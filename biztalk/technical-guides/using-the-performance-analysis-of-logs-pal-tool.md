---
title: 使用性能分析的日志 (PAL) 工具 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d563aa7d-102d-4fe6-a892-66794feaf83b
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 889cbe2a88859eec82f76d0eec309865bf727bfe
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "37024563"
---
# <a name="using-the-performance-analysis-of-logs-pal-tool"></a>使用日志 (PAL) 工具的性能分析
PAL （性能分析的日志） 工具读取性能监视器计数器日志 （任何已知格式） 中，并使用复杂，但已知阈值 （提供） 进行分析。 该工具生成基于 HTML 报表，以图形方式图表重要的性能计数器和超出阈值时引发警报。 阈值最初基于由 Microsoft 产品团队，包括定义的阈值[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，和成员的 Microsoft 支持。 此工具不能替代的传统的性能分析，但它可自动执行分析的性能计数器日志足够来帮助您节省大量时间。 PAL 工具中：  

- 分析阈值的性能计数器日志  

- 对于较大的 Perfmon 日志很有帮助  

- 标识[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]和通过分析阈值的操作系统性能计数器瓶颈  

- 可以扩展以对任何性能计数器进行分析  

- 可用于帮助编写你自己的计数器  

  PAL 是可作为免费下载[ http://go.microsoft.com/fwlink/?linkid=98098 ](http://go.microsoft.com/fwlink/?linkid=98098)。 它需要 Microsoft Log Parser。 日志分析程序是一个功能全面的强大工具，如事件日志、 注册表、 文件系统和活动在 Windows 操作系统上提供对基于文本的数据，例如日志文件、 XML 文件、 CSV 文件，以及关键的数据源的通用查询访问Directory® 目录服务。 您可能想要使用此工具来查询大量的日志记录信息。 您可以下载在 Log Parser 工具[ http://go.microsoft.com/fwlink/?linkid=85574 ](http://go.microsoft.com/fwlink/?linkid=85574)。  

## <a name="using-pal-with-performance-counter-logs-in-different-languages"></a>使用性能计数器的 PAL 中不同的语言的日志  
 PAL 工具将分析性能计数器日志仅以英语语言。 若要使用其他语言中的性能计数器日志 PAL 工具，必须首先将日志传输到英语的语言。 可以使用**Perfmon 日志转换器**工具，网址[ http://go.microsoft.com/fwlink/?LinkId=158802 ](http://go.microsoft.com/fwlink/?LinkId=158802)翻译为英语的原始性能计数器日志文件。  

## <a name="understanding-the-pal-tool-report-for-microsoft-biztalk-server-2010"></a>了解 Microsoft BizTalk Server 2010 的 PAL 工具报告  
 PAL 工具为 Windows 操作系统的 Microsoft SQL Server 提供的阈值 Perfmon 日志分析和[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。 本部分介绍在 BizTalk Server 阈值报表在 PAL 工具分析的大多数。  

> [!NOTE]  
>  本主题是长，以便可以在同一位置以方便引用包含有关 PAL 工具的全面信息。  

 PAL 工具报告的以下分析和阈值。  


|                                分析类型和名称                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       分析说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                        核心转储的磁盘： 磁盘可用空间                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  此分析会检查以确保足够的可用磁盘空间来转储所有内存到磁盘的操作系统。 如果没有足够的磁盘空间可用，则操作系统将无法创建 memory.dmp，这是内核转储的根本原因分析所需的文件。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                    磁盘： 逻辑/物理磁盘接口分析                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    此分析会查看每个物理磁盘的空闲时间。 磁盘空闲越多，越少正在使用该磁盘。 在逻辑磁盘中使用一个磁盘时，最好使用此计数器。 "%空闲时间"报告的磁盘处于空闲状态的示例间隔期间的时间百分比。<br /><br /> 参考： 排除磁盘密集型的问题 [http://go.microsoft.com/fwlink/?linkid=50669](http://go.microsoft.com/fwlink/?linkid=50669)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                磁盘： 逻辑/物理磁盘读/写延迟分析                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Windows 检测磁盘性能瓶颈的最可靠方法是通过测量其响应时间。 如果响应时间大于.025 （25 毫秒为单位），这是一个保守的阈值，则可能会发生明显减慢速度和性能问题影响用户。 详细信息，请参阅本主题中的逻辑/物理磁盘读/写延迟分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                           磁盘： 逻辑磁盘传输次数/秒                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "磁盘传输次数/秒"是的速率的读取和写入磁盘上的操作。 此分析检查以查看是否有任何逻辑磁盘的阈值会显示不佳响应时间 （大于 25 毫秒的 I/O 操作的响应时间）。 如果为 true，则磁盘每秒传输数应处于或高于 80。 如果没有，则磁盘体系结构需要进行调查。 不佳的磁盘 I/O 的最常见原因是重载在 SAN 上的 LUN。 有关详细信息，请参阅本主题中的逻辑 Disk Transfers/sec。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                            磁盘： 逻辑磁盘可用空间百分比                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "%可用空间"是所选逻辑磁盘驱动器的总可用空间的百分比。 小于 30%的可用磁盘驱动器空间之前，应该不会影响性能。 使用磁盘驱动器的 70%时，剩余的可用空间位于更靠近到磁盘的磁盘驱动器，在较低的性能级别进行操作的中心的主轴。 可用磁盘空间不足可能会导致严重的磁盘性能。<br /><br /> 参考： NT 服务器和磁盘子系统性能 [http://go.microsoft.com/fwlink/?linkid=106783](http://go.microsoft.com/fwlink/?linkid=106783)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|   磁盘： 处理 IO Data Operations/sec 和处理 IO 其他操作每秒分析   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            这些计数器计数，包括文件、 网络和设备 I/o 进程生成的所有 I/O 活动。 进程正在执行超过 1,000 个我 / O 的每秒并将其标记为警告时，请检查这些分析。 这些分析最适用于在其他分析，如磁盘分析以确定哪些进程可能涉及的 I/O 活动。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                               内存： 可用内存                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             此分析检查总可用内存是否不足 – 10%可用发出警告和在可用的 5%的关键。 每小时 10 MB 的下降趋势检测到，这可能表示潜在的即将推出的内存情况时，警告也会发出警报。 物理内存不足可能导致更高的特权模式下 CPU 和系统的延迟。 有关详细信息，请参阅可用 MemoryAnalysis 本主题中。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                        内存： 可用系统页表项                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                可用系统页表项 (PTE) 是当前未使用的系统页表条目数。 此分析确定是否在系统运行带 PTE 的通过检查是否有少于 5000 免费 PTE 的警告是否少于 10,000 位免费 PTE 的。 缺乏足够 PTE 可能会导致整个系统挂起。 此外请注意，3 GB 开关将显著降低免费 PTE 量。 详细信息，请参阅本主题中的可用系统页表条目分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                             内存： 内存泄漏检测                             |                                                                                                                                                                                                                                                                                                                                                                                             此分析确定的任何过程是否消耗大量系统的内存，并在进程是否在内存使用量随时间增加。 只要进程的内存返回到系统，占用大量内存的进程是没问题。 查找增加图表中的趋势。 长的一段时间内为增长趋势可能指示内存泄漏。 "专用字节数"是内存的当前大小 （字节），此进程已分配不能与其他进程共享。 此分析检查 10 MB 的每小时和 5 MB 的每小时增加趋势。 使用此分析在 PAL 中的可用内存分析。 详细信息，请参阅本主题中的内存泄漏检测分析。                                                                                                                                                                                                                                                                                                                                                                                              |
|                             内存： 句柄泄漏检测                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  此分析检查的所有进程以确定多少处理每个已打开并以确定是否有句柄泄漏怀疑。 一个过程，配合大量的句柄和/或积极向上的趋势可能指示句柄泄漏，这通常会导致内存泄漏。 此进程当前打开的句柄的总数等于在此过程中每个线程当前打开的句柄总数。<br /><br /> 参考： 调试诊断工具在 v1.1 [http://go.microsoft.com/fwlink/?linkid=106784](http://go.microsoft.com/fwlink/?linkid=106784)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                            内存： 内存 Pages Input/sec                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "Pages Input/sec"是从为解决强制分页错误的磁盘读取页的速率。 进程引用是不在其工作集或其他位置的物理内存，并且必须从磁盘中检索的虚拟内存中的页面时，将发生硬页面错误。 此分析会检查是否有超过 10 页文件的读取次数 / 秒。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                               内存： 内存页/秒                                |                                                                                                                                                                                                                                                                                                                                                                                此分析检查"页/秒"是高 （如上所示为 1000)。 如果高，然后在系统可能内存不足通过尝试进行分页到磁盘的内存。 "页/秒"是从读取或写入磁盘为解决强制分页错误页的速率。 此计数器是导致系统范围延迟的错误种类的主要指示器。  使用此分析在可用内存分析和 PAL 中的内存泄漏检测分析。 如果在同一时间中引发警报，所有这些分析，这可能表示系统内存不足和可疑的进程涉及并按照 analysis PAL 中的内存泄漏检测分析中所述的步骤。<br /><br /> 有关详细信息，请参阅本主题中的内存页/秒分析。                                                                                                                                                                                                                                                                                                                                                                                 |
|                      内存： 内存系统缓存驻留字节数                       |                                                                                                                                                                                                                                                                                                                                      "系统缓存驻留字节数"是大小 （字节） 文件系统缓存中的可分页操作系统代码。 此值仅包含当前物理页面，不包括任何当前未驻留的虚拟内存页面。 此值是一个组件的"内存\\\System 代码驻留字节数"表示所有当前正在物理内存的可分页操作系统代码。 此计数器显示上次观测的值; 仅它不是平均值。 此分析检查每小时 10 MB 的增长趋势。 承受负载时，服务器可能使用系统缓存，以便缓存如磁盘 I/O 活动。 在中使用相关进程 IO Data Operations/sec 和其他进程 IO 操作数/秒 PAL 中的分析。<br /><br /> 参考： 文件缓存性能和优化在 [http://go.microsoft.com/fwlink/?linkid=106786](http://go.microsoft.com/fwlink/?linkid=106786)                                                                                                                                                                                                                                                                                                                                      |
|                             内存： 池非分页字节数                              |                                                                                                                                                                                                                                                                                                                                                                             "池非分页字节数"是的大小，以字节为单位，无法写入到的对象的系统内存区域的非分页池的磁盘、 但一旦分配就必须保留在物理内存中。 此分析会检查以查看是否在系统即将接近最大的池非分页内存大小。 这是通过估计考虑到的池大小/3 GB、 物理内存大小和 32 位/64 位，然后确定值是否高于 60%的估计的池大小。 如果系统变得接近最大大小时，然后在系统可能会遇到系统宽挂起。<br /><br /> Boot.ini 文件中的 3 GB 开关选项大大减少了此内存池的大小。<br /><br /> 详细信息，请参阅本主题中的 Pool Non-Paged 字节分析。                                                                                                                                                                                                                                                                                                                                                                             |
|                               内存： 池分页字节数                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      此分析会检查以查看是否在系统即将接近最大池分页内存大小。 这是通过估计考虑到的池大小/3 GB、 物理内存大小和 32 位/64 位，然后确定值是否高于 60%的估计的池大小。 如果系统变得接近最大大小时，然后在系统可能会遇到系统宽挂起。<br /><br /> Boot.ini 文件中的 3 GB 开关选项大大减少了此内存池的大小。<br /><br /> 详细信息，请参阅本主题中的池分页字节分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                             内存： 进程线程计数                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     此分析会检查所有进程来确定某个进程是否拥有 500 多个线程和线程数已增加每小时 50 线程。 一个过程，配合大量的线程和/或积极向上的趋势可能指示存在线程泄漏，这通常会导致内存泄漏或高上下文切换。 高上下文切换会导致高特权模式下 CPU。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                              内存： 进程工作集                              |                                                                                                                                                                                                                                                                                                                                                                                          "工作集"是当前大小 （字节），此过程的工作集。 工作集是进程中的线程最近使用过的内存页的集合。 如果计算机中的可用内存高于阈值，页面会保留在进程的工作集，即使未使用。 如果可用内存降到阈值以下，将从工作集中削减页。 如果需要它们随后将软恢复到的工作集在离开主内存之前。 此分析检查 10 MB 的增长趋势或在每个进程的详细信息。 在使用 PAL 中的可用内存分析。<br /><br /> 参考： 检测在内存瓶颈 [http://go.microsoft.com/fwlink/?linkid=106787](http://go.microsoft.com/fwlink/?linkid=106787)                                                                                                                                                                                                                                                                                                                                                                                           |
|                     网络： 网络输出队列长度分析                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      此分析进行检查以查看多少线程正在等待网络适配器。 如果多个线程在等待上的网络适配器，然后在系统可能占满网络 I/O 由于网络延迟或网络带宽。 "Output Queue Length"是输出包列队 （数据包） 的长度。 延迟来指示这是长度大于 2，和瓶颈应找出并消除了在可能的情况。 网络输出队列的典型原因包括大量的小型网络请求和网络延迟。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                         网络： 网络使用率分析                         |                                                                                                                                                                                                                                                                                                                                   "Bytes Total/sec"是发送和每个网络适配器，包括组帧字符上接收字节的速率。 "Network Interface\Bytes Received/sec"是"Network Interface\Bytes Received/sec"和"Network Interface\Bytes Sent/sec"的总和。 此计数器可帮助你了解在您的网络适配器的流量是否已饱和以及您是否需要添加另一个网络适配器。 可以确定问题的速度取决于类型以及是否与其他应用程序共享带宽有的网络。 此分析将"Bytes Total/sec"转换为位并将它与计算网络利用率的网络适配器的当前带宽进行比较。 接下来，它检查利用率高于 50%。<br /><br /> 参考： 测量在.NET 应用程序性能 [http://go.microsoft.com/fwlink/?linkid=106788](http://go.microsoft.com/fwlink/?linkid=106788)                                                                                                                                                                                                                                                                                                                                    |
|                   分页文件： 分页文件使用率 %和 %使用情况峰值                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          分页文件实例的使用以百分比表示的量。 另请参阅"过程\\\Page 文件字节数"。 此分析会检查是否大于 70%的使用率的百分比。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  处理器： 处理器使用率分析和进程过多的处理器使用率   |                                                                                                                                                                                                                                                                                                                                                                                                                                                          此计数器是处理器活动的主要指示器，并显示在采样间隔期间观察到的忙时间的平均百分比。 通过监视服务处于非活动状态的时间然后减去该值从 100%，即可计算出它。 此分析检查使用率大于 60%的每个处理器。 如果是这样，确定它是否高用户模式 CPU 或高特权模式。 如果高特权模式下 CPU 怀疑有问题，请参阅 PAL 中的特权模式下 CPU 分析。 如果怀疑用户模式下处理器瓶颈，请考虑使用进程探查器分析导致高 CPU 占用率的函数。                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                           处理器： 处理器队列长度                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            此分析确定平均处理器队列长度是否超过处理器的数量。 如果是这样，这可能表示处理器瓶颈。 使用此分析在特权模式下 CPU 分析和过多的处理器使用 PAL 中的进程分析。 详细信息，请参阅本主题中的处理器队列长度分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                       处理器： 特权模式下 CPU 分析                        |                                                                                                                                                                                                                                                                                                                                                                                                                                        此计数器指示线程在特权模式下运行的时间的百分比。 当你的应用程序调用时 （例如，可执行文件或网络 I/O 或分配内存） 的操作系统功能时，这些操作系统函数在特权模式下执行。 此分析进行检查以查看特权模式下 CPU 是否占用了超过 30%的总 CPU。 如果这样，然后的 CPU 使用率可能会引起如网络、 内存或磁盘 I/O 处理器之外的另一个瓶颈。 在与处理器相关中的使用： 将 %Interrupt Time 和处理器： PAL 中的大量的上下文切换分析。 详细信息，请参阅本主题中的特权模式下 CPU 分析。                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                               处理器： 中断时间百分比                               |                                                                                                                                                                                                                                                                        "%中断时间"是处理器用于接收和服务硬件中断采样间隔期间的时间。 此值是活动的生成中断，例如系统时钟、 鼠标、 磁盘驱动程序、 数据通讯线路、 网络接口卡和其他外围设备的设备的间接指示器。 完成某项任务或需要注意时，这些设备通常会中断处理器。 中断期间暂挂正常线程执行。 大多数系统时钟每隔 10 毫秒，创建中断活动的背景会中断处理器。 显著提高此计数器指示潜在硬件问题。 此分析检查"%中断时间百分比"大于 30%。 如果发生这种情况，请考虑更新与此警报相关联的硬件的设备驱动程序。<br /><br /> 参考： 测量在.NET 应用程序性能 [http://go.microsoft.com/fwlink/?linkid=106788](http://go.microsoft.com/fwlink/?linkid=106788)                                                                                                                                                                                                                                                                        |
|                          处理器： 高上下文切换                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                         较高优先级线程抢先于当前正在运行的较低优先级线程或高优先级线程阻止时，会发生上下文切换。 当多个线程共享相同的优先级别，会发生上下文切换的高级别。 这通常表明过多的线程将在系统上处理器的争用。 作为一般规则，每个处理器每秒 5,000 个较低的上下文切换费率不值得担心。 如果上下文切换的速率超过 15,000 每秒每个处理器，则一个约束。 详细信息，请参阅本主题中的高上下文切换分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|              冻结业务流程的 Microsof BizTalk Server: BizTalk              |                                                                                                                                                                                        在同时运行多长时间运行的业务流程，内存和性能问题时，可能。 业务流程引擎通过“冻结”和“解除冻结”业务流程实例来解决这些问题。 冻结是将业务流程的状态序列化到 SQL Server 数据库中的过程。 解除冻结是此过程的相反： 反序列化数据库从业务流程的最后运行状态。 冻结用于通过减少必须在内存中同时实例化的业务流程数来最大程度地降低系统资源的使用。 因此，dehyrations 节省内存消耗，但若要执行的操作相对开销很大。 此分析会 dehydrations 10 或更多的检查。 如果是这样，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]可能内存不足 （虚拟或物理），较高的业务流程数都在等待消息，或未正确设置冻结设置。<br /><br /> 参考： 业务流程冻结和解除冻结在  [http://go.microsoft.com/fwlink/?LinkId=155284](http://go.microsoft.com/fwlink/?LinkId=155284)                                                                                                                                                                                         |
|               Microsoft BizTalk Server: BizTalk 高数据库会话               |                                                                                                                                                                                                                                                                                                                                                                                                               此计数器有两个可能值： 正常 (0) 或超出了阈值 (1)。 此分析检查的值为 1。 如果是这样，BizTalk 超出允许的数据库会话数的阈值。 此值控制 BizTalk 主机阻止设置中的"每 CPU 的数据库连接"值。 "数据库连接每个 CPU"是阻止开始之前允许并行数据库会话 （每 CPU) 的最大数目。 通过使用 BizTalk:Message Agent 性能对象类别下的 Database session 性能计数器，可以监视活动数据库连接数。 此参数只影响出站消息阻止功能。 详细信息，请参阅本主题中的 BizTalk 高数据库会话分析。                                                                                                                                                                                                                                                                                                                                                                                                               |
|                 Microsoft BizTalk Server: BizTalk 高数据库大小                  |                                                                                                                                                                                                         此计数器将设置为值 1，如果任何一个条件为数据库阈值中的消息计数列出发生。 默认情况下主机消息阻止阈值的数据库中的计数设置为 50000，会触发在下列情况下的在触发阻止条件的值：<br /><br /> 的发布到工作、 状态和已挂起的队列的订阅主机的主机实例消息总数超过 50,000。<br />-在后台处理表或跟踪表中的消息数超过 500,000 条消息。<br /><br /> 如果发生这种情况，请考虑将减少数据库中的消息的数目的操作过程。 例如，请确保在 SQL Server 作业[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]正常运行，并使用中的组中心页[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台来确定消息逐渐累积引起大量挂起消息。 有关详细信息，请参阅 BizTalk 高数据库大小分析此主题中。                                                                                                                                                                                                         |
|           Microsoft BizTalk Server: BizTalk 高进程内消息计数            |                                                                                                                                                                                                                                                                                                                                                                                                                                              此分析检查高进程内消息计数计数器来确定是否发生这种类型的限制。 如果是这样，请考虑调整"每 CPU 消息进程内"设置。 此参数只影响出站消息阻止功能。 在"进程内消息数 CPU"设置禁用基于每 CPU 的进程内消息数的阻止功能中输入值为 0。 "进程内消息数 CPU"设置的默认值为 1000。 请注意，修改此值可能还会影响在低延迟的消息和/或 BizTalk 资源的效率。 详细信息，请参阅本主题中的 BizTalk 高进程内消息计数分析。                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|             Microsoft BizTalk Server: BizTalk 高消息送达速率             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     此分析检查的值为 1 高消息送达速率计数器中。 高消息送达速率可能引起高处理复杂性、 出站适配器速度缓慢或系统资源出现暂时短缺。 详细信息，请参阅本主题中的 BizTalk 高消息送达速率分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|            Microsoft BizTalk Server: BizTalk 高消息发布速率            |                                                                                                                                                                                       入站的主机阻止，也称为消息发布阻止在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，应用于包含的主机实例接收适配器或业务流程的消息发布到 MessageBox 数据库。 此分析检查的值为 1 高消息发布速率计数器中。 如果发生这种情况，然后在数据库无法跟上的消息发布速率到 BizTalk MessageBox 数据库。<br /><br /> 引用：<br /><br /> -主机阻止性能计数器在 [http://go.microsoft.com/fwlink/?LinkId=155285](http://go.microsoft.com/fwlink/?LinkId=155285)<br />-如何[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkId=155286](http://go.microsoft.com/fwlink/?LinkId=155286)<br />消息发布阻止在设置对话框 [http://go.microsoft.com/fwlink/?LinkId=155287](http://go.microsoft.com/fwlink/?LinkId=155287)<br />-什么是主机阻止？在 [http://go.microsoft.com/fwlink/?LinkID=154694](http://go.microsoft.com/fwlink/?LinkID=154694)                                                                                                                                                                                        |
|                Microsoft BizTalk Server: BizTalk 高进程内存                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           限制阈值设置 BizTalk 进程内存使用情况是内存的相比工作集大小和可用虚拟内存总量的进程的总和，如果输入一个介于 1 和 100 之间使用百分比。 在指定百分比值时，将按固定的时间间隔来重新计算进程内存阈值。 此分析检查 1 中的较高的进程内存计数器的值。 详细信息，请参阅本主题中的 BizTalk 高进程内存分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                 Microsoft BizTalk Server: BizTalk 高系统内存                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     BizTalk 物理内存使用情况限制阈值设置为输入内存消耗与从 1 到 100 之间的如果值可用的物理内存总量的百分比。 如果输入大于 100 的值，此设置也可以是以兆字节表示的可用物理内存的总量。 输入值 0 可以禁用基于物理内存使用率的阻止功能。 默认值为 0。 详细信息，请参阅本主题中的 BizTalk 高的系统内存分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                 Microsoft BizTalk Server: BizTalk 高线程计数                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "每 CPU 线程数"是包括线程使用的适配器的主机进程中线程的总数。 如果超出此阈值，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将尝试减小 EPM 线程池和消息代理线程池的大小。 如果高负载可能导致创建大量线程，则在这种情况下，应启用基于线程的阻止功能。 此参数同时影响入站和出站阻止功能。 默认情况下禁用基于线程的阻止功能。 详细信息，请参阅本主题中的 BizTalk 高的线程计数分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                 Microsoft BizTalk Server: BizTalk 主机队列长度                  |                                                                                                                                                                                                                                                                                            BizTalk 主机队列长度跟踪特定主机队列中消息的总数。 长度大小 （即，BizTalk:MessageBox:HostCounters:Host 队列-长度） 可用于为提供正在排队等候在内部通过显示各个主机的队列深度的消息数的更详细的视图。 此计数器可确定是否遇到瓶颈特定主机。 假设每个传输协议为使用唯一的主机，这可以帮助确定潜在的传输瓶颈。 此分析检查平均队列长度大于 1。 目标主机的情况下，主机队列长度是通过聚合所有队列 (工作 Q，状态 Q 挂起 Q) 的记录计数的加权的队列长度。<br /><br /> 参考： BizTalk Server 2006： 管理成功在性能实验室[ http://go.microsoft.com/fwlink/?linkid=104152 ](http://go.microsoft.com/fwlink/?linkid=104152) **注意：** 此白皮书也是适用于 BizTalk Server。                                                                                                                                                                                                                                                                                             |
|        Microsoft BizTalk Server: BizTalk 主机挂起的消息队列长度         |                                                                                                                                                                                          此计数器跟踪特定主机的挂起的消息总数。 挂起的消息是消息或业务流程实例的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]已停止处理因出错而系统或消息中。 通常，根据系统问题的解决办法，由系统错误导致的挂起实例是可恢复的。 通常情况下，由于消息问题的挂起的实例不可恢复，以及消息本身必须修复并重新提交到[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系统。<br /><br /> 挂起的消息队列是包含为其错误或故障已处理过程中遇到的工作项的队列。 挂起队列将一直存储这些消息，直到它们被纠正、重新处理或被删除。 此分析检查挂起的任何的消息匹配项。 为增长趋势可能指示严重的处理错误。<br /><br /> 参考： BizTalk Server 2004： 监视和故障排除在 [http://go.microsoft.com/fwlink/?linkid=108771](http://go.microsoft.com/fwlink/?linkid=108771)                                                                                                                                                                                          |
|                     BizTalk Server: BizTalk 空闲业务流程                      |                                                                                                                    当前以主机实例为宿主的空闲业务流程实例的数量。 此计数器是指没有进展也不可冻结的业务流程。 业务流程被阻止时，出现这种情况，可以等待接收、 侦听或延迟在原子事务中。 如果累积了大量的非可冻结业务流程，BizTalk 可能会耗尽内存。<br /><br /> 冻结是将业务流程的状态序列化到 SQL Server 数据库中的过程。 解除冻结是此过程的相反： 反序列化数据库从业务流程的最后运行状态。 冻结用于通过减少必须在内存中同时实例化的业务流程数来最大程度地降低系统资源的使用。 引擎保存状态来冻结实例，并释放该实例所占用的内存。 通过冻结休眠的业务流程实例，该引擎使得大量长时间运行的业务流程，以同时在同一台计算机上运行。 此分析检查每小时一个空闲业务流程为增长趋势。<br /><br /> 参考： 业务流程冻结和解除冻结在  [http://go.microsoft.com/fwlink/?LinkId=155284](http://go.microsoft.com/fwlink/?LinkId=155284)                                                                                                                     |
|                       BizTalk Server: BizTalk 的入站延迟                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        以毫秒为单位自消息引擎文档从接收适配器发布到 MessageBox 为止的平均延迟。 减少滞后时间是 BizTalk 中，某些用户重要因此跟踪时间的文档所用的入站适配器中的量是很重要。 详细信息，请参阅本主题中的 BizTalk 的入站延迟分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                    BizTalk Server: BizTalk 消息传递延迟                    |                                                                                                                                                                         这是当前规定延迟时间以毫秒 (ms) 为单位对每个消息送达批 （如果要中止消息传递时适用）。 对于限制，在发布或处理消息，具体取决于消息是入站或出站应用延迟。 延迟时间是阻止条件的严重性成比例。 阻止条件的严重性较高将启动更长的阻止时间长于阻止条件的严重性较低。 随着阻止条件的变化，将根据阻止机制在特定范围内延长和缩短此延迟时间。 当前延迟时间是通过的 message delivery delay (ms) 和 message publishing 与 biztalk: Message Agent 性能对象类别相关联的延迟 (ms) 性能计数器公开。 此分析检查消息传递的大于 5 秒延迟。 长消息传送延迟可能表明由于高负载而进行大量控制。<br /><br /> 参考： 如何[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkId=155286](http://go.microsoft.com/fwlink/?LinkId=155286)                                                                                                                                                                         |
|              BizTalk Server: BizTalk 消息传递限制状态               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           BizTalk 消息传递阻止状态是主要指标，限制之一。 它是指示系统是否要阻止消息送达 （影响 XLANG 消息处理和出站传输） 的标志。 由计数器的数值指示阻止条件。 有关详细信息，请参阅本主题中的 BizTalk 消息传递限制状态分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                   BizTalk Server: BizTalk 消息发布延迟                   |                                                                                                                                                                                                    限制消息的发布的每个合格批中插入的延迟时间。 对于限制，在发布或处理消息，具体取决于消息是入站或出站应用延迟。 延迟时间是阻止条件的严重性成比例。 阻止条件的严重性较高将启动更长的阻止时间长于阻止条件的严重性较低。 随着阻止条件的变化，将根据阻止机制在特定范围内延长和缩短此延迟时间。 当前延迟时间是通过的 message delivery delay (ms) 和 message publishing 与 biztalk: Message Agent 性能对象类别相关联的延迟 (ms) 性能计数器公开。 此分析检查消息发布大于 5 秒的延迟。 长消息传送延迟可能表明由于高负载而进行大量控制。<br /><br /> 参考： 如何[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkId=155286](http://go.microsoft.com/fwlink/?LinkId=155286)                                                                                                                                                                                                    |
|           BizTalk Server: BizTalk MessageBox 数据库连接失败            |                                                                                                                                                                                                                                                                                                                                                                                     此性能计数器是数据库连接尝试失败，因为启动主机实例的数目。 如果出于任何原因，承载 BizTalk 数据库的 SQL Server 服务将变得不可用，则数据库群集会将资源从主动计算机传输到被动计算机。 在此故障转移过程中，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]服务实例遇到数据库连接失败，并自动重新启动以重新连接到数据库。 采用故障转移期间传输的资源后，正在运行的数据库计算机（即前面提到的被动计算机）将开始处理数据库连接。 详细信息，请参阅本主题中的 BizTalk MessageBox 数据库连接故障分析。                                                                                                                                                                                                                                                                                                                                                                                      |
|         BizTalk Server: BizTalk 消息传送延迟： 请求响应延迟时间         |                                                                                                                                                                                                                                                                                                                                                              自消息引擎从适配器接收到请求文档到将响应文档返回到适配器的平均延迟时间（以毫秒计）。 请参阅图，显示如何测量滞后时间是在 BizTalk 的入站延迟分析本主题中。 假设低延迟环境，此分析会检查请求-响应延迟大于 5 秒。 这可能表示入站的适配器和出站适配器之间的处理延迟。<br /><br /> 引用：<br /><br /> 请求/响应消息传送在 [http://go.microsoft.com/fwlink/?LinkId=155288](http://go.microsoft.com/fwlink/?LinkId=155288)<br />BizTalk Server 2006： 在 BizTalk Server 2006 在使用 SOAP 适配器的可伸缩性案例研究 [http://go.microsoft.com/fwlink/?linkid=108774](http://go.microsoft.com/fwlink/?linkid=108774)                                                                                                                                                                                                                                                                                                                                                              |
|            BizTalk Server: BizTalk 消息发布阻止状态             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           BizTalk 消息发布阻止状态是主要指标，限制之一。 它是指示系统是否要阻止消息发布 （影响 XLANG 消息处理和入站的传输） 的标志。 详细信息，请参阅本主题中的 BizTalk 消息发布限制状态分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                BizTalk Server: BizTalk 业务流程挂起/秒                |                                                                                                                                                                                                                                                                                                                                                                                        挂起的消息是消息或业务流程实例的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]已停止处理因出错而系统或消息中。 通常，根据系统问题的解决办法，由系统错误导致的挂起实例是可恢复的。 通常情况下，由于消息问题的挂起的实例不可恢复，以及消息本身必须修复并重新提交到[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系统。 此分析检查任何挂起的消息/业务流程。<br /><br /> 参考： BizTalk Server 2004： 监视和故障排除在 [http://go.microsoft.com/fwlink/?linkid=108771](http://go.microsoft.com/fwlink/?linkid=108771)                                                                                                                                                                                                                                                                                                                                                                                        |
|               BizTalk Server: BizTalk 业务流程已完成/秒                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       这是已完成的 BizTalk 业务流程数 / 秒。 这是处理 BizTalk 多少吞吐量很好的指示器。 此分析提供了仅限统计信息。<br /><br /> 参考： BizTalk Server 2006： 在 BizTalk Server 2006 中使用 SOAP 适配器的可伸缩性案例研究 <br />[http://go.microsoft.com/fwlink/?linkid=108774](http://go.microsoft.com/fwlink/?linkid=108774)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                   BizTalk Server: BizTalk 业务流程被丢弃                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          自从主机实例启动以来，内存中被丢弃的业务流程实例的数量。 如果引擎未能持久化某个业务流程的状态，则会将其丢弃。 此分析检查任何消息被放弃。<br /><br /> 参考： BizTalk 核心引擎的网络日志<br />[http://go.microsoft.com/fwlink/?linkid=108775](http://go.microsoft.com/fwlink/?linkid=108775)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|              在内存中驻留在 BizTalk 服务器： BizTalk 业务流程               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           当前以主机实例为宿主的业务流程实例的数量。 此分析检查驻留在内存和是否超过 50%的驻留在内存中的业务流程不是可冻结业务流程中为增长趋势。 有关详细信息，请参阅 BizTalk 业务流程驻留在内存分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   BizTalk Server: BizTalk 适配器的出站延迟                   |                                                                                                  这是从时适配器获取一个文档从消息引擎适配器发送之前的秒数的平均延迟。 请参阅图，显示如何测量滞后时间是在 BizTalk 的入站延迟分析本主题中。 假设低延迟环境，此分析检查在出站适配器中的大于 5 秒的延迟的平均值。 这可能指示在传输中，通过此主机实例中的出站适配器的消息的处理延迟。 如果此主机实例中存在多个出站适配器，请考虑将它们分散到其自己的主机以确定哪种出站适配器的高延迟。<br /><br /> 引用：<br /><br /> 请求/响应消息传送在 [http://go.microsoft.com/fwlink/?LinkId=155288](http://go.microsoft.com/fwlink/?LinkId=155288)<br />BizTalk Server 2006： 在 BizTalk Server 2006 在使用 SOAP 适配器的可伸缩性案例研究 [http://go.microsoft.com/fwlink/?linkid=108774](http://go.microsoft.com/fwlink/?linkid=108774)<br />标识在 BizTalk 层的瓶颈 [http://go.microsoft.com/fwlink/?LinkId=155289](http://go.microsoft.com/fwlink/?LinkId=155289)<br />BizTalk Server 2004： 性能优化的低延迟的消息传送在 [http://go.microsoft.com/fwlink/?linkid=108777](http://go.microsoft.com/fwlink/?linkid=108777)                                                                                                   |
|                       BizTalk Server: BizTalk 挂起的消息                       |                                                                                                                                                                                                        接收到 MessageBox 接收到尚未确认的消息数。 消息已拉取到内存并将其传送到 XLANG 业务流程，但尚不是挂起的消息处理。 这种情况下会丢失数据无关。  消息传送到业务流程是一个多步骤过程，只是驻留在数据库中的后台处理表中的消息实例。 这些挂起的消息计数，在处理消息;因此，在内存中大量的这些地址可能会导致内存限制在系统上。 调整内部消息队列大小设置有助于其控制的挂起消息数。 每个 CPU 进程内消息设置会影响限制将时调用挂起的消息更大量的发生时。 在 BizTalk 管理控制台中的主机属性中找到这些设置。 此分析会检查此计数器仅显示统计。<br /><br /> 在参考： 业务流程引擎性能计数器 [http://go.microsoft.com/fwlink/?LinkId=155290](http://go.microsoft.com/fwlink/?LinkId=155290)                                                                                                                                                                                                         |
|                  BizTalk Server: BizTalk 持久化点/秒                   |                                                                                         平均每秒持久化业务流程实例的次数。 业务流程引擎保存在不同点正在运行的业务流程实例的状态。 如果需要解除冻结的业务流程实例、 从受控的关闭、 启动或从意外关机恢复，它将从最后一个持久点运行的业务流程实例。 才能持久地保存业务流程实例，所有对象直接或间接指您的业务流程的实例 （如通过其他对象） 必须可序列化。 作为消息持久性频率 （需要永久保存数据的时间数） 增加，总体性能下降。 实际上，每个持久化点是到数据库的往返行程，因此只要有可能的持久化点的频率避免或减少合并持久化点。 请参阅下面有关持久化点发生时详细信息的引用。 此分析平均检查每秒超过 10 个持久化点。 这是常规的起始点。<br /><br /> 引用：<br /><br /> 的在业务流程中暂留 [http://go.microsoft.com/fwlink/?LinkId=155291](http://go.microsoft.com/fwlink/?LinkId=155291)<br />暂留和在业务流程引擎 [http://go.microsoft.com/fwlink/?LinkId=155292](http://go.microsoft.com/fwlink/?LinkId=155292)                                                                                         |
|                        BizTalk Server: BizTalk 专用字节数                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       这是个主机实例且比分配的专用内存兆字节的"\Process (\*) \Private 字节数"性能计数器。 此分析确定是否任何主机实例正在使用较大的系统的内存和是否在内存使用量随时间增加的主机实例。 在此主题的详细信息，请参阅 BizTalk 专用字节分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                       BizTalk Server: BizTalk 后台处理表大小                       |                                                  MessageBox 后台处理表包含每个消息的记录系统中 (活动或等待进行"垃圾回收")。 监视此表中的行数和而增加系统负载提供可以轻松地找到的最大可承受吞吐量每秒接收的消息数。 只需增加输入的负载直到任一 1） 在后台处理表开始无限期地增长或 2） 的第二个 plateaus，具体取决于第一个，，并且在最大可承受吞吐量每收到的消息数。 在摘要，而不考虑其他指标，此度量值将提供快速而简单的方式来评估是否在系统超负荷运行或不。 当 BizTalk 后台处理表大小上为增长趋势时，限制由于不均衡消息送达速率 （输入的速率超出输出速率） 或由于数据库大小限制可能会发生。 此分析会检查 BizTalk 后台处理表大小不断增加的趋势。<br /><br /> 引用：<br /><br /> -了解 BizTalk Server 2004 SP1 吞吐量和容量 [http://go.microsoft.com/fwlink/?linkid=108781](http://go.microsoft.com/fwlink/?linkid=108781)<br />-在可承受负载测试 [http://go.microsoft.com/fwlink/?LinkId=155293](http://go.microsoft.com/fwlink/?LinkId=155293)<br />-建议测试引擎性能时 [http://go.microsoft.com/fwlink/?LinkID=155294](http://go.microsoft.com/fwlink/?LinkID=155294)                                                   |
|                      BizTalk Server: BizTalk 跟踪数据大小                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                  当 BizTalk Server 处理越来越多的数据，你的系统上，BizTalk 跟踪数据库 (BizTalkDTADb) 将不断增长的大小。 不受控制的增长将会降低系统性能，并可能导致跟踪数据传送服务 (TDDS) 出错。 除了一般的跟踪数据之外，跟踪的消息也会在 MessageBox 数据库中累积，导致磁盘性能下降。 此分析检查多个 5 MB 的每小时在跟踪中为增长趋势的数据大小。<br /><br /> 参考：<br /><br /> 存档和清除 BizTalk 跟踪数据库  [http://go.microsoft.com/fwlink/?LinkID=153816](http://go.microsoft.com/fwlink/?LinkID=153816)                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                 BizTalk Server: BizTalk 事务作用域已中止                 |                                                                                                                                                                                                                                                                                       这是自从主机实例启动以来已中止的长期或原子作用域数量。 事务作用域中止是业务流程中的事务作用域中发生的故障。 请务必了解作用域已成功完成，但然后必须是撤消，因为周围的作用域已决定中止 （由于更高版本在过程中可能发生的失败） 时才调用作用域的补偿处理程序。 此外，状态不会"自动"回滚事务中止的情况下发生。 您可以获得此结果以编程方式通过异常和补偿处理程序。 中止事务作用域不应该通常发生在生产环境中;因此，此分析会检查任何已中止的事务作用域的匹配项。<br /><br /> 参考：<br /><br /> 在 BizTalk Server 2004 跨事务 [http://go.microsoft.com/fwlink/?linkid=108784](http://go.microsoft.com/fwlink/?linkid=108784)                                                                                                                                                                                                                                                                                       |
|               BizTalk Server: BizTalk 事务作用域补偿               |                                                                                                                                                                                                                                                                                                                                  可以将补偿视为逻辑撤消以响应某些错误条件已成功提交的工作。 请务必了解作用域已成功完成，但然后必须是撤消，因为周围的作用域已决定中止 （由于更高版本在过程中可能发生的失败） 时才调用作用域的补偿处理程序。 此外，状态不会"自动"回滚事务中止的情况下发生。 这种回滚可以通过编写异常处理程序和补偿处理程序来实现。 补偿事务作用域不应该通常发生在生产环境中;因此，此分析会检查任何已中止的事务作用域的匹配项。<br /><br /> 在 BizTalk Server 2004 跨参考： 事务 [http://go.microsoft.com/fwlink/?linkid=108784](http://go.microsoft.com/fwlink/?linkid=108784)                                                                                                                                                                                                                                                                                                                                   |
|                        BizTalk Server: BizTalk 虚拟字节数                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         这是适用于主机实例的虚拟内存保留的兆字节。 此分析确定的任何主机实例是否消耗大量系统的内存，并在主机实例是否在内存使用量随时间增加。 详细信息，请参阅本主题中的 BizTalk 虚拟字节分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|          BizTalk Server: BizTalk 消息代理数据库会话限制           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 这是与 MessageBox 相比其相应的 BizTalk 阻止设置的开放式数据库连接数。 "数据库连接每个 CPU"是阻止开始之前允许并行数据库会话 （每 CPU) 的最大数目。 详细信息，请参阅本主题中的 BizTalk 消息代理数据库会话限制分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|     BizTalk Server: BizTalk 消息代理数据库会话限制阈值      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          这是与 MessageBox 的开放式数据库连接数的当前阈值。 "数据库连接每个 CPU"是阻止开始之前允许并行数据库会话 （每 CPU) 的最大数目。 详细信息，请参阅本主题中的 BizTalk 消息代理数据库会话限制阈值分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|      BizTalk Server: BizTalk 消息代理进程内消息计数限制       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   这是服务类别正在处理的并行消息数。 主机阻止设置中的"进程内消息数 CPU"设置为的最大未处理的消息传送到端点管理器 (EPM) 或 XLANG 数。 有关详细信息，请参阅本主题中的 BizTalk 消息代理进程内消息计数限制分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| BizTalk Server: BizTalk 消息代理进程内消息数阻止阈值  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 这是服务类别正在处理的并行消息数的当前阈值。 主机阻止设置中的"进程内消息数 CPU"设置为的最大未处理的消息传送到端点管理器 (EPM) 或 XLANG 数。 有关详细信息，请参阅 BizTalk 消息代理进程内消息计数限制阈值中的分析此主题。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|      BizTalk Server: BizTalk 消息代理进程内存使用率 (MB) 限制      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    这是当前进程 (MB) 的内存使用情况。 如果要发布的批处理具有很高的内存要求，或者过多的线程所处理的消息，则会出现 BizTalk 进程内存的阻止功能。 有关详细信息，请参阅本主题中的 BizTalk 消息代理进程内存使用率 (MB) 限制分析。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 阻止阈值的 BizTalk Server: BizTalk 消息代理进程内存使用率 (MB) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         这是当前进程 (MB) 的内存使用量的当前阈值。 可能会动态调整阈值，具体取决于实际的于此进程及其内存占用模式可用内存量。 如果要发布的批处理具有很高的内存要求，或者过多的线程所处理的消息，则会出现 BizTalk 进程内存的阻止功能。 有关详细信息，请参阅 BizTalk 消息代理进程内存使用率 (MB) 限制阈值分析本主题中。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            BizTalk Server: BizTalk 消息代理线程计数限制             | BizTalk 进程中的线程总数。 "每 CPU 线程数"是包括线程使用的适配器的主机进程中线程的总数。 如果超过此阈值，则 BizTalk Server 将尝试减小 EPM 线程池和消息代理线程池的大小。 如果高负载可能导致创建大量线程，则在这种情况下，应启用基于线程的阻止功能。 此参数同时影响入站和出站阻止功能。 默认情况下禁用基于线程的阻止功能。 此分析会检查是否大于 80%的限制的阈值值，该值指示在触发阻止条件很可能 BizTalk 线程数。<br /><br /> 引用：<br /><br /> -主机阻止性能计数器在 [http://go.microsoft.com/fwlink/?LinkId=155285](http://go.microsoft.com/fwlink/?LinkId=155285)<br />-如何[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkId=155286](http://go.microsoft.com/fwlink/?LinkId=155286)<br />-如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkId=155296](http://go.microsoft.com/fwlink/?LinkId=155296)<br />会影响适配器性能的配置参数 [http://go.microsoft.com/fwlink/?LinkID=154200](http://go.microsoft.com/fwlink/?LinkID=154200)<br />线程，数据库会话和在限制 [http://go.microsoft.com/fwlink/?linkid=106793](http://go.microsoft.com/fwlink/?linkid=106793) |
|       BizTalk Server: BizTalk 消息代理线程数阻止阈值        |                    这是此进程中线程的总数的当前阈值。 "每 CPU 线程数"是包括线程使用的适配器的主机进程中线程的总数。 如果超过此阈值，则 BizTalk Server 将尝试减小 EPM 线程池和消息代理线程池的大小。 在其中高负载可能会导致创建大量的线程的情况下，应启用基于线程的阻止功能。 此参数同时影响入站和出站阻止功能。<br /><br /> 此分析会检查是否将此限制设置设置为非默认值。 默认情况下禁用基于线程的阻止功能。<br /><br /> 引用：<br /><br /> -主机阻止性能计数器在 [http://go.microsoft.com/fwlink/?LinkId=155285](http://go.microsoft.com/fwlink/?LinkId=155285)<br />-如何[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkId=155286](http://go.microsoft.com/fwlink/?LinkId=155286)<br />-如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkId=155296](http://go.microsoft.com/fwlink/?LinkId=155296)<br />会影响适配器性能的配置参数 [http://go.microsoft.com/fwlink/?LinkID=154200](http://go.microsoft.com/fwlink/?LinkID=154200)<br />线程，数据库会话和在限制 [http://go.microsoft.com/fwlink/?linkid=106793](http://go.microsoft.com/fwlink/?linkid=106793)                    |

## <a name="logicalphysical-disk-readwrite-latency-analysis"></a>逻辑/物理磁盘读/写延迟分析  
 Windows 检测磁盘性能瓶颈的最可靠方法是通过测量其响应时间。 如果响应时间大于.025 （25 毫秒为单位），这是一个保守的阈值，则可能会发生明显减慢速度和性能问题影响用户。  

 不佳的磁盘延迟的常见原因是磁盘碎片，性能缓存、 一个饱和 SAN，和在磁盘上的过多负载。 使用 SPA 工具以帮助识别的高级文件和进程使用的磁盘。 此外检查"进程 IO 数据 Operations/sec"和"进程 IO 其他操作数/秒"若要查看哪些进程正在使用最多磁盘我 / O 的 请记住，性能监视器计数器不能指定涉及哪些文件。  

### <a name="references"></a>References  

-   排除磁盘密集型的问题 [http://go.microsoft.com/fwlink/?linkid=50669](http://go.microsoft.com/fwlink/?linkid=50669)  

-   如何确定磁盘性能瓶颈使用在 Microsoft 服务器性能顾问 (SPA) 工具 [http://go.microsoft.com/fwlink/?linkid=98096](http://go.microsoft.com/fwlink/?linkid=98096)  

-   下载适用于在 Microsoft 服务性能顾问 (SPA) 的详细信息： [http://go.microsoft.com/fwlink/?linkid=57769](http://go.microsoft.com/fwlink/?linkid=57769)  

## <a name="logical-disk-transferssec"></a>逻辑磁盘传输/次数/秒  
 "磁盘传输次数/秒"是的速率的读取和写入磁盘上的操作。 尽管磁盘传输不直接关联到磁盘我 / O，他们不要告诉我们发生多少个磁盘操作。 如果您的平均顺序我 / O 的和随机我 / O，则你将得到约为 80 个我 / O 每秒作为常规的经验法则。 因此，我们应期望执行禬筁 80 我的 SAN 驱动器/O 按下的第二个时加载。 此分析检查以查看是否有任何逻辑磁盘的阈值会显示不佳响应时间 （大于 25 毫秒的 I/O 操作的响应时间）。 如果为 true，我们应期望磁盘每秒传输数为或高于 80。 如果没有，则磁盘体系结构需要进行调查。 不佳的磁盘 I/O 的最常见原因是重载上 SAN – 这意味着多个 LUN 正在使用较小的物理磁盘阵列的位置的条件的逻辑单元号 (LUN)。  

### <a name="reference"></a>参考  
 NT 服务器和磁盘子系统性能 [http://go.microsoft.com/fwlink/?linkid=106783](http://go.microsoft.com/fwlink/?linkid=106783)  

## <a name="available-memory-analysis"></a>可用内存分析  
 "Available Mbytes"是可在兆字节为单位的计算机上运行的进程的物理内存量。 虚拟内存管理器不断调整用在物理内存和磁盘上保持最小操作系统和进程的可用字节数的空间。 可用字节数不多时，虚拟内存管理器允许进程的工作集不断增长，或使它们通过删除旧的页为每个新页面添加稳定。 几个可用字节时，虚拟内存管理器必须剪裁流程来保持的最低要求的工作集。  

 此分析进行检查以查看总可用内存是否不足 – 10%可用发出警告和在可用的 5%的关键。 每小时 10 MB 的下降趋势检测到，指示潜在即将推出的内存情况时，警告也会发出警报。 物理内存不足可能导致更高的特权模式下 CPU 和系统的延迟。  

### <a name="references"></a>References  

-   在检测内存瓶颈 [http://go.microsoft.com/fwlink/?linkid=106787](http://go.microsoft.com/fwlink/?linkid=106787)  

-   排除了受内存限制的问题 [http://go.microsoft.com/fwlink/?linkid=62575](http://go.microsoft.com/fwlink/?linkid=62575)  

## <a name="memory-leak-detection-analysis"></a>内存泄漏检测分析  
 此分析确定的任何过程是否消耗大量系统的内存，并在进程是否在内存使用量随时间增加。 使用大量的内存的进程没什么关系，只要进程的内存返回到系统。 查找增加图表中的趋势。 长的一段时间内为增长趋势可能指示内存泄漏。 专用字节数是内存的当前大小 （字节），此进程已分配不能与其他进程共享。 此分析检查 10 MB 的每小时和 5 MB 的每小时增加趋势。 使用此分析在可用内存分析。  

 此外，请注意，新启动的进程将最初显示为内存泄漏时只是正常的启动行为。 当进程会继续占用的内存和长的一段时间，不会释放内存时，将发生内存泄漏。  

 如果您怀疑内存泄漏情况，然后安装并使用调试诊断工具工具。 调试诊断工具的详细信息，请参阅参考部分。  

### <a name="reference"></a>参考  
 调试诊断工具在 v1.1 [http://go.microsoft.com/fwlink/?linkid=106784](http://go.microsoft.com/fwlink/?linkid=106784)  

## <a name="memory-pagessec-analysis"></a>内存秒页数分析  
 此分析检查"页/秒"为高。 如果高，然后在系统可能内存不足通过尝试进行分页到磁盘的内存。 "页/秒"是从读取或写入磁盘为解决强制分页错误页的速率。 此计数器是导致系统范围延迟的错误种类的主要指示器。  它是"Memory\Pages Input/sec"和"Memory\Pages Output/sec"之和。 它以页数，因此它可以与其他页，例如"Memory\Page Faults/sec"计数比较计数。  

 此计数器应始终为 1,000 以下。 此分析检查到超过 1,000 的值。 与可用内存分析和内存泄漏检测分析的相关中使用此分析。 如果所有分析都在同一时间都引发警报，这可能表示系统内存不足。 按照本主题中的其他信息有关内存泄漏检测分析中所述的分析步骤。  

### <a name="reference"></a>参考  
 排除了受内存限制的问题 [http://go.microsoft.com/fwlink/?linkid=62575](http://go.microsoft.com/fwlink/?linkid=62575)  

## <a name="memory-system-cache-resident-bytes-analysis"></a>分析内存系统缓存驻留字节数  
 "系统缓存驻留字节数"是大小 （字节） 文件系统缓存中的可分页操作系统代码。 此值仅包含当前物理页面，不包括任何当前未驻留的虚拟内存页面。 它就是显示在任务管理器的系统缓存值。 因此，此值可能小于的实际使用的文件系统缓存中的虚拟内存量。 此值是一个组件的"内存\\\System 代码驻留字节数"，它表示所有当前正在物理内存的可分页操作系统代码。 此计数器显示上次观测的值; 仅它不是平均值。  

 此分析检查每小时 10 MB 的增长趋势。 承受负载时，服务器可能使用系统缓存，以便缓存如磁盘 I/O 活动。 在中使用相关进程 IO Data Operations/sec 和其他进程 IO 操作数/秒的分析。  

## <a name="processor-utilization-analysis-and-excessive-processor-use-by-processes"></a>处理器利用率分析和进程过多的处理器使用  
 "%Processor Time"是处理器执行非闲置线程的已用时间的百分比。 通过测量采样间隔的空闲线程处于活动状态的持续时间然后减去间隔持续时间计算出它。 （每个处理器都有占用时钟周期时没有其他线程准备好运行的空闲线程。）此计数器是处理器活动的主要指示器，并显示在采样间隔期间观察到的忙时间的平均百分比。 通过监视服务处于非活动状态，时间然后减去该值从 100%，即可计算出它。  

 此分析检查使用率大于每个单个处理器上的 60%。 如果是这样，确定它是否高用户模式 CPU 或高特权模式。 如果高特权模式下 CPU 怀疑有问题，请参阅"特权模式下 CPU 分析"。 如果怀疑用户模式下处理器瓶颈，请考虑使用进程探查器分析导致高 CPU 占用率的函数。 请参阅"如何为： 标识导致高用户模式 CPU 瓶颈为服务器应用程序在生产环境中的函数"的详细信息的参考资料部分中的文章。  

## <a name="processor-queue-length-analysis"></a>处理器队列长度分析  
 "Processor Queue Length"是处理器队列中的线程数。 与磁盘计数器，此计数器只显示就绪线程，不运行的线程。  没有单个队列的处理器时间百分比甚至在具有多个处理器的计算机上。 因此，如果计算机具有多个处理器，您需要此值除以处理工作负载的处理器数。 每个处理器少于 10 个线程的持续的处理器队列是通常可接受，不管工作负载。  

 此分析确定平均处理器队列长度是否超过处理器的数量。 如果是这样，这可能表示处理器瓶颈。 使用此分析在特权模式下 CPU 分析和由进程过多的处理器使用。 处理器队列是准备就绪，但不能由处理器执行，因为另一个活动线程当前正在执行的线程的集合。 更多的线程的处理器数大于处理器瓶颈更好地指示持续或重复发生队列。  

 可以结合使用此计数器"处理器\\%Processor Time"计数器来确定你的应用程序是否可以从更多的 Cpu 中受益。 没有单个队列的处理器时间，即使在多处理器计算机上。 因此，在多处理器计算机中，除"Processor Queue Length"(PQL) 值的处理工作负载的处理器数  

 如果 CPU 是非常忙 （90%和更高的利用率） 并且 PQL 平均值高于一致的处理器，数则可能存在处理器瓶颈可受益于更多的 Cpu。 或者，你可能会减少线程和应用程序级别的队列的数量。 这会导致减少上下文切换，这非常适合于减少 CPU 负载。 低 CPU 使用率较高 PQL 的常见原因是随机，处理器时间的请求到达时，线程需要不定期大量处理器时间。 这意味着在处理器不是瓶颈。 而是，需要改进工作线程处理逻辑。  

 如果怀疑用户模式下处理器瓶颈，请考虑使用进程探查器分析导致高 CPU 占用率的函数。 请参阅"如何为： 标识导致高用户模式 CPU 瓶颈为服务器应用程序在生产环境中的函数"的详细信息的参考资料部分中的文章。  

## <a name="privileged-mode-cpu-analysis"></a>特权模式下 CPU 分析  
 此计数器指示线程在特权模式下运行的时间的百分比。 当你的应用程序调用时 （例如，可执行文件或网络 I/O 或分配内存） 的操作系统功能时，这些操作系统函数在特权模式下执行。  

 高特权模式下 CPU 指示计算机花费了太多时间在与实际 （用户模式） 的系统 I/O 工作。 "%Privileged Time"是进程线程在特权模式下执行代码所用的占用时间的百分比。  调用 Windows 系统服务时，服务将通常运行在特权模式下，若要获取对系统专有数据的访问权限。 在用户模式下执行的线程访问从受此类数据。 对系统的调用可以是显式或隐式的例如页面错误或中断。 不像某些早期的操作系统，Windows 使用进程边界作为分系统保护除传统的保护之外的用户和特权模式。 代表应用程序由 Windows 完成某些工作可能会出现在进程中的特权时间除了其他子系统进程中。  

 此分析进行检查以查看特权模式下 CPU 是否占用了超过 30%的总 CPU。 如果这样，然后的 CPU 使用率可能会引起如网络、 内存或磁盘 I/O 处理器之外的另一个瓶颈。 在中使用相关将 %Interrupt Time 和大量的上下文切换分析。  

## <a name="high-context-switching-analysis"></a>高上下文切换分析  
 较高优先级线程抢先于当前正在运行的较低优先级线程或高优先级线程阻止时，会发生上下文切换。 当多个线程共享相同的优先级别，会发生上下文切换的高级别。 这通常表明过多的线程将在系统上处理器的争用。 如果您看不到更处理器利用率，并且查看非常低级别的上下文切换，则可能表示线程被阻止。  

 高特权模式下，CPU 和总体 CPU 时应仅调查高上下文切换。 作为一般规则，每个处理器每秒 5,000 个较低的上下文切换费率不值得担心。 如果上下文切换的速率超过 15,000 每秒每个处理器，则一个约束。  

 此分析检查高 CPU、 高特权模式下 CPU 和高 （大于 5,000 每个处理器） 系统上下文切换每秒所有发生在同一时间。 如果在发生高上下文切换，然后减少线程和进程在系统上运行的数量。  

## <a name="biztalk-high-database-sessions-analysis"></a>BizTalk 高数据库会话分析  
 此计数器有两个可能的值即正常 (0)，或超出 (1)。 此分析检查的值为 1。 如果是这样，BizTalk 超出允许的数据库会话数的阈值。 此值控制 BizTalk 主机阻止设置中的"每 CPU 的数据库连接"值。  

 "数据库连接每个 CPU"是阻止开始之前允许并行数据库会话 （每 CPU) 的最大数目。 此计数不包括通用的每主机会话池中的空闲数据库会话数，并且只对主机实例实际使用的会话数进行此检查。 此选项禁用默认设置。通常情况下，此设置应仅启用数据库服务器是瓶颈或低端数据库服务器的 BizTalk Server 系统中。 可以使用 biztalk: Message Agent 性能对象类别下的数据库会话性能计数器来监视活动数据库连接数。 此参数只影响出站消息阻止功能。 输入值 0 可以禁用基于数据库会话数的阻止功能。 默认值为 0。  

> [!NOTE]  
>  "MaxWorkerThreads"注册表项会影响数字的线程提供给 BizTalk，如果大多数 BizTalk 线程都忙于处理数据库连接可帮助。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   线程、 数据库会话和在限制 [http://go.microsoft.com/fwlink/?linkid=106793](http://go.microsoft.com/fwlink/?linkid=106793)  

-   影响适配器性能的配置参数 [http://go.microsoft.com/fwlink/?LinkID=154200](http://go.microsoft.com/fwlink/?LinkID=154200)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

## <a name="biztalk-high-database-size-analysis"></a>BizTalk 高数据库大小分析  
 此计数器是指此进程已发布的数据库队列中的消息数。 此值按所有主机队列表中的项数以及后台处理表和跟踪表中的项数来衡量。 队列包括工作队列、 状态队列和挂起的队列。 如果要将某一进程发布到多个队列，则此计数器将反映所有队列的加权平均值。  

 如果重新启动该主机，则内存中保留的统计信息将丢失。 由于涉及一些系统开销，则 BizTalk Server 会恢复收集统计信息，仅当有至少 100 发布，其中 5%的总会发布在重新启动的主机进程内。  

 此计数器将设置为值 1，如果任何一个条件为数据库阈值中的消息计数列出发生。 在本主题将介绍此阈值如何修改默认主机阻止设置下面引用。 默认情况下主机消息阻止阈值的数据库中的计数设置为 50000，会触发在下列情况下的在触发阻止条件的值：  

- 主机实例发布到订阅主机的工作、状态和已挂起队列的消息总数超过 50,000。  

- 后台处理表或跟踪表中的消息数超过 500,000。  

  由于挂起的消息包括在数据库计算中的消息计数，阻止消息发布即使 BizTalk 服务器很低或没有负载会出现。  

  此分析检查的值为 1。 如果发生这种情况，请考虑将减少数据库中的消息的数目的操作过程。 例如，确保 BizTalk SQL Server 作业正在运行不会出错并在 BizTalk 管理控制台中使用组中心确定消息逐渐累积引起大量挂起消息。  

### <a name="references"></a>References  

-   挂起的消息包括在数据库限制阈值中的消息计数 [http://go.microsoft.com/fwlink/?LinkId=155304](http://go.microsoft.com/fwlink/?LinkId=155304)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

## <a name="biztalk-high-in-process-message-count-analysis"></a>BizTalk 高进程内消息计数分析  
 主机阻止设置中的"进程内消息数 CPU"设置为的最大未处理的消息传送到端点管理器 (EPM) 或 XLANG 数。 此数值不包括从数据库但仍正在等待传递在内存中队列中检索的消息。 可以使用 biztalk: Message Agent 性能对象类别下的 in-process message count 性能计数器来监视进程内消息数。 考虑阻止条件时，此参数提供了阻止机制提示。 实际阈值可能会自我优化。 通过监视进程内消息计数性能计数器，可以验证实际的阈值。  

 此参数可以设置为较小的值对于大消息方案，其中平均消息大小较大或消息的处理可能需要大量的消息。 这将变得显而易见，如果过于频繁基于内存的限制和内存阈值获取自动调整为大体上低的值。 这样将指示出站传输应降低同时处理的消息数以避免占用过高内存。 此外，如果适配器一次处理多个消息（例如在向限制并行连接数的服务器发送消息时）可获得更高效率，则可以将此参数优化为低于默认值的值。  

 此分析检查高进程内消息计数计数器来确定是否发生这种类型的限制。 如果是这样，请考虑调整"每 CPU 消息进程内"设置。 此参数只影响出站消息阻止功能。 在"进程内消息数 CPU"设置禁用基于每 CPU 的进程内消息数的阻止功能中输入值为 0。 "进程内消息数 CPU"设置的默认值为 1000。 请注意，修改此值可能还会影响在低延迟的消息和/或 BizTalk 资源的效率。  

### <a name="references"></a>References  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

## <a name="biztalk-high-message-delivery-rate-analysis"></a>BizTalk 高消息送达速率分析  
 对于出站 （送达的） 消息，BizTalk Server 将阻止消息的送达如果主机实例的消息送达传入速率超出消息送达传出速率 * 指定的速率加速因子 （百分比） 值。 在消息处理阻止设置对话框上，速率加速因子 （百分比） 参数进行配置。 对出站消息的基于速率的阻止主要是通过将引入从内存中队列中删除消息并将消息送达端点管理器 (EPM) 或业务流程引擎进行处理之前延迟实现。 不执行任何其他操作，以实现对出站消息的基于速率的阻止。  

 出站阻止可能导致消息送达延迟，消息可能会在内存中队列中堆积，并可能导致出列线程被阻止，直到阻止条件得以缓解。 当出列线程被阻止，任何额外的消息从 MessageBox 中提取到的内存中队列的出站送达。  

 此分析检查的值为 1 高消息送达速率计数器中。 高消息送达速率可能引起高处理复杂性、 出站适配器速度缓慢或系统资源出现暂时短缺。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

## <a name="biztalk-high-process-memory-analysis"></a>BizTalk 高进程内存分析  
 限制阈值设置 BizTalk 进程内存使用情况是内存的相比工作集大小和可用虚拟内存总量的进程的总和，如果输入一个介于 1 和 100 之间使用百分比。 默认情况下，BizTalk 进程内存使用情况限制设置为 25。 在指定百分比值时，将按固定的时间间隔来重新计算进程内存阈值。 如果用户指定一个百分比值，它是根据计算为提交和当前进程内存使用情况的可用内存。  

 此分析检查 1 中的较高的进程内存计数器的值。 如果发生这种情况，请尝试使用调试诊断工具来确定内存增加的原因 （请参阅内存泄漏检测分析中的引用）。 请注意，为其正常的进程来启动和此过程中占用内存有很大一部分可能最初显示为内存泄漏，但进程无法释放不再需要因此我减少可用的量的内存会发生的真正的内存泄漏随着时间的推移 mory。 有关如何以一般方式分析 BizTalk 中的进程内存泄漏，请参阅下面的"如何为捕获内存转储的进程的是，正在泄漏内存"引用和/或"内存泄漏检测"分析 PAL 中的详细信息。  

 如果要发布的批处理具有很高的内存要求高的进程内存限制可能发生或过多的线程所处理的消息。  如果系统表现为过度阻止，请考虑增大与主机进程内存使用情况阈值的值，并验证主机实例不会生成"内存不足"错误。 如果通过增加进程内存使用阈值引发"内存不足"错误，请考虑减小内部消息队列大小的值，并且进程内消息数每 CPU 阈值。 此策略特别适用于大型消息处理方案。 此外，此值应设置为较低的值为具有较大内存要求每个消息的方案。 设置较低的值将进入在早期限制和阻止在进程内的内存分解。  

 如果您的 BizTalk server 定期运行虚拟内存不足，请考虑 BizTalk Server 64 位。 在 64 位服务器上的每个进程可以解决最多 4 TB 的虚拟内存中的 2 GB 的 32 位的。 一般情况下，强烈建议 64 位 BizTalk 和 64 位 SQL Server。 请参阅"BizTalk Server 64 位支持"参考的详细信息。  

### <a name="references"></a>References  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

-   如何捕获泄漏内存的进程的内存转储 [http://go.microsoft.com/fwlink/?LinkId=155305](http://go.microsoft.com/fwlink/?LinkId=155305)  

-   在 BizTalk Server 64 位支持 [http://go.microsoft.com/fwlink/?LinkId=155306](http://go.microsoft.com/fwlink/?LinkId=155306)  

## <a name="biztalk-high-system-memory-analysis"></a>BizTalk 高系统内存分析  
 BizTalk 物理内存使用情况限制阈值设置为输入内存消耗与从 1 到 100 之间的如果值可用的物理内存总量的百分比。 如果输入大于 100 的值，此设置也可以是以兆字节表示的可用物理内存的总量。 输入值 0 可以禁用基于物理内存使用率的阻止功能。 默认值为 0。  

 此分析检查 1 中的较高的系统内存计数器的值。 由于这样将度量系统内存总量，因此如果非 BizTalk Server 进程占用过多的系统内存，则可能会触发阻止条件。 因此如果发生这种情况，最好的方法是确定哪些进程正在使用的大多数物理内存和/或向服务器添加额外的物理内存。 此外，请考虑通过减少 EPM 线程池的默认大小和/或适配器批的大小来减少负载。 有关详细信息，请参阅 PAL 中的内存泄漏检测分析。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

## <a name="biztalk-high-thread-count-analysis"></a>BizTalk 高线程计数分析  
 "每 CPU 线程数"是包括线程使用的适配器的主机进程中线程的总数。 如果超过此阈值时，BizTalk Server 将尝试减小 EPM 线程池和消息代理线程池的大小。 如果高负载可能导致创建大量线程，则在这种情况下，应启用基于线程的阻止功能。 此参数同时影响入站和出站阻止功能。 默认情况下禁用基于线程的阻止功能。  

> [!NOTE]  
>  用户指定的值用作一般准则，并且主机动态地自行调整此阈值基于内存使用模式和进程的线程要求。  

 此分析检查值为高 Thread Count 计数器中为 1。 考虑调整不同线程池的大小，以确保系统不会创建大量线程。 每个第二个分析，以确定是否使用过多的线程，但在操作系统处于满负荷状态大多数情况下，高的线程计数原因比 BizTalk server 上的后端数据库上的更多争用，可以与上下文切换相关此分析。 有关修改线程池大小的详细信息请参阅如何修改默认主机阻止设置在引用中。  

### <a name="references"></a>References  

- 主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

- BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

- 如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

- 影响适配器性能的配置参数 [http://go.microsoft.com/fwlink/?LinkID=154200](http://go.microsoft.com/fwlink/?LinkID=154200)  

- 线程、 数据库会话和在限制 [http://go.microsoft.com/fwlink/?linkid=106793](http://go.microsoft.com/fwlink/?linkid=106793)  

  BizTalk 的入站延迟 AnalysisAverage 滞后时间自消息引擎文档从接收适配器发布到消息框之前的毫秒。 减少滞后时间是 BizTalk 中，某些用户重要因此跟踪时间的文档所用的入站适配器中的量是很重要。  

  下面是一个显示如何测量滞后时间的图表。  

|@shouldalert|2|3|4|5|6|  
|-------|-------|-------|-------|-------|-------|  
|适配器接收消息并将提交到引擎之前都在消息引擎不在适配器中完成的工作中这些性能计数器捕获|引擎从适配器接收消息，执行接收管道、 映射、 订阅评估，保留 DB 中的消息。|业务流程或要求响应端口将运行并生成响应消息。|响应消息在消息引擎中取消排队、 执行发送管道和映射。|消息引擎将响应消息提供给适配器。|适配器通知引擎消息都是。|  
||I|||||  
||RR|RR|RR|||  
||||O|O|O|  
|||||OA|OA|  

 我 = 入站的延迟  

 RR = 请求响应延迟  

 O = 出站延迟  

 OA = 出站适配器延迟  

 假设低延迟环境，此分析会检查文档是否花费时间超过 5 秒入站适配器中。 这可能指示在传输中，通过此主机实例中的入站适配器的消息的处理延迟。 如果此主机实例中存在多个入站的适配器，请考虑将它们分散到其自己的主机以确定哪个入站的适配器的高延迟。  

### <a name="references"></a>References  

-   BizTalk Server 数据库优化  
    [http://go.microsoft.com/fwlink/?linkid=104427](http://go.microsoft.com/fwlink/?linkid=104427)  

-   请求/响应消息传送  
    [http://go.microsoft.com/fwlink/?LinkID=155288](http://go.microsoft.com/fwlink/?LinkID=155288)  

-   确定 BizTalk 层的瓶颈  
    [http://go.microsoft.com/fwlink/?LinkID=155289](http://go.microsoft.com/fwlink/?LinkID=155289)  

## <a name="biztalk-message-delivery-throttling-state-analysis"></a>BizTalk 消息传递限制状态分析  
 BizTalk 消息传递阻止状态是主要指标，限制之一。 它是指示系统是否要阻止消息送达 （影响 XLANG 消息处理和出站传输） 的标志。 由计数器的数值指示阻止条件。 下面是一系列的值和其各自的含义：  

|||  
|-|-|  
|0|不限制|  
|@shouldalert|由于消息送达速率不匹配（输入速率超出输出速率）而阻止|  
|3|由于进程内消息数过高而阻止|  
|4|由于进程内存压力而阻止|  
|5|由于系统内存压力而阻止|  
|9|由于线程数过高而阻止|  
|10|由于送达时的用户替代而阻止|  

 此分析检查每个值，并为每个具有特定的警报。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

## <a name="biztalk-messagebox-database-connection-failures-analysis"></a>BizTalk MessageBox 数据库连接故障分析  
 此性能计数器是数据库连接尝试失败，因为启动主机实例的数目。 如果出于任何原因，承载 BizTalk 数据库的 SQL Server 服务将变得不可用，则数据库群集会将资源从主动计算机传输到被动计算机。 在此故障转移过程中，BizTalk Server 服务实例会遇到数据库连接失败，这些实例将自动重新启动以重新连接到数据库。 采用故障转移期间传输的资源后，正在运行的数据库计算机（即前面提到的被动计算机）将开始处理数据库连接。  

 当 BizTalk Server 运行时无法与 MessageBox 或管理数据库进行通信时，将出现 DBNetLib （数据库网络库） 错误。 此操作时，会捕获此异常的 BizTalk Server 运行时实例将关闭，然后循环每隔一分钟进行检查，请参阅数据库是否可用。 有关此主题，请参阅详细信息的参考资料部分。  

 当客户端启动到服务器的 TCP/IP 套接字连接时，客户端通常连接到服务器上的特定端口，并请求服务器通过临时（或暂时）TCP 或 UDP 端口进行响应。 在 Windows Server 2003 和 Windows XP 上，客户端应用程序使用的临时端口的默认范围是从 1025 到 5000。 在某些情况下，很可能会耗尽默认范围内的可用端口。 有关此主题，请参阅详细信息的参考资料部分。  

 此分析会检查数据库连接失败的任何匹配项。 数据库连接失败十分重要，因为 BizTalk 将不能没有数据库。 如果数据库连接失败的原因是未知的然后请考虑下面列出的引用和/或联系 Microsoft 支持部门以确定连接故障的性质。  

### <a name="references"></a>References  

-   向外扩展数据库  
    [http://go.microsoft.com/fwlink/?LinkId=155307](http://go.microsoft.com/fwlink/?LinkId=155307)  

-   避免出现 DBNETLIB 异常  
    [http://go.microsoft.com/fwlink/?LinkId=155308](http://go.microsoft.com/fwlink/?LinkId=155308)  

-   避免 TCP/IP 端口耗尽的情况  
    [http://go.microsoft.com/fwlink/?LinkId=155309](http://go.microsoft.com/fwlink/?LinkId=155309)  

## <a name="biztalk-messaging-publishing-throttling-state-analysis"></a>BizTalk 消息发布阻止状态分析  
 BizTalk 消息发布阻止状态是主要指标，限制之一。 它是指示系统是否要阻止消息发布 （影响 XLANG 消息处理和入站的传输） 的标志。由计数器的数值指示阻止条件。 下面是一系列的值和其各自的含义：  

|||  
|-|-|  
|0|不限制|  
|2|由于消息发布速率不匹配（输入速率超出输出速率）而阻止|  
|4|由于进程内存压力而阻止|  
|5|由于系统内存压力而阻止|  
|6|由于数据库增长而阻止|  
|8|由于会话数过高而阻止|  
|9|由于线程数过高而阻止|  
|11|由于发布时的用户替代而阻止|  

 此分析检查每个值，并为每个具有特定的警报。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

## <a name="biztalk-orchestrations-resident-in-memory"></a>在内存中驻留在 BizTalk 业务流程  
 当前以主机实例为宿主的业务流程实例的数量。 峰值或激增的业务流程驻留在内存中可能会被视为正常，为增长趋势可能指示"积累"的内存中的业务流程。 当 BizTalk 无法冻结业务流程消息/实例时，可能会出现随着时间的推移为增长趋势。 尝试将此计数器与"XLANG/s Orchestrations(?) 相关联\Dehydratable 业务流程"问号 （？） 所在相同作为此计数器的计数器实例。  

 如果大量的业务流程都驻留在内存中的和如果较低数目的业务流程都是可冻结，则您的业务流程有可能在内存中处于空闲状态，并且可能导致内存泄漏情况。 如果存在，请使用此分析中与"\XLANG/s 业务流程 （*） \Idle 业务流程"的关联。 BizTalk 空闲业务流程中的为增长趋势是更好的内存泄漏，因为无法冻结的业务流程实例的指标。  

 此分析检查驻留在内存和超过 50%的驻留在内存中的业务流程是否可冻结业务流程中为增长趋势。  

### <a name="references"></a>References  

-   业务流程引擎性能计数器  
    [http://go.microsoft.com/fwlink/?LinkID=155290](http://go.microsoft.com/fwlink/?LinkID=155290)  

-   业务流程冻结和解除冻结  
    [http://go.microsoft.com/fwlink/?LinkID=155284](http://go.microsoft.com/fwlink/?LinkID=155284)  

## <a name="biztalk-private-bytes-analysis"></a>BizTalk 专用字节分析  
 这是个主机实例和类似于"\Process （*） \Private 字节数"性能计数器分配的专用内存兆字节。 专用字节数是内存的当前大小 （字节） 进程已分配不能与其他进程共享。 此分析确定是否任何主机实例正在使用较大的系统的内存和是否在内存使用量随时间增加的主机实例。 只要它返回到系统内存，占用大量内存的主机实例是没问题。 查找增加图表中的趋势。 长的一段时间内为增长趋势可能指示内存泄漏。  

 此分析检查每小时 10 MB 的增长趋势。 使用此分析中使用的可用内存分析和内存泄漏分析相关。 此外，请注意，新启动主机实例将最初显示为内存泄漏时只需正常启动行为。 当一个过程会一直消耗内存和长的一段时间内没有释放内存时，内存泄漏。 如果您怀疑内存泄漏情况，然后阅读下面引用的"内存增长中 BizTalk 消息传送"一文。 否则为安装并使用调试诊断工具工具。 调试诊断工具的详细信息，请参阅参考部分。  

### <a name="references"></a>References  

-   调试诊断工具 1.1 版  
    [http://go.microsoft.com/fwlink/?linkid=106784](http://go.microsoft.com/fwlink/?linkid=106784)  

-   在 BizTalk 消息传送的内存增长  
    [http://go.microsoft.com/fwlink/?linkid=108788](http://go.microsoft.com/fwlink/?linkid=108788)  

## <a name="biztalk-virtual-bytes-analysis"></a>BizTalk 虚拟字节分析  
 这是适用于主机实例的虚拟内存保留的兆字节。 此分析确定的任何主机实例是否消耗大量系统的内存，并在主机实例是否在内存使用量随时间增加。 只要它返回到系统内存，占用大量内存的主机实例是没问题。 查找增加图表中的趋势。 长的一段时间内为增长趋势可能指示内存泄漏。  

 此分析检查以虚拟字节为单位按小时 10 MB 的增长趋势。 使用此分析中使用的可用内存分析和内存泄漏分析相关。 此外，请注意，新启动主机实例将最初显示为内存泄漏时只需正常启动行为。 当一个过程会一直消耗内存和长的一段时间内没有释放内存时，内存泄漏。 如果您怀疑内存泄漏情况，然后读取以下"内存增长中 BizTalk 消息传送"文章。 否则为安装并使用调试诊断工具工具。 调试诊断工具的详细信息，请参阅参考部分。  

### <a name="references"></a>References  

-   调试诊断工具 1.1 版  
    [http://go.microsoft.com/fwlink/?linkid=106784](http://go.microsoft.com/fwlink/?linkid=106784)  

-   在 BizTalk 消息传送的内存增长  
    [http://go.microsoft.com/fwlink/?linkid=108788](http://go.microsoft.com/fwlink/?linkid=108788)  

## <a name="biztalk-message-agent-database-session-throttling-analysis"></a>BizTalk 消息代理的数据库会话限制分析  
 这是与 MessageBox 相比其相应的 BizTalk 阻止设置的开放式数据库连接数。 "数据库连接每个 CPU"是阻止开始之前允许并行数据库会话 （每 CPU) 的最大数目。 此计数不包括通用的每主机会话池中的空闲数据库会话数，并且只对主机实例实际使用的会话数进行此检查。 默认情况下，此选项为禁用状态；通常，只有当数据库服务器成为 BizTalk Server 系统的瓶颈时才应启用此设置。 可以使用 biztalk: Message Agent 性能对象类别下的数据库会话性能计数器来监视活动数据库连接数。 此参数只影响出站消息阻止功能。 输入值 0 可以禁用基于数据库会话数的阻止功能。 默认值为 0。  

 MaxWorkerThreads 注册表项具有可用的 BizTalk 数字的线程的影响，可帮助在 BizTalk 的线程中的大部分忙于处理数据库连接的情况。 此分析检查到 MessageBox 的开放式数据库连接数是否大于 80%的数据库会话限制设置，这表明可能在触发阻止条件。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   影响适配器性能的配置参数 [http://go.microsoft.com/fwlink/?LinkID=154200](http://go.microsoft.com/fwlink/?LinkID=154200)  

-   线程、 数据库会话和在限制 [http://go.microsoft.com/fwlink/?linkid=106793](http://go.microsoft.com/fwlink/?linkid=106793)  

## <a name="biztalk-message-agent-database-session-throttling-threshold-analysis"></a>BizTalk 消息代理的数据库会话限制阈值分析  
 这是与 MessageBox 的开放式数据库连接数的当前阈值。 "数据库连接每个 CPU"是阻止开始之前允许并行数据库会话 （每 CPU) 的最大数目。 此计数不包括通用的每主机会话池中的空闲数据库会话数，并且只对主机实例实际使用的会话数进行此检查。 默认情况下，此选项为禁用状态；通常，只有当数据库服务器成为 BizTalk Server 系统的瓶颈时才应启用此设置。 可以使用 biztalk: Message Agent 性能对象类别下的数据库会话性能计数器来监视活动数据库连接数。 此参数只影响出站消息阻止功能。 输入值 0 可以禁用基于数据库会话数的阻止功能。 默认值为 0。  

 MaxWorkerThreads 注册表项具有可用的 BizTalk 数字的线程的影响，可帮助在 BizTalk 的线程中的大部分忙于处理数据库连接的情况。 此分析会检查此值以查看是否已被修改从其默认设置。 默认情况下，此设置是 0，表示数据库会话限制处于禁用状态。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   影响适配器性能的配置参数 [http://go.microsoft.com/fwlink/?LinkID=154200](http://go.microsoft.com/fwlink/?LinkID=154200)  

-   线程、 数据库会话和在限制 [http://go.microsoft.com/fwlink/?linkid=106793](http://go.microsoft.com/fwlink/?linkid=106793)  

## <a name="biztalk-message-agent-in-process-message-count-throttling-analysis"></a>BizTalk 消息代理进程内消息计数限制分析  
 这是服务类别正在处理的并行消息数。 主机阻止设置中的"进程内消息数 CPU"设置为的最大未处理的消息传送到端点管理器 (EPM) 或 XLANG 数。 这不包括从数据库中检索，但仍在等待内存中队列中传递的消息。 可以使用 biztalk: Message Agent 性能对象类别下的 in-process message count 性能计数器来监视进程内消息数。 此参数提供了阻止机制提示以便您考虑阻止条件。 实际阈值可能会自我优化。 通过监视 In-process message count 性能计数器，可以验证实际的阈值。  

 对于大消息方案 （其中平均消息大小较大或消息的处理可能需要大量的消息），此参数可以设置为较小的值。 如果频繁出现基于内存的限制和内存阈值获取自动调整为大体上低的值指示大消息方案。 这样将指示出站传输应降低同时处理的消息数以避免占用过高内存。 此外，如果适配器一次处理多个消息（例如在向限制并行连接数的服务器发送消息时）可获得更高效率，则可以将此参数优化为低于默认值的值。 此分析检查高进程内消息计数计数器来确定它大于 80%的同一名称下其限制设置，指示在触发阻止条件是否有可能。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

## <a name="biztalkmessage-agent-in-process-message-count-throttling-threshold-analysis"></a>Biztalk: Message 代理进程内消息数阻止阈值分析  
 这是服务类别正在处理的并行消息数的当前阈值。 主机阻止设置中的"进程内消息数 CPU"设置为的最大未处理的消息传送到端点管理器 (EPM) 或 XLANG 数。 这不包括从数据库中检索，但仍在等待内存中队列中传递的消息。 可以使用 biztalk: Message Agent 性能对象类别下的 in-process message count 性能计数器来监视进程内消息数。 此参数提供了阻止机制提示以便您考虑阻止条件。 实际阈值可能会自我优化。 通过监视 In-process message count 性能计数器，可以验证实际的阈值。  

 对于大消息方案 （其中平均消息大小较大或消息的处理可能需要大量的消息），此参数可以设置为较小的值。 如果频繁出现基于内存的限制和内存阈值获取自动调整为大体上低的值指示大消息方案。 这样将指示出站传输应降低同时处理的消息数以避免占用过高内存。 此外，如果适配器一次处理多个消息（例如在向限制并行连接数的服务器发送消息时）可获得更高效率，则可以将此参数优化为低于默认值的值。 此分析检查高进程内消息计数限制阈值为非默认值。  

### <a name="references"></a>References  

-   主机阻止性能计数器 [http://go.microsoft.com/fwlink/?LinkID=155285](http://go.microsoft.com/fwlink/?LinkID=155285)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

## <a name="biztalk-message-agent-process-memory-usage-mb-throttling-analysis"></a>BizTalk 消息代理进程内存使用率 (MB) 限制分析  
 这是当前进程 (MB) 的内存使用情况。 如果要发布的批处理具有很高的内存要求，或者过多的线程所处理的消息，则会出现 BizTalk 进程内存的阻止功能。  如果系统表现为过度阻止，请考虑增大与主机进程内存使用情况阈值的值，并验证主机实例不会生成"内存不足"错误。 如果通过增加进程内存使用阈值引发"内存不足"错误，请考虑减小内部消息队列大小的值，并且进程内消息数每 CPU 阈值。 此策略特别适用于大型消息处理方案。  

 如果您的 BizTalk server 定期运行虚拟内存不足，请考虑 BizTalk Server 64 位。 在 64 位服务器上的每个进程可以解决最多 4 TB 的虚拟内存中的 2 GB 的 32 位的。 一般情况下，强烈建议 64 位 BizTalk 和 64 位 SQL Server。 请参阅"BizTalk Server 64 位支持"参考的详细信息。 此分析会检查是否进程内存使用率大于 80%的相同的名称及其相应限制阈值。 默认情况下，BizTalk 进程内存使用情况限制设置为可用于进程的虚拟内存的 25%。 /3GB 开关对此设置无效。  

### <a name="references"></a>References  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

-   如何捕获泄漏内存的进程的内存转储 [http://go.microsoft.com/fwlink/?LinkId=155305](http://go.microsoft.com/fwlink/?LinkId=155305)  

-   在 BizTalk Server 64 位支持 [http://go.microsoft.com/fwlink/?LinkId=155306](http://go.microsoft.com/fwlink/?LinkId=155306)  

## <a name="biztalkmessage-agent-process-memory-usage-mb-throttling-threshold-analysis"></a>Biztalk： 消息代理进程内存使用率 (MB) 限制阈值分析  
 这是当前进程 (MB) 的内存使用量的当前阈值。 可能会动态调整阈值，具体取决于实际的于此进程及其内存占用模式可用内存量。 如果要发布的批处理具有很高的内存要求，或者过多的线程所处理的消息，则会出现 BizTalk 进程内存的阻止功能。 如果系统表现为过度阻止，请考虑增大与主机进程内存使用情况阈值的值，并验证主机实例不会生成"内存不足"错误。 如果通过增加进程内存使用阈值引发"内存不足"错误，请考虑减小内部消息队列大小的值，并且进程内消息数每 CPU 阈值。 此策略特别适用于大型消息处理方案。  

 如果您的 BizTalk server 定期运行虚拟内存不足，请考虑 BizTalk Server 64 位。 在 64 位服务器上的每个进程可以解决最多 4 TB 的虚拟内存中的 2 GB 的 32 位的。 一般情况下，强烈建议 64 位 BizTalk 和 64 位 SQL Server。 请参阅"BizTalk Server 64 位支持"参考的详细信息。 此分析会检查是否为非默认值设置进程内存的阻止功能。  

### <a name="references"></a>References  

-   BizTalk Server 如何实现主机阻止在 [http://go.microsoft.com/fwlink/?LinkID=155286](http://go.microsoft.com/fwlink/?LinkID=155286)  

-   如何修改默认主机阻止设置 [http://go.microsoft.com/fwlink/?LinkID=155296](http://go.microsoft.com/fwlink/?LinkID=155296)  

-   如何捕获泄漏内存的进程的内存转储 [http://go.microsoft.com/fwlink/?LinkId=155305](http://go.microsoft.com/fwlink/?LinkId=155305)  

-   在 BizTalk Server 64 位支持 [http://go.microsoft.com/fwlink/?LinkId=155306](http://go.microsoft.com/fwlink/?LinkId=155306)