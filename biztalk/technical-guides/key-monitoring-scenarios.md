---
title: 主要监视方案 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: fee90fd2-fb85-409f-827e-6ee3c8e13b4c
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 70c13588f37a262e52870dff8c99762bd3fd5aa5
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65391863"
---
# <a name="key-monitoring-scenarios"></a><span data-ttu-id="d70b2-102">主要监视方案</span><span class="sxs-lookup"><span data-stu-id="d70b2-102">Key Monitoring Scenarios</span></span>
<span data-ttu-id="d70b2-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Operations Manager 2007 R2/2012年的管理包包括多种主要监视方案中后面的表中所述。</span><span class="sxs-lookup"><span data-stu-id="d70b2-103">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Management Pack for Operations Manager 2007 R2/2012 includes a number of key monitoring scenarios described in the table that follows.</span></span>  
  
### <a name="biztalk-server-monitoring-scenarios"></a><span data-ttu-id="d70b2-104">BizTalk Server 监视方案</span><span class="sxs-lookup"><span data-stu-id="d70b2-104">BizTalk Server Monitoring Scenarios</span></span>  
  
|<span data-ttu-id="d70b2-105">应用场景</span><span class="sxs-lookup"><span data-stu-id="d70b2-105">Scenario</span></span>|<span data-ttu-id="d70b2-106">Description</span><span class="sxs-lookup"><span data-stu-id="d70b2-106">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="d70b2-107">挂起的消息警报</span><span class="sxs-lookup"><span data-stu-id="d70b2-107">Suspended Message Alerts</span></span>|<span data-ttu-id="d70b2-108">监视和解决与挂起的消息相关的问题是 BizTalk Server 环境中常见的操作任务。</span><span class="sxs-lookup"><span data-stu-id="d70b2-108">Monitoring and resolving issues related to suspended messages are common operational tasks in a BizTalk Server environment.</span></span> <span data-ttu-id="d70b2-109">BizTalk Server 管理包可监视和挂起的消息事件进行疑难解答的简化方式。</span><span class="sxs-lookup"><span data-stu-id="d70b2-109">The BizTalk Server Management Pack enables you to monitor and troubleshoot suspended message events in a streamlined way.</span></span> <span data-ttu-id="d70b2-110">处理消息时，在 BizTalk Server 中发生两种类型的消息挂起：入站消息挂起和出站消息挂起。</span><span class="sxs-lookup"><span data-stu-id="d70b2-110">Two kinds of message suspension occur in BizTalk Server when you process messages: Inbound Message Suspension and Outbound Message Suspension.</span></span><br /><br /> <span data-ttu-id="d70b2-111">对于入站消息，各种类型的处理失败或订阅缺失都可能会导致消息挂起。</span><span class="sxs-lookup"><span data-stu-id="d70b2-111">For inbound messages, various kinds of processing failures or lack of subscription may cause a message to be suspended.</span></span> <span data-ttu-id="d70b2-112">可以配置某些传输方式挂起消息或挂起消息。</span><span class="sxs-lookup"><span data-stu-id="d70b2-112">Some transports can be configured to suspend the message or not suspend the message.</span></span> <span data-ttu-id="d70b2-113">对于出站消息，所有处理失败将始终都导致消息挂起。</span><span class="sxs-lookup"><span data-stu-id="d70b2-113">For outbound messages, all processing failures will always lead to message suspension.</span></span><br /><br /> <span data-ttu-id="d70b2-114">对于入站消息挂起警报规则是每个适配器编写的。</span><span class="sxs-lookup"><span data-stu-id="d70b2-114">For inbound messages, alert rules for suspension are written per adapter.</span></span> <span data-ttu-id="d70b2-115">此方法提供了更灵活地处理入站方向的消息挂起。</span><span class="sxs-lookup"><span data-stu-id="d70b2-115">This approach provides more flexibility in handling message suspensions on the inbound side.</span></span> <span data-ttu-id="d70b2-116">您可以添加适配器，例如通知上基于不同的响应操作。</span><span class="sxs-lookup"><span data-stu-id="d70b2-116">You can add different response actions based on the adapter, such as notification.</span></span> <span data-ttu-id="d70b2-117">此外，您可以通过创建自定义规则来定制 BizTalk Server 管理包。</span><span class="sxs-lookup"><span data-stu-id="d70b2-117">You can additionally customize the BizTalk Server Management Pack by creating custom rules.</span></span> <span data-ttu-id="d70b2-118">对于出站消息，任何类型的传输时间失败时始终挂起所有消息。</span><span class="sxs-lookup"><span data-stu-id="d70b2-118">For outbound messages, all messages are always suspended on transmission time failure of any kind.</span></span>|  
|<span data-ttu-id="d70b2-119">警报取消策略</span><span class="sxs-lookup"><span data-stu-id="d70b2-119">Alert Suppression Policy</span></span>|<span data-ttu-id="d70b2-120">挂起的消息的规则使用不同的抑制策略比通常应用于其他规则。</span><span class="sxs-lookup"><span data-stu-id="d70b2-120">Rules for suspended messages employ a different suppression policy than are generally applied for other rules.</span></span> <span data-ttu-id="d70b2-121">警报将被抑制基于警报名称、 警报源以及计算机和域。</span><span class="sxs-lookup"><span data-stu-id="d70b2-121">Alerts are suppressed based the Alert Name, Alert Source, and Computer and Domain.</span></span><br /><br /> <span data-ttu-id="d70b2-122">禁止显示功能基于警报源，每个挂起的消息规则的警报源还包含从挂起的消息事件中提取的参数。</span><span class="sxs-lookup"><span data-stu-id="d70b2-122">For suppression based on Alert Source, the alert source for each suspended message rule also contains a parameter extracted from the suspended message event.</span></span> <span data-ttu-id="d70b2-123">此参数是该消息已接收或传输的 URI。</span><span class="sxs-lookup"><span data-stu-id="d70b2-123">This parameter is the URI on which the message was received or transmitted.</span></span><br /><br /> <span data-ttu-id="d70b2-124">由于同一原因通常是相同的 URI 上发生的错误。</span><span class="sxs-lookup"><span data-stu-id="d70b2-124">Errors that occur on the same URI are usually because of the same reason.</span></span> <span data-ttu-id="d70b2-125">因此，我们建议创建单个警报的相同的根本原因，即使存在多个相关的失败事件。</span><span class="sxs-lookup"><span data-stu-id="d70b2-125">Therefore, we recommend that you create a single alert for the same root cause even though multiple associated failure events exist.</span></span> <span data-ttu-id="d70b2-126">这使你能够在某一警报，一个根本原因，使你更轻松地解决问题发生时。</span><span class="sxs-lookup"><span data-stu-id="d70b2-126">This enables you to have one alert and one root cause that makes it easier for you to correct problems when they occur.</span></span> <span data-ttu-id="d70b2-127">基于 Uri 的流程化的警报减少不必要警报，并促进有效地跟踪待解决问题。</span><span class="sxs-lookup"><span data-stu-id="d70b2-127">Streamlined alerts, based on URIs, reduce unnecessary alerts and facilitate efficient tracking of open issues.</span></span> <span data-ttu-id="d70b2-128">为消息挂起以前没有挂起警报某个 URI 处创建一个新警报。</span><span class="sxs-lookup"><span data-stu-id="d70b2-128">A new alert is created for a message suspension at a URI with no previous suspension alerts.</span></span>|  
|<span data-ttu-id="d70b2-129">BAM 技术协助警报</span><span class="sxs-lookup"><span data-stu-id="d70b2-129">BAM Technical Assistance Alerts</span></span>|<span data-ttu-id="d70b2-130">业务活动监视 (BAM) 门户用户，称为业务用户通常了解的业务级别指标和业务活动。</span><span class="sxs-lookup"><span data-stu-id="d70b2-130">Business Activity Monitoring (BAM) Portal users, known as business users, usually understand the business level indicators and business activities.</span></span> <span data-ttu-id="d70b2-131">使用监视器聚合指标，完成进程内业务事务或搜索具有特定属性的事务到 BAM 门户，若要进一步调查。</span><span class="sxs-lookup"><span data-stu-id="d70b2-131">They use BAM Portal to monitor aggregate indicators, complete in-process business transactions, or search for transactions with particular properties to investigate further.</span></span> <span data-ttu-id="d70b2-132">但是，业务用户通常不了解 IT 基础结构级别时出现问题的方面。</span><span class="sxs-lookup"><span data-stu-id="d70b2-132">However, business users often do not understand the aspects of an issue at an IT infrastructure level.</span></span> <span data-ttu-id="d70b2-133">在给定的事务的调查，BAM 门户，业务用户可以从 IT 操作人员进行调查 IT 基础结构级事务的请求技术协助。</span><span class="sxs-lookup"><span data-stu-id="d70b2-133">During investigation of a given transaction, the BAM Portal enables business users to request technical assistance from the IT Operations staff to investigate transactions at the IT infrastructure level.</span></span><br /><br /> <span data-ttu-id="d70b2-134">BAM 门户，此提交从商业用户通过技术协助请求。</span><span class="sxs-lookup"><span data-stu-id="d70b2-134">The BAM Portal enables this hand-off from the business user through a Technical Assistance request.</span></span> <span data-ttu-id="d70b2-135">发送技术协助请求的应用程序日志中的 BAM 门户所在的计算机的事件查看器中创建一个条目。</span><span class="sxs-lookup"><span data-stu-id="d70b2-135">Requesting technical assistance creates an entry in the Application log in Event Viewer of the computer where the BAM Portal is hosted.</span></span> <span data-ttu-id="d70b2-136">此事件包含的活动的技术协助请求的用户和其他重要信息，例如消息实例标识符、 服务实例标识符和 BizTalk Server 组信息的详细信息。</span><span class="sxs-lookup"><span data-stu-id="d70b2-136">This event contains details about the activity on which technical assistance is requested by the user and other important information, such as the Message Instance Identifier, Service Instance Identifier, and BizTalk Server group information.</span></span><br /><br /> <span data-ttu-id="d70b2-137">BizTalk Server 管理包包含规则触发上检测到 BAM 技术协助事件的警报。</span><span class="sxs-lookup"><span data-stu-id="d70b2-137">The BizTalk Server Management Pack contains a rule to trigger an alert on detection of a BAM Technical Assistance event.</span></span> <span data-ttu-id="d70b2-138">创建此警报的规则是"错误：BAM 技术协助。"</span><span class="sxs-lookup"><span data-stu-id="d70b2-138">The rule that creates this alert is “Error: BAM Technical Assistance Required.”</span></span> <span data-ttu-id="d70b2-139">对于从 BAM 门户提交的每个请求创建一个新警报。</span><span class="sxs-lookup"><span data-stu-id="d70b2-139">A new alert is created for each request submitted from the BAM Portal.</span></span>|  
|<span data-ttu-id="d70b2-140">BizTalk Messagebox 和主机</span><span class="sxs-lookup"><span data-stu-id="d70b2-140">BizTalk Message Boxes and Hosts</span></span>|<span data-ttu-id="d70b2-141">BizTalk Server 管理包集成了性能阈值规则的数据库和队列提供的 BizTalk MessageBox 的运行状况的综合视图。</span><span class="sxs-lookup"><span data-stu-id="d70b2-141">BizTalk Server Management Pack incorporates performance threshold rules that provide a comprehensive view of the health of the BizTalk MessageBox databases and queues.</span></span> <span data-ttu-id="d70b2-142">提供两种类型的阈值规则：</span><span class="sxs-lookup"><span data-stu-id="d70b2-142">Two kinds of threshold rules are provided:</span></span><br /><br /> <span data-ttu-id="d70b2-143">-适用于的规则以一般方式，即，所有 BizTalk 主机和所有 BizTalk MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="d70b2-143">-   Rules that apply generically, that is, to all BizTalk Hosts, all BizTalk MessageBox databases.</span></span><br /><span data-ttu-id="d70b2-144">-特定于特定的 BizTalk 主机或 MessageBox 的规则。</span><span class="sxs-lookup"><span data-stu-id="d70b2-144">-   Rules that are specific to a particular BizTalk Host or a MessageBox.</span></span><br /><br /> <span data-ttu-id="d70b2-145">一般的规则监视所有 BizTalk Server 主机或 MessageBox 数据库基于通用阈值。</span><span class="sxs-lookup"><span data-stu-id="d70b2-145">Generic rules monitor all the BizTalk Server Hosts or MessageBox databases based on a common threshold.</span></span> <span data-ttu-id="d70b2-146">例如，规则"Monitor HostQ Size"，所有 BizTalk Server 主机的工作队列监视器基于通用阈值。</span><span class="sxs-lookup"><span data-stu-id="d70b2-146">For example, the rule “Monitor HostQ Size,” monitors the work queues of all BizTalk Server Hosts based on a common threshold.</span></span> <span data-ttu-id="d70b2-147">如果存在三个主机，其所有工作队列都监视由相同规则和任何主机工作队列超过通用阈值时将发出警报。</span><span class="sxs-lookup"><span data-stu-id="d70b2-147">If three hosts exist, all their work queues are monitored by the same rule and alerts occur when any of the host work queues cross the common threshold.</span></span><br /><br /> <span data-ttu-id="d70b2-148">BizTalk Server 主机特定的规则，可为不同的主机和 MessageBox 数据库配置不同的阈值。</span><span class="sxs-lookup"><span data-stu-id="d70b2-148">BizTalk Server host-specific rules enable you to configure different thresholds for different hosts and MessageBox databases.</span></span> <span data-ttu-id="d70b2-149">例如，规则"Monitor HostQ Size – BizTalkServerApplication"是特定于宿主的规则，用于监视 BizTalkServerApplication 主机工作队列。</span><span class="sxs-lookup"><span data-stu-id="d70b2-149">For example, the rule "Monitor HostQ Size – BizTalkServerApplication" is a host-specific rule that monitors the work queue of the BizTalkServerApplication host.</span></span> <span data-ttu-id="d70b2-150">通过定义为特定的性能计数器实例特定的 Operations Manager 提供程序和阈值规则中使用该提供程序执行此操作。</span><span class="sxs-lookup"><span data-stu-id="d70b2-150">You do this by defining a specific Operations Manager provider for the particular performance counter instance and using that provider in the threshold rule.</span></span><br /><br /> <span data-ttu-id="d70b2-151">如要用作一个指南，用于创建规则的模板规则均适用您的环境中提供了特定于 \messagebox 的规则。</span><span class="sxs-lookup"><span data-stu-id="d70b2-151">Host\MessageBox-specific rules are provided as template rules to be used as a guide for creating rules that are applicable in your environment.</span></span> <span data-ttu-id="d70b2-152">通用规则需要配置特定于环境的阈值。</span><span class="sxs-lookup"><span data-stu-id="d70b2-152">Generic rules need to be configured with threshold values specific to your environment.</span></span> <span data-ttu-id="d70b2-153">特定于 BizTalk 主机/MessageBox 的规则需要在创建基于模板规则和相应的阈值。</span><span class="sxs-lookup"><span data-stu-id="d70b2-153">BizTalk Host/MessageBox-specific rules need to be created based on the template rules and appropriate thresholds.</span></span><br /><br /> <span data-ttu-id="d70b2-154">BizTalk Server 集成了自阻止功能，这有助于防止重载基于各种参数。</span><span class="sxs-lookup"><span data-stu-id="d70b2-154">BizTalk Server incorporates self-throttling, which helps to prevent overloading based on various parameters.</span></span> <span data-ttu-id="d70b2-155">由临时重载引发的阻止不是严重问题。</span><span class="sxs-lookup"><span data-stu-id="d70b2-155">A temporary overload that causes throttling to occur is not an operationally significant event.</span></span> <span data-ttu-id="d70b2-156">持久性阻止，但是，不应出现在稳定的环境，可能表示底层基础结构级别的问题。</span><span class="sxs-lookup"><span data-stu-id="d70b2-156">Persistent throttling, however, is not expected in a stable environment and could indicate underlying problems at the infrastructure level.</span></span> <span data-ttu-id="d70b2-157">BizTalk Server 管理包提供了基于以下条件的性能阈值监视器使用主动监视此类持久性阻止条件：</span><span class="sxs-lookup"><span data-stu-id="d70b2-157">The BizTalk Server Management Pack provides proactive monitoring of such persistent throttling conditions with performance threshold monitors based on the following conditions:</span></span><br /><br /> <span data-ttu-id="d70b2-158">BizTalk Server 服务进程内存</span><span class="sxs-lookup"><span data-stu-id="d70b2-158">-   BizTalk Server service process memory</span></span><br /><span data-ttu-id="d70b2-159">-正在处理的消息数</span><span class="sxs-lookup"><span data-stu-id="d70b2-159">-   Number of messages being processed</span></span><br /><span data-ttu-id="d70b2-160">-BizTalk Server 进程中的线程数</span><span class="sxs-lookup"><span data-stu-id="d70b2-160">-   Number of threads in a BizTalk Server process</span></span><br /><span data-ttu-id="d70b2-161">的 BizTalk 数据库队列大小</span><span class="sxs-lookup"><span data-stu-id="d70b2-161">-   Size of the BizTalk database queues</span></span>|  
|<span data-ttu-id="d70b2-162">业务流程故障</span><span class="sxs-lookup"><span data-stu-id="d70b2-162">Orchestration Failures</span></span>|<span data-ttu-id="d70b2-163">监视挂起的业务流程是另一种常见方案。</span><span class="sxs-lookup"><span data-stu-id="d70b2-163">Monitoring for suspended orchestrations is another common scenario.</span></span> <span data-ttu-id="d70b2-164">包含业务流程引擎问题、.NET 组件故障以及程序逻辑的原因有很多情况下，业务流程可能会失败。</span><span class="sxs-lookup"><span data-stu-id="d70b2-164">Orchestrations can fail for many reasons that include orchestration engine problems, .NET Component failures, and program logic.</span></span> <span data-ttu-id="d70b2-165">请务必让操作员快速确定问题的来源，并继续挂起的业务流程时固定。</span><span class="sxs-lookup"><span data-stu-id="d70b2-165">It is important to enable an operator to determine the source of the problem quickly and to resume suspended orchestrations when fixed.</span></span>|  
|<span data-ttu-id="d70b2-166">服务监视</span><span class="sxs-lookup"><span data-stu-id="d70b2-166">Service Monitoring</span></span>|<span data-ttu-id="d70b2-167">BizTalk Server 需要运行多个服务才能正常运行。</span><span class="sxs-lookup"><span data-stu-id="d70b2-167">BizTalk Server requires that a number of services are running to operate correctly.</span></span> <span data-ttu-id="d70b2-168">这些服务的状态将映射到表示不同的 BizTalk 服务的类的监视器。</span><span class="sxs-lookup"><span data-stu-id="d70b2-168">The status of these services will be mapped to monitors for the classes representing the different BizTalk Services.</span></span>|  
|<span data-ttu-id="d70b2-169">应用程序监视</span><span class="sxs-lookup"><span data-stu-id="d70b2-169">Application Monitoring</span></span>|<span data-ttu-id="d70b2-170">BizTalk Server 引入了用于解决方案项目分组的应用程序的概念。</span><span class="sxs-lookup"><span data-stu-id="d70b2-170">BizTalk Server introduced the concept of an application for grouping solution artifacts.</span></span> <span data-ttu-id="d70b2-171">应用程序监视会检测应用程序级别失败造成的影响。</span><span class="sxs-lookup"><span data-stu-id="d70b2-171">Application monitoring detects effects of a failure at the application level.</span></span>|