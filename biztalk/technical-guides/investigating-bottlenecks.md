---
title: 调查瓶颈 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2ab8e485-ffe5-4f71-9ce2-f72c0c939e5d
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 35bb2b4c9d8eef862b2a0b009802b3bd5801320e
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65294809"
---
# <a name="investigating-bottlenecks"></a><span data-ttu-id="26a8b-102">调查瓶颈</span><span class="sxs-lookup"><span data-stu-id="26a8b-102">Investigating Bottlenecks</span></span>
<span data-ttu-id="26a8b-103">本主题介绍用于调查瓶颈的建议的过程。</span><span class="sxs-lookup"><span data-stu-id="26a8b-103">This topic describes a recommended process for investigating bottlenecks.</span></span>  
  
## <a name="what-is-the-source-of-the-problem"></a><span data-ttu-id="26a8b-104">问题的根源是什么？</span><span class="sxs-lookup"><span data-stu-id="26a8b-104">What is the source of the problem?</span></span>  
 <span data-ttu-id="26a8b-105">瓶颈的根源可能是硬件或软件相关。</span><span class="sxs-lookup"><span data-stu-id="26a8b-105">The source of the bottleneck could be hardware or software related.</span></span> <span data-ttu-id="26a8b-106">当资源得到充分利用时，通常是瓶颈的指示。</span><span class="sxs-lookup"><span data-stu-id="26a8b-106">When resources are underused, it is usually an indication of a bottleneck.</span></span> <span data-ttu-id="26a8b-107">通过硬件限制、 软件配置效率低下，或两者，则可能会导致瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-107">Bottlenecks can be caused by hardware limitations, by inefficient software configurations, or by both.</span></span>  
  
 <span data-ttu-id="26a8b-108">确定瓶颈是一个渐进的过程，因此缓解一个问题可能会导致下一个发现。</span><span class="sxs-lookup"><span data-stu-id="26a8b-108">Identifying bottlenecks is an incremental process whereby alleviating one bottleneck can lead to the discovery of the next one.</span></span> <span data-ttu-id="26a8b-109">本主题的目标是科学地确定和缓解这些瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-109">The science of identifying and alleviating these bottlenecks is the objective of this topic.</span></span> <span data-ttu-id="26a8b-110">很可能以峰值的时间短时间内执行的系统。</span><span class="sxs-lookup"><span data-stu-id="26a8b-110">It is possible for a system to perform at peaks for short periods of time.</span></span> <span data-ttu-id="26a8b-111">但是，为了可承受吞吐量只能作为其执行速度最慢的组件快速处理系统。</span><span class="sxs-lookup"><span data-stu-id="26a8b-111">However, for sustainable throughput a system can only process as fast as its slowest performing component.</span></span>  
  
## <a name="using-an-iterative-approach-to-testing"></a><span data-ttu-id="26a8b-112">使用测试迭代方法</span><span class="sxs-lookup"><span data-stu-id="26a8b-112">Using an iterative approach to testing</span></span>  
 <span data-ttu-id="26a8b-113">瓶颈可能的终结点 （进入/退出） 的系统或中间 （业务流程/数据库）。</span><span class="sxs-lookup"><span data-stu-id="26a8b-113">Bottlenecks can occur at the endpoints (entry/exit) of the system or in the middle (orchestration/database).</span></span> <span data-ttu-id="26a8b-114">瓶颈后，使用结构化的方法来标识源。</span><span class="sxs-lookup"><span data-stu-id="26a8b-114">After the bottleneck has been isolated, use a structured approach to identify the source.</span></span> <span data-ttu-id="26a8b-115">减轻瓶颈后，务必要测量其性能以确保，新的瓶颈不引入了其他位置在系统中。</span><span class="sxs-lookup"><span data-stu-id="26a8b-115">After the bottleneck is eased, it is important to measure performance again to ensure that a new bottleneck has not been introduced elsewhere in the system.</span></span>  
  
 <span data-ttu-id="26a8b-116">确定并修复瓶颈的过程应以迭代方式完成。</span><span class="sxs-lookup"><span data-stu-id="26a8b-116">The process of identifying and fixing bottlenecks should be done in an iterative manner.</span></span> <span data-ttu-id="26a8b-117">改变一次只有一个参数，每个测试运行期间，重复相同的步骤，然后进行衡量性能，以验证单个修改的影响。</span><span class="sxs-lookup"><span data-stu-id="26a8b-117">Vary only one parameter at a time, repeat exactly the same steps during each test run, and then measure performance to verify the impact of the single modification.</span></span> <span data-ttu-id="26a8b-118">一次变化多个参数可能会掩盖更改的效果。</span><span class="sxs-lookup"><span data-stu-id="26a8b-118">Varying more than one parameter at a time could conceal the effect of the change.</span></span>  
  
 <span data-ttu-id="26a8b-119">例如，更改参数 1 可能会提高性能。</span><span class="sxs-lookup"><span data-stu-id="26a8b-119">For example, changing parameter 1 could improve performance.</span></span> <span data-ttu-id="26a8b-120">但是，通过更改参数 1 更改了参数 2 一起使用可能造成不利影响并且抵消更改参数 1 的好处。</span><span class="sxs-lookup"><span data-stu-id="26a8b-120">However, changing parameter 2 in conjunction with changing parameter 1 could have a detrimental effect and negate the benefits of changing parameter 1.</span></span> <span data-ttu-id="26a8b-121">这会导致 net 零效果，并且会导致效果的改变参数 1 假负和假阳性上改变参数 2 的效果。</span><span class="sxs-lookup"><span data-stu-id="26a8b-121">This leads to a net zero effect and results in a false negative on the effect of varying parameter 1 and a false positive on the effect of varying parameter 2.</span></span>  
  
## <a name="testing-consistency"></a><span data-ttu-id="26a8b-122">测试一致性</span><span class="sxs-lookup"><span data-stu-id="26a8b-122">Testing consistency</span></span>  
 <span data-ttu-id="26a8b-123">应进行更改设置后测量性能有利于验证更改的效果。</span><span class="sxs-lookup"><span data-stu-id="26a8b-123">Measuring performance characteristics after changing settings should be done to validate the effect of the change.</span></span>  
  
-   <span data-ttu-id="26a8b-124">**硬件-** 使用一致的硬件，因为改变硬件可以导致不一致的行为，并产生误导性结果。</span><span class="sxs-lookup"><span data-stu-id="26a8b-124">**Hardware -** Use consistent hardware because varying the hardware can cause inconsistent behavior and produce misleading results.</span></span> <span data-ttu-id="26a8b-125">例如，不会使用一台便携式计算机来测试 BizTalk 解决方案的性能。</span><span class="sxs-lookup"><span data-stu-id="26a8b-125">For example, you would not use a laptop to test performance of a BizTalk solution.</span></span>  
  
-   <span data-ttu-id="26a8b-126">**测试运行持续时间-** 度量值的固定的最短期限以确保结果的可承受性能。</span><span class="sxs-lookup"><span data-stu-id="26a8b-126">**Test Run Duration -** Measure performance for a fixed minimum period to ensure that the results are sustainable.</span></span> <span data-ttu-id="26a8b-127">运行时间较长的测试还将确保系统已进行过初始热启动/突增期间其中填充所有缓存、 数据库表已达到预期的计数和限制足够时间进行一次调整吞吐量预定义的命中阈值。</span><span class="sxs-lookup"><span data-stu-id="26a8b-127">Running tests for longer periods also ensures the system has gone through the initial warm/ramp up period where all caches are populated, database tables have reached expected counts, and throttling is given sufficient time to regulate throughput once predefined thresholds are hit.</span></span> <span data-ttu-id="26a8b-128">此方法将有助于发现最佳可承受吞吐量。</span><span class="sxs-lookup"><span data-stu-id="26a8b-128">This approach will help discover optimal sustainable throughput.</span></span>  
  
-   <span data-ttu-id="26a8b-129">**测试参数 –** 不改变测试参数从测试运行到测试运行。</span><span class="sxs-lookup"><span data-stu-id="26a8b-129">**Test Parameters –** Do not vary test parameters from test run to test run.</span></span> <span data-ttu-id="26a8b-130">例如，改变映射复杂性和/或文档大小可能产生不同的吞吐量和延迟结果。</span><span class="sxs-lookup"><span data-stu-id="26a8b-130">For example, varying map complexity and/or document sizes can produce different throughput and latency results.</span></span>  
  
-   <span data-ttu-id="26a8b-131">**清除状态-** 测试完成后，确保在运行下一个测试之前是干净的测试环境的状态。</span><span class="sxs-lookup"><span data-stu-id="26a8b-131">**Clean State -** After a test is complete, ensure that the state of the test environment is clean before running the next test.</span></span> <span data-ttu-id="26a8b-132">例如，历史数据可以累积会影响运行时吞吐量在数据库中。</span><span class="sxs-lookup"><span data-stu-id="26a8b-132">For example, historical data can build up in the database affecting run-time throughput.</span></span> <span data-ttu-id="26a8b-133">回收服务实例有助于释放缓存的资源，例如内存、 数据库连接和线程。</span><span class="sxs-lookup"><span data-stu-id="26a8b-133">Recycling the service instances helps to release cached resources like memory, database connections, and threads.</span></span> <span data-ttu-id="26a8b-134">在测试环境中，你可能想要创建和执行 bts_CleanupMsgbox 存储过程中所述[如何从 MessageBox 数据库在测试环境中手动清除数据](http://go.microsoft.com/fwlink/?LinkId=158064)(http://go.microsoft.com/fwlink/?LinkId=158064)。</span><span class="sxs-lookup"><span data-stu-id="26a8b-134">In your test environment, you may want to create and execute the bts_CleanupMsgbox stored procedure as described in [How to Manually Purge Data from the MessageBox Database in a Test Environment](http://go.microsoft.com/fwlink/?LinkId=158064) (http://go.microsoft.com/fwlink/?LinkId=158064).</span></span> <span data-ttu-id="26a8b-135">此脚本旨在运行之间返回到全新状态与消息框的 BizTalk Server 测试环境。</span><span class="sxs-lookup"><span data-stu-id="26a8b-135">This script is intended to return your BizTalk Server test environment to a fresh state with regards to the Message Box between runs.</span></span> <span data-ttu-id="26a8b-136">该脚本删除所有正在运行的实例，并包括状态、 消息和订阅，这些实例的所有信息，但保留所有激活订阅，因此不需要重新登记业务流程或发送端口。</span><span class="sxs-lookup"><span data-stu-id="26a8b-136">The script deletes all running instances and all information about those instances including state, messages, and subscriptions, but leaves all activation subscriptions so you do not have to re-enlist your orchestrations or send ports.</span></span> <span data-ttu-id="26a8b-137">请注意，此工具不支持在生产系统上。</span><span class="sxs-lookup"><span data-stu-id="26a8b-137">Note that this tool is not supported on production systems.</span></span>  
  
-   <span data-ttu-id="26a8b-138">**性能测试和优化-** 此测试类别的目标是最大化性能和吞吐量的应用程序，并查找您的系统的最大可承受吞吐量 (MST)。</span><span class="sxs-lookup"><span data-stu-id="26a8b-138">**Performance Testing and Tuning -** The goal of this test category is to maximize performance and throughput of your application and find the Maximum Sustainable Throughput (MST) of your system.</span></span>  <span data-ttu-id="26a8b-139">有关规划和测量最大可承受性能的详细信息请参阅[规划可持续性能](http://go.microsoft.com/fwlink/?LinkId=158065)(http://go.microsoft.com/fwlink/?LinkId=158065)和[可承受性能？](http://go.microsoft.com/fwlink/?LinkId=132304)</span><span class="sxs-lookup"><span data-stu-id="26a8b-139">For more information about planning and measuring Maximum Sustainable Performance see [Planning for Sustained Performance](http://go.microsoft.com/fwlink/?LinkId=158065) (http://go.microsoft.com/fwlink/?LinkId=158065) and [What Is Sustainable Performance?](http://go.microsoft.com/fwlink/?LinkId=132304)</span></span> <span data-ttu-id="26a8b-140">(http://go.microsoft.com/fwlink/?LinkId=132304).</span><span class="sxs-lookup"><span data-stu-id="26a8b-140">(http://go.microsoft.com/fwlink/?LinkId=132304).</span></span>  
  
     <span data-ttu-id="26a8b-141">MST 是一个系统可以无限期地处理在生产环境中的消息流量的最高负载。</span><span class="sxs-lookup"><span data-stu-id="26a8b-141">The MST is the highest load of message traffic that a system can handle indefinitely in a production environment.</span></span> <span data-ttu-id="26a8b-142">转到生产环境前，所有 BizTalk 应用程序应进行都测试的性能和吞吐量。</span><span class="sxs-lookup"><span data-stu-id="26a8b-142">All BizTalk applications should be tested for performance and throughput before going into production.</span></span> <span data-ttu-id="26a8b-143">至少应运行测试用例表示的最常见的使用方案的一组有代表性。</span><span class="sxs-lookup"><span data-stu-id="26a8b-143">At a minimum, you should run a representative set of test cases that represent the most common usage scenarios.</span></span> <span data-ttu-id="26a8b-144">我们建议根据预期负载测试并在一个单独的环境与生产环境的特征匹配的峰值负载。</span><span class="sxs-lookup"><span data-stu-id="26a8b-144">We recommend that you test against expected loads and peak loads in a separate environment that matches characteristics of the production environment.</span></span> <span data-ttu-id="26a8b-145">此环境中应具有的所有安装并且正在运行，如监视代理和防病毒软件公司的标准服务。</span><span class="sxs-lookup"><span data-stu-id="26a8b-145">This environment should have all of the corporate standard services installed and running, such as monitoring agents, and antivirus software.</span></span>  
  
-   <span data-ttu-id="26a8b-146">我们还建议在以及正在运行的其他 BizTalk 应用程序的生产环境中测试新的 BizTalk 应用程序在同一硬件上。</span><span class="sxs-lookup"><span data-stu-id="26a8b-146">We also recommend that you test new BizTalk applications on the same hardware in production alongside the other BizTalk applications that are running.</span></span> <span data-ttu-id="26a8b-147">这些其他 BizTalk 应用程序将额外的负载放在 BizTalk Server、 SQL Server、 网络 I/O 和磁盘 I/O。</span><span class="sxs-lookup"><span data-stu-id="26a8b-147">These other BizTalk applications put additional load on the BizTalk Server, SQL Server, network I/O, and disk I/O.</span></span> <span data-ttu-id="26a8b-148">此外，一个 BizTalk 应用程序可能会导致另一个用来限制 （当后台处理深度量变得过大，例如）。</span><span class="sxs-lookup"><span data-stu-id="26a8b-148">In addition, one BizTalk application could cause another to throttle (when the spool depth gets too large, for example).</span></span> <span data-ttu-id="26a8b-149">所有 BizTalk 应用程序应都为性能 / 之前的压力测试到生产环境。</span><span class="sxs-lookup"><span data-stu-id="26a8b-149">All BizTalk applications should be performance / stress tested before going into production.</span></span> <span data-ttu-id="26a8b-150">此外，应确定需要多长时间的峰值负载从恢复的系统。</span><span class="sxs-lookup"><span data-stu-id="26a8b-150">In addition, you should determine how long it takes the system to recover from peak loads.</span></span> <span data-ttu-id="26a8b-151">如果系统没有完全从此峰值负载下一步的峰值负载发生之前，您已有问题。</span><span class="sxs-lookup"><span data-stu-id="26a8b-151">If the system does not fully recover from a peak load before the next peak load occurs, then you've got a problem.</span></span> <span data-ttu-id="26a8b-152">系统将获取更多并进一步隐藏，并且永远不会为能够完全恢复。</span><span class="sxs-lookup"><span data-stu-id="26a8b-152">The system will get further and further behind and will never be able to fully recover.</span></span>  
  
## <a name="expectations-throughput-vs-latency"></a><span data-ttu-id="26a8b-153">期望： 吞吐量与延迟</span><span class="sxs-lookup"><span data-stu-id="26a8b-153">Expectations: throughput vs. latency</span></span>  
 <span data-ttu-id="26a8b-154">您可以预计一定的吞吐量和/或从已部署系统的滞后时间。</span><span class="sxs-lookup"><span data-stu-id="26a8b-154">You can expect a certain amount of throughput and/or latency from the deployed system.</span></span> <span data-ttu-id="26a8b-155">尝试同时实现高吞吐量和低延迟会在系统上的对立的需求。</span><span class="sxs-lookup"><span data-stu-id="26a8b-155">Attempting to achieve high throughput and low latency simultaneously places opposing demands on the system.</span></span> <span data-ttu-id="26a8b-156">您可以使用合理的滞后时间期望获得最佳吞吐量。</span><span class="sxs-lookup"><span data-stu-id="26a8b-156">You can expect optimal throughput with reasonable latency.</span></span> <span data-ttu-id="26a8b-157">随着吞吐量提高，压力 （例如，高 CPU 占用率、 更多的磁盘 i/o 争用、 内存压力和更高版本的锁争用） 系统增大时。</span><span class="sxs-lookup"><span data-stu-id="26a8b-157">As throughput improves, stress (such as, higher CPU consumption, higher disk-I/O contention, memory pressure, and greater lock contention) on the system increases.</span></span> <span data-ttu-id="26a8b-158">这种情况下可以对延迟时间产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="26a8b-158">This situation can have a negative impact on latency.</span></span> <span data-ttu-id="26a8b-159">若要发现最佳系统容量，我们建议您识别并最大程度减少任何瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-159">To discover optimal capacity of a system, we recommend that you identify and minimize any bottlenecks.</span></span>  
  
 <span data-ttu-id="26a8b-160">已完成的数据库中驻留的实例可能会造成瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-160">Completed instances residing in the database can cause bottlenecks.</span></span> <span data-ttu-id="26a8b-161">发生瓶颈后，可能会降低性能。</span><span class="sxs-lookup"><span data-stu-id="26a8b-161">When bottlenecks occur, performance can degrade.</span></span> <span data-ttu-id="26a8b-162">让系统足够时间来排出可以帮助解决此问题。</span><span class="sxs-lookup"><span data-stu-id="26a8b-162">Giving the system sufficient time to drain can help fix the problem.</span></span> <span data-ttu-id="26a8b-163">发现出现积压的原因并帮助解决此问题很重要。</span><span class="sxs-lookup"><span data-stu-id="26a8b-163">Discovering the cause of the backlog buildup and helping fix the issue is important.</span></span>  
  
 <span data-ttu-id="26a8b-164">若要发现积压的原因，可以分析历史数据和监视性能计数器 （为了发现使用模式和诊断积压的根源）。</span><span class="sxs-lookup"><span data-stu-id="26a8b-164">To discover the cause of the backlog, you can analyze historical data and monitor performance counters (to discover usage patterns, and diagnose the source of the backlog).</span></span> <span data-ttu-id="26a8b-165">通常情况下，当以批处理方式每晚定期处理数据量很大，则会发生积压工作。</span><span class="sxs-lookup"><span data-stu-id="26a8b-165">Commonly, backlogs can occur when large volumes of data are processed in a batched manner on a nightly basis.</span></span> <span data-ttu-id="26a8b-166">你可能会发现可以发现的系统，并且能够从积压中恢复的容量。</span><span class="sxs-lookup"><span data-stu-id="26a8b-166">You may find it useful to discover the capacity of the system and its ability to recover from a backlog.</span></span> <span data-ttu-id="26a8b-167">此信息可以帮助您评估处理过载情况以及缓冲区的空间量的硬件要求，以容纳系统为处理不可预见的峰值吞吐量。</span><span class="sxs-lookup"><span data-stu-id="26a8b-167">This information can help you to estimate hardware requirements for handling overdrive scenarios and the amount of buffer room to accommodate within a system to handle unforeseen spikes in throughput.</span></span>  
  
 <span data-ttu-id="26a8b-168">监视性能计数器可以帮助区分在运行时可能会出现的潜在瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-168">Monitoring performance counters can help individuate potential bottlenecks that could arise at runtime.</span></span> <span data-ttu-id="26a8b-169">但是，当我们怀疑 CPU 或内存瓶颈的原因可能是构成解决方案的自定义组件之一，我们强烈建议你使用分析工具这种 Visual Studio Profiler 或性能 ANTS Profiler 性能测试期间若要缩小范围，并区分明确地生成问题的类。</span><span class="sxs-lookup"><span data-stu-id="26a8b-169">However, when we suspect that the culprit of CPU or memory bottleneck may be one of the custom components that compose the solution, we strongly recommend that you use profiling tools such Visual Studio Profiler or ANTS Performance Profiler during a performance test to narrow and individuate with certainty the class that generates the problem.</span></span> <span data-ttu-id="26a8b-170">很明显，分析应用程序会影响性能。</span><span class="sxs-lookup"><span data-stu-id="26a8b-170">Obviously, profiling an application interferes with performance.</span></span> <span data-ttu-id="26a8b-171">因此，这些测试应致力于 individuating 这些组件，从而导致内存消耗、 CPU 利用率或延迟，并且应丢弃这些测试期间收集的数字。</span><span class="sxs-lookup"><span data-stu-id="26a8b-171">Therefore, these tests should be focused on individuating those components that cause memory consumption, CPU utilization or latency and figures collected during these tests should be discarded.</span></span>  
  
 <span data-ttu-id="26a8b-172">优化系统以最佳可承受吞吐量要求用户深入了解部署的应用程序、 优势和劣势的系统和使用模式的特定方案。</span><span class="sxs-lookup"><span data-stu-id="26a8b-172">Tuning the system for optimal sustainable throughput requires an in depth understanding of the deployed application, the strengths and weaknesses of the system, and usage patterns of the specific scenario.</span></span> <span data-ttu-id="26a8b-173">将在生产环境中使用发现瓶颈和预测最佳可承受吞吐量颇有自信地是通过符合什么的拓扑结构进行彻底的测试的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="26a8b-173">The only way to discover bottlenecks and predict optimal sustainable throughput with certainty is through thorough testing on a topology that closely matches what will be used in production.</span></span> <span data-ttu-id="26a8b-174">当针对特定用例运行负载测试和压力测试，隔离到单独的主机实例 （接收位置、 发送端口，业务流程） 的单个项目和设置在性能监视器工具中的右计数器是至关重要的缩小瓶颈的原因。</span><span class="sxs-lookup"><span data-stu-id="26a8b-174">When running load and stress tests against a certain use case, isolating single artifacts (receive locations, send ports, orchestrations) into separate host instances and setting the right counters inside the performance monitor tool is crucial to narrow down the cause of a bottleneck.</span></span>  
  
 <span data-ttu-id="26a8b-175">本部分中的其他主题引导您完成定义该拓扑的过程，并提供有关如何降低和避免瓶颈的指导。</span><span class="sxs-lookup"><span data-stu-id="26a8b-175">Other topics in this section guide you through the process of defining that topology, and provide guidance on how to lessen and avoid bottlenecks.</span></span>  
  
## <a name="scaling"></a><span data-ttu-id="26a8b-176">缩放</span><span class="sxs-lookup"><span data-stu-id="26a8b-176">Scaling</span></span>  
 <span data-ttu-id="26a8b-177">瓶颈可能已部署的拓扑的各个阶段。</span><span class="sxs-lookup"><span data-stu-id="26a8b-177">Bottlenecks can occur at various stages of a deployed topology.</span></span> <span data-ttu-id="26a8b-178">某些瓶颈可通过向上扩展或横向扩展环境进行寻址。</span><span class="sxs-lookup"><span data-stu-id="26a8b-178">Some bottlenecks can be addressed by either scaling up or scaling out the environment.</span></span> <span data-ttu-id="26a8b-179">纵向扩展是升级现有计算机的过程。</span><span class="sxs-lookup"><span data-stu-id="26a8b-179">Scaling up is the process of upgrading the existing computer.</span></span> <span data-ttu-id="26a8b-180">例如，可以在 BizTalk Server 计算机从四处理器计算机升级到八处理器计算机，以及替换现有的 Cpu 和添加更多的 RAM。</span><span class="sxs-lookup"><span data-stu-id="26a8b-180">For example, you can upgrade a BizTalk Server computer from a four-processor computer to an eight-processor computer, as well as substituting the existing CPUs and adding more RAM.</span></span> <span data-ttu-id="26a8b-181">这种方式，可提高资源密集型任务，例如文档分析和映射。</span><span class="sxs-lookup"><span data-stu-id="26a8b-181">In this way, you can accelerate resource-intensive tasks such as document parsing and mapping.</span></span> <span data-ttu-id="26a8b-182">向外扩展是将服务器添加到你的部署的过程。</span><span class="sxs-lookup"><span data-stu-id="26a8b-182">Scaling out is the process of adding servers to your deployment.</span></span> <span data-ttu-id="26a8b-183">扩展或横向扩展的决定取决于瓶颈和正在配置的应用程序的类型。</span><span class="sxs-lookup"><span data-stu-id="26a8b-183">The decision to scale up or out depends on the type of bottleneck and the application being configured.</span></span> <span data-ttu-id="26a8b-184">应用程序需要将从头开始构建，才能利用扩展或横向扩展。以下指南介绍如何更改硬件部署拓扑基于遇到的瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-184">An application needs to be built from the ground up to be capable of taking advantage of scaling up or out. The following guidance explains how to change hardware deployment topologies based on bottlenecks encountered.</span></span>  
  
 <span data-ttu-id="26a8b-185">**向上扩展**上运行的 BizTalk 解决方案的方式升级硬件 （适用于示例中，添加 CPU 和内存）。</span><span class="sxs-lookup"><span data-stu-id="26a8b-185">**Scaling up** means running a BizTalk solution on upgraded hardware (for example, adding CPU’s and memory).</span></span> <span data-ttu-id="26a8b-186">您应考虑纵向扩展时 1） 向外扩展成本十分高昂或 2） 向外扩展将帮助解决瓶颈。</span><span class="sxs-lookup"><span data-stu-id="26a8b-186">You should look at scaling up when 1) scaling out is too expensive or 2) scaling out will not help solve a bottleneck.</span></span> <span data-ttu-id="26a8b-187">例如，可以显著减少所用的时间转换和处理大消息，如果更快的计算机上运行任务。</span><span class="sxs-lookup"><span data-stu-id="26a8b-187">For example, you can significantly reduce the time spent transforming and processing a large message if you run the task on a faster machine.</span></span>  
  
 <span data-ttu-id="26a8b-188">**向外扩展**应用程序平台将 BizTalk 节点添加到 BizTalk Server 组和使用它们来运行解决方案的一个或多个部分组成。</span><span class="sxs-lookup"><span data-stu-id="26a8b-188">**Scaling out** the application platform consists of adding BizTalk nodes to the BizTalk Server Group and using them to run one or more parts of the solution.</span></span> <span data-ttu-id="26a8b-189">应在 1） 需要隔离发送、 接收、 处理、 跟踪主机或 2） 时向外扩展内存、 I/O 或网络 I/O 资源透支的一台服务器。</span><span class="sxs-lookup"><span data-stu-id="26a8b-189">You should look at scaling out when 1) you need to isolate send, receive, processing, tracking hosts or 2) when memory, I/O or Network I/O resources are maxed out for a single server.</span></span> <span data-ttu-id="26a8b-190">负载可以分布在多个服务器;但是，将新节点添加到 BizTalk Server 组可以提高在 MessageBox 数据库上的锁争用现象。</span><span class="sxs-lookup"><span data-stu-id="26a8b-190">The load can be spread across multiple servers; however, adding new nodes to the BizTalk Server Group can increase the lock contention on the MessageBox database.</span></span>  
  
 <span data-ttu-id="26a8b-191">因此应纵向扩展或横向扩展？</span><span class="sxs-lookup"><span data-stu-id="26a8b-191">So should you scale up or scale out?</span></span> <span data-ttu-id="26a8b-192">纵向扩展你的平台可以减少的 BizTalk 解决方案的延迟，因为它使单个任务 （例如，消息映射） 运行得更快。</span><span class="sxs-lookup"><span data-stu-id="26a8b-192">Scaling up your platform can reduce the latency of a BizTalk solution because it makes single tasks (for example, message mapping) run faster.</span></span> <span data-ttu-id="26a8b-193">向外扩展可以提高最大可承受 throughtput 和您的 BizTalk 解决方案的可扩展性，因为它允许您以工作负荷分散到多台计算机。</span><span class="sxs-lookup"><span data-stu-id="26a8b-193">Scaling out can improve the maximum sustainable throughtput and the scalability of your BizTalk solution because it allows you to spread the workload across multiple machines.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="26a8b-194">请参阅</span><span class="sxs-lookup"><span data-stu-id="26a8b-194">See Also</span></span>  
 [<span data-ttu-id="26a8b-195">查找并消除瓶颈</span><span class="sxs-lookup"><span data-stu-id="26a8b-195">Finding and Eliminating Bottlenecks</span></span>](../technical-guides/finding-and-eliminating-bottlenecks.md)