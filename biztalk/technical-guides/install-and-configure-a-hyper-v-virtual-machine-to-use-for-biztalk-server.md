---
title: 安装和配置 HYPER-V 虚拟机，以使用与 BizTalk Server |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 86add392-3cde-432d-95d6-c81d68716537
caps.latest.revision: 18
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b973053d3afa9c6d0b61de111d9da1c4fb7a0fb1
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
ms.locfileid: "26010966"
---
# <a name="installing-and-configuring-a-hyper-v-virtual-machine-for-use-with-biztalk-server"></a><span data-ttu-id="4e12a-102">安装和配置 HYPER-V 虚拟机，以使用与 BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="4e12a-102">Installing and Configuring a Hyper-V Virtual Machine for use with BizTalk Server</span></span>
<span data-ttu-id="4e12a-103">本主题提供有关安装和配置在 HYPER-V 环境中，包括有关安装和配置 HYPER-V 虚拟机的建议和建议在上安装 BizTalk Server 的 BizTalk Server 建议HYPER-V 虚拟机。</span><span class="sxs-lookup"><span data-stu-id="4e12a-103">This topic provides recommendations for installing and configuring BizTalk Server in a Hyper-V environment, including recommendations for installation and configuration of the Hyper-V virtual machine and recommendations for installing BizTalk Server on a Hyper-V virtual machine.</span></span>  
  
## <a name="installing-and-configuring-hyper-v"></a><span data-ttu-id="4e12a-104">安装和配置 HYPER-V</span><span class="sxs-lookup"><span data-stu-id="4e12a-104">Installing and Configuring Hyper-V</span></span>  
 <span data-ttu-id="4e12a-105">在安装之前 HYPER-V，请参阅[What's New in Windows Server 2008 R2 中 HYPER-V](http://go.microsoft.com/fwlink/?LinkID=202427)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-105">Before installing Hyper-V, see [What's New in Hyper-V in Windows Server 2008 R2](http://go.microsoft.com/fwlink/?LinkID=202427).</span></span> <span data-ttu-id="4e12a-106">"Microsoft HYPER-V Server 2008 R2 入门"指南提供有关如何安装和配置详细信息[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]HYPER-V。</span><span class="sxs-lookup"><span data-stu-id="4e12a-106">The “Microsoft Hyper-V Server 2008 R2 Getting Started” guide provides details about how to install and configure [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] Hyper-V.</span></span> <span data-ttu-id="4e12a-107">该指南可以在[http://go.microsoft.com/fwlink/?LinkID=202431](http://go.microsoft.com/fwlink/?LinkID=202431)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-107">The guide is available at [http://go.microsoft.com/fwlink/?LinkID=202431](http://go.microsoft.com/fwlink/?LinkID=202431).</span></span>  
  
 <span data-ttu-id="4e12a-108">"性能优化准则适用于 Windows Server 2008 R2"文档提供了详细信息优化[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]和包含专门侧重于 HYPER-V 的部分。</span><span class="sxs-lookup"><span data-stu-id="4e12a-108">“The Performance Tuning Guidelines for Windows Server 2008 R2” document provides details on tuning [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] and includes a section specifically focused on Hyper-V.</span></span> <span data-ttu-id="4e12a-109">文档位于[http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-109">The document is available at [http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087).</span></span>  
  
### <a name="hyper-v-platform-prerequisites"></a><span data-ttu-id="4e12a-110">HYPER-V 平台必备组件</span><span class="sxs-lookup"><span data-stu-id="4e12a-110">Hyper-V Platform Prerequisites</span></span>  
 <span data-ttu-id="4e12a-111">HYPER-V 是可用于 64 位和的所有版本的服务器角色[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]都只能是 64 位。</span><span class="sxs-lookup"><span data-stu-id="4e12a-111">Hyper-V is a server role available for 64-bit and all editions of  [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] are 64-bit only.</span></span> <span data-ttu-id="4e12a-112">此外，物理硬件必须支持硬件辅助虚拟化。</span><span class="sxs-lookup"><span data-stu-id="4e12a-112">Additionally, the physical hardware must support hardware assisted virtualization.</span></span> <span data-ttu-id="4e12a-113">这意味着必须是具有 Intel 虚拟化技术 (Intel VT) 或 AMD 虚拟化 (AMD-V) 技术兼容的处理器、 系统 BIOS 必须支持数据执行保护 (DEP)，并且必须支持 DEP。</span><span class="sxs-lookup"><span data-stu-id="4e12a-113">This means the processor must be compatible with Intel Virtualization Technology (Intel VT) or AMD Virtualization (AMD-V) technology, the system BIOS must support Data Execution Prevention (DEP), and DEP must be enabled.</span></span> <span data-ttu-id="4e12a-114">具体而言，必须启用 Intel XD 位 （执行禁用位） 或 AMD NX 位 （无执行位）。</span><span class="sxs-lookup"><span data-stu-id="4e12a-114">Specifically, you must enable the Intel XD bit (execute disable bit) or AMD NX bit (no execute bit).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4e12a-115">启用在系统 BIOS 中的这些选项后, 完全关闭计算机，然后重新启动计算机，以确保这些设置将应用。</span><span class="sxs-lookup"><span data-stu-id="4e12a-115">After enabling these options in the system BIOS, turn off the computer completely and then restart the computer to ensure that these settings are applied.</span></span>  
  
#### <a name="determining-hardware-requirements"></a><span data-ttu-id="4e12a-116">确定硬件要求</span><span class="sxs-lookup"><span data-stu-id="4e12a-116">Determining Hardware Requirements</span></span>  
 <span data-ttu-id="4e12a-117">由于服务器合并的需求，HYPER-V 服务器倾向于使用更多的 CPU 和内存，并且需要更大的磁盘 I/O 带宽比具有可比较的计算负载的物理服务器。</span><span class="sxs-lookup"><span data-stu-id="4e12a-117">Due to the demands of server consolidation, Hyper-V servers tend to consume more CPU and memory, and require greater disk I/O bandwidth than physical servers with comparable computing loads.</span></span> <span data-ttu-id="4e12a-118">为了部署环境，以符合预期要求，请考虑下面确定你的服务器的确切的硬件要求的因素。</span><span class="sxs-lookup"><span data-stu-id="4e12a-118">In order to deploy an environment that will meet expectations, consider the factors below to determine the exact hardware requirements of your server.</span></span>  
  
##### <a name="storage-configuration-options"></a><span data-ttu-id="4e12a-119">存储配置选项</span><span class="sxs-lookup"><span data-stu-id="4e12a-119">Storage Configuration Options</span></span>  
 <span data-ttu-id="4e12a-120">存储硬件应提供足够的 I/O 带宽和存储容量，以满足你打算承载虚拟机的当前和未来需求。</span><span class="sxs-lookup"><span data-stu-id="4e12a-120">The storage hardware should provide sufficient I/O bandwidth and storage capacity to meet the current and future needs of the virtual machines that you plan to host.</span></span> <span data-ttu-id="4e12a-121">选择 HYPER-V 之间容量使用情况和性能它可以提供的存储配置时，进行权衡。</span><span class="sxs-lookup"><span data-stu-id="4e12a-121">There is a trade-off when choosing the storage configuration for Hyper-V between capacity usage and the performance it can provide.</span></span>  
  
 <span data-ttu-id="4e12a-122">在规划存储配置时，请考虑要设置的环境的要求。</span><span class="sxs-lookup"><span data-stu-id="4e12a-122">When planning storage configuration, consider the requirements of the environment you are provisioning.</span></span> <span data-ttu-id="4e12a-123">生产、 预生产中和开发环境的要求可能相差很大。</span><span class="sxs-lookup"><span data-stu-id="4e12a-123">The requirements for production, pre-production, and development environments may differ considerably.</span></span>  
  
 <span data-ttu-id="4e12a-124">如果要部署的生产型 HYPER-V 上的 BizTalk Server 环境，性能将一项关键要求。</span><span class="sxs-lookup"><span data-stu-id="4e12a-124">If you are deploying a production BizTalk Server environment on Hyper-V, performance will be a key requirement.</span></span> <span data-ttu-id="4e12a-125">若要避免磁盘 I/O 争用繁忙的生产系统上，在主机和来宾操作系统上安装集成服务，并使用合成 SCSI 控制器配置数据卷的磁盘。</span><span class="sxs-lookup"><span data-stu-id="4e12a-125">To avoid disk I/O contention on busy production systems, install integration services on both the host and guest operating system and configure disks for data volumes with the synthetic SCSI controller.</span></span> <span data-ttu-id="4e12a-126">对于跨多个数据驱动器的高密集型存储 I/O 工作负荷，应将每个 VHD 附加到更好的总体性能的单独合成 SCSI 控制器。</span><span class="sxs-lookup"><span data-stu-id="4e12a-126">For highly intensive storage I/O workloads that span multiple data drives, each VHD should be attached to a separate synthetic SCSI controller for better overall performance.</span></span> <span data-ttu-id="4e12a-127">此外，每个 VHD 应存储在单独的物理磁盘上。</span><span class="sxs-lookup"><span data-stu-id="4e12a-127">In addition, each VHD should be stored on separate physical disks.</span></span> <span data-ttu-id="4e12a-128">有关配置的数据磁盘的详细信息与综合的 SCSI 控制器的卷，请参阅主题的"优化磁盘性能"部分[清单： HYPER-V 上优化性能](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-128">For more information about configuring disks for data volumes with the synthetic SCSI controller see the “Optimize Disk Performance” section of the topic [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span>  
  
 <span data-ttu-id="4e12a-129">通常情况下，开发环境不具有严格的性能要求，因为最大化资源利用率往往是主要的优先级。</span><span class="sxs-lookup"><span data-stu-id="4e12a-129">Typically, development environments do not have stringent performance requirements since maximizing resource utilization tends to be the main priority.</span></span> <span data-ttu-id="4e12a-130">对于开发环境提供承载在单个物理驱动器上的多个 VHD 文件时的性能是通常可接受的。</span><span class="sxs-lookup"><span data-stu-id="4e12a-130">For development environments the performance provided when hosting multiple VHD files on a single physical drive is generally acceptable.</span></span>  
  
 <span data-ttu-id="4e12a-131">HYPER-V 支持多种不同类型的存储磁盘选项。</span><span class="sxs-lookup"><span data-stu-id="4e12a-131">Hyper-V supports several different types of storage disk options.</span></span> <span data-ttu-id="4e12a-132">到计算机，可以通过 IDE 或 SCSI 控制器附加每个存储选项。</span><span class="sxs-lookup"><span data-stu-id="4e12a-132">Each of the storage options can be attached via an IDE or SCSI controller to the machine.</span></span> <span data-ttu-id="4e12a-133">使用上的 IDE 控制器的 SCSI 控制器的潜在优点是，它将仅正常工作如果在来宾虚拟机上安装了操作系统集成组件的正确版本。</span><span class="sxs-lookup"><span data-stu-id="4e12a-133">A potential benefit of using the SCSI controller over the IDE controller is that it will only work correctly if the correct versions of the operating system integration components have been installed on the guest virtual machine.</span></span> <span data-ttu-id="4e12a-134">这是确保来宾操作系统上安装了正确的操作系统的集成组件的一种简单的方法。</span><span class="sxs-lookup"><span data-stu-id="4e12a-134">This is a straightforward method for ensuring that correct operating system integration components are installed on the guest operating system.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4e12a-135">与以前版本的 Microsoft 虚拟化技术，访问虚拟硬盘时使用的虚拟 IDE 控制器或虚拟 SCSI 控制器之间没有性能差异。</span><span class="sxs-lookup"><span data-stu-id="4e12a-135">Unlike previous versions of Microsoft virtualization technology, there is no performance difference between using a virtual IDE controller or a virtual SCSI controller when accessing virtual hard disks.</span></span>  
  
 <span data-ttu-id="4e12a-136">对于密集型的读写活动，如承载[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]数据库，传递磁盘选项提供增量性能优于固定虚拟硬盘 (VHD) 磁盘。</span><span class="sxs-lookup"><span data-stu-id="4e12a-136">For intensive read-write activities, such as hosting [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases, the passthrough disk option provides incremental performance advantages over fixed virtual hard drive (VHD) disks.</span></span> <span data-ttu-id="4e12a-137">传递选项允许虚拟机能够直接访问的物理磁盘和绕过 NTFS 文件系统根分区中的，但不支持某些功能的虚拟磁盘，例如虚拟机快照和群集支持。</span><span class="sxs-lookup"><span data-stu-id="4e12a-137">The passthrough option permits the virtual machine to have direct access to the physical disk and bypasses the NTFS file system in the root partition but does not support certain functionality of virtual disks, such as Virtual machine snapshots and clustering support.</span></span> <span data-ttu-id="4e12a-138">因此的传递磁盘功能的建议不要使用在 BizTalk 或 SQL Server 环境中由于边际性能优势是多个是通过所缺少的功能偏移量。</span><span class="sxs-lookup"><span data-stu-id="4e12a-138">Therefore use of the passthrough disk feature is not recommended in a BizTalk or SQL Server environment because the marginal performance benefits are more than offset by the missing functionality.</span></span>  
  
 <span data-ttu-id="4e12a-139">下表总结了可用的 HYPER-V 存储选项的优缺点:。</span><span class="sxs-lookup"><span data-stu-id="4e12a-139">The following table summarizes the advantages and disadvantages of available Hyper-V storage options:.</span></span>  
  
|<span data-ttu-id="4e12a-140">**HYPER-V 的存储类型**</span><span class="sxs-lookup"><span data-stu-id="4e12a-140">**Hyper-V Storage Type**</span></span>|<span data-ttu-id="4e12a-141">**专业人员**</span><span class="sxs-lookup"><span data-stu-id="4e12a-141">**Pros**</span></span>|<span data-ttu-id="4e12a-142">**Cons**</span><span class="sxs-lookup"><span data-stu-id="4e12a-142">**Cons**</span></span>|<span data-ttu-id="4e12a-143">**BizTalk Server 的注意事项**</span><span class="sxs-lookup"><span data-stu-id="4e12a-143">**Considerations for BizTalk Server**</span></span>|  
|-------------------------------|--------------|--------------|-------------------------------------------|  
|<span data-ttu-id="4e12a-144">**固定的大小磁盘**</span><span class="sxs-lookup"><span data-stu-id="4e12a-144">**Fixed size disks**</span></span>|<span data-ttu-id="4e12a-145">因为在其最大可能大小初始化 VHD 文件，在物理硬盘上创建时的性能优于动态 VHD。</span><span class="sxs-lookup"><span data-stu-id="4e12a-145">Performs better than a dynamic VHD because the VHD file is initialized at its maximum possible size when it is created on the physical hard drive.</span></span><br /><br /> <span data-ttu-id="4e12a-146">这使碎片小于可能和，因此，可以降低一个单一的 I/O 被分成多个 I/o 的方案。</span><span class="sxs-lookup"><span data-stu-id="4e12a-146">This makes fragmentation less likely and, therefore, mitigates scenarios where a single I/O is split into multiple I/Os.</span></span> <span data-ttu-id="4e12a-147">这具有 VHD 类型的最低 CPU 开销，因为读取和写入不需要查找的块的映射。</span><span class="sxs-lookup"><span data-stu-id="4e12a-147">This has the lowest CPU overhead of the VHD types because reads and writes do not need to look up the mapping of the block.</span></span>|<span data-ttu-id="4e12a-148">需要完整的前期的磁盘空间量分配。</span><span class="sxs-lookup"><span data-stu-id="4e12a-148">Requires allocation of the full amount of disk space up-front.</span></span>|<span data-ttu-id="4e12a-149">操作系统卷上使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]和[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4e12a-149">Use for operating system volumes on [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span> <span data-ttu-id="4e12a-150">**重要说明：** HYPER-V 来宾分区的启动磁盘必须连接到 IDE 控制器。</span><span class="sxs-lookup"><span data-stu-id="4e12a-150">**Important:**  The startup disk of a Hyper-V guest partition must be attached to an IDE contoller.</span></span>|  
|<span data-ttu-id="4e12a-151">**动态扩展磁盘**</span><span class="sxs-lookup"><span data-stu-id="4e12a-151">**Dynamically expanding disks**</span></span>|<span data-ttu-id="4e12a-152">VHD 文件的大小增加到更多的数据存储在虚拟机本身上时创建磁盘、 指定的大小。</span><span class="sxs-lookup"><span data-stu-id="4e12a-152">The size of the VHD file increases to the size specified when creating the disk, as more data is stored on the virtual machine itself.</span></span> <span data-ttu-id="4e12a-153">这样就能适应可用存储空间最有效的使用。</span><span class="sxs-lookup"><span data-stu-id="4e12a-153">This accommodates the most efficient use of available storage.</span></span>|<span data-ttu-id="4e12a-154">不执行以及固定大小的 VHD。</span><span class="sxs-lookup"><span data-stu-id="4e12a-154">Does not perform as well as a fixed size VHD.</span></span> <span data-ttu-id="4e12a-155">这是因为在磁盘中的块开始状态均为零的块，但不是由任何 VHD 文件中的实际空间。</span><span class="sxs-lookup"><span data-stu-id="4e12a-155">This is because the blocks in the disk start as zeroed blocks but are not backed by any actual space in the VHD file.</span></span> <span data-ttu-id="4e12a-156">返回此类块中读取零的块。</span><span class="sxs-lookup"><span data-stu-id="4e12a-156">Reads from such blocks return a block of zeros.</span></span> <span data-ttu-id="4e12a-157">第一个块时写入到中，虚拟化堆栈必须分配块的 VHD 文件内的空间，然后更新相应的元数据。</span><span class="sxs-lookup"><span data-stu-id="4e12a-157">When a block is first written to, the virtualization stack must allocate space within the VHD file for the block and then update the corresponding metadata.</span></span> <span data-ttu-id="4e12a-158">除了这每次引用现有块的块映射必须查找元数据中。</span><span class="sxs-lookup"><span data-stu-id="4e12a-158">In addition to this every time an existing block is referenced the block mapping must be looked up in the metadata.</span></span> <span data-ttu-id="4e12a-159">这会增加读取的数，并且这反过来会导致写入活动增加 CPU 使用率。</span><span class="sxs-lookup"><span data-stu-id="4e12a-159">This increases the number of read and write activities which in turn causes increased CPU utilization.</span></span><br /><br /> <span data-ttu-id="4e12a-160">动态增长还需要服务器管理员监视磁盘容量，以确保有足够的磁盘存储作为存储需求的增长。</span><span class="sxs-lookup"><span data-stu-id="4e12a-160">The dynamic growth also requires that the server administrator monitor disk capacity to ensure that there is sufficient disk storage as the storage requirements increase.</span></span>|<span data-ttu-id="4e12a-161">不执行以及固定大小的 VHD。</span><span class="sxs-lookup"><span data-stu-id="4e12a-161">Does not perform as well as a fixed size VHD.</span></span><br /><br /> <span data-ttu-id="4e12a-162">如果性能并不是问题，例如在开发环境中，这可能是操作系统的硬盘驱动器的合适选项。</span><span class="sxs-lookup"><span data-stu-id="4e12a-162">If performance is not a concern, for instance in a development environment, this may be a suitable option for the operating system hard drives.</span></span><br /><br /> <span data-ttu-id="4e12a-163">会导致额外的 CPU 开销，由于块映射查找。</span><span class="sxs-lookup"><span data-stu-id="4e12a-163">Causes additional CPU overhead due to block mapping lookup.</span></span>|  
|<span data-ttu-id="4e12a-164">**差异磁盘**</span><span class="sxs-lookup"><span data-stu-id="4e12a-164">**Differencing disks**</span></span>|<span data-ttu-id="4e12a-165">这其中差异磁盘存储相对于基本 VHD 和基本 VHD 的所有更改的父-子配置保持不变。</span><span class="sxs-lookup"><span data-stu-id="4e12a-165">This a parent-child configuration where the differencing disk stores all changes relative to a base VHD and the base VHD remains static.</span></span> <span data-ttu-id="4e12a-166">因此它们是不同于其父块需要存储差异 VHD 的子级。</span><span class="sxs-lookup"><span data-stu-id="4e12a-166">Therefore only the blocks which are different from the parent need to be stored in the child differencing VHD.</span></span>|<span data-ttu-id="4e12a-167">因为读/写需要访问形式固定/动态父 VHD 和差异磁盘，则可能会降低性能。</span><span class="sxs-lookup"><span data-stu-id="4e12a-167">Performance can degrade because read/writes need to access the fixed/dynamic parent VHD as well as the differencing disk.</span></span> <span data-ttu-id="4e12a-168">这会增加 CPU 使用率和磁盘 I/O 开销。</span><span class="sxs-lookup"><span data-stu-id="4e12a-168">This increases CPU utilization and disk I/O overhead.</span></span>|<span data-ttu-id="4e12a-169">大量的机特定配置，才能使用 BizTalk Server 安装和子 VHD 文件可能会变得大体上这将最小化使用此磁盘配置的优点。</span><span class="sxs-lookup"><span data-stu-id="4e12a-169">A large amount of machine specific configuration is required for BizTalk Server installations and child VHD files may grow substantially which would minimize the benefits of using this disk configuration.</span></span> <span data-ttu-id="4e12a-170">读取从多个 VHD 的在此方案中会产生额外的 CPU 和磁盘 I/O 开销。</span><span class="sxs-lookup"><span data-stu-id="4e12a-170">Reading from multiple VHD’s in this scenario incurs additional CPU and disk I/O overhead.</span></span>|  
|<span data-ttu-id="4e12a-171">**传递磁盘**</span><span class="sxs-lookup"><span data-stu-id="4e12a-171">**Passthrough disks**</span></span>|<span data-ttu-id="4e12a-172">这些是物理磁盘设置为*脱机*中的根分区和启用 HYPER-V 可具有独占写入物理磁盘的读写访问权限。</span><span class="sxs-lookup"><span data-stu-id="4e12a-172">These are physical disks which are set to *offline* in the root partition and enable Hyper-V to have exclusive read-write access to the physical disk.</span></span>|<span data-ttu-id="4e12a-173">以使其以分配给虚拟机需要一个完全专用的磁盘或 LUN。</span><span class="sxs-lookup"><span data-stu-id="4e12a-173">Requires a fully dedicated disk or LUN in order for it to be allocated to a virtual machine.</span></span><br /><br /> <span data-ttu-id="4e12a-174">物理磁盘的难度以比 VHD 文件在计算机之间移动。</span><span class="sxs-lookup"><span data-stu-id="4e12a-174">A physical disk is more difficult to move between machines than VHD files.</span></span>|<span data-ttu-id="4e12a-175">如果你[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]实例在 HYPER-V 上运行，则您可能通过使用用于 BizTalk Server 数据卷的固定虚拟硬盘 (VHD) 使用传递磁盘获取增量性能改进。</span><span class="sxs-lookup"><span data-stu-id="4e12a-175">If your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance is running on a Hyper-V, you may obtain incremental performance improvements by using passthrough disks over using fixed virtual hard disks (VHD) for the BizTalk Server data volumes.</span></span><br /><br /> <span data-ttu-id="4e12a-176">如果您要承载本地文件接收 BizTalk 服务器上的位置，或在处理过程中磁盘的大型消息流式处理，则可能会获得通过使用固定虚拟硬盘 (VHD) 使用传递磁盘的增量性能改进。</span><span class="sxs-lookup"><span data-stu-id="4e12a-176">If you are hosting local file receive locations on BizTalk Server or streaming large messages to disk during processing, you may obtain incremental performance improvements using passthrough disks over using fixed virtual hard disks (VHD).</span></span>|  
  
 <span data-ttu-id="4e12a-177">有关实现磁盘和存储与 HYPER-V 使用的详细信息请参阅[实现磁盘和存储](http://go.microsoft.com/fwlink/?LinkID=142362)(http://go.microsoft.com/fwlink/?LinkID=142362)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-177">For more information about implementing disks and storage with Hyper-V see [Implementing Disks and Storage](http://go.microsoft.com/fwlink/?LinkID=142362) (http://go.microsoft.com/fwlink/?LinkID=142362).</span></span>  
  
##### <a name="networking"></a><span data-ttu-id="4e12a-178">网络</span><span class="sxs-lookup"><span data-stu-id="4e12a-178">Networking</span></span>  
 <span data-ttu-id="4e12a-179">BizTalk Server 往往会表现出较高网络使用率。</span><span class="sxs-lookup"><span data-stu-id="4e12a-179">BizTalk Server tends to exhibit high network utilization.</span></span> <span data-ttu-id="4e12a-180">因此，如果网络性能问题，请考虑为每个虚拟机分配单独的物理网卡。</span><span class="sxs-lookup"><span data-stu-id="4e12a-180">Therefore, when network performance is an issue, consider allocating a separate physical network card for each virtual machine.</span></span>  
  
 <span data-ttu-id="4e12a-181">配置虚拟机，确保而不是旧版网络适配器使用网络适配器。</span><span class="sxs-lookup"><span data-stu-id="4e12a-181">When configuring a virtual machine, ensure that you use the Network Adapter instead of the Legacy Network Adapter.</span></span> <span data-ttu-id="4e12a-182">旧版网络适配器适用于不支持集成组件的操作系统。</span><span class="sxs-lookup"><span data-stu-id="4e12a-182">The legacy network adapter is intended for operating systems that do not support integration components.</span></span>  
  
 <span data-ttu-id="4e12a-183">若要测量网络性能使用 **"\Network 接口 \Bytes Total/sec"** 和**\Network 接口 (\*) \Output 队列长度**主机操作系统上的性能监视器计数器要测量的网络卡的总体性能的系统。</span><span class="sxs-lookup"><span data-stu-id="4e12a-183">To measure network performance use the **“\Network Interface \Bytes Total/sec”** and the **\Network Interface(\*)\Output Queue Length** performance monitor counters on the host operating system to measure overall performance of the network card.</span></span> <span data-ttu-id="4e12a-184">如果物理网络已被标识为忙，使用 **"\Hyper-V 虚拟网络适配器 (\*) \Bytes/sec"** 在主机操作系统以确定哪些虚拟机网络接口适配器上的计数器是生成高负载。</span><span class="sxs-lookup"><span data-stu-id="4e12a-184">If a physical network has been identified as being busy, use the **“\Hyper-V Virtual Network Adapter (\*)\Bytes/sec”** counter on the host operating system to identify which virtual machine network adapter(s) is/are generating high load.</span></span>  
  
 <span data-ttu-id="4e12a-185">有关评估在 HYPER-V 环境中的网络性能的详细信息请参阅**测量网络性能**部分[清单： HYPER-V 上的测量性能](../technical-guides/checklist-measuring-performance-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-185">For more information about evaluating network performance on a Hyper-V environment see the **Measuring Network Performance** section of [Checklist: Measuring Performance on Hyper-V](../technical-guides/checklist-measuring-performance-on-hyper-v.md).</span></span>  
  
##### <a name="cpu"></a><span data-ttu-id="4e12a-186">CPU</span><span class="sxs-lookup"><span data-stu-id="4e12a-186">CPU</span></span>  
 <span data-ttu-id="4e12a-187">HYPER-V 支持为不同的来宾操作系统; 不同数量的虚拟处理器下表中进行了总结。</span><span class="sxs-lookup"><span data-stu-id="4e12a-187">Hyper-V supports different numbers of virtual processors for different guest operating systems; as summarized in the table below.</span></span> <span data-ttu-id="4e12a-188">若要为 BizTalk Server 中分配的最大 CPU 资源，请将其安装在[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]来宾操作系统，支持每个虚拟机的四个虚拟处理器。</span><span class="sxs-lookup"><span data-stu-id="4e12a-188">To allocate the maximum CPU resources for BizTalk Server, install it on a [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] guest operating system,  which supports four virtual processors per virtual machine.</span></span>  
  
 <span data-ttu-id="4e12a-189">配置虚拟处理器的 1-1 分配到逻辑处理器可供主机操作系统，以防止过多的上下文切换的来宾操作系统中。</span><span class="sxs-lookup"><span data-stu-id="4e12a-189">Configure a 1-1 allocation of virtual processors in the guest operating system(s) to logical processors available to the host operating system to prevent excessive context switching.</span></span> <span data-ttu-id="4e12a-190">过多的上下文切换处理器之间会导致性能下降。</span><span class="sxs-lookup"><span data-stu-id="4e12a-190">Excessive context switching between processors will result in performance degradation.</span></span> <span data-ttu-id="4e12a-191">有关分配虚拟处理器到逻辑处理器的详细信息，请参阅主题的"优化处理器性能"部分[清单： HYPER-V 上优化性能](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-191">For more information about allocating virtual processors to logical processors, see the “Optimize Processor Performance” section of the topic [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span>  
  
 <span data-ttu-id="4e12a-192">"虚拟机监控程序逻辑 processor （_total) \Hyper-V\\%总运行时间"性能监视器计数器测量的所有来宾计算机和 HYPER-V 主机上的虚拟机监控程序的总体资源使用率。</span><span class="sxs-lookup"><span data-stu-id="4e12a-192">The “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” Performance Monitor counter measures the overall resource utilization of all guest machines and the hypervisor on the Hyper-V host.</span></span> <span data-ttu-id="4e12a-193">如果此值高于 90%，以最大容量; 运行服务器在此方案中的虚拟机分配额外的虚拟处理器可能会降低整体系统性能，应当避免。</span><span class="sxs-lookup"><span data-stu-id="4e12a-193">If this value is above 90%, the server is running at maximum capacity; allocating additional virtual processors to virtual machines in this scenario can degrade overall system performance and should be avoided.</span></span> <span data-ttu-id="4e12a-194">有关使用 HyperV 性能计数器的详细信息，请参阅[的 BizTalk Server 性能评估 HYPER-V](../technical-guides/evaluating-biztalk-server-performance-on-hyper-v.md)本指南的部分。</span><span class="sxs-lookup"><span data-stu-id="4e12a-194">For further details on using the HyperV performance counters, see the [Evaluating BizTalk Server Performance on Hyper-V](../technical-guides/evaluating-biztalk-server-performance-on-hyper-v.md) section of this guide.</span></span>  
  
|<span data-ttu-id="4e12a-195">操作系统</span><span class="sxs-lookup"><span data-stu-id="4e12a-195">Operating system</span></span>|<span data-ttu-id="4e12a-196">虚拟处理器限制</span><span class="sxs-lookup"><span data-stu-id="4e12a-196">Virtual processor limit</span></span>|  
|----------------------|-----------------------------|  
|[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]<span data-ttu-id="4e12a-197">。</span><span class="sxs-lookup"><span data-stu-id="4e12a-197">.</span></span> <span data-ttu-id="4e12a-198">所有版本的[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]都只能是 64 位。</span><span class="sxs-lookup"><span data-stu-id="4e12a-198">All editions of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] are 64-bit only.</span></span>|<span data-ttu-id="4e12a-199">4</span><span class="sxs-lookup"><span data-stu-id="4e12a-199">4</span></span>|  
|[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]<span data-ttu-id="4e12a-200">64 位</span><span class="sxs-lookup"><span data-stu-id="4e12a-200"> 64-bit</span></span>|<span data-ttu-id="4e12a-201">4</span><span class="sxs-lookup"><span data-stu-id="4e12a-201">4</span></span>|  
|[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]<span data-ttu-id="4e12a-202">32 位</span><span class="sxs-lookup"><span data-stu-id="4e12a-202"> 32-bit</span></span>|<span data-ttu-id="4e12a-203">4</span><span class="sxs-lookup"><span data-stu-id="4e12a-203">4</span></span>|  
|<span data-ttu-id="4e12a-204">64 位 Windows 7</span><span class="sxs-lookup"><span data-stu-id="4e12a-204">Windows 7 64-bit</span></span>|<span data-ttu-id="4e12a-205">4</span><span class="sxs-lookup"><span data-stu-id="4e12a-205">4</span></span>|  
|<span data-ttu-id="4e12a-206">32 位 Windows 7</span><span class="sxs-lookup"><span data-stu-id="4e12a-206">Windows 7 32-bit</span></span>|<span data-ttu-id="4e12a-207">4</span><span class="sxs-lookup"><span data-stu-id="4e12a-207">4</span></span>|  
|<span data-ttu-id="4e12a-208">64 位 Windows Vista</span><span class="sxs-lookup"><span data-stu-id="4e12a-208">Windows Vista 64-bit</span></span>|<span data-ttu-id="4e12a-209">2</span><span class="sxs-lookup"><span data-stu-id="4e12a-209">2</span></span>|  
|<span data-ttu-id="4e12a-210">Windows Vista 32 位</span><span class="sxs-lookup"><span data-stu-id="4e12a-210">Windows Vista  32-bit</span></span>|<span data-ttu-id="4e12a-211">2</span><span class="sxs-lookup"><span data-stu-id="4e12a-211">2</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="4e12a-212">在 HYPER-V 上支持的来宾操作系统的详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkID=118347](http://go.microsoft.com/fwlink/?LinkID=118347)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-212">For more information about the guest operating systems that are supported on Hyper-V, see [http://go.microsoft.com/fwlink/?LinkID=118347](http://go.microsoft.com/fwlink/?LinkID=118347).</span></span>  
  
##### <a name="memory"></a><span data-ttu-id="4e12a-213">内存</span><span class="sxs-lookup"><span data-stu-id="4e12a-213">Memory</span></span>  
 <span data-ttu-id="4e12a-214">物理服务器根分区和在服务器上运行任何虚拟机需要足够的内存。</span><span class="sxs-lookup"><span data-stu-id="4e12a-214">The physical server requires enough memory for the root partition and any virtual machines running on the server.</span></span> <span data-ttu-id="4e12a-215">在测试期间，至少 2 gb 的内存已分配给根分区和**内存/可用兆字节数**性能监视器计数器监视以确保没有内存压力，就会出现。</span><span class="sxs-lookup"><span data-stu-id="4e12a-215">During testing, a minimum of 2GB of memory was allocated to the root partition and the **Memory/Available Mbytes** performance monitor counter was monitored to ensure no memory pressure was experienced.</span></span>  
  
 <span data-ttu-id="4e12a-216">应该分配给 BizTalk 服务器环境中每个虚拟机的内存量取决于工作负荷，并将执行的处理类型。</span><span class="sxs-lookup"><span data-stu-id="4e12a-216">The amount of memory that should be allocated to each virtual machine in a BizTalk Server environment depends on the workload and type of processing that will be performed.</span></span> <span data-ttu-id="4e12a-217">有许多因素会影响的 BizTalk Server 包括内存要求：</span><span class="sxs-lookup"><span data-stu-id="4e12a-217">There are many factors that affect memory requirements of  BizTalk Server including:</span></span>  
  
-   <span data-ttu-id="4e12a-218">处理的消息的大小</span><span class="sxs-lookup"><span data-stu-id="4e12a-218">Size of messages processed</span></span>  
  
-   <span data-ttu-id="4e12a-219">消息吞吐量</span><span class="sxs-lookup"><span data-stu-id="4e12a-219">Throughput of messages</span></span>  
  
-   <span data-ttu-id="4e12a-220">业务流程设计</span><span class="sxs-lookup"><span data-stu-id="4e12a-220">Orchestration design</span></span>  
  
-   <span data-ttu-id="4e12a-221">管道处理</span><span class="sxs-lookup"><span data-stu-id="4e12a-221">Pipeline processing</span></span>  
  
-   <span data-ttu-id="4e12a-222">你打算运行虚拟机中的 BizTalk 主机数</span><span class="sxs-lookup"><span data-stu-id="4e12a-222">Number of BizTalk hosts that you plan to run within the virtual machine</span></span>  
  
 <span data-ttu-id="4e12a-223">有关影响内存的因素的完整列表，请参阅"性能因素"部分的 BizTalk Server 性能优化指南在[http://go.microsoft.com/fwlink/?LinkId=122587](http://go.microsoft.com/fwlink/?LinkId=122587)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-223">For a comprehensive list of factors that affect memory, see “The Performance Factors” section of the BizTalk Server Performance Optimizations Guide at [http://go.microsoft.com/fwlink/?LinkId=122587](http://go.microsoft.com/fwlink/?LinkId=122587).</span></span>  
  
 <span data-ttu-id="4e12a-224">主动监视**内存/可用兆字节数**计数器从每个虚拟机和根分区本身中。</span><span class="sxs-lookup"><span data-stu-id="4e12a-224">Proactively monitor the **Memory/Available Mbytes** counter from within each virtual machine and the root partition itself.</span></span> <span data-ttu-id="4e12a-225">从以下准则[清单： HYPER-V 上的测量性能](../technical-guides/checklist-measuring-performance-on-hyper-v.md)应该用于确定是否有足够的可用物理内存的虚拟机和根分区：</span><span class="sxs-lookup"><span data-stu-id="4e12a-225">The following guidelines from [Checklist: Measuring Performance on Hyper-V](../technical-guides/checklist-measuring-performance-on-hyper-v.md) should be used to determine whether there is enough available physical memory for the virtual machine and for the root partition:</span></span>  
  
-   <span data-ttu-id="4e12a-226">可用内存的 50%或更 = 正常</span><span class="sxs-lookup"><span data-stu-id="4e12a-226">50% of free memory available or more = Healthy</span></span>  
  
-   <span data-ttu-id="4e12a-227">25%的可用内存 = 监视器</span><span class="sxs-lookup"><span data-stu-id="4e12a-227">25% of free memory available = Monitor</span></span>  
  
-   <span data-ttu-id="4e12a-228">可用内存的 10%= 警告</span><span class="sxs-lookup"><span data-stu-id="4e12a-228">10% of free memory available = Warning</span></span>  
  
-   <span data-ttu-id="4e12a-229">小于 5%的可用内存 = 严重，性能将会受到不利影响</span><span class="sxs-lookup"><span data-stu-id="4e12a-229">Less than 5% of free memory available = Critical, performance will be adversely affected</span></span>  
  
#### <a name="choosing-root-operating-system-version"></a><span data-ttu-id="4e12a-230">选择根操作系统版本</span><span class="sxs-lookup"><span data-stu-id="4e12a-230">Choosing Root Operating System Version</span></span>  
 <span data-ttu-id="4e12a-231">HYPER-V 支持服务器核心完全安装的上[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4e12a-231">Hyper-V is supported on a Server Core as well as a full installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="4e12a-232">若要根分区的开销降到最低，请安装 HYPER-V 的服务器核心安装上[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4e12a-232">To minimize the overhead of the root partition, install Hyper-V on a Server Core installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="4e12a-233">可以从不同的系统上的 HYPER-V 管理器远程管理 HYPER-V 角色。</span><span class="sxs-lookup"><span data-stu-id="4e12a-233">The Hyper-V role can be managed remotely from the Hyper-V Manager on a different system.</span></span> <span data-ttu-id="4e12a-234">服务器核心提供了一个小磁盘和内存配置文件，因此，将保留可用于虚拟机的更多资源。</span><span class="sxs-lookup"><span data-stu-id="4e12a-234">Server Core provides a smaller disk and memory profile, therefore, leaving more resources available for virtual machines.</span></span> <span data-ttu-id="4e12a-235">有关可用于的服务器核心安装选项的详细信息[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]，请参阅[http://go.microsoft.com/fwlink/?LinkID=202439](http://go.microsoft.com/fwlink/?LinkID=202439)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-235">For more information about the Server Core installation option available for [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)], see [http://go.microsoft.com/fwlink/?LinkID=202439](http://go.microsoft.com/fwlink/?LinkID=202439).</span></span>  
  
 <span data-ttu-id="4e12a-236">如果你选择使用完全安装的[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]，确保根分区专用于 HYPER-V 服务器角色。</span><span class="sxs-lookup"><span data-stu-id="4e12a-236">If you choose to use a full installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)], ensure that the root partition is dedicated only to the Hyper-V server role.</span></span> <span data-ttu-id="4e12a-237">运行其他服务器角色将会占用内存、 磁盘、 处理器和网络资源，将降低性能。</span><span class="sxs-lookup"><span data-stu-id="4e12a-237">Running additional server roles will consume memory, disk, processor, and network resources and will degrade performance.</span></span>  
  
#### <a name="creating-your-virtual-machines"></a><span data-ttu-id="4e12a-238">创建虚拟机</span><span class="sxs-lookup"><span data-stu-id="4e12a-238">Creating Your Virtual Machines</span></span>  
 <span data-ttu-id="4e12a-239">已安装并配置 HYPER-V 服务器角色之后，你需要创建虚拟机。</span><span class="sxs-lookup"><span data-stu-id="4e12a-239">After you have installed and configured the Hyper-V server role, you need to create the virtual machines.</span></span> <span data-ttu-id="4e12a-240">之前执行此操作，它可用于回答以下问题：</span><span class="sxs-lookup"><span data-stu-id="4e12a-240">Before doing this, it is useful to answer the following questions:</span></span>  
  
-   <span data-ttu-id="4e12a-241">将使用何种存储配置？</span><span class="sxs-lookup"><span data-stu-id="4e12a-241">What storage configuration will I use?</span></span>  
  
-   <span data-ttu-id="4e12a-242">来宾操作系统支持虚拟处理器数量？</span><span class="sxs-lookup"><span data-stu-id="4e12a-242">How many virtual processors does the guest operating system support?</span></span>  
  
-   <span data-ttu-id="4e12a-243">将到虚拟机分配多少内存？</span><span class="sxs-lookup"><span data-stu-id="4e12a-243">How much memory will be allocated to the virtual machine?</span></span>  
  
-   <span data-ttu-id="4e12a-244">在我的 HYPER-V 服务器上可以运行多少个虚拟机？</span><span class="sxs-lookup"><span data-stu-id="4e12a-244">How many virtual machines can I run on my Hyper-V Server?</span></span>  
  
-   <span data-ttu-id="4e12a-245">如何将安装到计算机的操作系统？</span><span class="sxs-lookup"><span data-stu-id="4e12a-245">How will I install the operating system onto the machine?</span></span>  
  
 <span data-ttu-id="4e12a-246">有关如何创建和配置虚拟机的详细信息，请参阅[创建虚拟机](http://go.microsoft.com/fwlink/?LinkID=202440)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-246">For more information about how to create and configure virtual machines, see [Create Virtual Machines](http://go.microsoft.com/fwlink/?LinkID=202440).</span></span>  
  
##### <a name="installing-the-base-operating-system"></a><span data-ttu-id="4e12a-247">安装基本操作系统</span><span class="sxs-lookup"><span data-stu-id="4e12a-247">Installing the Base Operating System</span></span>  
 <span data-ttu-id="4e12a-248">在 HYPER-V 中有可供物理服务器安装的所有选项。</span><span class="sxs-lookup"><span data-stu-id="4e12a-248">All the options available for a physical server installation are available in Hyper-V.</span></span> <span data-ttu-id="4e12a-249">可启动 CD/DVD-ROM 媒体或 ISO 映像可用于执行的手动安装。</span><span class="sxs-lookup"><span data-stu-id="4e12a-249">A bootable CD/DVD-ROM media or an ISO image can be used to perform a manual installation.</span></span> <span data-ttu-id="4e12a-250">如果已使用连接到与承载 ISO 映像的服务器位于同一网络的网络适配器配置虚拟机，可以执行的网络安装。</span><span class="sxs-lookup"><span data-stu-id="4e12a-250">A network installation can be performed if the virtual machine has been configured with a network adapter connected to the same network as a server that hosts the ISO images.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="4e12a-251">选择任何一种安装方法，出于性能原因很重要操作系统集成组件安装在 HYPER-V 中运行每个虚拟机。</span><span class="sxs-lookup"><span data-stu-id="4e12a-251">Whichever installation method is chosen, for performance reasons it is critical the operating system integration components be installed for each virtual machine running under Hyper-V.</span></span> <span data-ttu-id="4e12a-252">集成组件提供驱动程序和服务的支持的来宾计算机，通过使用合成设备来执行一的组。</span><span class="sxs-lookup"><span data-stu-id="4e12a-252">The integration components provide a set of drivers and services that enable the guest machine to perform by using synthetic devices.</span></span> <span data-ttu-id="4e12a-253">合成设备避免对模拟的设备，这在不支持集成组件的操作系统上使用的需求。</span><span class="sxs-lookup"><span data-stu-id="4e12a-253">Synthetic devices avoid the need for emulated devices, which are used on operating systems that do not support integration components.</span></span> <span data-ttu-id="4e12a-254">模拟的设备会产生更大的系统开销相比合成设备。</span><span class="sxs-lookup"><span data-stu-id="4e12a-254">Emulated devices incur greater system overhead compared to synthetic devices.</span></span>  
  
 <span data-ttu-id="4e12a-255">若要安装和配置本实验室中使用的计算机，初始的基本映像已创建固定大小的 VHD。</span><span class="sxs-lookup"><span data-stu-id="4e12a-255">To install and configure the machines used in this lab, an initial base image was created on a fixed size VHD.</span></span> <span data-ttu-id="4e12a-256">这涉及到的手动安装[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4e12a-256">This involved a manual installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="4e12a-257">一旦已安装所有合适的更新基的虚拟机进行映像使用 sysprep 实用工具 %WINDIR%\system32\sysprep 目录中随 Windows Server 2008 一起安装。</span><span class="sxs-lookup"><span data-stu-id="4e12a-257">Once all appropriate updates had been installed the base virtual machine was imaged using sysprep utility that is installed with Windows Server 2008, in the %WINDIR%\system32\sysprep directory.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4e12a-258">可以通过使用 Sysprep 应答文件和与 BizTalk Server 附带提供的脚本完成之后 BizTalk Server 已安装并配置服务器上运行 Sysprep。</span><span class="sxs-lookup"><span data-stu-id="4e12a-258">Running Sysprep after BizTalk Server has been installed and configured on the server can be accomplished through the use of a Sysprep answer file and scripts provided with BizTalk Server.</span></span> <span data-ttu-id="4e12a-259">与 BizTalk Server 上安装这些示例脚本旨在用于[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4e12a-259">These sample scripts are designed for use with BizTalk Server installed on [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="4e12a-260">有关详细信息请参阅 BizTalk Server 联机文档。</span><span class="sxs-lookup"><span data-stu-id="4e12a-260">For more information see the BizTalk Server online documentation.</span></span>  
  
## <a name="installing-and-configuring-biztalk-server"></a><span data-ttu-id="4e12a-261">安装和配置 BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="4e12a-261">Installing and Configuring BizTalk Server</span></span>  
  
-   <span data-ttu-id="4e12a-262">若要最小化安装虚拟机所需的时间，创建基本映像只包含来宾操作系统和软件必备项。</span><span class="sxs-lookup"><span data-stu-id="4e12a-262">To minimize the time required to install virtual machines, create a base image consisting only of the guest operating system and software prerequisites.</span></span> <span data-ttu-id="4e12a-263">使用 SysPrep 准备的 VHD 映像以供重复使用，，然后的所有虚拟机 (Vm) 都基础此 VHD。</span><span class="sxs-lookup"><span data-stu-id="4e12a-263">Use SysPrep to prepare the VHD image for reuse, and then base all your virtual machines (VMs) on this VHD.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4e12a-264">使用 BizTalk Server 中，就可能对基本映像运行 Sysprep*后*已安装并在服务器上配置 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="4e12a-264">With BizTalk Server, it is possible to run Sysprep against a base image *after*BizTalk Server has been installed and configured on the server.</span></span> <span data-ttu-id="4e12a-265">这可以通过使用 Sysprep 应答文件和与 BizTalk Server 附带提供的脚本来完成。</span><span class="sxs-lookup"><span data-stu-id="4e12a-265">This can be accomplished through the use of a Sysprep answer file and scripts provided with BizTalk Server.</span></span> <span data-ttu-id="4e12a-266">与 BizTalk Server 上安装这些示例脚本旨在用于[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4e12a-266">These sample scripts are designed for use with BizTalk Server installed on   [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] .</span></span> <span data-ttu-id="4e12a-267">有关详细信息请参阅 BizTalk Server 联机文档。</span><span class="sxs-lookup"><span data-stu-id="4e12a-267">For more information see the BizTalk Server online documentation.</span></span>  
    >   
    >  <span data-ttu-id="4e12a-268">无人参与 Windows 安装参考位于[http://go.microsoft.com/fwlink/?LinkId=142364](http://go.microsoft.com/fwlink/?LinkId=142364)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-268">The Unattended Windows Setup Reference is available at [http://go.microsoft.com/fwlink/?LinkId=142364](http://go.microsoft.com/fwlink/?LinkId=142364).</span></span>  
  
-   <span data-ttu-id="4e12a-269">请按照"时安装和配置 BizTalk Server …"中的建议</span><span class="sxs-lookup"><span data-stu-id="4e12a-269">Follow the recommendations in the “When Installing and Configuring BizTalk Server…”</span></span> <span data-ttu-id="4e12a-270">主题的部分[清单： 安装和配置 HYPER-V 上的 BizTalk Server 最佳做法](../technical-guides/checklist-best-practices-to-install-and-configure-biztalk-server-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-270">section of the topic [Checklist: Best Practices for Installing and Configuring BizTalk Server on Hyper-V](../technical-guides/checklist-best-practices-to-install-and-configure-biztalk-server-on-hyper-v.md).</span></span>  
  
-   <span data-ttu-id="4e12a-271">有关信息的可支持性[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]和[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]在 HYPER-V 环境中，请参阅[附录 c: BizTalk Server 和 SQL Server HYPER-V 可支持性](../technical-guides/appendix-c-biztalk-server-and-sql-server-hyper-v-supportability.md)。</span><span class="sxs-lookup"><span data-stu-id="4e12a-271">For information on the supportability of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] in a Hyper-V environment, see [Appendix C: BizTalk Server and SQL Server Hyper-V Supportability](../technical-guides/appendix-c-biztalk-server-and-sql-server-hyper-v-supportability.md).</span></span>