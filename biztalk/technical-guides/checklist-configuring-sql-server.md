---
title: 清单：配置 SQL Server |Microsoft Docs
ms.custom: ''
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: edd20f24-8a72-40b7-abee-81fbd3ceefda
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 11ddb15c9086d8aeadf65da399a99598ae91a895
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65291457"
---
# <a name="checklist-configuring-sql-server"></a><span data-ttu-id="24ac9-102">清单：配置 SQL Server</span><span class="sxs-lookup"><span data-stu-id="24ac9-102">Checklist: Configuring SQL Server</span></span>
<span data-ttu-id="24ac9-103">要执行准备为 SQL Server 时的步骤使用在 BizTalk Server 生产环境中。</span><span class="sxs-lookup"><span data-stu-id="24ac9-103">Steps to follow when preparing SQL Server for use in a BizTalk Server production environment.</span></span>    
 
<a name="BKMK_Config"></a>   
## <a name="configuring-sql-server"></a><span data-ttu-id="24ac9-104">配置 SQL Server</span><span class="sxs-lookup"><span data-stu-id="24ac9-104">Configuring SQL Server</span></span>  
  
|<span data-ttu-id="24ac9-105">步骤</span><span class="sxs-lookup"><span data-stu-id="24ac9-105">Steps</span></span>|<span data-ttu-id="24ac9-106">参考</span><span class="sxs-lookup"><span data-stu-id="24ac9-106">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="24ac9-107">监视和减少 BizTalk Server 数据库文件磁盘 I/O 争用。</span><span class="sxs-lookup"><span data-stu-id="24ac9-107">Monitor and reduce BizTalk Server database files disk I/O contention.</span></span>|<span data-ttu-id="24ac9-108">-我们建议你主动监视存放的数据和事务日志文件的磁盘的磁盘 I/O 使用情况。</span><span class="sxs-lookup"><span data-stu-id="24ac9-108">-   We recommend that you proactively monitor the disk I/O usage for the disks that house the data and transaction log files.</span></span><br /><span data-ttu-id="24ac9-109">-我们建议，数据文件和事务日志文件的每个将置于专门的驱动器来减少磁盘 I/O 争用成为问题的可能性。</span><span class="sxs-lookup"><span data-stu-id="24ac9-109">-   We recommend that the data files and transaction log files for each of these be placed on dedicated drives to reduce the likelihood of disk I/O contention becoming a problem.</span></span><br /><span data-ttu-id="24ac9-110">-你可以减少磁盘 I/O 争用，通过将 MessageBox 和跟踪 (DTA) 的数据库，并通过分离数据库文件和事务日志文件在不同的物理磁盘上。</span><span class="sxs-lookup"><span data-stu-id="24ac9-110">-   You can reduce disk I/O contention by separating the MessageBox and Tracking (DTA) databases, and by separating the database files and transaction log files on different physical disks.</span></span><br /><br /> <span data-ttu-id="24ac9-111">有关详细信息，请参阅[监视和降低数据库 IO 争用](monitoring-and-reducing-database-i-o-contention.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-111">For more information, see [Monitoring and Reducing Database IO Contention](monitoring-and-reducing-database-i-o-contention.md)</span></span>|  
|<span data-ttu-id="24ac9-112">请确保正确地对齐磁盘分区上配置 SQL Server</span><span class="sxs-lookup"><span data-stu-id="24ac9-112">Ensure SQL Server is configured on properly-aligned disk partitions</span></span>|<span data-ttu-id="24ac9-113">正确地对齐的磁盘分区可能会导致延迟，从而改进 SQL Server 性能，又可以提高 BizTalk Server 性能显著降低。</span><span class="sxs-lookup"><span data-stu-id="24ac9-113">Properly aligned disk partitions could result in significant decrease in latency thereby improving the SQL Server performance, which in turn enhances BizTalk Server performance.</span></span> <span data-ttu-id="24ac9-114">相反，非对齐的磁盘分区产生负面影响 I/O 性能，从而降低 SQL Server 和 BizTalk Server 性能。</span><span class="sxs-lookup"><span data-stu-id="24ac9-114">On the contrary, nonaligned disk partitions can negatively affect I/O performance, thereby degrading the SQL Server and BizTalk Server performance.</span></span><br /><br /> <span data-ttu-id="24ac9-115">有关如何正确对齐磁盘分区的详细信息时可能会影响性能，请参阅[磁盘分区对齐方式适用于 SQL Server 的最佳做法](http://go.microsoft.com/fwlink/?LinkId=154073)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-115">For more information about how properly aligned disk partitions can positively affect performance, see [Disk Partition Alignment Best Practices for SQL Server](http://go.microsoft.com/fwlink/?LinkId=154073).</span></span>|  
|<span data-ttu-id="24ac9-116">保留您使用 SQL Server Profiler 来监视的事件</span><span class="sxs-lookup"><span data-stu-id="24ac9-116">Keep the events you monitor with the SQL Server Profiler</span></span>|<span data-ttu-id="24ac9-117">使用 SQL Server Profiler 来监视感兴趣的事件。</span><span class="sxs-lookup"><span data-stu-id="24ac9-117">Use SQL Server Profiler to monitor only the events in which you are interested.</span></span> <span data-ttu-id="24ac9-118">如果跟踪变得太大，可以筛选它们基于所需的信息，以便收集事件数据的一个子集。</span><span class="sxs-lookup"><span data-stu-id="24ac9-118">If traces become too large, you can filter them based on the information you want, so that only a subset of the event data is collected.</span></span> <span data-ttu-id="24ac9-119">监视过多事件会增加服务器和监视进程的开销，并且可能导致跟踪文件或跟踪表变得很大，尤其是当监视进程持续很长时间时。</span><span class="sxs-lookup"><span data-stu-id="24ac9-119">Monitoring too many events adds overhead to the server and the monitoring process, and can cause the trace file or trace table to grow very large, especially when the monitoring process takes place over a long period of time.</span></span>|  
|<span data-ttu-id="24ac9-120">监视和降低 DTC 日志文件磁盘 I/O 争用。</span><span class="sxs-lookup"><span data-stu-id="24ac9-120">Monitor and reduce DTC log file disk I/O contention.</span></span>|[<span data-ttu-id="24ac9-121">监视和降低 DTC 日志文件磁盘 IO 争用</span><span class="sxs-lookup"><span data-stu-id="24ac9-121">Monitoring and Reducing DTC Log File Disk IO Contention</span></span>](monitoring-and-reducing-dtc-log-file-disk-i-o-contention.md)|  
|<span data-ttu-id="24ac9-122">为 SQL Server 数据库提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="24ac9-122">Provide high availability for the SQL Server databases.</span></span>|[<span data-ttu-id="24ac9-123">规划数据库可用性</span><span class="sxs-lookup"><span data-stu-id="24ac9-123">Planning for Database Availability</span></span>](planning-for-database-availability.md)|  
|<span data-ttu-id="24ac9-124">查看故障转移方案的主动/主动 SQL Server 群集配置。</span><span class="sxs-lookup"><span data-stu-id="24ac9-124">Review active/active SQL Server cluster configuration for failover scenarios.</span></span>|[<span data-ttu-id="24ac9-125">查看和测试故障转移方案的 SQL Server 群集配置</span><span class="sxs-lookup"><span data-stu-id="24ac9-125">Reviewing and Testing SQL Server Cluster Configuration for Failover Scenarios</span></span>](reviewing-and-testing-sql-server-cluster-configuration-for-failover-scenarios.md)|  
|<span data-ttu-id="24ac9-126">使用默认配置设置：</span><span class="sxs-lookup"><span data-stu-id="24ac9-126">Use default configuration settings for:</span></span><br /><br /> <span data-ttu-id="24ac9-127">-最大并行度 (MDOP)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-127">-   Max Degree of Parallelism (MDOP).</span></span><br /><span data-ttu-id="24ac9-128">的在 BizTalk Server MessageBox 数据库上 SQL Server 统计信息。</span><span class="sxs-lookup"><span data-stu-id="24ac9-128">-   SQL Server statistics on the BizTalk Server MessageBox database.</span></span><br /><span data-ttu-id="24ac9-129">-SQL Server 数据库索引重新生成和碎片整理。</span><span class="sxs-lookup"><span data-stu-id="24ac9-129">-   SQL Server database index rebuilds and defragmentation.</span></span>|[<span data-ttu-id="24ac9-130">不可更改的 SQL Server 设置</span><span class="sxs-lookup"><span data-stu-id="24ac9-130">SQL Server Settings That Should Not Be Changed</span></span>](sql-server-settings-that-should-not-be-changed.md)|  
|<span data-ttu-id="24ac9-131">启用跟踪标志 1118 (TF1118) 作为启动参数的 SQL Server 的所有实例。</span><span class="sxs-lookup"><span data-stu-id="24ac9-131">Enable trace flag 1118 (TF1118) as a startup parameter for all instances of SQL Server.</span></span>|<span data-ttu-id="24ac9-132">实现 TF1118 有助于减少 SQL Server 实例之间的争用，通过删除几乎所有的单页分配。</span><span class="sxs-lookup"><span data-stu-id="24ac9-132">Implementing TF1118 helps reduce contention across the SQL Server instances by removing almost all single page allocations.</span></span> <span data-ttu-id="24ac9-133">有关详细信息，请参阅 Microsoft 知识库文章[tempdb 数据库的并发性增强功能](https://support.microsoft.com/en-us/help/328551/concurrency-enhancements-for-the-tempdb-database)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-133">For more information see Microsoft Knowledge Base article [Concurrency enhancements for the tempdb database](https://support.microsoft.com/en-us/help/328551/concurrency-enhancements-for-the-tempdb-database).</span></span> <br/><br/><span data-ttu-id="24ac9-134">**注意：** 有关 TF1118 的详细信息请参阅[围绕 TF1118 误解](https://www.sqlskills.com/blogs/paul/misconceptions-around-tf-1118/)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-134">**Note:**  For more information about TF1118 see [Misconceptions around TF1118](https://www.sqlskills.com/blogs/paul/misconceptions-around-tf-1118/).</span></span> <span data-ttu-id="24ac9-135">请注意，此链接中的内容不由 Microsoft 拥有，Microsoft 不保证内容的准确性。</span><span class="sxs-lookup"><span data-stu-id="24ac9-135">Note that the content at this link is not owned by Microsoft and Microsoft does not guarantee the accuracy of the content.</span></span>|  
|<span data-ttu-id="24ac9-136">将 tempdb 数据库拆分为多个大小相等的 BizTalk Server 使用的每个 SQL Server 实例上的数据文件。</span><span class="sxs-lookup"><span data-stu-id="24ac9-136">Split the tempdb database into multiple data files of equal size on each SQL Server instance used by BizTalk Server.</span></span>|<span data-ttu-id="24ac9-137">确保使用的 tempdb 数据文件大小相等。</span><span class="sxs-lookup"><span data-stu-id="24ac9-137">Ensure that the data files used for the tempdb are of equal size.</span></span> <span data-ttu-id="24ac9-138">这是关键，因为 SQL Server 使用的按比例填充算法基于数据文件的大小。</span><span class="sxs-lookup"><span data-stu-id="24ac9-138">This is critical because the proportional fill algorithm used by SQL Server is based on the size of the data files.</span></span> <span data-ttu-id="24ac9-139">如果使用不相等大小创建数据文件，按比例填充算法将使用更多全局分配映射 (GAM) 分配，而不是所有的文件，从而达到监控目的创建多个之间进行分配的最大文件数据文件。</span><span class="sxs-lookup"><span data-stu-id="24ac9-139">If data files are created with unequal sizes, the proportional fill algorithm will use the largest file more for Global Allocation Map (GAM) allocations rather than spreading the allocations between all the files, thereby defeating the purpose of creating multiple data files.</span></span> <span data-ttu-id="24ac9-140">一般原则是，为每个 CPU 的服务器上创建一个数据文件，然后调整根据需要向上或向下文件数。</span><span class="sxs-lookup"><span data-stu-id="24ac9-140">As a general guideline, create one data file for each CPU on the server and then adjust the number of files up or down as necessary.</span></span> <span data-ttu-id="24ac9-141">请注意，双核心 CPU 视为两个 cpu。</span><span class="sxs-lookup"><span data-stu-id="24ac9-141">Note that a dual-core CPU is considered to be two CPUs.</span></span> <span data-ttu-id="24ac9-142">在任何情况下，数据文件数不能大于 8 无论多少个内核，以便在计算机上可用。</span><span class="sxs-lookup"><span data-stu-id="24ac9-142">In any event, the number of data files must not be greater than 8 no matter how many additional cores are available on the computer.</span></span> <span data-ttu-id="24ac9-143">有关 tempdb 文件的详细信息，请参阅[优化 tempdb 性能](https://docs.microsoft.com/sql/relational-databases/databases/tempdb-database)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-143">For more information about tempdb files, see [Optimizing tempdb Performance](https://docs.microsoft.com/sql/relational-databases/databases/tempdb-database).</span></span>|  
|<span data-ttu-id="24ac9-144">设置最小值，并为 SQL Server 上的相同值的最大服务器内存个该主机实例的 BizTalk Server 数据库。</span><span class="sxs-lookup"><span data-stu-id="24ac9-144">Set the Minimum and Maximum Server memory to the same values on the SQL Server instance(s) that host the BizTalk Server databases.</span></span>|<span data-ttu-id="24ac9-145">运行该主机的 SQL Server 的计算机应将 BizTalk Server 数据库专用于运行 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="24ac9-145">The computers running SQL Server that host the BizTalk Server databases should be dedicated to running SQL Server.</span></span> <span data-ttu-id="24ac9-146">当运行该主机的 SQL Server 的计算机 BizTalk Server 数据库**是**专用于运行 SQL Server，我们建议，min server memory 和最大服务器内存设置每个 SQL Server 实例上的选项来指定要分配到 SQL Server 的内存量固定。</span><span class="sxs-lookup"><span data-stu-id="24ac9-146">When the computers running SQL Server that host the BizTalk Server databases **are** dedicated to running SQL Server, we recommend that the 'min server memory' and 'max server memory' options on each SQL Server instance be set to specify the fixed amount of memory to allocate to SQL Server.</span></span> <span data-ttu-id="24ac9-147">在这种情况下，您应将 min server memory 和最大服务器内存为相同的值 （设置为最大的 SQL Server 将使用的物理内存量）。</span><span class="sxs-lookup"><span data-stu-id="24ac9-147">In this case, you should set the 'min server memory' and 'max server memory' to the same value (equal to the maximum amount of physical memory that SQL Server will use).</span></span> <span data-ttu-id="24ac9-148">这将减少开销，否则将使用 SQL server 动态地管理这些值。</span><span class="sxs-lookup"><span data-stu-id="24ac9-148">This will reduce overhead that would otherwise be used by SQL Server dynamically managing these values.</span></span> <span data-ttu-id="24ac9-149">在运行 SQL Server 以指定要分配到 SQL Server 的内存量固定每台计算机上执行以下 T-SQL 命令：</span><span class="sxs-lookup"><span data-stu-id="24ac9-149">Execute the following T-SQL commands on each computer running SQL Server to specify the fixed amount of memory to allocate to SQL Server:</span></span><br /><br /> <span data-ttu-id="24ac9-150">sp_configure 最大服务器内存 (MB)，（以 mb 为单位的最大大小） sp_configure 最小服务器内存 (MB)，（以 mb 为单位的最小大小）</span><span class="sxs-lookup"><span data-stu-id="24ac9-150">sp_configure ‘Max Server memory (MB)’,(max size in MB)sp_configure ‘Min Server memory (MB)’,(min size in MB)</span></span><br /><br /> <span data-ttu-id="24ac9-151">为 SQL Server 设置的内存量之前，请通过减去总物理内存中适用于 Windows Server 所需的内存来确定适当的内存设置。</span><span class="sxs-lookup"><span data-stu-id="24ac9-151">Before you set the amount of memory for SQL Server, determine the appropriate memory setting by subtracting the memory required for Windows Server from the total physical memory.</span></span> <span data-ttu-id="24ac9-152">这是内存的最大可以为 SQL Server 分配量。</span><span class="sxs-lookup"><span data-stu-id="24ac9-152">This is the maximum amount of memory you can assign to SQL Server.</span></span> <span data-ttu-id="24ac9-153">**注意：** 如果运行 BizTalk Server 数据库也承载的 SQL Server 的计算机托管企业单一登录主密钥，如本主题中所述[聚类分析主密钥服务器](clustering-the-master-secret-server.md)则可能需要调整此值设置为确保有足够的内存可用于运行企业单一登录服务。</span><span class="sxs-lookup"><span data-stu-id="24ac9-153">**Note:**  If the computer(s) running SQL Server that host the BizTalk Server databases also host the Enterprise Single Sign-On master secret as described in the topic [Clustering the Master Secret Server](clustering-the-master-secret-server.md) then you may need to adjust this value to ensure that there is sufficient memory available to run the Enterprise Single Sign-On Service.</span></span>|  
|<span data-ttu-id="24ac9-154">BizTalk 跟踪数据库的大小</span><span class="sxs-lookup"><span data-stu-id="24ac9-154">Account for the size of BizTalk Tracking database</span></span>|<span data-ttu-id="24ac9-155">-当确定 BizTalk 跟踪 (DTA) 数据库中的消息的大小，向消息上下文的平均大小的消息大小如果这一点非常重要的消息大小。</span><span class="sxs-lookup"><span data-stu-id="24ac9-155">-   When determining the size of messages in the BizTalk Tracking (DTA) database, add the average size of the message context to the message size if it is significant compared to the message size.</span></span><br /><span data-ttu-id="24ac9-156">-若要将 BizTalk 跟踪数据库中的消息大小限制，限制提升的属性的数目。</span><span class="sxs-lookup"><span data-stu-id="24ac9-156">-   To limit the size of messages in the BizTalk Tracking database, limit the number of properties that you promote.</span></span><br /><span data-ttu-id="24ac9-157">-如果启用了业务流程调试器选项，请考虑在业务流程中每个形状的状态保存在 BizTalk 跟踪数据库中。</span><span class="sxs-lookup"><span data-stu-id="24ac9-157">-   If the orchestration debugger option is enabled, take into account that the status of each shape in the orchestration is saved in the BizTalk Tracking database.</span></span>|  
  
<a name="BKMK_Maintain"></a>   
## <a name="performing-sql-server-maintenance-procedures"></a><span data-ttu-id="24ac9-158">执行 SQL Server 维护过程</span><span class="sxs-lookup"><span data-stu-id="24ac9-158">Performing SQL Server Maintenance Procedures</span></span>  
  
|<span data-ttu-id="24ac9-159">步骤</span><span class="sxs-lookup"><span data-stu-id="24ac9-159">Steps</span></span>|<span data-ttu-id="24ac9-160">参考</span><span class="sxs-lookup"><span data-stu-id="24ac9-160">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="24ac9-161">定义 BizTalk Server 数据库的自动增长设置。</span><span class="sxs-lookup"><span data-stu-id="24ac9-161">Define auto-growth settings for the BizTalk Server databases.</span></span>|<span data-ttu-id="24ac9-162">尤其对于 MessageBox 和跟踪数据库，数据库自动增长应设置为固定数量的而不是百分比，兆字节为单位。</span><span class="sxs-lookup"><span data-stu-id="24ac9-162">-   Database auto-growth should be set to a fixed number of megabytes instead of a percentage, especially for the MessageBox and Tracking databases.</span></span> <span data-ttu-id="24ac9-163">具体取决于您的 BizTalk Server 应用程序和吞吐量，MessageBox 和跟踪数据库可能会非常大。</span><span class="sxs-lookup"><span data-stu-id="24ac9-163">Depending on your BizTalk Server application and throughput, the MessageBox and Tracking databases can get quite large.</span></span> <span data-ttu-id="24ac9-164">如果自动增长设置为百分比，则自动增长可能是重大。</span><span class="sxs-lookup"><span data-stu-id="24ac9-164">If auto-growth is set to a percentage, then the auto-growth can be substantial as well.</span></span><br /><span data-ttu-id="24ac9-165">-即时文件初始化可以大大减少文件增长操作的性能影响。</span><span class="sxs-lookup"><span data-stu-id="24ac9-165">-   Instant file initialization can greatly reduce the performance impact of a file growth operation.</span></span><br /><span data-ttu-id="24ac9-166">-理想情况下，支持的文件组的文件的大小应为预分配，和如果可能，请设置为静态的大小。</span><span class="sxs-lookup"><span data-stu-id="24ac9-166">-   Ideally, the size of files supporting the file groups should be pre-allocated, and if possible, set to a static size.</span></span><br /><br /> <span data-ttu-id="24ac9-167">有关详细信息，请参阅[定义数据库的自动增长设置](defining-auto-growth-settings-for-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-167">For more information, see [Defining Auto-Growth Settings for Databases](defining-auto-growth-settings-for-databases.md).</span></span>|  
|<span data-ttu-id="24ac9-168">备份 BizTalk Server 数据库</span><span class="sxs-lookup"><span data-stu-id="24ac9-168">Back up the BizTalk Server databases</span></span>|<span data-ttu-id="24ac9-169">-我们建议运行 BizTalk Server 备份作业，若要防止 BizTalk Server 数据库事务日志增长不受限制的方式。</span><span class="sxs-lookup"><span data-stu-id="24ac9-169">-   We recommend running the BizTalk Server backup job to prevent the BizTalk Server database transaction logs from growing in an unbounded fashion.</span></span><br /><span data-ttu-id="24ac9-170">-应还原整个 BizTalk Server 环境定期进行，并且应仔细记录的过程。</span><span class="sxs-lookup"><span data-stu-id="24ac9-170">-   You should restore the entire BizTalk Server environment on a regular basis, and you should carefully document the process.</span></span><br /><span data-ttu-id="24ac9-171">-我们建议您存档旧的备份文件。</span><span class="sxs-lookup"><span data-stu-id="24ac9-171">-   We recommend that you archive old backup files.</span></span><br /><br /> <span data-ttu-id="24ac9-172">有关详细信息，请参阅[备份数据库](backing-up-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-172">For more information, see [Backing Up Databases](backing-up-databases.md).</span></span>|  
|<span data-ttu-id="24ac9-173">监视 BizTalk Server SQL 代理作业。</span><span class="sxs-lookup"><span data-stu-id="24ac9-173">Monitor the BizTalk Server SQL Agent jobs.</span></span>|<span data-ttu-id="24ac9-174">监视这些作业的运行状况，并确保它们无错运行。</span><span class="sxs-lookup"><span data-stu-id="24ac9-174">Monitor the health of these jobs, and ensure that they are running without errors.</span></span> <span data-ttu-id="24ac9-175">有关详细信息，请参阅[监视 SQL Server 代理作业](monitoring-sql-server-agent-jobs.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-175">For more information, see [Monitoring SQL Server Agent Jobs](monitoring-sql-server-agent-jobs.md).</span></span>|  
|<span data-ttu-id="24ac9-176">启用 BizTalk Server 跟踪和存档</span><span class="sxs-lookup"><span data-stu-id="24ac9-176">Enable BizTalk Server tracking and archiving</span></span>|<span data-ttu-id="24ac9-177">"DTA 清除和存档"SQL 代理作业中存档和清除旧数据从 BizTalk 跟踪数据库，从而阻止增长失控。</span><span class="sxs-lookup"><span data-stu-id="24ac9-177">The “DTA Purge and Archive” SQL Agent job archives and purges old data from the BizTalk Tracking database, thus keeping it from growing out of control.</span></span> <span data-ttu-id="24ac9-178">这对于 BizTalk Server 系统正常运行至关重要。</span><span class="sxs-lookup"><span data-stu-id="24ac9-178">This is essential for a healthy BizTalk Server system.</span></span> <span data-ttu-id="24ac9-179">有关详细信息，请参阅[清除和存档跟踪数据](purging-and-archiving-tracking-data.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-179">For more information, see [Purging and Archiving Tracking Data](purging-and-archiving-tracking-data.md).</span></span>|  
  
<a name="BKMK_Backup"></a>   
## <a name="backing-up-the-biztalk-server-databases"></a><span data-ttu-id="24ac9-180">备份 BizTalk Server 数据库</span><span class="sxs-lookup"><span data-stu-id="24ac9-180">Backing Up the BizTalk Server Databases</span></span>  
  
|<span data-ttu-id="24ac9-181">步骤</span><span class="sxs-lookup"><span data-stu-id="24ac9-181">Steps</span></span>|<span data-ttu-id="24ac9-182">参考</span><span class="sxs-lookup"><span data-stu-id="24ac9-182">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="24ac9-183">验证已配置备份 BizTalk Server SQL 代理作业。</span><span class="sxs-lookup"><span data-stu-id="24ac9-183">Verify that the Backup BizTalk Server SQL Agent job is configured.</span></span>|<span data-ttu-id="24ac9-184">请参阅[配置备份 BizTalk Server 作业](../core/how-to-configure-the-backup-biztalk-server-job.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-184">See [Configure the Backup BizTalk Server Job](../core/how-to-configure-the-backup-biztalk-server-job.md)</span></span>|  
|<span data-ttu-id="24ac9-185">配置备份 BizTalk Server SQL 代理作业来删除早于指定天数的备份文件@DaysToKeep变量。</span><span class="sxs-lookup"><span data-stu-id="24ac9-185">Configure the Backup BizTalk Server SQL Agent job to delete backup files that are older than the number of days specified by the @DaysToKeep variable.</span></span> <span data-ttu-id="24ac9-186">如果备份文件不会删除它们可以不受限制不断增长的可能填满磁盘，它包含备份文件，并且会导致有限的磁盘空间与相关的问题。</span><span class="sxs-lookup"><span data-stu-id="24ac9-186">If the backup files are not deleted they can grow unbounded over time which can fill up the disk(s) that contain the backup files and cause problems that relate to limited disk space.</span></span>|<span data-ttu-id="24ac9-187">请参阅[配置备份 BizTalk Server 作业](../core/how-to-configure-the-backup-biztalk-server-job.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-187">See [Configure the Backup BizTalk Server Job](../core/how-to-configure-the-backup-biztalk-server-job.md)</span></span>|  
|<span data-ttu-id="24ac9-188">验证备份 BizTalk Server SQL 代理作业已启用并正在运行。</span><span class="sxs-lookup"><span data-stu-id="24ac9-188">Verify that the Backup BizTalk Server SQL Agent job is enabled and running.</span></span>|[<span data-ttu-id="24ac9-189">监视 SQL Server 代理作业</span><span class="sxs-lookup"><span data-stu-id="24ac9-189">Monitoring SQL Server Agent Jobs</span></span>](monitoring-sql-server-agent-jobs.md)|  
  
<a name="BKMK_Disaster"></a>   
## <a name="using-sql-server-log-shipping-for-disaster-recovery"></a><span data-ttu-id="24ac9-190">使用 SQL Server 日志传送灾难恢复</span><span class="sxs-lookup"><span data-stu-id="24ac9-190">Using SQL Server Log Shipping For Disaster Recovery</span></span>  
  
|<span data-ttu-id="24ac9-191">步骤</span><span class="sxs-lookup"><span data-stu-id="24ac9-191">Steps</span></span>|<span data-ttu-id="24ac9-192">参考</span><span class="sxs-lookup"><span data-stu-id="24ac9-192">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="24ac9-193">验证的灾难恢复服务器都具有容量来处理生产负载。</span><span class="sxs-lookup"><span data-stu-id="24ac9-193">Verify that the disaster recovery servers have the capacity to handle production load.</span></span>|<span data-ttu-id="24ac9-194">请参阅[使用 BizTalk Server 日志传送灾难恢复](using-biztalk-server-log-shipping-for-disaster-recovery.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-194">See [Using BizTalk Server Log Shipping for Disaster Recovery](using-biztalk-server-log-shipping-for-disaster-recovery.md)</span></span>|  
|<span data-ttu-id="24ac9-195">请确保也记录在灾难恢复例程的详细信息。</span><span class="sxs-lookup"><span data-stu-id="24ac9-195">Ensure that the specifics of your disaster recovery routine are well documented.</span></span>|<span data-ttu-id="24ac9-196">请参阅[使用 BizTalk Server 日志传送灾难恢复](using-biztalk-server-log-shipping-for-disaster-recovery.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-196">See [Using BizTalk Server Log Shipping for Disaster Recovery](using-biztalk-server-log-shipping-for-disaster-recovery.md)</span></span>|  
|<span data-ttu-id="24ac9-197">作为常规的测试，实际故障转移到灾难恢复站点的一部分，尤其是当新的 BizTalk 应用程序放在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="24ac9-197">As part of regular testing, practice failover to the disaster recovery site, especially as new BizTalk applications are put in production.</span></span>|<span data-ttu-id="24ac9-198">请参阅[使用 BizTalk Server 日志传送灾难恢复](using-biztalk-server-log-shipping-for-disaster-recovery.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-198">See [Using BizTalk Server Log Shipping for Disaster Recovery](using-biztalk-server-log-shipping-for-disaster-recovery.md)</span></span>|  
  
<a name="BKMK_Jobs"></a>   
## <a name="monitoring-biztalk-server-sql-agent-jobs"></a><span data-ttu-id="24ac9-199">监视 BizTalk Server SQL 代理作业</span><span class="sxs-lookup"><span data-stu-id="24ac9-199">Monitoring BizTalk Server SQL Agent Jobs</span></span>  
  
|<span data-ttu-id="24ac9-200">步骤</span><span class="sxs-lookup"><span data-stu-id="24ac9-200">Steps</span></span>|<span data-ttu-id="24ac9-201">参考</span><span class="sxs-lookup"><span data-stu-id="24ac9-201">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="24ac9-202">验证 SQL Server 代理服务正在运行。</span><span class="sxs-lookup"><span data-stu-id="24ac9-202">Verify that the SQL Server Agent service is running.</span></span>|<span data-ttu-id="24ac9-203">请参阅[监视 SQL Server 代理作业](monitoring-sql-server-agent-jobs.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-203">See [Monitoring SQL Server Agent Jobs](monitoring-sql-server-agent-jobs.md)</span></span>|  
|<span data-ttu-id="24ac9-204">验证 BizTalk server 安装的 SQL Server 代理作业已启用并正在运行成功。</span><span class="sxs-lookup"><span data-stu-id="24ac9-204">Verify that the SQL Server Agent jobs installed by BizTalk Server are enabled and running successfully.</span></span>|<span data-ttu-id="24ac9-205">请参阅[监视 SQL Server 代理作业](monitoring-sql-server-agent-jobs.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-205">See [Monitoring SQL Server Agent Jobs](monitoring-sql-server-agent-jobs.md)</span></span>|  
|<span data-ttu-id="24ac9-206">验证 BizTalk Server SQL 代理作业及时完成。</span><span class="sxs-lookup"><span data-stu-id="24ac9-206">Verify that the BizTalk Server SQL Agent jobs are completing in a timely manner.</span></span>|<span data-ttu-id="24ac9-207">请参阅[监视 SQL Server 代理作业](monitoring-sql-server-agent-jobs.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-207">See [Monitoring SQL Server Agent Jobs](monitoring-sql-server-agent-jobs.md)</span></span>|  
  
<a name="BKMK_Purge"></a>   
## <a name="purging-and-archiving-tracking-data"></a><span data-ttu-id="24ac9-208">清除和存档跟踪数据</span><span class="sxs-lookup"><span data-stu-id="24ac9-208">Purging and Archiving Tracking Data</span></span>  
  
|<span data-ttu-id="24ac9-209">步骤</span><span class="sxs-lookup"><span data-stu-id="24ac9-209">Steps</span></span>|<span data-ttu-id="24ac9-210">参考</span><span class="sxs-lookup"><span data-stu-id="24ac9-210">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="24ac9-211">请确保 SQL 代理作业"DTA 清除和存档"正确配置和启用，并且已成功完成。</span><span class="sxs-lookup"><span data-stu-id="24ac9-211">Ensure that the SQL Agent job "DTA Purge and Archive" is properly configured, enabled, and successfully completing.</span></span>|<span data-ttu-id="24ac9-212">请参阅[配置 DTA 清除和存档作业](../core/how-to-configure-the-dta-purge-and-archive-job.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-212">See [Configure the DTA Purge and Archive Job](../core/how-to-configure-the-dta-purge-and-archive-job.md).</span></span>|  
|<span data-ttu-id="24ac9-213">确保作业可以快速生成传入跟踪数据清除跟踪数据。</span><span class="sxs-lookup"><span data-stu-id="24ac9-213">Ensure that the job is able to purge the tracking data as fast as the incoming tracking data is generated.</span></span>|<span data-ttu-id="24ac9-214">请参阅[测量最大可承受跟踪吞吐量](../core/measuring-maximum-sustainable-tracking-throughput.md)</span><span class="sxs-lookup"><span data-stu-id="24ac9-214">See [Measuring Maximum Sustainable Tracking Throughput](../core/measuring-maximum-sustainable-tracking-throughput.md)</span></span>|  
|<span data-ttu-id="24ac9-215">查看软清除和硬清除参数，以确保保持最佳的时间长度的数据。</span><span class="sxs-lookup"><span data-stu-id="24ac9-215">Review the soft purge and hard purge parameters to ensure you are keeping data for the optimal length of time.</span></span>|<span data-ttu-id="24ac9-216">请参阅[存档和清除 BizTalk 跟踪数据库](../core/archiving-and-purging-the-biztalk-tracking-database.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-216">See [Archiving and Purging the BizTalk Tracking Database](../core/archiving-and-purging-the-biztalk-tracking-database.md).</span></span>|  
|<span data-ttu-id="24ac9-217">如果您只需清除旧数据，则不需要将其存档第一次，更改 SQL 代理作业来调用存储的过程"dtasp_PurgeTrackingDatabase。"</span><span class="sxs-lookup"><span data-stu-id="24ac9-217">If you only need to purge the old data and do not need to archive it first, change the SQL Agent job to call the stored procedure "dtasp_PurgeTrackingDatabase."</span></span>|<span data-ttu-id="24ac9-218">请参阅[从 BizTalk 跟踪数据库中清除数据](../core/how-to-purge-data-from-the-biztalk-tracking-database.md)。</span><span class="sxs-lookup"><span data-stu-id="24ac9-218">See [Purge Data from the BizTalk Tracking Database](../core/how-to-purge-data-from-the-biztalk-tracking-database.md).</span></span>|  
  
## <a name="next"></a><span data-ttu-id="24ac9-219">Next</span><span class="sxs-lookup"><span data-stu-id="24ac9-219">Next</span></span>
  
-   [<span data-ttu-id="24ac9-220">不可更改的 SQL Server 设置</span><span class="sxs-lookup"><span data-stu-id="24ac9-220">SQL Server Settings That Should Not Be Changed</span></span>](sql-server-settings-that-should-not-be-changed.md)  
  
-   [<span data-ttu-id="24ac9-221">监视和降低数据库 IO 争用</span><span class="sxs-lookup"><span data-stu-id="24ac9-221">Monitoring and Reducing Database IO Contention</span></span>](monitoring-and-reducing-database-i-o-contention.md)  
  
-   [<span data-ttu-id="24ac9-222">查看和测试故障转移方案的 SQL Server 群集配置</span><span class="sxs-lookup"><span data-stu-id="24ac9-222">Reviewing and Testing SQL Server Cluster Configuration for Failover Scenarios</span></span>](reviewing-and-testing-sql-server-cluster-configuration-for-failover-scenarios.md)  
  
-   [<span data-ttu-id="24ac9-223">定义数据库的自动增长设置</span><span class="sxs-lookup"><span data-stu-id="24ac9-223">Defining Auto-Growth Settings for Databases</span></span>](defining-auto-growth-settings-for-databases.md)  
  
-   [<span data-ttu-id="24ac9-224">备份数据库</span><span class="sxs-lookup"><span data-stu-id="24ac9-224">Backing Up Databases</span></span>](backing-up-databases.md)  
  
-   [<span data-ttu-id="24ac9-225">为灾难恢复使用 BizTalk Server 日志传送</span><span class="sxs-lookup"><span data-stu-id="24ac9-225">Using BizTalk Server Log Shipping for Disaster Recovery</span></span>](using-biztalk-server-log-shipping-for-disaster-recovery.md)  
  
-   [<span data-ttu-id="24ac9-226">监视 SQL Server 代理作业</span><span class="sxs-lookup"><span data-stu-id="24ac9-226">Monitoring SQL Server Agent Jobs</span></span>](monitoring-sql-server-agent-jobs.md)  
  
-   [<span data-ttu-id="24ac9-227">清除和存档跟踪数据</span><span class="sxs-lookup"><span data-stu-id="24ac9-227">Purging and Archiving Tracking Data</span></span>](purging-and-archiving-tracking-data.md)