---
title: 更新使用的并行版本控制的架构 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a7360ec5-b5e9-40c7-9a7c-965fcc95ddb0
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d3d63b93f665e80f88e2d9e81b2337e7b198b3df
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22302237"
---
# <a name="updating-a-schema-using-side-by-side-versioning"></a><span data-ttu-id="32c2b-102">更新使用的并行版本控制的架构</span><span class="sxs-lookup"><span data-stu-id="32c2b-102">Updating a Schema Using Side-by-Side Versioning</span></span>
<span data-ttu-id="32c2b-103">你可以执行的并行使用架构的版本控制。</span><span class="sxs-lookup"><span data-stu-id="32c2b-103">You can perform side-by-side versioning with schemas.</span></span> <span data-ttu-id="32c2b-104">你可以执行以便通过将新版本的架构添加到程序集，而使现有架构 （和其版本） 升级的架构版本不变。</span><span class="sxs-lookup"><span data-stu-id="32c2b-104">You do so by adding a new version of the schema to an assembly, upgrading the version of the schema, while leaving the existing schema (and its version) unchanged.</span></span>  
  
 <span data-ttu-id="32c2b-105">如果你自动增加的架构版本，则必须更新对任何管道实例和使用它的管道组件的架构的引用。</span><span class="sxs-lookup"><span data-stu-id="32c2b-105">If you increment a schema version, you must update the reference to the schema for any pipeline instances and pipeline components that use it.</span></span> <span data-ttu-id="32c2b-106">以及任何依赖于架构的业务流程，则还必须更新引用的架构 （或创建新的图） 中的映射。</span><span class="sxs-lookup"><span data-stu-id="32c2b-106">You must also update the maps that reference the schema (or create new maps) as well as any orchestrations that rely on the schema.</span></span>  
  
 <span data-ttu-id="32c2b-107">如果你取消部署架构，以前版本的架构，如果可用，将处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="32c2b-107">If you undeploy a schema, the previous version of the schema, if available, will become active.</span></span>  
  
## <a name="schema-resolution-in-pipelines"></a><span data-ttu-id="32c2b-108">管道中的架构解析</span><span class="sxs-lookup"><span data-stu-id="32c2b-108">Schema Resolution in Pipelines</span></span>  
 <span data-ttu-id="32c2b-109">如果你添加到应用程序的程序集具有与现有架构相同的消息类型的新架构包括 BizTalk 组中，管道中发生的架构解析时将使用最新的版本号的架构。</span><span class="sxs-lookup"><span data-stu-id="32c2b-109">If you add to an application an assembly that includes a new schema with the same message type as an existing schema in the BizTalk group, the schema with the latest version number will be used when schema resolution occurs in pipelines.</span></span> <span data-ttu-id="32c2b-110">如果多个.NET 类型引用的是一种消息类型，这种混乱情况可能会导致管道执行失败。</span><span class="sxs-lookup"><span data-stu-id="32c2b-110">If one message type refers to more than one .NET type, this ambiguity may cause pipeline execution failure.</span></span> <span data-ttu-id="32c2b-111">原因在于架构查找使用的是消息类型、目标命名空间和实例的根名称。</span><span class="sxs-lookup"><span data-stu-id="32c2b-111">This is because schema lookup uses message type, the target namespace, and root name of the instance.</span></span> <span data-ttu-id="32c2b-112">此类型故障可能会导致任何应用程序使用相同的消息类型作为新的架构的架构中的管道。</span><span class="sxs-lookup"><span data-stu-id="32c2b-112">This type of failure can occur for pipelines in any application that uses a schema with the same message type as the new schema.</span></span> <span data-ttu-id="32c2b-113">有关架构解析的详细信息，请参阅[管道组件中的架构解析](http://go.microsoft.com/fwlink/?LinkID=154207)(http://go.microsoft.com/fwlink/?LinkID=154207) 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]帮助。</span><span class="sxs-lookup"><span data-stu-id="32c2b-113">For more information about schema resolution, see [Schema Resolution in Pipeline Components](http://go.microsoft.com/fwlink/?LinkID=154207) (http://go.microsoft.com/fwlink/?LinkID=154207) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
 <span data-ttu-id="32c2b-114">添加新版本的并行较旧版本的架构后，XML 反汇编程序的架构解决行为可能需要其他更改。</span><span class="sxs-lookup"><span data-stu-id="32c2b-114">The schema resolution behavior for the XML Disassembler may require additional changes after adding a new version of a schema side by side with an older version.</span></span> <span data-ttu-id="32c2b-115">在某些情况下，你可能想在管道设计器的管道反汇编程序属性中于特定版本的架构的硬编码引用。</span><span class="sxs-lookup"><span data-stu-id="32c2b-115">In certain cases, you may want to hard-code references in the pipeline disassembler properties in the Pipeline Designer to specific versions of the schemas.</span></span> <span data-ttu-id="32c2b-116">这使您可以避免 XML 反汇编程序确定要使用的消息类型动态加载的架构发现在运行时从消息 XML 内容的动态解析行为。</span><span class="sxs-lookup"><span data-stu-id="32c2b-116">This enables you to avoid the dynamic resolution behavior, in which the XML Disassembler determines which schema to load by using the message type dynamically discovered at runtime from the message XML content.</span></span>  
  
## <a name="updating-a-schema-in-an-orchestration"></a><span data-ttu-id="32c2b-117">更新业务流程中的架构</span><span class="sxs-lookup"><span data-stu-id="32c2b-117">Updating a Schema in an Orchestration</span></span>  
 <span data-ttu-id="32c2b-118">当你更改与多个发送关联的架构，并接收形状中业务流程时，在可以使更改更容易通过设置每次发送与关联的消息的消息类型属性，或接收形状上的与多部分消息类型，而不是架构。</span><span class="sxs-lookup"><span data-stu-id="32c2b-118">When you change the schema associated with multiple send and receive shapes in an orchestration, you can make changes much easier by setting the Message Type property for the message associated with each send or receive shape to Multi-part Message Type, rather than Schema.</span></span> <span data-ttu-id="32c2b-119">然后，你可以设置与每个形状是相同的架构相关联的消息部分的类型属性。</span><span class="sxs-lookup"><span data-stu-id="32c2b-119">You can then set the Type property for the message part associated with each shapes to be the same schema.</span></span> <span data-ttu-id="32c2b-120">通过这种方式，你可以随后更改架构，通过更改的类型属性的每个消息部分，而无需更改每个形状的消息类型。</span><span class="sxs-lookup"><span data-stu-id="32c2b-120">By so doing, you can subsequently change the schema by changing the Type property for each message part, rather than having to change the Message Type for each shape.</span></span> <span data-ttu-id="32c2b-121">有关此过程轻松更改的详细信息，请参阅[的更好 BizTalk 编程 8 提示和技巧](http://go.microsoft.com/fwlink/?LinkId=101594)白皮书 (http://go.microsoft.com/fwlink/?LinkId=101594)。</span><span class="sxs-lookup"><span data-stu-id="32c2b-121">For more information about making changes easier by this process, see the [8 Tips and Tricks for Better BizTalk Programming](http://go.microsoft.com/fwlink/?LinkId=101594) white paper (http://go.microsoft.com/fwlink/?LinkId=101594).</span></span>  
  
## <a name="versioning-schemas"></a><span data-ttu-id="32c2b-122">对架构的版本控制</span><span class="sxs-lookup"><span data-stu-id="32c2b-122">Versioning Schemas</span></span>  
 <span data-ttu-id="32c2b-123">BizTalk Server 采用来自包含它的程序集的最新版本的架构。</span><span class="sxs-lookup"><span data-stu-id="32c2b-123">BizTalk Server takes a schema from the most recent version of the assembly containing it.</span></span> <span data-ttu-id="32c2b-124">这意味着，如果你创建新的架构版本，最新版本完全替换所有以前版本的架构。</span><span class="sxs-lookup"><span data-stu-id="32c2b-124">This means that if you create a new version of a schema, the new version completely replaces all previous versions of the schema.</span></span> <span data-ttu-id="32c2b-125">此操作在事务寿命很短时能够正常工作。</span><span class="sxs-lookup"><span data-stu-id="32c2b-125">This works well when transactions are short-lived.</span></span> <span data-ttu-id="32c2b-126">但是，业务流程管理解决方案中的事务寿命很长：订单可能需要一年时间才能完成。</span><span class="sxs-lookup"><span data-stu-id="32c2b-126">However, transactions in the Business Process Management solution are long-lived: an order may take up to a year to complete.</span></span>  
  
 <span data-ttu-id="32c2b-127">为了允许使用正在使用的架构的多个版本，解决方案中的每个架构在其命名空间中都包括版本号。</span><span class="sxs-lookup"><span data-stu-id="32c2b-127">To allow for the possibility of using multiple versions of a schema being in use, each schema in the solution includes a version number in its namespace.</span></span> <span data-ttu-id="32c2b-128">BizTalk 管道确定消息类型的基于目标命名空间的消息以及架构中定义的根节点名称。</span><span class="sxs-lookup"><span data-stu-id="32c2b-128">BizTalk pipelines determine the message type of a message based on the target namespace plus the root node name defined in the schema.</span></span> <span data-ttu-id="32c2b-129">例如，订单架构的命名空间如下所示：</span><span class="sxs-lookup"><span data-stu-id="32c2b-129">For example, the namespace for the Order schema is as follows:</span></span>  
  
```  
http://Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.Order.v1  
```  
  
 <span data-ttu-id="32c2b-130">由于命名空间标识的架构和的版本编号可以包含唯一的架构的命名空间，新架构将不同于较旧版本。</span><span class="sxs-lookup"><span data-stu-id="32c2b-130">Because the namespace identifies the schema, and inclusion of the version number makes the namespace unique to the schema, the new schema will be distinct from the older version.</span></span> <span data-ttu-id="32c2b-131">因此，无需取代旧架构就可以使用新架构。</span><span class="sxs-lookup"><span data-stu-id="32c2b-131">Thus, a new schema can be used without supplanting the old schema.</span></span>  
  
 <span data-ttu-id="32c2b-132">因此应提前规划这，更改架构版本可能会影响你的解决方案中的不同部分。</span><span class="sxs-lookup"><span data-stu-id="32c2b-132">Changing the schema version can affect many parts of your solution, so this should be planned in advance.</span></span> <span data-ttu-id="32c2b-133">有关的架构版本更改效果的详细信息，请参阅[管道组件中的架构解析](http://go.microsoft.com/fwlink/?LinkID=154207)(http://go.microsoft.com/fwlink/?LinkID=154207) 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]帮助。</span><span class="sxs-lookup"><span data-stu-id="32c2b-133">For more information about the effect of schema version changes, see [Schema Resolution in Pipeline Components](http://go.microsoft.com/fwlink/?LinkID=154207) (http://go.microsoft.com/fwlink/?LinkID=154207) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
 <span data-ttu-id="32c2b-134">更改业务流程中的架构的版本，当使用多部分消息类型。</span><span class="sxs-lookup"><span data-stu-id="32c2b-134">When changing the version of schemas in an orchestration, use multipart message types.</span></span> <span data-ttu-id="32c2b-135">这样将导致更大的灵活性时版本控制架构。</span><span class="sxs-lookup"><span data-stu-id="32c2b-135">Doing so will result in greater flexibility when versioning schemas.</span></span> <span data-ttu-id="32c2b-136">使用多部分消息类型的优势的详细信息，请参阅提示 #1，"始终使用多部分消息类型，"MSDN 杂志文章中[的更好的 BizTalk 编程 8 提示和技巧](http://go.microsoft.com/fwlink/?LinkId=101594)(http://go.microsoft.com/fwlink/？LinkId = 101594)。</span><span class="sxs-lookup"><span data-stu-id="32c2b-136">For more information about the advantages of using multipart message types, see tip #1, “Always Use Multi-Part Message Types,” in the MSDN Magazine article [8 Tips And Tricks For Better BizTalk Programming](http://go.microsoft.com/fwlink/?LinkId=101594) (http://go.microsoft.com/fwlink/?LinkId=101594).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="32c2b-137">另请参阅</span><span class="sxs-lookup"><span data-stu-id="32c2b-137">See Also</span></span>  
 [<span data-ttu-id="32c2b-138">更新应用程序的最佳做法</span><span class="sxs-lookup"><span data-stu-id="32c2b-138">Best Practices for Updating Applications</span></span>](../technical-guides/best-practices-for-updating-applications.md)