---
title: 如何避免磁盘 Contention2 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 37bdf6bd-cb34-4540-819e-908d83a22d40
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f7be7a38ac3f3f6cc1d7d266c664cbb85f731c22
ms.sourcegitcommit: 8418b1a8f38b7f56979cd6e203f0b591e2f40fe1
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/23/2018
ms.locfileid: "22298133"
---
# <a name="how-to-avoid-disk-contention"></a><span data-ttu-id="7a8ff-102">如何避免磁盘争用</span><span class="sxs-lookup"><span data-stu-id="7a8ff-102">How to Avoid Disk Contention</span></span>
<span data-ttu-id="7a8ff-103">BizTalk Server 设计为永久性系统中。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-103">BizTalk Server is designed as a persistent system.</span></span> <span data-ttu-id="7a8ff-104">对于高吞吐量方案，MessageBox 和 BizTalk 跟踪数据库可能会遇到严重的争用现象。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-104">For high throughput scenarios, the MessageBox and BizTalk Tracking databases can experience severe contention.</span></span> <span data-ttu-id="7a8ff-105">缓慢的磁盘速度会进一步加重这种争用状况。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-105">This contention can be aggravated by slow disks.</span></span> <span data-ttu-id="7a8ff-106">如果是磁盘降低 （大于平均的平均时间Disk sec/Read 或 avg.Disk sec/Write)，它可能会导致 SQL Server 保留更长的锁 （高锁等待的时间和高锁定超时）。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-106">If the disks are slow (greater than 15ms on average for Avg. Disk sec/Read or Avg. Disk sec/Write), it may cause SQL Server to hold onto locks longer (high Lock Wait Time and high Lock Timeouts).</span></span> <span data-ttu-id="7a8ff-107">此操作，反过来，可能导致 MessageBox 表 （假脱机和应用程序的队列） 不断增长，导致数据库膨胀和限制。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-107">This, in turn, can cause the MessageBox tables (Spool and Application Queues) to grow, causing database bloat and throttling.</span></span> <span data-ttu-id="7a8ff-108">这种情况下最终将导致较低的总体可持续吞吐量。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-108">This situation ultimately results in lower overall sustainable throughput.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7a8ff-109">有关如何确定如果服务器具有磁盘瓶颈的信息，请参阅[Windows 性能监视器](http://go.microsoft.com/fwlink/?LinkID=204007)(http://go.microsoft.com/fwlink/?LinkID=204007)。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-109">For information about identifying if a server has a disk bottleneck, see [Windows Performance Monitor](http://go.microsoft.com/fwlink/?LinkID=204007) (http://go.microsoft.com/fwlink/?LinkID=204007).</span></span> <span data-ttu-id="7a8ff-110">Windows 性能监视器是一个 Microsoft 管理控制台 (MMC) 管理单元，提供工具以用于分析系统性能。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-110">Windows Performance Monitor is a Microsoft Management Console (MMC) snap-in that provides tools for analyzing system performance.</span></span>  
  
 <span data-ttu-id="7a8ff-111">若要避免磁盘争用，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="7a8ff-111">To avoid disk contention, do the following:</span></span>  
  
|<span data-ttu-id="7a8ff-112">步骤</span><span class="sxs-lookup"><span data-stu-id="7a8ff-112">Steps</span></span>|<span data-ttu-id="7a8ff-113">參考</span><span class="sxs-lookup"><span data-stu-id="7a8ff-113">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="7a8ff-114">使用 Raid10 0 + 1 个磁盘配置。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-114">Use Raid10/0+1 disk configurations.</span></span>|[<span data-ttu-id="7a8ff-115">避免瓶颈的最佳做法</span><span class="sxs-lookup"><span data-stu-id="7a8ff-115">Best Practices for Avoiding Bottlenecks</span></span>](../technical-guides/best-practices-for-avoiding-bottlenecks.md)|  
|<span data-ttu-id="7a8ff-116">如果可能，部署高速 SAN 上的数据库。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-116">If possible, deploy the databases on a high-speed SAN.</span></span> <span data-ttu-id="7a8ff-117">如果多个数据库共享相同的磁盘，我们建议在单独上配置它们**专用**磁盘。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-117">If multiple databases are sharing the same disks, we recommend configuring them on separate **dedicated** disks.</span></span> <span data-ttu-id="7a8ff-118">此外，我们建议分隔到不同的磁盘上的 MessageBox 数据库的 MDF 和 LDF 文件。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-118">In addition, we recommend separating the MDF and LDF files for the MessageBox database onto separate disks.</span></span>|[<span data-ttu-id="7a8ff-119">针对 Databases2 优化文件组</span><span class="sxs-lookup"><span data-stu-id="7a8ff-119">Optimizing Filegroups for the Databases2</span></span>](../technical-guides/optimizing-filegroups-for-the-databases2.md)|  
|<span data-ttu-id="7a8ff-120">因为这将显著减少磁盘争用并将负载分布到多个数据文件，请考虑为 TEMPDB 数据库中，分配多个文件。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-120">Consider allocating multiple files for the TEMPDB database, as this will significantly reduce disk contention and spread the load across multiple data files.</span></span>|[<span data-ttu-id="7a8ff-121">预配置数据库 Optimizations2</span><span class="sxs-lookup"><span data-stu-id="7a8ff-121">Pre-Configuration Database Optimizations2</span></span>](../technical-guides/pre-configuration-database-optimizations2.md)|  
|<span data-ttu-id="7a8ff-122">请考虑将 MessageBox 数据库分别放在独立于 BizTalk 跟踪数据库的专用服务器。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-122">Consider separating the MessageBox database onto a dedicated server that is separate from the BizTalk Tracking databases.</span></span>|[<span data-ttu-id="7a8ff-123">后配置数据库 Optimizations2</span><span class="sxs-lookup"><span data-stu-id="7a8ff-123">Post-Configuration Database Optimizations2</span></span>](../technical-guides/post-configuration-database-optimizations2.md)|  
|<span data-ttu-id="7a8ff-124">将 MSDTC 日志文件目录分配给单独的专用驱动器。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-124">Assign the MSDTC log file directory to a separate dedicated drive.</span></span>|[<span data-ttu-id="7a8ff-125">优化操作系统性能</span><span class="sxs-lookup"><span data-stu-id="7a8ff-125">Optimizing Operating System Performance</span></span>](../technical-guides/optimizing-operating-system-performance.md)|  
|<span data-ttu-id="7a8ff-126">如果因 PageFile 或 MSDTC 日志而在本地驱动器上出现争用情况，请尝试将 PageFile 和/或 MSDTC 日志移到不同的驱动器上。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-126">If there is contention on the local drive due to the PageFile or MSDTC log, try moving the PageFile and/or the MSDTC log to a separate drive.</span></span>|[<span data-ttu-id="7a8ff-127">避免瓶颈的最佳做法</span><span class="sxs-lookup"><span data-stu-id="7a8ff-127">Best Practices for Avoiding Bottlenecks</span></span>](../technical-guides/best-practices-for-avoiding-bottlenecks.md)|  
|<span data-ttu-id="7a8ff-128">优化写入操作的跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-128">Optimize the Tracking database for write operations.</span></span>|[<span data-ttu-id="7a8ff-129">如何找出跟踪数据库数据库的瓶颈</span><span class="sxs-lookup"><span data-stu-id="7a8ff-129">How to Identify Bottlenecks in the Tracking Database</span></span>](../technical-guides/how-to-identify-bottlenecks-in-the-tracking-database.md)|  
|<span data-ttu-id="7a8ff-130">优化 MessageBox 数据库进行读取和写入操作。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-130">Optimize the MessageBox database for read and write operations.</span></span>|[<span data-ttu-id="7a8ff-131">如何确定 MessageBox Database1 中的瓶颈</span><span class="sxs-lookup"><span data-stu-id="7a8ff-131">How to Identify Bottlenecks in the MessageBox Database1</span></span>](../technical-guides/how-to-identify-bottlenecks-in-the-messagebox-database1.md)|  
|<span data-ttu-id="7a8ff-132">如果 BizTalk 主机实例占满 CPU，请考虑分隔发送、 接收、 处理和跟踪到多个主机的功能。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-132">If a BizTalk host instance is saturating the CPU, consider separating sending, receiving, processing, and tracking functionality into multiple hosts.</span></span> <span data-ttu-id="7a8ff-133">这会将配置系统，以便在单独的专用服务器来提高整体系统的吞吐量上运行的业务流程功能。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-133">This configures the system so that the orchestration functionality runs on a separate dedicated server to improve overall system throughput.</span></span>|[<span data-ttu-id="7a8ff-134">优化 BizTalk Server 性能</span><span class="sxs-lookup"><span data-stu-id="7a8ff-134">Optimizing BizTalk Server Performance</span></span>](../technical-guides/optimizing-biztalk-server-performance.md)|  
|<span data-ttu-id="7a8ff-135">如果部署多个业务流程，请考虑在不同的专用的 orchestration 主机中登记它们。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-135">If multiple orchestrations are deployed, consider enlisting them in different dedicated orchestration hosts.</span></span> <span data-ttu-id="7a8ff-136">这将隔离不同的业务流程，并防止在同一物理地址空间或在同一服务器上的共享资源的争用。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-136">This isolates the different orchestrations and prevents contention for shared resources either in the same physical address space or on the same server.</span></span>|[<span data-ttu-id="7a8ff-137">优化 BizTalk Server 性能</span><span class="sxs-lookup"><span data-stu-id="7a8ff-137">Optimizing BizTalk Server Performance</span></span>](../technical-guides/optimizing-biztalk-server-performance.md)|  
|<span data-ttu-id="7a8ff-138">请考虑使用 Windows 性能监视器来诊断磁盘争用问题...</span><span class="sxs-lookup"><span data-stu-id="7a8ff-138">Consider using Windows Performance Monitor to diagnose disk contention issues..</span></span>|[<span data-ttu-id="7a8ff-139">Windows 性能监视器</span><span class="sxs-lookup"><span data-stu-id="7a8ff-139">Windows Performance Monitor</span></span>](http://go.microsoft.com/fwlink/?LinkID=204007)|  
  
 <span data-ttu-id="7a8ff-140">有关磁盘性能分析的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="7a8ff-140">For more information about disk performance analysis, see the following resources:</span></span>  
  
-   <span data-ttu-id="7a8ff-141">[允许磁盘密集型问题](http://go.microsoft.com/fwlink/?LinkId=120947)(超链接"http://go.microsoft.com/fwlink/?LinkId=120947"\t"_blank"http://go.microsoft.com/fwlink/?LinkId=120947)。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-141">[Ruling Out Disk-Bound Problems](http://go.microsoft.com/fwlink/?LinkId=120947) (HYPERLINK "http://go.microsoft.com/fwlink/?LinkId=120947" \t "_blank"http://go.microsoft.com/fwlink/?LinkId=120947).</span></span>  
  
-   <span data-ttu-id="7a8ff-142">[SQL 服务器预部署 I/O 最佳实践](http://go.microsoft.com/fwlink/?LinkId=120948)(http://go.microsoft.com/fwlink/?LinkId=120948)。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-142">[SQL Server Predeployment I/O Best Practices](http://go.microsoft.com/fwlink/?LinkId=120948) (http://go.microsoft.com/fwlink/?LinkId=120948).</span></span>  
  
-   <span data-ttu-id="7a8ff-143">"I/O 瓶颈"部分[中 SQL Server 2008 的故障排除性能问题](http://go.microsoft.com/fwlink/?LinkID=153586)(http://go.microsoft.com/fwlink/?LinkID=153586)。</span><span class="sxs-lookup"><span data-stu-id="7a8ff-143">“I/O Bottlenecks” section of [Troubleshooting Performance Problems in SQL Server 2008](http://go.microsoft.com/fwlink/?LinkID=153586) (http://go.microsoft.com/fwlink/?LinkID=153586).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7a8ff-144">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7a8ff-144">See Also</span></span>  
 [<span data-ttu-id="7a8ff-145">数据库层的瓶颈</span><span class="sxs-lookup"><span data-stu-id="7a8ff-145">Bottlenecks in the Database Tier</span></span>](../technical-guides/bottlenecks-in-the-database-tier.md)