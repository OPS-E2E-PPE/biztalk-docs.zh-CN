---
title: 规划对其进行跟踪 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8ffc8573-1b4a-47c7-96ab-0471f43facf5
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c9853fccde9c5fa6e8c223106c8386f19298d0b9
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22302077"
---
# <a name="planning-for-tracking"></a><span data-ttu-id="55e53-102">规划对其进行跟踪</span><span class="sxs-lookup"><span data-stu-id="55e53-102">Planning for Tracking</span></span>
<span data-ttu-id="55e53-103">邮件跟踪是依据的部分消息实例，如消息正文、 消息属性和元数据将存储在数据库中，通常用于存档目的的过程。</span><span class="sxs-lookup"><span data-stu-id="55e53-103">Message tracking is the process by which parts of a message instance, such as the message body, message properties, and metadata are stored in a database, typically for archival purposes.</span></span> <span data-ttu-id="55e53-104">随后可以通过从中的组中心数据库页运行查询来查看跟踪的消息实例部分[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="55e53-104">Message instance parts that are tracked can subsequently be viewed by running queries from the Group Hub page in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="55e53-105">除了访问已存档的数据，还可以查看实时数据，这可能非常有用的工具进行标识和修复开发中的问题或过渡环境。</span><span class="sxs-lookup"><span data-stu-id="55e53-105">In addition to accessing archived data, you can also view live data, which can be a helpful tool for identifying and fixing problems in a development or staging environment.</span></span>  
  
 <span data-ttu-id="55e53-106">由于消息跟踪的过程可能会消耗大量的资源，因此创建你的计划前应查看本主题。</span><span class="sxs-lookup"><span data-stu-id="55e53-106">Since the process of message tracking can be very resource intensive, you should review this topic before creating your plan.</span></span>  
  
 <span data-ttu-id="55e53-107">有关跟踪的详细信息，请参阅[运行状况和活动跟踪](http://go.microsoft.com/fwlink/?LinkId=154187)(http://go.microsoft.com/fwlink/?LinkId=154187)。</span><span class="sxs-lookup"><span data-stu-id="55e53-107">For more information about tracking, see [Health and Activity Tracking](http://go.microsoft.com/fwlink/?LinkId=154187) (http://go.microsoft.com/fwlink/?LinkId=154187).</span></span>  
  
## <a name="configuring-and-enabling-the-dta-purge-and-archive-sql-agent-job"></a><span data-ttu-id="55e53-108">配置和启用 DTA 清除和存档 SQL 代理作业</span><span class="sxs-lookup"><span data-stu-id="55e53-108">Configuring and Enabling the DTA Purge and Archive SQL Agent Job</span></span>  
 <span data-ttu-id="55e53-109">此作业存档和清除旧数据从 BizTalk 跟踪数据库，从而阻止将其变得太大。</span><span class="sxs-lookup"><span data-stu-id="55e53-109">This job archives and purges old data from the BizTalk Tracking database, thus keeping it from becoming too large.</span></span> <span data-ttu-id="55e53-110">这是必需的正常[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系统。</span><span class="sxs-lookup"><span data-stu-id="55e53-110">This is essential for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="55e53-111">大型跟踪数据库将开始对跟踪主机和任何其他进程的性能影响该查询跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="55e53-111">A large tracking database will begin to affect the performance of the tracking host and any other processes that query the tracking database.</span></span>  
  
-   <span data-ttu-id="55e53-112">**确保 DTA 清除和存档 SQL 代理作业正确配置和启用，并且已成功完成。**</span><span class="sxs-lookup"><span data-stu-id="55e53-112">**Ensure that the DTA Purge and Archive SQL Agent job is properly configured, enabled, and successfully completing.**</span></span> <span data-ttu-id="55e53-113">默认情况下不启用此作业，因为你必须首先将其配置为包括可以在其中写入存档文件的目录。</span><span class="sxs-lookup"><span data-stu-id="55e53-113">This job is not enabled by default because you must first configure it to include a directory where the archive files can be written.</span></span>  
  
-   <span data-ttu-id="55e53-114">**确保作业能够快速生成传入的跟踪数据清除的跟踪数据。**</span><span class="sxs-lookup"><span data-stu-id="55e53-114">**Ensure that the job is able to purge the tracking data as fast as the incoming tracking data is generated.**</span></span> <span data-ttu-id="55e53-115">是可以接受作业的计划全力支持在高峰负载，但它应始终能保持同步。</span><span class="sxs-lookup"><span data-stu-id="55e53-115">It is acceptable for the job to get behind during peak load times, but it should always be able to catch up.</span></span> <span data-ttu-id="55e53-116">如果清除作业获取，并且永远不会是能够赶上，BizTalk 跟踪数据库将不断变大，，性能将最终会受到不利影响。</span><span class="sxs-lookup"><span data-stu-id="55e53-116">If the purge job gets behind and is never able to catch up, the BizTalk Tracking database will continue to grow, and performance will eventually be adversely affected.</span></span>  
  
-   <span data-ttu-id="55e53-117">**查看软清除并硬清除参数，以确保你一直在进行数据足够长的时间，但不是太长。**</span><span class="sxs-lookup"><span data-stu-id="55e53-117">**Review the soft purge and hard purge parameters to ensure you are keeping data long enough but not too long.**</span></span> <span data-ttu-id="55e53-118">有关这些参数的详细信息请参阅[存档和清除 BizTalk 跟踪数据库](http://go.microsoft.com/fwlink/?LinkID=153816)(http://go.microsoft.com/fwlink/?LinkID=153816)。</span><span class="sxs-lookup"><span data-stu-id="55e53-118">For more information about these parameters see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816).</span></span>  
  
-   <span data-ttu-id="55e53-119">**如果你只需以清除旧数据并不需要将其存档在第一次，然后更改 SQL 代理作业调用存储的过程"dtasp_PurgeTrackingDatabase"。**</span><span class="sxs-lookup"><span data-stu-id="55e53-119">**If you only need to purge the old data and do not need to archive it first, then change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase”.**</span></span> <span data-ttu-id="55e53-120">这跳过存档步骤中，并只是执行清除。</span><span class="sxs-lookup"><span data-stu-id="55e53-120">This skips the archive step, and just does the purge.</span></span> <span data-ttu-id="55e53-121">有关详细信息，有关此存储的过程和更改 SQL 代理作业以使用它，请参阅[如何清除数据从 BizTalk 跟踪数据库](http://go.microsoft.com/fwlink/?LinkID=153817)(http://go.microsoft.com/fwlink/?LinkID=153817)。</span><span class="sxs-lookup"><span data-stu-id="55e53-121">For more information about this stored procedure and changing the SQL Agent job to use it, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817).</span></span>  
  
-   <span data-ttu-id="55e53-122">**如果你需要保留存档文件的 BizTalk 跟踪数据库，请确保你有一个进程的位置，以成功还原并使用它们。**</span><span class="sxs-lookup"><span data-stu-id="55e53-122">**If you need to keep the BizTalk Tracking database archive files, ensure that you have a process in place to successfully restore and use them.**</span></span>  
  
-   <span data-ttu-id="55e53-123">**如果您遇到性能问题的暂时解决通过清除 BizTalk 跟踪数据库，并且你想要配置 BizTalk 不再收集跟踪信息，你可能想要考虑关闭全局跟踪。**</span><span class="sxs-lookup"><span data-stu-id="55e53-123">**If you are having performance issues that are momentarily addressed by purging the BizTalk tracking database, and you want to configure BizTalk to no longer collect tracking information, you may want to consider turning off global tracking.**</span></span> <span data-ttu-id="55e53-124">有关如何关闭全局跟踪的信息，请参阅主题[如何打开关闭全局跟踪](http://go.microsoft.com/fwlink/?LinkID=154193)(http://go.microsoft.com/fwlink/?LinkID=154193)。</span><span class="sxs-lookup"><span data-stu-id="55e53-124">For information about how to turn off global tracking, see the topic [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkID=154193) (http://go.microsoft.com/fwlink/?LinkID=154193).</span></span>  
  
## <a name="creating-a-dedicated-tracking-host"></a><span data-ttu-id="55e53-125">创建专用的跟踪主机</span><span class="sxs-lookup"><span data-stu-id="55e53-125">Creating a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="55e53-126">当选项**允许主机跟踪**在 BizTalk Server 管理控制台中，该主机的实例的主机将运行跟踪数据解码服务 (TDDS) 将跟踪的数据，从启用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBox数据库部署到 BizTalk 跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="55e53-126">When the option to **Allow Host Tracking** is enabled for a host in the BizTalk Server Administration console, instances of that host will run the Tracking Data Decode Service (TDDS) to move tracked data from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database to the BizTalk Tracking database.</span></span> <span data-ttu-id="55e53-127">因为 TDDS 可能占用大量资源，请考虑创建的"专用"跟踪主机**允许主机跟踪**选项启用状态并且其不会运行任何其他[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]进程 （如适配器或业务流程）。</span><span class="sxs-lookup"><span data-stu-id="55e53-127">Since TDDS may be resource intensive, consider creating a "dedicated" tracking host for which the **Allow Host Tracking** option is enabled and which does not run any other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes (such as adapters or orchestrations).</span></span> <span data-ttu-id="55e53-128">如果你的 BizTalk 组包含多个 BizTalk server，它也被视为最佳做法 TDDS 为提供高可用性组中每个服务器上创建一个此主机的实例。</span><span class="sxs-lookup"><span data-stu-id="55e53-128">If your BizTalk group contains more than one BizTalk server, it is also considered a best practice to create an instance of this host on each server in the group to provide high availability for TDDS.</span></span>  
  
## <a name="testing-to-measure-maximum-sustainable-tracking-throughput"></a><span data-ttu-id="55e53-129">测试度量值最大可持续跟踪吞吐量</span><span class="sxs-lookup"><span data-stu-id="55e53-129">Testing to Measure Maximum Sustainable Tracking Throughput</span></span>  
 <span data-ttu-id="55e53-130">较详细跟踪的消息是一个非常资源密集型活动和如果未正确管理可以产生极负面的性能影响[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]环境。</span><span class="sxs-lookup"><span data-stu-id="55e53-130">Extensive message tracking is a very resource intensive activity and if not properly managed can have an extremely adverse effect on the performance of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="55e53-131">因此，应测量的最大可持续跟踪吞吐量你[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]环境，以确保系统可持续，并将在给定的消息流入率无限期地运行。</span><span class="sxs-lookup"><span data-stu-id="55e53-131">Therefore, you should measure maximum sustainable tracking throughput for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment to ensure that the system is sustainable and will run indefinitely at a given message flow rate.</span></span> <span data-ttu-id="55e53-132">有关测量最大可持续跟踪吞吐量的详细信息，请参阅[测量最大的可持续跟踪吞吐量](http://go.microsoft.com/fwlink/?LinkID=153815)(http://go.microsoft.com/fwlink/?LinkID=153815)。</span><span class="sxs-lookup"><span data-stu-id="55e53-132">For more information about measuring maximum sustainable tracking throughput, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815).</span></span>  
  
##  <a name="BKMK_TrackingBP"></a><span data-ttu-id="55e53-133">跟踪的最佳实践</span><span class="sxs-lookup"><span data-stu-id="55e53-133">Best Practices for Tracking</span></span>  
  
-   <span data-ttu-id="55e53-134">**确定需要跟踪在规划过程的信息**： 你应决定在规划过程暂存需要跟踪，以便部署项目后你可以设置跟踪选项和限制的跟踪数据量的信息为你提供所需的信息。</span><span class="sxs-lookup"><span data-stu-id="55e53-134">**Determine the information you need to track during planning** : You should decide during the planning stages which information you need to track, so that after you deploy the project you can set the tracking options and limit the amount of tracked data to give you only the information you need.</span></span>  
  
-   <span data-ttu-id="55e53-135">**不跟踪所有消息**： 我们建议你不都跟踪所有消息，因为每次一条消息接触，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]使另一个副本。</span><span class="sxs-lookup"><span data-stu-id="55e53-135">**Do not track all messages**: We recommend that you not track all messages, because each time a message is touched, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] makes another copy.</span></span> <span data-ttu-id="55e53-136">通过跟踪特定端口，而是可以缩小范围。</span><span class="sxs-lookup"><span data-stu-id="55e53-136">You can instead narrow the scope by tracking only a specific port.</span></span> <span data-ttu-id="55e53-137">这有助于你的系统的性能最大化，并以使数据库整洁。</span><span class="sxs-lookup"><span data-stu-id="55e53-137">This helps to maximize the performance of your system and to keep the databases uncluttered.</span></span>  
  
-   <span data-ttu-id="55e53-138">**在发送端口上设置跟踪和接收管道上的而不是端口**： 如果你设置跟踪选项卡上的管道，你还将设置使用管道的每个端口全局跟踪选项。</span><span class="sxs-lookup"><span data-stu-id="55e53-138">**Set tracking on send ports and receive ports instead of on a pipeline**: If you set tracking options on pipelines, you will also set the tracking options globally for every port that uses the pipeline.</span></span> <span data-ttu-id="55e53-139">反过来，这可能会在导致被跟踪比你预期，这将降低系统性能的更多数据。</span><span class="sxs-lookup"><span data-stu-id="55e53-139">This in turn may result in far more data being tracked than you intend, which will slow system performance.</span></span> <span data-ttu-id="55e53-140">相反，你可以将端口设置跟踪选项卡上的发送和接收端口。</span><span class="sxs-lookup"><span data-stu-id="55e53-140">Instead, you can set tracking options on send ports and receive ports.</span></span>  
  
-   <span data-ttu-id="55e53-141">**各种各样的因素时考虑大小 BizTalk 跟踪数据库**:</span><span class="sxs-lookup"><span data-stu-id="55e53-141">**Take into account various factors when you size the BizTalk Tracking database**:</span></span>  
  
    -   <span data-ttu-id="55e53-142">当 BizTalk 跟踪数据库的大小调整，帐户有关 SQL Server 的因素，如索引大小，通过将应变乘数添加到您的计算。</span><span class="sxs-lookup"><span data-stu-id="55e53-142">When sizing the BizTalk Tracking database, account for SQL Server factors, such as index size, by adding a contingency multiplier to your calculations.</span></span>  
  
    -   <span data-ttu-id="55e53-143">在确定 BizTalk 跟踪数据库中的消息的大小，将添加消息上下文的平均大小到的消息大小如果一点很重要，相比的消息大小。</span><span class="sxs-lookup"><span data-stu-id="55e53-143">When determining the size of messages in the BizTalk Tracking database, add the average size of the message context to the message size if it is significant compared to the message size.</span></span>  
  
    -   <span data-ttu-id="55e53-144">将 BizTalk 跟踪数据库中的消息大小限制，限制在提升的属性的数目。</span><span class="sxs-lookup"><span data-stu-id="55e53-144">To limit the size of messages in the BizTalk Tracking database, limit the number of properties that you promote.</span></span> <span data-ttu-id="55e53-145">如果你需要这些路由目的应仅使用提升的属性，否则使用可分辨的字段。</span><span class="sxs-lookup"><span data-stu-id="55e53-145">You should only use promoted properties if you need them for routing purposes, otherwise use distinguished fields.</span></span>  
  
    -   <span data-ttu-id="55e53-146">如果业务流程**形状开始和结束**选项启用时，考虑到每个业务流程实例中的每个形状的启动和停止事件保存在 BizTalk 跟踪数据库的帐户。</span><span class="sxs-lookup"><span data-stu-id="55e53-146">If the orchestration **Shape start and end** option is enabled, take into account that a start and stop event for each shape in each orchestration instance is saved in the BizTalk Tracking database.</span></span>