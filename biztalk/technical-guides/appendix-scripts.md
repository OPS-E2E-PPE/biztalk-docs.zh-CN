---
title: "附录： 脚本 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: b6394321-13c9-4b1d-b529-eba3d53b33c4
caps.latest.revision: "6"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 12df00876f6b2da9ebb98631016bd42947b4a40a
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="appendix-scripts"></a><span data-ttu-id="0644f-102">附录： 脚本</span><span class="sxs-lookup"><span data-stu-id="0644f-102">Appendix: Scripts</span></span>
<span data-ttu-id="0644f-103">此管理包中包括以下脚本。</span><span class="sxs-lookup"><span data-stu-id="0644f-103">The following scripts are included in this management pack.</span></span>  
  
|<span data-ttu-id="0644f-104">脚本</span><span class="sxs-lookup"><span data-stu-id="0644f-104">Script</span></span>|<span data-ttu-id="0644f-105">用途</span><span class="sxs-lookup"><span data-stu-id="0644f-105">Purpose</span></span>|  
|------------|-------------|  
|<span data-ttu-id="0644f-106">Microsoft.BizTalk.Server.2013.ArtifactsDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-106">Microsoft.BizTalk.Server.2013.ArtifactsDiscovery.vbs</span></span>|<span data-ttu-id="0644f-107">此脚本发现应用程序项目基于 $Config 选项 $ 参数。</span><span class="sxs-lookup"><span data-stu-id="0644f-107">This script discovers application artifacts based on $Config/Option$ parameter.</span></span> <span data-ttu-id="0644f-108">选项包括</span><span class="sxs-lookup"><span data-stu-id="0644f-108">Options include</span></span><br /><br /> <span data-ttu-id="0644f-109">-All 发送端口，将端口组应用程序，其托管关系中发送到应用程序和发送端口组包含发送端口的关系。</span><span class="sxs-lookup"><span data-stu-id="0644f-109">-   All send ports, send port groups in an application, their hosting relations to an application and 'send port group contains send port' relations.</span></span><br /><span data-ttu-id="0644f-110">-所有业务流程的应用程序，应用程序到其托管关系。</span><span class="sxs-lookup"><span data-stu-id="0644f-110">-   All orchestrations in an application, their hosting relations to application.</span></span><br /><span data-ttu-id="0644f-111">-All 接收端口，则接收应用程序，其托管关系中的位置的应用程序和接收端口包含接收位置关系。</span><span class="sxs-lookup"><span data-stu-id="0644f-111">-   All receive ports, receive locations in an application, their hosting relation' to an application and 'receive port contains receive location' relations.</span></span>|  
|<span data-ttu-id="0644f-112">Microsoft.BizTalk.Server.2013.ApplicationDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-112">Microsoft.BizTalk.Server.2013.ApplicationDiscovery.vbs</span></span>|<span data-ttu-id="0644f-113">此脚本发现以下各项：</span><span class="sxs-lookup"><span data-stu-id="0644f-113">This script discovers the following:</span></span><br /><br /> <span data-ttu-id="0644f-114">的在组和组主机应用程序关系所有应用程序。</span><span class="sxs-lookup"><span data-stu-id="0644f-114">-   All applications in a group and 'group hosts application' relations.</span></span><br /><span data-ttu-id="0644f-115">的在组和组主机主机关系中所有主机。</span><span class="sxs-lookup"><span data-stu-id="0644f-115">-   All hosts in a group and 'group hosts host' relations.</span></span>|  
|<span data-ttu-id="0644f-116">Microsoft.BizTalk.Server.2013.BAMAnalysisDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-116">Microsoft.BizTalk.Server.2013.BAMAnalysisDiscovery.vbs</span></span>|<span data-ttu-id="0644f-117">此脚本发现 BAM 分析，并提醒其中发现 BAM 运行时组件的计算机上的组件。</span><span class="sxs-lookup"><span data-stu-id="0644f-117">This script discovers BAM analysis and alerts components on a computer where BAM runtime component is discovered.</span></span>|  
|<span data-ttu-id="0644f-118">Microsoft.BizTalk.Server.2013.BAMPortalDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-118">Microsoft.BizTalk.Server.2013.BAMPortalDiscovery.vbs</span></span>|<span data-ttu-id="0644f-119">此脚本发现 BAM 门户上的计算机的 IIS 配置。</span><span class="sxs-lookup"><span data-stu-id="0644f-119">This script discovers BAM portal configured on a machine having IIS.</span></span> <span data-ttu-id="0644f-120">这还发现 BAM 角色和 BAM 门户中它的包含关系。</span><span class="sxs-lookup"><span data-stu-id="0644f-120">This also discovers BAM role and the containment of BAM portal in it.</span></span>|  
|<span data-ttu-id="0644f-121">Microsoft.BizTalk.Server.2013.BAMRuntimeDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-121">Microsoft.BizTalk.Server.2013.BAMRuntimeDiscovery.vbs</span></span>|<span data-ttu-id="0644f-122">此脚本发现 BAM 作为参数 $Config 传递的计算机上的运行时组件/ComputerName$。</span><span class="sxs-lookup"><span data-stu-id="0644f-122">This script discovers BAM runtime component on a computer passed as parameter $Config/ComputerName$.</span></span> <span data-ttu-id="0644f-123">如果计算机名称未传递然后它将发现 BAM 具有在管理数据库中的最低服务器 ID 的运行时计算机上。</span><span class="sxs-lookup"><span data-stu-id="0644f-123">If computer name is not passed then it discovers BAM on a runtime computer with lowest server ID in the management database.</span></span> <span data-ttu-id="0644f-124">这还发现 BAM 角色和 BAM 运行时在它的包含关系。</span><span class="sxs-lookup"><span data-stu-id="0644f-124">This also discovers BAM role and the containment of BAM runtime in it.</span></span>|  
|<span data-ttu-id="0644f-125">Microsoft.BizTalk.Server.2013.BizTalkApplicationServiceDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-125">Microsoft.BizTalk.Server.2013.BizTalkApplicationServiceDiscovery.vbs</span></span>|<span data-ttu-id="0644f-126">此脚本发现以及其宿主关系与运行时角色的计算机上的所有 BizTalk 应用程序服务。</span><span class="sxs-lookup"><span data-stu-id="0644f-126">This script discovers all BizTalk application services on a computer along with its hosting relations with runtime role.</span></span>|  
|<span data-ttu-id="0644f-127">Microsoft.BizTalk.Server.2013.BizTalkGroupDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-127">Microsoft.BizTalk.Server.2013.BizTalkGroupDiscovery.vbs</span></span>|<span data-ttu-id="0644f-128">此脚本发现作为参数 $Config 传递的计算机上的 BizTalk 组/ComputerName$。</span><span class="sxs-lookup"><span data-stu-id="0644f-128">This script discovers BizTalk group on a computer passed as parameter $Config/ComputerName$.</span></span> <span data-ttu-id="0644f-129">如果计算机名称未传递然后它将发现具有管理数据库中的最低服务器 ID 的运行时计算机上的组。</span><span class="sxs-lookup"><span data-stu-id="0644f-129">If computer name is not passed then it discovers group on a runtime computer with lowest server ID in the management database.</span></span>|  
|<span data-ttu-id="0644f-130">Microsoft.BizTalk.Server.2013.BizTalkRoleDiscovery.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-130">Microsoft.BizTalk.Server.2013.BizTalkRoleDiscovery.vbs</span></span>|<span data-ttu-id="0644f-131">此脚本发现基于参数的指定计算机中的 BizTalk 服务器角色。</span><span class="sxs-lookup"><span data-stu-id="0644f-131">This script discovers the BizTalk server roles in a specified computer based on parameter.</span></span> <span data-ttu-id="0644f-132">$Config 选项 $。</span><span class="sxs-lookup"><span data-stu-id="0644f-132">$Config/Option$.</span></span> <span data-ttu-id="0644f-133">包括以下选项：</span><span class="sxs-lookup"><span data-stu-id="0644f-133">Options include the following:</span></span><br /><br /> <span data-ttu-id="0644f-134">-BizTalk 运行时角色、 BizTalk 组部署和包含组部署中的运行时。</span><span class="sxs-lookup"><span data-stu-id="0644f-134">-   BizTalk runtime role, BizTalk group deployment and containment of runtime in group deployment.</span></span><br /><span data-ttu-id="0644f-135">-BizTalk 规则引擎角色、 BizTalk 组部署和包含组部署中的规则引擎。</span><span class="sxs-lookup"><span data-stu-id="0644f-135">-   BizTalk rules engine role, BizTalk group deployment and containment of rules engine in group deployment.</span></span> <span data-ttu-id="0644f-136">BAM 角色始终发现的任何选项，以及其组部署中的包含关系。</span><span class="sxs-lookup"><span data-stu-id="0644f-136">BAM role is always discovered with any of the options, and its containment in group deployment.</span></span>|  
|<span data-ttu-id="0644f-137">BizTalkAnalysisDatabaseMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-137">BizTalkAnalysisDatabaseMonitor.vbs</span></span>|<span data-ttu-id="0644f-138">此脚本生成基于连接的 SQL 分析数据库的可用性监视的数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-138">This script generates monitoring data for availability of SQL analysis database based on connectivity.</span></span> <span data-ttu-id="0644f-139">监视器状态可以是成功或错误。</span><span class="sxs-lookup"><span data-stu-id="0644f-139">The monitor states can be either success or error.</span></span>|  
|<span data-ttu-id="0644f-140">BizTalkArtifactConfigurationMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-140">BizTalkArtifactConfigurationMonitor.vbs</span></span>|<span data-ttu-id="0644f-141">此脚本生成 BizTalk 应用程序项目配置的监视数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-141">This script generates monitoring data for BizTalk application artifact configuration.</span></span> <span data-ttu-id="0644f-142">每个项目将为三个的监视状态成功、 警告和错误之一。</span><span class="sxs-lookup"><span data-stu-id="0644f-142">Each artifact will be in one of the three monitoring states success, warning and error.</span></span>|  
|<span data-ttu-id="0644f-143">BizTalkArtifactSuspendedInstancesMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-143">BizTalkArtifactSuspendedInstancesMonitor.vbs</span></span>|<span data-ttu-id="0644f-144">此脚本生成基于每个项目的挂起实例数的 BizTalk 应用程序项目运行时状态的监视数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-144">This script generates monitoring data for BizTalk application artifact runtime state based on number of suspended instances per artifact.</span></span> <span data-ttu-id="0644f-145">每个项目将为三个的监视状态成功、 警告和错误之一。</span><span class="sxs-lookup"><span data-stu-id="0644f-145">Each artifact will be in one of the three monitoring states success, warning, and error.</span></span>|  
|<span data-ttu-id="0644f-146">BizTalkBAMPortalMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-146">BizTalkBAMPortalMonitor.vbs</span></span>|<span data-ttu-id="0644f-147">此脚本生成 BAM 门户的可用性监视的数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-147">This script generates monitoring data for availability of BAM portal.</span></span> <span data-ttu-id="0644f-148">监视器状态可以是成功或错误。</span><span class="sxs-lookup"><span data-stu-id="0644f-148">The monitor states can be either success or error.</span></span>|  
|<span data-ttu-id="0644f-149">BizTalkHostConfigurationMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-149">BizTalkHostConfigurationMonitor.vbs</span></span>|<span data-ttu-id="0644f-150">此脚本生成基于其所有主机实例 (BTSNTSvc.exe) 的可用性的 BizTalk 主机监视的数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-150">This script generates monitoring data for BizTalk host based on the availability of all its host instances (BTSNTSvc.exe).</span></span> <span data-ttu-id="0644f-151">可以任一成功监视器状态 (运行 > = 成功限制)，警告 (运行 > = 警告限制并运行 < 成功限制) 或错误。</span><span class="sxs-lookup"><span data-stu-id="0644f-151">The monitor states can be either success (running >= success limit), warning (running >= warning limit and running < success limit) or error.</span></span>|  
|<span data-ttu-id="0644f-152">BizTalkDatabaseMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-152">BizTalkDatabaseMonitor.vbs</span></span>|<span data-ttu-id="0644f-153">此脚本生成基于连接的 SQL 数据库的可用性监视的数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-153">This script generates monitoring data for availability of an SQL database based on connectivity.</span></span> <span data-ttu-id="0644f-154">监视器状态可以是成功或错误。</span><span class="sxs-lookup"><span data-stu-id="0644f-154">The monitor states can be either success or error.</span></span>|  
|<span data-ttu-id="0644f-155">BizTalkMultipleDatabaseMonitor.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-155">BizTalkMultipleDatabaseMonitor.vbs</span></span>|<span data-ttu-id="0644f-156">此脚本生成作为单个实体基于连接的 SQL 数据库的某个组的可用性监视的数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-156">This script generates monitoring data for availability of a group of SQL databases as a single entity based on connectivity.</span></span> <span data-ttu-id="0644f-157">监视器状态可以是任一错误 （不可用主数据库），警告 （某些非主数据库不可用） 或成功 （可用的所有数据库）。</span><span class="sxs-lookup"><span data-stu-id="0644f-157">Monitor states can be either error (primary database not available), warning (some non-primary databases not available) or success (all databases available).</span></span>|  
|<span data-ttu-id="0644f-158">BizTalkHostProbeAction.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-158">BizTalkHostProbeAction.vbs</span></span>|<span data-ttu-id="0644f-159">此脚本生成基于其所有主机实例 (BTSNTSvc.exe) 的可用性的 BizTalk 主机的诊断数据。</span><span class="sxs-lookup"><span data-stu-id="0644f-159">This script generates diagnostics data for BizTalk host based on the availability of all its host instances (BTSNTSvc.exe).</span></span> <span data-ttu-id="0644f-160">对于错误和警告状态中，它将显示未运行的主机实例。</span><span class="sxs-lookup"><span data-stu-id="0644f-160">For error and warning states it shows host instance that are not running.</span></span>|  
|<span data-ttu-id="0644f-161">Microsoft.BizTalk.Server.2013.HostAction.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-161">Microsoft.BizTalk.Server.2013.HostAction.vbs</span></span>|<span data-ttu-id="0644f-162">使用此脚本到启动/停止 BizTalk 主机。</span><span class="sxs-lookup"><span data-stu-id="0644f-162">This script is used to Start/Stop a BizTalk Host.</span></span>|  
|<span data-ttu-id="0644f-163">Microsoft.BizTalk.Server.2013.OrchestrationAction.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-163">Microsoft.BizTalk.Server.2013.OrchestrationAction.vbs</span></span>|<span data-ttu-id="0644f-164">使用此脚本到启动/停止业务流程 （BizTalk 应用程序项目）。</span><span class="sxs-lookup"><span data-stu-id="0644f-164">This script is used to Start/Stop an orchestration (BizTalk application artifact).</span></span>|  
|<span data-ttu-id="0644f-165">Microsoft.BizTalk.Server.2013.EnableReceiveLocation.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-165">Microsoft.BizTalk.Server.2013.EnableReceiveLocation.vbs</span></span>|<span data-ttu-id="0644f-166">此脚本是用于启用/禁用接收位置 （BizTalk 应用程序项目）。</span><span class="sxs-lookup"><span data-stu-id="0644f-166">This script is used to Enable/Disable a Receive Location (BizTalk application artifact).</span></span>|  
|<span data-ttu-id="0644f-167">Microsoft.BizTalk.Server.2013.SendPortAction.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-167">Microsoft.BizTalk.Server.2013.SendPortAction.vbs</span></span>|<span data-ttu-id="0644f-168">使用此脚本到启动/停止发送端口 （BizTalk 应用程序项目）。</span><span class="sxs-lookup"><span data-stu-id="0644f-168">This script is used to Start/Stop a Send Port (BizTalk application artifact).</span></span>|  
|<span data-ttu-id="0644f-169">Microsoft.BizTalk.Server.2013.SendPortGroupAction.vbs</span><span class="sxs-lookup"><span data-stu-id="0644f-169">Microsoft.BizTalk.Server.2013.SendPortGroupAction.vbs</span></span>|<span data-ttu-id="0644f-170">使用此脚本到启动/停止发送端口组 （BizTalk 应用程序项目）。</span><span class="sxs-lookup"><span data-stu-id="0644f-170">This script is used to Start/Stop a Send Port Group (BizTalk application artifact).</span></span>|