---
title: 如何从.msi 文件导入应用程序 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a5472df9-9f1e-42d5-82e0-cc559caf56b3
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: fc79413b17343ff7dbf27c90af803e7b22fb0678
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009542"
---
# <a name="how-to-import-an-application-from-an-msi-file"></a><span data-ttu-id="da9b7-102">如何从.msi 文件导入应用程序</span><span class="sxs-lookup"><span data-stu-id="da9b7-102">How to Import an Application from an .msi File</span></span>
<span data-ttu-id="da9b7-103">BizTalk Server 管理控制台或 BTSTask 中的导入 MSI 向导可用于将 BizTalk 应用程序从.msi 文件导入到目标环境中的 BizTalk 组和各个主机组中的实例上安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-103">You can use the Import MSI Wizard in the BizTalk Server Administration Console or BTSTask to import a BizTalk application from an .msi file into a BizTalk group in the target environment and install the application on individual host instances in the group.</span></span> <span data-ttu-id="da9b7-104">完全导入过程将执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="da9b7-104">The full import process performs the following operations:</span></span>  
  
-   <span data-ttu-id="da9b7-105">应用程序组级别部署</span><span class="sxs-lookup"><span data-stu-id="da9b7-105">A group-level deployment of the application</span></span>  
  
-   <span data-ttu-id="da9b7-106">服务器级安装此应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-106">A server-level installation of the application.</span></span>  
  
 <span data-ttu-id="da9b7-107">**组级别的应用程序部署**</span><span class="sxs-lookup"><span data-stu-id="da9b7-107">**Group-Level Application Deployment**</span></span>  
  
 <span data-ttu-id="da9b7-108">通过运行从 BizTalk Server 管理控制台的导入 MIS 向导或通过运行 BTSTask，可以在组中的服务器上执行的应用程序组级别的部署。</span><span class="sxs-lookup"><span data-stu-id="da9b7-108">You perform a group-level deployment of an application on a server in the group by running the Import MIS Wizard from the BizTalk Server Administration console or by running BTSTask.</span></span> <span data-ttu-id="da9b7-109">组级别部署执行以下任务：</span><span class="sxs-lookup"><span data-stu-id="da9b7-109">The group-level deployment does the following:</span></span>  
  
-   <span data-ttu-id="da9b7-110">在组中创建应用程序和其项目</span><span class="sxs-lookup"><span data-stu-id="da9b7-110">Creates the application and its artifacts in the group</span></span>  
  
-   <span data-ttu-id="da9b7-111">导入驻留在.msi 程序包的绑定</span><span class="sxs-lookup"><span data-stu-id="da9b7-111">Imports bindings resident in the .msi package</span></span>  
  
-   <span data-ttu-id="da9b7-112">将使用其内容的所有 BizTalk Server 程序集都部署到组 BizTalk 管理数据库</span><span class="sxs-lookup"><span data-stu-id="da9b7-112">Deploys all BizTalk Server assemblies with their artifacts to the BizTalk Management database for the group</span></span>  
  
-   <span data-ttu-id="da9b7-113">运行指定在导入时间运行的脚本。</span><span class="sxs-lookup"><span data-stu-id="da9b7-113">Runs scripts specified to run at import time.</span></span>  
  
 <span data-ttu-id="da9b7-114">如果你已添加到应用程序的特定于环境的绑定文件，你将需要选择你想要在导入时应用的绑定。</span><span class="sxs-lookup"><span data-stu-id="da9b7-114">If you have added environment-specific binding files to the application, you will have to select the bindings that you want to apply on import.</span></span>  
  
 <span data-ttu-id="da9b7-115">**服务器级别的应用程序安装**</span><span class="sxs-lookup"><span data-stu-id="da9b7-115">**Server-Level Application Installation**</span></span>  
  
 <span data-ttu-id="da9b7-116">通过双击.msi 文件本身，或执行导入 MSI 向导末尾的安装过程，可以在组中每个服务器上执行应用程序的服务器级安装。</span><span class="sxs-lookup"><span data-stu-id="da9b7-116">You perform a server-level installation of an application on each server in a group by double-clicking the .msi file itself, or performing the install process at the end of the Import MSI Wizard.</span></span> <span data-ttu-id="da9b7-117">而不是正在执行上一次每个组，它通常服务器上完成每个 BizTalk 组的成员。</span><span class="sxs-lookup"><span data-stu-id="da9b7-117">Instead of being done once per group, it is typically done on each BizTalk server that is a member of the group.</span></span> <span data-ttu-id="da9b7-118">服务器级安装执行以下任务：</span><span class="sxs-lookup"><span data-stu-id="da9b7-118">The server-level installation does the following:</span></span>  
  
-   <span data-ttu-id="da9b7-119">将安装所有 BizTalk Server 程序集和依赖程序集到全局程序集缓存的服务器，以便此计算机上具有所有运行时所需的二进制文件</span><span class="sxs-lookup"><span data-stu-id="da9b7-119">Installs all BizTalk Server assemblies and dependency assemblies into the global assembly cache of the server, so that this computer has all of the binaries that it needs for runtime</span></span>  
  
-   <span data-ttu-id="da9b7-120">可能是解决方案的一部分，例如，业务流程发布作为 Web 服务的相关 Web 服务的回滚。</span><span class="sxs-lookup"><span data-stu-id="da9b7-120">Rolls out related Web services that might be part of the solution, for example, orchestrations published as Web services.</span></span>  
  
-   <span data-ttu-id="da9b7-121">将应用特定于计算机的更改，例如预先创建 MSMQ 队列或创建文件放置文件夹的结构和权限，这可以实现脚本的帮助。</span><span class="sxs-lookup"><span data-stu-id="da9b7-121">Applies computer-specific changes, such as pre-creating MSMQ queues or creating FILE drop folder structures and permissions, which can be done with the help of scripts.</span></span>  
  
 <span data-ttu-id="da9b7-122">执行.msi 文件安装应用程序时，.msi 文件将在添加或删除程序列表中，创建注册表项，并通过自动执行部署的项目以及它们的依赖项，按正确的顺序加快部署。</span><span class="sxs-lookup"><span data-stu-id="da9b7-122">When you execute an .msi file to install an application, the .msi file creates registration entries in the Add or Remove Programs list, and accelerates deployment by automating deployment of artifacts and their dependencies in the correct order.</span></span>  
  
 <span data-ttu-id="da9b7-123">安装 BizTalk 应用程序的详细信息，请参阅[如何安装应用程序](../technical-guides/how-to-install-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-123">For more information on installing a BizTalk application, see [How to Install an Application](../technical-guides/how-to-install-an-application.md).</span></span>  
  
 <span data-ttu-id="da9b7-124">**完整的应用程序部署和安装过程**</span><span class="sxs-lookup"><span data-stu-id="da9b7-124">**The Complete Application Deployment and Installation Process**</span></span>  
  
 <span data-ttu-id="da9b7-125">导入 MSI 向导将部署组上的应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-125">The Import MSI Wizard deploys the application on the group.</span></span> <span data-ttu-id="da9b7-126">它不在组中的单个服务器上安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-126">It does not install the application on the individual servers in the group.</span></span> <span data-ttu-id="da9b7-127">如果应用程序包括基于文件的项目，你需要在每个主机实例将在应用程序 （和运行应用程序依赖于此应用程序的任何计算机） 中运行的程序集上安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-127">If the application includes file-based artifacts, you need to install the application on each host instance that will run the assemblies in the application (and any computers running applications that depend on this application).</span></span> <span data-ttu-id="da9b7-128">你可以执行以便在服务器上您导入 MSI 向导在上运行，但是，通过选择**运行应用程序安装向导在本地计算机上安装应用程序**显示导入成功页上的复选框导入 MSI 向导。</span><span class="sxs-lookup"><span data-stu-id="da9b7-128">You can do so on the server you ran the Import MSI Wizard on, however, by selecting the **Run the Application Installation Wizard to install the application on the local computer** check box on the Import Succeeded page displayed by the Import MSI Wizard.</span></span> <span data-ttu-id="da9b7-129">可以通过双击每台服务器上的.msi 文件，在上组中的其他服务器执行此操作。</span><span class="sxs-lookup"><span data-stu-id="da9b7-129">You can do so on the other servers in the group by double-clicking the .msi file on each of those servers.</span></span>  
  
 <span data-ttu-id="da9b7-130">如果你已准备好测试应用程序，你可以将它导入测试环境中的 BizTalk 组。</span><span class="sxs-lookup"><span data-stu-id="da9b7-130">If you are ready to test the application, you can import it into a BizTalk group in a test environment.</span></span> <span data-ttu-id="da9b7-131">如果你的应用程序可供临时或生产环境，你可以将它导入这些环境之一。</span><span class="sxs-lookup"><span data-stu-id="da9b7-131">If your application is ready for staging or production, you can import it into one of those environments.</span></span>  
  
## <a name="important-considerations"></a><span data-ttu-id="da9b7-132">重要注意事项</span><span class="sxs-lookup"><span data-stu-id="da9b7-132">Important Considerations</span></span>  
 <span data-ttu-id="da9b7-133">当从.msi 文件导入 BizTalk 应用程序，请记住以下：</span><span class="sxs-lookup"><span data-stu-id="da9b7-133">When importing a BizTalk application from an .msi file, keep the following in mind:</span></span>  
  
-   <span data-ttu-id="da9b7-134">**你必须指定你想要在标准导入过程中覆盖项目。**</span><span class="sxs-lookup"><span data-stu-id="da9b7-134">**You must specify that you want artifacts to be overwritten in a standard import process.**</span></span> <span data-ttu-id="da9b7-135">如果你想要覆盖现有项目，选择选项覆盖现有项目时导入.msi 文件。</span><span class="sxs-lookup"><span data-stu-id="da9b7-135">If you want to overwrite existing artifacts, select the option to overwrite existing artifacts when importing the .msi file.</span></span>  
  
-   <span data-ttu-id="da9b7-136">**导入的绑定将覆盖现有的绑定。**</span><span class="sxs-lookup"><span data-stu-id="da9b7-136">**Imported bindings overwrite existing bindings.**</span></span> <span data-ttu-id="da9b7-137">将包含绑定的 .msi 文件导入到现有应用程序时，现有绑定将被同名的导入绑定覆盖。</span><span class="sxs-lookup"><span data-stu-id="da9b7-137">When you import an .msi file that contains bindings into an existing application, the existing bindings are overwritten by imported bindings that have the same name.</span></span> <span data-ttu-id="da9b7-138">即使您没有选择在导入 .msi 文件时覆盖现有项目的选项，现有绑定也将被同名导入绑定覆盖。</span><span class="sxs-lookup"><span data-stu-id="da9b7-138">This is the case even when you have not selected the option to overwrite existing artifacts when importing the .msi file.</span></span> <span data-ttu-id="da9b7-139">如果您不希望用导出的应用程序中的绑定覆盖导入 .msi 文件的应用程序中的绑定，请不要在导出操作中选择将该绑定文件作为资源导出。</span><span class="sxs-lookup"><span data-stu-id="da9b7-139">If you do not want the bindings in the application you are exporting to overwrite the bindings in an application into which you are importing the .msi file, then you should not select the binding file as a resource to export during the export operation.</span></span> <span data-ttu-id="da9b7-140">有关设置导出的资源的详细信息，请参阅[how to Export BizTalk 应用程序如何](http://go.microsoft.com/fwlink/?LinkID=154848)(http://go.microsoft.com/fwlink/?LinkID=154848)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-140">For more information about setting the resources for an export, see [How to Export a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154848) (http://go.microsoft.com/fwlink/?LinkID=154848).</span></span>  
  
 <span data-ttu-id="da9b7-141">由于绑定在导入过程中应用，所以已应用的绑定将被同名的新绑定所覆盖。</span><span class="sxs-lookup"><span data-stu-id="da9b7-141">As bindings are applied during the import process, bindings that have already been applied are overwritten by new bindings that have the same name.</span></span> <span data-ttu-id="da9b7-142">换言之，将应用的具有特定名称的最后一个绑定生效。</span><span class="sxs-lookup"><span data-stu-id="da9b7-142">In other words, the last binding of a particular name to be applied takes effect.</span></span> <span data-ttu-id="da9b7-143">导入应用程序时，绑定按如下顺序应用：</span><span class="sxs-lookup"><span data-stu-id="da9b7-143">When you import an application, bindings are applied in the following order:</span></span>  
  
1.  <span data-ttu-id="da9b7-144">由 BizTalk Server 生成的、未通过绑定文件显式添加到应用程序但用户已经显式选择导出到应用程序 .msi 文件的应用程序绑定。</span><span class="sxs-lookup"><span data-stu-id="da9b7-144">Application bindings generated by BizTalk Server that were not explicitly added to the application via a binding file, but that were explicitly selected by the user for export into the application .msi file.</span></span>  
  
2.  <span data-ttu-id="da9b7-145">已经显式添加但尚未指定目标部署环境的绑定文件。</span><span class="sxs-lookup"><span data-stu-id="da9b7-145">Binding files that have been explicitly added, and do not have a target deployment environment specified.</span></span> <span data-ttu-id="da9b7-146">本组中的绑定可以按任何顺序应用。</span><span class="sxs-lookup"><span data-stu-id="da9b7-146">Bindings in this set are applied in no specific order.</span></span>  
  
3.  <span data-ttu-id="da9b7-147">已经显式添加并且具有与为导入应用程序而选的部署环境相匹配的关联目标部署环境的绑定。</span><span class="sxs-lookup"><span data-stu-id="da9b7-147">Bindings that have been explicitly added, and that have an associated target deployment environment that matches the deployment environment selected for application import.</span></span> <span data-ttu-id="da9b7-148">本组中的绑定可以按任何顺序应用。</span><span class="sxs-lookup"><span data-stu-id="da9b7-148">Bindings in this set are applied in no specific order.</span></span>  
  
-   <span data-ttu-id="da9b7-149">**指定的主机必须存在。**</span><span class="sxs-lookup"><span data-stu-id="da9b7-149">**The host specified must exist.**</span></span> <span data-ttu-id="da9b7-150">若要从.msi 文件导入应用程序，对应于在.msi 文件中包含的应用程序绑定中指定的主机的主机必须已存在于 BizTalk 组，或导入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="da9b7-150">To import an application from an .msi file, a host corresponding to the host specified in the application bindings contained in the .msi file must already exist in the BizTalk group or the import operation will fail.</span></span> <span data-ttu-id="da9b7-151">此外，主机的信任级别必须匹配。</span><span class="sxs-lookup"><span data-stu-id="da9b7-151">In addition, the host trust level must match.</span></span>  
  
-   <span data-ttu-id="da9b7-152">**依赖项可以在导入操作时的重大影响。**</span><span class="sxs-lookup"><span data-stu-id="da9b7-152">**Dependencies can have significant effects upon import operations.**</span></span> <span data-ttu-id="da9b7-153">当你导入的应用程序具有另一个应用程序的依赖关系时，下列规则适用：</span><span class="sxs-lookup"><span data-stu-id="da9b7-153">When you import an application that has a dependency on another application, the following rules apply:</span></span>  
  
    -   <span data-ttu-id="da9b7-154">如果您要导入的应用程序依赖于其他应用程序中的项目，你必须从第一个应用程序到第二个应用程序中添加的引用。</span><span class="sxs-lookup"><span data-stu-id="da9b7-154">If an application that you are importing depends on an artifact in another application, you must add a reference from the first application to the second application.</span></span> <span data-ttu-id="da9b7-155">应用程序和所需的项目必须已存在目标组中。</span><span class="sxs-lookup"><span data-stu-id="da9b7-155">The application and the required artifact must already exist in the destination group.</span></span> <span data-ttu-id="da9b7-156">导入向导，可将引用添加。</span><span class="sxs-lookup"><span data-stu-id="da9b7-156">The Import Wizard enables you to add the reference.</span></span> <span data-ttu-id="da9b7-157">但是，如果你使用的 BTSTask ImportApp 命令，你必须添加对导入后的应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="da9b7-157">However, if you are using the ImportApp command of BTSTask, you must add the reference to the application after import.</span></span> <span data-ttu-id="da9b7-158">有关详细信息，请参阅[如何添加对另一个应用程序的引用](http://go.microsoft.com/fwlink/?LinkId=155011)(http://go.microsoft.com/fwlink/?LinkId=155011)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-158">For more information, see [How to Add a Reference to Another Application](http://go.microsoft.com/fwlink/?LinkId=155011) (http://go.microsoft.com/fwlink/?LinkId=155011).</span></span> <span data-ttu-id="da9b7-159">导入向导将这些引用与组中现有应用程序相匹配，并且通过该向导您还可选择添加新引用或更改现有引用。</span><span class="sxs-lookup"><span data-stu-id="da9b7-159">The Import Wizard matches the references to existing applications in the group and gives you the option to add a new reference or change an existing reference.</span></span> <span data-ttu-id="da9b7-160">在 BizTalk Server 确认存在引用的应用程序时，我们建议您采取其他步骤来确认引用的应用程序包含所需项目。</span><span class="sxs-lookup"><span data-stu-id="da9b7-160">While BizTalk Server verifies that the referenced application exists, we recommend that you take the additional step of verifying that the referenced application contains the required artifact.</span></span>  
  
    -   <span data-ttu-id="da9b7-161">在您安装某一应用程序时，还必须安装它所依赖的任何应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-161">When you install an application, you must also install any applications on which it depends.</span></span> <span data-ttu-id="da9b7-162">如果某个项目（如 BizTalk 程序集）包含在另一个应用程序中，而要安装的应用程序与该项目之间存在依存关系，则在安装该应用程序时，必须首先安装包含该项目的应用程序。</span><span class="sxs-lookup"><span data-stu-id="da9b7-162">When you install an application that has a dependency on an artifact, such as a BizTalk assembly, which is contained in another application, you must first install the application that contains the artifact.</span></span> <span data-ttu-id="da9b7-163">例如，如果您要安装应用程序 A，并且它依赖于应用程序 B 中的程序集，则您必须首先安装应用程序 B。</span><span class="sxs-lookup"><span data-stu-id="da9b7-163">For example, if you want to install Application A, and it depends on an assembly in Application B, you must install Application B first.</span></span> <span data-ttu-id="da9b7-164">然后，你可以安装应用程序 a。有关安装 BizTalk 应用程序的详细信息，请参阅[如何安装应用程序](../technical-guides/how-to-install-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-164">Then you can install Application A. For more information about installing a BizTalk application, see [How to Install an Application](../technical-guides/how-to-install-an-application.md).</span></span>  
  
    -   <span data-ttu-id="da9b7-165">如果您想要将某一应用程序导入到不同的 BizTalk 组并在该组中运行此应用程序，则还必须导入此应用程序所依赖的所有项目。</span><span class="sxs-lookup"><span data-stu-id="da9b7-165">If you want to import an application into a different BizTalk group and run it in that group, you must also import any artifacts on which this application depends.</span></span> <span data-ttu-id="da9b7-166">通过第一个导入的应用程序包含引用的项目中，或通过将所需的项目添加到的应用程序需要它时，可以执行此操作。</span><span class="sxs-lookup"><span data-stu-id="da9b7-166">You can do this by first importing an application that contains the referenced artifact, or by adding the needed artifact to the application that requires it.</span></span> <span data-ttu-id="da9b7-167">有关导入 BizTalk 应用程序的详细信息，请参阅[如何从一个.msi 文件导入应用程序](../technical-guides/how-to-import-an-application-from-an-msi-file.md)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-167">For more information about importing a BizTalk application, see [How to Import an Application from an .msi File](../technical-guides/how-to-import-an-application-from-an-msi-file.md).</span></span>  
  
 <span data-ttu-id="da9b7-168">有关详细注意事项和有关从.msi 文件导入 BizTalk 应用程序的信息，请参阅[如何导入 BizTalk 应用程序](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-168">For more considerations and information about importing a BizTalk application from an .msi file, see [How to Import a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154827) (http://go.microsoft.com/fwlink/?LinkID=154827).</span></span>  
  
## <a name="how-to-import-an-application"></a><span data-ttu-id="da9b7-169">如何导入应用程序</span><span class="sxs-lookup"><span data-stu-id="da9b7-169">How to Import an Application</span></span>  
 <span data-ttu-id="da9b7-170">有关从.msi 文件导入 BizTalk 应用程序的说明，请参阅[如何导入 BizTalk 应用程序](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)。</span><span class="sxs-lookup"><span data-stu-id="da9b7-170">For instructions on importing a BizTalk application from an .msi file, see [How to Import a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154827) (http://go.microsoft.com/fwlink/?LinkID=154827).</span></span>