---
title: 如何从某一.msi 文件导入应用程序 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a5472df9-9f1e-42d5-82e0-cc559caf56b3
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4e1cea55ba50a094258a3fcf07eedf30466566d3
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "37004918"
---
# <a name="how-to-import-an-application-from-an-msi-file"></a><span data-ttu-id="897bd-102">如何从某一.msi 文件导入应用程序</span><span class="sxs-lookup"><span data-stu-id="897bd-102">How to Import an Application from an .msi File</span></span>
<span data-ttu-id="897bd-103">在 BizTalk Server 管理控制台或 BTSTask 导入 MSI 向导可用于 BizTalk 应用程序从.msi 文件导入到目标环境中的 BizTalk 组和组中的各个主机实例上安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-103">You can use the Import MSI Wizard in the BizTalk Server Administration Console or BTSTask to import a BizTalk application from an .msi file into a BizTalk group in the target environment and install the application on individual host instances in the group.</span></span> <span data-ttu-id="897bd-104">完全导入过程将执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="897bd-104">The full import process performs the following operations:</span></span>  
  
- <span data-ttu-id="897bd-105">组级别部署应用程序</span><span class="sxs-lookup"><span data-stu-id="897bd-105">A group-level deployment of the application</span></span>  
  
- <span data-ttu-id="897bd-106">安装的服务器级别的应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-106">A server-level installation of the application.</span></span>  
  
  <span data-ttu-id="897bd-107">**组级别应用程序部署**</span><span class="sxs-lookup"><span data-stu-id="897bd-107">**Group-Level Application Deployment**</span></span>  
  
  <span data-ttu-id="897bd-108">通过运行导入 MIS 向导从 BizTalk Server 管理控制台或通过运行 BTSTask 的组中的服务器上执行应用程序组级别的部署。</span><span class="sxs-lookup"><span data-stu-id="897bd-108">You perform a group-level deployment of an application on a server in the group by running the Import MIS Wizard from the BizTalk Server Administration console or by running BTSTask.</span></span> <span data-ttu-id="897bd-109">组级别部署执行以下任务：</span><span class="sxs-lookup"><span data-stu-id="897bd-109">The group-level deployment does the following:</span></span>  
  
- <span data-ttu-id="897bd-110">在组中创建应用程序和其项目</span><span class="sxs-lookup"><span data-stu-id="897bd-110">Creates the application and its artifacts in the group</span></span>  
  
- <span data-ttu-id="897bd-111">将绑定驻留在.msi 包中导入</span><span class="sxs-lookup"><span data-stu-id="897bd-111">Imports bindings resident in the .msi package</span></span>  
  
- <span data-ttu-id="897bd-112">将使用其项目的所有 BizTalk Server 程序集都部署到 BizTalk 管理数据库组</span><span class="sxs-lookup"><span data-stu-id="897bd-112">Deploys all BizTalk Server assemblies with their artifacts to the BizTalk Management database for the group</span></span>  
  
- <span data-ttu-id="897bd-113">运行指定要在导入时运行脚本。</span><span class="sxs-lookup"><span data-stu-id="897bd-113">Runs scripts specified to run at import time.</span></span>  
  
  <span data-ttu-id="897bd-114">如果已将特定于环境的绑定文件添加到应用程序，您将必须选择你想要在导入时应用的绑定。</span><span class="sxs-lookup"><span data-stu-id="897bd-114">If you have added environment-specific binding files to the application, you will have to select the bindings that you want to apply on import.</span></span>  
  
  <span data-ttu-id="897bd-115">**服务器级别的应用程序安装**</span><span class="sxs-lookup"><span data-stu-id="897bd-115">**Server-Level Application Installation**</span></span>  
  
  <span data-ttu-id="897bd-116">通过双击.msi 文件本身，或执行安装过程中的导入 MSI 向导结束时，可以在组中每个服务器上执行服务器级别安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-116">You perform a server-level installation of an application on each server in a group by double-clicking the .msi file itself, or performing the install process at the end of the Import MSI Wizard.</span></span> <span data-ttu-id="897bd-117">而不是正在进行上一次每个组，它通常是在每个 BizTalk server 组的成员。</span><span class="sxs-lookup"><span data-stu-id="897bd-117">Instead of being done once per group, it is typically done on each BizTalk server that is a member of the group.</span></span> <span data-ttu-id="897bd-118">服务器级别安装将执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="897bd-118">The server-level installation does the following:</span></span>  
  
- <span data-ttu-id="897bd-119">以便此计算机上具有所有所需的运行时的二进制文件安装到全局程序集缓存中的服务器的所有 BizTalk Server 程序集和依赖程序集</span><span class="sxs-lookup"><span data-stu-id="897bd-119">Installs all BizTalk Server assemblies and dependency assemblies into the global assembly cache of the server, so that this computer has all of the binaries that it needs for runtime</span></span>  
  
- <span data-ttu-id="897bd-120">发布了可能的解决方案的一部分，例如，业务流程发布为 Web 服务相关 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="897bd-120">Rolls out related Web services that might be part of the solution, for example, orchestrations published as Web services.</span></span>  
  
- <span data-ttu-id="897bd-121">应用特定于计算机的更改，例如预创建 MSMQ 队列，或创建文件放置文件夹结构和权限，可以使用脚本的帮助。</span><span class="sxs-lookup"><span data-stu-id="897bd-121">Applies computer-specific changes, such as pre-creating MSMQ queues or creating FILE drop folder structures and permissions, which can be done with the help of scripts.</span></span>  
  
  <span data-ttu-id="897bd-122">在执行时要安装的应用程序的.msi 文件，.msi 文件中的添加或删除程序列表中，创建多个注册表项并加速并部署自动部署的项目和正确的顺序及其依赖项。</span><span class="sxs-lookup"><span data-stu-id="897bd-122">When you execute an .msi file to install an application, the .msi file creates registration entries in the Add or Remove Programs list, and accelerates deployment by automating deployment of artifacts and their dependencies in the correct order.</span></span>  
  
  <span data-ttu-id="897bd-123">安装 BizTalk 应用程序的详细信息，请参阅[如何安装应用程序](../technical-guides/how-to-install-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="897bd-123">For more information on installing a BizTalk application, see [How to Install an Application](../technical-guides/how-to-install-an-application.md).</span></span>  
  
  <span data-ttu-id="897bd-124">**完整的应用程序部署和安装过程**</span><span class="sxs-lookup"><span data-stu-id="897bd-124">**The Complete Application Deployment and Installation Process**</span></span>  
  
  <span data-ttu-id="897bd-125">导入 MSI 向导将部署组上的应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-125">The Import MSI Wizard deploys the application on the group.</span></span> <span data-ttu-id="897bd-126">它不在组中的单个服务器上安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-126">It does not install the application on the individual servers in the group.</span></span> <span data-ttu-id="897bd-127">如果应用程序包含基于文件的项目，您需要将应用程序 （和运行应用程序依赖于此应用程序的任何计算机） 中运行的程序集的每个主机实例上安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-127">If the application includes file-based artifacts, you need to install the application on each host instance that will run the assemblies in the application (and any computers running applications that depend on this application).</span></span> <span data-ttu-id="897bd-128">您可以执行以便在服务器上导入 MSI 向导上运行，但是，通过选择**运行应用程序安装向导以在本地计算机上安装应用程序**通过显示的导入成功页上的复选框导入 MSI 向导。</span><span class="sxs-lookup"><span data-stu-id="897bd-128">You can do so on the server you ran the Import MSI Wizard on, however, by selecting the **Run the Application Installation Wizard to install the application on the local computer** check box on the Import Succeeded page displayed by the Import MSI Wizard.</span></span> <span data-ttu-id="897bd-129">可以仍使用此组中的其他服务器上通过双击每个这些服务器上的.msi 文件。</span><span class="sxs-lookup"><span data-stu-id="897bd-129">You can do so on the other servers in the group by double-clicking the .msi file on each of those servers.</span></span>  
  
  <span data-ttu-id="897bd-130">如果你已准备好测试应用程序，可以将它导入在测试环境中的 BizTalk 组。</span><span class="sxs-lookup"><span data-stu-id="897bd-130">If you are ready to test the application, you can import it into a BizTalk group in a test environment.</span></span> <span data-ttu-id="897bd-131">如果应用程序是用于过渡或生产准备就绪，您可以将它导入这些环境之一。</span><span class="sxs-lookup"><span data-stu-id="897bd-131">If your application is ready for staging or production, you can import it into one of those environments.</span></span>  
  
## <a name="important-considerations"></a><span data-ttu-id="897bd-132">重要注意事项</span><span class="sxs-lookup"><span data-stu-id="897bd-132">Important Considerations</span></span>  
 <span data-ttu-id="897bd-133">当从.msi 文件导入 BizTalk 应用程序，请记住以下：</span><span class="sxs-lookup"><span data-stu-id="897bd-133">When importing a BizTalk application from an .msi file, keep the following in mind:</span></span>  
  
- <span data-ttu-id="897bd-134">**必须指定你想要在标准导入过程中都覆盖项目。**</span><span class="sxs-lookup"><span data-stu-id="897bd-134">**You must specify that you want artifacts to be overwritten in a standard import process.**</span></span> <span data-ttu-id="897bd-135">如果你想要覆盖现有项目，选择导入.msi 文件时覆盖现有项目的选项。</span><span class="sxs-lookup"><span data-stu-id="897bd-135">If you want to overwrite existing artifacts, select the option to overwrite existing artifacts when importing the .msi file.</span></span>  
  
- <span data-ttu-id="897bd-136">**导入的绑定覆盖现有绑定。**</span><span class="sxs-lookup"><span data-stu-id="897bd-136">**Imported bindings overwrite existing bindings.**</span></span> <span data-ttu-id="897bd-137">将包含绑定的 .msi 文件导入到现有应用程序时，现有绑定将被同名的导入绑定覆盖。</span><span class="sxs-lookup"><span data-stu-id="897bd-137">When you import an .msi file that contains bindings into an existing application, the existing bindings are overwritten by imported bindings that have the same name.</span></span> <span data-ttu-id="897bd-138">即使您没有选择在导入 .msi 文件时覆盖现有项目的选项，现有绑定也将被同名导入绑定覆盖。</span><span class="sxs-lookup"><span data-stu-id="897bd-138">This is the case even when you have not selected the option to overwrite existing artifacts when importing the .msi file.</span></span> <span data-ttu-id="897bd-139">如果您不希望用导出的应用程序中的绑定覆盖导入 .msi 文件的应用程序中的绑定，请不要在导出操作中选择将该绑定文件作为资源导出。</span><span class="sxs-lookup"><span data-stu-id="897bd-139">If you do not want the bindings in the application you are exporting to overwrite the bindings in an application into which you are importing the .msi file, then you should not select the binding file as a resource to export during the export operation.</span></span> <span data-ttu-id="897bd-140">有关设置导出的资源的详细信息，请参阅[如何导出 BizTalk 应用程序](http://go.microsoft.com/fwlink/?LinkID=154848)(http://go.microsoft.com/fwlink/?LinkID=154848)。</span><span class="sxs-lookup"><span data-stu-id="897bd-140">For more information about setting the resources for an export, see [How to Export a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154848) (http://go.microsoft.com/fwlink/?LinkID=154848).</span></span>  
  
  <span data-ttu-id="897bd-141">由于绑定在导入过程中应用，所以已应用的绑定将被同名的新绑定所覆盖。</span><span class="sxs-lookup"><span data-stu-id="897bd-141">As bindings are applied during the import process, bindings that have already been applied are overwritten by new bindings that have the same name.</span></span> <span data-ttu-id="897bd-142">换言之，将应用的具有特定名称的最后一个绑定生效。</span><span class="sxs-lookup"><span data-stu-id="897bd-142">In other words, the last binding of a particular name to be applied takes effect.</span></span> <span data-ttu-id="897bd-143">导入应用程序时，绑定按如下顺序应用：</span><span class="sxs-lookup"><span data-stu-id="897bd-143">When you import an application, bindings are applied in the following order:</span></span>  
  
1.  <span data-ttu-id="897bd-144">由 BizTalk Server 生成的、未通过绑定文件显式添加到应用程序但用户已经显式选择导出到应用程序 .msi 文件的应用程序绑定。</span><span class="sxs-lookup"><span data-stu-id="897bd-144">Application bindings generated by BizTalk Server that were not explicitly added to the application via a binding file, but that were explicitly selected by the user for export into the application .msi file.</span></span>  
  
2.  <span data-ttu-id="897bd-145">已经显式添加但尚未指定目标部署环境的绑定文件。</span><span class="sxs-lookup"><span data-stu-id="897bd-145">Binding files that have been explicitly added, and do not have a target deployment environment specified.</span></span> <span data-ttu-id="897bd-146">本组中的绑定可以按任何顺序应用。</span><span class="sxs-lookup"><span data-stu-id="897bd-146">Bindings in this set are applied in no specific order.</span></span>  
  
3.  <span data-ttu-id="897bd-147">已经显式添加并且具有与为导入应用程序而选的部署环境相匹配的关联目标部署环境的绑定。</span><span class="sxs-lookup"><span data-stu-id="897bd-147">Bindings that have been explicitly added, and that have an associated target deployment environment that matches the deployment environment selected for application import.</span></span> <span data-ttu-id="897bd-148">本组中的绑定可以按任何顺序应用。</span><span class="sxs-lookup"><span data-stu-id="897bd-148">Bindings in this set are applied in no specific order.</span></span>  
  
- <span data-ttu-id="897bd-149">**指定的主机必须存在。**</span><span class="sxs-lookup"><span data-stu-id="897bd-149">**The host specified must exist.**</span></span> <span data-ttu-id="897bd-150">若要从某一.msi 文件导入应用程序，主机相对应的.msi 文件中包含的应用程序绑定中指定的主机必须已存在于 BizTalk 组或导入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="897bd-150">To import an application from an .msi file, a host corresponding to the host specified in the application bindings contained in the .msi file must already exist in the BizTalk group or the import operation will fail.</span></span> <span data-ttu-id="897bd-151">此外，主机的信任级别必须匹配。</span><span class="sxs-lookup"><span data-stu-id="897bd-151">In addition, the host trust level must match.</span></span>  
  
- <span data-ttu-id="897bd-152">**依赖项有很大影响后导入操作。**</span><span class="sxs-lookup"><span data-stu-id="897bd-152">**Dependencies can have significant effects upon import operations.**</span></span> <span data-ttu-id="897bd-153">导入程序依赖于另一个应用程序的应用程序时，以下规则适用：</span><span class="sxs-lookup"><span data-stu-id="897bd-153">When you import an application that has a dependency on another application, the following rules apply:</span></span>  
  
  -   <span data-ttu-id="897bd-154">如果您要导入的应用程序依赖于另一个应用程序中的某个项目，你必须从第一个应用程序到第二个应用程序添加的引用。</span><span class="sxs-lookup"><span data-stu-id="897bd-154">If an application that you are importing depends on an artifact in another application, you must add a reference from the first application to the second application.</span></span> <span data-ttu-id="897bd-155">应用程序和所需的项目必须已存在于目标组。</span><span class="sxs-lookup"><span data-stu-id="897bd-155">The application and the required artifact must already exist in the destination group.</span></span> <span data-ttu-id="897bd-156">导入向导，可将引用添加。</span><span class="sxs-lookup"><span data-stu-id="897bd-156">The Import Wizard enables you to add the reference.</span></span> <span data-ttu-id="897bd-157">但是，如果使用 BTSTask 的 ImportApp 命令，必须添加对导入后的应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="897bd-157">However, if you are using the ImportApp command of BTSTask, you must add the reference to the application after import.</span></span> <span data-ttu-id="897bd-158">有关详细信息，请参阅[如何添加对另一个应用程序的引用](http://go.microsoft.com/fwlink/?LinkId=155011)(http://go.microsoft.com/fwlink/?LinkId=155011)。</span><span class="sxs-lookup"><span data-stu-id="897bd-158">For more information, see [How to Add a Reference to Another Application](http://go.microsoft.com/fwlink/?LinkId=155011) (http://go.microsoft.com/fwlink/?LinkId=155011).</span></span> <span data-ttu-id="897bd-159">导入向导将这些引用与组中现有应用程序相匹配，并且通过该向导您还可选择添加新引用或更改现有引用。</span><span class="sxs-lookup"><span data-stu-id="897bd-159">The Import Wizard matches the references to existing applications in the group and gives you the option to add a new reference or change an existing reference.</span></span> <span data-ttu-id="897bd-160">在 BizTalk Server 确认存在引用的应用程序时，我们建议您采取其他步骤来确认引用的应用程序包含所需项目。</span><span class="sxs-lookup"><span data-stu-id="897bd-160">While BizTalk Server verifies that the referenced application exists, we recommend that you take the additional step of verifying that the referenced application contains the required artifact.</span></span>  
  
  -   <span data-ttu-id="897bd-161">在您安装某一应用程序时，还必须安装它所依赖的任何应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-161">When you install an application, you must also install any applications on which it depends.</span></span> <span data-ttu-id="897bd-162">如果某个项目（如 BizTalk 程序集）包含在另一个应用程序中，而要安装的应用程序与该项目之间存在依存关系，则在安装该应用程序时，必须首先安装包含该项目的应用程序。</span><span class="sxs-lookup"><span data-stu-id="897bd-162">When you install an application that has a dependency on an artifact, such as a BizTalk assembly, which is contained in another application, you must first install the application that contains the artifact.</span></span> <span data-ttu-id="897bd-163">例如，如果您要安装应用程序 A，并且它依赖于应用程序 B 中的程序集，则您必须首先安装应用程序 B。</span><span class="sxs-lookup"><span data-stu-id="897bd-163">For example, if you want to install Application A, and it depends on an assembly in Application B, you must install Application B first.</span></span> <span data-ttu-id="897bd-164">然后，你可以安装应用程序 a。有关安装 BizTalk 应用程序的详细信息，请参阅[如何安装应用程序](../technical-guides/how-to-install-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="897bd-164">Then you can install Application A. For more information about installing a BizTalk application, see [How to Install an Application](../technical-guides/how-to-install-an-application.md).</span></span>  
  
  -   <span data-ttu-id="897bd-165">如果您想要将某一应用程序导入到不同的 BizTalk 组并在该组中运行此应用程序，则还必须导入此应用程序所依赖的所有项目。</span><span class="sxs-lookup"><span data-stu-id="897bd-165">If you want to import an application into a different BizTalk group and run it in that group, you must also import any artifacts on which this application depends.</span></span> <span data-ttu-id="897bd-166">通过首先导入的应用程序包含所引用的项目，或通过将所需的项目添加到需要它的应用程序时，可以执行此操作。</span><span class="sxs-lookup"><span data-stu-id="897bd-166">You can do this by first importing an application that contains the referenced artifact, or by adding the needed artifact to the application that requires it.</span></span> <span data-ttu-id="897bd-167">有关导入 BizTalk 应用程序的详细信息，请参阅[如何从一个.msi 文件导入应用程序](../technical-guides/how-to-import-an-application-from-an-msi-file.md)。</span><span class="sxs-lookup"><span data-stu-id="897bd-167">For more information about importing a BizTalk application, see [How to Import an Application from an .msi File](../technical-guides/how-to-import-an-application-from-an-msi-file.md).</span></span>  
  
  <span data-ttu-id="897bd-168">有关详细注意事项和从某一.msi 文件导入 BizTalk 应用程序有关的信息，请参阅[导入 BizTalk 应用程序的方式](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)。</span><span class="sxs-lookup"><span data-stu-id="897bd-168">For more considerations and information about importing a BizTalk application from an .msi file, see [How to Import a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154827) (http://go.microsoft.com/fwlink/?LinkID=154827).</span></span>  
  
## <a name="how-to-import-an-application"></a><span data-ttu-id="897bd-169">如何导入应用程序</span><span class="sxs-lookup"><span data-stu-id="897bd-169">How to Import an Application</span></span>  
 <span data-ttu-id="897bd-170">有关从某一.msi 文件导入 BizTalk 应用程序的说明，请参阅[导入 BizTalk 应用程序的方式](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)。</span><span class="sxs-lookup"><span data-stu-id="897bd-170">For instructions on importing a BizTalk application from an .msi file, see [How to Import a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154827) (http://go.microsoft.com/fwlink/?LinkID=154827).</span></span>