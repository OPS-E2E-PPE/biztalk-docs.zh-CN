---
title: 配置专用的跟踪主机 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f997bcc2-08fd-4e9a-ba44-542ec8460d6d
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b91a4b65c6e9a9b293e967385b8f0ac4eece1aa4
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
ms.locfileid: "26010838"
---
# <a name="configuring-a-dedicated-tracking-host"></a><span data-ttu-id="9a5c8-102">配置专用的跟踪主机</span><span class="sxs-lookup"><span data-stu-id="9a5c8-102">Configuring a Dedicated Tracking Host</span></span>
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="9a5c8-103">针对吞吐量优化，因此主要业务流程和消息传送引擎执行不实际事件或消息直接转至 BizTalk 跟踪 (DTA) 或业务活动监视 (BAM) 数据库，因为这将会从其主这些引擎将转换执行业务流程的作业。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-103"> is optimized for throughput, so the main orchestration and messaging engines do not actually move events or messages directly to the BizTalk Tracking (DTA) or Business Activity Monitoring (BAM) databases, since this would divert these engines from their primary job of executing business processes.</span></span> <span data-ttu-id="9a5c8-104">相反，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]使 MessageBox 数据库中的事件和消息并将其标记为需要迁移到 BizTalk 跟踪或 BAM 数据库。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-104">Instead, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] leaves the events and messages in the MessageBox database and marks them as requiring a move to the BizTalk Tracking or BAM databases.</span></span> <span data-ttu-id="9a5c8-105">后台进程 （跟踪主机），然后移动到 BizTalk 跟踪和 BAM 数据库，SQL Server 代理作业副本跟踪的消息到 BizTalk 跟踪数据库时的事件。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-105">A background process (the tracking host) then moves the events to the BizTalk Tracking and BAM databases, while a SQL Server Agent job copies tracked messages to the BizTalk Tracking database.</span></span>  
  
## <a name="advantages-of-using-a-dedicated-tracking-host"></a><span data-ttu-id="9a5c8-106">使用专用的跟踪主机的优点</span><span class="sxs-lookup"><span data-stu-id="9a5c8-106">Advantages of Using a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="9a5c8-107">可承载跟踪 BizTalk 主机负责移动 DTA 和 BAM 到 BizTalk 跟踪 (DTA) 和 BAM 主导入数据库从 MessageBox 数据库跟踪数据。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-107">A BizTalk Host that hosts tracking is responsible for moving the DTA and BAM tracking data from the MessageBox database to the BizTalk Tracking (DTA) and BAM Primary Import databases.</span></span> <span data-ttu-id="9a5c8-108">这种跟踪数据移动的其他 BizTalk 项目，在承载跟踪的同一主机中运行的性能产生影响。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-108">This movement of tracking data has an impact on the performance of other BizTalk artifacts that are running in the same host that is hosting tracking.</span></span> <span data-ttu-id="9a5c8-109">因此，应使用不执行任何操作，但跟踪的主机的专用的主机。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-109">Thus, you should use a dedicated host that does nothing but host tracking.</span></span>  
  
 <span data-ttu-id="9a5c8-110">使用专用的跟踪主机还使你可以停止而不会干扰其他 BizTalk 主机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]跟踪。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-110">Using a dedicated tracking host also allows you to stop other BizTalk hosts without interfering with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking.</span></span> <span data-ttu-id="9a5c8-111">跟踪从 MessageBox 的数据库的数据的移动至关重要的正常[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系统。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-111">The movement of tracking data out of the MessageBox database is critical for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="9a5c8-112">如果停止 BizTalk 主机负责将跟踪数据移动 BizTalk 组中，跟踪数据解码服务将不会运行。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-112">If the BizTalk Host responsible for moving tracking data in the BizTalk group is stopped, the Tracking Data Decode service will not run.</span></span> <span data-ttu-id="9a5c8-113">此方法的影响是，如下所示：</span><span class="sxs-lookup"><span data-stu-id="9a5c8-113">The impact of this is as follows:</span></span>  
  
-   <span data-ttu-id="9a5c8-114">HAT 跟踪数据不会从 MessageBox 数据库移至 BizTalk 跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-114">HAT tracking data will not be moved from the MessageBox database to the BizTalk Tracking database.</span></span>  
  
-   <span data-ttu-id="9a5c8-115">BAM 跟踪数据不会从 MessageBox 数据库移至 BAM 主导入数据库。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-115">BAM tracking data will not be moved from the MessageBox database to the BAM Primary Import database.</span></span>  
  
-   <span data-ttu-id="9a5c8-116">因为不移动数据时，它不能从 MessageBox 数据库中删除。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-116">Because data is not moved, it cannot be deleted from the MessageBox database.</span></span>  
  
-   <span data-ttu-id="9a5c8-117">当停止跟踪数据解码服务时，跟踪拦截器仍将运行并将跟踪数据写入到 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-117">When the Tracking Data Decode service is stopped, tracking interceptors will still run and write tracking data to the MessageBox database.</span></span> <span data-ttu-id="9a5c8-118">如果不移动数据时，这会将会影响性能随着时间的推移导致 MessageBox 数据库变得臃肿。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-118">If the data is not moved, this will cause the MessageBox database to become bloated, which will affect performance over time.</span></span> <span data-ttu-id="9a5c8-119">即使自定义属性不会跟踪或 BAM 配置文件未设置，默认情况下的某些数据跟踪 （如管道接收 / 发送事件和业务流程事件）。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-119">Even if custom properties are not tracked or BAM profiles are not set up, by default some data is tracked (such as pipeline receive / send events and orchestration events).</span></span> <span data-ttu-id="9a5c8-120">如果您不想要运行的跟踪数据解码的服务，请关闭所有跟踪，以便不拦截器将数据保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-120">If you do not want to run the Tracking Data Decode service, turn off all tracking so that no interceptors save data to the database.</span></span> <span data-ttu-id="9a5c8-121">若要禁用全局跟踪，请参阅[如何打开关闭全局跟踪](http://go.microsoft.com/fwlink/?LinkId=154193)(http://go.microsoft.com/fwlink/?LinkId=154193) 使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台，可有选择性地禁用跟踪事件。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-121">To disable global tracking, see [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkId=154193) (http://go.microsoft.com/fwlink/?LinkId=154193) Use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console to selectively disable tracking events.</span></span>  
  
## <a name="optimizing-performance-for-a-dedicated-tracking-host"></a><span data-ttu-id="9a5c8-122">优化的专用的跟踪主机的性能</span><span class="sxs-lookup"><span data-stu-id="9a5c8-122">Optimizing Performance for a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="9a5c8-123">应运行的在至少两台计算机上运行此主机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]（用例中的冗余来说一个失败）。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-123">This host should be run on at least two computers running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] (for redundancy in case one fails).</span></span> <span data-ttu-id="9a5c8-124">为了获得最佳性能，应具有至少一个跟踪每个 MessageBox 数据库的主机实例。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-124">For optimal performance, you should have at least one tracking host instance per MessageBox database.</span></span> <span data-ttu-id="9a5c8-125">跟踪主机实例的实际数应为 N + 1，其中 N = MessageBox 数据库的数目。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-125">The actual number of tracking host instances should be N + 1, where N = the number of MessageBox databases.</span></span> <span data-ttu-id="9a5c8-126">"+ 1"是以实现冗余。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-126">The "+ 1" is for redundancy.</span></span> <span data-ttu-id="9a5c8-127">没有没有好处。 添加多个，因为只有一个跟踪主机实例可以将特定的 MessageBox 数据库的数据移动。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-127">There is no benefit to adding more than that, because only one tracking host instance can move data for a specific MessageBox database.</span></span> <span data-ttu-id="9a5c8-128">因此，锁定不应是问题。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-128">As a result, locking should never be an issue.</span></span> <span data-ttu-id="9a5c8-129">其他的一个跟踪主机实例将添加容错功能;如果跟踪之一承载实例失败，其他实例将假定的失败实例的职责。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-129">The one additional tracking host instance is added for fault tolerance; if one of the tracking host instances fails, the additional instance will assume the duties of the failed instance.</span></span>  
  
 <span data-ttu-id="9a5c8-130">跟踪主机实例移动特定的 MessageBox 数据库的跟踪数据，但将永远不会有多个跟踪主机实例特定的 MessageBox 数据库的数据移动。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-130">A tracking host instance moves tracking data for specific MessageBox databases, but there will never be more than one tracking host instance moving data for a specific MessageBox database.</span></span> <span data-ttu-id="9a5c8-131">例如，如果你有三个 MessageBox 数据库，并只有两个跟踪主机实例，然后其中一个主机实例需要 MessageBox 数据库中的两个移动数据。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-131">For example, if you have three MessageBox databases, and only two tracking host instances, then one of the host instances needs to move data for two of the MessageBox databases.</span></span> <span data-ttu-id="9a5c8-132">添加第三个跟踪主机实例将分发跟踪主机到另一台计算机运行的工作[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-132">Adding a third tracking host instance distributes the tracking host work to another computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="9a5c8-133">在此方案中，程序将添加第四个跟踪主机实例将不会将任何详细的跟踪主机的分发工作，但将提供一个额外跟踪容错能力的主机实例。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-133">In this scenario, adding a fourth tracking host instance would not distribute any more tracking host work, but would provide an extra tracking host instance for fault tolerance.</span></span>  
  
 <span data-ttu-id="9a5c8-134">有关 BAM 事件总线服务的详细信息，请参阅 BizTalk Server 帮助中的以下主题：</span><span class="sxs-lookup"><span data-stu-id="9a5c8-134">For more information about the BAM Event Bus service, see the following topics in BizTalk Server Help:</span></span>  
  
-   <span data-ttu-id="9a5c8-135">[管理 BAM 事件总线服务](http://go.microsoft.com/fwlink/?LinkId=154194)(http://go.microsoft.com/fwlink/?LinkId=154194)</span><span class="sxs-lookup"><span data-stu-id="9a5c8-135">[Managing the BAM Event Bus Service](http://go.microsoft.com/fwlink/?LinkId=154194) (http://go.microsoft.com/fwlink/?LinkId=154194)</span></span>  
  
-   <span data-ttu-id="9a5c8-136">[创建 BAM 事件总线服务的实例](http://go.microsoft.com/fwlink/?LinkId=154195)(http://go.microsoft.com/fwlink/?LinkId=154195)</span><span class="sxs-lookup"><span data-stu-id="9a5c8-136">[Creating Instances of the BAM Event Bus Service](http://go.microsoft.com/fwlink/?LinkId=154195) (http://go.microsoft.com/fwlink/?LinkId=154195)</span></span>  
  
## <a name="configuring-a-dedicated-tracking-host"></a><span data-ttu-id="9a5c8-137">配置专用的跟踪主机</span><span class="sxs-lookup"><span data-stu-id="9a5c8-137">Configuring a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="9a5c8-138">若要在本部分中执行该过程，必须具有的以下用户权限修改主机属性，它使跟踪的主机：</span><span class="sxs-lookup"><span data-stu-id="9a5c8-138">To perform the procedure in this section, you must have the following user rights for modifying host properties to allow host tracking:</span></span>  
  
-   <span data-ttu-id="9a5c8-139">您必须是属于[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理员组。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-139">You must be a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span>  
  
-   <span data-ttu-id="9a5c8-140">必须在 SQL Server 中具有以下权限：</span><span class="sxs-lookup"><span data-stu-id="9a5c8-140">You must have the following rights in SQL Server:</span></span>  
  
    -   <span data-ttu-id="9a5c8-141">你必须是 SQL Server 管理员或的成员*db_owner*或*db_securityadmin* BizTalk 跟踪数据库中 (BizTalk DTADb) MessageBox 数据库 （SQL Server 数据库角色BizTalkMsgBoxDb)，和 BAM 主导入数据库 (BAMPrimaryImport)。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-141">You must be either a SQL Server administrator or a member of the *db_owner* or *db_securityadmin* SQL Server database roles in the BizTalk Tracking database (BizTalk DTADb), MessageBox databases (BizTalkMsgBoxDb), and the BAM Primary Import database (BAMPrimaryImport).</span></span>  
  
    -   <span data-ttu-id="9a5c8-142">必须是在所有计算机上的 sysadmin SQL Server 角色的成员，其中有 MessageBox 数据库，或成员*db_owner*或*db_ddladmin* MessageBox 的所有数据库的 SQL Server 角色。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-142">You must be a member of the sysadmin SQL Server role on all the computers where there are MessageBox databases, or a member of the *db_owner* or *db_ddladmin* SQL Server role for all the MessageBox databases.</span></span>  
  
#### <a name="to-enable-host-tracking"></a><span data-ttu-id="9a5c8-143">若要启用跟踪的主机</span><span class="sxs-lookup"><span data-stu-id="9a5c8-143">To enable host tracking</span></span>  
  
1.  <span data-ttu-id="9a5c8-144">单击**启动**，单击**程序**，单击**Microsoft** [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]，然后单击**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-144">Click **Start**, click **Programs**, click **Microsoft** [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2.  <span data-ttu-id="9a5c8-145">在控制台树中，展开[!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]**管理**，展开 BizTalk 组，单击**平台设置**，然后单击**主机**。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-145">In the console tree, expand [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)] **Administration**, expand the BizTalk group, click **Platform Settings**, and then click **Hosts**.</span></span>  
  
3.  <span data-ttu-id="9a5c8-146">在详细信息窗格中，右键单击你想要修改，，然后单击主机**属性**。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-146">In the details pane, right-click the host that you want to modify, and then click **Properties**.</span></span>  
  
4.  <span data-ttu-id="9a5c8-147">在**主机属性**对话框中，在**常规**选项卡上，选中或清除**选项-允许主机跟踪**，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-147">In the **Host Properties** dialog box, on the **General** tab, select or clear **Options - Allow Host Tracking**, and then click **OK**.</span></span>  
  
     <span data-ttu-id="9a5c8-148">选中此复选框可指示主机加载 BizTalk 跟踪组件以处理运行状况监视数据和业务数据。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-148">Select this check box to indicate that the host loads the BizTalk Tracking component to process health monitoring and business data.</span></span> <span data-ttu-id="9a5c8-149">如果选中此复选框，当前主机需要跟踪数据库中的表的 MessageBox，以及到跟踪数据库的读/写访问。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-149">If you select this check box, the current host will have read/write access to the tracking tables in the MessageBox database, as well as to the Tracking database.</span></span> <span data-ttu-id="9a5c8-150">因此，运行在此主机中的任何对象也具有对这些数据库的读/写权限。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-150">Accordingly, any objects running in this host will also have read/write access to these databases.</span></span>  
  
     <span data-ttu-id="9a5c8-151">如果清除此复选框，该主机将仅对 MessageBox 数据库中的跟踪表具有写权限并且无权访问跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="9a5c8-151">If you clear the check box, the host will have only write access to the tracking tables in the MessageBox database and will not have access to the Tracking database.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9a5c8-152">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9a5c8-152">See Also</span></span>  
 [<span data-ttu-id="9a5c8-153">清单：配置 BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="9a5c8-153">Checklist: Configuring BizTalk Server</span></span>](../technical-guides/checklist-configuring-biztalk-server.md)