---
title: 配置专用的跟踪主机 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f997bcc2-08fd-4e9a-ba44-542ec8460d6d
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6feb950bccf51f61026a332b3b0fff4f3cceb458
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65277170"
---
# <a name="configuring-a-dedicated-tracking-host"></a><span data-ttu-id="8fb83-102">配置专用的跟踪主机</span><span class="sxs-lookup"><span data-stu-id="8fb83-102">Configuring a Dedicated Tracking Host</span></span>
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="8fb83-103">优化吞吐量，因此，主业务流程和消息传递引擎不实际移动的事件或消息直接向 BizTalk 跟踪 (DTA) 或业务活动监视 (BAM) 数据库，因为这会将转移这些引擎从其主执行业务流程的作业。</span><span class="sxs-lookup"><span data-stu-id="8fb83-103">is optimized for throughput, so the main orchestration and messaging engines do not actually move events or messages directly to the BizTalk Tracking (DTA) or Business Activity Monitoring (BAM) databases, since this would divert these engines from their primary job of executing business processes.</span></span> <span data-ttu-id="8fb83-104">相反，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]在 MessageBox 数据库中留出的事件和消息并将其标记为需要迁移到 BizTalk 跟踪或 BAM 数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-104">Instead, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] leaves the events and messages in the MessageBox database and marks them as requiring a move to the BizTalk Tracking or BAM databases.</span></span> <span data-ttu-id="8fb83-105">后台进程 （跟踪主机），然后移动到的 BizTalk 跟踪数据库和 BAM 数据库，到 BizTalk 跟踪数据库的 SQL Server 代理作业将跟踪消息时的事件。</span><span class="sxs-lookup"><span data-stu-id="8fb83-105">A background process (the tracking host) then moves the events to the BizTalk Tracking and BAM databases, while a SQL Server Agent job copies tracked messages to the BizTalk Tracking database.</span></span>  
  
## <a name="advantages-of-using-a-dedicated-tracking-host"></a><span data-ttu-id="8fb83-106">使用专用的跟踪主机的优点</span><span class="sxs-lookup"><span data-stu-id="8fb83-106">Advantages of Using a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="8fb83-107">托管跟踪的 BizTalk 主机负责移动 DTA 和 BAM 跟踪从 MessageBox 数据库的数据，对 BizTalk 跟踪 (DTA) 和 BAM 主导入数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-107">A BizTalk Host that hosts tracking is responsible for moving the DTA and BAM tracking data from the MessageBox database to the BizTalk Tracking (DTA) and BAM Primary Import databases.</span></span> <span data-ttu-id="8fb83-108">跟踪数据的此移动在托管跟踪的同一主机中运行的其他 BizTalk 项目的性能产生影响。</span><span class="sxs-lookup"><span data-stu-id="8fb83-108">This movement of tracking data has an impact on the performance of other BizTalk artifacts that are running in the same host that is hosting tracking.</span></span> <span data-ttu-id="8fb83-109">因此，应使用不执行任何操作，但主机跟踪的专用的主机。</span><span class="sxs-lookup"><span data-stu-id="8fb83-109">Thus, you should use a dedicated host that does nothing but host tracking.</span></span>  
  
 <span data-ttu-id="8fb83-110">使用专用的跟踪主机还允许您停止其他 BizTalk 主机而不会干扰[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]跟踪。</span><span class="sxs-lookup"><span data-stu-id="8fb83-110">Using a dedicated tracking host also allows you to stop other BizTalk hosts without interfering with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking.</span></span> <span data-ttu-id="8fb83-111">跟踪数据从 MessageBox 数据库的移动是正常的关键[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系统。</span><span class="sxs-lookup"><span data-stu-id="8fb83-111">The movement of tracking data out of the MessageBox database is critical for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="8fb83-112">如果停止 BizTalk 主机负责将跟踪数据移 BizTalk 组中，将不运行的跟踪数据解码服务。</span><span class="sxs-lookup"><span data-stu-id="8fb83-112">If the BizTalk Host responsible for moving tracking data in the BizTalk group is stopped, the Tracking Data Decode service will not run.</span></span> <span data-ttu-id="8fb83-113">这种影响是，如下所示：</span><span class="sxs-lookup"><span data-stu-id="8fb83-113">The impact of this is as follows:</span></span>  
  
- <span data-ttu-id="8fb83-114">HAT 跟踪数据不会从 MessageBox 数据库移至 BizTalk 跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-114">HAT tracking data will not be moved from the MessageBox database to the BizTalk Tracking database.</span></span>  
  
- <span data-ttu-id="8fb83-115">BAM 跟踪数据不会从 MessageBox 数据库移至 BAM 主导入数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-115">BAM tracking data will not be moved from the MessageBox database to the BAM Primary Import database.</span></span>  
  
- <span data-ttu-id="8fb83-116">不移动数据，因为它不能从 MessageBox 数据库中删除。</span><span class="sxs-lookup"><span data-stu-id="8fb83-116">Because data is not moved, it cannot be deleted from the MessageBox database.</span></span>  
  
- <span data-ttu-id="8fb83-117">跟踪数据解码服务停止时，跟踪侦听器仍将运行并将跟踪数据写入到 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-117">When the Tracking Data Decode service is stopped, tracking interceptors will still run and write tracking data to the MessageBox database.</span></span> <span data-ttu-id="8fb83-118">如果不移动数据时，这会 MessageBox 数据库变得臃肿，这将影响一段时间内的性能。</span><span class="sxs-lookup"><span data-stu-id="8fb83-118">If the data is not moved, this will cause the MessageBox database to become bloated, which will affect performance over time.</span></span> <span data-ttu-id="8fb83-119">即使不会跟踪自定义属性或 BAM 配置文件未设置，默认情况下的某些数据被跟踪 （如管道接收 / 发送事件和业务流程事件）。</span><span class="sxs-lookup"><span data-stu-id="8fb83-119">Even if custom properties are not tracked or BAM profiles are not set up, by default some data is tracked (such as pipeline receive / send events and orchestration events).</span></span> <span data-ttu-id="8fb83-120">如果您不想要运行的跟踪数据解码服务，请关闭所有跟踪，以便没有侦听器将数据保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-120">If you do not want to run the Tracking Data Decode service, turn off all tracking so that no interceptors save data to the database.</span></span> <span data-ttu-id="8fb83-121">若要禁用全局跟踪，请参阅[如何禁用全局跟踪](http://go.microsoft.com/fwlink/?LinkId=154193)(<http://go.microsoft.com/fwlink/?LinkId=154193>) 使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台来有选择性地禁用跟踪事件。</span><span class="sxs-lookup"><span data-stu-id="8fb83-121">To disable global tracking, see [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkId=154193) (<http://go.microsoft.com/fwlink/?LinkId=154193>) Use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console to selectively disable tracking events.</span></span>  
  
## <a name="optimizing-performance-for-a-dedicated-tracking-host"></a><span data-ttu-id="8fb83-122">优化专用的跟踪主机的性能</span><span class="sxs-lookup"><span data-stu-id="8fb83-122">Optimizing Performance for a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="8fb83-123">应在至少两台运行的计算机上运行此主机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]（用例中的冗余一个失败）。</span><span class="sxs-lookup"><span data-stu-id="8fb83-123">This host should be run on at least two computers running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] (for redundancy in case one fails).</span></span> <span data-ttu-id="8fb83-124">为了获得最佳性能，应具有至少一个跟踪主机实例，每个 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-124">For optimal performance, you should have at least one tracking host instance per MessageBox database.</span></span> <span data-ttu-id="8fb83-125">跟踪主机实例的实际数应为 N + 1，其中 N = MessageBox 数据库的数量。</span><span class="sxs-lookup"><span data-stu-id="8fb83-125">The actual number of tracking host instances should be N + 1, where N = the number of MessageBox databases.</span></span> <span data-ttu-id="8fb83-126">"+ 1"是以实现冗余。</span><span class="sxs-lookup"><span data-stu-id="8fb83-126">The "+ 1" is for redundancy.</span></span> <span data-ttu-id="8fb83-127">没有添加更多，因为只有一个跟踪主机实例并无好处可以将特定的 MessageBox 数据库的数据移动。</span><span class="sxs-lookup"><span data-stu-id="8fb83-127">There is no benefit to adding more than that, because only one tracking host instance can move data for a specific MessageBox database.</span></span> <span data-ttu-id="8fb83-128">因此，锁定不应是一个问题。</span><span class="sxs-lookup"><span data-stu-id="8fb83-128">As a result, locking should never be an issue.</span></span> <span data-ttu-id="8fb83-129">其他的一个跟踪主机实例将添加容错功能;如果其中一个跟踪主机实例失败，其他实例将假定在执行任务的失败实例。</span><span class="sxs-lookup"><span data-stu-id="8fb83-129">The one additional tracking host instance is added for fault tolerance; if one of the tracking host instances fails, the additional instance will assume the duties of the failed instance.</span></span>  
  
 <span data-ttu-id="8fb83-130">一个跟踪主机实例将跟踪数据的特定 MessageBox 数据库，但永远不会有多个跟踪主机实例特定的 MessageBox 数据库移动数据。</span><span class="sxs-lookup"><span data-stu-id="8fb83-130">A tracking host instance moves tracking data for specific MessageBox databases, but there will never be more than one tracking host instance moving data for a specific MessageBox database.</span></span> <span data-ttu-id="8fb83-131">例如，如果您有三个 MessageBox 数据库，并且只有两个跟踪主机实例，然后其中一个主机实例需要将数据移动 MessageBox 数据库中的两个。</span><span class="sxs-lookup"><span data-stu-id="8fb83-131">For example, if you have three MessageBox databases, and only two tracking host instances, then one of the host instances needs to move data for two of the MessageBox databases.</span></span> <span data-ttu-id="8fb83-132">添加第三个跟踪主机实例分配跟踪主机到另一台计算机运行的工作[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="8fb83-132">Adding a third tracking host instance distributes the tracking host work to another computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="8fb83-133">在此方案中，添加第四个跟踪主机实例将不分发任何详细的跟踪主机，但会提供一个额外跟踪主机实例的容错能力。</span><span class="sxs-lookup"><span data-stu-id="8fb83-133">In this scenario, adding a fourth tracking host instance would not distribute any more tracking host work, but would provide an extra tracking host instance for fault tolerance.</span></span>  
  
 <span data-ttu-id="8fb83-134">有关 BAM 事件总线服务的详细信息，请参阅 BizTalk Server 帮助中的以下主题：</span><span class="sxs-lookup"><span data-stu-id="8fb83-134">For more information about the BAM Event Bus service, see the following topics in BizTalk Server Help:</span></span>  
  
-   <span data-ttu-id="8fb83-135">[管理 BAM 事件总线服务](http://go.microsoft.com/fwlink/?LinkId=154194)(http://go.microsoft.com/fwlink/?LinkId=154194)</span><span class="sxs-lookup"><span data-stu-id="8fb83-135">[Managing the BAM Event Bus Service](http://go.microsoft.com/fwlink/?LinkId=154194) (http://go.microsoft.com/fwlink/?LinkId=154194)</span></span>  
  
-   <span data-ttu-id="8fb83-136">[创建的 BAM 事件总线服务实例](http://go.microsoft.com/fwlink/?LinkId=154195)(http://go.microsoft.com/fwlink/?LinkId=154195)</span><span class="sxs-lookup"><span data-stu-id="8fb83-136">[Creating Instances of the BAM Event Bus Service](http://go.microsoft.com/fwlink/?LinkId=154195) (http://go.microsoft.com/fwlink/?LinkId=154195)</span></span>  
  
## <a name="configuring-a-dedicated-tracking-host"></a><span data-ttu-id="8fb83-137">配置专用的跟踪主机</span><span class="sxs-lookup"><span data-stu-id="8fb83-137">Configuring a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="8fb83-138">若要在本部分中执行该过程，必须具有以下用户权限来修改主机属性以允许主机跟踪：</span><span class="sxs-lookup"><span data-stu-id="8fb83-138">To perform the procedure in this section, you must have the following user rights for modifying host properties to allow host tracking:</span></span>  
  
- <span data-ttu-id="8fb83-139">您必须是属于[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Administrators 组。</span><span class="sxs-lookup"><span data-stu-id="8fb83-139">You must be a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span>  
  
- <span data-ttu-id="8fb83-140">SQL Server 中，必须具有以下权限：</span><span class="sxs-lookup"><span data-stu-id="8fb83-140">You must have the following rights in SQL Server:</span></span>  
  
  -   <span data-ttu-id="8fb83-141">您必须是 SQL Server 管理员或的成员*db_owner*或*db_securityadmin*中 BizTalk 跟踪数据库 (BizTalk DTADb) MessageBox 数据库 （SQL Server 数据库角色BizTalkMsgBoxDb) 和 BAM 主导入数据库 (BAMPrimaryImport)。</span><span class="sxs-lookup"><span data-stu-id="8fb83-141">You must be either a SQL Server administrator or a member of the *db_owner* or *db_securityadmin* SQL Server database roles in the BizTalk Tracking database (BizTalk DTADb), MessageBox databases (BizTalkMsgBoxDb), and the BAM Primary Import database (BAMPrimaryImport).</span></span>  
  
  -   <span data-ttu-id="8fb83-142">必须是所有计算机上的 sysadmin SQL Server 角色的成员，其中有 MessageBox 数据库或隶属*db_owner*或*db_ddladmin*所有 MessageBox 数据库的 SQL Server 角色。</span><span class="sxs-lookup"><span data-stu-id="8fb83-142">You must be a member of the sysadmin SQL Server role on all the computers where there are MessageBox databases, or a member of the *db_owner* or *db_ddladmin* SQL Server role for all the MessageBox databases.</span></span>  
  
#### <a name="to-enable-host-tracking"></a><span data-ttu-id="8fb83-143">若要启用主机跟踪</span><span class="sxs-lookup"><span data-stu-id="8fb83-143">To enable host tracking</span></span>  
  
1. <span data-ttu-id="8fb83-144">单击**启动**，单击**程序**，单击**Microsoft** [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]，然后单击**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="8fb83-144">Click **Start**, click **Programs**, click **Microsoft** [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2. <span data-ttu-id="8fb83-145">在控制台树中，展开[!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]**管理**，展开 BizTalk 组，单击**平台设置**，然后单击**主机**。</span><span class="sxs-lookup"><span data-stu-id="8fb83-145">In the console tree, expand [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)] **Administration**, expand the BizTalk group, click **Platform Settings**, and then click **Hosts**.</span></span>  
  
3. <span data-ttu-id="8fb83-146">在详细信息窗格中，右键单击你想要修改，然后单击主机**属性**。</span><span class="sxs-lookup"><span data-stu-id="8fb83-146">In the details pane, right-click the host that you want to modify, and then click **Properties**.</span></span>  
  
4. <span data-ttu-id="8fb83-147">在中**主机属性**对话框中，在**常规**选项卡上，选中或清除**选项-允许主机跟踪**，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="8fb83-147">In the **Host Properties** dialog box, on the **General** tab, select or clear **Options - Allow Host Tracking**, and then click **OK**.</span></span>  
  
    <span data-ttu-id="8fb83-148">选中此复选框以指示主机加载 BizTalk 跟踪组件，以处理运行状况监视和业务数据。</span><span class="sxs-lookup"><span data-stu-id="8fb83-148">Select this check box to indicate that the host loads the BizTalk Tracking component to process health monitoring and business data.</span></span> <span data-ttu-id="8fb83-149">如果选中此复选框，当前主机将具有读/写访问 MessageBox 数据库中的跟踪表以及跟踪数据库。</span><span class="sxs-lookup"><span data-stu-id="8fb83-149">If you select this check box, the current host will have read/write access to the tracking tables in the MessageBox database, as well as to the Tracking database.</span></span> <span data-ttu-id="8fb83-150">因此，在此主机中运行的所有对象也都具有对这些数据库的读/写访问权限。</span><span class="sxs-lookup"><span data-stu-id="8fb83-150">Accordingly, any objects running in this host will also have read/write access to these databases.</span></span>  
  
    <span data-ttu-id="8fb83-151">如果清除该复选框，主机将 MessageBox 数据库中具有只写访问权限的跟踪表，并且不会对跟踪数据库的访问。</span><span class="sxs-lookup"><span data-stu-id="8fb83-151">If you clear the check box, the host will have only write access to the tracking tables in the MessageBox database and will not have access to the Tracking database.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8fb83-152">请参阅</span><span class="sxs-lookup"><span data-stu-id="8fb83-152">See Also</span></span>  
 [<span data-ttu-id="8fb83-153">清单：配置 BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="8fb83-153">Checklist: Configuring BizTalk Server</span></span>](../technical-guides/checklist-configuring-biztalk-server.md)