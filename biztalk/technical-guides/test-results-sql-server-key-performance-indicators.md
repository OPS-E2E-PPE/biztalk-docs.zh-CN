---
title: 测试结果： SQL Server 关键绩效指标 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2459ee6d-7a75-4338-ba5c-f42ab673ab87
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 93e1f1bdef55ad726c308902062dccff67eeb170
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22302461"
---
# <a name="test-results-sql-server-key-performance-indicators"></a><span data-ttu-id="58da7-102">测试结果： SQL Server 关键绩效指标</span><span class="sxs-lookup"><span data-stu-id="58da7-102">Test Results: SQL Server Key Performance Indicators</span></span>
<span data-ttu-id="58da7-103">本主题总结了 SQL Server 关键绩效指标 (KPI) 测试方案期间观察到。</span><span class="sxs-lookup"><span data-stu-id="58da7-103">This topic summarizes SQL Server Key Performance Indicators (KPI) observed during the test scenarios.</span></span> <span data-ttu-id="58da7-104">这些测试评估以下 SQL Server KPI:</span><span class="sxs-lookup"><span data-stu-id="58da7-104">These tests evaluated the following SQL Server KPI:</span></span>  
  
-   <span data-ttu-id="58da7-105">SQL 处理器使用率测量**\SQL\Processor(_Total)\\%Processor Time**性能监视器计数器。</span><span class="sxs-lookup"><span data-stu-id="58da7-105">SQL Processor Utilization as measured by the **\SQL\Processor(_Total)\\% Processor Time** performance monitor counter.</span></span>  
  
-   <span data-ttu-id="58da7-106">每秒为单位，由接收的 TRANSACT-SQL 命令批数**\SQL Server:SQL Statistics\Batch 每秒请求数**性能监视器计数器。</span><span class="sxs-lookup"><span data-stu-id="58da7-106">The number of Transact-SQL command batches received per second as measured by the **\SQL Server:SQL Statistics\Batch Requests/sec** performance monitor counter.</span></span>  
  
## <a name="summary-of-sql-server-key-performance-indicators"></a><span data-ttu-id="58da7-107">SQL Server 关键绩效指标的摘要</span><span class="sxs-lookup"><span data-stu-id="58da7-107">Summary of SQL Server Key Performance Indicators</span></span>  
 <span data-ttu-id="58da7-108">每个方案的物理机被限制，以便已等效的逻辑处理器和虚拟处理器数。</span><span class="sxs-lookup"><span data-stu-id="58da7-108">For each scenario the physical machines were restricted so that number of logical processors and virtual processors was equivalent.</span></span> <span data-ttu-id="58da7-109">执行此操作使用 /maxmem 和 /numproc boot.ini 开关。</span><span class="sxs-lookup"><span data-stu-id="58da7-109">This was done using the /maxmem and /numproc boot.ini switches.</span></span> <span data-ttu-id="58da7-110">有关使用这些开关的详细信息，请参阅"启动 INI 选项参考"在[http://go.microsoft.com/fwlink/?LinkId=122139](http://go.microsoft.com/fwlink/?LinkId=122139)。</span><span class="sxs-lookup"><span data-stu-id="58da7-110">For more information about using these switches, see “Boot INI Options Reference” at [http://go.microsoft.com/fwlink/?LinkId=122139](http://go.microsoft.com/fwlink/?LinkId=122139).</span></span>  
  
 <span data-ttu-id="58da7-111">**SQL Server 关键绩效指标 – 比较**[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]处理器使用率测量**\SQL\Processor(_Total)\\%Processor Time**计数器已大约上所有相同测试环境中，为高 90.1%介于 88%低。  </span><span class="sxs-lookup"><span data-stu-id="58da7-111">**Comparison of SQL Server Key Performance Indicators –**  [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] processor utilization as measured by **\SQL\Processor(_Total)\\% Processor Time** counter was approximately the same on all test environments, ranging from a low of 88% to a high of 90.1%.</span></span> <span data-ttu-id="58da7-112">但是还有之间存在显著差异**\SQL Server:SQL Statistics\Batch 每秒请求数**测量合并环境 (4520) 和**\SQL Server:SQL Statistics\Batch 每秒请求数**测量物理环境 (6350)。</span><span class="sxs-lookup"><span data-stu-id="58da7-112">There is however a significant difference between the **\SQL Server:SQL Statistics\Batch Requests/sec** measured on the consolidated environment (4520) and the **\SQL Server:SQL Statistics\Batch Requests/sec** measured on the physical environment (6350).</span></span> <span data-ttu-id="58da7-113">**\SQL Server:SQL Statistics\Batch 每秒请求数**性能监视器计数器提供了多少工作由 SQL Server 正在执行的良好指标。</span><span class="sxs-lookup"><span data-stu-id="58da7-113">The **\SQL Server:SQL Statistics\Batch Requests/sec** performance monitor counter provides a good indicator of how much work is being performed by SQL Server.</span></span> <span data-ttu-id="58da7-114">减少批处理每秒请求数在 HYPER-V 环境中运行 SQL Server 时可以被归因于 hyper-v 所需的 CPU 开销。</span><span class="sxs-lookup"><span data-stu-id="58da7-114">The reduction in Batch Requests/sec when SQL Server is running in a Hyper-V environment can be attributed to the CPU overhead required by Hyper-V.</span></span>  
  
 <span data-ttu-id="58da7-115">没有，但是，存在重大差异**\SQL Server:SQL Statistics\Batch 每秒请求数**测量合并环境 (4520) 和**\SQL Server:SQL Statistics\Batch 每秒请求数**测量物理环境 (6350)。</span><span class="sxs-lookup"><span data-stu-id="58da7-115">There is, however, a significant difference between the **\SQL Server:SQL Statistics\Batch Requests/sec** measured on the consolidated environment (4520) and the **\SQL Server:SQL Statistics\Batch Requests/sec** measured on the physical environment (6350).</span></span> <span data-ttu-id="58da7-116">**\SQL Server:SQL Statistics\Batch 每秒请求数**性能监视器计数器提供了多少工作由 SQL Server 正在执行的良好指标。</span><span class="sxs-lookup"><span data-stu-id="58da7-116">The **\SQL Server:SQL Statistics\Batch Requests/sec** performance monitor counter provides a good indicator of how much work is being performed by SQL Server.</span></span> <span data-ttu-id="58da7-117">减少批处理每秒请求数在 HYPER-V 环境中运行 SQL Server 时可以被归因于 hyper-v 所需的 CPU 开销。</span><span class="sxs-lookup"><span data-stu-id="58da7-117">The reduction in Batch Requests/sec when SQL Server is running in a Hyper-V environment can be attributed to the CPU overhead required by Hyper-V.</span></span>  
  
 <span data-ttu-id="58da7-118">请按照下列步骤以提高性能测量的 HYPER-V 虚拟机上运行的 SQL Server **\SQL Server:SQL Statistics\Batch 每秒请求数**性能监视器计数器：</span><span class="sxs-lookup"><span data-stu-id="58da7-118">Follow these steps to increase performance of SQL Server running on a Hyper-V virtual machine as measured by the **\SQL Server:SQL Statistics\Batch Requests/sec** performance monitor counter:</span></span>  
  
1.  <span data-ttu-id="58da7-119">**分配其他固定的 VHD 磁盘与专用虚拟控制器和通道 –** 分配其他固定 VHD 磁盘使用的专用虚拟控制器，通道将增加而不是使用单个 VHD 磁盘的磁盘吞吐量。</span><span class="sxs-lookup"><span data-stu-id="58da7-119">**Allocate additional fixed VHD disks with dedicated virtual controllers and channels –** Allocation of additional fixed VHD disks using dedicated virtual controllers and channels will increase disk throughput versus using a single VHD disk.</span></span>  
  
2.  <span data-ttu-id="58da7-120">**优化网络性能 –** 按照的"优化网络性能"部分中所述步骤[清单： HYPER-V 上优化性能](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="58da7-120">**Optimize Network Performance –** Follow steps outlined in the “Optimize Network Performance” section of [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span> <span data-ttu-id="58da7-121">在同一台 HYPER-V 主机上运行多个 HYPER-V 虚拟机时是非常重要，遵循"在相同的 HYPER-V 运行的配置 HYPER-V 虚拟机宿主计算机以使用专用虚拟网络"部分中的建议[网络优化](../technical-guides/network-optimizations.md)。</span><span class="sxs-lookup"><span data-stu-id="58da7-121">When running multiple Hyper-V virtual machines on the same Hyper-V host it is of particular importance to follow recommendations in the “Configure Hyper-V Virtual Machines that are Running on the same Hyper-V host computer to use a Private Virtual Network” section of [Network Optimizations](../technical-guides/network-optimizations.md).</span></span>  
  
 <span data-ttu-id="58da7-122">无状态性质，因此[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]、 其他[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]虚拟机可轻松添加到环境需要提供向外的扩展，并提高系统的整体性能。</span><span class="sxs-lookup"><span data-stu-id="58da7-122">Because of the stateless nature of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], additional [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] virtual machines can be easily added to the environment as required to provide scale out and increase the overall performance of the system.</span></span>  
  
 <span data-ttu-id="58da7-123">下图阐释了在不同的测试平台上的 SQL Server 的性能：</span><span class="sxs-lookup"><span data-stu-id="58da7-123">The graphic below illustrates the performance of SQL Server on the various test platforms:</span></span>  
  
 <span data-ttu-id="58da7-124">![SQL 关键绩效指标](../technical-guides/media/sqlkpi.gif "SQLKPI")</span><span class="sxs-lookup"><span data-stu-id="58da7-124">![SQL Key Performance Indicators](../technical-guides/media/sqlkpi.gif "SQLKPI")</span></span>  
<span data-ttu-id="58da7-125">SQL 关键绩效指标</span><span class="sxs-lookup"><span data-stu-id="58da7-125">SQL Key Performance Indicators</span></span>  
  
 <span data-ttu-id="58da7-126">下表说明了每个配置的收集 KPI 的相对性能。</span><span class="sxs-lookup"><span data-stu-id="58da7-126">The table below illustrates the relative performance of the collected KPI’s for each configuration.</span></span> <span data-ttu-id="58da7-127">每个结果集计算的基线配置 KPI 百分比</span><span class="sxs-lookup"><span data-stu-id="58da7-127">Each result set is calculated as a percentage of the Baseline configuration KPI</span></span>  
  
|<span data-ttu-id="58da7-128">KPI</span><span class="sxs-lookup"><span data-stu-id="58da7-128">KPI</span></span>|<span data-ttu-id="58da7-129">虚拟 BizTalk/物理 SQL</span><span class="sxs-lookup"><span data-stu-id="58da7-129">Virtual BizTalk/Physical SQL</span></span>|<span data-ttu-id="58da7-130">在单独的主机的虚拟 BizTalk/虚拟 SQL</span><span class="sxs-lookup"><span data-stu-id="58da7-130">Virtual BizTalk/Virtual SQL on separate Hosts</span></span>|<span data-ttu-id="58da7-131">合并环境上的虚拟 BizTalk/虚拟 SQL</span><span class="sxs-lookup"><span data-stu-id="58da7-131">Virtual BizTalk/Virtual SQL on Consolidated environment</span></span>|  
|---------|-----------------------------------|----------------------------------------------------|--------------------------------------------------------------|  
|<span data-ttu-id="58da7-132">\SQL\Processor(_Total)\\处理器时间百分比</span><span class="sxs-lookup"><span data-stu-id="58da7-132">\SQL\Processor(_Total)\\% Processor Time</span></span>|<span data-ttu-id="58da7-133">97.7%</span><span class="sxs-lookup"><span data-stu-id="58da7-133">97.7%</span></span>|<span data-ttu-id="58da7-134">98.4%</span><span class="sxs-lookup"><span data-stu-id="58da7-134">98.4%</span></span>|<span data-ttu-id="58da7-135">99.9%</span><span class="sxs-lookup"><span data-stu-id="58da7-135">99.9%</span></span>|  
|<span data-ttu-id="58da7-136">\SQL server: SQL Statistics\Batch 每秒请求数</span><span class="sxs-lookup"><span data-stu-id="58da7-136">\SQL Server:SQL Statistics\Batch Requests/sec</span></span>|<span data-ttu-id="58da7-137">97.1%</span><span class="sxs-lookup"><span data-stu-id="58da7-137">97.1%</span></span>|<span data-ttu-id="58da7-138">83.3%</span><span class="sxs-lookup"><span data-stu-id="58da7-138">83.3%</span></span>|<span data-ttu-id="58da7-139">71.2%</span><span class="sxs-lookup"><span data-stu-id="58da7-139">71.2%</span></span>|  
  
 <span data-ttu-id="58da7-140">有关如何评估磁盘 I/O 性能的详细信息，请参阅**测量磁盘输入/输出性能**主题的部分[清单： HYPER-V 上的测量性能](../technical-guides/checklist-measuring-performance-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="58da7-140">For more information about how to evaluate Disk I/O performance, see the **Measuring Disk I/O Performance** section of the topic [Checklist: Measuring Performance on Hyper-V](../technical-guides/checklist-measuring-performance-on-hyper-v.md).</span></span>  
  
 <span data-ttu-id="58da7-141">有关在 HYPER-V 环境中运行 SQL Server 2008 时的最佳做法的详细信息，请参阅白皮书"运行 SQL Server 2008 in a HYPER-V 环境 – 最佳做法和性能建议"下载[http: / / go.microsoft.com/fwlink/？LinkId = 144622](http://go.microsoft.com/fwlink/?LinkId=144622)。</span><span class="sxs-lookup"><span data-stu-id="58da7-141">For more information about Best Practices when running SQL Server 2008 in a Hyper-V environment, see the whitepaper “Running SQL Server 2008 in a Hyper-V Environment – Best Practices and Performance Recommendations” available for download at [http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622).</span></span>