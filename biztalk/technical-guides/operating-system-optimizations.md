---
title: 操作系统优化 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: af2e77d0-d69b-4ae4-b689-96831fc4deed
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 93222268e3d59bccfe8222e0e0e9b276e21f3dfd
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65242641"
---
# <a name="operating-system-optimizations"></a><span data-ttu-id="54f23-102">操作系统优化</span><span class="sxs-lookup"><span data-stu-id="54f23-102">Operating System Optimizations</span></span>
<span data-ttu-id="54f23-103">本主题提供有关优化性能的建议[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]在生产中使用计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]环境。</span><span class="sxs-lookup"><span data-stu-id="54f23-103">This topic provides recommendations for optimizing performance of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers used in a production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="54f23-104">这些优化应用后[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]已安装并配置。</span><span class="sxs-lookup"><span data-stu-id="54f23-104">These optimizations are applied after [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has been installed and configured.</span></span>  
  
## <a name="general-guidelines-for-improving-operating-system-performance"></a><span data-ttu-id="54f23-105">优化操作系统性能的常规指南</span><span class="sxs-lookup"><span data-stu-id="54f23-105">General guidelines for improving operating system performance</span></span>  
 <span data-ttu-id="54f23-106">以下建议可用于提高操作系统性能：</span><span class="sxs-lookup"><span data-stu-id="54f23-106">The following recommendations can be used to increase operating system performance:</span></span>  
  
### <a name="install-the-latest-bios-storage-area-network-san-drivers-network-adapter-firmware-and-network-adapter-drivers"></a><span data-ttu-id="54f23-107">安装最新的 BIOS、 存储区域网络 (SAN) 驱动程序、 网络适配器的固件和网络适配器驱动程序</span><span class="sxs-lookup"><span data-stu-id="54f23-107">Install the latest BIOS, storage area network (SAN) drivers, network adapter firmware and network adapter drivers</span></span>  
 <span data-ttu-id="54f23-108">硬件制造商会定期发布可以提高性能和可用性相关联的硬件的 BIOS、 固件和驱动程序更新。</span><span class="sxs-lookup"><span data-stu-id="54f23-108">Hardware manufacturers regularly release BIOS, firmware, and driver updates that can improve performance and availability for the associated hardware.</span></span> <span data-ttu-id="54f23-109">请访问硬件制造商的网站来下载并应用 BizTalk Server 环境中的每台计算机上的以下硬件组件的更新：</span><span class="sxs-lookup"><span data-stu-id="54f23-109">Visit the hardware manufacturer’s Web site to download and apply updates for the following hardware components on each computer in the BizTalk Server environment:</span></span>  
  
1.  <span data-ttu-id="54f23-110">BIOS 更新</span><span class="sxs-lookup"><span data-stu-id="54f23-110">BIOS updates</span></span>  
  
2.  <span data-ttu-id="54f23-111">SAN 驱动程序 （如果使用 SAN）</span><span class="sxs-lookup"><span data-stu-id="54f23-111">SAN drivers (if using a SAN)</span></span>  
  
3.  <span data-ttu-id="54f23-112">NIC 固件</span><span class="sxs-lookup"><span data-stu-id="54f23-112">NIC firmware</span></span>  
  
4.  <span data-ttu-id="54f23-113">NIC 驱动程序</span><span class="sxs-lookup"><span data-stu-id="54f23-113">NIC drivers</span></span>  
  
### <a name="assign-the-msdtc-log-file-directory-to-a-separate-dedicated-drive"></a><span data-ttu-id="54f23-114">将 MSDTC 日志文件目录分配到单独的专用驱动器</span><span class="sxs-lookup"><span data-stu-id="54f23-114">Assign the MSDTC log file directory to a separate dedicated drive</span></span>  
 <span data-ttu-id="54f23-115">在 BizTalk Server 环境使用不同的 SQL Server 计算机上的多个 MessageBox 数据库中，产生关联与 Microsoft 分布式事务处理协调器 (MSDTC) 的额外开销。</span><span class="sxs-lookup"><span data-stu-id="54f23-115">In a BizTalk Server environment with multiple MessageBox databases on separate SQL Server computers, additional overhead associated with Microsoft Distributed Transaction Coordinator (MSDTC) is incurred.</span></span> <span data-ttu-id="54f23-116">默认情况下，MSDTC 日志文件位于运行 DTC 服务的计算机的 %systemdrive%\windows\system32\msdtc 目录中。</span><span class="sxs-lookup"><span data-stu-id="54f23-116">By default, the MSDTC log files are located in the %systemdrive%\windows\system32\msdtc directory of the computers running the DTC service.</span></span> <span data-ttu-id="54f23-117">若要降低 DTC 日志记录可能成为性能瓶颈的可能性，请考虑将 MSDTC 日志文件目录移到快速的磁盘驱动器。</span><span class="sxs-lookup"><span data-stu-id="54f23-117">To mitigate the possibility that DTC logging could become a performance bottleneck, consider moving the MSDTC log file directory to a fast disk drive.</span></span> <span data-ttu-id="54f23-118">若要更改 MSDTC 日志文件目录，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="54f23-118">To change the MSDTC log file directory follow these steps:</span></span>  
  
1.  <span data-ttu-id="54f23-119">单击**启动**，单击**运行**，然后键入**dcomcnfg**以启动**组件服务**管理控制台。</span><span class="sxs-lookup"><span data-stu-id="54f23-119">Click **Start**, click **Run**, and type **dcomcnfg** to launch the **Component Services** Management console.</span></span>  
  
2.  <span data-ttu-id="54f23-120">展开**组件服务**，展开**计算机**，右键单击**我的电脑**，然后单击**属性**。</span><span class="sxs-lookup"><span data-stu-id="54f23-120">Expand **Component Services**, expand **Computers**, right-click **My Computer**, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="54f23-121">在中**我的电脑属性**对话框中，单击**MSDTC**选项卡。</span><span class="sxs-lookup"><span data-stu-id="54f23-121">In the **My Computer Properties** dialog box, click the **MSDTC** tab.</span></span>  
  
4.  <span data-ttu-id="54f23-122">在中**位置**编辑框下的**日志信息**，键入要用 （例如 G:\Logs\DTCLog） 创建新日志的路径。</span><span class="sxs-lookup"><span data-stu-id="54f23-122">In the **Location** edit box under **Log Information**, type the path where you want the new log to be created (for example, G:\Logs\DTCLog).</span></span>  
  
5.  <span data-ttu-id="54f23-123">单击**重置日志**，并且系统将提示您为服务重新启动。</span><span class="sxs-lookup"><span data-stu-id="54f23-123">Click **Reset log**, and you will be prompted for service restart.</span></span> <span data-ttu-id="54f23-124">单击**确定**以重新启动 DTC 服务，然后单击**确定**以确认已重新启动 MSDTC 服务。</span><span class="sxs-lookup"><span data-stu-id="54f23-124">Click **OK** to restart the DTC service, and then click **OK** to confirm the MSDTC service has been restarted.</span></span>  
  
### <a name="configure-antivirus-software-to-avoid-real-time-scanning-of-biztalk-server-executables-and-file-drops"></a><span data-ttu-id="54f23-125">若要避免的 BizTalk Server 可执行文件的实时扫描的防病毒软件配置和丢失的文件</span><span class="sxs-lookup"><span data-stu-id="54f23-125">Configure antivirus software to avoid real-time scanning of BizTalk Server executables and file drops</span></span>  
 <span data-ttu-id="54f23-126">防病毒软件实时扫描的 BizTalk Server 可执行文件和任何文件夹或文件共享监视 BizTalk server 接收位置对 BizTalk Server 性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="54f23-126">Antivirus software real-time scanning of BizTalk Server executable files and any folders or file shares monitored by BizTalk Server receive locations can negatively impact BizTalk Server performance.</span></span> <span data-ttu-id="54f23-127">如果在 BizTalk Server 计算机上安装防病毒软件，则禁用实时扫描的非可执行文件的文件类型引用的任何 BizTalk Server 接收位置 （通常。XML，但也可以是.csv、.txt 等。)和配置 BizTalk Server 可执行文件的扫描中排除的防病毒软件</span><span class="sxs-lookup"><span data-stu-id="54f23-127">If antivirus software is installed on the BizTalk Server computer(s), disable real-time scanning of non-executable file types referenced by any BizTalk Server receive locations (usually .XML, but can also be .csv, .txt, etc.) and configure antivirus software to exclude scanning of BizTalk Server executable Files</span></span>  
  
### <a name="disable-intrusion-detection-network-scanning-between-computers-in-the-biztalk-server-environment"></a><span data-ttu-id="54f23-128">禁用扫描在 BizTalk Server 环境中的计算机之间的入侵检测网络</span><span class="sxs-lookup"><span data-stu-id="54f23-128">Disable intrusion detection network scanning between computers in the BizTalk Server environment</span></span>  
 <span data-ttu-id="54f23-129">入侵检测软件可以慢，或者甚至通过网络防止有效的通信。</span><span class="sxs-lookup"><span data-stu-id="54f23-129">Intrusion detection software can slow down or even prevent valid communications over the network.</span></span> <span data-ttu-id="54f23-130">如果安装入侵检测软件，则禁用网络扫描 BizTalk Server 计算机和外部数据存储库 (SQL Server) 计算机之间或消息传送服务 （消息队列、 WebSphere MQSeries 等） 的计算机。</span><span class="sxs-lookup"><span data-stu-id="54f23-130">If intrusion detection software is installed, disable network scanning between BizTalk Server computers and external data repositories (SQL Server) computers or messaging services (Message Queuing, WebSphere MQSeries, etc.) computers.</span></span>  
  
### <a name="defragment-all-disks-in-the-biztalk-server-environment-on-a-regular-basis"></a><span data-ttu-id="54f23-131">对定期在 BizTalk Server 环境中的所有磁盘进行碎片都整理</span><span class="sxs-lookup"><span data-stu-id="54f23-131">Defragment all disks in the BizTalk Server environment on a regular basis</span></span>  
 <span data-ttu-id="54f23-132">在 BizTalk Server 环境中的过多的磁盘碎片会对性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="54f23-132">Excessive disk fragmentation in the BizTalk Server environment will negatively impact performance.</span></span> <span data-ttu-id="54f23-133">请按照下列步骤进行碎片整理 BizTalk Server 环境中的磁盘：</span><span class="sxs-lookup"><span data-stu-id="54f23-133">Follow these steps to defragment disks in the BizTalk Server environment:</span></span>  
  
1.  <span data-ttu-id="54f23-134">对所有磁盘进行碎片都整理 (本地和 SAN/NAS) 定期通过计划非工作时间磁盘碎片整理。</span><span class="sxs-lookup"><span data-stu-id="54f23-134">Defragment all disks (local and SAN/NAS) on a regular basis by scheduling off-hours disk defragmentation.</span></span>  
  
2.  <span data-ttu-id="54f23-135">对 Windows 页面文件进行碎片整理和预分配在 BizTalk Server 环境中每个磁盘的主文件表，以提升总体系统性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-135">Defragment the Windows PageFile and pre-allocate the Master File Tables of each disk in the BizTalk Server environment to boost overall system performance.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="54f23-136">使用 PageDefrag 实用程序可在[ http://go.microsoft.com/fwlink/?LinkId=108976 ](http://go.microsoft.com/fwlink/?LinkId=108976)进行碎片整理 Windows 页面文件和预分配主文件表。</span><span class="sxs-lookup"><span data-stu-id="54f23-136">Use the PageDefrag utility available at [http://go.microsoft.com/fwlink/?LinkId=108976](http://go.microsoft.com/fwlink/?LinkId=108976) to defragment the Windows PageFile and pre-allocate the Master File Tables.</span></span>  
  
### <a name="if-antivirus-software-is-installed-on-the-sql-server-computers-disable-real-time-scanning-of-data-and-transaction-files"></a><span data-ttu-id="54f23-137">如果在 SQL Server 计算机上安装防病毒软件，则禁用实时扫描的数据和事务文件</span><span class="sxs-lookup"><span data-stu-id="54f23-137">If antivirus software is installed on the SQL Server computer(s), disable real-time scanning of data and transaction files</span></span>  
 <span data-ttu-id="54f23-138">SQL Server 数据和事务文件 （.mdf、.ndf、.ldf、.mdb） 的实时扫描可以提高磁盘 I/O 争用，并减少 SQL Server 的性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-138">Real-time scanning of the SQL Server data and transaction files (.mdf, .ndf, .ldf, .mdb) can increase disk I/O contention and reduce SQL Server performance.</span></span> <span data-ttu-id="54f23-139">请注意，BizTalk Server 环境之间的 SQL Server 数据和事务文件的名称可能会有所不同。</span><span class="sxs-lookup"><span data-stu-id="54f23-139">Note that the names of the SQL Server data and transaction files may vary between BizTalk Server environments.</span></span> <span data-ttu-id="54f23-140">有关使用默认 BizTalk Server 配置创建的数据和事务的详细信息，请参阅[优化文件组的数据库](http://msdn.microsoft.com/library/ee377060\(v=bts.70\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="54f23-140">For more information about the data and transaction files created with a default BizTalk Server configuration, see[Optimizing Filegroups for the Databases](http://msdn.microsoft.com/library/ee377060\(v=bts.70\).aspx).</span></span>  
  
### <a name="configure-msdtc-for-biztalk-server"></a><span data-ttu-id="54f23-141">为 BizTalk Server 配置 MSDTC</span><span class="sxs-lookup"><span data-stu-id="54f23-141">Configure MSDTC for BizTalk Server</span></span>  
 <span data-ttu-id="54f23-142">查看要为 BizTalk Server 配置 MSDTC 的以下信息：</span><span class="sxs-lookup"><span data-stu-id="54f23-142">Review the following information to configure MSDTC for BizTalk Server:</span></span>  
  
-   <span data-ttu-id="54f23-143">若要在 BizTalk Server 上配置 MSDTC，请参阅"启用 DTC 在本地主机服务器上"部分中的 BizTalk Server 2010 安装指南[ http://go.microsoft.com/fwlink/?LinkID=191321 ](http://go.microsoft.com/fwlink/?LinkID=191321)。</span><span class="sxs-lookup"><span data-stu-id="54f23-143">To configure MSDTC on the BizTalk Server, see “Enable DTC on the Local Host Server” section of the BizTalk Server 2010 installation guide at [http://go.microsoft.com/fwlink/?LinkID=191321](http://go.microsoft.com/fwlink/?LinkID=191321).</span></span>  
  
-   <span data-ttu-id="54f23-144">"解决 MSDTC 问题的"，网址[ http://go.microsoft.com/fwlink/?LinkID=202142 ](http://go.microsoft.com/fwlink/?LinkID=202142)。</span><span class="sxs-lookup"><span data-stu-id="54f23-144">"Troubleshooting Problems with MSDTC" at [http://go.microsoft.com/fwlink/?LinkID=202142](http://go.microsoft.com/fwlink/?LinkID=202142).</span></span>  
  
### <a name="configure-firewalls-for-biztalk-server"></a><span data-ttu-id="54f23-145">为 BizTalk Server 配置防火墙</span><span class="sxs-lookup"><span data-stu-id="54f23-145">Configure firewall(s) for BizTalk Server</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="54f23-146">此步骤才是必需的如果一个或多个防火墙，则在 BizTalk Server 环境中的位置。</span><span class="sxs-lookup"><span data-stu-id="54f23-146">This step is only required if one or more firewalls are in place in your BizTalk Server environment.</span></span>  
  
 <span data-ttu-id="54f23-147">请查看以下信息为 BizTalk Server 配置防火墙：</span><span class="sxs-lookup"><span data-stu-id="54f23-147">Review the following information to configure firewall(s) for BizTalk Server:</span></span>  
  
-   <span data-ttu-id="54f23-148">"必需的端口为 BizTalk Server"处[ http://go.microsoft.com/fwlink/?LinkId=101607 ](http://go.microsoft.com/fwlink/?LinkId=101607)。</span><span class="sxs-lookup"><span data-stu-id="54f23-148">"Required Ports for BizTalk Server" at [http://go.microsoft.com/fwlink/?LinkId=101607](http://go.microsoft.com/fwlink/?LinkId=101607).</span></span>  
  
-   <span data-ttu-id="54f23-149">"如何配置 RPC 动态端口分配，以使用防火墙"在[ http://go.microsoft.com/fwlink/?LinkID=76145 ](http://go.microsoft.com/fwlink/?LinkID=76145)。</span><span class="sxs-lookup"><span data-stu-id="54f23-149">”How to configure RPC dynamic port allocation to work with firewalls” at [http://go.microsoft.com/fwlink/?LinkID=76145](http://go.microsoft.com/fwlink/?LinkID=76145).</span></span>  
  
### <a name="use-the-ntfs-file-system-on-all-volumes"></a><span data-ttu-id="54f23-150">使用 NTFS 文件系统上的所有卷</span><span class="sxs-lookup"><span data-stu-id="54f23-150">Use the NTFS file system on all volumes</span></span>  
 [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)] <span data-ttu-id="54f23-151">提供用于格式化驱动器，包括 NTFS、 FAT 和 FAT32 的多个文件系统类型。</span><span class="sxs-lookup"><span data-stu-id="54f23-151">offers multiple file system types for formatting drives, including NTFS, FAT, and FAT32.</span></span> <span data-ttu-id="54f23-152">NTFS 应始终为所选的服务器的文件系统。[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="54f23-152">NTFS should always be the file system of choice for servers.[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]</span></span>  
  
 <span data-ttu-id="54f23-153">NTFS FAT 和 FAT32 文件系统相比，提供很大的性能优势，因此应以独占方式在 Windows 服务器上。</span><span class="sxs-lookup"><span data-stu-id="54f23-153">NTFS offers considerable performance benefits over the FAT and FAT32 file systems and should be used exclusively on Windows servers.</span></span> <span data-ttu-id="54f23-154">此外，NTFS 提供针对许多安全性、 可伸缩性、 稳定性和可恢复性优势 FAT 和 FAT32。</span><span class="sxs-lookup"><span data-stu-id="54f23-154">In addition, NTFS offers many security, scalability, stability and recoverability benefits over FAT and FAT32.</span></span>  
  
 <span data-ttu-id="54f23-155">在以前版本的 Windows，FAT 和 FAT32 通常上实现较小的卷 (例如 < 500 MB) 因为它们通常在这种情况下更快。</span><span class="sxs-lookup"><span data-stu-id="54f23-155">Under previous versions of Windows, FAT and FAT32 were often implemented for smaller volumes (say <500 MB) because they were often faster in such situations.</span></span> <span data-ttu-id="54f23-156">磁盘存储价格相对便宜今天和操作系统和应用程序推送到最多的驱动器的容量，不太可能此类小的卷，将使用。</span><span class="sxs-lookup"><span data-stu-id="54f23-156">With disk storage relatively inexpensive today and operating systems and applications pushing drive capacity to a maximum, it is unlikely that such small volumes will be in use.</span></span> <span data-ttu-id="54f23-157">FAT32 伸缩性比 FAT 更好，更大的卷上，但仍不适当的文件系统的 Windows 服务器。</span><span class="sxs-lookup"><span data-stu-id="54f23-157">FAT32 scales better than FAT on larger volumes but is still not an appropriate file system for Windows servers.</span></span>  
  
 <span data-ttu-id="54f23-158">FAT 和 FAT32 通常已实现过去它们是为更轻松地可恢复和可使用本机 DOS 工具出现问题与使用的卷时所示。</span><span class="sxs-lookup"><span data-stu-id="54f23-158">FAT and FAT32 have often been implemented in the past as they were seen as more easily recoverable and manageable with native DOS tools in the event of a problem with a volume.</span></span> <span data-ttu-id="54f23-159">目前，各种 NTFS 可恢复性与生成的工具，同时以本机模式到操作系统，并可用作第三方实用程序可用，应不再有未使用 NTFS 文件系统的有效参数。</span><span class="sxs-lookup"><span data-stu-id="54f23-159">Today, with the various NTFS recoverability tools built both natively into the operating system and available as third-party utilities available, there should no longer be a valid argument for not using NTFS for file systems.</span></span>  
  
### <a name="do-not-use-ntfs-file-compression"></a><span data-ttu-id="54f23-160">不使用 NTFS 文件压缩</span><span class="sxs-lookup"><span data-stu-id="54f23-160">Do not use NTFS file compression</span></span>  
 <span data-ttu-id="54f23-161">虽然使用 NTFS 文件系统压缩是减少空间卷上的简单方法，但它不是适用于企业的文件服务器。</span><span class="sxs-lookup"><span data-stu-id="54f23-161">Though using NTFS file system compression is an easy way to reduce space on volumes, it is not appropriate for enterprise file servers.</span></span> <span data-ttu-id="54f23-162">实现压缩磁盘的所有操作在 CPU 上会不必要的开销，最好避免使用。</span><span class="sxs-lookup"><span data-stu-id="54f23-162">Implementing compression places an unnecessary overhead on the CPU for all disk operations and is best avoided.</span></span> <span data-ttu-id="54f23-163">考虑添加更多的磁盘的选项、 近线存储或将数据存档在认真考虑文件系统压缩之前，请考虑。</span><span class="sxs-lookup"><span data-stu-id="54f23-163">Think about options for adding additional disks, near-line storage or consider archiving data before seriously considering file system compression.</span></span>  
  
### <a name="review-disk-controller-stripe-size-and-volume-allocation-units"></a><span data-ttu-id="54f23-164">查看磁盘控制器条带大小和卷分配单元。</span><span class="sxs-lookup"><span data-stu-id="54f23-164">Review disk controller stripe size and volume allocation units</span></span>  
 <span data-ttu-id="54f23-165">时配置驱动器阵列和逻辑驱动器中硬件驱动器控制器，请确保您与匹配与将使用格式化卷的分配单元大小控制器条带大小。</span><span class="sxs-lookup"><span data-stu-id="54f23-165">When configuring drive arrays and logical drives within your hardware drive controller, ensure you match the controller stripe size with the allocation unit size that the volumes will be formatted with.</span></span> <span data-ttu-id="54f23-166">这将确保磁盘读取和写入已获得最佳性能，并提供更好的总体服务器性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-166">This will ensure disk read and write performance is optimal and offer better overall server performance.</span></span>  
  
 <span data-ttu-id="54f23-167">配置更大的分配单元 （或群集或块） 大小会导致磁盘空间来使用效率较低，但还会提供更高版本磁盘 I/O 性能，因为磁盘头期间读取的每个活动可以读取更多数据。</span><span class="sxs-lookup"><span data-stu-id="54f23-167">Configuring larger allocation unit (or cluster or block) sizes will cause disk space to be used less efficiently, but will also provide higher disk I/O performance as the disk head can read in more data during each read activity.</span></span>  
  
 <span data-ttu-id="54f23-168">若要确定的最佳设置： 若要配置控制器和使用的磁盘进行格式化，应确定具有类似的文件系统特征的服务器的磁盘子系统上的磁盘的平均传输大小。</span><span class="sxs-lookup"><span data-stu-id="54f23-168">To determine the optimal setting to configure the controller and format the disks with, you should determine the average disk transfer size on the disk subsystem of a server with similar file system characteristics.</span></span> <span data-ttu-id="54f23-169">使用[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]性能监视器工具来监视平均的逻辑磁盘对象计数器Disk Bytes/Read 和 avg.磁盘字节数/写入的正常活动的期间内以帮助确定要使用的最佳值。</span><span class="sxs-lookup"><span data-stu-id="54f23-169">Use the [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)] Performance Monitor tool to monitor the Logical Disk object counters of Avg. Disk Bytes/Read and Avg. Disk Bytes/Write over a period of normal activity to help determine the best value to use.</span></span>  
  
 <span data-ttu-id="54f23-170">尽管较小的分配单元大小可能合理许多小文件或记录，如果将访问系统，为 64 KB 分配单元大小提供声音性能和大多数情况下的 I/O 吞吐量。</span><span class="sxs-lookup"><span data-stu-id="54f23-170">Although smaller allocation unit sizes may be warranted if the system will be accessing many small files or records, an allocation unit size of 64 KB delivers sound performance and I/O throughput under most circumstances.</span></span> <span data-ttu-id="54f23-171">中的优化的分配单元大小与性能的改进可以特别注意的是磁盘负载增加时。</span><span class="sxs-lookup"><span data-stu-id="54f23-171">Improvements in performance with tuned allocation unit sizes can be particularly noted when disk load increases.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="54f23-172">格式命令行工具或磁盘管理工具需要格式化卷时，指定分配单元大小大于 4096 个字节 (4 KB)。</span><span class="sxs-lookup"><span data-stu-id="54f23-172">Either the FORMAT command line tool or the Disk Management tool is required to specify an allocation unit size larger than 4096 bytes (4 KB) when formatting volumes.</span></span> <span data-ttu-id="54f23-173">Windows 资源管理器将仅由此阈值设置格式。</span><span class="sxs-lookup"><span data-stu-id="54f23-173">Windows Explorer will only format up to this threshold.</span></span> <span data-ttu-id="54f23-174">CHKDSK 命令可以用于确认卷的当前分配单元大小，但是它需要扫描整个卷之前 （以字节显示在每个分配单元中） 显示的所需的信息。</span><span class="sxs-lookup"><span data-stu-id="54f23-174">The CHKDSK command can be used to confirm the current allocation unit size of a volume however it needs to scan the entire volume before the desired information is displayed (shown as Bytes in each allocation unit).</span></span>  
  
### <a name="monitor-drive-space-utilization"></a><span data-ttu-id="54f23-175">监视驱动器空间利用率</span><span class="sxs-lookup"><span data-stu-id="54f23-175">Monitor drive space utilization</span></span>  
 <span data-ttu-id="54f23-176">更少数据磁盘上的，更快地运行。</span><span class="sxs-lookup"><span data-stu-id="54f23-176">The less data on a disk, the faster it will operate.</span></span> <span data-ttu-id="54f23-177">这是磁盘的因为也经过碎片整理的驱动器上数据将写入的外边缘尽可能接近由于这是磁盘的磁盘位置旋转的速度最快和实现最佳性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-177">This is because on a well defragmented drive, data is written as close to the outer edge of the disk as possible because this is where the disk spins the fastest and yields the best performance.</span></span>  
  
 <span data-ttu-id="54f23-178">磁盘寻道时间是通常相当长的时间比读取或写入活动。</span><span class="sxs-lookup"><span data-stu-id="54f23-178">Disk seek time is normally considerably longer than read or write activities.</span></span> <span data-ttu-id="54f23-179">如上文所述，数据最初是写入磁盘的外边缘。</span><span class="sxs-lookup"><span data-stu-id="54f23-179">As noted above, data is initially written to the outside edge of a disk.</span></span> <span data-ttu-id="54f23-180">当对磁盘存储的提高和可用空间的需求减少时，更接近将数据写入磁盘的中心。</span><span class="sxs-lookup"><span data-stu-id="54f23-180">As demand for disk storage increases and free space reduces, data is written closer to the center of the disk.</span></span> <span data-ttu-id="54f23-181">磁盘寻道时间增加的头移动数量从边缘，作为查找数据和找到时，所花费的时间阅读，妨碍磁盘 I/O 性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-181">Disk seek time is increased in locating the data as the head moves away from the edge, and when found, it takes longer to read, hindering disk I/O performance.</span></span>  
  
 <span data-ttu-id="54f23-182">这意味着，监视磁盘空间利用率很重要不只是出于容量原因，但性能还。</span><span class="sxs-lookup"><span data-stu-id="54f23-182">This means that monitoring disk space utilization is important not just for capacity reasons but for performance also.</span></span>  
  
 <span data-ttu-id="54f23-183">根据经验，工作完成保持磁盘可用空间介于 20%到 25%的总磁盘空间的一个目标。</span><span class="sxs-lookup"><span data-stu-id="54f23-183">As a rule of thumb, work towards a goal of keeping disk free space between 20% to 25% of total disk space.</span></span> <span data-ttu-id="54f23-184">如果可用磁盘空间下降到低于此阈值，则磁盘 I/O 性能将受到负面影响。</span><span class="sxs-lookup"><span data-stu-id="54f23-184">If free disk space drops below this threshold, then disk I/O performance will be negatively impacted.</span></span>  
  
### <a name="implement-a-strategy-to-avoid-disk-fragmentation"></a><span data-ttu-id="54f23-185">实施策略，以避免磁盘碎片</span><span class="sxs-lookup"><span data-stu-id="54f23-185">Implement a strategy to avoid disk fragmentation</span></span>  
 <span data-ttu-id="54f23-186">在你的磁盘，包括根驱动器，用于防止性能下降上定期运行碎片整理程序实用工具。</span><span class="sxs-lookup"><span data-stu-id="54f23-186">Run a defragmenter utility regularly on your disks, including the root drive, to prevent performance degradation.</span></span> <span data-ttu-id="54f23-187">执行此每周在繁忙的磁盘上。</span><span class="sxs-lookup"><span data-stu-id="54f23-187">Do this weekly on busy disks.</span></span> <span data-ttu-id="54f23-188">磁盘碎片整理程序随 Windows Server 安装，并可以从计划任务在指定的时间间隔运行。</span><span class="sxs-lookup"><span data-stu-id="54f23-188">A disk defragmenter is installed with Windows Server and can be run from a Scheduled Task at specified intervals.</span></span>  
  
### <a name="optimize-windows-server-performance-for-background-services"></a><span data-ttu-id="54f23-189">优化后台服务的 Windows Server 的性能</span><span class="sxs-lookup"><span data-stu-id="54f23-189">Optimize Windows Server performance for background services</span></span>  
 <span data-ttu-id="54f23-190">BizTalk Server 进程 (BTSNTSVC.exe) 作为后台服务运行。</span><span class="sxs-lookup"><span data-stu-id="54f23-190">The BizTalk Server process (BTSNTSVC.exe) runs as a background service.</span></span> <span data-ttu-id="54f23-191">默认情况下，[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]配置为调整为获得最佳性能的应用程序的程序而不是针对后台服务。</span><span class="sxs-lookup"><span data-stu-id="54f23-191">By default, [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)] is configured to adjust for best performance of application programs and not for background services.</span></span>  
  
 [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)] <span data-ttu-id="54f23-192">使用抢先式多任务来确定将为参加由 CPU 的进程线程的优先级。</span><span class="sxs-lookup"><span data-stu-id="54f23-192">uses preemptive multi-tasking to prioritize process threads that will be attended to by the CPU.</span></span> <span data-ttu-id="54f23-193">抢先式多任务处理是一种方法来暂停进程的执行和启动另一个进程时，操作系统的决定。</span><span class="sxs-lookup"><span data-stu-id="54f23-193">Preemptive multi-tasking is a methodology whereby the execution of a process is halted and another process is started, at the discretion of the operating system.</span></span> <span data-ttu-id="54f23-194">此方案可防止单个线程在支配 CPU。</span><span class="sxs-lookup"><span data-stu-id="54f23-194">This scheme prevents a single thread from dominating the CPU.</span></span>  
  
 <span data-ttu-id="54f23-195">切换到下一个进程内执行从 CPU 被称为上下文切换。</span><span class="sxs-lookup"><span data-stu-id="54f23-195">Switching the CPU from executing one process to the next is known as context-switching.</span></span> <span data-ttu-id="54f23-196">Windows 操作系统包括确定多长时间允许各个线程发生上下文切换和下一个线程已得到处理之前，在 CPU 上运行的设置。</span><span class="sxs-lookup"><span data-stu-id="54f23-196">The Windows operating system includes a setting that determines how long individual threads are allowed to run on the CPU before a context-switch occurs and the next thread is serviced.</span></span> <span data-ttu-id="54f23-197">此时间量称为量程。</span><span class="sxs-lookup"><span data-stu-id="54f23-197">This amount of time is referred to as a quantum.</span></span> <span data-ttu-id="54f23-198">此设置允许您选择处理器量程前台程序和后台服务之间的共享方式。</span><span class="sxs-lookup"><span data-stu-id="54f23-198">This setting lets you choose how processor quanta are shared between foreground programs and background services.</span></span> <span data-ttu-id="54f23-199">通常为服务器不需要以允许前台程序具有比后台服务分配给它的更多 CPU 时间。</span><span class="sxs-lookup"><span data-stu-id="54f23-199">Typically for a server it is not desirable to allow a foreground program to have more CPU time allocated to it than background services.</span></span> <span data-ttu-id="54f23-200">也就是说，所有应用程序和其在服务器上运行的进程应考虑相等的 CPU 时间。</span><span class="sxs-lookup"><span data-stu-id="54f23-200">That is, all applications and their processes running on the server should be given equal consideration for CPU time.</span></span>  
  
 <span data-ttu-id="54f23-201">若要增加为 BizTalk 主机实例等的后台服务的性能，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="54f23-201">To increase performance for background service like BizTalk host instances, follow these steps:</span></span>  
  
1.  <span data-ttu-id="54f23-202">单击**启动**，单击**控制面板**，然后单击**系统**。</span><span class="sxs-lookup"><span data-stu-id="54f23-202">Click **Start**, click **Control Panel**, and then click **System**.</span></span>  
  
2.  <span data-ttu-id="54f23-203">单击**高级**选项卡，然后依次**设置**下**性能**。</span><span class="sxs-lookup"><span data-stu-id="54f23-203">Click the **Advanced** tab, and then click **Settings** under **Performance**.</span></span>  
  
3.  <span data-ttu-id="54f23-204">单击**高级**选项卡上，单击**后台服务**，然后单击**确定**两次。</span><span class="sxs-lookup"><span data-stu-id="54f23-204">Click the **Advanced** tab, click **Background services**, and then click **OK** twice.</span></span>  
  
### <a name="manually-load-microsoft-certificate-revocation-lists"></a><span data-ttu-id="54f23-205">手动加载 Microsoft 证书吊销列表</span><span class="sxs-lookup"><span data-stu-id="54f23-205">Manually load Microsoft Certificate Revocation lists</span></span>  
 <span data-ttu-id="54f23-206">在启动时的.NET 应用程序，.NET Framework 将尝试下载的证书吊销列表 (CRL) 适用于任何已签名的程序集。</span><span class="sxs-lookup"><span data-stu-id="54f23-206">When starting a .NET application, the .NET Framework will attempt to download the Certificate Revocation list (CRL) for any signed assembly.</span></span> <span data-ttu-id="54f23-207">如果您的系统不具有直接访问 Internet，或受限制而无法访问 Microsoft.com 域，这可能会延迟启动 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="54f23-207">If your system does not have direct access to the Internet, or is restricted from accessing the Microsoft.com domain, this may delay startup of BizTalk Server.</span></span> <span data-ttu-id="54f23-208">若要避免这种延迟在应用程序启动时，可以使用以下步骤来手动下载并安装在系统上签名证书吊销列表的代码。</span><span class="sxs-lookup"><span data-stu-id="54f23-208">To avoid this delay at application startup, you can use the following steps to manually download and install the code signing Certificate Revocation Lists on your system.</span></span>  
  
1. <span data-ttu-id="54f23-209">下载最新的 CRL 更新从[ http://crl.microsoft.com/pki/crl/products/CodeSignPCA.crl ](http://go.microsoft.com/fwlink/?LinkID=117794)并[ http://crl.microsoft.com/pki/crl/products/CodeSignPCA2.crl ](http://go.microsoft.com/fwlink/?LinkId=117795)。</span><span class="sxs-lookup"><span data-stu-id="54f23-209">Download the latest CRL updates from [http://crl.microsoft.com/pki/crl/products/CodeSignPCA.crl](http://go.microsoft.com/fwlink/?LinkID=117794) and [http://crl.microsoft.com/pki/crl/products/CodeSignPCA2.crl](http://go.microsoft.com/fwlink/?LinkId=117795).</span></span>  
  
2. <span data-ttu-id="54f23-210">将 CodeSignPCA.crl 和 CodeSignPCA2.crl 文件移动到独立的系统。</span><span class="sxs-lookup"><span data-stu-id="54f23-210">Move the CodeSignPCA.crl and CodeSignPCA2.crl files to the isolated system.</span></span>  
  
3. <span data-ttu-id="54f23-211">从命令提示符下输入以下命令以使用 certutil 实用程序以使用在步骤 1 中下载 CRL 更新本地证书存储区：</span><span class="sxs-lookup"><span data-stu-id="54f23-211">From a command prompt, enter the following command to use the certutil utility to update the local certificate store with the CRL downloaded in step 1:</span></span>  
  
    <span data-ttu-id="54f23-212">certutil –addstore CA c:\CodeSignPCA.crl</span><span class="sxs-lookup"><span data-stu-id="54f23-212">certutil –addstore CA c:\CodeSignPCA.crl</span></span>  
  
   <span data-ttu-id="54f23-213">CRL 文件将定期更新，因此您应该考虑设置重复的任务的下载和安装 CRL 更新。</span><span class="sxs-lookup"><span data-stu-id="54f23-213">The CRL files are updated regularly, so you should consider setting a reoccurring task of downloading and installing the CRL updates.</span></span> <span data-ttu-id="54f23-214">若要查看下一步的更新时间，双击.crl 文件以及查看的值**下一步更新**字段。</span><span class="sxs-lookup"><span data-stu-id="54f23-214">To view the next update time, double-click the .crl file and view the value of the **Next Update** field.</span></span>  
  
### <a name="synchronize-time-on-all-servers"></a><span data-ttu-id="54f23-215">同步所有服务器上的时间</span><span class="sxs-lookup"><span data-stu-id="54f23-215">Synchronize time on all servers</span></span>  
 <span data-ttu-id="54f23-216">涉及票证的许多操作，回执和日志记录将被准确的本地系统时钟。</span><span class="sxs-lookup"><span data-stu-id="54f23-216">Many operations involving tickets, receipts and logging rely on the local system clock being accurate.</span></span> <span data-ttu-id="54f23-217">这是在分布式环境中，系统之间的时间差异可能导致的日志，以同步的或由为已过期拒绝的另一个系统颁发票证尤其如此或尚未生效。</span><span class="sxs-lookup"><span data-stu-id="54f23-217">This is especially true in a distributed environment, where time discrepancies between systems may cause logs to be out of sync or tickets issued by one system to be rejected by another as expired or not yet valid.</span></span>  
  
 <span data-ttu-id="54f23-218">服务器配置为自动同步时间的详细信息，请参阅[ http://go.microsoft.com/fwlink/?LinkId=99420 ](http://go.microsoft.com/fwlink/?LinkId=99420)。</span><span class="sxs-lookup"><span data-stu-id="54f23-218">For more information on configuring a server to automatically synchronize time, see [http://go.microsoft.com/fwlink/?LinkId=99420](http://go.microsoft.com/fwlink/?LinkId=99420).</span></span>  
  
### <a name="configure-the-windows-pagefile-for-optimal-performance"></a><span data-ttu-id="54f23-219">配置 Windows 页面文件以获得最佳性能</span><span class="sxs-lookup"><span data-stu-id="54f23-219">Configure the Windows PAGEFILE for optimal performance</span></span>  
 <span data-ttu-id="54f23-220">为了获得最佳性能，请遵循以下准则来配置 Windows 页面文件 （分页文件）：</span><span class="sxs-lookup"><span data-stu-id="54f23-220">Follow these guidelines to configure the Windows PAGEFILE (paging file) for optimal performance:</span></span>  
  
1.  <span data-ttu-id="54f23-221">**将页面文件移到独立于操作系统安装以减少磁盘争用并提高磁盘性能的物理驱动器的物理卷**-BizTalk Server 在计算机上，与移动相关的性能提升分页文件的文档处理负载而异。</span><span class="sxs-lookup"><span data-stu-id="54f23-221">**Move the paging file to a physical volume separate from the physical drive that operating system is installed on to reduce disk contention and increase disk performance** - On BizTalk Server computers, the performance gain associated with moving the paging file will vary depending on the document processing load.</span></span> <span data-ttu-id="54f23-222">SQL Server 计算机上将页面文件移动到一个单独的卷被认为在所有方案中由于磁盘密集型特性的 SQL Server 最佳实践。</span><span class="sxs-lookup"><span data-stu-id="54f23-222">On SQL Server computers, moving the paging file to a separate volume is considered a best practice in all scenarios due to the disk intensive nature of SQL Server.</span></span>  
  
2.  <span data-ttu-id="54f23-223">**隔离一个或多个专用物理驱动器上配置为 RAID 0 （带区） 或 RAID 1 （镜像） 数组，或在没有 RAID 的单个磁盘上分页文件**-通过使用专用的磁盘或驱动器阵列的页面文件。SYS 是整个卷上唯一的文件、 分页文件不会变成碎片，这还可以提高性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-223">**Isolate the paging file onto one or more dedicated physical drives that are configured as either RAID-0 (striping) or RAID-1 (mirroring) arrays, or on single disks without RAID** - By using a dedicated disk or drive array where PAGEFILE.SYS is the only file on the entire volume, the paging file will not become fragmented, which will also improve performance.</span></span> <span data-ttu-id="54f23-224">与大多数磁盘的阵列，该数组的性能得到改进由于数组中的物理磁盘的数量已增加。</span><span class="sxs-lookup"><span data-stu-id="54f23-224">As with most disk-arrays, performance of the array is improved as the number of physical disks in the array is increased.</span></span> <span data-ttu-id="54f23-225">如果页面文件磁盘阵列中的多个物理驱动器上的多个卷之间分布，分页文件大小应为数组中每个驱动器上的相同大小。</span><span class="sxs-lookup"><span data-stu-id="54f23-225">If the paging file is distributed between multiple volumes on multiple physical drives in a disk array, the paging file size should be the same size on each drive in the array.</span></span> <span data-ttu-id="54f23-226">在配置磁盘阵列，它也被建议使用具有相同的容量和速度的物理驱动器。</span><span class="sxs-lookup"><span data-stu-id="54f23-226">When configuring a disk array, it is also recommended to use physical drives that have the same capacity and speed.</span></span> <span data-ttu-id="54f23-227">请注意冗余不是通常所需的分页文件。</span><span class="sxs-lookup"><span data-stu-id="54f23-227">Note that redundancy is not normally required for the paging file.</span></span>  
  
3.  <span data-ttu-id="54f23-228">**未配置 RAID 5 阵列上的分页文件**-不建议在 RAID 5 阵列上分页文件的配置，因为分页文件活动写入密集型和 RAID 5 阵列更好地适合于读取性能不是写入性能。</span><span class="sxs-lookup"><span data-stu-id="54f23-228">**Do not configure the paging file on a RAID 5 array** - Configuration of the paging file on a RAID 5 array is not recommended because paging file activity is write intensive and RAID 5 arrays are better suited for read performance than write performance.</span></span>  
  
4.  <span data-ttu-id="54f23-229">**如果还没有资源，以将页面文件移动到物理卷，而不在安装操作系统，配置要与操作系统相同的逻辑卷上驻留的分页文件**-配置页面文件，使其位于另一个逻辑卷位于同一物理磁盘，因为操作系统将增加磁盘寻道时间并降低系统性能，因为磁盘驱动器的盘片磁头将不断移动之间的卷，或者访问的页面文件操作系统文件、 应用程序文件和数据文件。</span><span class="sxs-lookup"><span data-stu-id="54f23-229">**If you do not have resources to move the paging file to a physical volume other than the operating system is installed on, configure the paging file to reside on the same logical volume as the operating system** - Configuring the paging file to reside on a another logical volume which is on the same physical disk as the operating system will increase disk seek time and reduce system performance as the disk drive platter heads will be continually moving between the volumes, alternately accessing the page file, operating system files, application files, and data files.</span></span> <span data-ttu-id="54f23-230">此外，通常最接近于物理磁盘的外边缘的物理磁盘的第一个分区通常安装操作系统，其中磁盘速度是，关联的性能最适合于该磁盘。</span><span class="sxs-lookup"><span data-stu-id="54f23-230">Also, the operating system is typically installed on the first partition of a physical disk, which is usually the closest to the outside edge of the physical disk and where disk speed is and associated performance are optimal for the disk.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="54f23-231">如果你从启动分区删除分页文件，Windows 无法创建崩溃转储文件 （的内存。DMP) 用来在的内核模式下停止写入调试信息时发生错误。</span><span class="sxs-lookup"><span data-stu-id="54f23-231">If you do remove the paging file from the boot partition, Windows cannot create a crash dump file (MEMORY.DMP) in which to write debugging information in the event that a kernel mode STOP error occurs.</span></span> <span data-ttu-id="54f23-232">如果你需要的崩溃转储文件，则您将别无选择，只能离开至少为页面文件大小的物理内存 + 1 MB 的引导分区上。</span><span class="sxs-lookup"><span data-stu-id="54f23-232">If you do require a crash dump file, then you will have no option but to leave a paging file of at least the size of physical memory + 1 MB on the boot partition.</span></span>  
  
5.  <span data-ttu-id="54f23-233">**手动设置的页面文件大小**– 手动设置分页文件的大小通常提供更好的性能比这样，服务器可以自动调整大小或根本无分页文件。</span><span class="sxs-lookup"><span data-stu-id="54f23-233">**Manually set the size of the paging file** – Manually setting the size of the paging file typically provides better performance than allowing the server to size it automatically or having no paging file at all.</span></span> <span data-ttu-id="54f23-234">优化最佳做法是设置初始 （最低配置） 和页面文件的最大大小设置为相同的值。</span><span class="sxs-lookup"><span data-stu-id="54f23-234">Best-practice tuning is to set the initial (minimum) and maximum size settings for the paging file to the same value.</span></span> <span data-ttu-id="54f23-235">这可确保没有处理资源丢失到分页文件，可能是操作的动态调整大小。</span><span class="sxs-lookup"><span data-stu-id="54f23-235">This ensures that no processing resources are lost to the dynamic resizing of the paging file, which can be intensive.</span></span> <span data-ttu-id="54f23-236">考虑到此大小调整活动通常发生在系统上的内存资源成为约束时，也是如此。</span><span class="sxs-lookup"><span data-stu-id="54f23-236">This is especially true given that this resizing activity typically occurs when the memory resources on the system are already becoming constrained.</span></span> <span data-ttu-id="54f23-237">设置相同的最小值和最大页面文件大小值还可在磁盘上的分页区域是一个单一的连续未分配区域中，确保提高磁盘寻道时间。</span><span class="sxs-lookup"><span data-stu-id="54f23-237">Setting the same minimum and maximum page file size value also ensures the paging area on a disk is one single, contiguous area, improving disk seek time.</span></span>