---
title: "不应更改的 SQL Server 设置 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 4b383bfb-c3d9-47d4-b294-f6be94302734
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d2fb6e2553c005d3ba8651c860ff844e8cc74106
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="sql-server-settings-that-should-not-be-changed"></a><span data-ttu-id="8d99a-102">不应更改的 SQL Server 设置</span><span class="sxs-lookup"><span data-stu-id="8d99a-102">SQL Server Settings That Should Not Be Changed</span></span>
<span data-ttu-id="8d99a-103">设置时[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]期间的操作的准备情况过程[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，你不应更改为下列设置。</span><span class="sxs-lookup"><span data-stu-id="8d99a-103">When setting up [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] during the operational readiness procedures for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], you should not make changes to the following settings.</span></span>  
  
## <a name="sql-server-max-degree-of-parallelism"></a><span data-ttu-id="8d99a-104">SQL Server 最大并行度</span><span class="sxs-lookup"><span data-stu-id="8d99a-104">SQL Server Max Degree of Parallelism</span></span>  
 <span data-ttu-id="8d99a-105">最大程度的并行度 (MDOP) 设置为"1"在配置期间[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]为[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]instance(s) 该主机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="8d99a-105">Max Degree of Parallelism (MDOP) is set to “1” during the configuration of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] for the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance(s) that host the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database(s).</span></span> <span data-ttu-id="8d99a-106">这是[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]实例级别设置。</span><span class="sxs-lookup"><span data-stu-id="8d99a-106">This is a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance-level setting.</span></span> <span data-ttu-id="8d99a-107">从"1"的值不应更改此设置。</span><span class="sxs-lookup"><span data-stu-id="8d99a-107">This setting should not be changed from the value of “1”.</span></span> <span data-ttu-id="8d99a-108">将此设置更改为"1"之外的任何内容会对严重的负面影响[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]存储过程和性能。</span><span class="sxs-lookup"><span data-stu-id="8d99a-108">Changing this to anything other than “1” can have a significant negative impact on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures and performance.</span></span> <span data-ttu-id="8d99a-109">如果更改的实例的并行度设置[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]会造成负面影响在其执行其他数据库应用程序上的[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]实例，应创建单独的实例[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]专用于承载[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库。</span><span class="sxs-lookup"><span data-stu-id="8d99a-109">If changing the parallelism setting for an instance of [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] will have an adverse effect on other database applications that are being executed on the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance, you should create a separate instance of [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] dedicated to hosting the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  
  
 <span data-ttu-id="8d99a-110">并行查询通常最适合于批处理和决策支持工作负荷。</span><span class="sxs-lookup"><span data-stu-id="8d99a-110">Parallel queries are generally best suited to batch processing and decision support workloads.</span></span> <span data-ttu-id="8d99a-111">它们通常不是在有许多较短的快速查询正在并行事务处理环境中所需。</span><span class="sxs-lookup"><span data-stu-id="8d99a-111">They are typically not desirable in a transaction processing environment where you have many short, fast queries running in parallel.</span></span> <span data-ttu-id="8d99a-112">此外，更改设置有时原因查询计划更改，这会导致查询性能不佳或甚至死锁与 MDOP[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]查询。</span><span class="sxs-lookup"><span data-stu-id="8d99a-112">In addition, changing the MDOP setting sometimes causes the query plan to be changed, which leads to poor query performance or even deadlocks with the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] queries.</span></span>  
  
 <span data-ttu-id="8d99a-113">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]存储的过程提供正确的连接和锁定提示，只要有可能为了尝试以防止执行极大的工作和更改计划的查询优化器。</span><span class="sxs-lookup"><span data-stu-id="8d99a-113">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures provide the correct joins and lock hints wherever possible in order to try to keep the query optimizer from doing much work and changing the plan.</span></span> <span data-ttu-id="8d99a-114">这些存储的过程通过构造查询，以便查询优化器清除出图尽可能多地提供一致的查询执行。</span><span class="sxs-lookup"><span data-stu-id="8d99a-114">These stored procedures provide consistent query executions by constructing the queries such that the query optimizer is taken out of the picture as much as possible.</span></span>  
  
 <span data-ttu-id="8d99a-115">有关详细信息，请参阅 Microsoft 知识库文章 899000， ["的实例的 SQL Server 配置 BizTalk Server 时的并行度设置"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432)。</span><span class="sxs-lookup"><span data-stu-id="8d99a-115">For more information, see Microsoft Knowledge Base article 899000, ["The Parallelism setting for the instance of SQL Server when you configure BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432).</span></span>  
  
## <a name="sql-server-statistics-on-the-messagebox-database"></a><span data-ttu-id="8d99a-116">在 MessageBox 数据库上的 SQL Server 统计信息</span><span class="sxs-lookup"><span data-stu-id="8d99a-116">SQL Server Statistics on the MessageBox Database</span></span>  
 <span data-ttu-id="8d99a-117">以下选项处于关闭状态在默认情况下[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBox 数据库创建时：</span><span class="sxs-lookup"><span data-stu-id="8d99a-117">The following options are turned off by default in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database when it is created:</span></span>  
  
-   <span data-ttu-id="8d99a-118">自动创建统计信息</span><span class="sxs-lookup"><span data-stu-id="8d99a-118">Auto create statistics</span></span>  
  
-   <span data-ttu-id="8d99a-119">自动更新统计信息</span><span class="sxs-lookup"><span data-stu-id="8d99a-119">Auto update statistics</span></span>  
  
 <span data-ttu-id="8d99a-120">不要启用 MessageBox 数据库上的这些选项。</span><span class="sxs-lookup"><span data-stu-id="8d99a-120">Do not enable these options on MessageBox databases.</span></span> <span data-ttu-id="8d99a-121">启用"自动创建统计信息"和"自动更新统计信息"选项可能导致意外的查询执行延迟，特别是在高负荷环境。</span><span class="sxs-lookup"><span data-stu-id="8d99a-121">Enabling the "auto create statistics" and "auto update statistics" options can cause undesirable query execution delays, especially in a high-load environment.</span></span>  
  
 <span data-ttu-id="8d99a-122">此外，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]存储的过程具有完全联接和在查询中指定的锁提示。</span><span class="sxs-lookup"><span data-stu-id="8d99a-122">In addition, the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures have exact joins and lock hints specified on the queries.</span></span> <span data-ttu-id="8d99a-123">这样做是为了确保最佳查询计划可供[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]中的查询[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="8d99a-123">This is done to ensure that the optimal query plan is used by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] queries in [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span> <span data-ttu-id="8d99a-124">已知的分发和预期的结果的查询;已知返回的行的大致数目。</span><span class="sxs-lookup"><span data-stu-id="8d99a-124">The distributions and expected results for the queries are known; the approximate number of rows returned is known.</span></span> <span data-ttu-id="8d99a-125">通常不需要统计信息。</span><span class="sxs-lookup"><span data-stu-id="8d99a-125">Statistics are generally not needed.</span></span>  
  
 <span data-ttu-id="8d99a-126">有关详细信息，请参阅以下 Microsoft 知识库文章：</span><span class="sxs-lookup"><span data-stu-id="8d99a-126">For more information, see the following Microsoft Knowledge Base articles:</span></span>  
  
-   <span data-ttu-id="8d99a-127">**912262**-["自动更新统计信息选项的自动创建统计信息选项和并行度设置处于关闭状态中承载 BizTalk Server BizTalkMsgBoxDB 数据库的 SQL Server 数据库实例"](http://go.microsoft.com/fwlink/?LinkId=153430)(http://go.microsoft.com/fwlink/?LinkId=153430)。</span><span class="sxs-lookup"><span data-stu-id="8d99a-127">**912262**—["The auto update statistics option, the auto create statistics option, and the Parallelism setting are turned off in the SQL Server database instance that hosts the BizTalk Server BizTalkMsgBoxDB database"](http://go.microsoft.com/fwlink/?LinkId=153430) (http://go.microsoft.com/fwlink/?LinkId=153430).</span></span>  
  
-   <span data-ttu-id="8d99a-128">**917845**-["你遇到阻止，死锁条件或其他 SQL Server 问题，当你尝试连接到 BizTalk Server 中的 BizTalkMsgBoxDb 数据库时"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="8d99a-128">**917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>  
  
## <a name="changes-to-the-messagebox-database"></a><span data-ttu-id="8d99a-129">对 MessageBox 数据库的更改</span><span class="sxs-lookup"><span data-stu-id="8d99a-129">Changes to the MessageBox Database</span></span>  
 <span data-ttu-id="8d99a-130">MessageBox 数据库应被视为非 Microsoft 应用程序源代码。</span><span class="sxs-lookup"><span data-stu-id="8d99a-130">The MessageBox database should be treated like non-Microsoft application source code.</span></span> <span data-ttu-id="8d99a-131">也就是说，你应不"调整"MessageBox 数据库通过对表、 索引、 存储的过程和大多数 SQL Server 数据库设置的更改。</span><span class="sxs-lookup"><span data-stu-id="8d99a-131">That is, you should not “tweak” the MessageBox database via changes to tables, indexes, stored procedures, and most SQL Server database settings.</span></span> <span data-ttu-id="8d99a-132">有关详细信息，请在 BizTalk 核心引擎日志，请参阅输入["什么可以并不能执行与 MessageBox 数据库服务器"](http://go.microsoft.com/fwlink/?LinkId=101577) (http://go.microsoft.com/fwlink/?LinkId=101577)。</span><span class="sxs-lookup"><span data-stu-id="8d99a-132">For more information, in the BizTalk Core Engine's WebLog, see the entry ["What you can and can't do with the MessageBox Database server"](http://go.microsoft.com/fwlink/?LinkId=101577) (http://go.microsoft.com/fwlink/?LinkId=101577).</span></span>  
  
## <a name="default-settings-for-the-database-index-rebuilds-and-defragmentation"></a><span data-ttu-id="8d99a-133">数据库索引重新生成和碎片整理的默认设置</span><span class="sxs-lookup"><span data-stu-id="8d99a-133">Default Settings for the Database Index Rebuilds and Defragmentation</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="8d99a-134">不支持磁盘碎片整理的索引。</span><span class="sxs-lookup"><span data-stu-id="8d99a-134"> does not support defragmenting indexes.</span></span> <span data-ttu-id="8d99a-135">"DBCC INDEXDEFRAG"和"ALTER INDEX...</span><span class="sxs-lookup"><span data-stu-id="8d99a-135">“DBCC INDEXDEFRAG” and “ALTER INDEX …</span></span> <span data-ttu-id="8d99a-136">重新组织..."</span><span class="sxs-lookup"><span data-stu-id="8d99a-136">REORGANIZE …”</span></span> <span data-ttu-id="8d99a-137">因为它们使用的页锁定，可能会导致阻塞和死锁与不支持[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="8d99a-137">are not supported since they use page locking, which can cause blocking and deadlocks with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="8d99a-138">执行支持数据库重新生成索引后 （"DBCC DBREINDEX"和"ALTER INDEX...</span><span class="sxs-lookup"><span data-stu-id="8d99a-138"> does support database index rebuilds (“DBCC DBREINDEX” and “ALTER INDEX …</span></span> <span data-ttu-id="8d99a-139">重新生成..."），但它们应该仅可以在维护时段时[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]未处理数据。</span><span class="sxs-lookup"><span data-stu-id="8d99a-139">REBUILD …”), but they should only be done during maintenance windows when [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is not processing data.</span></span> <span data-ttu-id="8d99a-140">索引重新生成时[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]正在处理不支持数据。</span><span class="sxs-lookup"><span data-stu-id="8d99a-140">Index rebuilds while [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is processing data are not supported.</span></span>  
  
 <span data-ttu-id="8d99a-141">有关详细信息，请参阅 Microsoft 知识库文章 917845 ["你遇到阻止，死锁条件或其他 SQL Server 问题，当你尝试连接到 BizTalk Server 中的 BizTalkMsgBoxDb 数据库时"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/？LinkId = 153429)。</span><span class="sxs-lookup"><span data-stu-id="8d99a-141">For more information, see Microsoft Knowledge Base article 917845 [" You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>  
  
 <span data-ttu-id="8d99a-142">索引碎片不是尽可能多的性能问题[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]因为它处于 DSS 系统或执行索引扫描的 OLTP 系统。</span><span class="sxs-lookup"><span data-stu-id="8d99a-142">Index fragmentation is not as much of a performance issue for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as it would be for a DSS system or an OLTP system that performs index scans.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="8d99a-143">执行非常选择性的查询和更新和[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]存储的过程不应导致表扫描或索引扫描。</span><span class="sxs-lookup"><span data-stu-id="8d99a-143"> does very selective queries and updates and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures should not cause table or index scans.</span></span>  
  
 <span data-ttu-id="8d99a-144">有关索引碎片和工作负荷类型的详细信息，请参阅["Microsoft SQL Server 2000 索引碎片整理最佳实践"](http://go.microsoft.com/fwlink/?LinkId=101580) (http://go.microsoft.com/fwlink/?LinkId=101580)。</span><span class="sxs-lookup"><span data-stu-id="8d99a-144">For more information about index fragmentation and workload types, see ["Microsoft SQL Server 2000 Index Defragmentation Best Practices"](http://go.microsoft.com/fwlink/?LinkId=101580) (http://go.microsoft.com/fwlink/?LinkId=101580).</span></span> <span data-ttu-id="8d99a-145">文章引号：</span><span class="sxs-lookup"><span data-stu-id="8d99a-145">A quote from the article:</span></span>  
  
 <span data-ttu-id="8d99a-146">"中图 1 所示，存在很少之间区别是之前和之后对进行碎片整理的存储过程的性能。</span><span class="sxs-lookup"><span data-stu-id="8d99a-146">“As shown in Figure 1, there is little difference between the performance of the stored procedures before and after defragmenting.</span></span> <span data-ttu-id="8d99a-147">通过这些存储过程发出的基础查询处理的数据非常选择性部分，因为工作负荷性能已不产生负面影响碎片的索引。"</span><span class="sxs-lookup"><span data-stu-id="8d99a-147">Because the underlying queries issued by these stored procedures acted upon very selective portions of the data, workload performance was not adversely affected by fragmented indexes.”</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8d99a-148">文章的内容也适用于[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]和[!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="8d99a-148">The contents of the article also apply to [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)] and [!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8d99a-149">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8d99a-149">See Also</span></span>  
 [<span data-ttu-id="8d99a-150">清单： 配置 SQL Server</span><span class="sxs-lookup"><span data-stu-id="8d99a-150">Checklist: Configuring SQL Server</span></span>](~/technical-guides/checklist-configuring-sql-server.md)