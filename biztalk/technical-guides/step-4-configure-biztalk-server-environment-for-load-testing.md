---
title: 步骤 4： 配置 BizTalk Server 环境以进行负载测试 |Microsoft Docs
ms.custom: ''
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 5f336c5f-5a18-493d-8fc0-a8a475ab47b3
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cf3ab4c913a55be391d1e92522c257c4cd82d272
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36990350"
---
# <a name="step-4-configure-biztalk-server-environment-for-load-testing"></a><span data-ttu-id="28719-102">步骤 4： 配置 BizTalk Server 环境以进行负载测试</span><span class="sxs-lookup"><span data-stu-id="28719-102">Step 4: Configure BizTalk Server Environment for Load Testing</span></span>
<span data-ttu-id="28719-103">本主题提供有关创建 BizTalk Server 接收位置，接收端口的信息和运行在主题中所述的示例代码所需的发送端口[步骤 1： 创建单元测试将文档提交到 BizTalk Server](~/technical-guides/step-1-create-a-unit-test-to-submit-documents-to-biztalk-server.md)并[步骤 3： 创建负载测试，以同时执行多个单元测试](~/technical-guides/step-3-create-a-load-test-to-perform-multiple-unit-tests-simultaneously.md)。</span><span class="sxs-lookup"><span data-stu-id="28719-103">This topic provides information for creating the BizTalk Server Receive Locations, Receive Ports, and Send Ports required to run the sample code described in the topics [Step 1: Create a Unit Test to Submit Documents to BizTalk Server](~/technical-guides/step-1-create-a-unit-test-to-submit-documents-to-biztalk-server.md) and [Step 3: Create a Load Test to Perform Multiple Unit Tests Simultaneously](~/technical-guides/step-3-create-a-load-test-to-perform-multiple-unit-tests-simultaneously.md).</span></span>  

## <a name="configure-biztalk-server-environment-for-load-tests"></a><span data-ttu-id="28719-104">为负载测试配置 BizTalk Server 环境</span><span class="sxs-lookup"><span data-stu-id="28719-104">Configure BizTalk Server Environment for Load Tests</span></span>  
 <span data-ttu-id="28719-105">本主题中所述[第 3 步： 创建负载测试对执行多个单元测试同时](~/technical-guides/step-3-create-a-load-test-to-perform-multiple-unit-tests-simultaneously.md)，在负载测试**BTS_Messaging_Step**配置为执行单元测试**BTSMessaging**并**BTSMessaging2**。</span><span class="sxs-lookup"><span data-stu-id="28719-105">As described in the topic [Step 3: Create a Load Test to Perform Multiple Unit Tests Simultaneously](~/technical-guides/step-3-create-a-load-test-to-perform-multiple-unit-tests-simultaneously.md), the load test **BTS_Messaging_Step** is configured to execute the unit tests **BTSMessaging** and **BTSMessaging2**.</span></span> <span data-ttu-id="28719-106">反过来，这些单元测试加载消息 C:\Projects\LoadTest\BTSLoad\TestMessages\TestXmlDocument.xml 的副本并将其发送到终结点**BTSMessagingEP**并**BTSMessagingEP2**中定义项目的应用程序配置 (app.config) 文件的以下部分：</span><span class="sxs-lookup"><span data-stu-id="28719-106">In turn, these unit tests load a copy of the message C:\Projects\LoadTest\BTSLoad\TestMessages\TestXmlDocument.xml and send it to the endpoints **BTSMessagingEP** and **BTSMessagingEP2** as defined in the following section of the project’s application configuration (app.config) file:</span></span>  

 <span data-ttu-id="28719-107">\<\!-BTSMessagingEP-\>\<终结点 address="net.tcp://*BizTalk Server 计算机*: 8123/btsloadtest"绑定 ="netTcpBinding"bindingConfiguration ="netTcpBinding"协定 ="System.ServiceModel.Channels.IRequestChannel"名称 ="BTSMessagingEP"/\>\<终结点 address="net.tcp://*BizTalk Server 计算机*: 8123/btsloadtest"绑定 ="netTcpBinding"bindingConfiguration ="netTcpBinding"contract="System.ServiceModel.Channels.IRequestChannel"名称 ="BTSMessagingEP2"/                  \></span><span class="sxs-lookup"><span data-stu-id="28719-107">\<\!-- BTSMessagingEP --\>         \<endpoint address="net.tcp://*BizTalk Server Computer*:8123/btsloadtest" binding="netTcpBinding" bindingConfiguration="netTcpBinding" contract="System.ServiceModel.Channels.IRequestChannel" name="BTSMessagingEP" /\>         \<endpoint address="net.tcp://*BizTalk Server Computer*:8123/btsloadtest" binding="netTcpBinding" bindingConfiguration="netTcpBinding" contract="System.ServiceModel.Channels.IRequestChannel" name="BTSMessagingEP2" /\></span></span>  

> [!NOTE]
>  <span data-ttu-id="28719-108">如前文所述， *BizTalk Server 计算机*是一个占位符的实际的 BizTalk Server 计算机名，或在情况下，BizTalk Server 计算机都配置为网络负载平衡 (NLB) 群集; 的成员*BizTalk Server 计算机*是占位符的名称或相应的 NLB 虚拟服务器的地址。</span><span class="sxs-lookup"><span data-stu-id="28719-108">As noted earlier, *BizTalk Server Computer* is a placeholder for the actual BizTalk Server computer names or, in the case that the BizTalk Server Computers are configured as members of a Network Load Balancing (NLB) cluster; *BizTalk Server Computer* is a placeholder for the name or address of the corresponding NLB virtual server.</span></span>  

 <span data-ttu-id="28719-109">对于此示例中，使用两台 BizTalk Server 计算机和 BizTalk Server Messagebox 数据库是远程的 SQL Server 计算机上。</span><span class="sxs-lookup"><span data-stu-id="28719-109">For purposes of this example, two BizTalk Server computers were used and the BizTalk Server Message Box database was on a remote SQL Server computer.</span></span>  

### <a name="create-biztalk-server-send-and-receive-hosts"></a><span data-ttu-id="28719-110">创建 BizTalk Server 发送和接收主机</span><span class="sxs-lookup"><span data-stu-id="28719-110">Create BizTalk Server Send and Receive Hosts</span></span>  
 <span data-ttu-id="28719-111">按照 BizTalk Server 文档主题中的步骤[如何创建新的主机](http://go.microsoft.com/fwlink/?LinkId=208595)(http://go.microsoft.com/fwlink/?LinkId=208595)若要创建的 BizTalk Server"发送"主机的发送端口和发送适配器处理程序。</span><span class="sxs-lookup"><span data-stu-id="28719-111">Follow the steps in the BizTalk Server Documentation topic [How to Create a New Host](http://go.microsoft.com/fwlink/?LinkId=208595) (http://go.microsoft.com/fwlink/?LinkId=208595) to create a BizTalk Server “Send” host for Send Ports and Send adapter handlers.</span></span> <span data-ttu-id="28719-112">配置主机具有以下属性：</span><span class="sxs-lookup"><span data-stu-id="28719-112">Configure the host with the following properties:</span></span>  

|<span data-ttu-id="28719-113">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-113">Property</span></span>|<span data-ttu-id="28719-114">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-114">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-115">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-115">Name</span></span>|<span data-ttu-id="28719-116">TxHost</span><span class="sxs-lookup"><span data-stu-id="28719-116">TxHost</span></span>|  
|<span data-ttu-id="28719-117">类型</span><span class="sxs-lookup"><span data-stu-id="28719-117">Type</span></span>|<span data-ttu-id="28719-118">进程内</span><span class="sxs-lookup"><span data-stu-id="28719-118">In-Process</span></span>|  
|<span data-ttu-id="28719-119">允许主机跟踪</span><span class="sxs-lookup"><span data-stu-id="28719-119">Allow Host Tracking</span></span>|<span data-ttu-id="28719-120">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-120">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-121">受信任验证</span><span class="sxs-lookup"><span data-stu-id="28719-121">Authentication Trusted</span></span>|<span data-ttu-id="28719-122">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-122">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-123">仅限 32 位</span><span class="sxs-lookup"><span data-stu-id="28719-123">32-bit only</span></span>|<span data-ttu-id="28719-124">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-124">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-125">将其用作组中的默认主机</span><span class="sxs-lookup"><span data-stu-id="28719-125">Make this the default host in the group</span></span>|<span data-ttu-id="28719-126">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-126">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-127">Windows 组</span><span class="sxs-lookup"><span data-stu-id="28719-127">Windows group</span></span>|<span data-ttu-id="28719-128">用于控制对此主机与关联的主机实例的访问的 Windows 组。</span><span class="sxs-lookup"><span data-stu-id="28719-128">The Windows group used to control access to this host and associated host instances.</span></span> <span data-ttu-id="28719-129">为默认进程内主机为创建的窗口组*\<计算机名\>* \BizTalk 应用程序用户 （适用于单个服务器 BizTalk Server 安装） 或 *\<域名\>* \BizTalk 应用程序用户 （适用于多个服务器需要使用域组的 BizTalk Server 安装）。</span><span class="sxs-lookup"><span data-stu-id="28719-129">The Window group created for the default in-process host is named either *\<Computer Name\>* \BizTalk Application Users (for a single server BizTalk Server installation) or *\<Domain Name\>* \BizTalk Application Users (for a multiple server BizTalk Server installation, which requires the use of domain groups).</span></span> <span data-ttu-id="28719-130">**注意：***\<计算机名\>* 并*\<域名\>* 都是实际的计算机名称或使用域名的占位符创建组时。  </span><span class="sxs-lookup"><span data-stu-id="28719-130">**Note:**  *\<Computer Name\>* and *\<Domain Name\>* are placeholders for the actual computer name or domain name used when the group was created.</span></span> <br /><br /> <span data-ttu-id="28719-131">如果为此主机创建新的组，则它必须具有本主题中所述的权限[主机组](http://go.microsoft.com/fwlink/?LinkId=208803)(http://go.microsoft.com/fwlink/?LinkId=208803) BizTalk Server 文档中。</span><span class="sxs-lookup"><span data-stu-id="28719-131">If a new group is created for this host then it must have the privileges described in the topic [Host Groups](http://go.microsoft.com/fwlink/?LinkId=208803) (http://go.microsoft.com/fwlink/?LinkId=208803) in the BizTalk Server documentation.</span></span>|  

 <span data-ttu-id="28719-132">重复执行时创建"发送"主机来创建"接收"主机遵循的步骤。</span><span class="sxs-lookup"><span data-stu-id="28719-132">Repeat the steps that you followed when creating the “Send” host to create a “Receive” host.</span></span> <span data-ttu-id="28719-133">使用以下属性值配置"接收"主机：</span><span class="sxs-lookup"><span data-stu-id="28719-133">Configure the “Receive” host with the following property values:</span></span>  

|<span data-ttu-id="28719-134">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-134">Property</span></span>|<span data-ttu-id="28719-135">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-135">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-136">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-136">Name</span></span>|<span data-ttu-id="28719-137">RxHost</span><span class="sxs-lookup"><span data-stu-id="28719-137">RxHost</span></span>|  
|<span data-ttu-id="28719-138">类型</span><span class="sxs-lookup"><span data-stu-id="28719-138">Type</span></span>|<span data-ttu-id="28719-139">进程内</span><span class="sxs-lookup"><span data-stu-id="28719-139">In-Process</span></span>|  
|<span data-ttu-id="28719-140">允许主机跟踪</span><span class="sxs-lookup"><span data-stu-id="28719-140">Allow Host Tracking</span></span>|<span data-ttu-id="28719-141">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-141">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-142">受信任验证</span><span class="sxs-lookup"><span data-stu-id="28719-142">Authentication Trusted</span></span>|<span data-ttu-id="28719-143">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-143">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-144">仅限 32 位</span><span class="sxs-lookup"><span data-stu-id="28719-144">32-bit only</span></span>|<span data-ttu-id="28719-145">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-145">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-146">将其用作组中的默认主机</span><span class="sxs-lookup"><span data-stu-id="28719-146">Make this the default host in the group</span></span>|<span data-ttu-id="28719-147">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-147">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-148">Windows 组</span><span class="sxs-lookup"><span data-stu-id="28719-148">Windows group</span></span>|<span data-ttu-id="28719-149">用于控制对此主机与关联的主机实例的访问的 Windows 组。</span><span class="sxs-lookup"><span data-stu-id="28719-149">The Windows group used to control access to this host and associated host instances.</span></span> <span data-ttu-id="28719-150">为默认进程内主机为创建的窗口组*\<计算机名\>* \BizTalk 应用程序用户 （适用于单个服务器 BizTalk Server 安装） 或 *\<域名\>* \BizTalk 应用程序用户 （适用于多个服务器需要使用域组的 BizTalk Server 安装）。</span><span class="sxs-lookup"><span data-stu-id="28719-150">The Window group created for the default in-process host is named either *\<Computer Name\>* \BizTalk Application Users (for a single server BizTalk Server installation) or *\<Domain Name\>* \BizTalk Application Users (for a multiple server BizTalk Server installation, which requires the use of domain groups).</span></span> <span data-ttu-id="28719-151">**注意：***\<计算机名\>* 并*\<域名\>* 都是实际的计算机名称或使用域名的占位符创建组时。  </span><span class="sxs-lookup"><span data-stu-id="28719-151">**Note:**  *\<Computer Name\>* and *\<Domain Name\>* are placeholders for the actual computer name or domain name used when the group was created.</span></span> <br /><br /> <span data-ttu-id="28719-152">如果为此主机创建新的组，则它必须具有本主题中所述的权限[主机组](http://go.microsoft.com/fwlink/?LinkId=208803)(http://go.microsoft.com/fwlink/?LinkId=208803) BizTalk Server 文档中。</span><span class="sxs-lookup"><span data-stu-id="28719-152">If a new group is created for this host then it must have the privileges described in the topic [Host Groups](http://go.microsoft.com/fwlink/?LinkId=208803) (http://go.microsoft.com/fwlink/?LinkId=208803) in the BizTalk Server documentation.</span></span>|  

### <a name="create-instances-of-the-biztalk-server-send-and-receive-hosts"></a><span data-ttu-id="28719-153">创建实例的 BizTalk Server 发送和接收主机</span><span class="sxs-lookup"><span data-stu-id="28719-153">Create Instances of the BizTalk Server Send and Receive Hosts</span></span>  
 <span data-ttu-id="28719-154">按照 BizTalk Server 文档主题中的步骤[如何将主机实例添加](http://go.microsoft.com/fwlink/?LinkId=208596)(http://go.microsoft.com/fwlink/?LinkId=208596)创建并启动 BizTalk Server"发送"主机的实例。</span><span class="sxs-lookup"><span data-stu-id="28719-154">Follow the steps in the BizTalk Server Documentation topic [How to Add a Host Instance](http://go.microsoft.com/fwlink/?LinkId=208596) (http://go.microsoft.com/fwlink/?LinkId=208596) to create and start instances of the BizTalk Server “Send” host.</span></span> <span data-ttu-id="28719-155">配置要在 BizTalk Server 组中每个 BizTalk Server 上运行并配置每个主机实例使用以下属性值的"发送"主机实例：</span><span class="sxs-lookup"><span data-stu-id="28719-155">Configure an instance of the “Send” host to run on each BizTalk Server in the BizTalk Server group and configure each host instance with the following property values:</span></span>  

|<span data-ttu-id="28719-156">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-156">Property</span></span>|<span data-ttu-id="28719-157">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-157">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-158">**主机名**</span><span class="sxs-lookup"><span data-stu-id="28719-158">**Host name**</span></span>|<span data-ttu-id="28719-159">选择**TxHost**下拉列表中下一步**主机名**。</span><span class="sxs-lookup"><span data-stu-id="28719-159">Select **TxHost** from the drop-down list next to **Host name**.</span></span>|  
|<span data-ttu-id="28719-160">**Server**</span><span class="sxs-lookup"><span data-stu-id="28719-160">**Server**</span></span>|<span data-ttu-id="28719-161">选择 BizTalk Server 将运行此主机实例从下拉列表旁边**Server**。</span><span class="sxs-lookup"><span data-stu-id="28719-161">Select the BizTalk Server that will run this host instance from the drop-down list next to **Server**.</span></span>|  
|<span data-ttu-id="28719-162">**登录**</span><span class="sxs-lookup"><span data-stu-id="28719-162">**Logon**</span></span>|<span data-ttu-id="28719-163">1.单击**配置**按钮以显示**登录凭据**对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-163">1.  Click the **Configure** button to display the **Logon Credentials** dialog box.</span></span><br /><span data-ttu-id="28719-164">2.在中**登录凭据**对话框中的指定属性中输入以下值：</span><span class="sxs-lookup"><span data-stu-id="28719-164">2.  In the **Logon Credentials** dialog box enter the following values for the specified properties:</span></span><br />     <span data-ttu-id="28719-165">**属性**</span><span class="sxs-lookup"><span data-stu-id="28719-165">**Property**</span></span><br />     <span data-ttu-id="28719-166">**登录**： 是与此 BizTalk Server 主机关联的 Windows 组的成员的用户帐户的名称。</span><span class="sxs-lookup"><span data-stu-id="28719-166">**Logon**: Name of user account that is a member of the Windows group associated with this BizTalk Server host.</span></span><br />     <span data-ttu-id="28719-167">**密码**： 在指定的用户帐户密码**登录**文本框中。</span><span class="sxs-lookup"><span data-stu-id="28719-167">**Password**: Password for the user account specified in the **Logon** textbox.</span></span><br /><span data-ttu-id="28719-168">3.单击**确定**以关闭**登录凭据**对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-168">3.  Click **OK** to close the **Logon Credentials** dialog box.</span></span>|  
|<span data-ttu-id="28719-169">**禁用主机实例启动。**</span><span class="sxs-lookup"><span data-stu-id="28719-169">**Disable host instance from starting.**</span></span>|<span data-ttu-id="28719-170">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-170">Ensure that this box is un-checked.</span></span>|  

 <span data-ttu-id="28719-171">在创建主机实例，右键单击主机实例，然后选择**启动**从上下文菜单。</span><span class="sxs-lookup"><span data-stu-id="28719-171">After creating the host instance, right-click on the host instance and select **Start** from the context menu.</span></span>  

 <span data-ttu-id="28719-172">重复创建"发送"主机实例创建"接收"主机实例时所遵循的步骤。</span><span class="sxs-lookup"><span data-stu-id="28719-172">Repeat the steps that you followed when creating the “Send” host instances to create “Receive” host instances.</span></span> <span data-ttu-id="28719-173">配置要在 BizTalk Server 组中每个 BizTalk Server 上运行并配置每个主机实例使用以下属性值的"接收"主机实例：</span><span class="sxs-lookup"><span data-stu-id="28719-173">Configure an instance of the “Receive” host to run on each BizTalk Server in the BizTalk Server group and configure each host instance with the following property values:</span></span>  

|<span data-ttu-id="28719-174">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-174">Property</span></span>|<span data-ttu-id="28719-175">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-175">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-176">主机名</span><span class="sxs-lookup"><span data-stu-id="28719-176">Host name</span></span>|<span data-ttu-id="28719-177">选择**RxHost**下拉列表中下一步**主机名**。</span><span class="sxs-lookup"><span data-stu-id="28719-177">Select **RxHost** from the drop-down list next to **Host name**.</span></span>|  
|<span data-ttu-id="28719-178">“服务器”</span><span class="sxs-lookup"><span data-stu-id="28719-178">Server</span></span>|<span data-ttu-id="28719-179">选择 BizTalk Server 将运行此主机实例从下拉列表旁边**Server**。</span><span class="sxs-lookup"><span data-stu-id="28719-179">Select the BizTalk Server that will run this host instance from the drop-down list next to **Server**.</span></span>|  
|<span data-ttu-id="28719-180">登录</span><span class="sxs-lookup"><span data-stu-id="28719-180">Logon</span></span>|<span data-ttu-id="28719-181">1.单击**配置**按钮以显示**登录凭据**对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-181">1.  Click the **Configure** button to display the **Logon Credentials** dialog box.</span></span><br /><span data-ttu-id="28719-182">2.在中**登录凭据**对话框中的指定属性中输入以下值：</span><span class="sxs-lookup"><span data-stu-id="28719-182">2.  In the **Logon Credentials** dialog box enter the following values for the specified properties:</span></span><br />     <span data-ttu-id="28719-183">**属性**</span><span class="sxs-lookup"><span data-stu-id="28719-183">**Property**</span></span><br />     <span data-ttu-id="28719-184">**登录**： 是与此 BizTalk Server 主机关联的 Windows 组的成员的用户帐户的名称。</span><span class="sxs-lookup"><span data-stu-id="28719-184">**Logon**: Name of user account that is a member of the Windows group associated with this BizTalk Server host.</span></span><br />     <span data-ttu-id="28719-185">**密码**： 在指定的用户帐户密码**登录**文本框中。</span><span class="sxs-lookup"><span data-stu-id="28719-185">**Password**: Password for the user account specified in the **Logon** textbox.</span></span><br /><span data-ttu-id="28719-186">3.单击**确定**以关闭登录凭据对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-186">3.  Click **OK** to close the Logon Credentials dialog box.</span></span>|  
|<span data-ttu-id="28719-187">禁止主机实例启动</span><span class="sxs-lookup"><span data-stu-id="28719-187">Disable host instance from starting</span></span>|<span data-ttu-id="28719-188">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-188">Ensure that this box is un-checked.</span></span>|  

 <span data-ttu-id="28719-189">在创建主机实例，右键单击主机实例，然后选择**启动**从上下文菜单。</span><span class="sxs-lookup"><span data-stu-id="28719-189">After creating the host instance, right-click on the host instance and select **Start** from the context menu.</span></span>  

### <a name="create-a-biztalk-server-receive-port"></a><span data-ttu-id="28719-190">创建 BizTalk Server 接收端口</span><span class="sxs-lookup"><span data-stu-id="28719-190">Create a BizTalk Server Receive Port</span></span>  
 <span data-ttu-id="28719-191">按照本主题中的步骤[如何创建接收端口](http://go.microsoft.com/fwlink/?LinkID=154843)(http://go.microsoft.com/fwlink/?LinkID=154843)中创建一个单向接收端口的 BizTalk Server 文档。</span><span class="sxs-lookup"><span data-stu-id="28719-191">Follow the steps in the topic [How to Create a Receive Port](http://go.microsoft.com/fwlink/?LinkID=154843) (http://go.microsoft.com/fwlink/?LinkID=154843) in the BizTalk Server documentation to create a One-Way Receive Port.</span></span> <span data-ttu-id="28719-192">创建接收端口时，将保留默认值，除非所有属性下, 表中所述：</span><span class="sxs-lookup"><span data-stu-id="28719-192">When creating the Receive port, leave all properties at default values except as noted in the table below:</span></span>  

|<span data-ttu-id="28719-193">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-193">Property</span></span>|<span data-ttu-id="28719-194">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-194">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-195">General\Name</span><span class="sxs-lookup"><span data-stu-id="28719-195">General\Name</span></span>|<span data-ttu-id="28719-196">BTSLoadTestMessaging.OneWay.ReceivePort</span><span class="sxs-lookup"><span data-stu-id="28719-196">BTSLoadTestMessaging.OneWay.ReceivePort</span></span>|  
|<span data-ttu-id="28719-197">General\Port 类型</span><span class="sxs-lookup"><span data-stu-id="28719-197">General\Port Type</span></span>|<span data-ttu-id="28719-198">单向</span><span class="sxs-lookup"><span data-stu-id="28719-198">One-Way</span></span>|  
|<span data-ttu-id="28719-199">General\Authentication</span><span class="sxs-lookup"><span data-stu-id="28719-199">General\Authentication</span></span>|<span data-ttu-id="28719-200">不进行身份验证</span><span class="sxs-lookup"><span data-stu-id="28719-200">No authentication</span></span>|  
|<span data-ttu-id="28719-201">失败消息 General\Enable 路由功能</span><span class="sxs-lookup"><span data-stu-id="28719-201">General\Enable routing for failed messages</span></span>|<span data-ttu-id="28719-202">确保未选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-202">Ensure that this box is un-checked.</span></span>|  
|<span data-ttu-id="28719-203">General\Description</span><span class="sxs-lookup"><span data-stu-id="28719-203">General\Description</span></span>|<span data-ttu-id="28719-204">将保留为空</span><span class="sxs-lookup"><span data-stu-id="28719-204">Leave blank</span></span>|  
|<span data-ttu-id="28719-205">入站映射</span><span class="sxs-lookup"><span data-stu-id="28719-205">Inbound Maps</span></span>|<span data-ttu-id="28719-206">InclusionThresholdSetting</span><span class="sxs-lookup"><span data-stu-id="28719-206">None</span></span>|  
|<span data-ttu-id="28719-207">跟踪</span><span class="sxs-lookup"><span data-stu-id="28719-207">Tracking</span></span>|<span data-ttu-id="28719-208">确保取消选中所有框。</span><span class="sxs-lookup"><span data-stu-id="28719-208">Ensure that all boxes are un-checked.</span></span>|  
|<span data-ttu-id="28719-209">接收位置</span><span class="sxs-lookup"><span data-stu-id="28719-209">Receive Locations</span></span>|<span data-ttu-id="28719-210">单击**新建**，这将显示**接收位置属性**对话框中，应进行配置，如下面部分中所述**创建 BizTalk Server 接收位置**.</span><span class="sxs-lookup"><span data-stu-id="28719-210">Click **New**, this will display the **Receive Location Properties** dialog box which should be configured as described in the following section, **Create a BizTalk Server Receive Location**.</span></span>|  

### <a name="create-a-biztalk-server-receive-location"></a><span data-ttu-id="28719-211">创建 BizTalk Server 接收位置</span><span class="sxs-lookup"><span data-stu-id="28719-211">Create a BizTalk Server Receive Location</span></span>  
 <span data-ttu-id="28719-212">在中**接收位置属性**对话框显示创建 BizTalk Server 接收端口时，将应用指定的属性值：</span><span class="sxs-lookup"><span data-stu-id="28719-212">In the **Receive Location Properties** dialog box displayed while creating the BizTalk Server Receive port, apply the specified property values:</span></span>  

|<span data-ttu-id="28719-213">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-213">Property</span></span>|<span data-ttu-id="28719-214">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-214">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-215">名称：</span><span class="sxs-lookup"><span data-stu-id="28719-215">Name:</span></span>|<span data-ttu-id="28719-216">BTSLoadTest.Messaging.OneWay.WCF Customer.ReceiveLocation</span><span class="sxs-lookup"><span data-stu-id="28719-216">BTSLoadTest.Messaging.OneWay.WCF-Customer.ReceiveLocation</span></span>|  
|<span data-ttu-id="28719-217">接收处理程序：</span><span class="sxs-lookup"><span data-stu-id="28719-217">Receive handler:</span></span>|<span data-ttu-id="28719-218">RxHost</span><span class="sxs-lookup"><span data-stu-id="28719-218">RxHost</span></span>|  
|<span data-ttu-id="28719-219">接收管道：</span><span class="sxs-lookup"><span data-stu-id="28719-219">Receive pipeline:</span></span>|<span data-ttu-id="28719-220">PassThruReceive</span><span class="sxs-lookup"><span data-stu-id="28719-220">PassThruReceive</span></span>|  
|<span data-ttu-id="28719-221">说明:</span><span class="sxs-lookup"><span data-stu-id="28719-221">Description:</span></span>|<span data-ttu-id="28719-222">将此留空</span><span class="sxs-lookup"><span data-stu-id="28719-222">Leave this blank</span></span>|  
|<span data-ttu-id="28719-223">类型：</span><span class="sxs-lookup"><span data-stu-id="28719-223">Type:</span></span>|<span data-ttu-id="28719-224">选择**WCF 自定义**从下拉列表，再单击**配置**按钮，这将显示**Wcf-custom 传输属性**应为对话框下面部分中所述配置**配置 WCF 自定义接收传输**。</span><span class="sxs-lookup"><span data-stu-id="28719-224">Select **WCF-Custom** from the drop-down list and then click the **Configure** button, this will display the **WCF-Custom Transport Properties** dialog box which should be configured as described in the following section, **Configure the WCF-Custom Receive Transport**.</span></span>|  

### <a name="configure-the-wcf-custom-receive-transport"></a><span data-ttu-id="28719-225">配置 WCF 自定义接收传输</span><span class="sxs-lookup"><span data-stu-id="28719-225">Configure the WCF-Custom Receive Transport</span></span>  
 <span data-ttu-id="28719-226">在中**Wcf-custom 传输属性**对话框显示创建 BizTalk Server 接收位置时，将所有属性保留为默认值除外下, 表中所述：</span><span class="sxs-lookup"><span data-stu-id="28719-226">In the **WCF-Custom Transport Properties** dialog box displayed while creating the BizTalk Server Receive location, leave all properties at default values except as noted in the table below:</span></span>  

|<span data-ttu-id="28719-227">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-227">Property</span></span>|<span data-ttu-id="28719-228">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-228">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-229">General\Address (URI)</span><span class="sxs-lookup"><span data-stu-id="28719-229">General\Address (URI)</span></span>|<span data-ttu-id="28719-230">net.tcp: //localhost: 8123/btsloadtest</span><span class="sxs-lookup"><span data-stu-id="28719-230">net.tcp://localhost:8123/btsloadtest</span></span>|  
|<span data-ttu-id="28719-231">Binding\Binding 类型</span><span class="sxs-lookup"><span data-stu-id="28719-231">Binding\Binding Type</span></span>|<span data-ttu-id="28719-232">netTcpbinding</span><span class="sxs-lookup"><span data-stu-id="28719-232">netTcpbinding</span></span>|  
|<span data-ttu-id="28719-233">Binding\NetTcpBindingElement\listenBacklog</span><span class="sxs-lookup"><span data-stu-id="28719-233">Binding\NetTcpBindingElement\listenBacklog</span></span>|<span data-ttu-id="28719-234">400</span><span class="sxs-lookup"><span data-stu-id="28719-234">400</span></span>|  
|<span data-ttu-id="28719-235">Binding\NetTcpBindingElement\maxConnections</span><span class="sxs-lookup"><span data-stu-id="28719-235">Binding\NetTcpBindingElement\maxConnections</span></span>|<span data-ttu-id="28719-236">400</span><span class="sxs-lookup"><span data-stu-id="28719-236">400</span></span>|  
|<span data-ttu-id="28719-237">Binding\Security\NetTcpSecurityElement\mode</span><span class="sxs-lookup"><span data-stu-id="28719-237">Binding\Security\NetTcpSecurityElement\mode</span></span>|<span data-ttu-id="28719-238">InclusionThresholdSetting</span><span class="sxs-lookup"><span data-stu-id="28719-238">None</span></span>|  
|<span data-ttu-id="28719-239">Behavior\ServiceBehavior\serviceThrottling\ServiceThrottlingElement**注意：** 若要将 serviceThrottling 行为添加到的行为，右键单击 ServiceBehavior 列表单击**添加扩展**，选择**serviceThrottling**从列表中的行为扩展，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="28719-239">Behavior\ServiceBehavior\serviceThrottling\ServiceThrottlingElement **Note:**  To add the serviceThrottling behavior to the list of behaviors, right-click ServiceBehavior, click **Add Extension**, select **serviceThrottling** from the list of behavior extensions and then click **OK**.</span></span>|<span data-ttu-id="28719-240">设置**ServiceThrottlingElement**属性设置为以下值：</span><span class="sxs-lookup"><span data-stu-id="28719-240">Set the **ServiceThrottlingElement** properties to the following values:</span></span><br /><br /> <span data-ttu-id="28719-241">-   **maxConcurrentCalls** 400</span><span class="sxs-lookup"><span data-stu-id="28719-241">-   **maxConcurrentCalls** 400</span></span><br /><span data-ttu-id="28719-242">-   **maxConcurrentInstances** 400</span><span class="sxs-lookup"><span data-stu-id="28719-242">-   **maxConcurrentInstances** 400</span></span><br /><span data-ttu-id="28719-243">-   **maxConcurrentSessions** 400</span><span class="sxs-lookup"><span data-stu-id="28719-243">-   **maxConcurrentSessions** 400</span></span>|  
|<span data-ttu-id="28719-244">Behavior\ServiceBehavior\serviceDebug\ServiceDebugElement**注意：** 若要将 serviceDebug 行为添加到的行为，右键单击 ServiceBehavior 列表单击**添加扩展**，选择**serviceDebug**从列表中的行为扩展，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="28719-244">Behavior\ServiceBehavior\serviceDebug\ServiceDebugElement **Note:**  To add the serviceDebug behavior to the list of behaviors, right-click ServiceBehavior, click **Add Extension**, select **serviceDebug** from the list of behavior extensions, and then click **OK**.</span></span>|<span data-ttu-id="28719-245">保留的列表**ServiceDebugElement**属性的默认值 （空） 的以下属性除外的应更改为值为 True:</span><span class="sxs-lookup"><span data-stu-id="28719-245">Leave the list of **ServiceDebugElement** properties at their default values (empty) except for the following properties, which should be changed to a value of True:</span></span><br /><br /> <span data-ttu-id="28719-246">-   **httpHelpPageEnabled** ，则返回 True</span><span class="sxs-lookup"><span data-stu-id="28719-246">-   **httpHelpPageEnabled** True</span></span><br /><span data-ttu-id="28719-247">-   **httpsHelpPageEnabled** ，则返回 True</span><span class="sxs-lookup"><span data-stu-id="28719-247">-   **httpsHelpPageEnabled** True</span></span><br /><span data-ttu-id="28719-248">-   **includeExceptionDetailInFaults** ，则返回 True</span><span class="sxs-lookup"><span data-stu-id="28719-248">-   **includeExceptionDetailInFaults** True</span></span>|  

 <span data-ttu-id="28719-249">单击**确定**以关闭 Wcf-custom 传输属性对话框中，然后单击**确定**以关闭接收位置属性对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-249">Click **OK** to close the WCF-Custom Transport Properties dialog box and then click **OK** again to close the Receive Location Properties dialog box.</span></span>  

### <a name="create-a-biztalk-server-send-port"></a><span data-ttu-id="28719-250">创建 BizTalk Server 发送端口</span><span class="sxs-lookup"><span data-stu-id="28719-250">Create a BizTalk Server Send Port</span></span>  
 <span data-ttu-id="28719-251">按照本主题中的步骤[如何创建发送端口](http://go.microsoft.com/fwlink/?LinkID=154845)(http://go.microsoft.com/fwlink/?LinkID=154845)中创建的 BizTalk Server 文档**静态单向**发送端口。</span><span class="sxs-lookup"><span data-stu-id="28719-251">Follow the steps in the topic [How to Create a Send Port](http://go.microsoft.com/fwlink/?LinkID=154845) (http://go.microsoft.com/fwlink/?LinkID=154845) in the BizTalk Server documentation to create a **Static One-Way** Send Port.</span></span> <span data-ttu-id="28719-252">创建发送端口时，将保留默认值，除非所有属性下, 表中所述：</span><span class="sxs-lookup"><span data-stu-id="28719-252">When creating the Send port, leave all properties at default values except as noted in the table below:</span></span>  

|<span data-ttu-id="28719-253">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-253">Property</span></span>|<span data-ttu-id="28719-254">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-254">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-255">General\Name</span><span class="sxs-lookup"><span data-stu-id="28719-255">General\Name</span></span>|<span data-ttu-id="28719-256">BTSLoadTest.Messaging.Send.WCF 自定义</span><span class="sxs-lookup"><span data-stu-id="28719-256">BTSLoadTest.Messaging.Send.WCF-Custom</span></span>|  
|<span data-ttu-id="28719-257">General\Send 处理程序</span><span class="sxs-lookup"><span data-stu-id="28719-257">General\Send handler</span></span>|<span data-ttu-id="28719-258">TxHost</span><span class="sxs-lookup"><span data-stu-id="28719-258">TxHost</span></span>|  
|<span data-ttu-id="28719-259">General\Send 管道</span><span class="sxs-lookup"><span data-stu-id="28719-259">General\Send pipeline</span></span>|<span data-ttu-id="28719-260">PassThruTransmit</span><span class="sxs-lookup"><span data-stu-id="28719-260">PassThruTransmit</span></span>|  
|<span data-ttu-id="28719-261">Filters\Name</span><span class="sxs-lookup"><span data-stu-id="28719-261">Filters\Name</span></span>|<span data-ttu-id="28719-262">BTS.ReceivePortName</span><span class="sxs-lookup"><span data-stu-id="28719-262">BTS.ReceivePortName</span></span>|  
|<span data-ttu-id="28719-263">Filters\Operator</span><span class="sxs-lookup"><span data-stu-id="28719-263">Filters\Operator</span></span>|==|  
|<span data-ttu-id="28719-264">Filters\Value</span><span class="sxs-lookup"><span data-stu-id="28719-264">Filters\Value</span></span>|<span data-ttu-id="28719-265">BTSLoadTest.Messaging.OneWay.ReceivePort</span><span class="sxs-lookup"><span data-stu-id="28719-265">BTSLoadTest.Messaging.OneWay.ReceivePort</span></span>|  
|<span data-ttu-id="28719-266">通过 Filters\Group</span><span class="sxs-lookup"><span data-stu-id="28719-266">Filters\Group by</span></span>|<span data-ttu-id="28719-267">并**注意：** 这些属性配置了正确的值，如果筛选器应显示为`BTS.ReceivePortName == BTSLoadTest.Messaging.OneWay.ReceivePort`b 中的发送端口属性对话框的筛选器页底部所示ox。</span><span class="sxs-lookup"><span data-stu-id="28719-267">And **Note:**  If these properties are configured with the correct values, the filter should be displayed as                                              `BTS.ReceivePortName == BTSLoadTest.Messaging.OneWay.ReceivePort` as seen toward the bottom of the Filters page of the Send Port Properties dialog box.</span></span> <span data-ttu-id="28719-268">由于应用此筛选器，此发送端口订阅通过名为 BTSLoadTest.Messaging.OneWay.ReceivePort 的接收端口的 BizTalk Server 接收的任何消息。</span><span class="sxs-lookup"><span data-stu-id="28719-268">As a result of applying this filter, this Send port subscribes to any messages received by BizTalk Server via the Receive Port named BTSLoadTest.Messaging.OneWay.ReceivePort.</span></span>|  
|<span data-ttu-id="28719-269">跟踪</span><span class="sxs-lookup"><span data-stu-id="28719-269">Tracking</span></span>|<span data-ttu-id="28719-270">确保取消选中所有框。</span><span class="sxs-lookup"><span data-stu-id="28719-270">Ensure that all boxes are un-checked.</span></span>|  
|<span data-ttu-id="28719-271">General\Type</span><span class="sxs-lookup"><span data-stu-id="28719-271">General\Type</span></span>|<span data-ttu-id="28719-272">选择**WCF 自定义**从下拉列表，再单击**配置**按钮，这将显示**Wcf-custom 传输属性**应为对话框下面部分中所述配置**配置 WCF 自定义发送传输**。</span><span class="sxs-lookup"><span data-stu-id="28719-272">Select **WCF-Custom** from the drop-down list and then click the **Configure** button, this will display the **WCF-Custom Transport Properties** dialog box which should be configured as described in the following section, **Configure the WCF-Custom Send Transport**.</span></span>|  

### <a name="configure-the-wcf-custom-send-transport"></a><span data-ttu-id="28719-273">配置 Wcf-custom 发送传输</span><span class="sxs-lookup"><span data-stu-id="28719-273">Configure the WCF-Custom Send Transport</span></span>  
 <span data-ttu-id="28719-274">在中**Wcf-custom 传输属性**对话框显示创建 BizTalk Server 发送端口时，将所有属性保留为默认值除外下, 表中所述：</span><span class="sxs-lookup"><span data-stu-id="28719-274">In the **WCF-Custom Transport Properties** dialog box displayed while creating the BizTalk Server Send Port, leave all properties at default values except as noted in the table below:</span></span>  

|<span data-ttu-id="28719-275">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-275">Property</span></span>|<span data-ttu-id="28719-276">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-276">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="28719-277">General\Address (URI)</span><span class="sxs-lookup"><span data-stu-id="28719-277">General\Address (URI)</span></span>|<span data-ttu-id="28719-278">net.tcp://*\<计算机名\>*: 2001年/TCP1**重要说明：***\<计算机的名称\>* 是一个占位符有关用于托管 IndigoService.exe，旨在使用通过 WCF 发送的消息的实际计算机名称。  </span><span class="sxs-lookup"><span data-stu-id="28719-278">net.tcp://*\<Computer Name\>*:2001/TCP1 **Important:**  *\<Computer Name\>* is a placeholder for the actual computer name used to host IndigoService.exe, which is designed to consume messages sent via WCF.</span></span> <span data-ttu-id="28719-279">由于 IndigoService.exe 需要很少的资源，它通常是完全可以接受的 BizTalk Server 组数据库使用 SQL Server 计算机上运行 IndigoService.exe。</span><span class="sxs-lookup"><span data-stu-id="28719-279">Because IndigoService.exe requires very little resources, it is often perfectly acceptable to run IndigoService.exe on the SQL Server computer used for the BizTalk Server group databases.</span></span> <span data-ttu-id="28719-280">属于 BizTalk 基准向导，可在 IndigoService.exe [BizTalk 基准向导](http://go.microsoft.com/fwlink/?LinkID=186347)(http://go.microsoft.com/fwlink/?LinkID=186347)。</span><span class="sxs-lookup"><span data-stu-id="28719-280">IndigoService.exe is part of the BizTalk Benchmark Wizard, which is available at [BizTalk Benchmark Wizard](http://go.microsoft.com/fwlink/?LinkID=186347) (http://go.microsoft.com/fwlink/?LinkID=186347).</span></span>|  
|<span data-ttu-id="28719-281">Binding\Binding 类型</span><span class="sxs-lookup"><span data-stu-id="28719-281">Binding\Binding Type</span></span>|<span data-ttu-id="28719-282">**customBinding**</span><span class="sxs-lookup"><span data-stu-id="28719-282">**customBinding**</span></span>|  

 <span data-ttu-id="28719-283">与大多数 WCF 自定义绑定类型一样**customBinding**绑定类型公开多个属性，应设置为以下值：</span><span class="sxs-lookup"><span data-stu-id="28719-283">As with most of the WCF-Custom Binding Types, the **customBinding** Binding type exposes several properties, which should be set to the following values:</span></span>  

1.  <span data-ttu-id="28719-284">下**绑定**部分中没有**CustomBindingElement**带有关联属性**配置**部分。</span><span class="sxs-lookup"><span data-stu-id="28719-284">Under the **Binding** section there is a **CustomBindingElement** property with an associated **Configuration** section.</span></span> <span data-ttu-id="28719-285">保留的配置部分中的所有值**CustomBindingElement**属性的默认值。</span><span class="sxs-lookup"><span data-stu-id="28719-285">Leave all of the values in the Configuration section for the **CustomBindingElement** property at their default values.</span></span>  

2.  <span data-ttu-id="28719-286">然后在**CustomBindingElement**右键单击**textMessageEncoding** ，然后选择**删除扩展 (Del)**。</span><span class="sxs-lookup"><span data-stu-id="28719-286">Then under **CustomBindingElement** right-click **textMessageEncoding** and select **Remove extension (Del)**.</span></span> <span data-ttu-id="28719-287">同样，用鼠标右键单击**httpTransport** ，然后选择**删除扩展 (Del)**。</span><span class="sxs-lookup"><span data-stu-id="28719-287">Likewise, right-click **httpTransport** and select **Remove extension (Del)**.</span></span>  

3.  <span data-ttu-id="28719-288">现在，右键单击**CustomBindingElement** ，然后选择**添加扩展项**以显示**选择绑定元素扩展**对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-288">Now right-click **CustomBindingElement** and select **Add extension Ins** to display the **Select Binding Element Extension** dialog box.</span></span>  

4.  <span data-ttu-id="28719-289">选择**binaryMessageEncoding**然后单击**确定**若要添加**binaryMessageEncoding**元素扩展。</span><span class="sxs-lookup"><span data-stu-id="28719-289">Select **binaryMessageEncoding** and click **OK** to add the **binaryMessageEncoding** element extension.</span></span> <span data-ttu-id="28719-290">重复步骤以显示**选择绑定元素扩展**对话框并滚动下可用的元素扩展的列表，直到看到**tcpTransport**元素扩展，选择**tcpTransport**然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="28719-290">Repeat the steps to display the **Select Binding Element Extension** dialog box and scroll down the list of available element extensions until you see the **tcpTransport** element extension, select **tcpTransport** and click **OK**.</span></span>  

5.  <span data-ttu-id="28719-291">下**CustomBindingElement**选择**tcpTransport**元素和中的配置节**tcpTransport**，将所有属性保留为默认值为除外下表中所述：</span><span class="sxs-lookup"><span data-stu-id="28719-291">Under **CustomBindingElement** select the **tcpTransport** element and in the Configuration section for **tcpTransport**, leave all properties at default values except as noted in the following table:</span></span>  

    |<span data-ttu-id="28719-292">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-292">Property</span></span>|<span data-ttu-id="28719-293">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-293">Value</span></span>|  
    |--------------|-----------|  
    |<span data-ttu-id="28719-294">connectionBufferSize</span><span class="sxs-lookup"><span data-stu-id="28719-294">connectionBufferSize</span></span>|<span data-ttu-id="28719-295">2097152</span><span class="sxs-lookup"><span data-stu-id="28719-295">2097152</span></span>|  
    |<span data-ttu-id="28719-296">maxBufferSize</span><span class="sxs-lookup"><span data-stu-id="28719-296">maxBufferSize</span></span>|<span data-ttu-id="28719-297">2097152</span><span class="sxs-lookup"><span data-stu-id="28719-297">2097152</span></span>|  
    |<span data-ttu-id="28719-298">maxPendingAccepts</span><span class="sxs-lookup"><span data-stu-id="28719-298">maxPendingAccepts</span></span>|<span data-ttu-id="28719-299">400</span><span class="sxs-lookup"><span data-stu-id="28719-299">400</span></span>|  
    |<span data-ttu-id="28719-300">maxPendingConnections</span><span class="sxs-lookup"><span data-stu-id="28719-300">maxPendingConnections</span></span>|<span data-ttu-id="28719-301">400</span><span class="sxs-lookup"><span data-stu-id="28719-301">400</span></span>|  
    |<span data-ttu-id="28719-302">listenBacklog</span><span class="sxs-lookup"><span data-stu-id="28719-302">listenBacklog</span></span>|<span data-ttu-id="28719-303">400</span><span class="sxs-lookup"><span data-stu-id="28719-303">400</span></span>|  
    |<span data-ttu-id="28719-304">maxBufferPoolSize</span><span class="sxs-lookup"><span data-stu-id="28719-304">maxBufferPoolSize</span></span>|<span data-ttu-id="28719-305">2097152</span><span class="sxs-lookup"><span data-stu-id="28719-305">2097152</span></span>|  
    |<span data-ttu-id="28719-306">MaxReceivedMessageSize</span><span class="sxs-lookup"><span data-stu-id="28719-306">maxReceivedMessageSize</span></span>|<span data-ttu-id="28719-307">2097152</span><span class="sxs-lookup"><span data-stu-id="28719-307">2097152</span></span>|  

6.  <span data-ttu-id="28719-308">下**tcpTransport**元素选择**ConnectionPoolSettings**元素，并保留默认值的所有属性都值除**maxOutboundConnectionsPerEndpoint**应为 400 的值已更改的属性。</span><span class="sxs-lookup"><span data-stu-id="28719-308">Under the **tcpTransport** element select the **ConnectionPoolSettings** element and leave all properties at default values except for the **maxOutboundConnectionsPerEndpoint** property, which should be changed to a value of 400.</span></span>  

7.  <span data-ttu-id="28719-309">单击**确定**以关闭 Wcf-custom 传输属性对话框中，然后单击**确定**以关闭 BTSLoadTest.Messaging.Send.WCF Custom-发送端口属性对话框。</span><span class="sxs-lookup"><span data-stu-id="28719-309">Click **OK** to close the WCF-Custom Transport Properties dialog box, then click **OK** again to close the BTSLoadTest.Messaging.Send.WCF-Custom – Send Port Properties dialog box.</span></span>  

### <a name="configure-a-computer-to-consume-messages-sent-by-the-biztalk-server-send-port"></a><span data-ttu-id="28719-310">将计算机配置为使用由 BizTalk Server 发送端口发送的消息</span><span class="sxs-lookup"><span data-stu-id="28719-310">Configure a Computer to Consume Messages Sent by the BizTalk Server Send Port</span></span>  
 <span data-ttu-id="28719-311">如前文所述，IndigoService.exe 旨在使用通过 WCF 发送的消息。</span><span class="sxs-lookup"><span data-stu-id="28719-311">As described earlier, the IndigoService.exe is designed to consume messages sent via WCF.</span></span> <span data-ttu-id="28719-312">属于 BizTalk 基准向导，可在 IndigoService.exe [BizTalk 基准向导](http://go.microsoft.com/fwlink/?LinkID=186347)(http://go.microsoft.com/fwlink/?LinkID=186347)。</span><span class="sxs-lookup"><span data-stu-id="28719-312">IndigoService.exe is part of the BizTalk Benchmark Wizard, which is available at [BizTalk Benchmark Wizard](http://go.microsoft.com/fwlink/?LinkID=186347) (http://go.microsoft.com/fwlink/?LinkID=186347).</span></span> <span data-ttu-id="28719-313">设置和 IndigoService.exe 运行此示例的最简单方法是只需下载中的 BizTalk 基准向导 zip 文件[BizTalk 基准向导下载页](http://go.microsoft.com/fwlink/?LinkID=209100)(http://go.microsoft.com/fwlink/?LinkID=209100)并提取以下 4到你想要运行 IndigoService.exe 的计算机上的文件：</span><span class="sxs-lookup"><span data-stu-id="28719-313">The easiest way to set up and run IndigoService.exe for purposes of this example is to simply download the BizTalk Benchmark Wizard zip file from the [BizTalk BenchMark Wizard download page](http://go.microsoft.com/fwlink/?LinkID=209100) (http://go.microsoft.com/fwlink/?LinkID=209100) and extract the following 4 files onto the computer that you would like to run IndigoService.exe:</span></span>  

1. <span data-ttu-id="28719-314">\IndigoService\bin\Release\IndigoService.exe</span><span class="sxs-lookup"><span data-stu-id="28719-314">\IndigoService\bin\Release\IndigoService.exe</span></span>  

2. <span data-ttu-id="28719-315">\IndigoService\bin\Release\IndigoService.exe.config</span><span class="sxs-lookup"><span data-stu-id="28719-315">\IndigoService\bin\Release\IndigoService.exe.config</span></span>  

3. <span data-ttu-id="28719-316">\IndigoService\bin\Release\Response.xml</span><span class="sxs-lookup"><span data-stu-id="28719-316">\IndigoService\bin\Release\Response.xml</span></span>  

4. <span data-ttu-id="28719-317">\IndigoService\bin\Release\StartIndigoService.bat</span><span class="sxs-lookup"><span data-stu-id="28719-317">\IndigoService\bin\Release\StartIndigoService.bat</span></span>  

   <span data-ttu-id="28719-318">然后，通过双击 StartIndigoService.bat 启动 IndigoService.exe。</span><span class="sxs-lookup"><span data-stu-id="28719-318">Then, start IndigoService.exe by double-clicking on StartIndigoService.bat.</span></span> <span data-ttu-id="28719-319">IndigoService.exe 使用的消息发送到 IndigoService.exe.config 文件中指定的终结点：</span><span class="sxs-lookup"><span data-stu-id="28719-319">IndigoService.exe consumes messages sent to the endpoint specified in the IndigoService.exe.config file:</span></span>  

   <span data-ttu-id="28719-320">\<终结点地址 ="net.tcp: //localhost: 2001年/TCP1"绑定 ="netTcpBinding"bindingConfiguration ="Binding1"名称 ="endpoint1"contract="IndigoService.IServiceTwoWaysVoidNonTransactional"/\></span><span class="sxs-lookup"><span data-stu-id="28719-320">\<endpoint address="net.tcp://localhost:2001/TCP1"             binding="netTcpBinding"             bindingConfiguration="Binding1"             name="endpoint1"             contract="IndigoService.IServiceTwoWaysVoidNonTransactional" /\></span></span>  

   <span data-ttu-id="28719-321">这就是原因发送端口地址配置与一个地址 (URI) 的 net.tcp://*\<计算机名\>*: 2001年/TCP1</span><span class="sxs-lookup"><span data-stu-id="28719-321">This is why the Send Port Address is configured with an Address (URI) of net.tcp://*\<Computer Name\>*:2001/TCP1</span></span>  

   <span data-ttu-id="28719-322">由于 IndigoService.exe 需要很少的资源，它通常是完全可以接受的 BizTalk Server 数据库使用 SQL Server 计算机上运行 IndigoService.exe。</span><span class="sxs-lookup"><span data-stu-id="28719-322">Because IndigoService.exe requires very little resources, it is often perfectly acceptable to run IndigoService.exe on the SQL Server computer used for the BizTalk Server databases.</span></span>  

### <a name="disable-tracking-and-throttling-for-the-biztalk-server-group"></a><span data-ttu-id="28719-323">禁用跟踪和 BizTalk Server 组的限制</span><span class="sxs-lookup"><span data-stu-id="28719-323">Disable Tracking and Throttling for the BizTalk Server Group</span></span>  
 <span data-ttu-id="28719-324">若要确定系统，这两个消息的绝对最大可承受吞吐量跟踪和阻止功能之前，应该禁用从负载测试。</span><span class="sxs-lookup"><span data-stu-id="28719-324">In order to determine the absolute maximum sustainable throughput of the system, both message Tracking and Throttling should be disabled before beginning load testing.</span></span> <span data-ttu-id="28719-325">这可以通过执行以下步骤使用在 BizTalk Server 管理控制台：</span><span class="sxs-lookup"><span data-stu-id="28719-325">This can be done using the BizTalk Server Administration console by following these steps:</span></span>  

1. <span data-ttu-id="28719-326">启动 BizTalk Server 管理控制台。</span><span class="sxs-lookup"><span data-stu-id="28719-326">Launch the BizTalk Server Administration console.</span></span> <span data-ttu-id="28719-327">单击**启动**，依次指向**所有程序**，指向**BizTalk Server 2010** ，然后单击**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="28719-327">Click **Start**, point to **All Programs**, point to **BizTalk Server 2010** and then click **BizTalk Server Administration**.</span></span>  

2. <span data-ttu-id="28719-328">下**BizTalk Server 管理**中，选择你的 BizTalk 组，如果它列出或如果未列出，请右键单击**BizTalk Server 管理**，选择**连接到现有组**，输入旁边存储 BizTalk 组的 BizTalk Server 管理数据库的 SQL Server 名称**SQL Server 名称：**，输入名称为 BizTalk 组的管理数据库名称旁边**数据库名称：** ，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="28719-328">Under **BizTalk Server Administration**, select your BizTalk Group if it is listed or if it is not listed, right-click **BizTalk Server Administration**, select **Connect to Existing Group**, enter the SQL Server name that houses the BizTalk Group’s BizTalk Server Management database next to **SQL Server name:**, enter the name of the BizTalk Group’s management database name next to **Database name:** and then click **OK**.</span></span>  

3. <span data-ttu-id="28719-329">右键单击 BizTalk 组节点并选择**设置**以显示**BizTalk 设置仪表板**。</span><span class="sxs-lookup"><span data-stu-id="28719-329">Right-click the BizTalk Group node and select **Settings** to display the **BizTalk Settings Dashboard**.</span></span>  

4. <span data-ttu-id="28719-330">单击此项可选择**主机**BizTalk 设置仪表板的左侧窗格中。</span><span class="sxs-lookup"><span data-stu-id="28719-330">Click to select **Hosts** in the left hand pane of the BizTalk Settings Dashboard.</span></span>  

5. <span data-ttu-id="28719-331">单击下拉列表旁边**主机**选择一个将性能测试期间使用的主机。</span><span class="sxs-lookup"><span data-stu-id="28719-331">Click the dropdown list next to **Host** to select one of the hosts that will be used during performance testing.</span></span>  

6. <span data-ttu-id="28719-332">保留属性的默认值除下表中所述：</span><span class="sxs-lookup"><span data-stu-id="28719-332">Leave properties at their default values except as noted in the following table:</span></span>  


   |                          <span data-ttu-id="28719-333">“属性”</span><span class="sxs-lookup"><span data-stu-id="28719-333">Property</span></span>                          |               <span data-ttu-id="28719-334">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="28719-334">Value</span></span>                |
   |------------------------------------------------------------|------------------------------------|
   |          <span data-ttu-id="28719-335">**General\Move 到 DTA 数据库跟踪数据**</span><span class="sxs-lookup"><span data-stu-id="28719-335">**General\Move tracking data to DTA DB**</span></span>          | <span data-ttu-id="28719-336">如果对其进行检查，请取消选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-336">Uncheck this box if it is checked.</span></span> |
   |                  <span data-ttu-id="28719-337">**仅限 General\32 位**</span><span class="sxs-lookup"><span data-stu-id="28719-337">**General\32-bit only**</span></span>                   | <span data-ttu-id="28719-338">如果对其进行检查，请取消选中此框。</span><span class="sxs-lookup"><span data-stu-id="28719-338">Uncheck this box if it is checked.</span></span> |
   |          <span data-ttu-id="28719-339">**General\Polling Intervals\Messaging**</span><span class="sxs-lookup"><span data-stu-id="28719-339">**General\Polling Intervals\Messaging**</span></span>           |     <span data-ttu-id="28719-340">设置为 20000000 值</span><span class="sxs-lookup"><span data-stu-id="28719-340">Set to a value of 20000000</span></span>     |
   |        <span data-ttu-id="28719-341">**General\Polling Intervals\Orchestrations**</span><span class="sxs-lookup"><span data-stu-id="28719-341">**General\Polling Intervals\Orchestrations**</span></span>        |     <span data-ttu-id="28719-342">设置为 20000000 值</span><span class="sxs-lookup"><span data-stu-id="28719-342">Set to a value of 20000000</span></span>     |
   |     <span data-ttu-id="28719-343">**基于资源的 Throttling\In 处理消息**</span><span class="sxs-lookup"><span data-stu-id="28719-343">**Resource-Based Throttling\In-process messages**</span></span>      |      <span data-ttu-id="28719-344">设置为值为 10000</span><span class="sxs-lookup"><span data-stu-id="28719-344">Set to a value of 10000</span></span>       |
   | <span data-ttu-id="28719-345">**基于资源的 Throttling\Internal 消息队列大小**</span><span class="sxs-lookup"><span data-stu-id="28719-345">**Resource-Based Throttling\Internal message queue size**</span></span>  |      <span data-ttu-id="28719-346">设置为值为 10000</span><span class="sxs-lookup"><span data-stu-id="28719-346">Set to a value of 10000</span></span>       |
   |     <span data-ttu-id="28719-347">**在 DB 中的基于资源的 Throttling\Message 计数**</span><span class="sxs-lookup"><span data-stu-id="28719-347">**Resource-Based Throttling\Message count in DB**</span></span>      |        <span data-ttu-id="28719-348">设置为 0 的值</span><span class="sxs-lookup"><span data-stu-id="28719-348">Set to a value of 0</span></span>         |
   | <span data-ttu-id="28719-349">**虚拟的基于资源的 Throttling\Memory Usage\Process**</span><span class="sxs-lookup"><span data-stu-id="28719-349">**Resource-Based Throttling\Memory Usage\Process virtual**</span></span> |        <span data-ttu-id="28719-350">设置为 0 的值</span><span class="sxs-lookup"><span data-stu-id="28719-350">Set to a value of 0</span></span>         |
   |  <span data-ttu-id="28719-351">**基于速率的 Throttling\Publishing\Throttling 重写**</span><span class="sxs-lookup"><span data-stu-id="28719-351">**Rate-Based Throttling\Publishing\Throttling override**</span></span>  |       <span data-ttu-id="28719-352">设置为不阻止</span><span class="sxs-lookup"><span data-stu-id="28719-352">Set to Do Not Throttle</span></span>       |
   |   <span data-ttu-id="28719-353">**基于速率的 Throttling\Delivery\Throttling 重写**</span><span class="sxs-lookup"><span data-stu-id="28719-353">**Rate-Based Throttling\Delivery\Throttling override**</span></span>   |       <span data-ttu-id="28719-354">设置为不阻止</span><span class="sxs-lookup"><span data-stu-id="28719-354">Set to Do Not Throttle</span></span>       |


7. <span data-ttu-id="28719-355">重复步骤 6 中所述过程的性能测试过程中将使用每个主机的过程。</span><span class="sxs-lookup"><span data-stu-id="28719-355">Repeat the process outlined in step 6 for every host that will be used during the course of performance testing.</span></span>  

8. <span data-ttu-id="28719-356">单击此项可选择**主机实例**BizTalk 设置仪表板的左侧窗格中。</span><span class="sxs-lookup"><span data-stu-id="28719-356">Click to select **Host Instances** in the left hand pane of the BizTalk Settings Dashboard.</span></span>  

9. <span data-ttu-id="28719-357">单击下拉列表旁边**主机实例：** 来选择一种用于性能测试的主机实例。</span><span class="sxs-lookup"><span data-stu-id="28719-357">Click the dropdown list next to **Host Instance:** to select one of the host instances that will be used for performance testing.</span></span>  

10. <span data-ttu-id="28719-358">将属性值保留为其默认设置，除了更改 **.NET CLR 最大工作线程**为值**100**并更改 **.NET CLR 最小工作线程**到值**25**。</span><span class="sxs-lookup"><span data-stu-id="28719-358">Leave property values at their default setting except change the **.NET CLR Maximum worker threads** to a value of **100** and change the **.NET CLR Minimum worker threads** to a value of **25**.</span></span>  

11. <span data-ttu-id="28719-359">重复步骤 10 的每个主机实例将使用的性能测试过程中所述的过程。</span><span class="sxs-lookup"><span data-stu-id="28719-359">Repeat the process outlined in step 10 for every host instance that will be used during the course of performance testing.</span></span>  

    <span data-ttu-id="28719-360">即使禁用跟踪和带宽限制确实不以任何方式表示应如何处理在生产方案中，因为这些操作是从性能角度看，最好禁用它们以找出 true 最大可承受如此昂贵BizTalk Server 环境的吞吐量 (MST)。</span><span class="sxs-lookup"><span data-stu-id="28719-360">Even though disabling Tracking and Throttling does not in any way represent what should be done in a production scenario, because these operations are so expensive from a performance perspective it makes sense to disable them to find out the true Maximum Sustainable Throughput (MST) of a BizTalk Server Environment.</span></span> <span data-ttu-id="28719-361">这样，测试人员能够清楚地看到的调整的任何性能影响应用到环境。</span><span class="sxs-lookup"><span data-stu-id="28719-361">This allows testers to clearly see the impact of any performance tweaking that has been applied to the environment.</span></span> <span data-ttu-id="28719-362">当然不应禁用跟踪，如果你从一开始就知道在 BizTalk Server 应用程序将需要跟踪然后应启用跟踪，则无法进行自变量。</span><span class="sxs-lookup"><span data-stu-id="28719-362">Certainly an argument could be made that tracking should not be disabled and if you know from the outset that your BizTalk Server application will require tracking then you should enable tracking.</span></span> <span data-ttu-id="28719-363">话虽如此，**应将每项工作可以禁用阻止功能的性能测试**。</span><span class="sxs-lookup"><span data-stu-id="28719-363">With that said, **every effort should be made to disable throttling for purposes of performance testing**.</span></span> <span data-ttu-id="28719-364">限制会阻止 BizTalk Server"侵扰"因负载过大，在生产环境中非常有用。</span><span class="sxs-lookup"><span data-stu-id="28719-364">Throttling is very useful for preventing a BizTalk Server from “falling over” due to excessive load in a production environment.</span></span> <span data-ttu-id="28719-365">但是，您不希望限制在性能测试，因为它将极大地影响系统性能，因为如果负载测试期间限制中的时，将启动然后将具有很难确定何种级别的性能的过程中启用你BizTalk Server 应用程序可以实际实现。</span><span class="sxs-lookup"><span data-stu-id="28719-365">However, you don’t want throttling enabled during performance testing because it is expensive from a performance standpoint and because if throttling kicks in during a load test then you will have a very difficult time determining what level of performance your BizTalk Server application can actually achieve.</span></span> <span data-ttu-id="28719-366">下一步的主题介绍如何执行负载测试来推送你的 BizTalk Server 环境超出 MST 并缩放回实际 MST 常量负载测试步骤。</span><span class="sxs-lookup"><span data-stu-id="28719-366">The next topics describe how to perform step load testing to push your BizTalk Server environment beyond MST and then scale back to actual MST with constant load testing.</span></span> <span data-ttu-id="28719-367">如果启用限制然后它将成为几乎无法推送，以便您又无法发现的真正所 MST 是 BizTalk 环境超出 MST。</span><span class="sxs-lookup"><span data-stu-id="28719-367">If throttling is enabled then it will become nearly impossible to push your BizTalk environment beyond MST so that you could in turn discover what the true MST is.</span></span>