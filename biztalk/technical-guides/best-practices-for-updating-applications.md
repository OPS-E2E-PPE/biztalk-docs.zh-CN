---
title: 更新应用程序的最佳实践 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 072eaf25-a1ee-4af3-b034-525a04260ef4
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 75dbde61369cdc8658dd9b39fa75fe2655225222
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "37001726"
---
# <a name="best-practices-for-updating-applications"></a><span data-ttu-id="b7289-102">更新应用程序的最佳实践</span><span class="sxs-lookup"><span data-stu-id="b7289-102">Best Practices for Updating Applications</span></span>
<span data-ttu-id="b7289-103">本主题介绍你应考虑使用更新 BizTalk 应用程序和项目时的最佳做法。</span><span class="sxs-lookup"><span data-stu-id="b7289-103">This topic describes best practices that you should consider using when updating BizTalk applications and artifacts.</span></span>  
  
## <a name="versioning"></a><span data-ttu-id="b7289-104">版本控制</span><span class="sxs-lookup"><span data-stu-id="b7289-104">Versioning</span></span>  
 <span data-ttu-id="b7289-105">**实现版本控制策略**</span><span class="sxs-lookup"><span data-stu-id="b7289-105">**Implement a versioning strategy**</span></span>  
  
- <span data-ttu-id="b7289-106">如果长时间运行，则使用事务或 BizTalk 应用程序无法创建向下，若要执行升级或 bug 修复，很好的版本控制策略至关重要。</span><span class="sxs-lookup"><span data-stu-id="b7289-106">A good versioning strategy is essential if long-running transactions are used or the BizTalk application cannot be taken down to do upgrades or bug fixes.</span></span> <span data-ttu-id="b7289-107">应计划的所有 BizTalk 项目的版本控制策略： 架构、 映射、 自定义适配器、 管道、 管道组件、 业务流程、 业务规则、 BAM 和自定义类名为在业务流程和映射。</span><span class="sxs-lookup"><span data-stu-id="b7289-107">You should plan the versioning strategy of all BizTalk artifacts: schemas, maps, custom adapters, pipelines, pipeline components, orchestrations, business rules, BAM, and custom classes called in orchestrations and maps.</span></span>  
  
  <span data-ttu-id="b7289-108">**与 BizTalk 管理数据库和全局程序集缓存 (GAC) 中的程序集匹配**</span><span class="sxs-lookup"><span data-stu-id="b7289-108">**Match the assemblies in the BizTalk Management database and the global assembly cache (GAC)**</span></span>  
  
- <span data-ttu-id="b7289-109">确保程序集的相同版本并在 BizTalk 管理数据库和 GAC 中，以便你的应用程序正常运行。</span><span class="sxs-lookup"><span data-stu-id="b7289-109">Ensure that the same versions of assemblies are in the BizTalk Management database as in the GAC, so that your application functions properly.</span></span> <span data-ttu-id="b7289-110">如果部署程序集时并不总是将其安装到 GAC 中，GAC 和 BizTalk 管理数据库中的程序集版本可能有所不同，从而导致运行时出现处理错误。</span><span class="sxs-lookup"><span data-stu-id="b7289-110">If you do not always install an assembly in the GAC when you deploy it, you might have different versions in the GAC and the BizTalk Management database, which will cause processing errors during run time.</span></span>  
  
  <span data-ttu-id="b7289-111">**使用 BizTalk 程序集检查器和远程 GAC 工具验证版本控制**</span><span class="sxs-lookup"><span data-stu-id="b7289-111">**Use the BizTalk Assembly Checker and Remote GAC tool to verify versioning**</span></span>  
  
- <span data-ttu-id="b7289-112">**BizTalk 程序集检查器和远程 GAC 工具**(BTSAssemblyChecker.exe) 会检查部署到 BizTalk 管理数据库的程序集的版本，并验证它们都正确注册所有 BizTalk 上的 GAC 中服务器的计算机。</span><span class="sxs-lookup"><span data-stu-id="b7289-112">The **BizTalk Assembly Checker and Remote GAC tool** (BTSAssemblyChecker.exe) checks the versions of assemblies deployed to the BizTalk Management database and verifies that they are correctly registered in the GAC on all BizTalk Server computers.</span></span> <span data-ttu-id="b7289-113">可以使用此工具检查 BizTalk 的所有节点上已安装了所有包含的某一 BizTalk 应用程序的项目的程序集。</span><span class="sxs-lookup"><span data-stu-id="b7289-113">You can use this tool to verify that all the assemblies containing the artifacts of a certain BizTalk application are installed on all BizTalk nodes.</span></span> <span data-ttu-id="b7289-114">该工具是结合 solid 版本控制策略来验证一组程序集的正确版本上安装了每个 BizTalk 计算机，尤其是使用通过并行部署方法时特别有用。</span><span class="sxs-lookup"><span data-stu-id="b7289-114">The tool is particularly useful in conjunction with a solid versioning strategy to verify that the correct version of a set of assemblies is installed on each BizTalk machine, especially when side-by-side deployment approach is used.</span></span>  
  
- <span data-ttu-id="b7289-115">该工具随 BizTalk Server 安装介质上 Support\Tools\x86\BTSAssemblyChecker.exe。</span><span class="sxs-lookup"><span data-stu-id="b7289-115">The tool is available with the BizTalk Server installation media at Support\Tools\x86\BTSAssemblyChecker.exe.</span></span>  
  
  <span data-ttu-id="b7289-116">**使用版本控制产品**</span><span class="sxs-lookup"><span data-stu-id="b7289-116">**Use a Versioning Product**</span></span>  
  
- <span data-ttu-id="b7289-117">版本控制产品，如 Microsoft Visual Studio® Team Foundation Server 2010，应该用于跟踪和版本控制 BizTalk 项目。</span><span class="sxs-lookup"><span data-stu-id="b7289-117">You should use a versioning product, such as Microsoft Visual Studio® Team Foundation Server 2010, for tracking and versioning BizTalk artifacts.</span></span> <span data-ttu-id="b7289-118">有关 Microsoft Visual Studio® Team Foundation Server 2010 的详细信息请参阅[Microsoft Visual Studio® Team Foundation Server 2010](http://go.microsoft.com/fwlink/?LinkId=210637) (http://go.microsoft.com/fwlink/?LinkId=210637)</span><span class="sxs-lookup"><span data-stu-id="b7289-118">For more information about Microsoft Visual Studio® Team Foundation Server 2010 see [Microsoft Visual Studio® Team Foundation Server 2010](http://go.microsoft.com/fwlink/?LinkId=210637) (http://go.microsoft.com/fwlink/?LinkId=210637)</span></span>  
  
  <span data-ttu-id="b7289-119">**到多个 BizTalk 应用程序的身份项目**</span><span class="sxs-lookup"><span data-stu-id="b7289-119">**Factor artifacts into multiple BizTalk applications**</span></span>  
  
- <span data-ttu-id="b7289-120">若要执行的 BizTalk 项目的程序集版本控制，您的 BizTalk 解决方案程序集需要考虑 （打包） 的方式以允许 BizTalk Server 版本控制。</span><span class="sxs-lookup"><span data-stu-id="b7289-120">In order to perform assembly versioning of BizTalk artifacts, your BizTalk solution assemblies need to be factored (packaged) in such a way to allow for BizTalk Server versioning.</span></span> <span data-ttu-id="b7289-121">分解的详细信息，请参阅[将项目添加到应用程序](../technical-guides/adding-artifacts-to-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="b7289-121">For more information about factoring, see [Adding Artifacts to an Application](../technical-guides/adding-artifacts-to-an-application.md).</span></span>  
  
## <a name="updating-an-application"></a><span data-ttu-id="b7289-122">更新应用程序</span><span class="sxs-lookup"><span data-stu-id="b7289-122">Updating an Application</span></span>  
 <span data-ttu-id="b7289-123">**使用.msi 文件将更新的应用程序**</span><span class="sxs-lookup"><span data-stu-id="b7289-123">**Use an .msi file to update an application**</span></span>  
  
-   <span data-ttu-id="b7289-124">升级应用程序通常是一个故意安排和精确的操作，在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="b7289-124">Upgrading applications is typically a deliberate and precise operation in production.</span></span> <span data-ttu-id="b7289-125">当你升级应用程序时，你通常应使用手动检查表。</span><span class="sxs-lookup"><span data-stu-id="b7289-125">When you upgrade an application, you should normally use a manual checklist.</span></span> <span data-ttu-id="b7289-126">但是，您可能能够通过使用.msi 文件，来优化某些步骤。</span><span class="sxs-lookup"><span data-stu-id="b7289-126">However, you may be able to streamline certain steps by using an .msi file.</span></span> <span data-ttu-id="b7289-127">当您使用某一.msi 文件时，可以总结你的应用程序项目打包到可分发包。</span><span class="sxs-lookup"><span data-stu-id="b7289-127">When you use an .msi file, you can wrap up your application artifacts into a distributable package.</span></span> <span data-ttu-id="b7289-128">向多个运行时中推出更新的 Dll 或执行组级别部署时，某一.msi 文件是特别有用。</span><span class="sxs-lookup"><span data-stu-id="b7289-128">An .msi file is particularly useful when you roll out updated DLLs to multiple runtime boxes or perform a group-level deployment.</span></span> <span data-ttu-id="b7289-129">在创建某一.msi 文件时，应从包中排除所有其他未更改的资源和绑定。</span><span class="sxs-lookup"><span data-stu-id="b7289-129">When you create an .msi file, you should exclude all other unchanged resources and bindings from the package.</span></span>  
  
-   <span data-ttu-id="b7289-130">如果更新 BizTalk 程序集，您应停止、 取消登记、 重新登记，并启动 BizTalk 项目手动之前和之后导入和安装.msi 文件。</span><span class="sxs-lookup"><span data-stu-id="b7289-130">If you update a BizTalk assembly, you should stop, unenlist, re-enlist, and then start BizTalk artifacts manually before and after you import and install the .msi file.</span></span> <span data-ttu-id="b7289-131">有关更新的 BizTalk 程序集的详细信息，请参阅[清单： 更新的程序集](../technical-guides/checklist-updating-an-assembly.md)。</span><span class="sxs-lookup"><span data-stu-id="b7289-131">For more information about updating a BizTalk assembly, see [Checklist: Updating an Assembly](../technical-guides/checklist-updating-an-assembly.md).</span></span>  
  
-   <span data-ttu-id="b7289-132">如果升级 BizTalk Server 程序集的并行版本控制，您将必须使用.msi 文件之前和之后执行手动步骤。</span><span class="sxs-lookup"><span data-stu-id="b7289-132">If you upgrade a BizTalk Server assembly using side-by-side versioning, you will have to perform manual steps before and after using the .msi file.</span></span> <span data-ttu-id="b7289-133">有关所需的手动步骤的详细信息，请参阅[清单： 更新应用程序使用的并行版本控制](../technical-guides/checklist-updating-an-application-using-side-by-side-versioning.md)。</span><span class="sxs-lookup"><span data-stu-id="b7289-133">For more information about the manual steps that are required, see [Checklist: Updating an Application Using Side-by-Side Versioning](../technical-guides/checklist-updating-an-application-using-side-by-side-versioning.md).</span></span>  
  
## <a name="updating-an-assembly"></a><span data-ttu-id="b7289-134">更新的程序集</span><span class="sxs-lookup"><span data-stu-id="b7289-134">Updating an Assembly</span></span>  
 <span data-ttu-id="b7289-135">**增加在生产环境中的程序集的版本号**</span><span class="sxs-lookup"><span data-stu-id="b7289-135">**Increment the version of an assembly in a production environment**</span></span>  
  
- <span data-ttu-id="b7289-136">如果要更新在生产环境中运行的程序集，您应始终是递增程序集的版本号。</span><span class="sxs-lookup"><span data-stu-id="b7289-136">If you are updating an assembly that is running in a production environment, you should always increment the assembly version number.</span></span>  
  
  <span data-ttu-id="b7289-137">**使用更新的程序集更新 GAC**</span><span class="sxs-lookup"><span data-stu-id="b7289-137">**Update the GAC with an updated assembly**</span></span>  
  
- <span data-ttu-id="b7289-138">当更新包含业务流程、 架构或映射的程序集时，必须使用包含新版本的程序集更新 gac。</span><span class="sxs-lookup"><span data-stu-id="b7289-138">When you update an assembly containing an orchestration, schema, or map, you must update the GAC with the assembly containing the new version.</span></span> <span data-ttu-id="b7289-139">否则，BizTalk Server 将使用版本已过时。</span><span class="sxs-lookup"><span data-stu-id="b7289-139">Otherwise, BizTalk Server will use the outdated version.</span></span> <span data-ttu-id="b7289-140">要执行此操作，请在运行应用程序绑定到的主机的实例的每台计算机上，从 GAC 卸载包含更新项目的程序集的过期版本，并确保安装新版本。</span><span class="sxs-lookup"><span data-stu-id="b7289-140">To do this, on each computer that is running an instance of the host to which an application is bound, uninstall from the GAC the outdated version of the assembly containing the updated artifact and make sure that the new version is installed.</span></span>  
  
  <span data-ttu-id="b7289-141">**更新的程序集后重新启动主机实例**</span><span class="sxs-lookup"><span data-stu-id="b7289-141">**Restart a host instance after updating an assembly**</span></span>  
  
- <span data-ttu-id="b7289-142">如果更新现有应用程序中的 BizTalk 程序集时，可能需要重新启动主机实例以使更改生效。</span><span class="sxs-lookup"><span data-stu-id="b7289-142">If a BizTalk assembly in an existing application is updated, you may need to restart host instances for the changes to take effect.</span></span> <span data-ttu-id="b7289-143">重新启动主机实例停止所有主机实例运行其他应用程序。</span><span class="sxs-lookup"><span data-stu-id="b7289-143">Restarting a host instance stops all other applications that are running on the host instance.</span></span>  
  
## <a name="updating-an-artifact"></a><span data-ttu-id="b7289-144">更新某一项目</span><span class="sxs-lookup"><span data-stu-id="b7289-144">Updating an Artifact</span></span>  
 <span data-ttu-id="b7289-145">**取消部署依赖的程序集的项目，这取决于之前**</span><span class="sxs-lookup"><span data-stu-id="b7289-145">**Undeploy a dependent artifact before the artifact that it depends on**</span></span>  
  
- <span data-ttu-id="b7289-146">如果要取消部署被另一个项目所依赖的项目，您必须首先取消部署依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="b7289-146">If you are undeploying an artifact on which another artifact depends, you must undeploy the dependent artifact first.</span></span>  
  
  > [!NOTE]  
  >  <span data-ttu-id="b7289-147">如果你不执行第一次取消依赖的程序集的部署，在 BizTalk Server 管理控制台将显示一条警告，并防止错误的顺序取消部署项目。</span><span class="sxs-lookup"><span data-stu-id="b7289-147">If you do not undeploy the dependent artifact first, the BizTalk Server Administration console will display a warning and prevent you from undeploying artifacts in the incorrect order.</span></span>  
  
  <span data-ttu-id="b7289-148">**不会停止其他应用程序依赖的项目**</span><span class="sxs-lookup"><span data-stu-id="b7289-148">**Do not stop an artifact that another application depends on**</span></span>  
  
- <span data-ttu-id="b7289-149">如果您停止一个应用程序中另一个应用程序所依赖的项目（这可能导致停止整个应用程序），则依赖的应用程序将无法正常工作。</span><span class="sxs-lookup"><span data-stu-id="b7289-149">If you stop an artifact in one application (which may result from stopping the entire application) that another application depends on, the dependent application will not function correctly.</span></span> <span data-ttu-id="b7289-150">有关停止应用程序的详细信息，请参阅[如何启动和停止 BizTalk 应用程序](http://go.microsoft.com/fwlink/?LinkID=154729)(http://go.microsoft.com/fwlink/?LinkID=154729)。</span><span class="sxs-lookup"><span data-stu-id="b7289-150">For more information about stopping an application, see [How to Start and Stop a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154729) (http://go.microsoft.com/fwlink/?LinkID=154729).</span></span>  
  
  <span data-ttu-id="b7289-151">**添加对程序集之前移动项目的引用**</span><span class="sxs-lookup"><span data-stu-id="b7289-151">**Add a reference to an assembly before moving an artifact**</span></span>  
  
- <span data-ttu-id="b7289-152">将项目移向新应用程序时，该项目所依赖的其他所有项目也会被移动，除非此新应用程序有对包含移动项目所依赖项目的应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="b7289-152">When you move an artifact to a new application, any other artifacts on which it has dependencies are also moved unless the new application has a reference to the application(s) containing the artifacts on which the moved artifact depends.</span></span> <span data-ttu-id="b7289-153">同样，依赖于移动项目的所有项目也会被移动，除非包含这些项目的应用程序有对新应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="b7289-153">Also, any artifacts that have dependencies on the moved artifact are moved unless the application(s) containing them have a reference to the new application.</span></span> <span data-ttu-id="b7289-154">当移动项目，将显示一起移动的其他项目的列表。</span><span class="sxs-lookup"><span data-stu-id="b7289-154">When moving an artifact, you are shown the list of other artifacts that will also be moved.</span></span>  
  
## <a name="updating-bindings"></a><span data-ttu-id="b7289-155">更新绑定</span><span class="sxs-lookup"><span data-stu-id="b7289-155">Updating Bindings</span></span>  
 <span data-ttu-id="b7289-156">**自动执行重新配置绑定**</span><span class="sxs-lookup"><span data-stu-id="b7289-156">**Automate the reconfiguration of bindings**</span></span>  
  
-   <span data-ttu-id="b7289-157">在更新应用程序中的一个程序集时，通常会覆盖该程序集的绑定，也有可能该程序集根本未绑定，所以您不得不手动重新配置绑定。</span><span class="sxs-lookup"><span data-stu-id="b7289-157">When you update an assembly in an application, its bindings are often overwritten or else the assembly may not be bound at all, forcing you to manually reconfigure bindings.</span></span> <span data-ttu-id="b7289-158">可以使用绑定文件来自动化此过程。</span><span class="sxs-lookup"><span data-stu-id="b7289-158">You can automate this process by using a binding file.</span></span> <span data-ttu-id="b7289-159">如果要更新的程序集相同的版本，可以首先导出绑定文件的程序集，然后更新程序集，然后导入应用程序，该程序集并导入绑定文件，然后重新应用以前的绑定。</span><span class="sxs-lookup"><span data-stu-id="b7289-159">If you are updating the same version of an assembly, you can first export a binding file for the assembly, then update the assembly, then import the assembly into the application, and then reapply the previous bindings by importing the binding file.</span></span> <span data-ttu-id="b7289-160">如果要使用更新的版本更新程序集，可以导出绑定文件，编辑该文件以反映新的程序集版本、 新的程序集导入应用程序，然后通过导入绑定文件中应用的新绑定。</span><span class="sxs-lookup"><span data-stu-id="b7289-160">If you are updating an assembly with a newer version, you can export a binding file, edit the file to reflect the new assembly version, import the new assembly into the application, and then apply the new bindings by importing the binding file.</span></span> <span data-ttu-id="b7289-161">有关绑定文件的详细信息，请参阅[如何将绑定导出到绑定文件](../technical-guides/how-to-export-bindings-to-a-binding-file.md)。</span><span class="sxs-lookup"><span data-stu-id="b7289-161">For more information about binding files, see [How to Export Bindings to a Binding File](../technical-guides/how-to-export-bindings-to-a-binding-file.md).</span></span> <span data-ttu-id="b7289-162">有关编辑绑定文件的详细信息，请参阅[自定义绑定文件](http://go.microsoft.com/fwlink/?LinkID=155000)(http://go.microsoft.com/fwlink/?LinkID=155000)。</span><span class="sxs-lookup"><span data-stu-id="b7289-162">For more information about editing a binding file, see [Customizing Binding Files](http://go.microsoft.com/fwlink/?LinkID=155000) (http://go.microsoft.com/fwlink/?LinkID=155000).</span></span>  
  
## <a name="starting-or-stopping-an-application"></a><span data-ttu-id="b7289-163">启动或停止应用程序</span><span class="sxs-lookup"><span data-stu-id="b7289-163">Starting or Stopping an Application</span></span>  
 <span data-ttu-id="b7289-164">**停止应用程序来更新项目**</span><span class="sxs-lookup"><span data-stu-id="b7289-164">**Stop an application to update artifacts**</span></span>  
  
-   <span data-ttu-id="b7289-165">如果不停止应用程序更新应用程序中的项目，需要暂时禁用终结点，通过来暂停进程发布到 MessageBox 数据库和停止并取消登记任何正在运行的实例。</span><span class="sxs-lookup"><span data-stu-id="b7289-165">If you do not stop an application to update artifacts in the application, you need to temporarily halt publication to the MessageBox database by disabling endpoints, and stop and unenlist any running instances.</span></span> <span data-ttu-id="b7289-166">若要停止并取消登记正在运行的实例，所有已冻结或挂起的实例必须进行手动恢复，已完成，或者终止。</span><span class="sxs-lookup"><span data-stu-id="b7289-166">To stop and unenlist running instances, all dehydrated or suspended instances must be either manually resumed and completed, or terminated.</span></span>  
  
-   <span data-ttu-id="b7289-167">尽管它不需要停止应用程序，以便更新某个项目或安装应用程序，但我们建议你更新项目时始终停止应用程序。</span><span class="sxs-lookup"><span data-stu-id="b7289-167">Although it is not required to stop an application in order to update an artifact or install the application, we recommend that you always stop an application when you update an artifact.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b7289-168">请参阅</span><span class="sxs-lookup"><span data-stu-id="b7289-168">See Also</span></span>  
 [<span data-ttu-id="b7289-169">如何将绑定导出到绑定文件</span><span class="sxs-lookup"><span data-stu-id="b7289-169">How to Export Bindings to a Binding File</span></span>](../technical-guides/how-to-export-bindings-to-a-binding-file.md)