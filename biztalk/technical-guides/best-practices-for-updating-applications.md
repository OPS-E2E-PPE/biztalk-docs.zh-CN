---
title: 更新应用程序的最佳实践 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 072eaf25-a1ee-4af3-b034-525a04260ef4
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d01cf54454866eadbd70de7ef30439a0e7068cb1
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009430"
---
# <a name="best-practices-for-updating-applications"></a><span data-ttu-id="5297b-102">更新应用程序的最佳做法</span><span class="sxs-lookup"><span data-stu-id="5297b-102">Best Practices for Updating Applications</span></span>
<span data-ttu-id="5297b-103">本主题介绍你应考虑使用更新 BizTalk 应用程序和项目时的最佳做法。</span><span class="sxs-lookup"><span data-stu-id="5297b-103">This topic describes best practices that you should consider using when updating BizTalk applications and artifacts.</span></span>  
  
## <a name="versioning"></a><span data-ttu-id="5297b-104">版本控制</span><span class="sxs-lookup"><span data-stu-id="5297b-104">Versioning</span></span>  
 <span data-ttu-id="5297b-105">**实施版本控制策略**</span><span class="sxs-lookup"><span data-stu-id="5297b-105">**Implement a versioning strategy**</span></span>  
  
-   <span data-ttu-id="5297b-106">如果长时间运行，则使用事务或 BizTalk 应用程序不能被移除执行升级或 bug 修复，良好的版本控制策略至关重要。</span><span class="sxs-lookup"><span data-stu-id="5297b-106">A good versioning strategy is essential if long-running transactions are used or the BizTalk application cannot be taken down to do upgrades or bug fixes.</span></span> <span data-ttu-id="5297b-107">你应该规划所有 BizTalk 项目的版本控制策略： 架构、 映射、 自定义适配器、 管道、 管道组件、 业务流程、 业务规则、 BAM 和自定义类调用中业务流程和映射。</span><span class="sxs-lookup"><span data-stu-id="5297b-107">You should plan the versioning strategy of all BizTalk artifacts: schemas, maps, custom adapters, pipelines, pipeline components, orchestrations, business rules, BAM, and custom classes called in orchestrations and maps.</span></span>  
  
 <span data-ttu-id="5297b-108">**匹配 BizTalk 管理数据库和全局程序集缓存 (GAC) 中的程序集**</span><span class="sxs-lookup"><span data-stu-id="5297b-108">**Match the assemblies in the BizTalk Management database and the global assembly cache (GAC)**</span></span>  
  
-   <span data-ttu-id="5297b-109">以便你的应用程序工作正常，请确保相同版本的程序集位于 GAC 中，如 BizTalk 管理数据库。</span><span class="sxs-lookup"><span data-stu-id="5297b-109">Ensure that the same versions of assemblies are in the BizTalk Management database as in the GAC, so that your application functions properly.</span></span> <span data-ttu-id="5297b-110">如果部署程序集时并不总是将其安装到 GAC 中，GAC 和 BizTalk 管理数据库中的程序集版本可能有所不同，从而导致运行时出现处理错误。</span><span class="sxs-lookup"><span data-stu-id="5297b-110">If you do not always install an assembly in the GAC when you deploy it, you might have different versions in the GAC and the BizTalk Management database, which will cause processing errors during run time.</span></span>  
  
 <span data-ttu-id="5297b-111">**使用 BizTalk 程序集检查和远程 GAC 工具验证版本控制**</span><span class="sxs-lookup"><span data-stu-id="5297b-111">**Use the BizTalk Assembly Checker and Remote GAC tool to verify versioning**</span></span>  
  
-   <span data-ttu-id="5297b-112">**BizTalk 程序集检查器和远程 GAC 工具**(BTSAssemblyChecker.exe) 检查部署到 BizTalk 管理数据库中的程序集的版本，并验证它们是否正确注册所有 BizTalk 上的 GAC 中服务器的计算机。</span><span class="sxs-lookup"><span data-stu-id="5297b-112">The **BizTalk Assembly Checker and Remote GAC tool** (BTSAssemblyChecker.exe) checks the versions of assemblies deployed to the BizTalk Management database and verifies that they are correctly registered in the GAC on all BizTalk Server computers.</span></span> <span data-ttu-id="5297b-113">此工具可用于验证包含某些 BizTalk 应用程序的项目的所有程序集安装在所有 BizTalk 节点。</span><span class="sxs-lookup"><span data-stu-id="5297b-113">You can use this tool to verify that all the assemblies containing the artifacts of a certain BizTalk application are installed on all BizTalk nodes.</span></span> <span data-ttu-id="5297b-114">该工具是结合稳定版本控制策略以验证一组程序集的正确版本上安装了每个 BizTalk 机，尤其是使用通过并行部署方法时特别有用。</span><span class="sxs-lookup"><span data-stu-id="5297b-114">The tool is particularly useful in conjunction with a solid versioning strategy to verify that the correct version of a set of assemblies is installed on each BizTalk machine, especially when side-by-side deployment approach is used.</span></span>  
  
-   <span data-ttu-id="5297b-115">该工具时使用的 BizTalk Server 安装媒体上 Support\Tools\x86\BTSAssemblyChecker.exe。</span><span class="sxs-lookup"><span data-stu-id="5297b-115">The tool is available with the BizTalk Server installation media at Support\Tools\x86\BTSAssemblyChecker.exe.</span></span>  
  
 <span data-ttu-id="5297b-116">**使用版本控制产品**</span><span class="sxs-lookup"><span data-stu-id="5297b-116">**Use a Versioning Product**</span></span>  
  
-   <span data-ttu-id="5297b-117">应将版本控制产品，如 Microsoft Visual Studio® Team Foundation Server 2010，用于跟踪和版本管理 BizTalk 项目中。</span><span class="sxs-lookup"><span data-stu-id="5297b-117">You should use a versioning product, such as Microsoft Visual Studio® Team Foundation Server 2010, for tracking and versioning BizTalk artifacts.</span></span> <span data-ttu-id="5297b-118">有关 Microsoft Visual Studio® Team Foundation Server 2010 的详细信息请参阅[Microsoft Visual Studio® Team Foundation Server 2010](http://go.microsoft.com/fwlink/?LinkId=210637) (http://go.microsoft.com/fwlink/?LinkId=210637)</span><span class="sxs-lookup"><span data-stu-id="5297b-118">For more information about Microsoft Visual Studio® Team Foundation Server 2010 see [Microsoft Visual Studio® Team Foundation Server 2010](http://go.microsoft.com/fwlink/?LinkId=210637) (http://go.microsoft.com/fwlink/?LinkId=210637)</span></span>  
  
 <span data-ttu-id="5297b-119">**到多个 BizTalk 应用程序的因素项目**</span><span class="sxs-lookup"><span data-stu-id="5297b-119">**Factor artifacts into multiple BizTalk applications**</span></span>  
  
-   <span data-ttu-id="5297b-120">若要执行的 BizTalk 项目的程序集版本控制，BizTalk 解决方案程序集需要包含 （打包） 的方式以便 BizTalk Server 版本控制。</span><span class="sxs-lookup"><span data-stu-id="5297b-120">In order to perform assembly versioning of BizTalk artifacts, your BizTalk solution assemblies need to be factored (packaged) in such a way to allow for BizTalk Server versioning.</span></span> <span data-ttu-id="5297b-121">有关将分解的详细信息，请参阅[将项目添加到应用程序](../technical-guides/adding-artifacts-to-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="5297b-121">For more information about factoring, see [Adding Artifacts to an Application](../technical-guides/adding-artifacts-to-an-application.md).</span></span>  
  
## <a name="updating-an-application"></a><span data-ttu-id="5297b-122">更新应用程序</span><span class="sxs-lookup"><span data-stu-id="5297b-122">Updating an Application</span></span>  
 <span data-ttu-id="5297b-123">**使用.msi 文件更新的应用程序**</span><span class="sxs-lookup"><span data-stu-id="5297b-123">**Use an .msi file to update an application**</span></span>  
  
-   <span data-ttu-id="5297b-124">升级应用程序通常是一种有意和精确的操作，在生产环境中。</span><span class="sxs-lookup"><span data-stu-id="5297b-124">Upgrading applications is typically a deliberate and precise operation in production.</span></span> <span data-ttu-id="5297b-125">当你升级应用程序时，你通常应使用手动检查列表。</span><span class="sxs-lookup"><span data-stu-id="5297b-125">When you upgrade an application, you should normally use a manual checklist.</span></span> <span data-ttu-id="5297b-126">但是，你可能能够通过使用.msi 文件，来优化某些步骤。</span><span class="sxs-lookup"><span data-stu-id="5297b-126">However, you may be able to streamline certain steps by using an .msi file.</span></span> <span data-ttu-id="5297b-127">当使用.msi 文件时，你可以完成可再发行包到你应用程序的项目。</span><span class="sxs-lookup"><span data-stu-id="5297b-127">When you use an .msi file, you can wrap up your application artifacts into a distributable package.</span></span> <span data-ttu-id="5297b-128">到多个运行时框推出更新的 Dll 或执行组级别部署时，则.msi 文件是特别有用。</span><span class="sxs-lookup"><span data-stu-id="5297b-128">An .msi file is particularly useful when you roll out updated DLLs to multiple runtime boxes or perform a group-level deployment.</span></span> <span data-ttu-id="5297b-129">当你创建一个.msi 文件时，则应从包中排除所有其他不变的资源和绑定。</span><span class="sxs-lookup"><span data-stu-id="5297b-129">When you create an .msi file, you should exclude all other unchanged resources and bindings from the package.</span></span>  
  
-   <span data-ttu-id="5297b-130">如果你更新 BizTalk 程序集，应停止、 取消、 重新登记，然后之前和之后导入并安装.msi 文件手动启动 BizTalk 项目。</span><span class="sxs-lookup"><span data-stu-id="5297b-130">If you update a BizTalk assembly, you should stop, unenlist, re-enlist, and then start BizTalk artifacts manually before and after you import and install the .msi file.</span></span> <span data-ttu-id="5297b-131">有关更新 BizTalk 程序集的详细信息，请参阅[清单： 更新程序集](../technical-guides/checklist-updating-an-assembly.md)。</span><span class="sxs-lookup"><span data-stu-id="5297b-131">For more information about updating a BizTalk assembly, see [Checklist: Updating an Assembly](../technical-guides/checklist-updating-an-assembly.md).</span></span>  
  
-   <span data-ttu-id="5297b-132">如果升级使用的并行版本控制的 BizTalk Server 程序集，你将需要使用.msi 文件之前和之后执行手动步骤。</span><span class="sxs-lookup"><span data-stu-id="5297b-132">If you upgrade a BizTalk Server assembly using side-by-side versioning, you will have to perform manual steps before and after using the .msi file.</span></span> <span data-ttu-id="5297b-133">有关手动步骤，所需的详细信息，请参阅[清单： 更新应用程序使用的并行版本控制](../technical-guides/checklist-updating-an-application-using-side-by-side-versioning.md)。</span><span class="sxs-lookup"><span data-stu-id="5297b-133">For more information about the manual steps that are required, see [Checklist: Updating an Application Using Side-by-Side Versioning](../technical-guides/checklist-updating-an-application-using-side-by-side-versioning.md).</span></span>  
  
## <a name="updating-an-assembly"></a><span data-ttu-id="5297b-134">更新程序集</span><span class="sxs-lookup"><span data-stu-id="5297b-134">Updating an Assembly</span></span>  
 <span data-ttu-id="5297b-135">**增加的生产环境中的程序集的版本号**</span><span class="sxs-lookup"><span data-stu-id="5297b-135">**Increment the version of an assembly in a production environment**</span></span>  
  
-   <span data-ttu-id="5297b-136">如果正在更新生产环境中运行的程序集，你应该始终增加程序集版本号。</span><span class="sxs-lookup"><span data-stu-id="5297b-136">If you are updating an assembly that is running in a production environment, you should always increment the assembly version number.</span></span>  
  
 <span data-ttu-id="5297b-137">**使用更新的程序集中更新 GAC**</span><span class="sxs-lookup"><span data-stu-id="5297b-137">**Update the GAC with an updated assembly**</span></span>  
  
-   <span data-ttu-id="5297b-138">在更新包含业务流程、 架构或映射的程序集时，你必须使用包含新版本的程序集更新 gac。</span><span class="sxs-lookup"><span data-stu-id="5297b-138">When you update an assembly containing an orchestration, schema, or map, you must update the GAC with the assembly containing the new version.</span></span> <span data-ttu-id="5297b-139">否则，BizTalk Server 将使用过时的版本。</span><span class="sxs-lookup"><span data-stu-id="5297b-139">Otherwise, BizTalk Server will use the outdated version.</span></span> <span data-ttu-id="5297b-140">要执行此操作，请在运行应用程序绑定到的主机的实例的每台计算机上，从 GAC 卸载包含更新项目的程序集的过期版本，并确保安装新版本。</span><span class="sxs-lookup"><span data-stu-id="5297b-140">To do this, on each computer that is running an instance of the host to which an application is bound, uninstall from the GAC the outdated version of the assembly containing the updated artifact and make sure that the new version is installed.</span></span>  
  
 <span data-ttu-id="5297b-141">**在更新程序集后重新启动主机实例**</span><span class="sxs-lookup"><span data-stu-id="5297b-141">**Restart a host instance after updating an assembly**</span></span>  
  
-   <span data-ttu-id="5297b-142">如果现有应用程序中的 BizTalk 程序集进行了更新，你可能需要重新启动主机实例以使更改生效。</span><span class="sxs-lookup"><span data-stu-id="5297b-142">If a BizTalk assembly in an existing application is updated, you may need to restart host instances for the changes to take effect.</span></span> <span data-ttu-id="5297b-143">重新启动主机实例将停止所有主机实例运行其他应用程序。</span><span class="sxs-lookup"><span data-stu-id="5297b-143">Restarting a host instance stops all other applications that are running on the host instance.</span></span>  
  
## <a name="updating-an-artifact"></a><span data-ttu-id="5297b-144">更新某个项目</span><span class="sxs-lookup"><span data-stu-id="5297b-144">Updating an Artifact</span></span>  
 <span data-ttu-id="5297b-145">**取消部署的项目，它依赖于前一个依赖项目**</span><span class="sxs-lookup"><span data-stu-id="5297b-145">**Undeploy a dependent artifact before the artifact that it depends on**</span></span>  
  
-   <span data-ttu-id="5297b-146">如果你取消部署另一个项目所依赖的项目，你必须首先取消部署依赖项目。</span><span class="sxs-lookup"><span data-stu-id="5297b-146">If you are undeploying an artifact on which another artifact depends, you must undeploy the dependent artifact first.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5297b-147">如果你不执行第一次取消依赖项目的部署，则 BizTalk Server 管理控制台将显示一条警告，并阻止你从正在取消部署项目顺序不正确。</span><span class="sxs-lookup"><span data-stu-id="5297b-147">If you do not undeploy the dependent artifact first, the BizTalk Server Administration console will display a warning and prevent you from undeploying artifacts in the incorrect order.</span></span>  
  
 <span data-ttu-id="5297b-148">**不会停止依赖于另一个应用程序的项目**</span><span class="sxs-lookup"><span data-stu-id="5297b-148">**Do not stop an artifact that another application depends on**</span></span>  
  
-   <span data-ttu-id="5297b-149">如果您停止一个应用程序中另一个应用程序所依赖的项目（这可能导致停止整个应用程序），则依赖的应用程序将无法正常工作。</span><span class="sxs-lookup"><span data-stu-id="5297b-149">If you stop an artifact in one application (which may result from stopping the entire application) that another application depends on, the dependent application will not function correctly.</span></span> <span data-ttu-id="5297b-150">要停止应用程序的详细信息，请参阅[如何启动和停止 BizTalk 应用程序](http://go.microsoft.com/fwlink/?LinkID=154729)(http://go.microsoft.com/fwlink/?LinkID=154729)。</span><span class="sxs-lookup"><span data-stu-id="5297b-150">For more information about stopping an application, see [How to Start and Stop a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154729) (http://go.microsoft.com/fwlink/?LinkID=154729).</span></span>  
  
 <span data-ttu-id="5297b-151">**添加对之前移动项目程序集的引用**</span><span class="sxs-lookup"><span data-stu-id="5297b-151">**Add a reference to an assembly before moving an artifact**</span></span>  
  
-   <span data-ttu-id="5297b-152">将项目移向新应用程序时，该项目所依赖的其他所有项目也会被移动，除非此新应用程序有对包含移动项目所依赖项目的应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="5297b-152">When you move an artifact to a new application, any other artifacts on which it has dependencies are also moved unless the new application has a reference to the application(s) containing the artifacts on which the moved artifact depends.</span></span> <span data-ttu-id="5297b-153">同样，依赖于移动项目的所有项目也会被移动，除非包含这些项目的应用程序有对新应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="5297b-153">Also, any artifacts that have dependencies on the moved artifact are moved unless the application(s) containing them have a reference to the new application.</span></span> <span data-ttu-id="5297b-154">当移动项目，你会看到的其他项目，也将被移动的列表。</span><span class="sxs-lookup"><span data-stu-id="5297b-154">When moving an artifact, you are shown the list of other artifacts that will also be moved.</span></span>  
  
## <a name="updating-bindings"></a><span data-ttu-id="5297b-155">更新绑定</span><span class="sxs-lookup"><span data-stu-id="5297b-155">Updating Bindings</span></span>  
 <span data-ttu-id="5297b-156">**自动执行绑定的重新配置**</span><span class="sxs-lookup"><span data-stu-id="5297b-156">**Automate the reconfiguration of bindings**</span></span>  
  
-   <span data-ttu-id="5297b-157">在更新应用程序中的一个程序集时，通常会覆盖该程序集的绑定，也有可能该程序集根本未绑定，所以您不得不手动重新配置绑定。</span><span class="sxs-lookup"><span data-stu-id="5297b-157">When you update an assembly in an application, its bindings are often overwritten or else the assembly may not be bound at all, forcing you to manually reconfigure bindings.</span></span> <span data-ttu-id="5297b-158">可以通过使用绑定文件来自动执行此过程。</span><span class="sxs-lookup"><span data-stu-id="5297b-158">You can automate this process by using a binding file.</span></span> <span data-ttu-id="5297b-159">如果你要更新相同版本的程序集，首先将绑定文件导出为程序集，然后可以更新该程序集，然后将程序集导入到该应用程序，并导入绑定文件，然后重新应用以前的绑定。</span><span class="sxs-lookup"><span data-stu-id="5297b-159">If you are updating the same version of an assembly, you can first export a binding file for the assembly, then update the assembly, then import the assembly into the application, and then reapply the previous bindings by importing the binding file.</span></span> <span data-ttu-id="5297b-160">如果你使用较新版本进行更新程序集，你可以导出绑定文件，编辑该文件以反映新的程序集版本，将新的程序集导入到该应用程序，然后将新的绑定应用通过导入绑定文件。</span><span class="sxs-lookup"><span data-stu-id="5297b-160">If you are updating an assembly with a newer version, you can export a binding file, edit the file to reflect the new assembly version, import the new assembly into the application, and then apply the new bindings by importing the binding file.</span></span> <span data-ttu-id="5297b-161">有关绑定文件的详细信息，请参阅[如何导出绑定到绑定文件](../technical-guides/how-to-export-bindings-to-a-binding-file.md)。</span><span class="sxs-lookup"><span data-stu-id="5297b-161">For more information about binding files, see [How to Export Bindings to a Binding File](../technical-guides/how-to-export-bindings-to-a-binding-file.md).</span></span> <span data-ttu-id="5297b-162">有关编辑绑定文件的详细信息，请参阅[自定义绑定文件](http://go.microsoft.com/fwlink/?LinkID=155000)(http://go.microsoft.com/fwlink/?LinkID=155000)。</span><span class="sxs-lookup"><span data-stu-id="5297b-162">For more information about editing a binding file, see [Customizing Binding Files](http://go.microsoft.com/fwlink/?LinkID=155000) (http://go.microsoft.com/fwlink/?LinkID=155000).</span></span>  
  
## <a name="starting-or-stopping-an-application"></a><span data-ttu-id="5297b-163">启动或停止应用程序</span><span class="sxs-lookup"><span data-stu-id="5297b-163">Starting or Stopping an Application</span></span>  
 <span data-ttu-id="5297b-164">**停止应用程序更新项目**</span><span class="sxs-lookup"><span data-stu-id="5297b-164">**Stop an application to update artifacts**</span></span>  
  
-   <span data-ttu-id="5297b-165">如果不停止应用程序更新应用程序中的项目，你需要暂时暂停发布到 MessageBox 数据库通过禁用终结点，并停止并取消任何正在运行的实例。</span><span class="sxs-lookup"><span data-stu-id="5297b-165">If you do not stop an application to update artifacts in the application, you need to temporarily halt publication to the MessageBox database by disabling endpoints, and stop and unenlist any running instances.</span></span> <span data-ttu-id="5297b-166">若要停止并取消正在运行的实例，所有的已冻结或挂起实例必须使用方法手动恢复和完成，或终止。</span><span class="sxs-lookup"><span data-stu-id="5297b-166">To stop and unenlist running instances, all dehydrated or suspended instances must be either manually resumed and completed, or terminated.</span></span>  
  
-   <span data-ttu-id="5297b-167">尽管无需停止应用程序，以便更新项目，或安装应用程序，但是我们建议你始终停止应用程序，当你更新项目。</span><span class="sxs-lookup"><span data-stu-id="5297b-167">Although it is not required to stop an application in order to update an artifact or install the application, we recommend that you always stop an application when you update an artifact.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5297b-168">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5297b-168">See Also</span></span>  
 [<span data-ttu-id="5297b-169">如何将绑定导出到绑定文件</span><span class="sxs-lookup"><span data-stu-id="5297b-169">How to Export Bindings to a Binding File</span></span>](../technical-guides/how-to-export-bindings-to-a-binding-file.md)