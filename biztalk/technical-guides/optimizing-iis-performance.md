---
title: 优化 IIS 性能 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 6722a2ee-3704-4aaa-9b0d-cef97bcb9a04
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: ad8db99f2f6d26b05960950376e30faaa5a2155d
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36971446"
---
# <a name="optimizing-iis-performance"></a><span data-ttu-id="9b7f9-102">优化 IIS 性能</span><span class="sxs-lookup"><span data-stu-id="9b7f9-102">Optimizing IIS Performance</span></span>
## <a name="apply-iis-configuration-options-to-improve-iis-performance"></a><span data-ttu-id="9b7f9-103">应用 IIS 配置选项来提高 IIS 性能</span><span class="sxs-lookup"><span data-stu-id="9b7f9-103">Apply IIS configuration options to improve IIS performance</span></span>  
 <span data-ttu-id="9b7f9-104">Internet 信息服务 (IIS) 会公开大量影响 IIS 性能的配置参数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-104">Internet Information Services (IIS) exposes numerous configuration parameters that affect IIS performance.</span></span> <span data-ttu-id="9b7f9-105">本主题介绍了几种这些参数，并提供有关设置参数值以提高 IIS 性能的一般指南。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-105">This topic describes several of these parameters and provides general guidance for setting the parameter values to improve IIS performance.</span></span>  
  
### <a name="log-only-essential-information-or-completely-disable-iis-logging"></a><span data-ttu-id="9b7f9-106">仅记录基本信息或完全禁用 IIS 日志记录</span><span class="sxs-lookup"><span data-stu-id="9b7f9-106">Log only essential information or completely disable IIS logging</span></span>  
 <span data-ttu-id="9b7f9-107">应最小化或甚至在生产环境中禁用 IIS 日志记录。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-107">IIS logging should be minimized or even disabled in a production environment.</span></span> <span data-ttu-id="9b7f9-108">若要禁用日志记录，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="9b7f9-108">To disable logging follow these steps:</span></span>  
  
1.  <span data-ttu-id="9b7f9-109">单击**启动**，依次指向**所有程序**，单击**管理工具**，然后单击**Internet Information Services (IIS) Manager**.</span><span class="sxs-lookup"><span data-stu-id="9b7f9-109">Click **Start**, point to **All Programs**, click **Administrative Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
2.  <span data-ttu-id="9b7f9-110">在中**连接**窗格中，单击以展开**站点**，单击此项可选择为其想要禁用日志记录，请单击以选择的 Web 站点**功能视图**，，然后双击**日志记录**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-110">In the **Connections** pane, click to expand **Sites**, click to select the Web site for which you would like to disable logging, click to select **Features View**, and then double-click the **Logging** feature.</span></span>  
  
3.  <span data-ttu-id="9b7f9-111">单击**禁用**中**操作**窗格，可以禁用此网站的日志记录。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-111">Click **Disable** in the **Actions** pane to disable logging for this Web site.</span></span>  
  
### <a name="disable-iis-asp-debugging-in-production-environments"></a><span data-ttu-id="9b7f9-112">禁用 IIS ASP 在生产环境中进行调试</span><span class="sxs-lookup"><span data-stu-id="9b7f9-112">Disable IIS ASP debugging in production environments</span></span>  
 <span data-ttu-id="9b7f9-113">应在生产环境中禁用 IIS ASP 调试。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-113">IIS ASP debugging should be disabled in a production environment.</span></span> <span data-ttu-id="9b7f9-114">若要禁用 IIS ASP 调试执行以下步骤： 在**连接**窗格中，单击以展开**站点**，单击此项可选择为其想要禁用 ASP 调试，请单击以选中网站**功能视图**，然后双击**ASP**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-114">To disable IIS ASP debugging follow these steps: In the **Connections** pane, click to expand **Sites**, click to select the web site for which you would like to disable ASP debugging, click to select **Features View**, and then double-click the **ASP** feature.</span></span> <span data-ttu-id="9b7f9-115">单击此项可展开**编译**，单击此项可展开**调试属性**，并验证这两**启用客户端调试**和**启用服务器端调试**设置为**False**。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-115">Click to expand **Compilation**, click to expand **Debugging Properties**, and verify that both **Enable Client-side Debugging** and **Enable Server-side Debugging** are set to **False**.</span></span>  
  
1. <span data-ttu-id="9b7f9-116">单击**启动**，依次指向**所有程序**，单击**管理工具**，然后单击**Internet Information Services (IIS) Manager**.</span><span class="sxs-lookup"><span data-stu-id="9b7f9-116">Click **Start**, point to **All Programs**, click **Administrative Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
2. <span data-ttu-id="9b7f9-117">在中**连接**窗格中，单击以展开**站点**，单击此项可选择为其想要禁用 ASP 调试，请单击以选择的 web 站点**功能视图**，，然后双击**ASP**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-117">In the **Connections** pane, click to expand **Sites**, click to select the web site for which you would like to disable ASP debugging, click to select **Features View**, and then double-click the **ASP** feature.</span></span>  
  
3. <span data-ttu-id="9b7f9-118">单击此项可展开**编译**，单击此项可展开**调试属性**，并验证这两**启用客户端调试**和**启用服务器端调试**设置为**False**。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-118">Click to expand **Compilation**, click to expand **Debugging Properties**, and verify that both **Enable Client-side Debugging** and **Enable Server-side Debugging** are set to **False**.</span></span>  
  
4. <span data-ttu-id="9b7f9-119">如有必要，单击**Apply**中**操作**窗格。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-119">If necessary, click **Apply** in the **Actions** pane.</span></span>  
  
   <span data-ttu-id="9b7f9-120">禁用调试 ASP.NET 应用程序和 Web 服务通过指定\<编译调试 ="false"\> web 应用程序的 web.config 文件中的部分。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-120">Disable debugging for ASP.NET Applications and Web Services by specifying the \<compilation debug="false"\> section in the web.config file for the web application.</span></span>  
  
### <a name="tune-the-value-of-the-asp-threads-per-processor-limit-property"></a><span data-ttu-id="9b7f9-121">优化 ASP 线程针对每个处理器限制属性的值</span><span class="sxs-lookup"><span data-stu-id="9b7f9-121">Tune the value of the ASP Threads Per Processor Limit property</span></span>  
 <span data-ttu-id="9b7f9-122">ASP**线程针对每个处理器限制**属性指定的最大工作线程为每个 IIS 创建的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-122">The ASP **Threads Per Processor Limit** property specifies the maximum number of worker threads per processor that IIS creates.</span></span> <span data-ttu-id="9b7f9-123">之前的处理器使用率满足至少达到 50%或更高版本，应增加处理器限制每个线程的值。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-123">Increase the value for the Threads Per Processor Limit until the processor utilization meets at least 50 percent or above.</span></span> <span data-ttu-id="9b7f9-124">此设置可以极大地影响 Web 应用程序的可伸缩性和性能的服务器一般情况下。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-124">This setting can dramatically influence the scalability of your Web applications and the performance of your server in general.</span></span> <span data-ttu-id="9b7f9-125">由于此属性定义的 ASP 请求可同时执行的最大数量，此设置应保持为默认值，除非 ASP 应用程序正在扩展的调用外部组件。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-125">Because this property defines the maximum number of ASP requests that can execute simultaneously, this setting should remain at the default value unless your ASP applications are making extended calls to external components.</span></span> <span data-ttu-id="9b7f9-126">在这种情况下，可能会增加线程针对每个处理器限制的值。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-126">In this case, you may increase the value of Threads Per Processor Limit.</span></span> <span data-ttu-id="9b7f9-127">这样做使要创建更多的线程以处理更多的并发请求的服务器。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-127">Doing so allows the server to create more threads to handle more concurrent requests.</span></span> <span data-ttu-id="9b7f9-128">处理器限制每个线程的默认值为 25。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-128">The default value of Threads Per Processor Limit is 25.</span></span> <span data-ttu-id="9b7f9-129">此属性的最大建议的值为 100。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-129">The maximum recommended value for this property is 100.</span></span>  
  
 <span data-ttu-id="9b7f9-130">若要增加处理器限制每个线程的值，请执行以下步骤： 在**连接**窗格中，选择 web 服务器，请单击以选中**功能视图**，然后双击**ASP**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-130">To increase the value for the Threads Per Processor Limit follow these steps:In the **Connections** pane, select the web server, click to select **Features View**, and then double-click the **ASP** feature.</span></span>  
  
1. <span data-ttu-id="9b7f9-131">单击**启动**，依次指向**所有程序**，单击**管理工具**，然后单击**Internet Information Services (IIS) Manager**.</span><span class="sxs-lookup"><span data-stu-id="9b7f9-131">Click **Start**, point to **All Programs**, click **Administrative Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
2. <span data-ttu-id="9b7f9-132">在中**连接**窗格中，选择 web 服务器，请单击以选中**功能视图**，然后双击**ASP**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-132">In the **Connections** pane, select the web server, click to select **Features View**, and then double-click the **ASP** feature.</span></span>  
  
3. <span data-ttu-id="9b7f9-133">单击此项可展开**限制属性**下**行为**，单击**线程针对每个处理器限制**，输入所需的值**线程针对每个处理器限制**然后单击**Apply**中**操作**窗格。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-133">Click to expand **Limits Properties** under **Behavior**, click **Threads Per Processor Limit**, enter the desired value for **Threads Per Processor Limit** and click **Apply** in the **Actions** pane.</span></span>  
  
   <span data-ttu-id="9b7f9-134">有关如何修改中的属性详细信息\<限制\>元素的 IIS 7.5/7.0 \<asp\>元素中，请参阅[ASP 限制\<限制\>](http://go.microsoft.com/fwlink/?LinkId=157483) (http://go.microsoft.com/fwlink/?LinkId=157483).</span><span class="sxs-lookup"><span data-stu-id="9b7f9-134">For more information about how to modify the properties in the \<limits\> element of the IIS 7.5/7.0 \<asp\> element, see [ASP Limits \<limits\>](http://go.microsoft.com/fwlink/?LinkId=157483) (http://go.microsoft.com/fwlink/?LinkId=157483).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9b7f9-135">由于只能在服务器级别上应用此属性，此属性的修改会影响在服务器运行的所有网站。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-135">Because this property can only be applied at the server level, modification of this property affects all Web sites that run on the server.</span></span>  
  
### <a name="tune-the-value-of-the-asp-queue-length-property"></a><span data-ttu-id="9b7f9-136">优化 ASP Queue Length 属性的值</span><span class="sxs-lookup"><span data-stu-id="9b7f9-136">Tune the value of the ASP Queue Length property</span></span>  
 <span data-ttu-id="9b7f9-137">优化此属性的目标是确保良好的响应时间，同时最大程度减少 ASP 请求队列已满时，服务器何种频率发送到客户端的 HTTP 503 （服务器太忙） 错误。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-137">The goal of tuning this property is to ensure good response time while minimizing how often the server sends the HTTP 503 (Server Too Busy) error to clients when the ASP request queue is full.</span></span> <span data-ttu-id="9b7f9-138">如果 ASP Queue Length 属性的值太低，则服务器会更高的频率发送 HTTP 503 错误。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-138">If the value of ASP Queue Length property is too low, the server will send the HTTP 503 error with greater frequency.</span></span> <span data-ttu-id="9b7f9-139">如果 ASP Queue Length 属性的值过高，用户会认为，服务器不响应时实际上在队列中等待其请求。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-139">If the value of ASP Queue Length property is too high, users might perceive that the server is not responding when in fact their request is waiting in the queue.</span></span> <span data-ttu-id="9b7f9-140">通过在高流量时段观看队列，应该识别模式的 web 请求高峰和低谷。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-140">By watching the queue during periods of high traffic, you should discern a pattern of web request peaks and valleys.</span></span> <span data-ttu-id="9b7f9-141">请记下的最大资源值，并将峰值值的正上方的 ASP 队列长度属性的值。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-141">Make note of the peak value, and set the value of the ASP Queue Length property just above the peak value.</span></span> <span data-ttu-id="9b7f9-142">使用队列来处理短期的高峰，请确保响应时间并限制系统，以避免重载时持续出现意外的峰值。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-142">Use the queue to handle short-term spikes, ensure response time, and throttle the system to avoid overload when sustained, unexpected spikes occur.</span></span> <span data-ttu-id="9b7f9-143">如果还没有用于调整 ASP Queue Length 属性的数据，将是很好的起点设置队列的一对一比率为总线程数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-143">If you do not have data for adjusting the ASP Queue Length property, a good starting point will be to set a one-to-one ratio of queues to total threads.</span></span> <span data-ttu-id="9b7f9-144">例如，如果针对每个处理器限制对线程 ASP 属性设置为 25，并且具有四个处理器 (4 \* 25 = 100 线程)、 将 ASP 队列长度属性设置为 100 和调整从该处。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-144">For example, if the ASP Threads Per Processor Limit property is set to 25 and you have four processors (4 \* 25 = 100 threads), set the ASP Queue Length property to 100 and tune from there.</span></span>  
  
 <span data-ttu-id="9b7f9-145">若要增加队列长度的值属性，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="9b7f9-145">To increase the value for the Queue Length property follow these steps:</span></span>  
  
1. <span data-ttu-id="9b7f9-146">单击**启动**，依次指向**所有程序**，单击**管理工具**，然后单击**Internet Information Services (IIS) Manager**.</span><span class="sxs-lookup"><span data-stu-id="9b7f9-146">Click **Start**, point to **All Programs**, click **Administrative Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
2. <span data-ttu-id="9b7f9-147">在中**连接**窗格中，选择 Web 服务器，请单击以选中**功能视图**，然后双击**ASP**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-147">In the **Connections** pane, select the Web server, click to select **Features View**, and then double-click the **ASP** feature.</span></span>  
  
3. <span data-ttu-id="9b7f9-148">单击此项可展开**限制属性**下**行为**，单击**队列长度**，输入所需的值**队列长度**，然后单击**Apply**中**操作**窗格。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-148">Click to expand **Limits Properties** under **Behavior**, click **Queue Length**, enter the desired value for **Queue Length** and then click **Apply** in the **Actions** pane.</span></span>  
  
   <span data-ttu-id="9b7f9-149">有关如何修改中的属性详细信息\<限制\>元素的 IIS 7.5/7.0 \<asp\>元素中，请参阅[ASP 限制\<限制\>](http://go.microsoft.com/fwlink/?LinkId=157483) (http://go.microsoft.com/fwlink/?LinkId=157483).</span><span class="sxs-lookup"><span data-stu-id="9b7f9-149">For more information about how to modify the properties in the \<limits\> element of the IIS 7.5/7.0 \<asp\> element, see [ASP Limits \<limits\>](http://go.microsoft.com/fwlink/?LinkId=157483) (http://go.microsoft.com/fwlink/?LinkId=157483).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9b7f9-150">由于只能在服务器级别上应用此属性，此属性的修改会影响在服务器运行的所有网站。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-150">Because this property can only be applied at the server level, modification of this property affects all Web sites that run on the server.</span></span>  
  
### <a name="tune-the-maxpoolthreads-registry-entry"></a><span data-ttu-id="9b7f9-151">优化 MaxPoolThreads 注册表项</span><span class="sxs-lookup"><span data-stu-id="9b7f9-151">Tune the MaxPoolThreads registry entry</span></span>  
 <span data-ttu-id="9b7f9-152">此设置指定每个处理器创建的池线程的数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-152">This setting specifies the number of pool threads to create per processor.</span></span> <span data-ttu-id="9b7f9-153">池线程监视网络中的请求和处理传入的请求。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-153">Pool threads watch the network for requests and process incoming requests.</span></span> <span data-ttu-id="9b7f9-154">MaxPoolThreads 计数不包括 ISAPI 应用程序使用的线程。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-154">The MaxPoolThreads count does not include threads that are consumed by ISAPI applications.</span></span> <span data-ttu-id="9b7f9-155">通常情况下，不应创建每个处理器超过 20 个线程。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-155">Generally, you should not create more than 20 threads per processor.</span></span> <span data-ttu-id="9b7f9-156">MaxPoolThreads 是位于 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\InetInfo\Parameters\ 默认值为 4 的 REG_DWORD 注册表条目。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-156">MaxPoolThreads is a REG_DWORD registry entry located at HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\InetInfo\Parameters\ with a default value of 4.</span></span>  
  
### <a name="disable-wcf-services-tracing"></a><span data-ttu-id="9b7f9-157">禁用跟踪的 WCF 服务</span><span class="sxs-lookup"><span data-stu-id="9b7f9-157">Disable WCF services tracing</span></span>  
 <span data-ttu-id="9b7f9-158">使用配置编辑器工具 (SvcConfigEditor.exe) 来禁用 WCF 服务在生产环境中进行跟踪。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-158">Use the Configuration Editor Tool (SvcConfigEditor.exe) to disable WCF services tracing in a production environment.</span></span> <span data-ttu-id="9b7f9-159">有关配置编辑器工具的详细信息，请参阅[配置编辑器工具 (SvcConfigEditor.exe)](http://go.microsoft.com/fwlink/?LinkID=127070) (http://go.microsoft.com/fwlink/?LinkID=127070)。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-159">For more information about the Configuration Editor Tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](http://go.microsoft.com/fwlink/?LinkID=127070) (http://go.microsoft.com/fwlink/?LinkID=127070).</span></span>  
  
### <a name="configure-aspnet-20-maxconcurrentrequests-for-iis-7570-integrated-mode"></a><span data-ttu-id="9b7f9-160">为 IIS 7.5/7.0 集成模式下配置 ASP.NET 2.0 MaxConcurrentRequests</span><span class="sxs-lookup"><span data-stu-id="9b7f9-160">Configure ASP.NET 2.0 MaxConcurrentRequests for IIS 7.5/7.0 Integrated mode</span></span>  
 <span data-ttu-id="9b7f9-161">当 ASP.NET 2.0 承载在 IIS 7.5/7.0 集成模式下时，使用线程处理方式不同上 IIS 7.5/7.0 在经典模式下。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-161">When ASP.NET 2.0 is hosted on IIS 7.5/7.0 in Integrated Mode, the use of threads is handled differently than on IIS 7.5/7.0 in Classic Mode.</span></span> <span data-ttu-id="9b7f9-162">当 ASP.NET 2.0 承载于 IIS 7.5 集成模式中时，ASP.NET 2.0 限制并发执行的请求而不是并发执行的请求的线程数的数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-162">When ASP.NET 2.0 is hosted on IIS 7.5 in Integrated mode, ASP.NET 2.0 restricts the number of concurrently executing requests instead of the number of threads concurrently executing requests.</span></span> <span data-ttu-id="9b7f9-163">同步的情况下，这会因为请求的数量将是相同的线程数间接限制线程数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-163">For synchronous scenarios, this will indirectly limit the number of threads because the number of requests will be the same as the number of threads.</span></span> <span data-ttu-id="9b7f9-164">但异步情况下，请求和线程的数量可能非常不同因为您可以比以往更多请求的线程数多于。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-164">But for asynchronous scenarios, the number of requests and threads will likely be very different because you could have far more requests than threads.</span></span> <span data-ttu-id="9b7f9-165">运行时 ASP.NET 2.0 上 IIS 7.5 集成模式下，忽略 minFreeThreads 和 minLocalRequestFreeThreads 在 machine.config 中的"httpRuntime"元素。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-165">When you run ASP.NET 2.0 on IIS 7.5 in integrated mode, the minFreeThreads and minLocalRequestFreeThreads of the “httpRuntime” element in the machine.config are ignored.</span></span> <span data-ttu-id="9b7f9-166">IIS 7.5 集成模式下，对于名为内 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\2.0.50727.0 maxconcurrentrequestspercpu 配置一个 dword 值确定每个 CPU 的并发请求数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-166">For IIS 7.5 Integrated mode, a DWORD named MaxConcurrentRequestsPerCPU within HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\2.0.50727.0 determines the number of concurrent requests per CPU.</span></span> <span data-ttu-id="9b7f9-167">默认情况下，注册表项不存在并且每 CPU 的请求数限制为 12。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-167">By default, the registry key does not exist and the number of requests per CPU is limited to 12.</span></span> <span data-ttu-id="9b7f9-168">.NET framework 3.5 SP1 包括支持通过 aspnet.config 文件中的配置 IIS 应用程序池对 v2.0 二进制文件的更新。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-168">.NET Framework 3.5 SP1 includes an update to the v2.0 binaries that supports configuring IIS application pools via the aspnet.config file.</span></span> <span data-ttu-id="9b7f9-169">此配置仅适用于集成模式 （经典/ISAPI 模式会忽略这些设置）。下面列出了新的 aspnet.config 配置节具有默认值：</span><span class="sxs-lookup"><span data-stu-id="9b7f9-169">This configuration applies to integrated mode only (Classic/ISAPI mode ignores these settings).The new aspnet.config config section with default values is listed below:</span></span>  
  
```  
<system.web>  
   <applicationPool maxConcurrentRequestsPerCPU="12" maxConcurrentThreadsPerCPU="0" requestQueueLimit="5000"/>  
</system.web>  
```  
  
 <span data-ttu-id="9b7f9-170">在 IIS 7.5 集成模式下，maxWorkerThreads 和 machine.config 文件的"processModel"部分中的 maxIoThreads 参数不用于控制数本身运行的请求，但仍然使用它们来控制 CLR 线程池的大小由 ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-170">In IIS 7.5 Integrated Mode, the maxWorkerThreads and the maxIoThreads parameters in the “processModel” section of the machine.config file are not used to govern the number of running requests, per se, but they are still used to govern the size of the CLR thread pool used by ASP.NET.</span></span> <span data-ttu-id="9b7f9-171">当在 machine.config 的"processModel"部分具有"autoConfig = true"（这是默认设置），这将为应用程序池提供每个逻辑 CPU 的最多 100 个工作线程 (MaxWorkerThreads)。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-171">When the “processModel” section of the machine.config has “autoConfig=true” (which is the default setting), this will give the application pool up to 100 worker threads (MaxWorkerThreads) per logical CPU.</span></span> <span data-ttu-id="9b7f9-172">因此具有 2 个双核 Cpu 的常见商用服务器必须 400 MaxWorkerThreads。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-172">So a common commodity server with 2 dual-core CPUs would have 400 MaxWorkerThreads.</span></span> <span data-ttu-id="9b7f9-173">这应足以满足所有要求最苛刻的应用程序除外。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-173">This should be sufficient for all but the most demanding applications.</span></span>  
  
 <span data-ttu-id="9b7f9-174">有关在 IIS 7.5 上配置 ASP.NET 线程使用情况的详细信息，请参阅[Thomas Marquardt 的博客上的 IIS 7.0 ASP.NET 线程使用情况](http://go.microsoft.com/fwlink/?LinkId=157518)(http://go.microsoft.com/fwlink/?LinkId=157518)。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-174">For more information about configuring ASP.NET Thread Usage on IIS 7.5, see [Thomas Marquardt's Blog on ASP.NET Thread Usage on IIS 7.0](http://go.microsoft.com/fwlink/?LinkId=157518) (http://go.microsoft.com/fwlink/?LinkId=157518).</span></span>  
  
### <a name="configure-aspnet-4-maxconcurrentrequests-for-iis-7570-integrated-mode"></a><span data-ttu-id="9b7f9-175">为 IIS 7.5/7.0 集成模式下配置 ASP.NET 4 MaxConcurrentRequests</span><span class="sxs-lookup"><span data-stu-id="9b7f9-175">Configure ASP.NET 4 MaxConcurrentRequests for IIS 7.5/7.0 Integrated mode</span></span>  
 <span data-ttu-id="9b7f9-176">使用.NET Framework 4，maxconcurrentrequestspercpu 配置的默认设置为 5000，它是一个非常大的数字，并因此将留出足够的并发执行的异步请求。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-176">With .NET Framework 4, the default setting for maxConcurrentRequestsPerCPU is 5000 which is a very large number and therefore will allow plenty of asynchronous requests to execute concurrently.</span></span> <span data-ttu-id="9b7f9-177">有关详细信息，请参阅[ \<applicationPool\>元素 （Web 设置）](http://go.microsoft.com/fwlink/?LinkID=205339) (http://go.microsoft.com/fwlink/?LinkID=205339)。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-177">For more information, see [\<applicationPool\> Element (Web Settings)](http://go.microsoft.com/fwlink/?LinkID=205339) (http://go.microsoft.com/fwlink/?LinkID=205339).</span></span>  
  
 <span data-ttu-id="9b7f9-178">IIS 7.5/7.0 集成模式下，对于名为内 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\4.0.30319.0 maxconcurrentrequestspercpu 配置一个 dword 值确定每个 CPU 的并发请求数。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-178">For IIS 7.5/7.0 Integrated mode, a DWORD named MaxConcurrentRequestsPerCPU within HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\4.0.30319.0 determines the number of concurrent requests per CPU.</span></span> <span data-ttu-id="9b7f9-179">默认情况下，注册表项不存在并且每 CPU 的请求数被限制为 5000。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-179">By default, the registry key does not exist and the number of requests per CPU is limited to 5000.</span></span>  
  
### <a name="enable-iis-http-compression"></a><span data-ttu-id="9b7f9-180">启用 IIS HTTP 压缩</span><span class="sxs-lookup"><span data-stu-id="9b7f9-180">Enable IIS HTTP compression</span></span>  
 <span data-ttu-id="9b7f9-181">若要更有效地使用可用带宽，启用 IIS HTTP 压缩。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-181">To more efficiently use available bandwidth, enable IIS HTTP compression.</span></span> <span data-ttu-id="9b7f9-182">HTTP 压缩提供更快之间启用压缩的浏览器和 IIS，而不考虑你的内容是否从本地存储或 UNC 资源提供服务的传输时间。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-182">HTTP compression provides faster transmission time between compression-enabled browsers and IIS, regardless of whether your content is served from local storage or a UNC resource.</span></span>  
  
-   <span data-ttu-id="9b7f9-183">**若要在 Web 服务器级别配置压缩：**</span><span class="sxs-lookup"><span data-stu-id="9b7f9-183">**To configure compression at the Web server level:**</span></span>  
  
    1.  <span data-ttu-id="9b7f9-184">单击**启动**，依次指向**所有程序**，单击**管理工具**，然后单击**Internet Information Services (IIS) Manager**.</span><span class="sxs-lookup"><span data-stu-id="9b7f9-184">Click **Start**, point to **All Programs**, click **Administrative Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
    2.  <span data-ttu-id="9b7f9-185">在中**连接**窗格中，选择 Web 服务器，请单击以选中**功能视图**，然后双击**压缩**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-185">In the **Connections** pane, select the Web server, click to select **Features View**, and then double-click the **Compression** feature.</span></span>  
  
    3.  <span data-ttu-id="9b7f9-186">设置所需的压缩选项，然后单击**Apply**中**操作**窗格。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-186">Set the desired compression options and then click **Apply** in the **Actions** pane.</span></span>  
  
-   <span data-ttu-id="9b7f9-187">**若要在网站级别配置压缩：**</span><span class="sxs-lookup"><span data-stu-id="9b7f9-187">**To configure compression at the Web site level:**</span></span>  
  
    1.  <span data-ttu-id="9b7f9-188">单击**启动**，依次指向**所有程序**，单击**管理工具**，然后单击**Internet Information Services (IIS) Manager**.</span><span class="sxs-lookup"><span data-stu-id="9b7f9-188">Click **Start**, point to **All Programs**, click **Administrative Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
    2.  <span data-ttu-id="9b7f9-189">在中**连接**窗格中，单击以展开**站点**，单击此项可选择为其想要配置压缩，请单击以选择的 Web 站点**功能视图**，和然后双击**压缩**功能。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-189">In the **Connections** pane, click to expand **Sites**, click to select the Web site for which you would like to configure compression, click to select **Features View**, and then double-click the **Compression** feature.</span></span>  
  
    3.  <span data-ttu-id="9b7f9-190">设置所需的压缩选项，然后单击**Apply**中**操作**窗格。</span><span class="sxs-lookup"><span data-stu-id="9b7f9-190">Set the desired compression options and then click **Apply** in the **Actions** pane.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9b7f9-191">请参阅</span><span class="sxs-lookup"><span data-stu-id="9b7f9-191">See Also</span></span>  
 [<span data-ttu-id="9b7f9-192">优化性能</span><span class="sxs-lookup"><span data-stu-id="9b7f9-192">Optimizing Performance</span></span>](../technical-guides/optimizing-performance.md)