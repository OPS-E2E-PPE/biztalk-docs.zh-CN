---
title: 清单：最佳做法的 HYPER-V 上安装和配置 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 5b5ddbb5-3752-4294-ae6a-c14363b3ddc9
caps.latest.revision: 18
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 567d5e4fe422489bec5343b65faa02d8c0243fdb
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65400431"
---
# <a name="checklist-best-practices-for-installing-and-configuring-biztalk-server-on-hyper-v"></a>清单：安装和配置 BizTalk Server 上的 HYPER-V 的最佳实践
以下各节是安装的摘要和配置要求中所述[HYPER-V 上部署 BizTalk Server](../technical-guides/deploying-biztalk-server-on-hyper-v.md)本指南的部分。 作为快速参考安装、 配置和部署时应使用这些[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]在 HYPER-V 环境中。 有关详细信息提供了指向相关部分。  

## <a name="before-installing-hyper-v"></a>之前安装的 HYPER-V...  

|步骤|参考|  
|----------|---------------|  
|HYPER-V 是适用于 64 位版本的 Windows Server 的服务器角色。|请参阅[核对清单：安装和配置 BizTalk Server 上的 HYPER-V 的最佳实践](../technical-guides/checklist-best-practices-to-install-and-configure-biztalk-server-on-hyper-v.md)|  
|请确保您的处理器支持硬件辅助虚拟化和数据执行保护 (DEP)，并且已启用这些功能。 这要求与 Intel 虚拟化技术 (Intel VT) 或 AMD 虚拟化 (AMD-V) 兼容的处理器。|请参阅[安装 HYPER-V 角色](https://docs.microsoft.com/windows-server/virtualization/hyper-v/get-started/install-the-hyper-v-role-on-windows-server)。|  
|为根分区中使用 Windows Server Core 版本。 这将最大程度减少服务器开销并提高性能的 HYPER-V。|请参阅[安装服务器核心](https://docs.microsoft.com/windows-server/get-started/getting-started-with-server-core)。|  
|在根分区上运行的 HYPER-V 服务器角色。|请参阅[性能优化的 HYPER-V 服务器](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/):<br />**专用的服务器角色**<br />根分区应将专用于虚拟化服务器角色。 其他服务器角色可以性能产生负面影响的虚拟化服务器，尤其是在它们需要占用大量 CPU、 内存或 I/O 带宽。 最大程度减少根分区中的服务器角色中还有其他好处，如减少攻击面和更新的频率。 系统管理员应仔细考虑，因为某些软件可能会在虚拟化服务器的整体性能产生负面影响，根分区中安装的软件。<br/><br/> 请参阅[HYPER-V 配置](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/configuration)有关的指南。|  

## <a name="when-creating-hyper-v-virtual-machines"></a>当创建的 HYPER-V 虚拟机...  

|步骤|参考|  
|----------|---------------|  
|使用固定的大小虚拟硬盘 (VHD) 提供了改进的性能相比操作系统驱动器的动态调整大小的 Vhd。|请参阅[HYPER-V 存储 I/O 性能](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/storage-io-performance)有关的指南： <br />**固定大小的 VHD**<br />创建 VHD 文件时，首先分配为 VHD 的空间。 这种类型的 VHD 是不太易于片段，这减少了 I/O 吞吐量，当单个 I/O 拆分为多个 I/o。 它具有三种 VHD 类型的最小 CPU 开销，因为读取和写入不需要查找块的映射。|  
|固定大小虚拟硬盘 (VHD) 磁盘用于较高的磁盘 I/O 活动并配置为使用 SCSI 控制器的数据卷的磁盘。 对于跨多个数据驱动器的高密集型存储 I/O 工作负荷，每个 VHD 应附加到单独的合成 SCSI 控制器以提高整体性能。 此外，每个 VHD 应存储在单独的物理磁盘上。|请参阅[HYPER-V 存储 I/O 性能](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/storage-io-performance)有关的指南：<br />**合成 SCSI 控制器**<br />综合存储控制器上减少 CPU 开销高于仿真的 IDE 设备使用的存储 I/o 提供显著提高性能。 VM 集成服务包括此存储设备的已启用驱动程序和所需的来宾操作系统，若要对其进行检测。 必须在操作系统正常，启动 IDE 设备上装载操作系统磁盘，但 VM 集成服务加载修复重新路由到合成存储设备的 IDE 设备 I/o 的筛选器驱动程序。<br />我们强烈建议您装入直接向合成 SCSI 控制器的数据驱动器，因为该配置具有降低的 CPU 开销。 如果其预期的 I/O 率很高，还应装载日志文件和操作系统分页文件直接到合成 SCSI 控制器。<br />对于跨多个数据驱动器的高密集型存储 I/O 工作负荷，每个 VHD 应附加到单独的合成 SCSI 控制器以提高整体性能。 此外，每个 VHD 应存储在单独的物理磁盘上。|  
|使用 SCSI 控制器将 VHD 磁盘的高 I/O 活动，如附加的 SQL Server 数据和日志文件。 **注意：** 不要将系统磁盘附加到 SCSI 控制器。 包含一个操作系统虚拟硬盘必须附加到 IDE 控制器。|即使 HYPER-V IDE 控制器和 SCSI 控制器提供了类似的性能，如果安装了 HYPER-V 集成服务，只能被安装 SCSI 控制器。 因此，附加传递磁盘的 SCSI 控制器的使用将确保 HYPER-V 集成服务安装这反过来将确保获得最佳磁盘 I/O 性能。|  
|配置虚拟机的网络时，请使用网络适配器而不是旧版网络适配器。 旧版网络适配器用于不支持集成组件的操作系统。|**合成网络适配器**<br />专为虚拟机以实现显著的合成网络适配器能减少 CPU 开销的 HYPER-V 功能相比到仿真的网络适配器，以模拟现有硬件的网络 I/O。 合成网络适配器之间的子和根分区 VMBus 通过使用共享的内存的更高效的数据传输进行通信。 仿真的网络适配器应通过 VM 设置对话框中删除并替换为合成网络适配器。 来宾要求安装 VM 集成服务。|  
|请确保 integration services 在任何已启用的来宾操作系统上安装和验证已安装最新版本的 integration services。 若要检查最新版本的 integration services，请运行**Windows Update**。|请参阅[HYPER-V 处理器性能](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/processor-performance)有关的指南：<br />**启用的来宾**<br />可能会建议你使用 Windows Server 作为来宾操作系统。 启发方法减少的 VM 中运行的 Windows 的 CPU 开销。 集成服务提供其他 I/O 自旋。 根据服务器负载，它可以是相应托管服务器应用程序中更好的性能的 Windows Server 来宾。|  
|只要有可能，配置虚拟处理器到可用逻辑处理器的 1-1 分配。|有关配置虚拟处理器到可用逻辑处理器的 1 对 1 分配的详细信息请参阅中的"优化处理器性能"部分[核对清单：Hyper V 上优化性能](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)。|  
|将转换或迁移虚拟机运行于 Microsoft Virtual PC、 Microsoft Virtual Server 或 VMWare ESX Server 的 HYPER-V 上运行。|-若要将转换或迁移虚拟机的 HYPER-V 上运行使用 System Center Virtual Machine Manager。 <br />-如果需要，可以手动执行转换在 Microsoft Virtual PC 或 Microsoft Virtual Server 上运行的虚拟机的过程。 有关详细信息，请参阅[虚拟机的迁移指南：如何从虚拟服务器迁移到 HYPER-V](http://go.microsoft.com/fwlink/?LinkID=137258)。<br />-该示例工具**VMC2Hyper V**还可用于迁移到 HYPER-V 的 Microsoft Virtual PC 或 Microsoft Virtual Server 上运行的虚拟机。 有关 VMC2Hyper V 示例工具的详细信息，请参阅[VMC to HYPER-V 导入工具可用](http://go.microsoft.com/fwlink/?LinkID=135683)。 |  

## <a name="when-installing-and-configuring-biztalk-server"></a>安装和配置 BizTalk Server 时...  
 时在虚拟环境中安装 BizTalk Server，如物理环境中所示，应遵循相同的做法。 安装和配置 BizTalk Server 期间，应使用以下资源：  


|                                                                                                                                                                                                                                                                                                                                                   步骤                                                                                                                                                                                                                                                                                                                                                   |                                                                          参考                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                                                                                                                     有关如何在来宾操作系统上安装 BizTalk Server 的说明，请参阅[BizTalk Server 安装指南](../install-and-config-guides/biztalk-server-what-s-new-installation-configuration-and-upgrade.md)。                                                                                                                                                                                                                                     |                                                                                                                                                              |
|                                                                                                                                                                                                                                                               运行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]上已完成的 BizTalk Server 安装的最佳做法分析器 (BPA) 工具。                                                                                                                                                                                                                                                                |                                         下载[BPA](https://www.microsoft.com/download/details.aspx?id=43382)                                         |
|                                                                                                                                                                                     [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库托管在 SQL Server 上。 SQL Server 实例上运行 theSQL Server 最佳做法分析器 (BPA) 工具，然后配置[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库。                                                                                                                                                                                      |                                   下载[SQL Server BPA](https://www.microsoft.com/download/details.aspx?id=29302)                                    |
| Microsoft[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]操作指南提供了可用于确保已安装所有必要的必备软件的操作准备情况检查表。 提供的清单[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]作为的一部分所需的所有组件提供特定的配置信息[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]堆栈包括操作系统、 IIS 和 SQL Server。 此外，有关如何配置 BizTalk Server 的高可用性提供指导。 |                               读取 (.../technical-guides/BizTalk 操作 Guide](biztalk-server-2010-operations-guide.md)                               |
|                                                                                                                                                                                                                                                                                                                      优化 BizTalk Server 安装的性能。                                                                                                                                                                                                                                                                                                                       |         请参阅[BizTalk Server 性能优化指南](../technical-guides/biztalk-server-2010-performance-optimization-guide.md)有关的指南          |
|                                                                                                                                                                                                                                                                                     安装和运行 BizTalk 运行状况监视器来分析和验证 BizTalk Server MessageBox 数据库的配置。                                                                                                                                                                                                                                                                                      |                                           下载[BHM](https://www.microsoft.com/download/details.aspx?id=43716)                                           |
|                                                                                                                                                                                                                                                                                                        确认 CPU 正在正确分配给在 HYPER-V 中运行的来宾操作系统。                                                                                                                                                                                                                                                                                                        | 请参阅**测量处理器性能**在[核对清单：Hyper V 上测量性能](../technical-guides/checklist-measuring-performance-on-hyper-v.md)。 |

