---
title: "清单： 更新业务流程使用的并行版本控制 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 97f66987-0269-4dfe-a648-7b68412e86fe
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a8e9ed9f260b7b7b8b269e6a4b5e22411ce05b5c
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
---
# <a name="checklist-updating-an-orchestration-using-side-by-side-versioning"></a><span data-ttu-id="38ec5-102">清单： 更新业务流程使用的并行版本控制</span><span class="sxs-lookup"><span data-stu-id="38ec5-102">Checklist: Updating an Orchestration Using Side-by-Side Versioning</span></span>
<span data-ttu-id="38ec5-103">对业务流程更改可以将更多地涉及不是更改为其他项目，比如地图。</span><span class="sxs-lookup"><span data-stu-id="38ec5-103">Changes to orchestrations can be more involved than changes to other artifacts, such as maps.</span></span> <span data-ttu-id="38ec5-104">如果你有生存期较短的业务流程，简单的更新可能足够。</span><span class="sxs-lookup"><span data-stu-id="38ec5-104">If you have short-lived orchestrations, then a simple update may be sufficient.</span></span> <span data-ttu-id="38ec5-105">但是，如果你有长时间运行业务流程，或者无法终止现有实例，则的并行版本控制将唯一的选项。</span><span class="sxs-lookup"><span data-stu-id="38ec5-105">But if you have long-running orchestrations or cannot terminate existing instances, then side-by-side versioning will be your only option.</span></span>  
  
 <span data-ttu-id="38ec5-106">当业务流程处理长时间运行事务时，你无法立即更改业务流程的已更新版本。</span><span class="sxs-lookup"><span data-stu-id="38ec5-106">When an orchestration handles long-running transactions, you cannot change to the updated version of the orchestration immediately.</span></span> <span data-ttu-id="38ec5-107">你必须允许要完成处理其消息，以便它们不会丢失的原始版本。</span><span class="sxs-lookup"><span data-stu-id="38ec5-107">You must allow the original version to finish processing its messages so that they are not lost.</span></span> <span data-ttu-id="38ec5-108">为此，请将已更新的业务流程与原始版本部署到同一应用程序。</span><span class="sxs-lookup"><span data-stu-id="38ec5-108">To accomplish this, you deploy the updated orchestration into the same application as the original one.</span></span> <span data-ttu-id="38ec5-109">然后，停止原始版本并启动已更新的版本，以便在先前版本继续处理任何正在处理的消息时可以接收所有新消息。</span><span class="sxs-lookup"><span data-stu-id="38ec5-109">You then stop the original version and start the updated version so that it receives all new messages while the previous version continues to process any in-flight messages.</span></span> <span data-ttu-id="38ec5-110">在原始业务流程完成其所有消息的处理后，从其部署的 BizTalk 应用程序中取消对它的部署。</span><span class="sxs-lookup"><span data-stu-id="38ec5-110">After the original orchestration has finished processing all of its messages, you undeploy it from the BizTalk application in which it was deployed.</span></span>  
  
|<span data-ttu-id="38ec5-111">步骤</span><span class="sxs-lookup"><span data-stu-id="38ec5-111">Steps</span></span>|<span data-ttu-id="38ec5-112">参考</span><span class="sxs-lookup"><span data-stu-id="38ec5-112">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="38ec5-113">对业务流程进行必要的更改后, 递增程序集版本号。</span><span class="sxs-lookup"><span data-stu-id="38ec5-113">After making the necessary changes to the orchestration, increment the assembly version number.</span></span>|[<span data-ttu-id="38ec5-114">如何更新程序集</span><span class="sxs-lookup"><span data-stu-id="38ec5-114">How to Update an Assembly</span></span>](../technical-guides/how-to-update-an-assembly.md)|  
|<span data-ttu-id="38ec5-115">部署到 BizTalk 应用程序，从 Visual Studio 程序集，然后测试程序集。</span><span class="sxs-lookup"><span data-stu-id="38ec5-115">Deploy the assembly from Visual Studio into a BizTalk application, and then test the assembly.</span></span> <span data-ttu-id="38ec5-116">**注意：**确保你选择要将程序集安装在 GAC 中的部署选项。</span><span class="sxs-lookup"><span data-stu-id="38ec5-116">**Note:**  Make sure you select the deployment option to install the assembly in the GAC.</span></span>|<span data-ttu-id="38ec5-117">[部署到 BizTalk 应用程序程序集从 Visual Studio BizTalk](http://go.microsoft.com/fwlink/?LinkID=154719) (http://go.microsoft.com/fwlink/?LinkID=154719)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-117">[Deploying BizTalk Assemblies from Visual Studio into a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154719) (http://go.microsoft.com/fwlink/?LinkID=154719).</span></span>|  
|<span data-ttu-id="38ec5-118">从测试环境到.msi 文件中的应用程序导出程序集。</span><span class="sxs-lookup"><span data-stu-id="38ec5-118">Export the assembly from the application in your test environment into an .msi file.</span></span>|[<span data-ttu-id="38ec5-119">如何将应用程序导出到 .msi 文件</span><span class="sxs-lookup"><span data-stu-id="38ec5-119">How to Export an Application to an .msi File</span></span>](../technical-guides/how-to-export-an-application-to-an-msi-file.md)|  
|<span data-ttu-id="38ec5-120">.Msi 文件导入生产环境中包含你想要更新的业务流程的 BizTalk 应用程序。</span><span class="sxs-lookup"><span data-stu-id="38ec5-120">Import the .msi file into the BizTalk application in your production environment that contains the orchestration that you want to update.</span></span> <span data-ttu-id="38ec5-121">**注意：**可以为测试程序集，以及将其部署到生产环境中使用以下步骤。</span><span class="sxs-lookup"><span data-stu-id="38ec5-121">**Note:**  You can use the following steps for testing the assembly as well as deploying it into your production environment.</span></span>|[<span data-ttu-id="38ec5-122">如何从 .msi 文件导入应用程序</span><span class="sxs-lookup"><span data-stu-id="38ec5-122">How to Import an Application from an .msi File</span></span>](../technical-guides/how-to-import-an-application-from-an-msi-file.md)|  
|<span data-ttu-id="38ec5-123">绑定更新业务流程作为原始业务流程中使用相同的绑定。</span><span class="sxs-lookup"><span data-stu-id="38ec5-123">Bind the updated orchestration using the same bindings as the original orchestration.</span></span>|<span data-ttu-id="38ec5-124">[如何配置适用于业务流程的绑定](http://go.microsoft.com/fwlink/?LinkId=154850)(http://go.microsoft.com/fwlink/?LinkId=154850)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-124">[How to Configure Bindings for an Orchestration](http://go.microsoft.com/fwlink/?LinkId=154850) (http://go.microsoft.com/fwlink/?LinkId=154850).</span></span>|  
|<span data-ttu-id="38ec5-125">取消登记原始业务流程，然后启动已更新的业务流程。</span><span class="sxs-lookup"><span data-stu-id="38ec5-125">Unenlist the original orchestration, and then start the updated orchestration.</span></span> <span data-ttu-id="38ec5-126">**注意：**以避免任何已删除的消息，你应执行此操作以编程方式。</span><span class="sxs-lookup"><span data-stu-id="38ec5-126">**Note:**  To avoid any dropped messages, you should do this programmatically.</span></span>|<span data-ttu-id="38ec5-127">有关以编程方式部署业务流程的详细信息，请参阅[部署和启动新版本的业务流程以编程方式](http://go.microsoft.com/fwlink/?LinkId=154851)(http://go.microsoft.com/fwlink/?LinkId=154851)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-127">For more information about deploying the orchestration programmatically, see [Deploying and Starting a New Version of an Orchestration Programmatically](http://go.microsoft.com/fwlink/?LinkId=154851) (http://go.microsoft.com/fwlink/?LinkId=154851).</span></span><br /><br /> <span data-ttu-id="38ec5-128">有关手动部署业务流程的详细信息，请参阅以下 BizTalk Server 帮助中：</span><span class="sxs-lookup"><span data-stu-id="38ec5-128">For more information about deploying the orchestration manually, see the following in BizTalk Server Help:</span></span><br /><br /> <span data-ttu-id="38ec5-129">-   [如何取消登记业务流程](http://go.microsoft.com/fwlink/?LinkId=154852)(http://go.microsoft.com/fwlink/?LinkId=154852)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-129">-   [How to Unenlist an Orchestration](http://go.microsoft.com/fwlink/?LinkId=154852) (http://go.microsoft.com/fwlink/?LinkId=154852).</span></span><br /><span data-ttu-id="38ec5-130">-   [如何登记业务流程](http://go.microsoft.com/fwlink/?LinkId=154853)(http://go.microsoft.com/fwlink/?LinkId=154853)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-130">-   [How to Enlist an Orchestration](http://go.microsoft.com/fwlink/?LinkId=154853) (http://go.microsoft.com/fwlink/?LinkId=154853).</span></span><br /><span data-ttu-id="38ec5-131">-   [如何启动 Orchestration](http://go.microsoft.com/fwlink/?LinkId=154854) (http://go.microsoft.com/fwlink/?LinkId=154854)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-131">-   [How to Start an Orchestration](http://go.microsoft.com/fwlink/?LinkId=154854) (http://go.microsoft.com/fwlink/?LinkId=154854).</span></span>|  
|<span data-ttu-id="38ec5-132">监视的系统的使用组中心数据库的原始 orchestration 版本实例页上的查询视图。</span><span class="sxs-lookup"><span data-stu-id="38ec5-132">Monitor the system for instances of the original orchestration version using the Group Hub page query view.</span></span>|<span data-ttu-id="38ec5-133">[如何查看为业务流程的实例信息](http://go.microsoft.com/fwlink/?LinkId=154855)(http://go.microsoft.com/fwlink/?LinkId=154855)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-133">[How to View Instance Information for an Orchestration](http://go.microsoft.com/fwlink/?LinkId=154855) (http://go.microsoft.com/fwlink/?LinkId=154855).</span></span>|  
|<span data-ttu-id="38ec5-134">完成所有活动、 已冻结，和挂起实例后，取消部署应用程序从原始的业务流程。</span><span class="sxs-lookup"><span data-stu-id="38ec5-134">When all of its active, dehydrated, and suspended instances are complete, undeploy the original orchestration from the application.</span></span>|<span data-ttu-id="38ec5-135">[如何从应用程序删除业务流程](http://go.microsoft.com/fwlink/?LinkId=154856)(http://go.microsoft.com/fwlink/?LinkId=154856)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-135">[How to Remove an Orchestration from an Application](http://go.microsoft.com/fwlink/?LinkId=154856) (http://go.microsoft.com/fwlink/?LinkId=154856).</span></span>|  
|<span data-ttu-id="38ec5-136">（可选） 从运行应用程序的每台计算机上的 GAC 中卸载原始程序集版本。</span><span class="sxs-lookup"><span data-stu-id="38ec5-136">Optionally uninstall the original assembly version from the GAC on each computer running the application.</span></span>|<span data-ttu-id="38ec5-137">[如何从 GAC 中卸载程序集](http://go.microsoft.com/fwlink/?LinkId=154857)(http://go.microsoft.com/fwlink/?LinkId=154857)。</span><span class="sxs-lookup"><span data-stu-id="38ec5-137">[How to Uninstall an Assembly from the GAC](http://go.microsoft.com/fwlink/?LinkId=154857) (http://go.microsoft.com/fwlink/?LinkId=154857).</span></span>|  
  
## <a name="binding-to-receive-ports-and-locations"></a><span data-ttu-id="38ec5-138">绑定，使其接收端口和位置</span><span class="sxs-lookup"><span data-stu-id="38ec5-138">Binding to Receive Ports and Locations</span></span>  
 <span data-ttu-id="38ec5-139">如果你想要创建新接收端口和业务流程的新版本的位置，只需将绑定到的新端口和登记/启动新的项目通常会足够。</span><span class="sxs-lookup"><span data-stu-id="38ec5-139">If you want to create new receive ports and locations for the new version of the orchestration, simply binding to the new ports and enlisting/starting the new artifacts will typically be sufficient.</span></span> <span data-ttu-id="38ec5-140">创建新的接收位置和端口通常是首选的方法，尤其是如果你的方案使用长时间运行业务流程的关联数仍收到需要处理。</span><span class="sxs-lookup"><span data-stu-id="38ec5-140">Creating new receive locations and ports is usually the preferred approach, especially if your scenario uses long-running orchestrations where a number of correlating receives still need to be processed.</span></span> <span data-ttu-id="38ec5-141">在这种情况下，你可能无法重用现有的接收端口或执行征用。</span><span class="sxs-lookup"><span data-stu-id="38ec5-141">In this case, you may not be able to reuse existing receive ports or perform unenlistment.</span></span> <span data-ttu-id="38ec5-142">如果创建新端口，请确保有可能你的后端和合作伙伴系统以处理此更改。</span><span class="sxs-lookup"><span data-stu-id="38ec5-142">If you create new ports, be sure that it is possible for your backend and partner systems to handle this change.</span></span> <span data-ttu-id="38ec5-143">如果没有，你将必须等待所有的长时间运行实例，以在升级之前并且最后结束。</span><span class="sxs-lookup"><span data-stu-id="38ec5-143">If not, you will have to wait for all long-running instances to culminate before upgrading.</span></span>  
  
 <span data-ttu-id="38ec5-144">如果你想要使用现有的端口，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="38ec5-144">If you want to use existing ports, do the following:</span></span>  
  
1.  <span data-ttu-id="38ec5-145">绑定到现有端口业务流程的新版本。</span><span class="sxs-lookup"><span data-stu-id="38ec5-145">Bind the new version of the orchestration to existing ports.</span></span>  
  
2.  <span data-ttu-id="38ec5-146">取消登记 （但不是会停止） 旧版本的业务流程。</span><span class="sxs-lookup"><span data-stu-id="38ec5-146">Unenlist (but do not stop) the old orchestration version.</span></span>  
  
3.  <span data-ttu-id="38ec5-147">登记和启动新的业务流程版本。</span><span class="sxs-lookup"><span data-stu-id="38ec5-147">Enlist and start the new orchestration version.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="38ec5-148">可以使用脚本若要执行步骤 2 和 3 中一个事务，以便消息将不缺少之间手动单击订阅。</span><span class="sxs-lookup"><span data-stu-id="38ec5-148">You can use a script to do steps 2 and 3 in one transaction, so that messages will not be missing subscriptions between manual clicking.</span></span>