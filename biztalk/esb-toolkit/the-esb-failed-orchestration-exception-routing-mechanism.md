---
title: ESB 故障业务流程异常路由机制 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: aa05f44b-7fb2-48fd-886d-c6d179904e6d
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1da528a8af1b232f014a349afae292a7c0e319d5
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65399818"
---
# <a name="the-esb-failed-orchestration-exception-routing-mechanism"></a><span data-ttu-id="c9ff5-102">ESB 故障业务流程异常路由机制</span><span class="sxs-lookup"><span data-stu-id="c9ff5-102">The ESB Failed Orchestration Exception Routing Mechanism</span></span>
<span data-ttu-id="c9ff5-103">ESB 失败，业务流程异常路由机制提供了以下功能：</span><span class="sxs-lookup"><span data-stu-id="c9ff5-103">The ESB Failed Orchestration Exception Routing mechanism provides the following features:</span></span>  
  
-   <span data-ttu-id="c9ff5-104">**创建捕获环境属性的错误消息。**</span><span class="sxs-lookup"><span data-stu-id="c9ff5-104">**Creating fault messages that capture ambient properties.**</span></span> <span data-ttu-id="c9ff5-105">**CreateFaultMessage**方法将生成错误消息包含的业务流程服务名称和服务实例 ID，当前激活业务流程形状中，该业务流程将应用程序的名称部署，处理业务流程中，服务器的名称以及异常日期和时间 （UTC 格式）。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-105">The **CreateFaultMessage** method generates a fault message that contains the orchestration service name and service instance ID, the currently activated orchestration shape, the name of the application to which the orchestration is deployed, the name of the server processing the orchestration, and the exception date and time (UTC format).</span></span> <span data-ttu-id="c9ff5-106">它还将隐式添加当前**System.Exception**在当前业务流程形状的异常处理程序中生成的对象。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-106">It also implicitly adds the current **System.Exception** object generated in the exception handler of the current orchestration shape.</span></span>  
  
-   <span data-ttu-id="c9ff5-107">**将现有业务流程消息添加到的错误消息**。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-107">**Adding existing orchestration messages to a fault message**.</span></span> <span data-ttu-id="c9ff5-108">**AddMessage**方法保留的业务流程消息和错误消息中的所有消息上下文属性的 XLANG 设置。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-108">The **AddMessage** method preserves the XLANG setting of the orchestration message and all the message context properties in the fault message.</span></span>  
  
-   <span data-ttu-id="c9ff5-109">**显式将一个现有的异常对象添加到的错误消息**。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-109">**Explicitly adding an existing Exception object to a fault message**.</span></span> <span data-ttu-id="c9ff5-110">**SetFaultMsgException**方法以将对象序列化为**System.Exception**并保留在错误消息中。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-110">The **SetFaultMsgException** method serializes the object as a **System.Exception** and preserves it in the fault message.</span></span>  
  
-   <span data-ttu-id="c9ff5-111">**从订阅服务器收到的错误消息中检索枚举的集合的类型无消息**。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-111">**Retrieving an enumerated collection of type-less messages from a fault message received by a subscriber**.</span></span> <span data-ttu-id="c9ff5-112">**GetMessages**方法从失败的业务流程作为 XLANG 消息中检索所有持久的消息。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-112">The **GetMessages** method retrieves all persisted messages from the failed orchestration as XLANG messages.</span></span> <span data-ttu-id="c9ff5-113">它在每个 XLANG 消息中返回每个持久化消息的所有原始上下文的属性。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-113">It returns all the original context properties of each persisted message in each XLANG message.</span></span>  
  
-   <span data-ttu-id="c9ff5-114">**从订阅服务器收到的错误消息中检索强类型化的 XLANG 业务流程消息**。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-114">**Retrieving a strongly typed XLANG orchestration message from a fault message received by a subscriber**.</span></span> <span data-ttu-id="c9ff5-115">**GetMessage**方法从错误消息作为 XLANG 消息中检索特定类型的持久的消息。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-115">The **GetMessage** method retrieves a persisted message of a specific type from the fault message as an XLANG message.</span></span> <span data-ttu-id="c9ff5-116">它返回原始上下文的所有属性持久化消息 XLANG 消息中。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-116">It returns all the original context properties of the persisted message in the XLANG message.</span></span> <span data-ttu-id="c9ff5-117">它还支持检索**System.Exception**对象生成的失败的业务流程和检索的持久化**System.Exception**错误消息中的对象。</span><span class="sxs-lookup"><span data-stu-id="c9ff5-117">It also supports retrieval of the **System.Exception** object generated by the failed orchestration and retrieves a persisted **System.Exception** object from the fault message.</span></span>