---
title: ESB JMS 编码器和解码器组件 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 4e5591c2-d2ca-4168-8026-059fe51dd588
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a7c1be49757872021ab19b419eb0042261a76e15
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65399778"
---
# <a name="the-esb-jms-encoder-and-decoder-components"></a><span data-ttu-id="77e1c-102">ESB JMS 编码器和解码器组件</span><span class="sxs-lookup"><span data-stu-id="77e1c-102">The ESB JMS Encoder and Decoder Components</span></span>
<span data-ttu-id="77e1c-103">一些集成的解决方案涉及到 Java 消息服务 (JMS) 和 SOAP 消息发送到或从 IBM WebSphere MQ;[!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)]包括两个 JMS 管道组件在这些情况下使用的托管代码编写的。</span><span class="sxs-lookup"><span data-stu-id="77e1c-103">Some integration solutions involve Java Message Service (JMS) and SOAP messages sent to or from IBM WebSphere MQ; [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] includes two JMS pipeline components written in managed code for use in these situations.</span></span> <span data-ttu-id="77e1c-104">组件读取或写入 MQ 消息标头使用与消息关联的上下文属性的值的 JMS 部分。</span><span class="sxs-lookup"><span data-stu-id="77e1c-104">The components read or write the JMS portion of the MQ message header using the values of context properties associated with the message.</span></span> <span data-ttu-id="77e1c-105">目前，有 60 多个不同类型的 JMS 标头中与 WebSphere MQ Series 系统; 结合使用ESB JMS 组件仅使用 MQRFH2 标头。</span><span class="sxs-lookup"><span data-stu-id="77e1c-105">Currently, there are more than 60 different types of JMS headers in use with WebSphere MQ Series systems; the ESB JMS components work only with MQRFH2 headers.</span></span>  
  
## <a name="installation"></a><span data-ttu-id="77e1c-106">安装</span><span class="sxs-lookup"><span data-stu-id="77e1c-106">Installation</span></span>  
 <span data-ttu-id="77e1c-107">自动安装 ESB 核心 BizTalk Server 管道组件文件夹中安装 JMS 编码器和 JMS 解码器组件。</span><span class="sxs-lookup"><span data-stu-id="77e1c-107">Installing the ESB Core automatically installs the JMS Encoder and JMS Decoder components in the BizTalk Server Pipeline Components folder.</span></span>  
  
## <a name="how-it-works"></a><span data-ttu-id="77e1c-108">其工作原理</span><span class="sxs-lookup"><span data-stu-id="77e1c-108">How It Works</span></span>  
 <span data-ttu-id="77e1c-109">JMS 管道组件检查消息标头和仅对具有的消息**MQMD_Format**标头设置为**RFH (MQRFH2)**。</span><span class="sxs-lookup"><span data-stu-id="77e1c-109">The JMS pipeline components inspect the message headers and operate only on messages that have the **MQMD_Format** header set to **RFH (MQRFH2)**.</span></span> <span data-ttu-id="77e1c-110">但是，即使设置此属性，组件会检查以确认它们符合为 IBM RFH2 格式的标头。</span><span class="sxs-lookup"><span data-stu-id="77e1c-110">However, even when this property is set, the components inspect the headers to confirm that they do conform to the IBM RFH2 format.</span></span> <span data-ttu-id="77e1c-111">如果标头不符合此格式，组件会生成分析错误，指示**MQMD_Format**参数设置为**RFH (MQRFH2)**，但不是符合的标头的结构RFH2 标准。</span><span class="sxs-lookup"><span data-stu-id="77e1c-111">If the header does not conform to this format, the components generate a parse error that indicates the **MQMD_Format** parameter was set to **RFH (MQRFH2)**, but the structure of the header did not comply with the RFH2 standard.</span></span> <span data-ttu-id="77e1c-112">如果入站的消息标头分析失败，解码器组件允许消息传递，但它名为消息上下文属性设置**MQRFH2_ParseError**到**True**。</span><span class="sxs-lookup"><span data-stu-id="77e1c-112">If inbound message header parsing fails, the decoder component allows the message to pass, but it sets a message context property named **MQRFH2_ParseError** to **True**.</span></span>  
  
 <span data-ttu-id="77e1c-113">**MQRFH2**与 JMS 组件部署在 BizTalk 属性架构公开所有 MQRFH2 标头属性。</span><span class="sxs-lookup"><span data-stu-id="77e1c-113">The **MQRFH2** property schema deployed in BizTalk with the JMS components exposes all of the MQRFH2 header properties.</span></span> <span data-ttu-id="77e1c-114">在降级的传入消息的标头，从标头的数据驻留在 XML 文档存储在**MQRFH2_NameValueData**消息上下文属性。</span><span class="sxs-lookup"><span data-stu-id="77e1c-114">After demoting the headers of an incoming message, the data from the headers resides in an XML document stored in the **MQRFH2_NameValueData** context property of the message.</span></span> <span data-ttu-id="77e1c-115">编码器调整的长度**NameValueData**文件夹，以确保它是正确的长度。</span><span class="sxs-lookup"><span data-stu-id="77e1c-115">The encoder adjusts the length of the **NameValueData** folder to ensure it is the correct length.</span></span> <span data-ttu-id="77e1c-116">若要了解这些标头和影响的使用情况，在更改值时，查看相应的 IBM 文档。</span><span class="sxs-lookup"><span data-stu-id="77e1c-116">To understand the usage of these headers, and the impact when changing the values, review the appropriate IBM documentation.</span></span>  
  
## <a name="using-the-jms-encoder-and-decoder-components"></a><span data-ttu-id="77e1c-117">使用 JMS 编码器和解码器组件</span><span class="sxs-lookup"><span data-stu-id="77e1c-117">Using the JMS Encoder and Decoder Components</span></span>  
 <span data-ttu-id="77e1c-118">若要使用的 JMS 编码器和解码器组件，开发人员将它们添加到 BizTalk 应用程序中的管道。</span><span class="sxs-lookup"><span data-stu-id="77e1c-118">To use the JMS Encoder and Decoder components, developers add them to pipelines in a BizTalk application.</span></span> <span data-ttu-id="77e1c-119">为发送管道，JMS 编码器组件应位于编码阶段。</span><span class="sxs-lookup"><span data-stu-id="77e1c-119">For a send pipeline, the JMS Encoder component should reside in the Encode stage.</span></span> <span data-ttu-id="77e1c-120">接收管道，JMS 解码器组件应驻留在解码阶段中。</span><span class="sxs-lookup"><span data-stu-id="77e1c-120">For a receive pipeline, the JMS Decoder component should reside in the Decode stage.</span></span> <span data-ttu-id="77e1c-121">JMS 组件将不安装任何其他阶段的管道中。</span><span class="sxs-lookup"><span data-stu-id="77e1c-121">The JMS components will not install in any other stages of a pipeline.</span></span>  
  
 <span data-ttu-id="77e1c-122">JMS 编码器组件的编码阶段在安装时，读取的值中将 JMS **MQRFH2**标头和写入 （升级） 到消息上下文属性。</span><span class="sxs-lookup"><span data-stu-id="77e1c-122">When installed in the Encode stage, the JMS Encoder component reads the values in the JMS **MQRFH2** headers and writes (promotes) them into the message context properties.</span></span> <span data-ttu-id="77e1c-123">在解码阶段安装时，读取 JMS 解码器组件 （将降级） 的上下文属性值，并将其插入到 JMS **MQRFH2**标头。</span><span class="sxs-lookup"><span data-stu-id="77e1c-123">When installed in the Decode stage, the JMS Decoder component reads (demotes) the context property values and inserts them into the JMS **MQRFH2** headers.</span></span> <span data-ttu-id="77e1c-124">这意味着所有 MQ 标头值都为上下文属性在管道中消息的形式提供。</span><span class="sxs-lookup"><span data-stu-id="77e1c-124">This means that all the MQ header values are available as context properties of the message in the pipeline.</span></span>  
  
 <span data-ttu-id="77e1c-125">若要检测和管理标头分析错误，开发人员可以添加代码来检查的值**MQRFH2_ParseError**属性。</span><span class="sxs-lookup"><span data-stu-id="77e1c-125">To detect and manage header-parsing errors, developers can include code that examines the value of the **MQRFH2_ParseError** property.</span></span> <span data-ttu-id="77e1c-126">它们可以实现订阅失败消息的恢复过程，也可以指定发送端口的筛选**MQRFH2_ParseError**属性将该消息保存。</span><span class="sxs-lookup"><span data-stu-id="77e1c-126">They can implement a recovery process that subscribes to failed messages or specify send ports that filter on the **MQRFH2_ParseError** property to persist the message.</span></span> <span data-ttu-id="77e1c-127">使用 JMS 消息的订阅服务器应包含指定的值的筛选器条件**False**有关**MQRFH2_ParseError**属性来防止订阅者接收消息失败分析过程的标头。</span><span class="sxs-lookup"><span data-stu-id="77e1c-127">Subscribers that work with JMS messages should include a filter condition that specifies the value **False** for the **MQRFH2_ParseError** property to prevent the subscriber from receiving messages that failed the header parsing process.</span></span>  
  
 <span data-ttu-id="77e1c-128">开发人员还可以更新上下文属性值 (例如，更改**MQRFH2_Encoding**属性值)，并且该组件将反映的 MQ 消息标头中的这些更改，以使它们设置消息到达时其最终目标。</span><span class="sxs-lookup"><span data-stu-id="77e1c-128">Developers can also update the context property values (for example, change the **MQRFH2_Encoding** property value), and the component will reflect these changes in the MQ message headers so that they are set when the message arrives at its ultimate destination.</span></span> <span data-ttu-id="77e1c-129">该组件会自动将忽略无效的值，并设置"安全"默认值必需的标头会缺失。</span><span class="sxs-lookup"><span data-stu-id="77e1c-129">The component automatically ignores invalid values and sets "safe" default values where required headers are missing.</span></span> <span data-ttu-id="77e1c-130">例如，如果开发人员指定的值无效**MQRFH2_Encoding**属性，出站消息将具有**MQRFH2_Encoding**标头设置为**未知**.</span><span class="sxs-lookup"><span data-stu-id="77e1c-130">For example, if the developer specifies an invalid value for the **MQRFH2_Encoding** property, the outbound message will have the **MQRFH2_Encoding** header set to **UNKNOWN**.</span></span> <span data-ttu-id="77e1c-131">如果开发人员从上下文属性中删除一个值，但**MQMD_Format**属性仍设置为**RFH**，该组件将添加包含默认值，根据 IBM 规范的标头。</span><span class="sxs-lookup"><span data-stu-id="77e1c-131">If the developer removes a value from a context property, but the **MQMD_Format** property is still set to **RFH**, the component will add a header containing the default value, as per the IBM specification.</span></span>  
  
 <span data-ttu-id="77e1c-132">有关如何使用这些组件的示例，请参阅[安装和运行 JMS MQRFH2 组件示例](../esb-toolkit/installing-and-running-the-jms-mqrfh2-component-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="77e1c-132">For an example of how to use these components, see [Installing and Running the JMS MQRFH2 Component Sample](../esb-toolkit/installing-and-running-the-jms-mqrfh2-component-sample.md).</span></span>