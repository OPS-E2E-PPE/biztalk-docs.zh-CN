---
title: ESB JMS 编码器和解码器组件 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 4e5591c2-d2ca-4168-8026-059fe51dd588
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 9f39f4ab1b0650a8ad6fa1ff35d62b4807995237
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22295677"
---
# <a name="the-esb-jms-encoder-and-decoder-components"></a><span data-ttu-id="b9364-102">ESB JMS 编码器和解码器组件</span><span class="sxs-lookup"><span data-stu-id="b9364-102">The ESB JMS Encoder and Decoder Components</span></span>
<span data-ttu-id="b9364-103">某些集成解决方案涉及到 Java 消息服务 (JMS) 和 SOAP 消息发送到数据库或从 IBM WebSphere MQ;[!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)]包括用在这些情况下使用的托管代码编写的两个 JMS 管道组件。</span><span class="sxs-lookup"><span data-stu-id="b9364-103">Some integration solutions involve Java Message Service (JMS) and SOAP messages sent to or from IBM WebSphere MQ; [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] includes two JMS pipeline components written in managed code for use in these situations.</span></span> <span data-ttu-id="b9364-104">组件读取或写入 MQ 消息标头使用与消息关联的上下文属性的值的 JMS 部分。</span><span class="sxs-lookup"><span data-stu-id="b9364-104">The components read or write the JMS portion of the MQ message header using the values of context properties associated with the message.</span></span> <span data-ttu-id="b9364-105">目前，有 60 多个不同类型的 JMS 中与 WebSphere MQ 系列系统; 一起使用的标头ESB JMS 组件只使用 MQRFH2 标头。</span><span class="sxs-lookup"><span data-stu-id="b9364-105">Currently, there are more than 60 different types of JMS headers in use with WebSphere MQ Series systems; the ESB JMS components work only with MQRFH2 headers.</span></span>  
  
## <a name="installation"></a><span data-ttu-id="b9364-106">安装</span><span class="sxs-lookup"><span data-stu-id="b9364-106">Installation</span></span>  
 <span data-ttu-id="b9364-107">自动安装 ESB 核心安装 BizTalk Server 管道组件文件夹中的 JMS 编码器和 JMS 解码器组件。</span><span class="sxs-lookup"><span data-stu-id="b9364-107">Installing the ESB Core automatically installs the JMS Encoder and JMS Decoder components in the BizTalk Server Pipeline Components folder.</span></span>  
  
## <a name="how-it-works"></a><span data-ttu-id="b9364-108">它是如何工作</span><span class="sxs-lookup"><span data-stu-id="b9364-108">How It Works</span></span>  
 <span data-ttu-id="b9364-109">JMS 管道组件检查消息头，并仅对消息进行操作**MQMD_Format**标头设置为**RFH (MQRFH2)**。</span><span class="sxs-lookup"><span data-stu-id="b9364-109">The JMS pipeline components inspect the message headers and operate only on messages that have the **MQMD_Format** header set to **RFH (MQRFH2)**.</span></span> <span data-ttu-id="b9364-110">但是，即使设置此属性，组件会检查以确认它们符合 IBM RFH2 格式的标头。</span><span class="sxs-lookup"><span data-stu-id="b9364-110">However, even when this property is set, the components inspect the headers to confirm that they do conform to the IBM RFH2 format.</span></span> <span data-ttu-id="b9364-111">如果标头不符合此格式，组件都会生成分析错误，该值指示**MQMD_Format**参数设置为**RFH (MQRFH2)**，但不是符合的标头结构RFH2 标准。</span><span class="sxs-lookup"><span data-stu-id="b9364-111">If the header does not conform to this format, the components generate a parse error that indicates the **MQMD_Format** parameter was set to **RFH (MQRFH2)**, but the structure of the header did not comply with the RFH2 standard.</span></span> <span data-ttu-id="b9364-112">如果分析的入站的消息标头失败，解码器组件允许消息传递，但它将设置一个名为消息上下文属性**MQRFH2_ParseError**到**True**。</span><span class="sxs-lookup"><span data-stu-id="b9364-112">If inbound message header parsing fails, the decoder component allows the message to pass, but it sets a message context property named **MQRFH2_ParseError** to **True**.</span></span>  
  
 <span data-ttu-id="b9364-113">**MQRFH2**属性架构部署在 BizTalk 通过 JMS 组件公开的所有 MQRFH2 标头属性。</span><span class="sxs-lookup"><span data-stu-id="b9364-113">The **MQRFH2** property schema deployed in BizTalk with the JMS components exposes all of the MQRFH2 header properties.</span></span> <span data-ttu-id="b9364-114">在降级传入消息的标头，标头中的数据将驻留在 XML 文档存储在**MQRFH2_NameValueData**消息上下文属性。</span><span class="sxs-lookup"><span data-stu-id="b9364-114">After demoting the headers of an incoming message, the data from the headers resides in an XML document stored in the **MQRFH2_NameValueData** context property of the message.</span></span> <span data-ttu-id="b9364-115">编码器调整的长度**NameValueData**文件夹以确保它是正确的长度。</span><span class="sxs-lookup"><span data-stu-id="b9364-115">The encoder adjusts the length of the **NameValueData** folder to ensure it is the correct length.</span></span> <span data-ttu-id="b9364-116">若要了解使用这些标头，以及影响在更改值时，查看相应的 IBM 文档。</span><span class="sxs-lookup"><span data-stu-id="b9364-116">To understand the usage of these headers, and the impact when changing the values, review the appropriate IBM documentation.</span></span>  
  
## <a name="using-the-jms-encoder-and-decoder-components"></a><span data-ttu-id="b9364-117">使用 JMS 编码器和解码器组件</span><span class="sxs-lookup"><span data-stu-id="b9364-117">Using the JMS Encoder and Decoder Components</span></span>  
 <span data-ttu-id="b9364-118">若要使用的 JMS 编码器和解码器组件，开发人员将它们添加到 BizTalk 应用程序中的管道。</span><span class="sxs-lookup"><span data-stu-id="b9364-118">To use the JMS Encoder and Decoder components, developers add them to pipelines in a BizTalk application.</span></span> <span data-ttu-id="b9364-119">发送管道，JMS 编码器组件应驻留在编码阶段。</span><span class="sxs-lookup"><span data-stu-id="b9364-119">For a send pipeline, the JMS Encoder component should reside in the Encode stage.</span></span> <span data-ttu-id="b9364-120">接收管道，JMS 解码器组件应驻留在解码阶段。</span><span class="sxs-lookup"><span data-stu-id="b9364-120">For a receive pipeline, the JMS Decoder component should reside in the Decode stage.</span></span> <span data-ttu-id="b9364-121">JMS 组件将不安装任何其他阶段的管道中。</span><span class="sxs-lookup"><span data-stu-id="b9364-121">The JMS components will not install in any other stages of a pipeline.</span></span>  
  
 <span data-ttu-id="b9364-122">JMS 编码器组件安装在编码阶段中，当读取 JMS 中的值**MQRFH2**标头和写入 （提升） 消息上下文属性中。</span><span class="sxs-lookup"><span data-stu-id="b9364-122">When installed in the Encode stage, the JMS Encoder component reads the values in the JMS **MQRFH2** headers and writes (promotes) them into the message context properties.</span></span> <span data-ttu-id="b9364-123">JMS 解码器组件安装在解码阶段中，当读取 （将降级） 的上下文属性值，并将其插入到 JMS **MQRFH2**标头。</span><span class="sxs-lookup"><span data-stu-id="b9364-123">When installed in the Decode stage, the JMS Decoder component reads (demotes) the context property values and inserts them into the JMS **MQRFH2** headers.</span></span> <span data-ttu-id="b9364-124">这意味着所有 MQ 标头值都是可用作管道中消息的上下文属性。</span><span class="sxs-lookup"><span data-stu-id="b9364-124">This means that all the MQ header values are available as context properties of the message in the pipeline.</span></span>  
  
 <span data-ttu-id="b9364-125">若要检测和管理标头分析错误，开发人员可以包括检查的值的代码**MQRFH2_ParseError**属性。</span><span class="sxs-lookup"><span data-stu-id="b9364-125">To detect and manage header-parsing errors, developers can include code that examines the value of the **MQRFH2_ParseError** property.</span></span> <span data-ttu-id="b9364-126">它们可以实现订阅失败的消息的恢复进程或指定对筛选发送端口**MQRFH2_ParseError**属性将该消息保存。</span><span class="sxs-lookup"><span data-stu-id="b9364-126">They can implement a recovery process that subscribes to failed messages or specify send ports that filter on the **MQRFH2_ParseError** property to persist the message.</span></span> <span data-ttu-id="b9364-127">使用 JMS 消息的订阅服务器应包括指定的值的筛选器条件**False**为**MQRFH2_ParseError**属性来阻止订阅服务器接收消息失败分析进程的标头。</span><span class="sxs-lookup"><span data-stu-id="b9364-127">Subscribers that work with JMS messages should include a filter condition that specifies the value **False** for the **MQRFH2_ParseError** property to prevent the subscriber from receiving messages that failed the header parsing process.</span></span>  
  
 <span data-ttu-id="b9364-128">开发人员还可以更新的上下文属性值 (例如，更改**MQRFH2_Encoding**属性值)，该组件将反映 MQ 消息标头中的这些更改，以便它们设置消息到达时其最终目标。</span><span class="sxs-lookup"><span data-stu-id="b9364-128">Developers can also update the context property values (for example, change the **MQRFH2_Encoding** property value), and the component will reflect these changes in the MQ message headers so that they are set when the message arrives at its ultimate destination.</span></span> <span data-ttu-id="b9364-129">该组件会自动将忽略无效的值，并设置"安全"默认值缺少必需的标头在哪里。</span><span class="sxs-lookup"><span data-stu-id="b9364-129">The component automatically ignores invalid values and sets "safe" default values where required headers are missing.</span></span> <span data-ttu-id="b9364-130">例如，如果开发人员已指定的值无效**MQRFH2_Encoding**属性，出站消息将具有**MQRFH2_Encoding**标头设置为**未知**.</span><span class="sxs-lookup"><span data-stu-id="b9364-130">For example, if the developer specifies an invalid value for the **MQRFH2_Encoding** property, the outbound message will have the **MQRFH2_Encoding** header set to **UNKNOWN**.</span></span> <span data-ttu-id="b9364-131">如果开发人员从上下文属性中删除一个值，但**MQMD_Format**属性仍将设置为**RFH**，该组件将添加包含默认值，根据 IBM 规范的标头。</span><span class="sxs-lookup"><span data-stu-id="b9364-131">If the developer removes a value from a context property, but the **MQMD_Format** property is still set to **RFH**, the component will add a header containing the default value, as per the IBM specification.</span></span>  
  
 <span data-ttu-id="b9364-132">有关如何使用这些组件的示例，请参阅[安装和运行 JMS MQRFH2 组件示例](../esb-toolkit/installing-and-running-the-jms-mqrfh2-component-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="b9364-132">For an example of how to use these components, see [Installing and Running the JMS MQRFH2 Component Sample](../esb-toolkit/installing-and-running-the-jms-mqrfh2-component-sample.md).</span></span>