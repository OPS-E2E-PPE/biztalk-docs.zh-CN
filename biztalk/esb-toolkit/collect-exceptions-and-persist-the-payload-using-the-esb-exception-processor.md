---
title: 收集异常并保留有效负载使用 ESB 异常处理器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 52650eed-e760-4ade-bc3f-2b5b2a1c43ff
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c43925006153ccfdcfa0c9700dd1ecf27fd3fd2f
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36994814"
---
# <a name="collecting-exceptions-and-persisting-the-payload-using-the-esb-exception-processor"></a><span data-ttu-id="61748-102">收集异常并保留使用 ESB 异常处理器的有效负载</span><span class="sxs-lookup"><span data-stu-id="61748-102">Collecting Exceptions and Persisting the Payload Using the ESB Exception Processor</span></span>
<span data-ttu-id="61748-103">在此用例，业务流程的异常处理程序将到 ESB 的错误消息发布到 BizTalk Server 消息框，或者 BizTalk 失败消息路由机制将生成错误消息。</span><span class="sxs-lookup"><span data-stu-id="61748-103">In this use case, either the exception handler for an orchestration publishes an ESB fault message to the BizTalk Server Message Box or the BizTalk Failed Message Routing mechanism generates a fault message.</span></span> <span data-ttu-id="61748-104">使用 ESB 异常编码器管道组件，预配置的发送端口订阅这两种错误消息。</span><span class="sxs-lookup"><span data-stu-id="61748-104">A send port, preconfigured with the ESB Exception Encoder pipeline component, subscribes to both of the fault message types.</span></span> <span data-ttu-id="61748-105">它处理的错误消息，然后将其保留为磁盘文件，你可以查看使用 InfoPath，如图 1 中所示。</span><span class="sxs-lookup"><span data-stu-id="61748-105">It processes the fault messages and then persists them as disk files that you can view using InfoPath, as illustrated in Figure 1.</span></span>  
  
 <span data-ttu-id="61748-106">![收集异常负载](../esb-toolkit/media/ch3-collectingexceptionspayload.gif "Ch3-CollectingExceptionsPayload")</span><span class="sxs-lookup"><span data-stu-id="61748-106">![Collecting Exceptions Payload](../esb-toolkit/media/ch3-collectingexceptionspayload.gif "Ch3-CollectingExceptionsPayload")</span></span>  
  
 <span data-ttu-id="61748-107">**图 1**</span><span class="sxs-lookup"><span data-stu-id="61748-107">**Figure 1**</span></span>  
  
 <span data-ttu-id="61748-108">**捕获的错误消息并将其保存到磁盘文件**</span><span class="sxs-lookup"><span data-stu-id="61748-108">**Capturing a fault message and persisting it to a disk file**</span></span>  
  
 <span data-ttu-id="61748-109">[!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)]包括以下：</span><span class="sxs-lookup"><span data-stu-id="61748-109">The [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] includes the following:</span></span>  
  
- <span data-ttu-id="61748-110">**预配置的发送端口使用 ESB 故障处理器发送管道。**</span><span class="sxs-lookup"><span data-stu-id="61748-110">**A preconfigured send port that uses the ESB Fault Processor send pipeline.**</span></span> <span data-ttu-id="61748-111">您可以依据特定要求配置此发送端口。</span><span class="sxs-lookup"><span data-stu-id="61748-111">You can configure this send port according to your own specific requirements.</span></span>  
  
- <span data-ttu-id="61748-112">**消息保留自定义异常处理程序示例。**</span><span class="sxs-lookup"><span data-stu-id="61748-112">**The Message Persisting Custom Exception Handler sample.**</span></span> <span data-ttu-id="61748-113">此示例演示如何松散耦合的一般异常处理程序可以接收错误消息中提取 BizTalk Server 消息包含、 规范化和增强消息，并将其作为磁盘文件写入到文件系统。</span><span class="sxs-lookup"><span data-stu-id="61748-113">This sample shows how a loosely coupled generic exception handler can receive fault messages, extract the BizTalk Server messages they contain, normalize and enrich the messages, and write them as disk files to the file system.</span></span>  
  
- <span data-ttu-id="61748-114">**BizTalk 失败消息路由的示例。**</span><span class="sxs-lookup"><span data-stu-id="61748-114">**The BizTalk Failed Message Routing sample.**</span></span> <span data-ttu-id="61748-115">此示例演示如何 ESB 异常管理框架可以标准化和丰富本机生成的 BizTalk Server 中的失败消息路由机制的错误消息。</span><span class="sxs-lookup"><span data-stu-id="61748-115">This sample shows how the ESB Exception Management Framework can normalize and enrich fault messages natively generated by the Failed Message Routing mechanism in BizTalk Server.</span></span>  
  
  <span data-ttu-id="61748-116">有关详细信息，请参阅[运行消息保留自定义异常处理程序示例](../esb-toolkit/running-the-message-persisting-custom-exception-handler-sample.md)并[运行 BizTalk 失败消息路由 ESB 处理示例](../esb-toolkit/running-the-biztalk-failed-message-routing-esb-processing-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="61748-116">For more information, see [Running the Message Persisting Custom Exception Handler Sample](../esb-toolkit/running-the-message-persisting-custom-exception-handler-sample.md) and [Running the BizTalk Failed Message Routing ESB Processing Sample](../esb-toolkit/running-the-biztalk-failed-message-routing-esb-processing-sample.md).</span></span>