---
title: BizTalk 操作 Web 服务 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: af38815f-f643-4598-9148-6499071d12e4
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 0b9a78dddbbd76566c5c97b1e571e5ad80073d4a
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36997966"
---
# <a name="the-biztalk-operations-web-service"></a><span data-ttu-id="ca8ce-102">BizTalk 操作 Web 服务</span><span class="sxs-lookup"><span data-stu-id="ca8ce-102">The BizTalk Operations Web Service</span></span>
<span data-ttu-id="ca8ce-103">Microsoft BizTalk 操作 Web 服务公开的对象和 BizTalk Server 中的消息有关的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-103">The Microsoft BizTalk Operations Web service exposes information about the objects and messages in BizTalk Server.</span></span> <span data-ttu-id="ca8ce-104">服务名称是**ESB.BizTalkOperationsService**，并且服务会公开各种返回诸如主机、 业务流程、 应用程序，以及 BizTalk 应用程序状态的列表的方法。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-104">The service name is **ESB.BizTalkOperationsService**, and the service exposes a wide range of methods that return items such as a list of hosts, orchestrations, applications, and the BizTalk application status.</span></span>  
  
 <span data-ttu-id="ca8ce-105">以下方法有：</span><span class="sxs-lookup"><span data-stu-id="ca8ce-105">The following methods are available:</span></span>  
  
-   <span data-ttu-id="ca8ce-106">**应用程序**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-106">**Applications**.</span></span> <span data-ttu-id="ca8ce-107">此方法采用任何参数，并返回的名称和说明的所有已安装的 BizTalk 应用程序作为一系列**BTApplication**对象。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-107">This method takes no parameters, and it returns the name and description of all installed BizTalk applications as a collection of **BTApplication** objects.</span></span>  
  
-   <span data-ttu-id="ca8ce-108">**ApplicationStatus**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-108">**ApplicationStatus**.</span></span> <span data-ttu-id="ca8ce-109">此方法将作为参数的应用程序名称，并返回有关指定的 BizTalk 应用程序作为信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-109">This method takes as a parameter the application name, and it returns information about the specified BizTalk application as a **BTSysStatus** instance.</span></span> <span data-ttu-id="ca8ce-110">此信息包括业务流程、 发送端口、 接收位置和主机的详细信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-110">This information includes orchestrations, send ports, receive locations, and host details.</span></span>  
  
-   <span data-ttu-id="ca8ce-111">**GetLiveMessageBody**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-111">**GetLiveMessageBody**.</span></span> <span data-ttu-id="ca8ce-112">消息 ID 和实例 ID，此方法将作为参数并返回该消息的正文从与实时环境**BTMsgBody**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-112">This method takes as parameters a message ID and an instance ID, and it returns the body of that message from the live environment as a **BTMsgBody** instance.</span></span>  
  
-   <span data-ttu-id="ca8ce-113">**GetMessageInstances**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-113">**GetMessageInstances**.</span></span> <span data-ttu-id="ca8ce-114">此方法将作为参数的消息类型，并返回匹配的所有消息作为一系列**BTMsgInstance**对象。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-114">This method takes as a parameter the message type, and it returns all matching messages as a collection of **BTMsgInstance** objects.</span></span>  
  
-   <span data-ttu-id="ca8ce-115">**GetOrchestrationInstances**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-115">**GetOrchestrationInstances**.</span></span> <span data-ttu-id="ca8ce-116">此方法将作为参数的业务流程名称和它返回的集合**BTOrchestrationInstance**包含匹配的业务流程的详细信息的对象。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-116">This method takes as parameters the name of an orchestration, and it returns a collection of **BTOrchestrationInstance** object that contain details of the matching orchestrations.</span></span>  
  
-   <span data-ttu-id="ca8ce-117">**GetTrackedMessageBody**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-117">**GetTrackedMessageBody**.</span></span> <span data-ttu-id="ca8ce-118">此方法将作为参数的消息的 GUID，并返回作为该消息的正文**BTMsgBody**实例后在 BizTalk 中进行处理。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-118">This method takes as a parameter a message GUID, and it returns the body of that message as a **BTMsgBody** instance after it is processed in BizTalk.</span></span>  
  
-   <span data-ttu-id="ca8ce-119">**主机**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-119">**Hosts**.</span></span> <span data-ttu-id="ca8ce-120">此方法将作为参数的名称的主机，并返回作为一系列指定的主机实例的信息**BTHost**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-120">This method takes as a parameter the name of a host, and it returns information about the specified host instance as a collection of **BTHost** instances.</span></span> <span data-ttu-id="ca8ce-121">使用主机名称参数为空字符串返回有关所有主机实例的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-121">Use an empty string for the host name parameter to return information about all host instances.</span></span>  
  
-   <span data-ttu-id="ca8ce-122">**MessageFlowTree**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-122">**MessageFlowTree**.</span></span> <span data-ttu-id="ca8ce-123">此方法将作为参数的实例 ID，并返回作为该消息的消息流的详细信息**RouteTreeNode**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-123">This method takes as a parameter an instance ID, and it returns details of the message flow for that message as a **RouteTreeNode** instance.</span></span>  
  
-   <span data-ttu-id="ca8ce-124">**业务流程**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-124">**Orchestrations**.</span></span> <span data-ttu-id="ca8ce-125">此方法将作为参数的业务流程名称并返回作为该业务流程的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-125">This method takes as a parameter the name of an orchestration, and it returns all the information for that orchestration as a **BTSysStatus** instance.</span></span> <span data-ttu-id="ca8ce-126">业务流程名称参数为空字符串用于返回有关所有业务流程的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-126">Use an empty string for the orchestration name parameter to return information about all orchestrations.</span></span>  
  
-   <span data-ttu-id="ca8ce-127">**ReceiveLocations**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-127">**ReceiveLocations**.</span></span> <span data-ttu-id="ca8ce-128">此方法将作为参数的名称的接收位置，并返回匹配位置的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-128">This method takes as a parameter the name of a receive location, and it returns all the information for matching locations as a **BTSysStatus** instance.</span></span> <span data-ttu-id="ca8ce-129">接收位置名称参数为空字符串用于返回有关所有位置的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-129">Use an empty string for the receive locations name parameter to return information about all locations.</span></span>  
  
-   <span data-ttu-id="ca8ce-130">**ReceiveLocationsByDescription**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-130">**ReceiveLocationsByDescription**.</span></span> <span data-ttu-id="ca8ce-131">此方法将作为参数的说明接收位置，并返回匹配位置的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-131">This method takes as a parameter the description of a receive location, and it returns all the information for matching locations as a **BTSysStatus** instance.</span></span> <span data-ttu-id="ca8ce-132">Description 参数为空字符串用于返回有关所有位置的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-132">Use an empty string for the description parameter to return information about all locations.</span></span>  
  
-   <span data-ttu-id="ca8ce-133">**发送端口**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-133">**SendPorts**.</span></span> <span data-ttu-id="ca8ce-134">此方法将作为参数的名称的发送端口，并返回匹配的端口的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-134">This method takes as a parameter the name of a send port, and it returns all the information for matching ports as a **BTSysStatus** instance.</span></span> <span data-ttu-id="ca8ce-135">发送端口名称参数为空字符串用于返回有关所有端口的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-135">Use an empty string for the send port name parameter to return information about all ports.</span></span>  
  
-   <span data-ttu-id="ca8ce-136">**SendPortsByDescription**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-136">**SendPortsByDescription**.</span></span> <span data-ttu-id="ca8ce-137">此方法将作为参数的说明的发送端口，并返回匹配的端口的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-137">This method takes as a parameter the description of a send port, and it returns all the information for matching ports as a **BTSysStatus** instance.</span></span> <span data-ttu-id="ca8ce-138">使用 description 参数为空字符串返回有关所有端口的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-138">Use an empty string for the description parameter to return information about all ports.</span></span>  
  
-   <span data-ttu-id="ca8ce-139">**StatusChanged**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-139">**StatusChanged**.</span></span> <span data-ttu-id="ca8ce-140">此方法采用一个参数作为一个时间戳，并返回作为指定的时间戳以来修改的 BizTalk 对象 （如端口、 主机和业务流程） 的详细信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-140">This method takes as a parameter a timestamp, and it returns details of BizTalk objects (such as ports, hosts, and orchestrations) modified since the specified timestamp as a **BTSysStatus** instance.</span></span>  
  
-   <span data-ttu-id="ca8ce-141">**SystemStatus**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-141">**SystemStatus**.</span></span> <span data-ttu-id="ca8ce-142">此方法采用任何参数，并返回作为 BizTalk 系统状态的完整详细信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-142">This method takes no parameters, and it returns full details of the BizTalk system status as a **BTSysStatus** instance.</span></span>  
  
-   <span data-ttu-id="ca8ce-143">**UpdateReceiveLocationDescription**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-143">**UpdateReceiveLocationDescription**.</span></span> <span data-ttu-id="ca8ce-144">此方法更新使用包含应用程序名称、 接收端口名称、 接收位置名称和接收位置描述的参数值的指定的接收位置的说明。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-144">This method updates the description of a specified receive location using parameter values that contain the application name, the receive port name, the receive location name, and the receive location description.</span></span> <span data-ttu-id="ca8ce-145">它返回一个字符串，表示操作的结果。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-145">It returns a String that indicates the result of the operation.</span></span> <span data-ttu-id="ca8ce-146">请注意测试客户端应用程序从其 App.config 文件中读取此信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-146">Note that the test client application reads this information from its App.config file.</span></span>  
  
-   <span data-ttu-id="ca8ce-147">**UpdateSendPortDescription**。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-147">**UpdateSendPortDescription**.</span></span> <span data-ttu-id="ca8ce-148">此方法将更新指定的发送端口使用包含发送端口名称和发送端口描述的参数值的说明。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-148">This method updates the description of a specified send port using parameter values that contain the send port name and the send port description.</span></span> <span data-ttu-id="ca8ce-149">它返回一个字符串，表示操作的结果。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-149">It returns a String that indicates the result of the operation.</span></span> <span data-ttu-id="ca8ce-150">请注意测试客户端应用程序从其 App.config 文件中读取此信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-150">Note that the test client application reads this information from its App.config file.</span></span>  
  
## <a name="configuring-the-biztalk-operations-web-service"></a><span data-ttu-id="ca8ce-151">配置 BizTalk 操作 Web 服务</span><span class="sxs-lookup"><span data-stu-id="ca8ce-151">Configuring the BizTalk Operations Web Service</span></span>  
 <span data-ttu-id="ca8ce-152">BizTalk 操作 Web 服务或者直接与 BizTalk Server 管理数据库使用 Windows Management Instrumentation (WMI) 通信或它使用 BizTalk 操作和资源管理器 API 来获取所需的信息。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-152">The BizTalk Operations Web service either communicates directly with the BizTalk Server management databases using Windows Management Instrumentation (WMI) or it uses the BizTalk Operations and Explorer API to obtain the information it requires.</span></span> <span data-ttu-id="ca8ce-153">因此，必须确保你的系统满足以下条件和配置以下安全权限设置：</span><span class="sxs-lookup"><span data-stu-id="ca8ce-153">Therefore, you must make sure that your system meets the following conditions and that you configure the following security permission settings:</span></span>  
  
- <span data-ttu-id="ca8ce-154">设置**allowOverride**到计算机级别的 Web.config 文件中的属性**false**以确保开发人员不能更改他们的应用程序的信任级别。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-154">Set the **allowOverride** attribute in the machine-level Web.config file to **false** to make sure developers cannot change the trust level of their applications.</span></span>  
  
- <span data-ttu-id="ca8ce-155">默认情况下，BizTalk 操作 Web 服务未配置为需要安全套接字层 (SSL) 客户端进行访问时。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-155">By default, the BizTalk Operations Web service is not configured to require Secure Sockets Layer (SSL) when accessed by clients.</span></span> <span data-ttu-id="ca8ce-156">应配置服务，因此它需要 SSL 客户端访问和保护 Internet 信息服务 (IIS) Web 服务主机计算机和运行托管 BizTalkMgmtDb 数据库使用 SQL Server 的计算机之间的连接网络级别 IPSec 和相应的文件级访问控制列表 (ACL) 权限。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-156">You should configure the service so that it requires SSL for client access, and protect the connection between the Internet Information Services (IIS) Web service host computer and the computer running SQL Server that hosts the BizTalkMgmtDb database using network-level IPSec and appropriate file-level access control list (ACL) permissions.</span></span>  
  
- <span data-ttu-id="ca8ce-157">访问 BizTalk 操作 Web 服务的用户必须对某些方法的默认 BizTalk Server Administrators 组的成员和其他方法的默认 BizTalk Application Users 组的成员。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-157">Users accessing the BizTalk Operations Web service must be members of the default BizTalk Server Administrators group for some methods and members of the default BizTalk Application Users group for other methods.</span></span>  
  
- <span data-ttu-id="ca8ce-158">必须确保 BizTalk 操作 Web 服务驻留在名为已禁用匿名访问的 ESB.BizTalkOperationsService 的 IIS 虚拟目录中。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-158">You must make sure that the BizTalk Operations Web service resides in an IIS virtual directory named ESB.BizTalkOperationsService that has anonymous access disabled.</span></span>  
  
- <span data-ttu-id="ca8ce-159">用户必须具有**选择**位于 BizTalkMgmtDb 数据库和在 BizTalkMsgBoxDb 数据库中的 SQL Server 中的多个表的权限。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-159">Users must have **SELECT** permission in SQL Server for several tables located in the BizTalkMgmtDb database and the BizTalkMsgBoxDb database.</span></span> <span data-ttu-id="ca8ce-160">使用 SQL Server Management Studio 设置以下权限：</span><span class="sxs-lookup"><span data-stu-id="ca8ce-160">Use SQL Server Management Studio to set the following permissions:</span></span>  
  
  -   <span data-ttu-id="ca8ce-161">在 BizTalkMgmtDb 数据库中，配置具有 BTS_ADMIN_USERS 数据库角色**选择**以下表的权限：</span><span class="sxs-lookup"><span data-stu-id="ca8ce-161">In the BizTalkMgmtDb database, configure the BTS_ADMIN_USERS database role with **SELECT** permission on the following tables:</span></span>  
  
      -   <span data-ttu-id="ca8ce-162">adm_Server2HostMapping</span><span class="sxs-lookup"><span data-stu-id="ca8ce-162">adm_Server2HostMapping</span></span>  
  
      -   <span data-ttu-id="ca8ce-163">adm_Server</span><span class="sxs-lookup"><span data-stu-id="ca8ce-163">adm_Server</span></span>  
  
      -   <span data-ttu-id="ca8ce-164">adm_hostInstance</span><span class="sxs-lookup"><span data-stu-id="ca8ce-164">adm_hostInstance</span></span>  
  
  -   <span data-ttu-id="ca8ce-165">在 BizTalkMsgBoxDb 数据库中，配置具有 BTS_ADMIN_USER 数据库角色**选择**ProcessHeartbeats 表的权限。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-165">In the BizTalkMsgBoxDb database, configure the BTS_ADMIN_USER database role with **SELECT** permission on the ProcessHeartbeats table.</span></span>  
  
  <span data-ttu-id="ca8ce-166">在 SQL Server Management Studio，可以配置所需的权限。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-166">In SQL Server Management Studio, you can configure the required permissions.</span></span> <span data-ttu-id="ca8ce-167">若要执行此操作，请展开**安全**在对象资源管理器的左的窗格树视图中，展开**角色**，展开**DatabaseRoles**、 选择 BTS_ADMIN_USERS 角色，然后编辑对于此角色，如图 1 中所示的属性。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-167">To do this, expand **Security** in the left pane tree view of Object Explorer, expand **Roles**, expand **DatabaseRoles**, select the BTS_ADMIN_USERS role, and then edit the properties for this role, as shown in Figure 1.</span></span>  
  
  <span data-ttu-id="ca8ce-168">![SQL Server 管理 Studio](../esb-toolkit/media/ch4-sqlservermgmtstudio.gif "Ch4 SQLServerMgmtStudio")</span><span class="sxs-lookup"><span data-stu-id="ca8ce-168">![SQL Server Mgmt Studio](../esb-toolkit/media/ch4-sqlservermgmtstudio.gif "Ch4-SQLServerMgmtStudio")</span></span>  
  
  <span data-ttu-id="ca8ce-169">**图 1**</span><span class="sxs-lookup"><span data-stu-id="ca8ce-169">**Figure 1**</span></span>  
  
  <span data-ttu-id="ca8ce-170">**编辑 Microsoft SQL Server Management Studio 中的 BTS_ADMIN_USERS 数据库角色的权限**</span><span class="sxs-lookup"><span data-stu-id="ca8ce-170">**Editing permissions for the BTS_ADMIN_USERS database role in Microsoft SQL Server Management Studio**</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ca8ce-171">必须配置为使用 Windows 集成安全性并在内置网络服务帐户下运行此服务。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-171">You must configure this service to use Windows Integrated Security and run under the built-in NETWORK SERVICE account.</span></span> <span data-ttu-id="ca8ce-172">您还必须启用 Kerberos 身份验证在 IIS Web 服务器上，以便它将发送标头**Negotiate、 NTLM**到客户端。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-172">You must also enable Kerberos authentication on your IIS Web server so that it sends the header **Negotiate,NTLM** to the client.</span></span> <span data-ttu-id="ca8ce-173">有关详细信息，请参阅[如何配置 IIS 以用于网络身份验证支持 Kerberos 协议和 NTLM 协议](http://go.microsoft.com/fwlink/?LinkId=186430)([http://go.microsoft.com/fwlink/?LinkId=186430](http://go.microsoft.com/fwlink/?LinkId=186430))。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-173">For more information, see [How to configure IIS to support both the Kerberos protocol and the NTLM protocol for network authentication](http://go.microsoft.com/fwlink/?LinkId=186430)([http://go.microsoft.com/fwlink/?LinkId=186430](http://go.microsoft.com/fwlink/?LinkId=186430)).</span></span>  
>   
>  <span data-ttu-id="ca8ce-174">默认情况下，BizTalk 操作 Web 服务未配置为需要 SSL 客户端进行访问时。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-174">By default, the BizTalk Operations Web service is not configured to require SSL when accessed by clients.</span></span> <span data-ttu-id="ca8ce-175">应配置服务，因此它需要 SSL 客户端访问和保护 IIS Web 服务主机计算机和服务器托管 UDDI 服务使用网络级别 IPSec 和相应的文件级 ACL 权限之间的连接。</span><span class="sxs-lookup"><span data-stu-id="ca8ce-175">You should configure the service so that it requires SSL for client access and protect the connection between the IIS Web service host computer and the server that hosts the UDDI service using network-level IPSec and appropriate file-level ACL permissions.</span></span>