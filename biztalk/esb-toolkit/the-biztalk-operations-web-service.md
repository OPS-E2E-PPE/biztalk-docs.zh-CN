---
title: "BizTalk 操作 Web 服务 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: af38815f-f643-4598-9148-6499071d12e4
caps.latest.revision: "5"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5d09fb2cdcca83e8a9f2e4e7704178d40a915065
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="the-biztalk-operations-web-service"></a><span data-ttu-id="fea14-102">BizTalk 操作 Web 服务</span><span class="sxs-lookup"><span data-stu-id="fea14-102">The BizTalk Operations Web Service</span></span>
<span data-ttu-id="fea14-103">Microsoft BizTalk 操作 Web 服务公开的对象和 BizTalk Server 中的消息有关的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-103">The Microsoft BizTalk Operations Web service exposes information about the objects and messages in BizTalk Server.</span></span> <span data-ttu-id="fea14-104">服务名称是**ESB.BizTalkOperationsService**，并且服务将公开各种返回如列表项的主机、 业务流程、 应用程序和 BizTalk 应用程序状态的方法。</span><span class="sxs-lookup"><span data-stu-id="fea14-104">The service name is **ESB.BizTalkOperationsService**, and the service exposes a wide range of methods that return items such as a list of hosts, orchestrations, applications, and the BizTalk application status.</span></span>  
  
 <span data-ttu-id="fea14-105">提供了以下方法：</span><span class="sxs-lookup"><span data-stu-id="fea14-105">The following methods are available:</span></span>  
  
-   <span data-ttu-id="fea14-106">**应用程序**。</span><span class="sxs-lookup"><span data-stu-id="fea14-106">**Applications**.</span></span> <span data-ttu-id="fea14-107">此方法没有采用任何参数并返回的名称和描述的所有已安装的 BizTalk 应用程序的集合作为**BTApplication**对象。</span><span class="sxs-lookup"><span data-stu-id="fea14-107">This method takes no parameters, and it returns the name and description of all installed BizTalk applications as a collection of **BTApplication** objects.</span></span>  
  
-   <span data-ttu-id="fea14-108">**ApplicationStatus**。</span><span class="sxs-lookup"><span data-stu-id="fea14-108">**ApplicationStatus**.</span></span> <span data-ttu-id="fea14-109">此方法将作为参数的应用程序名称，并返回有关指定 BizTalk 应用程序作为信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-109">This method takes as a parameter the application name, and it returns information about the specified BizTalk application as a **BTSysStatus** instance.</span></span> <span data-ttu-id="fea14-110">此信息包括业务流程、 发送端口、 接收位置和主机的详细信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-110">This information includes orchestrations, send ports, receive locations, and host details.</span></span>  
  
-   <span data-ttu-id="fea14-111">**GetLiveMessageBody**。</span><span class="sxs-lookup"><span data-stu-id="fea14-111">**GetLiveMessageBody**.</span></span> <span data-ttu-id="fea14-112">消息 ID 和实例 ID，此方法使用作为参数并返回该消息的正文从作为实时环境**BTMsgBody**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-112">This method takes as parameters a message ID and an instance ID, and it returns the body of that message from the live environment as a **BTMsgBody** instance.</span></span>  
  
-   <span data-ttu-id="fea14-113">**GetMessageInstances**。</span><span class="sxs-lookup"><span data-stu-id="fea14-113">**GetMessageInstances**.</span></span> <span data-ttu-id="fea14-114">此方法将作为参数的消息类型，并返回匹配的所有消息的集合作为**BTMsgInstance**对象。</span><span class="sxs-lookup"><span data-stu-id="fea14-114">This method takes as a parameter the message type, and it returns all matching messages as a collection of **BTMsgInstance** objects.</span></span>  
  
-   <span data-ttu-id="fea14-115">**GetOrchestrationInstances**。</span><span class="sxs-lookup"><span data-stu-id="fea14-115">**GetOrchestrationInstances**.</span></span> <span data-ttu-id="fea14-116">此方法使用作为参数的业务流程的名称和它将返回的集合**BTOrchestrationInstance**包含匹配的业务流程的详细信息的对象。</span><span class="sxs-lookup"><span data-stu-id="fea14-116">This method takes as parameters the name of an orchestration, and it returns a collection of **BTOrchestrationInstance** object that contain details of the matching orchestrations.</span></span>  
  
-   <span data-ttu-id="fea14-117">**GetTrackedMessageBody**。</span><span class="sxs-lookup"><span data-stu-id="fea14-117">**GetTrackedMessageBody**.</span></span> <span data-ttu-id="fea14-118">此方法将作为参数消息 GUID，并返回作为该消息的正文**BTMsgBody**实例后在 BizTalk 中处理。</span><span class="sxs-lookup"><span data-stu-id="fea14-118">This method takes as a parameter a message GUID, and it returns the body of that message as a **BTMsgBody** instance after it is processed in BizTalk.</span></span>  
  
-   <span data-ttu-id="fea14-119">**主机**。</span><span class="sxs-lookup"><span data-stu-id="fea14-119">**Hosts**.</span></span> <span data-ttu-id="fea14-120">此方法将作为参数而主机的名称和它返回有关指定的主机实例的集合的信息**BTHost**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-120">This method takes as a parameter the name of a host, and it returns information about the specified host instance as a collection of **BTHost** instances.</span></span> <span data-ttu-id="fea14-121">使用主机名称参数为空字符串返回有关所有主机实例的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-121">Use an empty string for the host name parameter to return information about all host instances.</span></span>  
  
-   <span data-ttu-id="fea14-122">**MessageFlowTree**。</span><span class="sxs-lookup"><span data-stu-id="fea14-122">**MessageFlowTree**.</span></span> <span data-ttu-id="fea14-123">此方法将作为参数的实例 ID，并返回作为该消息的消息流的详细信息**RouteTreeNode**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-123">This method takes as a parameter an instance ID, and it returns details of the message flow for that message as a **RouteTreeNode** instance.</span></span>  
  
-   <span data-ttu-id="fea14-124">**业务流程**。</span><span class="sxs-lookup"><span data-stu-id="fea14-124">**Orchestrations**.</span></span> <span data-ttu-id="fea14-125">此方法将作为参数的名称的业务流程，并返回适用于为该业务流程的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-125">This method takes as a parameter the name of an orchestration, and it returns all the information for that orchestration as a **BTSysStatus** instance.</span></span> <span data-ttu-id="fea14-126">业务流程名称参数为空字符串用于返回有关所有业务流程的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-126">Use an empty string for the orchestration name parameter to return information about all orchestrations.</span></span>  
  
-   <span data-ttu-id="fea14-127">**接收位置**。</span><span class="sxs-lookup"><span data-stu-id="fea14-127">**ReceiveLocations**.</span></span> <span data-ttu-id="fea14-128">此方法将作为参数接收位置的名称并返回匹配与位置的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-128">This method takes as a parameter the name of a receive location, and it returns all the information for matching locations as a **BTSysStatus** instance.</span></span> <span data-ttu-id="fea14-129">接收位置名称参数为空字符串用于返回有关所有位置的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-129">Use an empty string for the receive locations name parameter to return information about all locations.</span></span>  
  
-   <span data-ttu-id="fea14-130">**ReceiveLocationsByDescription**。</span><span class="sxs-lookup"><span data-stu-id="fea14-130">**ReceiveLocationsByDescription**.</span></span> <span data-ttu-id="fea14-131">此方法将作为参数接收位置的说明，并返回匹配与位置的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-131">This method takes as a parameter the description of a receive location, and it returns all the information for matching locations as a **BTSysStatus** instance.</span></span> <span data-ttu-id="fea14-132">Description 参数为空字符串用于返回有关所有位置的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-132">Use an empty string for the description parameter to return information about all locations.</span></span>  
  
-   <span data-ttu-id="fea14-133">**发送端口**。</span><span class="sxs-lookup"><span data-stu-id="fea14-133">**SendPorts**.</span></span> <span data-ttu-id="fea14-134">此方法将作为参数的名称发送端口，并返回匹配的端口的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-134">This method takes as a parameter the name of a send port, and it returns all the information for matching ports as a **BTSysStatus** instance.</span></span> <span data-ttu-id="fea14-135">发送端口名称参数为空字符串用于返回有关所有端口的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-135">Use an empty string for the send port name parameter to return information about all ports.</span></span>  
  
-   <span data-ttu-id="fea14-136">**SendPortsByDescription**。</span><span class="sxs-lookup"><span data-stu-id="fea14-136">**SendPortsByDescription**.</span></span> <span data-ttu-id="fea14-137">此方法将作为参数发送端口的说明，并返回匹配的端口的所有信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-137">This method takes as a parameter the description of a send port, and it returns all the information for matching ports as a **BTSysStatus** instance.</span></span> <span data-ttu-id="fea14-138">使用 description 参数为空字符串返回有关所有端口的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-138">Use an empty string for the description parameter to return information about all ports.</span></span>  
  
-   <span data-ttu-id="fea14-139">**StatusChanged**。</span><span class="sxs-lookup"><span data-stu-id="fea14-139">**StatusChanged**.</span></span> <span data-ttu-id="fea14-140">此方法将作为参数一个时间戳，并返回自指定时间戳作为以来修改的 BizTalk 对象 （如端口、 主机和业务流程） 的详细信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-140">This method takes as a parameter a timestamp, and it returns details of BizTalk objects (such as ports, hosts, and orchestrations) modified since the specified timestamp as a **BTSysStatus** instance.</span></span>  
  
-   <span data-ttu-id="fea14-141">**SystemStatus**。</span><span class="sxs-lookup"><span data-stu-id="fea14-141">**SystemStatus**.</span></span> <span data-ttu-id="fea14-142">此方法没有采用任何参数，它返回的形式的 BizTalk 系统状态的完整详细信息**BTSysStatus**实例。</span><span class="sxs-lookup"><span data-stu-id="fea14-142">This method takes no parameters, and it returns full details of the BizTalk system status as a **BTSysStatus** instance.</span></span>  
  
-   <span data-ttu-id="fea14-143">**UpdateReceiveLocationDescription**。</span><span class="sxs-lookup"><span data-stu-id="fea14-143">**UpdateReceiveLocationDescription**.</span></span> <span data-ttu-id="fea14-144">此方法将更新指定的接收位置使用包含应用程序名称、 接收端口名称、 接收位置名称，和接收位置描述的参数值的说明。</span><span class="sxs-lookup"><span data-stu-id="fea14-144">This method updates the description of a specified receive location using parameter values that contain the application name, the receive port name, the receive location name, and the receive location description.</span></span> <span data-ttu-id="fea14-145">它将返回一个字符串，指示该操作的结果。</span><span class="sxs-lookup"><span data-stu-id="fea14-145">It returns a String that indicates the result of the operation.</span></span> <span data-ttu-id="fea14-146">请注意测试客户端应用程序从其 App.config 文件中读取此信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-146">Note that the test client application reads this information from its App.config file.</span></span>  
  
-   <span data-ttu-id="fea14-147">**UpdateSendPortDescription**。</span><span class="sxs-lookup"><span data-stu-id="fea14-147">**UpdateSendPortDescription**.</span></span> <span data-ttu-id="fea14-148">使用包含发送端口名称和发送端口描述的参数值指定的发送端口的说明更新为此方法。</span><span class="sxs-lookup"><span data-stu-id="fea14-148">This method updates the description of a specified send port using parameter values that contain the send port name and the send port description.</span></span> <span data-ttu-id="fea14-149">它将返回一个字符串，指示该操作的结果。</span><span class="sxs-lookup"><span data-stu-id="fea14-149">It returns a String that indicates the result of the operation.</span></span> <span data-ttu-id="fea14-150">请注意测试客户端应用程序从其 App.config 文件中读取此信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-150">Note that the test client application reads this information from its App.config file.</span></span>  
  
## <a name="configuring-the-biztalk-operations-web-service"></a><span data-ttu-id="fea14-151">配置 BizTalk 操作 Web 服务</span><span class="sxs-lookup"><span data-stu-id="fea14-151">Configuring the BizTalk Operations Web Service</span></span>  
 <span data-ttu-id="fea14-152">BizTalk 操作 Web 服务可以直接与 BizTalk Server 管理数据库使用 Windows Management Instrumentation (WMI) 通信或它使用 BizTalk 操作和资源管理器 API 来获取所需的信息。</span><span class="sxs-lookup"><span data-stu-id="fea14-152">The BizTalk Operations Web service either communicates directly with the BizTalk Server management databases using Windows Management Instrumentation (WMI) or it uses the BizTalk Operations and Explorer API to obtain the information it requires.</span></span> <span data-ttu-id="fea14-153">因此，你必须确保你的系统满足以下条件和配置下列安全权限设置：</span><span class="sxs-lookup"><span data-stu-id="fea14-153">Therefore, you must make sure that your system meets the following conditions and that you configure the following security permission settings:</span></span>  
  
-   <span data-ttu-id="fea14-154">设置**allowOverride**到计算机级别的 Web.config 文件中的属性**false**若要确保开发人员不能更改其应用程序的信任级别。</span><span class="sxs-lookup"><span data-stu-id="fea14-154">Set the **allowOverride** attribute in the machine-level Web.config file to **false** to make sure developers cannot change the trust level of their applications.</span></span>  
  
-   <span data-ttu-id="fea14-155">默认情况下，BizTalk 操作 Web 服务未配置为需要安全套接字层 (SSL) 时的客户端访问。</span><span class="sxs-lookup"><span data-stu-id="fea14-155">By default, the BizTalk Operations Web service is not configured to require Secure Sockets Layer (SSL) when accessed by clients.</span></span> <span data-ttu-id="fea14-156">你应配置服务，因此它需要 SSL 客户端访问和保护 Internet Information Services (IIS) Web 服务主机计算机和运行承载 BizTalkMgmtDb 数据库使用的 SQL Server 的计算机之间的连接网络级别 IPSec 和相应的文件级访问控制列表 (ACL) 权限。</span><span class="sxs-lookup"><span data-stu-id="fea14-156">You should configure the service so that it requires SSL for client access, and protect the connection between the Internet Information Services (IIS) Web service host computer and the computer running SQL Server that hosts the BizTalkMgmtDb database using network-level IPSec and appropriate file-level access control list (ACL) permissions.</span></span>  
  
-   <span data-ttu-id="fea14-157">访问 BizTalk Operations Web 服务的用户必须对某些方法默认 BizTalk Server Administrators 组的成员和成员的默认 BizTalk 应用程序用户组的其他方法。</span><span class="sxs-lookup"><span data-stu-id="fea14-157">Users accessing the BizTalk Operations Web service must be members of the default BizTalk Server Administrators group for some methods and members of the default BizTalk Application Users group for other methods.</span></span>  
  
-   <span data-ttu-id="fea14-158">你必须确保 BizTalk 操作 Web 服务驻留在名为已禁用的匿名访问的 ESB.BizTalkOperationsService 的 IIS 虚拟目录。</span><span class="sxs-lookup"><span data-stu-id="fea14-158">You must make sure that the BizTalk Operations Web service resides in an IIS virtual directory named ESB.BizTalkOperationsService that has anonymous access disabled.</span></span>  
  
-   <span data-ttu-id="fea14-159">用户必须具有**选择**位于 BizTalkMgmtDb 数据库和 BizTalkMsgBoxDb 数据库的 SQL Server 中为多个表的权限。</span><span class="sxs-lookup"><span data-stu-id="fea14-159">Users must have **SELECT** permission in SQL Server for several tables located in the BizTalkMgmtDb database and the BizTalkMsgBoxDb database.</span></span> <span data-ttu-id="fea14-160">使用 SQL Server Management Studio 设置以下权限：</span><span class="sxs-lookup"><span data-stu-id="fea14-160">Use SQL Server Management Studio to set the following permissions:</span></span>  
  
    -   <span data-ttu-id="fea14-161">在 BizTalkMgmtDb 数据库中，配置具有 BTS_ADMIN_USERS 数据库角色**选择**以下表的权限：</span><span class="sxs-lookup"><span data-stu-id="fea14-161">In the BizTalkMgmtDb database, configure the BTS_ADMIN_USERS database role with **SELECT** permission on the following tables:</span></span>  
  
        -   <span data-ttu-id="fea14-162">adm_Server2HostMapping</span><span class="sxs-lookup"><span data-stu-id="fea14-162">adm_Server2HostMapping</span></span>  
  
        -   <span data-ttu-id="fea14-163">adm_Server</span><span class="sxs-lookup"><span data-stu-id="fea14-163">adm_Server</span></span>  
  
        -   <span data-ttu-id="fea14-164">adm_hostInstance</span><span class="sxs-lookup"><span data-stu-id="fea14-164">adm_hostInstance</span></span>  
  
    -   <span data-ttu-id="fea14-165">在 BizTalkMsgBoxDb 数据库中，配置具有 BTS_ADMIN_USER 数据库角色**选择**ProcessHeartbeats 表的权限。</span><span class="sxs-lookup"><span data-stu-id="fea14-165">In the BizTalkMsgBoxDb database, configure the BTS_ADMIN_USER database role with **SELECT** permission on the ProcessHeartbeats table.</span></span>  
  
 <span data-ttu-id="fea14-166">在 SQL Server Management Studio，你可以配置所需的权限。</span><span class="sxs-lookup"><span data-stu-id="fea14-166">In SQL Server Management Studio, you can configure the required permissions.</span></span> <span data-ttu-id="fea14-167">若要执行此操作，展开**安全**在左窗格中对象资源管理器树视图中，展开**角色**，展开**DatabaseRoles**、 选择 BTS_ADMIN_USERS 角色，然后编辑此角色，如图 1 中所示的的属性。</span><span class="sxs-lookup"><span data-stu-id="fea14-167">To do this, expand **Security** in the left pane tree view of Object Explorer, expand **Roles**, expand **DatabaseRoles**, select the BTS_ADMIN_USERS role, and then edit the properties for this role, as shown in Figure 1.</span></span>  
  
 <span data-ttu-id="fea14-168">![SQL Server 管理 Studio](../esb-toolkit/media/ch4-sqlservermgmtstudio.gif "第四章第 4 SQLServerMgmtStudio")</span><span class="sxs-lookup"><span data-stu-id="fea14-168">![SQL Server Mgmt Studio](../esb-toolkit/media/ch4-sqlservermgmtstudio.gif "Ch4-SQLServerMgmtStudio")</span></span>  
  
 <span data-ttu-id="fea14-169">**图 1**</span><span class="sxs-lookup"><span data-stu-id="fea14-169">**Figure 1**</span></span>  
  
 <span data-ttu-id="fea14-170">**编辑在 Microsoft SQL Server Management Studio 中的 BTS_ADMIN_USERS 数据库角色的权限**</span><span class="sxs-lookup"><span data-stu-id="fea14-170">**Editing permissions for the BTS_ADMIN_USERS database role in Microsoft SQL Server Management Studio**</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="fea14-171">你必须配置为使用 Windows 集成安全性并在内置网络服务帐户下运行此服务。</span><span class="sxs-lookup"><span data-stu-id="fea14-171">You must configure this service to use Windows Integrated Security and run under the built-in NETWORK SERVICE account.</span></span> <span data-ttu-id="fea14-172">你还必须启用 Kerberos 身份验证 IIS Web 服务器上，以便它将此标头发**协商、 NTLM**到客户端。</span><span class="sxs-lookup"><span data-stu-id="fea14-172">You must also enable Kerberos authentication on your IIS Web server so that it sends the header **Negotiate,NTLM** to the client.</span></span> <span data-ttu-id="fea14-173">有关详细信息，请参阅[如何配置 IIS 以支持用于网络身份验证的 Kerberos 协议和 NTLM 协议](http://go.microsoft.com/fwlink/?LinkId=186430)([http://go.microsoft.com/fwlink/?LinkId=186430](http://go.microsoft.com/fwlink/?LinkId=186430))。</span><span class="sxs-lookup"><span data-stu-id="fea14-173">For more information, see [How to configure IIS to support both the Kerberos protocol and the NTLM protocol for network authentication](http://go.microsoft.com/fwlink/?LinkId=186430)([http://go.microsoft.com/fwlink/?LinkId=186430](http://go.microsoft.com/fwlink/?LinkId=186430)).</span></span>  
>   
>  <span data-ttu-id="fea14-174">默认情况下，BizTalk 操作 Web 服务未配置为需要 SSL 时的客户端访问。</span><span class="sxs-lookup"><span data-stu-id="fea14-174">By default, the BizTalk Operations Web service is not configured to require SSL when accessed by clients.</span></span> <span data-ttu-id="fea14-175">你应配置服务，因此需要 SSL 的客户端访问和保护 IIS Web 服务主机计算机和承载使用网络级别 IPSec 和相应的文件级 ACL 权限 UDDI 服务的服务器之间的连接。</span><span class="sxs-lookup"><span data-stu-id="fea14-175">You should configure the service so that it requires SSL for client access and protect the connection between the IIS Web service host computer and the server that hosts the UDDI service using network-level IPSec and appropriate file-level ACL permissions.</span></span>