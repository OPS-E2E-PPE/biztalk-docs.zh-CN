---
title: 接收数据库更改通知 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: be1eacf1-7fba-4eca-b35b-9770904d9ebd
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7cdc28a49b99f4869bf1471c1c05de1c057838fe
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22217325"
---
# <a name="receive-database-change-notifications"></a><span data-ttu-id="58b36-102">接收数据库更改通知</span><span class="sxs-lookup"><span data-stu-id="58b36-102">Receive database change notifications</span></span>
<span data-ttu-id="58b36-103">[!INCLUDE[adapteroracleebusinesslong](../../includes/adapteroracleebusinesslong-md.md)]支持 ODP.NET 数据库更改通知功能。</span><span class="sxs-lookup"><span data-stu-id="58b36-103">The [!INCLUDE[adapteroracleebusinesslong](../../includes/adapteroracleebusinesslong-md.md)] supports the ODP.NET Database Change Notification feature.</span></span> <span data-ttu-id="58b36-104">使用此功能，适配器客户端可以将注册的 SELECT 语句为在数据库中，通知查询并数据库以对适配器客户端及其在结果集的 SELECT 语句更改时发送通知。</span><span class="sxs-lookup"><span data-stu-id="58b36-104">Using this feature, the adapter clients can register a SELECT statement as the notification query on the database, and the database sends a notification to the adapter client as and when the result set of the SELECT statement changes.</span></span> <span data-ttu-id="58b36-105">在使用 OracleDependency 类适配器中实现数据库更改通知。</span><span class="sxs-lookup"><span data-stu-id="58b36-105">The database change notification is implemented in the adapter using the OracleDependency class.</span></span> <span data-ttu-id="58b36-106">有关 ODP.NET 和 OracleDependency 类中的数据库更改支持功能的更多特定于 Oracle 的信息，请转到[http://go.microsoft.com/fwlink/p/?LinkId=124801](http://go.microsoft.com/fwlink/p/?LinkId=124801)。</span><span class="sxs-lookup"><span data-stu-id="58b36-106">For more Oracle-specific information about the Database Change Support feature in ODP.NET and the OracleDependency class, go to [http://go.microsoft.com/fwlink/p/?LinkId=124801](http://go.microsoft.com/fwlink/p/?LinkId=124801).</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="58b36-107">先决条件</span><span class="sxs-lookup"><span data-stu-id="58b36-107">Prerequisites</span></span>  
 <span data-ttu-id="58b36-108">[!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)]公开的入站的操作，通知，以支持数据库更改通知。</span><span class="sxs-lookup"><span data-stu-id="58b36-108">The [!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)] exposes an inbound operation, Notification, to support database change notification.</span></span> <span data-ttu-id="58b36-109">但是，数据库的更改通知用于[!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)]，必须确保以下：</span><span class="sxs-lookup"><span data-stu-id="58b36-109">However, for the database change notification to work with [!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)], you must ensure the following:</span></span>  
  
-   <span data-ttu-id="58b36-110">使用的基础的 Oracle 数据库版本 10.2 或更高版本连接到 Oracle E-business Suite。</span><span class="sxs-lookup"><span data-stu-id="58b36-110">Connect to Oracle E-Business Suite with the underlying Oracle database version 10.2 or later.</span></span> <span data-ttu-id="58b36-111">10.2 之前的 oracle 数据库版本不支持通知。</span><span class="sxs-lookup"><span data-stu-id="58b36-111">Oracle database versions prior to 10.2 do not support notifications.</span></span>  
  
-   <span data-ttu-id="58b36-112">以有权创建通知注册更改通知的用户身份连接到 Oracle E-business Suite。</span><span class="sxs-lookup"><span data-stu-id="58b36-112">Connect to Oracle E-Business Suite as a user that has the CHANGE NOTIFICATION privilege to create a notification registration.</span></span> <span data-ttu-id="58b36-113">若要向用户授予更改通知特权，以具有管理权限的用户身份连接到 Oracle 数据库并在 SQL 提示符处运行以下命令：</span><span class="sxs-lookup"><span data-stu-id="58b36-113">To grant the CHANGE NOTIFICATION privilege to a user, connect to the Oracle database as a user with administrative privileges, and run the following command at the SQL prompt:</span></span>  
  
    ```  
    grant change notification to <user name>  
    ```  
  
-   <span data-ttu-id="58b36-114">决定 ODP.NET 可以用于接收从 Oracle 数据库的数据库更改通知的 TCP 端口。</span><span class="sxs-lookup"><span data-stu-id="58b36-114">Decide on a TCP port that can be used by ODP.NET to receive database change notifications from Oracle database.</span></span> <span data-ttu-id="58b36-115">将 TCP 端口添加到 Windows 防火墙例外列表。</span><span class="sxs-lookup"><span data-stu-id="58b36-115">Add the TCP port to Windows Firewall exceptions list.</span></span> <span data-ttu-id="58b36-116">有关如何将端口添加到 Windows 防火墙例外列表的说明，请参阅[http://go.microsoft.com/fwlink/?LinkID=196959](http://go.microsoft.com/fwlink/?LinkID=196959)。</span><span class="sxs-lookup"><span data-stu-id="58b36-116">For instructions on how to add ports to Windows Firewall exceptions list, see [http://go.microsoft.com/fwlink/?LinkID=196959](http://go.microsoft.com/fwlink/?LinkID=196959).</span></span> <span data-ttu-id="58b36-117">必须提供相同的 TCP 端口号，供**NotificationPort**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="58b36-117">You must provide the same TCP port number for the **NotificationPort** binding property.</span></span> <span data-ttu-id="58b36-118">有关绑定属性的详细信息，请参阅[了解针对 Oracle E-business Suite 绑定属性的 BizTalk 适配器](../../adapters-and-accelerators/adapter-oracle-ebs/read-about-the-biztalk-adapter-for-oracle-e-business-suite-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="58b36-118">For more information about the binding property, see [Read about the  BizTalk Adapter for Oracle E-Business Suite Binding Properties](../../adapters-and-accelerators/adapter-oracle-ebs/read-about-the-biztalk-adapter-for-oracle-e-business-suite-binding-properties.md).</span></span>  
  
 <span data-ttu-id="58b36-119">典型的数据库更改通知使用[!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)]涉及下列：</span><span class="sxs-lookup"><span data-stu-id="58b36-119">A typical database change notification using the [!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)] involves the following:</span></span>  
  
1.  <span data-ttu-id="58b36-120">适配器客户端必须指定`Notification`中的入站操作作为**InboundOperationType**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="58b36-120">The adapter clients must specify `Notification` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="58b36-121">正在轮询此绑定属性的默认值。</span><span class="sxs-lookup"><span data-stu-id="58b36-121">The default value for this binding property is Polling.</span></span>  
  
2.  <span data-ttu-id="58b36-122">适配器客户端必须指定 SQL SELECT 语句中的数据库更改通知注册**NotificationStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="58b36-122">The adapter clients must specify a SQL SELECT statement to register for database change notifications in the **NotificationStatement** binding property.</span></span> <span data-ttu-id="58b36-123">从 Oracle 数据库作为和的结果集指定的 SQL 语句更改，则适配器客户端获取通知。</span><span class="sxs-lookup"><span data-stu-id="58b36-123">The adapter client gets a notification from Oracle database as and when the result set for the specified SQL statement changes.</span></span>  
  
3.  <span data-ttu-id="58b36-124">适配器客户端必须指定适配器是否在中启动侦听器时，就会立即在向适配器客户端发送了通知**NotifyOnListenerStart**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="58b36-124">The adapter clients must specify whether the adapter sends a notification to the adapter clients as soon as the listener is started in the **NotifyOnListenerStart** binding property.</span></span>  
  
4.  <span data-ttu-id="58b36-125">向作为适配器客户端发送通知，当结果集的 SELECT 语句中指定**NotificationStatement**绑定属性更改。</span><span class="sxs-lookup"><span data-stu-id="58b36-125">The notification is sent to the adapter clients as and when the result set of the SELECT statement specified in the **NotificationStatement** binding property is changed.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="58b36-126">如果没有在 Oracle 数据库和适配器客户端之间的网络中断，通知将不发送到适配器客户端的网络中断期间对 Oracle 数据库进行的更改并且之后。</span><span class="sxs-lookup"><span data-stu-id="58b36-126">If there is a network outage between the Oracle database and the adapter client, the notifications will not be sent to the adapter clients for the changes done on the Oracle database during the period of network outage, and thereafter.</span></span> <span data-ttu-id="58b36-127">因此，你必须使用轮询操作而不是关键方案的通知操作。</span><span class="sxs-lookup"><span data-stu-id="58b36-127">Therefore, you must use the Polling operation instead of the Notification operation for critical scenarios.</span></span>  
  
## <a name="differences-between-notification-and-polling"></a><span data-ttu-id="58b36-128">通知和轮询之间的差异</span><span class="sxs-lookup"><span data-stu-id="58b36-128">Differences between Notification and Polling</span></span>  
 <span data-ttu-id="58b36-129">尽管通知和轮询是这两个入站的操作，Oracle 数据库中的数据更改通知适配器客户端下, 表说明了这两个之间的一些差异。</span><span class="sxs-lookup"><span data-stu-id="58b36-129">Though notification and polling are both inbound operations, and inform the adapter clients about the data changes in the Oracle database, the following table illustrates some differences between the two.</span></span> <span data-ttu-id="58b36-130">以下差异将帮助你决定在具体取决于你的要求操作：</span><span class="sxs-lookup"><span data-stu-id="58b36-130">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="58b36-131">通知</span><span class="sxs-lookup"><span data-stu-id="58b36-131">Notification</span></span>|<span data-ttu-id="58b36-132">轮询</span><span class="sxs-lookup"><span data-stu-id="58b36-132">Polling</span></span>|  
|------------------|-------------|  
|<span data-ttu-id="58b36-133">通知是仅支持 Oracle 数据库版本 10.2 及更高版本。</span><span class="sxs-lookup"><span data-stu-id="58b36-133">Notification is supported only for Oracle database versions 10.2 and later.</span></span>|<span data-ttu-id="58b36-134">所有支持的 Oracle 数据库版本支持轮询[!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="58b36-134">Polling is supported for all the Oracle database versions that are supported by the [!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)].</span></span>|  
|<span data-ttu-id="58b36-135">数据更改通知始终是即时的。</span><span class="sxs-lookup"><span data-stu-id="58b36-135">The data-change notification is always instantaneous.</span></span>|<span data-ttu-id="58b36-136">你可以配置的轮询间隔来检查可用于按固定时间间隔轮询数据或即时的方式，以及何时有可用的数据。</span><span class="sxs-lookup"><span data-stu-id="58b36-136">You can either configure the polling interval to check the data available for polling at regular intervals or instantaneously as and when the data is available.</span></span> <span data-ttu-id="58b36-137">**提示：** 轮询可以为你提供更佳的吞吐量在数据更改发生连续，并且不希望为每项更改的和发生时要通知的情况下。</span><span class="sxs-lookup"><span data-stu-id="58b36-137">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="58b36-138">作为替代，你指定要在其后的发生是因为最后一个更改通知的所有更改的通知轮询间隔。</span><span class="sxs-lookup"><span data-stu-id="58b36-138">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last change notification.</span></span>|  
|<span data-ttu-id="58b36-139">Oracle 数据库发出通知。</span><span class="sxs-lookup"><span data-stu-id="58b36-139">Notification is initiated by the Oracle database.</span></span> <span data-ttu-id="58b36-140">只需适配器发出的通知语句指示要在该语句结果集中的更改的情况下启动通知的数据库。</span><span class="sxs-lookup"><span data-stu-id="58b36-140">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span> <span data-ttu-id="58b36-141">通知是 Oracle 数据库的一项功能。</span><span class="sxs-lookup"><span data-stu-id="58b36-141">Notification is a feature of the Oracle database.</span></span>|<span data-ttu-id="58b36-142">轮询启动的适配器。</span><span class="sxs-lookup"><span data-stu-id="58b36-142">Polling is initiated by the adapter.</span></span> <span data-ttu-id="58b36-143">适配器执行 SQL 语句以验证是否数据可用于轮询，并随后通过执行轮询语句，如果某些数据可用于轮询开始轮询。</span><span class="sxs-lookup"><span data-stu-id="58b36-143">The adapter executes a SQL statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|  
|<span data-ttu-id="58b36-144">可以使用通知语句仅具有读取 Oracle 数据库中的数据。</span><span class="sxs-lookup"><span data-stu-id="58b36-144">You can use the notification statement to only read data in an Oracle database.</span></span>|<span data-ttu-id="58b36-145">轮询语句可用于读取或更新的 Oracle 数据库中的数据。</span><span class="sxs-lookup"><span data-stu-id="58b36-145">You can use the polling statement to read or update data in the Oracle database.</span></span>|  
|<span data-ttu-id="58b36-146">通知会告知仅如 Insert、 数据中的更改类型的更新和删除。</span><span class="sxs-lookup"><span data-stu-id="58b36-146">Notification informs only about the type of change in the data such as Insert, Update, and Delete.</span></span>|<span data-ttu-id="58b36-147">轮询通知你有关已更改的实际数据信息。</span><span class="sxs-lookup"><span data-stu-id="58b36-147">Polling informs you about the actual data that has changed.</span></span>|  
  
 <span data-ttu-id="58b36-148">有关详细信息：</span><span class="sxs-lookup"><span data-stu-id="58b36-148">For more information about:</span></span>  
  
-   <span data-ttu-id="58b36-149">绑定属性与此通知操作，请参阅[了解针对 Oracle E-business Suite 绑定属性的 BizTalk 适配器](../../adapters-and-accelerators/adapter-oracle-ebs/read-about-the-biztalk-adapter-for-oracle-e-business-suite-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="58b36-149">The binding properties related to the Notification operation, see [Read about the  BizTalk Adapter for Oracle E-Business Suite Binding Properties](../../adapters-and-accelerators/adapter-oracle-ebs/read-about-the-biztalk-adapter-for-oracle-e-business-suite-binding-properties.md).</span></span>  
  
-   <span data-ttu-id="58b36-150">如何使用中的通知操作[!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)]，请参阅[Reaceive 的数据库已由更改通知使用的 BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-using-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="58b36-150">How to use the Notification operation in [!INCLUDE[adapteroraclebusinessshort](../../includes/adapteroraclebusinessshort-md.md)], see [Reaceive Database Change Notifications Using BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="58b36-151">另请参阅</span><span class="sxs-lookup"><span data-stu-id="58b36-151">See Also</span></span>  
 <span data-ttu-id="58b36-152">[哪些操作可以是执行使用适配器？](https://msdn.microsoft.com/library/cc185219(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="58b36-152">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185219(v=bts.10).aspx)</span></span>