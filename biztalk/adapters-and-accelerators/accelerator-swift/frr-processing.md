---
title: "FRR 处理 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- FRR, processing
- FRR, components
- FRR, process flow
ms.assetid: 8b064d18-5ee7-44fd-95d1-9a0d66f1ad1a
caps.latest.revision: "3"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f2b0d34ccffd2bf09148bcfc5544b38ea5d0033d
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="frr-processing"></a><span data-ttu-id="a6d51-102">FRR 处理</span><span class="sxs-lookup"><span data-stu-id="a6d51-102">FRR Processing</span></span>
<span data-ttu-id="a6d51-103">[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] FIN 响应对帐 (FRR) 功能包含来自的原始消息关联 FIN 消息从 SWIFT 联盟访问 (SAA) [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] SAA 消息响应。</span><span class="sxs-lookup"><span data-stu-id="a6d51-103">The [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] FIN Response Reconciliation (FRR) feature correlates FIN messages from the SWIFT Alliance Access (SAA) with the original message from [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] that the SAA message responds to.</span></span> <span data-ttu-id="a6d51-104">每当[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]发送原始消息，FRR 缓存绑定 SWIFT 和的任何消息的副本不失败处理。</span><span class="sxs-lookup"><span data-stu-id="a6d51-104">Whenever [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] sends an original message, FRR caches a copy of any message that is bound for SWIFT and that has not failed processing.</span></span> <span data-ttu-id="a6d51-105">然后，它监视的响应消息返回到 SAA MessageBox [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]，接收对应于缓存的消息副本的任何 ACK/否认消息。</span><span class="sxs-lookup"><span data-stu-id="a6d51-105">It then monitors the MessageBox for response messages returned by SAA to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)], and picks up any ACK/NAK messages that corresponds to the cached message copy.</span></span>  
  
 <span data-ttu-id="a6d51-106">FRR 通过比较相关性 ID 属性建立传出消息和传入消息之间的相关性。</span><span class="sxs-lookup"><span data-stu-id="a6d51-106">FRR establishes a correlation between an outgoing message and an incoming message by comparing correlation ID properties.</span></span> <span data-ttu-id="a6d51-107">FRR 设置的副本的原始消息的性质的响应，根据提升的属性，并随后将原始消息路由到 MessageBox 进行进一步处理。</span><span class="sxs-lookup"><span data-stu-id="a6d51-107">FRR sets promoted properties of the copy of the original message according to the nature of the response, and then routes the original message to the MessageBox for further processing.</span></span>  
  
## <a name="frr-components"></a><span data-ttu-id="a6d51-108">FRR 组件</span><span class="sxs-lookup"><span data-stu-id="a6d51-108">FRR Components</span></span>  
 <span data-ttu-id="a6d51-109">FRR 包括一个持续的过程 （业务流程），用于监视传出和传入消息，并为每个传出或传入消息，将提升将用于比较的标识属性。</span><span class="sxs-lookup"><span data-stu-id="a6d51-109">FRR includes an ongoing process (orchestration) that monitors outgoing and incoming messages, and for each outgoing or incoming message, promotes the identification properties that it will use for comparison.</span></span> <span data-ttu-id="a6d51-110">一系列[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]组件结合起来，FRR 业务流程中的 FRR 组件之间路由消息[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]，和之间[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]和 SAA。</span><span class="sxs-lookup"><span data-stu-id="a6d51-110">A series of [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] components work together with the FRR orchestration, routing messages between the FRR components within [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)], and between [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] and SAA.</span></span> <span data-ttu-id="a6d51-111">下面列出了这些组件：</span><span class="sxs-lookup"><span data-stu-id="a6d51-111">These components are listed below:</span></span>  
  
-   <span data-ttu-id="a6d51-112">FRR 接收从后端应用程序接收原始消息的位置。</span><span class="sxs-lookup"><span data-stu-id="a6d51-112">An FRR receive location that receives the original message from the back-end application.</span></span>  
  
-   <span data-ttu-id="a6d51-113">FRR 业务流程，用于监视传出和传入消息，并建立它们之间的相关性。</span><span class="sxs-lookup"><span data-stu-id="a6d51-113">The FRR orchestration that monitors outgoing and incoming messages, and establishes the correlation between them.</span></span>  
  
-   <span data-ttu-id="a6d51-114">FRR 发送端口发送原始消息从[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]到 SAA。</span><span class="sxs-lookup"><span data-stu-id="a6d51-114">An FRR send port that sends the original message from [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] to SAA.</span></span>  
  
-   <span data-ttu-id="a6d51-115">使之间的数据传输的 MQSeries BizTalk 适配器[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]和 SAA （它使用 MQSeries 队列）。</span><span class="sxs-lookup"><span data-stu-id="a6d51-115">The BizTalk Adapter for MQSeries that enables data transmission between [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] and SAA (which uses MQSeries queues).</span></span>  
  
-   <span data-ttu-id="a6d51-116">FRR 接收从 SAA 接收 FIN 响应消息的位置。</span><span class="sxs-lookup"><span data-stu-id="a6d51-116">An FRR receive location that receives FIN response messages from SAA.</span></span>  
  
-   <span data-ttu-id="a6d51-117">一组的 FRR 发送端口，其中每个发送中特定类型的相关的消息[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]到的后端应用程序自定义处理。</span><span class="sxs-lookup"><span data-stu-id="a6d51-117">A set of FRR send ports, each of which sends correlated messages of a specific type from [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] to a back-end application for custom processing.</span></span>  
  
 <span data-ttu-id="a6d51-118">上面的组件，你可以将添加到的后端自定义处理程序处理原始消息已由 FRR 设置种提升的属性。</span><span class="sxs-lookup"><span data-stu-id="a6d51-118">To the above components, you can add a back-end custom handler that processes the original message the promoted properties of which have been set by FRR.</span></span>  
  
## <a name="frr-process-flow"></a><span data-ttu-id="a6d51-119">FRR 流程</span><span class="sxs-lookup"><span data-stu-id="a6d51-119">FRR Process Flow</span></span>  
 [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]<span data-ttu-id="a6d51-120">在以下过程中执行对帐：</span><span class="sxs-lookup"><span data-stu-id="a6d51-120"> performs the reconciliation in the following process:</span></span>  
  
1.  <span data-ttu-id="a6d51-121">后端应用程序将路由到原始消息[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a6d51-121">The back-end application routes the original message to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span>  
  
2.  <span data-ttu-id="a6d51-122">FRR 接收位置接收消息，在关联的接收管道中对其进行处理并将它路由到 BizTalk MessageBox。</span><span class="sxs-lookup"><span data-stu-id="a6d51-122">An FRR receive location receives the message, processes it in the associated receive pipeline, and routes it to the BizTalk MessageBox.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="a6d51-123">你可以结合使用 FRR[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]消息修复和新提交功能，或单独。</span><span class="sxs-lookup"><span data-stu-id="a6d51-123">You can use FRR in conjunction with the [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] Message Repair and New Submission feature, or separately.</span></span> <span data-ttu-id="a6d51-124">如果你已安装消息修复和新的提交，可以在步骤 2 后配置消息修复的系统。</span><span class="sxs-lookup"><span data-stu-id="a6d51-124">If you have installed Message Repair and New Submission, you can configure the system for message repair after step 2.</span></span> <span data-ttu-id="a6d51-125">消息修复业务流程将修复/验证/批准消息路由回到后续 FRR 处理 BizTalk MessageBox。</span><span class="sxs-lookup"><span data-stu-id="a6d51-125">The message-repair orchestration routes the repaired/verified/approved message back to the BizTalk MessageBox for subsequent FRR processing.</span></span>  
  
3.  <span data-ttu-id="a6d51-126">如果消息框中的消息被绑定到 SWIFT 和已通过验证，[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]激活 FRR 业务流程的实例。</span><span class="sxs-lookup"><span data-stu-id="a6d51-126">If the message in the MessageBox is bound for SWIFT and has passed validation, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] activates an instance of the FRR orchestration.</span></span> <span data-ttu-id="a6d51-127">业务流程将在传出消息的副本。</span><span class="sxs-lookup"><span data-stu-id="a6d51-127">The orchestration keeps a copy of the outgoing message.</span></span> <span data-ttu-id="a6d51-128">然后，它处于激活状态等待来自 SAA，因此它可以匹配任何传入的响应的传出消息的响应。</span><span class="sxs-lookup"><span data-stu-id="a6d51-128">It then waits in an activated state for a response from SAA, so it can match the outgoing message to any incoming response.</span></span> <span data-ttu-id="a6d51-129">业务流程的此实例仅处理该特定的传出消息和对该邮件的任何相关的响应。</span><span class="sxs-lookup"><span data-stu-id="a6d51-129">This instance of the orchestration only processes that specific outgoing message and any correlated responses to that message.</span></span> <span data-ttu-id="a6d51-130">任何其他消息，甚至优先于相同的类型，由业务流程的另一个实例处理。</span><span class="sxs-lookup"><span data-stu-id="a6d51-130">Any other message, even of the same type, is processed by another instance of the orchestration.</span></span>  
  
4.  <span data-ttu-id="a6d51-131">在同一时间[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]激活 FRR orchestration 实例时，[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]将消息路由到将消息发送到 SAA 发送端口。</span><span class="sxs-lookup"><span data-stu-id="a6d51-131">At the same time that [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] activates the FRR orchestration instance, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] routes the message to the send port that sends messages to SAA.</span></span> <span data-ttu-id="a6d51-132">发送管道促进消息标识属性和所需的处理由 MQSeries 属性。</span><span class="sxs-lookup"><span data-stu-id="a6d51-132">The send pipeline promotes a message-identification property and properties required for processing by MQSeries.</span></span> <span data-ttu-id="a6d51-133">它然后将消息发送到 BizTalk 适配器为 MQSeries。</span><span class="sxs-lookup"><span data-stu-id="a6d51-133">It then sends the message to the BizTalk Adapter for MQSeries.</span></span>  
  
5.  <span data-ttu-id="a6d51-134">MQSeries BizTalk 适配器传输到 SAA 上的相应 MQSeries 队列消息。</span><span class="sxs-lookup"><span data-stu-id="a6d51-134">The BizTalk Adapter for MQSeries transports the message to the appropriate MQSeries queue at SAA.</span></span>  
  
6.  <span data-ttu-id="a6d51-135">SAA 生成用于直接路由回即时响应[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a6d51-135">SAA generates an immediate response for routing directly back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span> <span data-ttu-id="a6d51-136">SAA 然后将消息路由到 SWIFT 网络。</span><span class="sxs-lookup"><span data-stu-id="a6d51-136">SAA then routes the message to the SWIFT Network.</span></span> <span data-ttu-id="a6d51-137">SWIFT 网络生成其他响应，它会将发送给 SAA 路由回[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a6d51-137">The SWIFT Network generates other responses, which it sends to SAA for routing back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span> <span data-ttu-id="a6d51-138">SAA 将 FIN 响应消息的相关令牌属性设置为原始消息的消息标识值。</span><span class="sxs-lookup"><span data-stu-id="a6d51-138">SAA sets the correlation token property for the FIN response message to the message-identification value of the original message.</span></span>  
  
7.  <span data-ttu-id="a6d51-139">通过 MQSeries BizTalk 适配器 FIN 响应发回到 SAA 传输[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a6d51-139">SAA transports the FIN response through the BizTalk Adapter for MQSeries back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span>  
  
8.  <span data-ttu-id="a6d51-140">FRR 接收位置接收响应，并将通过 FRR 条消息路由接收处理响应的相关标记的管道。</span><span class="sxs-lookup"><span data-stu-id="a6d51-140">The FRR receive location receives the response and routes the message through the FRR receive pipeline that processes the response's correlation token.</span></span> <span data-ttu-id="a6d51-141">然后，它将响应放置在 BizTalk 消息框中。</span><span class="sxs-lookup"><span data-stu-id="a6d51-141">It then places the response in the BizTalk MessageBox.</span></span>  
  
9. <span data-ttu-id="a6d51-142">FRR 业务流程实例从那里获取的任何消息具有相关令牌等于原始消息的副本的消息 ID 属性 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="a6d51-142">The FRR orchestration instance picks up any message from the MessageBox that has a correlation token equal to the message ID property of the copy of the original message.</span></span>  
  
10. <span data-ttu-id="a6d51-143">如果该响应指示 SAA/SWIFT 成功处理原始消息，FRR 业务流程实例的副本的原始消息的 A4SWIFT_Failed 提升属性设置为 False，并设置 BTS。操作属性设置为适当的值。</span><span class="sxs-lookup"><span data-stu-id="a6d51-143">If the response indicates that the original message was successfully processed by SAA/SWIFT, the FRR orchestration instance sets the A4SWIFT_Failed promoted property of the copy of the original message to False, and sets the BTS.Operation property to the appropriate value.</span></span>  
  
11. <span data-ttu-id="a6d51-144">如果未通过 SAA/SWIFT 成功处理原始消息，FRR 业务流程实例设置 BTS。为适当的值的操作属性，然后通过将 A4SWIFT_Failed 设置为 True 和 A4SWIFT_FRRFailedReason 提升属性设置为失败的原因指定修复的消息。</span><span class="sxs-lookup"><span data-stu-id="a6d51-144">If the original message was not successfully processed by SAA/SWIFT, the FRR orchestration instance sets the BTS.Operation property to the appropriate value, and then designates the message for repair by setting A4SWIFT_Failed to True and setting the A4SWIFT_FRRFailedReason promoted property to the reason for the failure.</span></span>  
  
12. <span data-ttu-id="a6d51-145">FRR 业务流程实例放弃响应消息，并随后将原始消息的副本 （使用提升的属性，该值指示响应） 路由到 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="a6d51-145">The FRR orchestration instance discards the response message(s), and then routes the copy of the original message (with promoted properties indicating the response) to the MessageBox.</span></span>  
  
13. <span data-ttu-id="a6d51-146">FRR 发送端口之一设置以便将路由到一个或多个自定义处理程序选取提升的属性的原始消息的副本的响应。</span><span class="sxs-lookup"><span data-stu-id="a6d51-146">One of the FRR send ports set up to route the responses to one or more custom handlers picks up the copy of the original message with the promoted properties.</span></span>  
  
14. <span data-ttu-id="a6d51-147">自定义处理程序或处理程序订阅中, 检索，并处理所需的后端应用程序的原始消息的副本。</span><span class="sxs-lookup"><span data-stu-id="a6d51-147">The custom handler or handlers subscribes to, retrieves, and processes the copy of the original message as required for the back-end application.</span></span>