---
title: FRR 处理 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- FRR, processing
- FRR, components
- FRR, process flow
ms.assetid: 8b064d18-5ee7-44fd-95d1-9a0d66f1ad1a
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f1e3873bd70055d59cf4a216b084ea84594980f7
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65377570"
---
# <a name="frr-processing"></a><span data-ttu-id="e9704-102">FRR 处理</span><span class="sxs-lookup"><span data-stu-id="e9704-102">FRR Processing</span></span>
<span data-ttu-id="e9704-103">[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] FIN 响应对帐 (FRR) 功能将与来自原始消息相关联 FIN 消息从 SWIFT 联盟访问 (SAA) [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] SAA 消息响应。</span><span class="sxs-lookup"><span data-stu-id="e9704-103">The [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] FIN Response Reconciliation (FRR) feature correlates FIN messages from the SWIFT Alliance Access (SAA) with the original message from [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] that the SAA message responds to.</span></span> <span data-ttu-id="e9704-104">每当[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]发送原始消息时，FRR 缓存的和 SWIFT 绑定任何消息的副本不具有故障处理。</span><span class="sxs-lookup"><span data-stu-id="e9704-104">Whenever [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] sends an original message, FRR caches a copy of any message that is bound for SWIFT and that has not failed processing.</span></span> <span data-ttu-id="e9704-105">然后，它监视的响应消息返回到 SAA MessageBox [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]，接收对应于缓存的消息复制任何 ACK/NAK 消息。</span><span class="sxs-lookup"><span data-stu-id="e9704-105">It then monitors the MessageBox for response messages returned by SAA to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)], and picks up any ACK/NAK messages that corresponds to the cached message copy.</span></span>  

 <span data-ttu-id="e9704-106">FRR 通过比较相关 ID 属性来建立传出消息和传入消息之间的相关性。</span><span class="sxs-lookup"><span data-stu-id="e9704-106">FRR establishes a correlation between an outgoing message and an incoming message by comparing correlation ID properties.</span></span> <span data-ttu-id="e9704-107">FRR 设置升级的属性的特性的响应，根据原始消息的副本，并随后将原始消息路由到 MessageBox 中以便进一步处理。</span><span class="sxs-lookup"><span data-stu-id="e9704-107">FRR sets promoted properties of the copy of the original message according to the nature of the response, and then routes the original message to the MessageBox for further processing.</span></span>  

## <a name="frr-components"></a><span data-ttu-id="e9704-108">FRR 组件</span><span class="sxs-lookup"><span data-stu-id="e9704-108">FRR Components</span></span>  
 <span data-ttu-id="e9704-109">FRR 包括一个持续的过程 （业务流程），用于监视传出和传入消息，并对于每个传出或传入消息，升级将用来比较标识属性。</span><span class="sxs-lookup"><span data-stu-id="e9704-109">FRR includes an ongoing process (orchestration) that monitors outgoing and incoming messages, and for each outgoing or incoming message, promotes the identification properties that it will use for comparison.</span></span> <span data-ttu-id="e9704-110">一系列[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]组件一起使用 FRR 业务流程、 路由中的 FRR 组件之间的消息[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]，和介于[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]和 SAA。</span><span class="sxs-lookup"><span data-stu-id="e9704-110">A series of [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] components work together with the FRR orchestration, routing messages between the FRR components within [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)], and between [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] and SAA.</span></span> <span data-ttu-id="e9704-111">下面列出了这些组件：</span><span class="sxs-lookup"><span data-stu-id="e9704-111">These components are listed below:</span></span>  

- <span data-ttu-id="e9704-112">FRR 接收位置从后端应用程序接收原始消息。</span><span class="sxs-lookup"><span data-stu-id="e9704-112">An FRR receive location that receives the original message from the back-end application.</span></span>  

- <span data-ttu-id="e9704-113">FRR 业务流程，用于监视传出和传入消息，并建立它们之间的相关性。</span><span class="sxs-lookup"><span data-stu-id="e9704-113">The FRR orchestration that monitors outgoing and incoming messages, and establishes the correlation between them.</span></span>  

- <span data-ttu-id="e9704-114">FRR 发送端口发送原始消息从[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]SAA 到。</span><span class="sxs-lookup"><span data-stu-id="e9704-114">An FRR send port that sends the original message from [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] to SAA.</span></span>  

- <span data-ttu-id="e9704-115">用于使之间的数据传输的 MQSeries 的 BizTalk 适配器[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]和 SAA （它使用 MQSeries 队列）。</span><span class="sxs-lookup"><span data-stu-id="e9704-115">The BizTalk Adapter for MQSeries that enables data transmission between [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] and SAA (which uses MQSeries queues).</span></span>  

- <span data-ttu-id="e9704-116">FRR 接收位置用于接收来自 SAA FIN 响应消息。</span><span class="sxs-lookup"><span data-stu-id="e9704-116">An FRR receive location that receives FIN response messages from SAA.</span></span>  

- <span data-ttu-id="e9704-117">FRR 发送端口，其中每个发送相关的消息中的特定类型的一组[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]到后端应用程序进行自定义处理。</span><span class="sxs-lookup"><span data-stu-id="e9704-117">A set of FRR send ports, each of which sends correlated messages of a specific type from [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] to a back-end application for custom processing.</span></span>  

  <span data-ttu-id="e9704-118">到更高版本的组件，可以添加后端自定义处理程序，用于处理原始消息的 FRR 已设置的升级的属性。</span><span class="sxs-lookup"><span data-stu-id="e9704-118">To the above components, you can add a back-end custom handler that processes the original message the promoted properties of which have been set by FRR.</span></span>  

## <a name="frr-process-flow"></a><span data-ttu-id="e9704-119">FRR 处理流程</span><span class="sxs-lookup"><span data-stu-id="e9704-119">FRR Process Flow</span></span>  
 [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] <span data-ttu-id="e9704-120">以下过程中执行对帐：</span><span class="sxs-lookup"><span data-stu-id="e9704-120">performs the reconciliation in the following process:</span></span>  

1. <span data-ttu-id="e9704-121">后端应用程序将路由到原始消息[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="e9704-121">The back-end application routes the original message to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span>  

2. <span data-ttu-id="e9704-122">接收的 FRR 接收位置接收消息、 在关联的接收管道中，对其进行处理，并将其路由到 BizTalk MessageBox。</span><span class="sxs-lookup"><span data-stu-id="e9704-122">An FRR receive location receives the message, processes it in the associated receive pipeline, and routes it to the BizTalk MessageBox.</span></span>  

   > [!NOTE]
   >  <span data-ttu-id="e9704-123">可以结合使用 FRR[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]消息修复和新提交功能，或单独。</span><span class="sxs-lookup"><span data-stu-id="e9704-123">You can use FRR in conjunction with the [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] Message Repair and New Submission feature, or separately.</span></span> <span data-ttu-id="e9704-124">如果已安装消息修复和新提交，您可以在步骤 2 后配置消息修复的系统。</span><span class="sxs-lookup"><span data-stu-id="e9704-124">If you have installed Message Repair and New Submission, you can configure the system for message repair after step 2.</span></span> <span data-ttu-id="e9704-125">消息修复业务流程将修复/验证/批准消息路由回 BizTalk MessageBox 中以便后续 FRR 处理。</span><span class="sxs-lookup"><span data-stu-id="e9704-125">The message-repair orchestration routes the repaired/verified/approved message back to the BizTalk MessageBox for subsequent FRR processing.</span></span>  

3. <span data-ttu-id="e9704-126">如果 MessageBox 中的消息的 SWIFT 绑定，并且已通过验证，[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]激活 FRR 业务流程实例。</span><span class="sxs-lookup"><span data-stu-id="e9704-126">If the message in the MessageBox is bound for SWIFT and has passed validation, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] activates an instance of the FRR orchestration.</span></span> <span data-ttu-id="e9704-127">业务流程将传出消息的副本。</span><span class="sxs-lookup"><span data-stu-id="e9704-127">The orchestration keeps a copy of the outgoing message.</span></span> <span data-ttu-id="e9704-128">然后，它处于激活状态等待来自 SAA，因此它可以与匹配任何传入的响应的传出消息的响应。</span><span class="sxs-lookup"><span data-stu-id="e9704-128">It then waits in an activated state for a response from SAA, so it can match the outgoing message to any incoming response.</span></span> <span data-ttu-id="e9704-129">业务流程的此实例只处理该特定的传出消息和任何相关的响应该消息。</span><span class="sxs-lookup"><span data-stu-id="e9704-129">This instance of the orchestration only processes that specific outgoing message and any correlated responses to that message.</span></span> <span data-ttu-id="e9704-130">任何其他的消息的相同的类型，甚至是由业务流程的另一个实例进行处理。</span><span class="sxs-lookup"><span data-stu-id="e9704-130">Any other message, even of the same type, is processed by another instance of the orchestration.</span></span>  

4. <span data-ttu-id="e9704-131">在同一时间[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]FRR 业务流程实例，将激活[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]将消息路由到发送端口将消息发送到 SAA。</span><span class="sxs-lookup"><span data-stu-id="e9704-131">At the same time that [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] activates the FRR orchestration instance, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] routes the message to the send port that sends messages to SAA.</span></span> <span data-ttu-id="e9704-132">发送管道会升级消息标识属性和所需的处理通过 MQSeries 属性。</span><span class="sxs-lookup"><span data-stu-id="e9704-132">The send pipeline promotes a message-identification property and properties required for processing by MQSeries.</span></span> <span data-ttu-id="e9704-133">然后将该消息对 BizTalk 适配器发送的 MQSeries。</span><span class="sxs-lookup"><span data-stu-id="e9704-133">It then sends the message to the BizTalk Adapter for MQSeries.</span></span>  

5. <span data-ttu-id="e9704-134">用于 MQSeries 的 BizTalk 适配器会将传输到位于 SAA 相应的 MQSeries 队列的消息。</span><span class="sxs-lookup"><span data-stu-id="e9704-134">The BizTalk Adapter for MQSeries transports the message to the appropriate MQSeries queue at SAA.</span></span>  

6. <span data-ttu-id="e9704-135">SAA 生成即时响应直接路由回[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="e9704-135">SAA generates an immediate response for routing directly back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span> <span data-ttu-id="e9704-136">SAA 然后将该消息路由到 SWIFT 网络。</span><span class="sxs-lookup"><span data-stu-id="e9704-136">SAA then routes the message to the SWIFT Network.</span></span> <span data-ttu-id="e9704-137">SWIFT 网络生成其他响应，将其发送到 SAA 路由回[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="e9704-137">The SWIFT Network generates other responses, which it sends to SAA for routing back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span> <span data-ttu-id="e9704-138">SAA 将 FIN 响应消息的相关令牌属性设置为原始消息的消息的标识值。</span><span class="sxs-lookup"><span data-stu-id="e9704-138">SAA sets the correlation token property for the FIN response message to the message-identification value of the original message.</span></span>  

7. <span data-ttu-id="e9704-139">通过用于 MQSeries 的 BizTalk 适配器 FIN 响应发回到 SAA 传输[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="e9704-139">SAA transports the FIN response through the BizTalk Adapter for MQSeries back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span>  

8. <span data-ttu-id="e9704-140">接收的 FRR 接收位置接收的响应，并将路由该消息的 FRR 接收管道处理响应的相关标记。</span><span class="sxs-lookup"><span data-stu-id="e9704-140">The FRR receive location receives the response and routes the message through the FRR receive pipeline that processes the response's correlation token.</span></span> <span data-ttu-id="e9704-141">它然后将响应放置到 BizTalk MessageBox 中。</span><span class="sxs-lookup"><span data-stu-id="e9704-141">It then places the response in the BizTalk MessageBox.</span></span>  

9. <span data-ttu-id="e9704-142">FRR 业务流程实例从 MessageBox 具有一个等于原始消息的副本的消息 ID 属性的相关标记提取的任何消息。</span><span class="sxs-lookup"><span data-stu-id="e9704-142">The FRR orchestration instance picks up any message from the MessageBox that has a correlation token equal to the message ID property of the copy of the original message.</span></span>  

10. <span data-ttu-id="e9704-143">如果该响应指示原始消息已成功处理通过 SAA/SWIFT，FRR 业务流程实例将原始消息的副本将提升 A4SWIFT_Failed 属性设置为 False，并设置 BTS。操作属性设置为适当的值。</span><span class="sxs-lookup"><span data-stu-id="e9704-143">If the response indicates that the original message was successfully processed by SAA/SWIFT, the FRR orchestration instance sets the A4SWIFT_Failed promoted property of the copy of the original message to False, and sets the BTS.Operation property to the appropriate value.</span></span>  

11. <span data-ttu-id="e9704-144">如果通过 SAA/SWIFT 原始消息未成功处理，FRR 业务流程实例设置 BTS。操作属性设置为适当的值，并将修复该消息然后指定通过 A4SWIFT_Failed 设置为 True 并提升 A4SWIFT_FRRFailedReason 属性设置为失败的原因。</span><span class="sxs-lookup"><span data-stu-id="e9704-144">If the original message was not successfully processed by SAA/SWIFT, the FRR orchestration instance sets the BTS.Operation property to the appropriate value, and then designates the message for repair by setting A4SWIFT_Failed to True and setting the A4SWIFT_FRRFailedReason promoted property to the reason for the failure.</span></span>  

12. <span data-ttu-id="e9704-145">FRR 业务流程实例将丢弃的响应消息，并随后将原始消息的副本 （与升级的属性，该值指示响应） 路由到 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="e9704-145">The FRR orchestration instance discards the response message(s), and then routes the copy of the original message (with promoted properties indicating the response) to the MessageBox.</span></span>  

13. <span data-ttu-id="e9704-146">其中一个的 FRR 发送端口设置以将答复转到一个或多个自定义处理程序从其中提取已升级的属性的原始消息的副本。</span><span class="sxs-lookup"><span data-stu-id="e9704-146">One of the FRR send ports set up to route the responses to one or more custom handlers picks up the copy of the original message with the promoted properties.</span></span>  

14. <span data-ttu-id="e9704-147">自定义处理程序或处理程序订阅、 检索，并处理原始消息所需的后端应用程序的副本。</span><span class="sxs-lookup"><span data-stu-id="e9704-147">The custom handler or handlers subscribes to, retrieves, and processes the copy of the original message as required for the back-end application.</span></span>
