---
title: Insert、 Update、 Delete 和选择表和视图与 SQL 适配器的操作 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d0cc39d5-16f2-454a-8e1d-c031592439ae
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f57aa7252fc838473f87418953e081a33a42ae12
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36993622"
---
# <a name="insert-update-delete-and-select-operations-on-tables-and-views-with-the-sql-adapter"></a>Insert、 Update、 Delete 和选择表和视图与 SQL 适配器操作
[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]显示一组的每个表和视图中的 SQL Server 数据库上的标准操作。 通过使用这些操作，可以执行简单的 INSERT、 UPDATE、 SELECT 和 DELETE 语句目标表或视图的 WHERE 子句的限定。 这些操作也称为数据操作语言 (DML) 操作。  

 下表显示的 DML 操作[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]支持：  


| 运算 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  Insert   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      执行插入操作的目标表或视图上。<br /><br /> -插入操作将记录的数组作为输入。 每个记录强类型化为目标表，并映射到表中插入行。<br />-你可以在提供的值的标识列中插入值**AllowIdentityInsert**绑定属性设置为 TRUE。 有关详细信息**AllowIdentityInsert**绑定属性，请参阅[了解有关 SQL Server 适配器绑定属性的 BizTalk 适配器](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。<br />的插入操作返回值为长整型数据类型的数组。 如果有，则此数组存储插入的行的标识值。 如果在表中没有标识列，返回值为 NULL。<br /><br /> 中的插入操作消息的某些值视为按以下方式通过[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:<br /><br /> 的为计算的列以及时间戳列指定值将被忽略。<br />-如果标识列的节点为 null，则忽略它。<br /><br /> 对于 Insert 操作消息中的所有其他值：<br /><br /> -如果为列指定值，该值是在 INSERT 语句中使用。<br />-如果为特定的列的节点为 null，在 INSERT 语句中使用 NULL。 **注意：** 如果对于特定的记录，没有可以在 INSERT 语句中使用的值 （即，没有指定值的任何列或所有列的值已都忽略），适配器将执行以下 SQL 语句： `insert into <table_name> default values`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|  选择   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               对目标表或基于记录 （列） 的数组和一个查询字符串，指定 WHERE 子句的视图执行 SELECT 语句。<br /><br /> 的必须为 SELECT 语句中的列的列表指定值。 如果要在表或视图中检索所有列都有\*必须在 SELECT 语句中指定。 如果要检索特定列，必须由逗号分隔，列名称，并将其指定的相同顺序为它们在表或视图定义中。<br />必须在 SELECT 语句中包含 WHERE 子句。 但是，如果您不想要在 WHERE 子句中指定一个值，您可以删除`Query`元素或将其留空。<br />-选择操作还可以执行更新操作。 在这种情况下，UPDATE 语句置于`Query`SELECT 语句中的元素。<br /><br /> 选择操作的返回值是强类型化结果集包含指定的列和目标表或视图中的行。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|  Update   | 执行更新操作上的目标表或视图。<br /><br /> -更新操作将记录对的数组作为输入。 每个记录对两个记录的集合，每条记录是强类型化为目标表。<br /><br /> -第一条记录对应于需要更新的新值，也就是说，它对应于 UPDATE 语句的 SET 子句。 <br />-另一条记录对应的行的旧值，也就是说，它对应于 UPDATE 语句的 WHERE 子句。 **注意：** 如果对特定记录有可用的 SET 子句中没有值，该记录对执行没有 UPDATE 语句。 <br />-你可以更新中提供的值的标识列的值**AllowIdentityInsert**绑定属性设置为 TRUE。 有关详细信息**AllowIdentityInsert**绑定属性，请参阅[了解有关 SQL Server 适配器绑定属性的 BizTalk 适配器](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。 <br />的更新操作返回值是 Int32 数据类型，表示更新的行数。<br /> 更新操作消息中的某些值视为按以下方式通过[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:<br /><br /> 的为计算的列以及时间戳列的消息的 SET 子句中指定值将被忽略。<br />-如果用户定义类型 (UDT) 不是字节进行排序，为 UDT 列指定的值在 WHERE 子句是被忽略。<br />-如果标识列的节点为 null 的消息的 SET 子句中，则忽略它。<br />-如果的标识或时间戳列的节点为 null 的消息的 WHERE 子句中，则忽略它。<br />-如果图像、 XML、 Text 或 Ntext 列的节点不在消息的 WHERE 子句中为 null，因为这些值不能进行比较，将忽略为其指定的值。<br /><br /> 对于更新操作消息中的所有其他值：<br /><br /> -如果 UPDATE 语句的 SET 子句中的列指定值，该语句的 SET 子句中使用的值 (`set <column_name> = <value>`)。<br />-如果为特定的列的节点为空的 SET 子句中，UPDATE 语句中使用 NULL (`set <column_name> = null`)。<br />-如果一个值，指定列中的 UPDATE 语句的 WHERE 子句，该语句的 WHERE 子句中使用的值 (`where <column_name> = <value>`)。<br />-如果为特定的列的节点为 null 在 WHERE 子句的 UPDATE 语句中，UPDATE 语句中使用 NULL (`where <column_name> is null`)。 |
|  DELETE   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        执行删除操作对目标表或视图基于强类型化数组的目标表和一个筛选器字符串，指定 WHERE 子句的记录 （列名称的列表）。<br /><br /> 删除操作的返回值是 Int32 数据类型，表示删除的行数。<br /><br /> 删除操作消息中的某些值视为按以下方式通过[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:<br /><br /> -如果图像、 XML、 Text 或 Ntext 列的节点不在消息的 WHERE 子句中为 null，因为这些值不能进行比较，将忽略为其指定的值。<br />-如果的标识或时间戳列的节点为 null，则忽略它。<br />-如果 UDT 不是字节进行排序，为 UDT 列指定的值在 WHERE 子句是被忽略。<br /><br /> 对于删除操作消息中的所有其他值：<br /><br /> -如果为列指定值，在 DELETE 语句的 WHERE 子句中使用的值 (`where <column_name> = <value>`)。<br />-如果为特定的列的节点为 null，在 DELETE 语句中使用 NULL (`where <column_name> is null`)。 **注意：** 如果对于特定的记录，有没有可用在 DELETE 语句 （即，没有指定值的任何列或所有存在的列值已被忽略） 的值，该适配器不会执行任何 DELETE 语句。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

 有关详细信息：  

- 执行这些操作使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]，请参阅[插入、 更新、 删除或将 BizTalk Server 与 SQL 适配器的 select 操作](../../adapters-and-accelerators/adapter-sql/insert-update-delete-or-select-using-the-sql-adapter-in-biztalk-server.md)。  

- 消息结构和 SOAP 操作用于在执行 DML 操作，请参见[Insert、 Update、 Delete 和对表和视图的选择操作的消息架构](../../adapters-and-accelerators/adapter-sql/message-schemas-for-insert-update-delete-and-select-on-tables-and-views.md)。  

## <a name="see-also"></a>请参阅  
 [连接到 SAP 系统使用的适配器](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)