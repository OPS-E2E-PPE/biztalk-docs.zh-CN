---
title: "接收查询通知使用的 SQL 适配器 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 6b2ed0f0-d005-4eec-b1a6-97a0c94678dc
caps.latest.revision: "10"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 37d333a2248c943d1d404aa086565ae4b1662226
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="receive-query-notifications-using-the-sql-adapter"></a><span data-ttu-id="15cb5-102">接收查询通知使用的 SQL 适配器</span><span class="sxs-lookup"><span data-stu-id="15cb5-102">Receive query notifications using the SQL adapter</span></span>
<span data-ttu-id="15cb5-103">适配器客户端可以订阅接收查询通知有关数据更改 SQL Server 数据库中。</span><span class="sxs-lookup"><span data-stu-id="15cb5-103">The adapter clients can subscribe to receive query notifications about the data changes in the SQL Server database.</span></span> <span data-ttu-id="15cb5-104">SQL SELECT 语句或存储的过程用于触发的查询通知中，表中指定的数据更改条件以及 SQL Server 发送作为查询通知和时的结果集的 SELECT 语句或存储的过程更改。</span><span class="sxs-lookup"><span data-stu-id="15cb5-104">A SQL SELECT statement or a stored procedure specifies the data-change criteria in a table for triggering of the query notifications, and the SQL Server sends query notifications as and when the result set for the SELECT statement or the stored procedure changes.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="15cb5-105">若要支持查询通知，适配器客户端和 SQL Server 数据库必须满足某些要求。</span><span class="sxs-lookup"><span data-stu-id="15cb5-105">To support query notifications, the adapter clients and the SQL Server database have to fulfill certain requirements.</span></span> <span data-ttu-id="15cb5-106">有关这些要求的详细信息，请参阅"启用查询通知"网址[http://go.microsoft.com/fwlink/?LinkID=122323](http://go.microsoft.com/fwlink/?LinkID=122323)。</span><span class="sxs-lookup"><span data-stu-id="15cb5-106">For detailed information about these requirements, see “Enabling Query Notifications” at [http://go.microsoft.com/fwlink/?LinkID=122323](http://go.microsoft.com/fwlink/?LinkID=122323).</span></span>  
  
 <span data-ttu-id="15cb5-107">典型查询通知涉及以下过程：</span><span class="sxs-lookup"><span data-stu-id="15cb5-107">A typical query notification involves the following:</span></span>  
  
-   <span data-ttu-id="15cb5-108">适配器客户端必须指定`Notification`中的入站操作作为**InboundOperationType**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="15cb5-108">The adapter clients must specify `Notification` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="15cb5-109">此绑定属性的默认值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="15cb5-109">The default value for this binding property is `Polling`.</span></span>  
  
-   <span data-ttu-id="15cb5-110">适配器客户端必须指定一个 SQL 语句来注册中的查询通知**NotificationStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="15cb5-110">The adapter clients must specify a SQL statement to register for query notifications in the **NotificationStatement** binding property.</span></span> <span data-ttu-id="15cb5-111">指定的 SQL 语句更改的结果集时，就会立即适配器客户端从 SQL Server 中获取一条通知。</span><span class="sxs-lookup"><span data-stu-id="15cb5-111">The adapter client gets a notification from SQL Server as soon as the result set for the specified SQL statement changes.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="15cb5-112">若要接收通知，通知订阅的 SQL 语句*必须*满足特定条件。</span><span class="sxs-lookup"><span data-stu-id="15cb5-112">To receive notifications, the SQL statement for the notification subscription *must* meet certain criteria.</span></span> <span data-ttu-id="15cb5-113">有关可以用于查询通知的 SQL 语句的信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=122160](http://go.microsoft.com/fwlink/?LinkId=122160)。</span><span class="sxs-lookup"><span data-stu-id="15cb5-113">For information about SQL statements that can be used for query notifications, see [http://go.microsoft.com/fwlink/?LinkId=122160](http://go.microsoft.com/fwlink/?LinkId=122160).</span></span>  
  
-   <span data-ttu-id="15cb5-114">适配器客户端必须指定适配器是否在中启动侦听器时，就会立即在向适配器客户端发送了通知**NotifyOnListenerStart**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="15cb5-114">The adapter clients must specify whether the adapter sends a notification to the adapter clients as soon as the listener is started in the **NotifyOnListenerStart** binding property.</span></span>  
  
-   <span data-ttu-id="15cb5-115">通知将发送到适配器客户端视为和中的结果集时指定的 SQL 语句**NotificationStatement**绑定属性更改。</span><span class="sxs-lookup"><span data-stu-id="15cb5-115">The notification is sent to the adapter clients as and when the result set of the SQL statement specified in the **NotificationStatement** binding property is changed.</span></span>  
  
 <span data-ttu-id="15cb5-116">有关这些绑定属性的详细信息，请参阅[了解针对 SQL Server 适配器绑定属性的 BizTalk 适配器](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="15cb5-116">For more information about these binding properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="15cb5-117">通知订阅始终是已提交，无论该语句已运行的事务已提交还是回滚。</span><span class="sxs-lookup"><span data-stu-id="15cb5-117">The notification subscription is always committed, regardless of whether the transaction in which the statement ran was committed or rolled back.</span></span> <span data-ttu-id="15cb5-118">因此，该通知操作可能不保证查询通知订阅的结果已更改。</span><span class="sxs-lookup"><span data-stu-id="15cb5-118">Therefore, the notification operation might not guarantee that the result of the query subscribed for notification has changed.</span></span> <span data-ttu-id="15cb5-119">例如，假设数据插入表行中 （订阅通知） 在事务中，并立即将通知发送到的更改 （插入） 的相关适配器通知。</span><span class="sxs-lookup"><span data-stu-id="15cb5-119">For example, suppose data is inserted in a table row (subscribed for notification) in a transaction, and immediately a notification is sent to the adapter informing about the change (insert).</span></span> <span data-ttu-id="15cb5-120">由于某些原因，事务能够回滚，并有效地将任何数据插入到表行。</span><span class="sxs-lookup"><span data-stu-id="15cb5-120">Due to some reason, the transaction rolls back, and effectively no data is inserted into the table row.</span></span> <span data-ttu-id="15cb5-121">但是，SQL Server 不会将通知发送到有关事务回滚适配器。</span><span class="sxs-lookup"><span data-stu-id="15cb5-121">However, the SQL Server does not send a notification to the adapter about the transaction roll back.</span></span> <span data-ttu-id="15cb5-122">有关 SQL Server 中的查询通知的信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=145367](http://go.microsoft.com/fwlink/?LinkId=145367)。</span><span class="sxs-lookup"><span data-stu-id="15cb5-122">For information about query notifications in SQL Server, see [http://go.microsoft.com/fwlink/?LinkId=145367](http://go.microsoft.com/fwlink/?LinkId=145367).</span></span>  
  
## <a name="differences-between-query-notification-and-polling"></a><span data-ttu-id="15cb5-123">查询通知和轮询之间的差异</span><span class="sxs-lookup"><span data-stu-id="15cb5-123">Differences between Query Notification and Polling</span></span>  
 <span data-ttu-id="15cb5-124">尽管查询通知和轮询是这两个入站的操作，SQL Server 数据库中的数据更改通知适配器客户端下, 表列出这两者之间的一些差异。</span><span class="sxs-lookup"><span data-stu-id="15cb5-124">Though query notification and polling are both inbound operations, and inform the adapter clients about the data changes in the SQL Server database, the following table lists some differences between the two.</span></span> <span data-ttu-id="15cb5-125">以下差异将帮助你决定在具体取决于你的要求操作：</span><span class="sxs-lookup"><span data-stu-id="15cb5-125">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="15cb5-126">查询通知</span><span class="sxs-lookup"><span data-stu-id="15cb5-126">Query Notification</span></span>|<span data-ttu-id="15cb5-127">轮询</span><span class="sxs-lookup"><span data-stu-id="15cb5-127">Polling</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="15cb5-128">通过 SQL Server 启动的查询通知。</span><span class="sxs-lookup"><span data-stu-id="15cb5-128">Query notification is initiated by SQL Server.</span></span> <span data-ttu-id="15cb5-129">只需适配器发出的通知语句指示要在该语句结果集中的更改的情况下启动通知的数据库。</span><span class="sxs-lookup"><span data-stu-id="15cb5-129">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span>|<span data-ttu-id="15cb5-130">轮询启动的适配器。</span><span class="sxs-lookup"><span data-stu-id="15cb5-130">Polling is initiated by the adapter.</span></span> <span data-ttu-id="15cb5-131">适配器执行一个语句来验证是否数据可用于轮询，并随后通过执行轮询语句，如果某些数据可用于轮询开始轮询。</span><span class="sxs-lookup"><span data-stu-id="15cb5-131">The adapter executes a statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|  
|<span data-ttu-id="15cb5-132">可以使用查询通知语句仅具有读取 SQL Server 数据库表中的数据。</span><span class="sxs-lookup"><span data-stu-id="15cb5-132">You can use the query notification statement to only read data in a SQL Server database table.</span></span>|<span data-ttu-id="15cb5-133">轮询语句可用于读取或更新 SQL Server 数据库表中的数据。</span><span class="sxs-lookup"><span data-stu-id="15cb5-133">You can use the polling statement to read or update data in a SQL Server database table.</span></span>|  
|<span data-ttu-id="15cb5-134">查询通知会告知仅如 Insert、 数据中的更改类型的更新和删除。</span><span class="sxs-lookup"><span data-stu-id="15cb5-134">Query notification informs only about the type of change in the data such as Insert, Update, and Delete.</span></span>|<span data-ttu-id="15cb5-135">轮询通知你有关已更改的实际数据信息。</span><span class="sxs-lookup"><span data-stu-id="15cb5-135">Polling informs you about the actual data that has changed.</span></span>|  
|<span data-ttu-id="15cb5-136">数据更改通知是即时的。</span><span class="sxs-lookup"><span data-stu-id="15cb5-136">The data-change notification is instantaneous.</span></span>|<span data-ttu-id="15cb5-137">数据更改通知取决于轮询间隔，并且在每个轮询间隔的末尾，有关数据更改的适配器客户端通知。</span><span class="sxs-lookup"><span data-stu-id="15cb5-137">The data-change notification depends on the polling interval, and the adapter clients are informed about the data changes at the end of every polling interval.</span></span> <span data-ttu-id="15cb5-138">**提示：**轮询可以为你提供更佳的吞吐量在数据更改发生连续，并且不希望为每项更改的和发生时要通知的情况下。</span><span class="sxs-lookup"><span data-stu-id="15cb5-138">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="15cb5-139">作为替代，你指定要在其后的发生是因为最后一个更改通知的所有更改的通知轮询间隔。</span><span class="sxs-lookup"><span data-stu-id="15cb5-139">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last change notification.</span></span>|  
  
 <span data-ttu-id="15cb5-140">有关中的查询通知的详细信息[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]，请参阅[使用 BizTalk server 接收 SQL 的查询通知](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="15cb5-140">For more information about query notification in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)], see [Receive SQL Query Notifications by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15cb5-141">另请参阅</span><span class="sxs-lookup"><span data-stu-id="15cb5-141">See Also</span></span>  
 <span data-ttu-id="15cb5-142">[哪些操作可以是执行使用适配器？](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="15cb5-142">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span></span>