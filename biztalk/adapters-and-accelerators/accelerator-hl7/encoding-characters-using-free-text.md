---
title: 使用自定义文本的字符进行编码 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a69dffe1-3fb2-4902-a9a2-093f3ea7b11f
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 59a89a1748112e9dc8f639fd408ed2525242505b
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36987462"
---
# <a name="encoding-characters-using-free-text"></a>使用自定义文本的字符进行编码
从开始[!INCLUDE[bts2013r2](../../includes/bts2013r2-md.md)]，可以在字段或段中使用"FreeText"。 未能分析"FreeText"字段/段中的数据。  
  
## <a name="what-you-need-to-know"></a>您需要了解  
  
|                            |                                                                                                                                                行为                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     示例                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  ~: 重复分隔符   |                                  在字段中，重复 （~） 被视为重复分隔符。 非免费段中重复 （~） 被视为重复分隔符。 在免费段中，重复 （~） 被视为自定义文本，重复新的一部分。                                   | 在以下示例中，如 FRE 是免费的段。 它可以具有任何字符作为自定义文本，包括 ~。 任何其他重复 （~） 不被视为重复分隔符，而是被视为自定义文本内容。 验证成功，即使免费段的子非可重复且包含重复 （~）。 如 FRE 示例：<br /><br /> **如 FRE&#124; Foo & ^&#124;Foo & ^&#124;Foo & ^&#124;Foo （& a) ^ ~ Foo & ^&#124;Foo & ^&#124;Foo & ^&#124;Foo （& a) ^**<br /><br /> 在以下示例中，EVN4 定义为自定义文本因为它包含*&^*。 当"&#124;"在遇到分隔符，则它将被视为当前自定义文本的末尾。 EVN 示例：<br /><br /> **EVN&#124;&#124;&#124;&#124;Foo & ^ Foo & ^ Foo & ^ Foo & ^ Foo （& a) ^&#124;&#124;**<br /><br /> 以下示例中，EVN5 的第一个子级定义为自定义文本因为它包含*&*。 当"^"遇到分隔符，它将被视为当前自定义文本的末尾。 EVN5 示例：<br /><br /> **EVN&#124; &#124; &#124; &#124; &#124; Foo 和 Foo & Foo 和 Foo 和 Foo & ^5.2&#124;**<br /><br /> 在以下示例中，5.2.1 章和 5.2.2 不能将任何分隔符作为自定义文本，即使在架构中定义为 FreeText。 5.2.1 章和 5.2.2 示例：<br /><br /> **EVN&#124; &#124; &#124; &#124; &#124; Foo1 ^5.2.1 章 & 5.2.2&#124;**<br /><br /> 在以下示例中，假定 EVN4 可重复且的自定义文本类型。 *Foo1 & ^* 被视为第一个重复并*Foo2 & ^* 作为第二个重复处理。 如果 EVN4 不是可重复 (MaxOccurs = 1)，则验证将失败，如果它包含 ~，即使它是自定义文本类型 （例如，在非免费文本字段的情况下）。 EVN4 示例：<br /><br /> <strong>EVN &#124; &#124; &#124; &#124; Foo1 （& a) ^ ~ Foo2 （& a) ^&#124;&#124;</strong> |
|  &#124;： 字段分隔符   |                                                                                                     字段分隔符缺少免费段，段标记后，如果验证成功。                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            在以下示例中，如 FRE 是自定义文本类型。 免费的文本内容可以如 FRE 段标记中，带或不带后立即启动"&#124;"字段分隔符。 这两个示例会成功：<br /><br /> **FREabc** <br /> **如 FRE&#124;abc**<br /><br /> 在以下示例中，验证将成功：<br /><br /> 输入的消息 DASM:**如 FRE&#124;abcd**<br />输出从 DASM:  **\<SegmentData\>&#124;abcd\</SegmentData\>**<br />输出从 ASM:**如 FRE&#124;abcd**<br /><br /> 输入的消息 DASM: **FREabcd**<br />输出从 DASM:  **\<SegmentData\>abcd\</SegmentData\>**<br />输出从 ASM: **FREabcd**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|   父-子可选    |                                                                                                                        父-子可选的验证规则仍然适用。                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            假设父级是可选的它的一个子级是必需的然后：<br /><br /> -如果没有其他子级和必需的子未填充，则消息验证成功。<br />-如果填充至少一个子级，则应还填充的必需子级。 否则，将消息验证失败。<br /><br /> 在下面的示例中，为可选字段 1。 其*1.a*子是可选的是自定义文本类型。 其*1.b*子是必需的：<br /><br /> **xyz&#124;1.a^1.b&#124;2**<br /><br /> 在下面的示例消息中， *dfssdf*<em>&</em>*sdf*被视为单个元素-1.a。 分析器检查 1.b 是否存在。 当 *&#124;* 是达到，假定未填充 1.b 和消息验证失败：<br /><br /> **xyz&#124;dfssdf & sdf&#124;2**                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MSH、 FSH 和 BSH 段 |                                                                  对于所有字段，自定义文本将被忽略。 这些段对应于标头部分。 和往常一样，即使它们被定义为自定义文本，会发生验证。                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|    \\： 转义符    | 如果有偶数个元素中的"\"，验证将成功 （即使它们是不连续的）。 如果有奇数数目，验证将失败。 相同的行为将继续为非免费文本字段。 自定义文本字段后，不会验证数量;它作为自定义文本内容。 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
  
 [消息分隔符](../../adapters-and-accelerators/accelerator-hl7/message-delimiters.md)提供有关这些示例中的分隔符的详细信息。  
  
## <a name="using-free-text"></a>使用自定义文本  
  
1.  在 Visual Studio 中的项目，打开架构。  
  
2.  右键单击记录，选择**插入 Schema 节点**，选择**子字段元素**。  
  
3.  在属性中，选择**数据类型**，然后选择**自定义文本 (SimpleType)**。  
  
## <a name="see-also"></a>请参阅  
 [处理 HL7 消息](../../adapters-and-accelerators/accelerator-hl7/processing-hl7-messages.md)