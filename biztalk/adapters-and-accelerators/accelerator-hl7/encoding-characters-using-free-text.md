---
title: 使用自定义文本的字符进行编码 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a69dffe1-3fb2-4902-a9a2-093f3ea7b11f
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 629e0a60a9781b9610e4cfad3502086fca8071c8
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65264494"
---
# <a name="encoding-characters-using-free-text"></a><span data-ttu-id="3a465-102">使用自定义文本的字符进行编码</span><span class="sxs-lookup"><span data-stu-id="3a465-102">Encoding Characters using Free Text</span></span>
<span data-ttu-id="3a465-103">从开始[!INCLUDE[bts2013r2](../../includes/bts2013r2-md.md)]，可以在字段或段中使用"FreeText"。</span><span class="sxs-lookup"><span data-stu-id="3a465-103">Starting with [!INCLUDE[bts2013r2](../../includes/bts2013r2-md.md)], “FreeText” can be used in a field or segment.</span></span> <span data-ttu-id="3a465-104">未能分析"FreeText"字段/段中的数据。</span><span class="sxs-lookup"><span data-stu-id="3a465-104">Data in the “FreeText” field/segment is not parsed.</span></span>  
  
## <a name="what-you-need-to-know"></a><span data-ttu-id="3a465-105">您需要了解</span><span class="sxs-lookup"><span data-stu-id="3a465-105">What you need to know</span></span>  
  
|                            |                                                                                                                                                <span data-ttu-id="3a465-106">行为</span><span class="sxs-lookup"><span data-stu-id="3a465-106">Behavior</span></span>                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <span data-ttu-id="3a465-107">示例</span><span class="sxs-lookup"><span data-stu-id="3a465-107">Example</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  <span data-ttu-id="3a465-108">~:重复分隔符</span><span class="sxs-lookup"><span data-stu-id="3a465-108">~: Repetition separator</span></span>   |                                  <span data-ttu-id="3a465-109">在字段中，重复 （~） 被视为重复分隔符。</span><span class="sxs-lookup"><span data-stu-id="3a465-109">In a field, Repetition (~) is treated as a repeating delimiter.</span></span> <span data-ttu-id="3a465-110">非免费段中重复 （~） 被视为重复分隔符。</span><span class="sxs-lookup"><span data-stu-id="3a465-110">In a non-free segment, Repetition (~) is treated as a repeating delimiter.</span></span> <span data-ttu-id="3a465-111">在免费段中，重复 （~） 被视为自定义文本，重复新的一部分。</span><span class="sxs-lookup"><span data-stu-id="3a465-111">In a free segment, Repetition (~) is treated as part of Free Text, not a new repetition.</span></span>                                   | <span data-ttu-id="3a465-112">在以下示例中，如 FRE 是免费的段。</span><span class="sxs-lookup"><span data-stu-id="3a465-112">In the following example, FRE is free Segment.</span></span> <span data-ttu-id="3a465-113">它可以具有任何字符作为自定义文本，包括 ~。</span><span class="sxs-lookup"><span data-stu-id="3a465-113">It can have any character as free text, including ~.</span></span> <span data-ttu-id="3a465-114">任何其他重复 （~） 不被视为重复分隔符，而是被视为自定义文本内容。</span><span class="sxs-lookup"><span data-stu-id="3a465-114">Any additional repetitions (~) are not considered a repetition delimiter and are treated as the Free Text content.</span></span> <span data-ttu-id="3a465-115">验证成功，即使免费段的子非可重复且包含重复 （~）。</span><span class="sxs-lookup"><span data-stu-id="3a465-115">Validation succeeds even if the child of the Free Segment is non-repeatable and contains repetition (~).</span></span> <span data-ttu-id="3a465-116">如 FRE 示例：</span><span class="sxs-lookup"><span data-stu-id="3a465-116">FRE example:</span></span><br /><br /> <span data-ttu-id="3a465-117">**FRE&#124; Foo&^&#124;Foo&^&#124;Foo&^&#124;Foo&^~Foo&^&#124;Foo&^&#124;Foo&^&#124;Foo&^**</span><span class="sxs-lookup"><span data-stu-id="3a465-117">**FRE&#124; Foo&^&#124;Foo&^&#124;Foo&^&#124;Foo&^~Foo&^&#124;Foo&^&#124;Foo&^&#124;Foo&^**</span></span><br /><br /> <span data-ttu-id="3a465-118">在以下示例中，EVN4 定义为自定义文本因为它包含*&^*。</span><span class="sxs-lookup"><span data-stu-id="3a465-118">In the following example, EVN4 is defined as free text because it contains *&^*.</span></span> <span data-ttu-id="3a465-119">当"&#124;"在遇到分隔符，则它将被视为当前自定义文本的末尾。</span><span class="sxs-lookup"><span data-stu-id="3a465-119">When the “&#124;” delimiter is encountered, it is treated as the end of the current Free Text.</span></span> <span data-ttu-id="3a465-120">EVN 示例：</span><span class="sxs-lookup"><span data-stu-id="3a465-120">EVN example:</span></span><br /><br /> <span data-ttu-id="3a465-121">**EVN&#124;&#124;&#124;&#124;Foo&^Foo&^Foo&^Foo&^Foo&^&#124;&#124;**</span><span class="sxs-lookup"><span data-stu-id="3a465-121">**EVN&#124;&#124;&#124;&#124;Foo&^Foo&^Foo&^Foo&^Foo&^&#124;&#124;**</span></span><br /><br /> <span data-ttu-id="3a465-122">以下示例中，EVN5 的第一个子级定义为自定义文本因为它包含*&*。</span><span class="sxs-lookup"><span data-stu-id="3a465-122">In the following example, the first child of EVN5 is defined as free text because it contains *&*.</span></span> <span data-ttu-id="3a465-123">当"^"遇到分隔符，它将被视为当前自定义文本的末尾。</span><span class="sxs-lookup"><span data-stu-id="3a465-123">When the “^” delimiter is encountered, it is treated as the end of the current Free Text.</span></span> <span data-ttu-id="3a465-124">EVN5 示例：</span><span class="sxs-lookup"><span data-stu-id="3a465-124">EVN5 example:</span></span><br /><br /> <span data-ttu-id="3a465-125">**EVN&#124;&#124;&#124;&#124; &#124; Foo&Foo&Foo&Foo&Foo&^5.2&#124;**</span><span class="sxs-lookup"><span data-stu-id="3a465-125">**EVN&#124;&#124;&#124;&#124; &#124; Foo&Foo&Foo&Foo&Foo&^5.2&#124;**</span></span><br /><br /> <span data-ttu-id="3a465-126">在以下示例中，5.2.1 章和 5.2.2 不能将任何分隔符作为自定义文本，即使在架构中定义为 FreeText。</span><span class="sxs-lookup"><span data-stu-id="3a465-126">In the following example, 5.2.1 and 5.2.2 cannot have any delimiters as Free Text, even if it is defined as FreeText in the schema.</span></span> <span data-ttu-id="3a465-127">5.2.1 章和 5.2.2 示例：</span><span class="sxs-lookup"><span data-stu-id="3a465-127">5.2.1 and 5.2.2 example:</span></span><br /><br /> <span data-ttu-id="3a465-128">**EVN&#124;&#124;&#124;&#124; &#124; Foo1^5.2.1&5.2.2&#124;**</span><span class="sxs-lookup"><span data-stu-id="3a465-128">**EVN&#124;&#124;&#124;&#124; &#124; Foo1^5.2.1&5.2.2&#124;**</span></span><br /><br /> <span data-ttu-id="3a465-129">在以下示例中，假定 EVN4 可重复且的自定义文本类型。</span><span class="sxs-lookup"><span data-stu-id="3a465-129">In the following example, assume EVN4 can be repeated and is of the Free Text type.</span></span> <span data-ttu-id="3a465-130">*Foo1 & ^* 被视为第一个重复并*Foo2 & ^* 作为第二个重复处理。</span><span class="sxs-lookup"><span data-stu-id="3a465-130">*Foo1&^* is treated as the first repetition and *Foo2&^* is treated as the second repetition.</span></span> <span data-ttu-id="3a465-131">如果 EVN4 不是可重复 (MaxOccurs = 1)，则验证将失败，如果它包含 ~，即使它是自定义文本类型 （例如，在非免费文本字段的情况下）。</span><span class="sxs-lookup"><span data-stu-id="3a465-131">If EVN4 is not repeatable (MaxOccurs = 1), then the validation fails if it contains ~, even if it is of Free Text type (like in the cases of non-Free Text fields).</span></span> <span data-ttu-id="3a465-132">EVN4 示例：</span><span class="sxs-lookup"><span data-stu-id="3a465-132">EVN4 example:</span></span><br /><br /> <span data-ttu-id="3a465-133"><strong>EVN &#124;&#124;&#124;&#124; Foo1&^~ Foo2&^ &#124;&#124;</strong></span><span class="sxs-lookup"><span data-stu-id="3a465-133"><strong>EVN &#124;&#124;&#124;&#124; Foo1&^~ Foo2&^ &#124;&#124;</strong></span></span> |
|  <span data-ttu-id="3a465-134">&#124;:字段分隔符</span><span class="sxs-lookup"><span data-stu-id="3a465-134">&#124;: Field separator</span></span>   |                                                                                                     <span data-ttu-id="3a465-135">字段分隔符缺少免费段，段标记后，如果验证成功。</span><span class="sxs-lookup"><span data-stu-id="3a465-135">If a field delimiter is missing after the segment tag of a free segment, Validation succeeds.</span></span>                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <span data-ttu-id="3a465-136">在以下示例中，如 FRE 是自定义文本类型。</span><span class="sxs-lookup"><span data-stu-id="3a465-136">In the following examples, FRE is a Free Text type.</span></span> <span data-ttu-id="3a465-137">免费的文本内容可以如 FRE 段标记中，带或不带后立即启动"&#124;"字段分隔符。</span><span class="sxs-lookup"><span data-stu-id="3a465-137">Free Text content can be started immediately after the FRE segment Tag, with or without “&#124;” field delimiter.</span></span> <span data-ttu-id="3a465-138">这两个示例会成功：</span><span class="sxs-lookup"><span data-stu-id="3a465-138">Both examples succeed:</span></span><br /><br /> <span data-ttu-id="3a465-139">**FREabc**</span><span class="sxs-lookup"><span data-stu-id="3a465-139">**FREabc**</span></span> <br /> <span data-ttu-id="3a465-140">**FRE&#124;abc**</span><span class="sxs-lookup"><span data-stu-id="3a465-140">**FRE&#124;abc**</span></span><br /><br /> <span data-ttu-id="3a465-141">在以下示例中，验证将成功：</span><span class="sxs-lookup"><span data-stu-id="3a465-141">In the following examples, validation succeeds:</span></span><br /><br /> <span data-ttu-id="3a465-142">DASM 输入的消息：**FRE&#124;abcd**</span><span class="sxs-lookup"><span data-stu-id="3a465-142">Input message to DASM: **FRE&#124;abcd**</span></span><br /><span data-ttu-id="3a465-143">从 DASM 输出：**\<SegmentData\>&#124;abcd\</SegmentData\>**</span><span class="sxs-lookup"><span data-stu-id="3a465-143">Output from DASM: **\<SegmentData\>&#124;abcd\</SegmentData\>**</span></span><br /><span data-ttu-id="3a465-144">从 ASM 输出：**FRE&#124;abcd**</span><span class="sxs-lookup"><span data-stu-id="3a465-144">Output from ASM: **FRE&#124;abcd**</span></span><br /><br /> <span data-ttu-id="3a465-145">DASM 输入的消息：**FREabcd**</span><span class="sxs-lookup"><span data-stu-id="3a465-145">Input message to DASM: **FREabcd**</span></span><br /><span data-ttu-id="3a465-146">从 DASM 输出：**\<SegmentData\>abcd\</SegmentData\>**</span><span class="sxs-lookup"><span data-stu-id="3a465-146">Output from DASM: **\<SegmentData\>abcd\</SegmentData\>**</span></span><br /><span data-ttu-id="3a465-147">从 ASM 输出：**FREabcd**</span><span class="sxs-lookup"><span data-stu-id="3a465-147">Output from ASM: **FREabcd**</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|   <span data-ttu-id="3a465-148">父-子可选</span><span class="sxs-lookup"><span data-stu-id="3a465-148">Parent-Child optional</span></span>    |                                                                                                                        <span data-ttu-id="3a465-149">父-子可选的验证规则仍然适用。</span><span class="sxs-lookup"><span data-stu-id="3a465-149">The parent-child optional validation rules still apply.</span></span>                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <span data-ttu-id="3a465-150">假设父级是可选的它的一个子级是必需的然后：</span><span class="sxs-lookup"><span data-stu-id="3a465-150">Assume the parent is optional and one of its children is mandatory, then:</span></span><br /><br /> <span data-ttu-id="3a465-151">-如果没有其他子级和必需的子未填充，则消息验证成功。</span><span class="sxs-lookup"><span data-stu-id="3a465-151">-   If none of the other children and the mandatory child are not populated, then message validation succeeds.</span></span><br /><span data-ttu-id="3a465-152">-如果填充至少一个子级，则应还填充的必需子级。</span><span class="sxs-lookup"><span data-stu-id="3a465-152">-   If at least one child is populated, then the mandatory child should also be populated.</span></span> <span data-ttu-id="3a465-153">否则，将消息验证失败。</span><span class="sxs-lookup"><span data-stu-id="3a465-153">Otherwise, message validation fails.</span></span><br /><br /> <span data-ttu-id="3a465-154">在下面的示例中，为可选字段 1。</span><span class="sxs-lookup"><span data-stu-id="3a465-154">In the following example, Field 1 as optional.</span></span> <span data-ttu-id="3a465-155">其*1.a*子是可选的是自定义文本类型。</span><span class="sxs-lookup"><span data-stu-id="3a465-155">Its *1.a* child is optional and is the Free Text type.</span></span> <span data-ttu-id="3a465-156">其*1.b*子是必需的：</span><span class="sxs-lookup"><span data-stu-id="3a465-156">Its *1.b* child is mandatory:</span></span><br /><br /> <span data-ttu-id="3a465-157">**xyz&#124;1.a^1.b&#124;2**</span><span class="sxs-lookup"><span data-stu-id="3a465-157">**xyz&#124;1.a^1.b&#124;2**</span></span><br /><br /> <span data-ttu-id="3a465-158">在下面的示例消息中， *dfssdf*<em>&</em>*sdf*被视为单个元素-1.a。</span><span class="sxs-lookup"><span data-stu-id="3a465-158">In the following sample message, *dfssdf*<em>&</em>*sdf* is considered as one single element - 1.a.</span></span> <span data-ttu-id="3a465-159">分析器检查 1.b 是否存在。</span><span class="sxs-lookup"><span data-stu-id="3a465-159">The parser checks if 1.b exists.</span></span> <span data-ttu-id="3a465-160">当 *&#124;* 是达到，假定未填充 1.b 和消息验证失败：</span><span class="sxs-lookup"><span data-stu-id="3a465-160">When the *&#124;* is reached, it assumes 1.b is not populated and message validation fails:</span></span><br /><br /> <span data-ttu-id="3a465-161">**xyz&#124;dfssdf&sdf&#124;2**</span><span class="sxs-lookup"><span data-stu-id="3a465-161">**xyz&#124;dfssdf&sdf&#124;2**</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="3a465-162">MSH、 FSH 和 BSH 段</span><span class="sxs-lookup"><span data-stu-id="3a465-162">MSH, FSH, and BSH segments</span></span> |                                                                  <span data-ttu-id="3a465-163">对于所有字段，自定义文本将被忽略。</span><span class="sxs-lookup"><span data-stu-id="3a465-163">Free Text is ignored for all fields.</span></span> <span data-ttu-id="3a465-164">这些段对应于标头部分。</span><span class="sxs-lookup"><span data-stu-id="3a465-164">These segments correspond to the header section.</span></span> <span data-ttu-id="3a465-165">和往常一样，即使它们被定义为自定义文本，会发生验证。</span><span class="sxs-lookup"><span data-stu-id="3a465-165">Validation occurs as it normally would, even if they are defined as Free Text.</span></span>                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|    <span data-ttu-id="3a465-166">\\设置用户帐户 ：转义符</span><span class="sxs-lookup"><span data-stu-id="3a465-166">\\: Escape character</span></span>    | <span data-ttu-id="3a465-167">如果有偶数个元素中的"\"，验证将成功 （即使它们是不连续的）。</span><span class="sxs-lookup"><span data-stu-id="3a465-167">If there are even number of “\” in the element, validation succeeds (even if they are not contiguous).</span></span> <span data-ttu-id="3a465-168">如果有奇数数目，验证将失败。</span><span class="sxs-lookup"><span data-stu-id="3a465-168">If there are odd number, validation fails.</span></span> <span data-ttu-id="3a465-169">相同的行为将继续为非免费文本字段。</span><span class="sxs-lookup"><span data-stu-id="3a465-169">The same behavior continues for non- Free Text fields.</span></span> <span data-ttu-id="3a465-170">自定义文本字段后，不会验证数量;它作为自定义文本内容。</span><span class="sxs-lookup"><span data-stu-id="3a465-170">With Free Text fields, there is no validation on the number; it treated as Free Text content.</span></span> |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
  
 <span data-ttu-id="3a465-171">[消息分隔符](../../adapters-and-accelerators/accelerator-hl7/message-delimiters.md)提供有关这些示例中的分隔符的详细信息。</span><span class="sxs-lookup"><span data-stu-id="3a465-171">[Message Delimiters](../../adapters-and-accelerators/accelerator-hl7/message-delimiters.md) provides more information on the separators in these examples.</span></span>  
  
## <a name="using-free-text"></a><span data-ttu-id="3a465-172">使用自定义文本</span><span class="sxs-lookup"><span data-stu-id="3a465-172">Using Free Text</span></span>  
  
1.  <span data-ttu-id="3a465-173">在 Visual Studio 中的项目，打开架构。</span><span class="sxs-lookup"><span data-stu-id="3a465-173">In the project in Visual Studio, open the schema.</span></span>  
  
2.  <span data-ttu-id="3a465-174">右键单击记录，选择**插入 Schema 节点**，选择**子字段元素**。</span><span class="sxs-lookup"><span data-stu-id="3a465-174">Right-click a record, select **Insert Schema Node**, select **Child Field Element**.</span></span>  
  
3.  <span data-ttu-id="3a465-175">在属性中，选择**数据类型**，然后选择**自定义文本 (SimpleType)**。</span><span class="sxs-lookup"><span data-stu-id="3a465-175">In Properties, select **Data Type**, and then select **Free Text (SimpleType)**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a465-176">请参阅</span><span class="sxs-lookup"><span data-stu-id="3a465-176">See Also</span></span>  
 [<span data-ttu-id="3a465-177">处理 HL7 消息</span><span class="sxs-lookup"><span data-stu-id="3a465-177">Processing HL7 Messages</span></span>](../../adapters-and-accelerators/accelerator-hl7/processing-hl7-messages.md)