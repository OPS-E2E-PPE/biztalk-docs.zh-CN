---
title: 在使用 WCF LOB 适配器 SDK 的 IIS 中适配器的宿主 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 90b6cd97-01b3-4c98-a190-c6e0ccf24d2b
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 51d6958bb740b3707748459281769077eb69d008
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65363599"
---
# <a name="host-an-adapter-in-iis-using-the-wcf-lob-adapter-sdk"></a><span data-ttu-id="16913-102">在使用 WCF LOB 适配器 SDK 的 IIS 中适配器的宿主</span><span class="sxs-lookup"><span data-stu-id="16913-102">Host an adapter in IIS using the WCF LOB Adapter SDK</span></span>
<span data-ttu-id="16913-103">本部分介绍如何使用生成的适配器宿主[!INCLUDE[afproductnamelong](../../includes/afproductnamelong-md.md)]在 Internet 信息服务 (IIS)。</span><span class="sxs-lookup"><span data-stu-id="16913-103">This section contains information about hosting an adapter built by using the [!INCLUDE[afproductnamelong](../../includes/afproductnamelong-md.md)] in Internet Information Services (IIS).</span></span> <span data-ttu-id="16913-104">有关其他托管选项的详细信息，请参阅[托管服务](https://msdn.microsoft.com/library/ms730158.aspx)。</span><span class="sxs-lookup"><span data-stu-id="16913-104">For more information about other hosting options, see [Hosting Services](https://msdn.microsoft.com/library/ms730158.aspx).</span></span>

## <a name="use-iis-and-aspnet"></a><span data-ttu-id="16913-105">使用 IIS 和 ASP.NET</span><span class="sxs-lookup"><span data-stu-id="16913-105">Use IIS and ASP.NET</span></span>
 <span data-ttu-id="16913-106">使用 ASP.NET 启用以发布使用 WCF LOB 适配器 SDK 创建的适配器，可以使用 IIS。</span><span class="sxs-lookup"><span data-stu-id="16913-106">You can use IIS with ASP.NET enabled to publish adapters created with the WCF LOB Adapter SDK.</span></span> <span data-ttu-id="16913-107">若要创建的适配器的宿主[!INCLUDE[afproductnameshort](../../includes/afproductnameshort-md.md)]，为发布 WCF 服务配置 Internet 信息服务 (IIS)。</span><span class="sxs-lookup"><span data-stu-id="16913-107">To host an adapter created by the [!INCLUDE[afproductnameshort](../../includes/afproductnameshort-md.md)], you configure Internet Information Services (IIS) for publishing WCF services.</span></span> <span data-ttu-id="16913-108">接下来，请考虑如何使用你的 WCF adapterwith ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="16913-108">Next, consider how to use your WCF adapterwith ASP.NET.</span></span>

 <span data-ttu-id="16913-109">当承载在 IIS 中的 WCF 服务时，有两种可用的宿主模式： **-并行**和一个**SP.NET 兼容性模式**。</span><span class="sxs-lookup"><span data-stu-id="16913-109">When hosting a WCF service in IIS, there are two hosting modes available: **side-by-side** and A**SP.NET compatibility mode**.</span></span> <span data-ttu-id="16913-110">托管模式下的默认值为并行。</span><span class="sxs-lookup"><span data-stu-id="16913-110">The default hosting mode is side-by-side.</span></span> <span data-ttu-id="16913-111">通过并行模式与托管解决方案的其他 WCF 的行为一致。</span><span class="sxs-lookup"><span data-stu-id="16913-111">Side-by-side mode behaves consistently with other WCF hosting solutions.</span></span> <span data-ttu-id="16913-112">因此，在 IIS 中承载的 WCF 服务的行为与一个驻留在一个控制台应用程序中相同。</span><span class="sxs-lookup"><span data-stu-id="16913-112">Therefore, a WCF service hosted in IIS behaves the same as one hosted in a console application.</span></span> <span data-ttu-id="16913-113">但是，这可能不需要由于 web 开发人员所预期的行为类似于 ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="16913-113">However, this may not be desirable because web developers might expect behavior similar to ASP.NET.</span></span> <span data-ttu-id="16913-114">例如，在通过并行模式下，WCF 不符合任何基于 URL 的授权规则中指定`<system.web> <authorization>`web.config 的配置元素。</span><span class="sxs-lookup"><span data-stu-id="16913-114">For instance, in side-by-side mode, WCF does not adhere to any URL-based authorization rules specified in the `<system.web> <authorization>` configuration element of web.config.</span></span>  

 <span data-ttu-id="16913-115">ASP.NET 兼容性模式允许 WCF 服务以使用 ASP.NET 中的所有功能和行为与 ASPX 页; 相同但是，必须采取其他步骤，创建您的 WCF 适配器以启用此功能时。</span><span class="sxs-lookup"><span data-stu-id="16913-115">ASP.NET compatibility mode allows the WCF service to use all the features of ASP.NET, and to behave the same as an ASPX page; however, you must take additional steps when creating your WCF adapter to enable this functionality.</span></span> <span data-ttu-id="16913-116">有关详细信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="16913-116">For more information, see:</span></span> 

 [<span data-ttu-id="16913-117">WCF 服务和 ASP.NET</span><span class="sxs-lookup"><span data-stu-id="16913-117">WCF Services and ASP.NET</span></span>](https://msdn.microsoft.com/library/aa702682.aspx)

[<span data-ttu-id="16913-118">在 Internet 信息服务中承载</span><span class="sxs-lookup"><span data-stu-id="16913-118">Hosting in Internet Information Services</span></span>](https://msdn.microsoft.com/library/ms734710.aspx)

[<span data-ttu-id="16913-119">托管服务的 WCF</span><span class="sxs-lookup"><span data-stu-id="16913-119">WCF Hosting Services</span></span>](https://msdn.microsoft.com/library/ms730158.aspx)

## <a name="use-the-wcf-adapter-service-development-wizard"></a><span data-ttu-id="16913-120">使用 WCF 适配器服务开发向导</span><span class="sxs-lookup"><span data-stu-id="16913-120">Use the WCF Adapter Service Development Wizard</span></span>

<span data-ttu-id="16913-121">使用[!INCLUDE[afsvcdevwizlong](../../includes/afsvcdevwizlong-md.md)]若要自动创建用于承载您的适配器在 Internet 信息服务 (IIS) 的 Web 项目。</span><span class="sxs-lookup"><span data-stu-id="16913-121">Use the [!INCLUDE[afsvcdevwizlong](../../includes/afsvcdevwizlong-md.md)] to automate creation of a Web project for hosting your adapter within Internet Information Services (IIS).</span></span> <span data-ttu-id="16913-122">然后可以通过使用 Windows Communication Framework (WCF) 或 Web 服务的客户端使用托管的适配器。</span><span class="sxs-lookup"><span data-stu-id="16913-122">The hosted adapter can then be consumed by clients using Windows Communication Framework (WCF) or Web services.</span></span>  

### <a name="publish-an-adapter-as-a-wcf-service-hosted-in-iis"></a><span data-ttu-id="16913-123">将适配器作为 IIS 中承载的 WCF 服务发布</span><span class="sxs-lookup"><span data-stu-id="16913-123">Publish an adapter as a WCF service hosted in IIS</span></span>  

1. <span data-ttu-id="16913-124">打开 [!INCLUDE[btsVStudioNoVersion_md](../../includes/btsvstudionoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="16913-124">Open [!INCLUDE[btsVStudioNoVersion_md](../../includes/btsvstudionoversion-md.md)].</span></span> <span data-ttu-id="16913-125">上**文件**菜单中，选择**新建**，然后选择**网站**。</span><span class="sxs-lookup"><span data-stu-id="16913-125">On the **File** menu, select **New**, and then select **Web Site**.</span></span>  

2. <span data-ttu-id="16913-126">在中**模板**，选择**Visual C#**，然后选择**WCF 适配器服务**。</span><span class="sxs-lookup"><span data-stu-id="16913-126">In **Templates**, select **Visual C#**, and select **WCF Adapter Service**.</span></span>  

3. <span data-ttu-id="16913-127">请输入文件夹以保存该解决方案，然后选择**确定**。</span><span class="sxs-lookup"><span data-stu-id="16913-127">Enter the folder to save the solution, and then select **OK**.</span></span> <span data-ttu-id="16913-128">**WCF 适配器服务开发向导**启动。</span><span class="sxs-lookup"><span data-stu-id="16913-128">The **WCF Adapter Service Development Wizard** starts.</span></span>  

4. <span data-ttu-id="16913-129">上**简介**页上，单击**下一步**。</span><span class="sxs-lookup"><span data-stu-id="16913-129">On the **Introduction** page, click **Next**.</span></span>  

5. <span data-ttu-id="16913-130">上**选择操作**页上，指定要用于此托管服务的绑定、 协定和操作。</span><span class="sxs-lookup"><span data-stu-id="16913-130">On the **Choose Operations** page, specify the binding, contract, and operations to use for this hosted service.</span></span>  

   1.  <span data-ttu-id="16913-131">在中**选择绑定**列表中，选择适配器绑定以使用，然后单击**配置**。</span><span class="sxs-lookup"><span data-stu-id="16913-131">In the **Select a binding** list, select the adapter binding to use, and then click **Configure**.</span></span> <span data-ttu-id="16913-132">这将显示**配置适配器**对话框。</span><span class="sxs-lookup"><span data-stu-id="16913-132">This displays the **Configure Adapter** dialog box.</span></span> <span data-ttu-id="16913-133">提供调用适配器以及检索操作的元数据所必需的值。</span><span class="sxs-lookup"><span data-stu-id="16913-133">Provide the values necessary to invoke the adapter and to retrieve operation metadata.</span></span>  

   2.  <span data-ttu-id="16913-134">上**安全**选项卡上，选择**客户端凭据类型**时将客户端凭据传递到适配器使用。</span><span class="sxs-lookup"><span data-stu-id="16913-134">On the **Security** tab, select the **Client credential type** to use when passing client credentials to the adapter.</span></span>  

       |<span data-ttu-id="16913-135">凭据类型</span><span class="sxs-lookup"><span data-stu-id="16913-135">Credential Type</span></span>|<span data-ttu-id="16913-136">Description</span><span class="sxs-lookup"><span data-stu-id="16913-136">Description</span></span>|  
       |---------------------|-----------------|  
       |<span data-ttu-id="16913-137">**无**</span><span class="sxs-lookup"><span data-stu-id="16913-137">**None**</span></span>|<span data-ttu-id="16913-138">客户端不需要提供凭据。</span><span class="sxs-lookup"><span data-stu-id="16913-138">The client does not need to present credentials.</span></span>|  
       |<span data-ttu-id="16913-139">**Windows**</span><span class="sxs-lookup"><span data-stu-id="16913-139">**Windows**</span></span>|<span data-ttu-id="16913-140">客户端将使用 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="16913-140">The client will use Windows credentials.</span></span>|  
       |<span data-ttu-id="16913-141">**用户名**</span><span class="sxs-lookup"><span data-stu-id="16913-141">**Username**</span></span>|<span data-ttu-id="16913-142">客户端将提供的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="16913-142">The client will supply a user name and password.</span></span>|  
       |<span data-ttu-id="16913-143">**证书**</span><span class="sxs-lookup"><span data-stu-id="16913-143">**Certificate**</span></span>|<span data-ttu-id="16913-144">客户端将使用 X.509 证书进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="16913-144">The client will be authenticated by using an X.509 certificate.</span></span> <span data-ttu-id="16913-145">如果设置此值，请单击**浏览**中**客户端证书**区域中，并选择要使用的证书。</span><span class="sxs-lookup"><span data-stu-id="16913-145">If this value is set, click **Browse** in the **Client Certificate** area, and then select the certificate to use.</span></span>|  

   3.  <span data-ttu-id="16913-146">上**URI 属性**选项卡上，指定适配器所需的 URI 参数。</span><span class="sxs-lookup"><span data-stu-id="16913-146">On the **URI Properties** tab, specify the URI parameters required by the adapter.</span></span> <span data-ttu-id="16913-147">此选项卡中显示的条目中公开的属性因`ConnectionUri Properties`的适配器类。</span><span class="sxs-lookup"><span data-stu-id="16913-147">The entries displayed in this tab vary based on the properties exposed in the  `ConnectionUri Properties` class of the adapter.</span></span>  

   4.  <span data-ttu-id="16913-148">上**绑定属性**选项卡上，指定所需的适配器的绑定属性的值。</span><span class="sxs-lookup"><span data-stu-id="16913-148">On the **Binding Properties** tab, specify values for the binding properties required for the adapter.</span></span> <span data-ttu-id="16913-149">**常规**部分包含常用的设置，如超时值。</span><span class="sxs-lookup"><span data-stu-id="16913-149">The **General** section contains common settings such as timeout values.</span></span> <span data-ttu-id="16913-150">其他属性列出了根据自定义属性中公开你`AdapterBinding`类。</span><span class="sxs-lookup"><span data-stu-id="16913-150">Additional properties are listed based on the custom properties exposed in your `AdapterBinding` class.</span></span>  

6. <span data-ttu-id="16913-151">后指定配置值后，单击**Connect**。</span><span class="sxs-lookup"><span data-stu-id="16913-151">Once you have specified the configuration values, click **Connect**.</span></span>  

   1.  <span data-ttu-id="16913-152">从**选择协定类型**列表中，选择要使用的协定。</span><span class="sxs-lookup"><span data-stu-id="16913-152">From the **Select contract type** list, select the contract to use.</span></span> <span data-ttu-id="16913-153">这将填充**选择一个类别**树具有类别和通过此适配器执行的操作的列表控件。</span><span class="sxs-lookup"><span data-stu-id="16913-153">This populates the **Select a category** tree control with a list of categories and operations available from this adapter.</span></span> <span data-ttu-id="16913-154">如果适配器实现搜索功能通过`MetadataRetrievalClient`类，您可以输入搜索词**类别中的搜索**字段返回仅类别和包含搜索词的操作。</span><span class="sxs-lookup"><span data-stu-id="16913-154">If the adapter implements search functionality through a `MetadataRetrievalClient` class, you can enter a search term in the **Search in category** field to return only categories and operations that contain the search term.</span></span>  

       > [!NOTE]
       >  <span data-ttu-id="16913-155">仅出站操作是可供选择。</span><span class="sxs-lookup"><span data-stu-id="16913-155">Only outbound operations are available for selection.</span></span>  

   2.  <span data-ttu-id="16913-156">从**可用类别和操作**框中，选择要添加，并单击的项**添加**。</span><span class="sxs-lookup"><span data-stu-id="16913-156">From the **Available categories and operations** box, select the items to add, and then click **Add**.</span></span> <span data-ttu-id="16913-157">添加所需的项目后，单击**下一步**。</span><span class="sxs-lookup"><span data-stu-id="16913-157">Once you have added the desired items, click **Next**.</span></span>  

7. <span data-ttu-id="16913-158">上**配置服务和终结点行为**页上，为此适配器设置所需的行为。</span><span class="sxs-lookup"><span data-stu-id="16913-158">On the **Configure Service and Endpoint Behaviors** page, set the desired behaviors for this adapter.</span></span>  

   1.  <span data-ttu-id="16913-159">**服务行为配置**部分包含控制服务行为的条目。</span><span class="sxs-lookup"><span data-stu-id="16913-159">The **Service Behavior Configuration** section contains entries that control the service behavior.</span></span> <span data-ttu-id="16913-160">运行向导之后，可以通过编辑 web.config 文件来修改所选的服务行为。</span><span class="sxs-lookup"><span data-stu-id="16913-160">After running the wizard, you can modify the selected service behaviors by editing the web.config file.</span></span>  

       |<span data-ttu-id="16913-161">属性</span><span class="sxs-lookup"><span data-stu-id="16913-161">Property</span></span>|<span data-ttu-id="16913-162">Description</span><span class="sxs-lookup"><span data-stu-id="16913-162">Description</span></span>|  
       |--------------|-----------------|  
       |<span data-ttu-id="16913-163">**EnableMetadataExchange**</span><span class="sxs-lookup"><span data-stu-id="16913-163">**EnableMetadataExchange**</span></span>|<span data-ttu-id="16913-164">此值设置为 **，则返回 True** ，服务元数据发布到客户端请求。</span><span class="sxs-lookup"><span data-stu-id="16913-164">Setting this value to **True** enables service metadata publishing to client requests.</span></span> <span data-ttu-id="16913-165">此外可以通过修改设置这\< **serviceMetadata httpGetEnabled =""** \>在 web.config 中。默认值是**False**</span><span class="sxs-lookup"><span data-stu-id="16913-165">This can also be set by modifying \<**serviceMetadata httpGetEnabled=””**\> in web.config. Default is **False**</span></span>|  
       |<span data-ttu-id="16913-166">**IncludeExceptionDetailsinFault**</span><span class="sxs-lookup"><span data-stu-id="16913-166">**IncludeExceptionDetailsinFault**</span></span>|<span data-ttu-id="16913-167">此值设置为 **，则返回 True**结果中将托管的异常信息返回到 SOAP 错误中的客户端。</span><span class="sxs-lookup"><span data-stu-id="16913-167">Setting this value to **True** results in managed exception information returned to the client in SOAP faults.</span></span> <span data-ttu-id="16913-168">此外可以通过修改设置这\< **serviceDebug usingincludeExceptionDetailInFaults =""** \>在 web.config 中。默认值是**False**。</span><span class="sxs-lookup"><span data-stu-id="16913-168">This can also be set by modifying \<**serviceDebug usingincludeExceptionDetailInFaults=””**\> in web.config. Default is **False**.</span></span>|  
       |<span data-ttu-id="16913-169">**名称**</span><span class="sxs-lookup"><span data-stu-id="16913-169">**Name**</span></span>|<span data-ttu-id="16913-170">服务行为配置名称。</span><span class="sxs-lookup"><span data-stu-id="16913-170">Name for the service behavior configuration.</span></span>|  
       |<span data-ttu-id="16913-171">**UseServiceCertificate**</span><span class="sxs-lookup"><span data-stu-id="16913-171">**UseServiceCertificate**</span></span>|<span data-ttu-id="16913-172">此值确定服务是否将使用 X.509 证书向客户端进程验证自身身份。</span><span class="sxs-lookup"><span data-stu-id="16913-172">This value determines whether the service will use an X.509 certificate to authenticate itself to the client process.</span></span> <span data-ttu-id="16913-173">默认值是 **，则返回 True**。</span><span class="sxs-lookup"><span data-stu-id="16913-173">Default is **True**.</span></span>|  
       |<span data-ttu-id="16913-174">**FindValue**</span><span class="sxs-lookup"><span data-stu-id="16913-174">**FindValue**</span></span>|<span data-ttu-id="16913-175">此值用于搜索特定的 X.509 证书的证书存储中。</span><span class="sxs-lookup"><span data-stu-id="16913-175">This value is used to search for a specific X.509 certificate in the certificate store.</span></span> <span data-ttu-id="16913-176">此外可以通过修改设置这\< **serviceCredentials findValue =""** \> web.config 中**注意：** 请为此属性仅当**UseServiceCertificate**设置为**True**。</span><span class="sxs-lookup"><span data-stu-id="16913-176">This can also be set by modifying \<**serviceCredentials findValue=””**\> in web.config **Note:**  Specify a value for this property only if **UseServiceCertificate** is set to **True**.</span></span>|  
       |<span data-ttu-id="16913-177">**StoreLocation**</span><span class="sxs-lookup"><span data-stu-id="16913-177">**StoreLocation**</span></span>|<span data-ttu-id="16913-178">此值指定系统存储位置，搜索指定的证书。</span><span class="sxs-lookup"><span data-stu-id="16913-178">This value specifies system store location to search for the specified certificate.</span></span> <span data-ttu-id="16913-179">此外可以通过修改设置这\< **serviceCredentials storeLocation =""** \>在 web.config 中。**注意：** 请为此属性仅当**UseServiceCertificate**设置为**True**。</span><span class="sxs-lookup"><span data-stu-id="16913-179">This can also be set by modifying \<**serviceCredentials storeLocation=””**\> in web.config. **Note:**  Specify a value for this property only if **UseServiceCertificate** is set to **True**.</span></span>|  
       |<span data-ttu-id="16913-180">**StoreName**</span><span class="sxs-lookup"><span data-stu-id="16913-180">**StoreName**</span></span>|<span data-ttu-id="16913-181">此值指定要搜索指定的证书的特定系统存储区。</span><span class="sxs-lookup"><span data-stu-id="16913-181">This value specifies the specific system store to search for the specified certificate.</span></span> <span data-ttu-id="16913-182">此外可以通过修改设置这\< **serviceCredentials storeName =""** \> web.config 中**注意：** 请为此属性仅当**UseServiceCertificate**设置为**True**。</span><span class="sxs-lookup"><span data-stu-id="16913-182">This can also be set by modifying \<**serviceCredentials storeName=””**\> in web.config **Note:**  Specify a value for this property only if **UseServiceCertificate** is set to **True**.</span></span>|  
       |<span data-ttu-id="16913-183">**X509FindType**</span><span class="sxs-lookup"><span data-stu-id="16913-183">**X509FindType**</span></span>|<span data-ttu-id="16913-184">若要查找要使用的特定证书前面指定的搜索将与 FindValue 的类型。</span><span class="sxs-lookup"><span data-stu-id="16913-184">The type of search to use with the FindValue specified earlier in order to find the specific certificate to use.</span></span> <span data-ttu-id="16913-185">此外可以通过修改设置这\< **serviceCredentials x509FindType =""** \> web.config 中**注意：** 请为此属性仅当**UseServiceCertificate**设置为**True**。</span><span class="sxs-lookup"><span data-stu-id="16913-185">This can also be set by modifying \<**serviceCredentials x509FindType=””**\> in web.config **Note:**  Specify a value for this property only if **UseServiceCertificate** is set to **True**.</span></span>|  

   2.  <span data-ttu-id="16913-186">**终结点行为配置**部分控制终结点行为。</span><span class="sxs-lookup"><span data-stu-id="16913-186">The **Endpoint Behavior Configuration** section controls the endpoint behavior.</span></span>  

       |<span data-ttu-id="16913-187">属性</span><span class="sxs-lookup"><span data-stu-id="16913-187">Property</span></span>|<span data-ttu-id="16913-188">Description</span><span class="sxs-lookup"><span data-stu-id="16913-188">Description</span></span>|  
       |--------------|-----------------|  
       |<span data-ttu-id="16913-189">**名称**</span><span class="sxs-lookup"><span data-stu-id="16913-189">**Name**</span></span>|<span data-ttu-id="16913-190">终结点行为的名称</span><span class="sxs-lookup"><span data-stu-id="16913-190">The name of the endpoint behavior</span></span>|  
       |<span data-ttu-id="16913-191">**AuthenticationType**</span><span class="sxs-lookup"><span data-stu-id="16913-191">**AuthenticationType**</span></span>|<span data-ttu-id="16913-192">此值指示适配器获取客户端凭据的传入文档的位置。</span><span class="sxs-lookup"><span data-stu-id="16913-192">This value instructs the adapter where to obtain the client credentials of the incoming document.</span></span> <span data-ttu-id="16913-193">若要启用客户端指定客户端证书向服务进行身份验证，请将此设置为**ClientCredentialUsernamePassword**。</span><span class="sxs-lookup"><span data-stu-id="16913-193">To enable clients to specify a client certificate to authenticate to the service, set this to **ClientCredentialUsernamePassword**.</span></span> <span data-ttu-id="16913-194">若要启用客户端的 HTTP 标头的一部分指定的用户名和密码，请将此设置为**HTTPUsernamePassword**。</span><span class="sxs-lookup"><span data-stu-id="16913-194">To enable clients to specify the user name and password as part of the HTTP header, set this to **HTTPUsernamePassword**.</span></span> <span data-ttu-id="16913-195">若要启用客户端指定客户端凭据接口通过凭据，请将此设置为**自动**。如果此操作失败，客户端可以将作为 HTTP 标头的一部分传递的凭据。</span><span class="sxs-lookup"><span data-stu-id="16913-195">To enable clients to specify credentials through the ClientCredential interface, set this to **Auto**. If this fails, clients can pass credentials as part of the HTTP header.</span></span><br /><br /> <span data-ttu-id="16913-196">此值还可以设置通过修改\< **endpointBehavior adapterSecurityBridgeType** \>在 web.config 中。默认值是**自动**。</span><span class="sxs-lookup"><span data-stu-id="16913-196">This value can also be set by modifying \<**endpointBehavior adapterSecurityBridgeType**\> in web.config. Default is **Auto**.</span></span>|  
       |<span data-ttu-id="16913-197">**UsernameHeader**</span><span class="sxs-lookup"><span data-stu-id="16913-197">**UsernameHeader**</span></span>|<span data-ttu-id="16913-198">指定将用于将用户名称传递给该服务的标头的名称。</span><span class="sxs-lookup"><span data-stu-id="16913-198">This specifies the name of the header that will be used to pass the user name to the service.</span></span> <span data-ttu-id="16913-199">有关 HTTP 标头的详细信息，请参阅"支持的自定义 HTTP 和 SOAP 标头"网址 [http://go.microsoft.com/fwlink/?LinkId=106692](http://go.microsoft.com/fwlink/?LinkId=106692)</span><span class="sxs-lookup"><span data-stu-id="16913-199">For more information about HTTP headers, see “Support for Custom HTTP and SOAP headers” at [http://go.microsoft.com/fwlink/?LinkId=106692](http://go.microsoft.com/fwlink/?LinkId=106692)</span></span><br /><br /> <span data-ttu-id="16913-200">此值还可以设置通过修改\< **endpointBehavior usernameHttpHeader** \>在 web.config 中。**注意：** 如果满足以下条件，则必须指定此属性的值**AuthenticationType**设置为**HTTPUserNamePassword**。</span><span class="sxs-lookup"><span data-stu-id="16913-200">This value can also be set by modifying \<**endpointBehavior usernameHttpHeader**\> in web.config. **Note:**  You must specify a value for this property if the **AuthenticationType** is set to **HTTPUserNamePassword**.</span></span>  <span data-ttu-id="16913-201">如果设置为**自动**，此为可选属性。</span><span class="sxs-lookup"><span data-stu-id="16913-201">If set to **Auto**, this property is optional.</span></span>|  
       |<span data-ttu-id="16913-202">**PasswordHeader**</span><span class="sxs-lookup"><span data-stu-id="16913-202">**PasswordHeader**</span></span>|<span data-ttu-id="16913-203">指定将用于将用户密码传递给该服务的标头的名称。</span><span class="sxs-lookup"><span data-stu-id="16913-203">This specifies the name of the header that will be used to pass the user password to the service.</span></span> <span data-ttu-id="16913-204">有关 HTTP 标头的详细信息，请参阅"支持的自定义 HTTP 和 SOAP 标头"网址 [http://go.microsoft.com/fwlink/?LinkId=106692](http://go.microsoft.com/fwlink/?LinkId=106692)</span><span class="sxs-lookup"><span data-stu-id="16913-204">For more information about HTTP headers, see “Support for Custom HTTP and SOAP Headers” at [http://go.microsoft.com/fwlink/?LinkId=106692](http://go.microsoft.com/fwlink/?LinkId=106692)</span></span><br /><br /> <span data-ttu-id="16913-205">此外可以通过修改设置此值 <**endpointBehavior passwordHttpHeader**< web.config 中。**注意：** 如果满足以下条件，则必须指定此属性的值**AuthenticationType**设置为**HTTPUserNamePassword**。</span><span class="sxs-lookup"><span data-stu-id="16913-205">This value can also be set by modifying <**endpointBehavior passwordHttpHeader**< in web.config. **Note:**  You must specify a value for this property if the **AuthenticationType** is set to **HTTPUserNamePassword**.</span></span> <span data-ttu-id="16913-206">如果设置为**自动**，此为可选属性。</span><span class="sxs-lookup"><span data-stu-id="16913-206">If set to **Auto**, this property is optional.</span></span>|  

   3.  <span data-ttu-id="16913-207">设置后所需的行为，请单击**下一步**以继续。</span><span class="sxs-lookup"><span data-stu-id="16913-207">After setting the desired behavior, click **Next** to continue.</span></span>  

8. <span data-ttu-id="16913-208">上**配置服务终结点绑定和地址**页上，可以配置为协定的地址和绑定属性。</span><span class="sxs-lookup"><span data-stu-id="16913-208">On the **Configure Service Endpoint Binding and Address** page, you can configure the address and binding properties for the contracts.</span></span> <span data-ttu-id="16913-209">选择中的协定**选择用于配置的协定**列表，，然后输入所需的值以**配置地址和协定绑定**对话框。</span><span class="sxs-lookup"><span data-stu-id="16913-209">Select the contract in the **Select a contract to configure** list, and then enter the desired values in the **Configure the address and binding for the contract** dialog box.</span></span>  

   1.  <span data-ttu-id="16913-210">选择**BindingConfiguration**绑定属性下的条目。</span><span class="sxs-lookup"><span data-stu-id="16913-210">Select the **BindingConfiguration** entry under Binding Properties.</span></span> <span data-ttu-id="16913-211">该向导仅支持基本 HTTP 绑定，因此绑定配置字段将自动设置为**System.ServiceModel.Configuration.BasicHttpBindingElement**。</span><span class="sxs-lookup"><span data-stu-id="16913-211">The wizard only supports basic HTTP binding so the binding configuration field is automatically set to **System.ServiceModel.Configuration.BasicHttpBindingElement**.</span></span> <span data-ttu-id="16913-212">若要更改此绑定的配置属性，单击省略号 **...**</span><span class="sxs-lookup"><span data-stu-id="16913-212">To change the configuration properties for this binding, click the ellipsis **…**</span></span> <span data-ttu-id="16913-213">按钮。</span><span class="sxs-lookup"><span data-stu-id="16913-213">button.</span></span> <span data-ttu-id="16913-214">若要使用的安全通信通道，必须始终设置**模式下**属性设置为**传输**。</span><span class="sxs-lookup"><span data-stu-id="16913-214">To use a secure communication channel, you must always set the **Mode** property to **Transport**.</span></span> <span data-ttu-id="16913-215">这是默认值。</span><span class="sxs-lookup"><span data-stu-id="16913-215">This is the default value.</span></span>  

   2.  <span data-ttu-id="16913-216">选择**EndpointName**，然后输入所需的终结点的名称。</span><span class="sxs-lookup"><span data-stu-id="16913-216">Select the **EndpointName**, and then enter the desired name of the endpoint.</span></span>  

   3.  <span data-ttu-id="16913-217">若要将应用所做的更改，请单击**应用**。</span><span class="sxs-lookup"><span data-stu-id="16913-217">To apply your changes, click **Apply**.</span></span>  

9. <span data-ttu-id="16913-218">若要继续，请单击 **“下一步”**。</span><span class="sxs-lookup"><span data-stu-id="16913-218">To continue, click **Next**.</span></span> <span data-ttu-id="16913-219">摘要页列出了所选择的适配器操作的树状结构。</span><span class="sxs-lookup"><span data-stu-id="16913-219">The Summary page lists a tree structure of the adapter operations that were selected.</span></span>  

10. <span data-ttu-id="16913-220">查看摘要，然后依次**完成**。</span><span class="sxs-lookup"><span data-stu-id="16913-220">Review the summary, and then click **Finish**.</span></span>  

11. <span data-ttu-id="16913-221">该向导创建 Web 项目并添加以下文件。</span><span class="sxs-lookup"><span data-stu-id="16913-221">The wizard creates a Web project and adds the following files.</span></span>  


    |    <span data-ttu-id="16913-222">文件</span><span class="sxs-lookup"><span data-stu-id="16913-222">File</span></span>    |                                                <span data-ttu-id="16913-223">Description</span><span class="sxs-lookup"><span data-stu-id="16913-223">Description</span></span>                                                 |
    |------------|------------------------------------------------------------------------------------------------------------|
    |    <span data-ttu-id="16913-224">.svc</span><span class="sxs-lookup"><span data-stu-id="16913-224">.svc</span></span>    |                               <span data-ttu-id="16913-225">为 WCF 代理引用的服务文件。</span><span class="sxs-lookup"><span data-stu-id="16913-225">Service file that references to the WCF proxy.</span></span>                               |
    |    <span data-ttu-id="16913-226">.cs</span><span class="sxs-lookup"><span data-stu-id="16913-226">.cs</span></span>     |                                         <span data-ttu-id="16913-227">实现 WCF 代理。</span><span class="sxs-lookup"><span data-stu-id="16913-227">Implements the WCF proxy.</span></span>                                          |
    | <span data-ttu-id="16913-228">web.config</span><span class="sxs-lookup"><span data-stu-id="16913-228">web.config</span></span> | <span data-ttu-id="16913-229">包含\<**终结点**\, \<**绑定**\>，并\<**行为**\>元素\<**系统。ServiceModel**\></span><span class="sxs-lookup"><span data-stu-id="16913-229">Contains \<**endpoint**\, \<**bindings**\>, and \<**behaviors**\> elements for \<**system.ServiceModel**\></span></span> |


12. <span data-ttu-id="16913-230">发布 WCF 服务项目。</span><span class="sxs-lookup"><span data-stu-id="16913-230">Publish the WCF service project.</span></span>  

    1.  <span data-ttu-id="16913-231">右键单击解决方案资源管理器中的项目，然后单击**发布**。</span><span class="sxs-lookup"><span data-stu-id="16913-231">Right-click the project in Solution Explorer, and then click **Publish**.</span></span>  

    2.  <span data-ttu-id="16913-232">在中**发布网站**对话框中指定的 WCF 服务的目标 URL。</span><span class="sxs-lookup"><span data-stu-id="16913-232">In the **Publish Web Site** dialog box, specify the target URL for the WCF service.</span></span>  

    3.  <span data-ttu-id="16913-233">选择**允许更新此预编译的站点**。</span><span class="sxs-lookup"><span data-stu-id="16913-233">Select **Allow this precompiled site to be updated**.</span></span>  

    4.  <span data-ttu-id="16913-234">选择**使用固定命名和单页程序集**。</span><span class="sxs-lookup"><span data-stu-id="16913-234">Select **Use fixed naming and single page assemblies**.</span></span>  

    5.  <span data-ttu-id="16913-235">选择**启用强命名在预编译程序集**，然后指定要使用的签名密钥。</span><span class="sxs-lookup"><span data-stu-id="16913-235">Select **Enable strong naming on precompiled assemblies**, and then specify the signing key to use.</span></span>  

13. <span data-ttu-id="16913-236">若要发布 Web 站点，请单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="16913-236">To publish the Web site, click **OK**.</span></span>  

14. <span data-ttu-id="16913-237">验证已成功发布服务。</span><span class="sxs-lookup"><span data-stu-id="16913-237">Verify that the service is published successfully.</span></span>  

    1.  <span data-ttu-id="16913-238">启动 IIS 管理控制台。</span><span class="sxs-lookup"><span data-stu-id="16913-238">Start the IIS Management Console.</span></span>  <span data-ttu-id="16913-239">单击**启动**，依次指向**管理工具**，然后单击**Internet Information Services**。</span><span class="sxs-lookup"><span data-stu-id="16913-239">Click **Start**, point to **Administrative Tools**, and then click **Internet Information Services**.</span></span>  

    2.  <span data-ttu-id="16913-240">导航到发布服务的节点。</span><span class="sxs-lookup"><span data-stu-id="16913-240">Navigate to the node where you published the service.</span></span>  <span data-ttu-id="16913-241">如果该服务已作为 http://localhost/myservice ，导航到**Internet Information Services**> **计算机名称**> **网站**>  **Default Web Site**> **myservice**。</span><span class="sxs-lookup"><span data-stu-id="16913-241">If the service was published as http://localhost/myservice, navigate to **Internet Information Services**> **Computer Name**> **Web Sites**> **Default Web Site**> **myservice**.</span></span>  

    3.  <span data-ttu-id="16913-242">在右窗格中，右键单击的.svc 文件，并单击**浏览**。</span><span class="sxs-lookup"><span data-stu-id="16913-242">On the right pane, right-click the .svc file, and then click **Browse**.</span></span> <span data-ttu-id="16913-243">Web 页会显示有关该服务的信息。</span><span class="sxs-lookup"><span data-stu-id="16913-243">The Web page shows up with information about the service.</span></span> <span data-ttu-id="16913-244">你现在可以通过使用 WCF 或 Web 服务调用客户端应用程序使用此服务。</span><span class="sxs-lookup"><span data-stu-id="16913-244">You can now consume this service by using WCF or Web service calls from client applications.</span></span> 

## <a name="security"></a><span data-ttu-id="16913-245">安全性</span><span class="sxs-lookup"><span data-stu-id="16913-245">Security</span></span>
<span data-ttu-id="16913-246">当适配器的宿主服务中时，来自客户端应用程序调用使用适配器安全桥将客户端凭据传递给适配器。</span><span class="sxs-lookup"><span data-stu-id="16913-246">When the adapter is hosted within a service, calls from client applications use the Adapter Security Bridge to pass client credentials to the adapter.</span></span>  

 <span data-ttu-id="16913-247">当 WCF 客户端发送到 WCF 服务的身份验证时，通常服务使用的身份验证。</span><span class="sxs-lookup"><span data-stu-id="16913-247">When a WCF client sends authentication to a WCF service, normally the service consumes the authentication.</span></span> <span data-ttu-id="16913-248">但是，对于适配器，旨在捕获与基础 LOB 系统配合使用的身份验证信息。</span><span class="sxs-lookup"><span data-stu-id="16913-248">However, in the case of an adapter, the idea is to capture the authentication information for use with the underlying LOB system.</span></span> <span data-ttu-id="16913-249">这是通过适配器安全桥接，呈现为终结点行为的实现。</span><span class="sxs-lookup"><span data-stu-id="16913-249">This is implemented through the Adapter Security Bridge, which is surfaced as an endpoint behavior.</span></span> <span data-ttu-id="16913-250">作为适配器开发人员，则不执行任何需要实现才能利用此功能;但是，在部署适配器时，必须考虑如何在客户端将提供对服务的凭据。</span><span class="sxs-lookup"><span data-stu-id="16913-250">As an adapter developer, there is nothing that needs to be implemented to take advantage of this functionality; however, when deploying the adapter, you must consider how the client will be providing credentials to the service.</span></span>  

 <span data-ttu-id="16913-251">如果使用消息级安全性，适配器安全桥可以检索 ClientCredentials 发送的任何绑定上的客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="16913-251">If you are using message-level security, the Adapter Security Bridge can retrieve the ClientCredentials sent by the client application on any binding.</span></span> <span data-ttu-id="16913-252">如果使用基本 HTTP 绑定，则可以改为选择使用自定义标头来传递用户名和密码信息。</span><span class="sxs-lookup"><span data-stu-id="16913-252">If you are using basic HTTP binding, you can instead select to use a custom header to pass the user name and password information.</span></span> <span data-ttu-id="16913-253">建议使用 WCF 提供的客户端凭据类来传递凭据，但是，许多 Web 服务客户端应用程序将需要使用自定义标头来传递凭据。</span><span class="sxs-lookup"><span data-stu-id="16913-253">It is recommended to use the ClientCredential class provided by WCF to pass credentials, however many Web Service client applications will need to use a custom header to pass credentials.</span></span>  

 <span data-ttu-id="16913-254">下面是一个示例配置适配器凭据在客户端应用程序提供了 Clientcredential 中查找的位置。</span><span class="sxs-lookup"><span data-stu-id="16913-254">The following is an example configuration where the adapter looks for credentials in the ClientCredentials that the client application provides.</span></span> <span data-ttu-id="16913-255">如果找不到，适配器，然后在指定的 HTTP 请求标头中查找。</span><span class="sxs-lookup"><span data-stu-id="16913-255">If none is found, the adapter then looks in the HTTP request headers that are specified.</span></span>  

```  
<endpointBehaviors>  
   <behavior name="customEndpointBehavior">  
      <endpointBehavior usernameHttpHeader="UNHdr" passwordHttpHeader="PWHdr"  
         adapterSecurityBridgeType="Auto" />  
    </behavior>  
</endpointBehaviors>  
```      

## <a name="see-also"></a><span data-ttu-id="16913-256">请参阅</span><span class="sxs-lookup"><span data-stu-id="16913-256">See Also</span></span>  
 [<span data-ttu-id="16913-257">开发活动</span><span class="sxs-lookup"><span data-stu-id="16913-257">Development Activities</span></span>](../../esb-toolkit/development-activities.md)