---
title: SAP 适配器中的 SAPConnection 类 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cb5a1778fac8577efb3c3c21a10b16f47a026397
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2017
ms.locfileid: "25964291"
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="91242-102">SAP 适配器中 SAPConnection 类</span><span class="sxs-lookup"><span data-stu-id="91242-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="91242-103">以下部分列出的方法和属性**SAPConnection**类。</span><span class="sxs-lookup"><span data-stu-id="91242-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="91242-104">这表示与 SAP 应用程序服务器的 ADO.NET 连接。</span><span class="sxs-lookup"><span data-stu-id="91242-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="91242-105">该项派生自**System.Data.Common.DbConnection**。</span><span class="sxs-lookup"><span data-stu-id="91242-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="91242-106">受支持的属性</span><span class="sxs-lookup"><span data-stu-id="91242-106">Supported Properties</span></span>  
  
|<span data-ttu-id="91242-107">Name</span><span class="sxs-lookup"><span data-stu-id="91242-107">Name</span></span>|<span data-ttu-id="91242-108">Get/Set</span><span class="sxs-lookup"><span data-stu-id="91242-108">Get/Set</span></span>|<span data-ttu-id="91242-109">Description</span><span class="sxs-lookup"><span data-stu-id="91242-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="91242-110">**ConnectionString**</span><span class="sxs-lookup"><span data-stu-id="91242-110">**ConnectionString**</span></span>|<span data-ttu-id="91242-111">获取和设置</span><span class="sxs-lookup"><span data-stu-id="91242-111">Get and Set</span></span>|<span data-ttu-id="91242-112">请参阅[SAP 连接字符串中读取有关数据提供程序类型](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md)。</span><span class="sxs-lookup"><span data-stu-id="91242-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="91242-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="91242-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="91242-114">获取</span><span class="sxs-lookup"><span data-stu-id="91242-114">Get</span></span>|<span data-ttu-id="91242-115">不提供支持。</span><span class="sxs-lookup"><span data-stu-id="91242-115">Not supported.</span></span> <span data-ttu-id="91242-116">返回 0。</span><span class="sxs-lookup"><span data-stu-id="91242-116">Returns 0.</span></span>|  
|<span data-ttu-id="91242-117">**数据库**</span><span class="sxs-lookup"><span data-stu-id="91242-117">**Database**</span></span>|<span data-ttu-id="91242-118">获取</span><span class="sxs-lookup"><span data-stu-id="91242-118">Get</span></span>|<span data-ttu-id="91242-119">SAP 系统 id。</span><span class="sxs-lookup"><span data-stu-id="91242-119">SAP System ID.</span></span>|  
|<span data-ttu-id="91242-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="91242-120">**DataSource**</span></span>|<span data-ttu-id="91242-121">获取</span><span class="sxs-lookup"><span data-stu-id="91242-121">Get</span></span>|<span data-ttu-id="91242-122">这将返回的 SAP 应用程序服务器主机的名称。</span><span class="sxs-lookup"><span data-stu-id="91242-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="91242-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="91242-123">**ServerVersion**</span></span>|<span data-ttu-id="91242-124">获取</span><span class="sxs-lookup"><span data-stu-id="91242-124">Get</span></span>|<span data-ttu-id="91242-125">这将显示 SAP 实例而不是 SAP 服务器版的发行版号。</span><span class="sxs-lookup"><span data-stu-id="91242-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="91242-126">例如，如果使用实例发行版号 620 情况下，ADO.NET 客户端连接到 SAP 服务器版本 4.6，则此属性将显示 620。</span><span class="sxs-lookup"><span data-stu-id="91242-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="91242-127">**State**</span><span class="sxs-lookup"><span data-stu-id="91242-127">**State**</span></span>|<span data-ttu-id="91242-128">获取</span><span class="sxs-lookup"><span data-stu-id="91242-128">Get</span></span>|<span data-ttu-id="91242-129">连接状态。</span><span class="sxs-lookup"><span data-stu-id="91242-129">Connection state.</span></span> <span data-ttu-id="91242-130">支持的状态包括：</span><span class="sxs-lookup"><span data-stu-id="91242-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="91242-131">-[System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="91242-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="91242-132">关闭</span><span class="sxs-lookup"><span data-stu-id="91242-132">- Closed</span></span><br /><br /> <span data-ttu-id="91242-133">-打开</span><span class="sxs-lookup"><span data-stu-id="91242-133">- Open</span></span><br /><br /> <span data-ttu-id="91242-134">-连接</span><span class="sxs-lookup"><span data-stu-id="91242-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="91242-135">支持的方法</span><span class="sxs-lookup"><span data-stu-id="91242-135">Supported Methods</span></span>  
  
|<span data-ttu-id="91242-136">Name</span><span class="sxs-lookup"><span data-stu-id="91242-136">Name</span></span>|<span data-ttu-id="91242-137">Description</span><span class="sxs-lookup"><span data-stu-id="91242-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="91242-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="91242-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="91242-139">不提供支持。</span><span class="sxs-lookup"><span data-stu-id="91242-139">Not supported.</span></span>|  
|<span data-ttu-id="91242-140">**Close （)**</span><span class="sxs-lookup"><span data-stu-id="91242-140">**Close()**</span></span>|<span data-ttu-id="91242-141">关闭到 SAP 系统的连接。</span><span class="sxs-lookup"><span data-stu-id="91242-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="91242-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="91242-142">**CreateCommand()**</span></span>|<span data-ttu-id="91242-143">返回与此连接关联新 SAPCommand。</span><span class="sxs-lookup"><span data-stu-id="91242-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="91242-144">**GetSchema()**</span><span class="sxs-lookup"><span data-stu-id="91242-144">**GetSchema()**</span></span>|<span data-ttu-id="91242-145">获取发现 SAP 表的列表。</span><span class="sxs-lookup"><span data-stu-id="91242-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="91242-146">所有发现在 XML 文件 SAPDiscoveredObjects.xml 表才可用。</span><span class="sxs-lookup"><span data-stu-id="91242-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="91242-147">该文件位于\<安装驱动器\>: \program Files\Microsoft Shared\Adapters\SAP。</span><span class="sxs-lookup"><span data-stu-id="91242-147">The file is located at \<installation drive\>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="91242-148">**GetSchema(string)**</span><span class="sxs-lookup"><span data-stu-id="91242-148">**GetSchema(string)**</span></span>|<span data-ttu-id="91242-149">获取基于集合名称的架构。</span><span class="sxs-lookup"><span data-stu-id="91242-149">Gets schema based on collection name.</span></span> <span data-ttu-id="91242-150">支持集合名称"Tables"。</span><span class="sxs-lookup"><span data-stu-id="91242-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="91242-151">Name</span><span class="sxs-lookup"><span data-stu-id="91242-151">Name</span></span>|<span data-ttu-id="91242-152">Description</span><span class="sxs-lookup"><span data-stu-id="91242-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="91242-153">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-154">获取根据集合名称和限制的架构。</span><span class="sxs-lookup"><span data-stu-id="91242-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="91242-155">下表表示的集合名称和支持的限制：</span><span class="sxs-lookup"><span data-stu-id="91242-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="91242-156">Name</span><span class="sxs-lookup"><span data-stu-id="91242-156">Name</span></span>|<span data-ttu-id="91242-157">集合名称</span><span class="sxs-lookup"><span data-stu-id="91242-157">Collection Name</span></span>|<span data-ttu-id="91242-158">限制</span><span class="sxs-lookup"><span data-stu-id="91242-158">Restrictions</span></span>|<span data-ttu-id="91242-159">Description</span><span class="sxs-lookup"><span data-stu-id="91242-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="91242-160">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-161">表</span><span class="sxs-lookup"><span data-stu-id="91242-161">Tables</span></span>|-|<span data-ttu-id="91242-162">发现 SAP 表的列表</span><span class="sxs-lookup"><span data-stu-id="91242-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="91242-163">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-164">过程</span><span class="sxs-lookup"><span data-stu-id="91242-164">Procedures</span></span>|-|<span data-ttu-id="91242-165">发现 Rfc 的列表</span><span class="sxs-lookup"><span data-stu-id="91242-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="91242-166">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="91242-167">SearchRFCs</span></span>|<span data-ttu-id="91242-168">arr [0]: 搜索 expr</span><span class="sxs-lookup"><span data-stu-id="91242-168">arr[0]: Search expr</span></span>|<span data-ttu-id="91242-169">匹配 Rfc 的列表</span><span class="sxs-lookup"><span data-stu-id="91242-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="91242-170">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="91242-171">ImportParameters</span></span>|<span data-ttu-id="91242-172">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-172">arr[1]: RFC name</span></span>|<span data-ttu-id="91242-173">导入 RFC 的参数</span><span class="sxs-lookup"><span data-stu-id="91242-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="91242-174">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="91242-175">ImportParameterColumn</span></span>|<span data-ttu-id="91242-176">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="91242-177">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="91242-177">arr[2]: Param name</span></span>|<span data-ttu-id="91242-178">导入参数架构</span><span class="sxs-lookup"><span data-stu-id="91242-178">Import parameter schema</span></span>|  
|<span data-ttu-id="91242-179">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="91242-180">ExportParameters</span></span>|<span data-ttu-id="91242-181">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-181">arr[1]: RFC name</span></span>|<span data-ttu-id="91242-182">导出 RFC 的参数</span><span class="sxs-lookup"><span data-stu-id="91242-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="91242-183">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="91242-184">ExportParameterColumn</span></span>|<span data-ttu-id="91242-185">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="91242-186">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="91242-186">arr[2]: Param name</span></span>|<span data-ttu-id="91242-187">导出参数架构</span><span class="sxs-lookup"><span data-stu-id="91242-187">Export parameter schema</span></span>|  
|<span data-ttu-id="91242-188">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="91242-189">TableParameters</span></span>|<span data-ttu-id="91242-190">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-190">arr[1]: RFC name</span></span>|<span data-ttu-id="91242-191">RFC 的表参数</span><span class="sxs-lookup"><span data-stu-id="91242-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="91242-192">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="91242-193">TableParameterColumn</span></span>|<span data-ttu-id="91242-194">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="91242-195">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="91242-195">arr[2]: Param name</span></span>|<span data-ttu-id="91242-196">表参数架构</span><span class="sxs-lookup"><span data-stu-id="91242-196">Table parameter schema</span></span>|  
|<span data-ttu-id="91242-197">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="91242-198">ChangingParameters</span></span>|<span data-ttu-id="91242-199">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-199">arr[1]: RFC name</span></span>|<span data-ttu-id="91242-200">更改 RFC 的参数</span><span class="sxs-lookup"><span data-stu-id="91242-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="91242-201">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="91242-202">ChangingParameterColumn</span></span>|<span data-ttu-id="91242-203">arr [1]: RFC 名称</span><span class="sxs-lookup"><span data-stu-id="91242-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="91242-204">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="91242-204">arr[2]: Param name</span></span>|<span data-ttu-id="91242-205">更改参数架构</span><span class="sxs-lookup"><span data-stu-id="91242-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="91242-206">**GetSchema （string，string[])**</span><span class="sxs-lookup"><span data-stu-id="91242-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="91242-207">列</span><span class="sxs-lookup"><span data-stu-id="91242-207">columns</span></span>|<span data-ttu-id="91242-208">arr [1]: 表名</span><span class="sxs-lookup"><span data-stu-id="91242-208">arr[1]: Table name</span></span>|<span data-ttu-id="91242-209">SAP 表列架构</span><span class="sxs-lookup"><span data-stu-id="91242-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="91242-210">Name</span><span class="sxs-lookup"><span data-stu-id="91242-210">Name</span></span>|<span data-ttu-id="91242-211">Description</span><span class="sxs-lookup"><span data-stu-id="91242-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="91242-212">**Open （)**</span><span class="sxs-lookup"><span data-stu-id="91242-212">**Open()**</span></span>|<span data-ttu-id="91242-213">将打开基于连接字符串的 SAP 连接。</span><span class="sxs-lookup"><span data-stu-id="91242-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="91242-214">表、 过程以及 SearchRFCs 收集条目除外的所有其他集合条目必须指定 arr [0] dummy 值。</span><span class="sxs-lookup"><span data-stu-id="91242-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="91242-215">支持的构造函数</span><span class="sxs-lookup"><span data-stu-id="91242-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="91242-216">Name</span><span class="sxs-lookup"><span data-stu-id="91242-216">Name</span></span>|<span data-ttu-id="91242-217">Description</span><span class="sxs-lookup"><span data-stu-id="91242-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="91242-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="91242-218">**SAPConnection()**</span></span>|<span data-ttu-id="91242-219">创建 SAPConnection 对象实例。</span><span class="sxs-lookup"><span data-stu-id="91242-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="91242-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="91242-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="91242-221">接受一个 SAP 连接字符串。</span><span class="sxs-lookup"><span data-stu-id="91242-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="91242-222">如果连接字符串无效，则引发异常。</span><span class="sxs-lookup"><span data-stu-id="91242-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="91242-223">另请参阅</span><span class="sxs-lookup"><span data-stu-id="91242-223">See Also</span></span>  
 [<span data-ttu-id="91242-224">使用 SAP 适配器扩展 ADO.NET 接口</span><span class="sxs-lookup"><span data-stu-id="91242-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)