---
title: SAP 适配器 SAPConnection 类 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 14fb1cf2b04fd16aedd8aa97f75f2fa57620e3f0
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65372951"
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="43964-102">SAP 适配器 SAPConnection 类</span><span class="sxs-lookup"><span data-stu-id="43964-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="43964-103">以下部分列出的方法和属性**SAPConnection**类。</span><span class="sxs-lookup"><span data-stu-id="43964-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="43964-104">这表示 ADO.NET 连接到 SAP 应用程序服务器。</span><span class="sxs-lookup"><span data-stu-id="43964-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="43964-105">这派生自**System.Data.Common.DbConnection**。</span><span class="sxs-lookup"><span data-stu-id="43964-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="43964-106">支持的属性</span><span class="sxs-lookup"><span data-stu-id="43964-106">Supported Properties</span></span>  
  
|<span data-ttu-id="43964-107">“属性”</span><span class="sxs-lookup"><span data-stu-id="43964-107">Name</span></span>|<span data-ttu-id="43964-108">获取/设置</span><span class="sxs-lookup"><span data-stu-id="43964-108">Get/Set</span></span>|<span data-ttu-id="43964-109">Description</span><span class="sxs-lookup"><span data-stu-id="43964-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="43964-110">**ConnectionString**</span><span class="sxs-lookup"><span data-stu-id="43964-110">**ConnectionString**</span></span>|<span data-ttu-id="43964-111">获取和设置</span><span class="sxs-lookup"><span data-stu-id="43964-111">Get and Set</span></span>|<span data-ttu-id="43964-112">请参阅[了解数据提供程序类型适用于 SAP 连接字符串](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md)。</span><span class="sxs-lookup"><span data-stu-id="43964-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="43964-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="43964-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="43964-114">获取</span><span class="sxs-lookup"><span data-stu-id="43964-114">Get</span></span>|<span data-ttu-id="43964-115">不提供支持。</span><span class="sxs-lookup"><span data-stu-id="43964-115">Not supported.</span></span> <span data-ttu-id="43964-116">返回 0。</span><span class="sxs-lookup"><span data-stu-id="43964-116">Returns 0.</span></span>|  
|<span data-ttu-id="43964-117">**“数据库”**</span><span class="sxs-lookup"><span data-stu-id="43964-117">**Database**</span></span>|<span data-ttu-id="43964-118">获取</span><span class="sxs-lookup"><span data-stu-id="43964-118">Get</span></span>|<span data-ttu-id="43964-119">SAP 系统 id。</span><span class="sxs-lookup"><span data-stu-id="43964-119">SAP System ID.</span></span>|  
|<span data-ttu-id="43964-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="43964-120">**DataSource**</span></span>|<span data-ttu-id="43964-121">获取</span><span class="sxs-lookup"><span data-stu-id="43964-121">Get</span></span>|<span data-ttu-id="43964-122">这将返回 SAP 应用程序服务器主机的名称。</span><span class="sxs-lookup"><span data-stu-id="43964-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="43964-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="43964-123">**ServerVersion**</span></span>|<span data-ttu-id="43964-124">获取</span><span class="sxs-lookup"><span data-stu-id="43964-124">Get</span></span>|<span data-ttu-id="43964-125">这将显示有关 SAP 实例而不是 SAP 服务器版的发行版号。</span><span class="sxs-lookup"><span data-stu-id="43964-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="43964-126">例如，如果实例版本编号 620 的情况下，ADO.NET 客户端连接到 SAP 服务器版本 4.6，此属性将显示 620。</span><span class="sxs-lookup"><span data-stu-id="43964-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="43964-127">**状态**</span><span class="sxs-lookup"><span data-stu-id="43964-127">**State**</span></span>|<span data-ttu-id="43964-128">获取</span><span class="sxs-lookup"><span data-stu-id="43964-128">Get</span></span>|<span data-ttu-id="43964-129">连接状态。</span><span class="sxs-lookup"><span data-stu-id="43964-129">Connection state.</span></span> <span data-ttu-id="43964-130">受支持的状态包括：</span><span class="sxs-lookup"><span data-stu-id="43964-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="43964-131">- [System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="43964-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="43964-132">-关闭</span><span class="sxs-lookup"><span data-stu-id="43964-132">- Closed</span></span><br /><br /> <span data-ttu-id="43964-133">-打开</span><span class="sxs-lookup"><span data-stu-id="43964-133">- Open</span></span><br /><br /> <span data-ttu-id="43964-134">-连接</span><span class="sxs-lookup"><span data-stu-id="43964-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="43964-135">受支持的方法</span><span class="sxs-lookup"><span data-stu-id="43964-135">Supported Methods</span></span>  
  
|<span data-ttu-id="43964-136">“属性”</span><span class="sxs-lookup"><span data-stu-id="43964-136">Name</span></span>|<span data-ttu-id="43964-137">Description</span><span class="sxs-lookup"><span data-stu-id="43964-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="43964-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="43964-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="43964-139">不提供支持。</span><span class="sxs-lookup"><span data-stu-id="43964-139">Not supported.</span></span>|  
|<span data-ttu-id="43964-140">**Close()**</span><span class="sxs-lookup"><span data-stu-id="43964-140">**Close()**</span></span>|<span data-ttu-id="43964-141">关闭到 SAP 系统的连接。</span><span class="sxs-lookup"><span data-stu-id="43964-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="43964-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="43964-142">**CreateCommand()**</span></span>|<span data-ttu-id="43964-143">返回与此连接关联的新 SAPCommand。</span><span class="sxs-lookup"><span data-stu-id="43964-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="43964-144">**GetSchema()**</span><span class="sxs-lookup"><span data-stu-id="43964-144">**GetSchema()**</span></span>|<span data-ttu-id="43964-145">获取已发现 SAP 表的列表。</span><span class="sxs-lookup"><span data-stu-id="43964-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="43964-146">所有发现的表是在 SAPDiscoveredObjects.xml 的 XML 文件中可用。</span><span class="sxs-lookup"><span data-stu-id="43964-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="43964-147">该文件位于\<安装驱动器\>: \Program Files\Common Files\Microsoft Shared\Adapters\SAP。</span><span class="sxs-lookup"><span data-stu-id="43964-147">The file is located at \<installation drive\>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="43964-148">**GetSchema(string)**</span><span class="sxs-lookup"><span data-stu-id="43964-148">**GetSchema(string)**</span></span>|<span data-ttu-id="43964-149">获取根据集合名称的架构。</span><span class="sxs-lookup"><span data-stu-id="43964-149">Gets schema based on collection name.</span></span> <span data-ttu-id="43964-150">支持集合名称"表"。</span><span class="sxs-lookup"><span data-stu-id="43964-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="43964-151">“属性”</span><span class="sxs-lookup"><span data-stu-id="43964-151">Name</span></span>|<span data-ttu-id="43964-152">Description</span><span class="sxs-lookup"><span data-stu-id="43964-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="43964-153">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-154">获取根据集合名称和限制的架构。</span><span class="sxs-lookup"><span data-stu-id="43964-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="43964-155">下表表示的集合名称和受支持的限制：</span><span class="sxs-lookup"><span data-stu-id="43964-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="43964-156">“属性”</span><span class="sxs-lookup"><span data-stu-id="43964-156">Name</span></span>|<span data-ttu-id="43964-157">集合名称</span><span class="sxs-lookup"><span data-stu-id="43964-157">Collection Name</span></span>|<span data-ttu-id="43964-158">限制</span><span class="sxs-lookup"><span data-stu-id="43964-158">Restrictions</span></span>|<span data-ttu-id="43964-159">Description</span><span class="sxs-lookup"><span data-stu-id="43964-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="43964-160">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-161">表</span><span class="sxs-lookup"><span data-stu-id="43964-161">Tables</span></span>|-|<span data-ttu-id="43964-162">已发现 SAP 表的列表</span><span class="sxs-lookup"><span data-stu-id="43964-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="43964-163">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-164">过程</span><span class="sxs-lookup"><span data-stu-id="43964-164">Procedures</span></span>|-|<span data-ttu-id="43964-165">已发现的 Rfc 的列表</span><span class="sxs-lookup"><span data-stu-id="43964-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="43964-166">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="43964-167">SearchRFCs</span></span>|<span data-ttu-id="43964-168">arr[0]:搜索 expr</span><span class="sxs-lookup"><span data-stu-id="43964-168">arr[0]: Search expr</span></span>|<span data-ttu-id="43964-169">匹配 Rfc 的列表</span><span class="sxs-lookup"><span data-stu-id="43964-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="43964-170">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="43964-171">ImportParameters</span></span>|<span data-ttu-id="43964-172">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-172">arr[1]: RFC name</span></span>|<span data-ttu-id="43964-173">导入 RFC 的参数</span><span class="sxs-lookup"><span data-stu-id="43964-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="43964-174">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="43964-175">ImportParameterColumn</span></span>|<span data-ttu-id="43964-176">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="43964-177">arr[2]:参数名称</span><span class="sxs-lookup"><span data-stu-id="43964-177">arr[2]: Param name</span></span>|<span data-ttu-id="43964-178">导入参数架构</span><span class="sxs-lookup"><span data-stu-id="43964-178">Import parameter schema</span></span>|  
|<span data-ttu-id="43964-179">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="43964-180">ExportParameters</span></span>|<span data-ttu-id="43964-181">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-181">arr[1]: RFC name</span></span>|<span data-ttu-id="43964-182">导出 RFC 的参数</span><span class="sxs-lookup"><span data-stu-id="43964-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="43964-183">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="43964-184">ExportParameterColumn</span></span>|<span data-ttu-id="43964-185">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="43964-186">arr[2]:参数名称</span><span class="sxs-lookup"><span data-stu-id="43964-186">arr[2]: Param name</span></span>|<span data-ttu-id="43964-187">导出参数架构</span><span class="sxs-lookup"><span data-stu-id="43964-187">Export parameter schema</span></span>|  
|<span data-ttu-id="43964-188">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="43964-189">TableParameters</span></span>|<span data-ttu-id="43964-190">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-190">arr[1]: RFC name</span></span>|<span data-ttu-id="43964-191">表参数的 RFC</span><span class="sxs-lookup"><span data-stu-id="43964-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="43964-192">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="43964-193">TableParameterColumn</span></span>|<span data-ttu-id="43964-194">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="43964-195">arr[2]:参数名称</span><span class="sxs-lookup"><span data-stu-id="43964-195">arr[2]: Param name</span></span>|<span data-ttu-id="43964-196">表参数架构</span><span class="sxs-lookup"><span data-stu-id="43964-196">Table parameter schema</span></span>|  
|<span data-ttu-id="43964-197">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="43964-198">ChangingParameters</span></span>|<span data-ttu-id="43964-199">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-199">arr[1]: RFC name</span></span>|<span data-ttu-id="43964-200">更改参数的 RFC</span><span class="sxs-lookup"><span data-stu-id="43964-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="43964-201">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="43964-202">ChangingParameterColumn</span></span>|<span data-ttu-id="43964-203">arr[1]:RFC 名称</span><span class="sxs-lookup"><span data-stu-id="43964-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="43964-204">arr[2]:参数名称</span><span class="sxs-lookup"><span data-stu-id="43964-204">arr[2]: Param name</span></span>|<span data-ttu-id="43964-205">更改参数架构</span><span class="sxs-lookup"><span data-stu-id="43964-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="43964-206">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="43964-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="43964-207">列</span><span class="sxs-lookup"><span data-stu-id="43964-207">columns</span></span>|<span data-ttu-id="43964-208">arr[1]:表名</span><span class="sxs-lookup"><span data-stu-id="43964-208">arr[1]: Table name</span></span>|<span data-ttu-id="43964-209">SAP 表列架构</span><span class="sxs-lookup"><span data-stu-id="43964-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="43964-210">“属性”</span><span class="sxs-lookup"><span data-stu-id="43964-210">Name</span></span>|<span data-ttu-id="43964-211">Description</span><span class="sxs-lookup"><span data-stu-id="43964-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="43964-212">**Open()**</span><span class="sxs-lookup"><span data-stu-id="43964-212">**Open()**</span></span>|<span data-ttu-id="43964-213">将打开基于连接字符串上的 SAP 连接。</span><span class="sxs-lookup"><span data-stu-id="43964-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="43964-214">除了表、 过程和 SearchRFCs 集合项，对于所有其他集合项必须指定 arr [0] 的虚拟值。</span><span class="sxs-lookup"><span data-stu-id="43964-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="43964-215">受支持的构造函数</span><span class="sxs-lookup"><span data-stu-id="43964-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="43964-216">“属性”</span><span class="sxs-lookup"><span data-stu-id="43964-216">Name</span></span>|<span data-ttu-id="43964-217">Description</span><span class="sxs-lookup"><span data-stu-id="43964-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="43964-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="43964-218">**SAPConnection()**</span></span>|<span data-ttu-id="43964-219">创建 SAPConnection 对象实例。</span><span class="sxs-lookup"><span data-stu-id="43964-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="43964-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="43964-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="43964-221">接受 SAP 连接字符串。</span><span class="sxs-lookup"><span data-stu-id="43964-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="43964-222">如果连接字符串无效，将引发异常。</span><span class="sxs-lookup"><span data-stu-id="43964-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="43964-223">请参阅</span><span class="sxs-lookup"><span data-stu-id="43964-223">See Also</span></span>  
 [<span data-ttu-id="43964-224">扩展 ADO.NET 接口，与 SAP 适配器</span><span class="sxs-lookup"><span data-stu-id="43964-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)