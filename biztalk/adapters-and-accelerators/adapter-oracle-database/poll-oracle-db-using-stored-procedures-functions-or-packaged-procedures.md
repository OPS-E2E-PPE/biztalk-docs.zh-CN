---
title: "轮询使用存储的过程、 函数或打包的过程和函数的 Oracle 数据库 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 6c34843a-d02b-4941-baf6-6bc80b5821ad
caps.latest.revision: "12"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 72147ffe0f29fbb8456e4d652877b66e7ce0543c
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2017
---
# <a name="poll-oracle-database-using-stored-procedures-functions-or-packaged-procedures-and-functions"></a><span data-ttu-id="a780f-102">使用存储的过程、 函数或打包的过程和函数的轮询 Oracle 数据库</span><span class="sxs-lookup"><span data-stu-id="a780f-102">Poll Oracle Database Using Stored Procedures, Functions, or Packaged Procedures and Functions</span></span>
<span data-ttu-id="a780f-103">你可以配置[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]接收定期的数据更改消息通过使用存储的过程、 函数或打包的过程和函数以定期轮询 Oracle 数据库。</span><span class="sxs-lookup"><span data-stu-id="a780f-103">You can configure the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] to receive periodic data-change messages by using stored procedures, functions, or packaged procedures and functions to periodically poll the Oracle database.</span></span> <span data-ttu-id="a780f-104">你可以指定存储的过程、 函数或打包的过程和函数与适配器执行定期轮询 Oracle 数据库的轮询语句。</span><span class="sxs-lookup"><span data-stu-id="a780f-104">You can specify a stored procedure, function, or packaged procedure and function as a polling statement that the adapter executes periodically to poll the Oracle database.</span></span>  
  
 <span data-ttu-id="a780f-105">若要启用此功能，必须指定某些绑定属性上[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a780f-105">To enable this, you must specify certain binding properties on the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)].</span></span> <span data-ttu-id="a780f-106">你还可以通过设置修改 POLLINGSTMT 操作的目标命名空间**PollingId**连接 URI 中的属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-106">You can also modify the target namespace for the POLLINGSTMT operation by setting the **PollingId** property in the connection URI.</span></span> <span data-ttu-id="a780f-107">有关详细信息，请参阅[支持基于接收轮询的 Oracle 数据库中的数据更改消息](../../adapters-and-accelerators/adapter-oracle-database/support-for-receiving-polling-based-data-changed-messages-in-oracle-database.md)和[Oracle 数据库适配器中接收基于轮询的数据更改消息](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-database-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-107">For more information, see [Support for Receiving Polling-based Data-changed Messages in Oracle Database](../../adapters-and-accelerators/adapter-oracle-database/support-for-receiving-polling-based-data-changed-messages-in-oracle-database.md) and [Receive polling-based data-changed messages in Oracle Database adapter](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-database-adapter.md).</span></span> <span data-ttu-id="a780f-108">有关轮询操作的 SOAP 消息结构的信息，请参阅[轮询操作的消息架构](../../adapters-and-accelerators/adapter-oracle-database/message-schemas-for-the-polling-operations2.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-108">For information about the structure of the SOAP message for polling operations, see [Message Schemas for the Polling Operations](../../adapters-and-accelerators/adapter-oracle-database/message-schemas-for-the-polling-operations2.md).</span></span>  
  
## <a name="configuring-a-polling-operation-with-oracle-database-adapter-binding-properties"></a><span data-ttu-id="a780f-109">使用 Oracle 数据库适配器绑定属性中配置的轮询操作</span><span class="sxs-lookup"><span data-stu-id="a780f-109">Configuring a Polling Operation with Oracle Database Adapter Binding Properties</span></span>  
 <span data-ttu-id="a780f-110">[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]执行轮询查询和在事务内的任何后轮询 PL/SQL 代码块。</span><span class="sxs-lookup"><span data-stu-id="a780f-110">The [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] executes the polling query and any post-poll PL/SQL code block inside a transaction.</span></span> <span data-ttu-id="a780f-111">下表总结了[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]更改消息的绑定属性，用于配置适配器，以接收数据。</span><span class="sxs-lookup"><span data-stu-id="a780f-111">The following table summarizes the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] binding properties that you use to configure the adapter to receive data change messages.</span></span> <span data-ttu-id="a780f-112">你必须指定配置 WCF 自定义或 WCF OracleDB 时这些绑定属性接收中的端口[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="a780f-112">You must specify these binding properties while configuring the WCF-Custom or WCF-OracleDB receive port in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
|<span data-ttu-id="a780f-113">绑定属性</span><span class="sxs-lookup"><span data-stu-id="a780f-113">Binding Property</span></span>|<span data-ttu-id="a780f-114">Description</span><span class="sxs-lookup"><span data-stu-id="a780f-114">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="a780f-115">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="a780f-115">**InboundOperationType**</span></span>|<span data-ttu-id="a780f-116">指定是否想要执行的轮询或通知入站操作。</span><span class="sxs-lookup"><span data-stu-id="a780f-116">Specifies whether you want to perform the Polling or Notification inbound operation.</span></span> <span data-ttu-id="a780f-117">默认值是**轮询**。</span><span class="sxs-lookup"><span data-stu-id="a780f-117">Default is **Polling**.</span></span>|  
|<span data-ttu-id="a780f-118">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="a780f-118">**PolledDataAvailableStatement**</span></span>|<span data-ttu-id="a780f-119">指定适配器以确定任何数据是否可用于轮询将执行的 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="a780f-119">Specifies the SQL statement that the adapter executes to determine whether any data is available for polling.</span></span> <span data-ttu-id="a780f-120">仅当一条记录时，存储的过程指定为**PollingStatement**将执行绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-120">Only if a record is available, the stored procedure you specified for the **PollingStatement** binding property will be executed.</span></span>|  
|<span data-ttu-id="a780f-121">**PollingInterval**</span><span class="sxs-lookup"><span data-stu-id="a780f-121">**PollingInterval**</span></span>|<span data-ttu-id="a780f-122">指定的时间间隔，以秒为单位，从该处[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]执行为指定的语句**PolledDataAvailableStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-122">Specifies the interval, in seconds, at which the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] executes the statement specified for the **PolledDataAvailableStatement** binding property.</span></span> <span data-ttu-id="a780f-123">默认值为 500 秒。</span><span class="sxs-lookup"><span data-stu-id="a780f-123">The default is 500 seconds.</span></span> <span data-ttu-id="a780f-124">轮询间隔确定连续两次轮询之间的时间间隔。</span><span class="sxs-lookup"><span data-stu-id="a780f-124">The polling interval determines the time interval between successive polls.</span></span> <span data-ttu-id="a780f-125">如果在指定间隔内执行该语句，该适配器休眠的剩余时间的时间间隔内。</span><span class="sxs-lookup"><span data-stu-id="a780f-125">If the statement is executed within the specified interval, the adapter sleeps for the remaining time in the interval.</span></span> <span data-ttu-id="a780f-126">默认值是`SELECT 1 FROM DUAL`，这表明是否，适配器必须继续而不考虑轮询表是否具有数据的轮询。</span><span class="sxs-lookup"><span data-stu-id="a780f-126">The default is `SELECT 1 FROM DUAL`, which implies that the adapter must continue polling irrespective of whether the table being polled has data or not.</span></span>|  
|<span data-ttu-id="a780f-127">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="a780f-127">**PollingStatement**</span></span>|<span data-ttu-id="a780f-128">指定的轮询语句。</span><span class="sxs-lookup"><span data-stu-id="a780f-128">Specifies the polling statement.</span></span> <span data-ttu-id="a780f-129">若要轮询使用存储的过程、 函数，或打包的过程或函数，必须在此绑定属性中指定相应的操作的整个请求消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-129">To poll using a stored procedure, function, or packaged procedure or function, you must specify the entire request message for the respective operation in this binding property.</span></span> <span data-ttu-id="a780f-130">请求消息必须相同，你将发送到适配器作为出站操作调用相应的操作。</span><span class="sxs-lookup"><span data-stu-id="a780f-130">The request message must be the same that you send to the adapter for invoking the respective operations as an outbound operation.</span></span> <span data-ttu-id="a780f-131">默认值为 null。</span><span class="sxs-lookup"><span data-stu-id="a780f-131">The default is null.</span></span><br /><br /> <span data-ttu-id="a780f-132">必须指定的值**PollingStatement**绑定属性来启用轮询。</span><span class="sxs-lookup"><span data-stu-id="a780f-132">You must specify a value for **PollingStatement** binding property to enable polling.</span></span> <span data-ttu-id="a780f-133">仅当没有数据可用于轮询，该域由执行轮询语句**PolledDataAvailableStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-133">The polling statement is executed only if there is data available for polling, which is determined by the **PolledDataAvailableStatement** binding property.</span></span>|  
|<span data-ttu-id="a780f-134">**PollingAction**</span><span class="sxs-lookup"><span data-stu-id="a780f-134">**PollingAction**</span></span>|<span data-ttu-id="a780f-135">指定轮询操作的操作。</span><span class="sxs-lookup"><span data-stu-id="a780f-135">Specifies the action for the polling operation.</span></span> <span data-ttu-id="a780f-136">你可以确定从元数据生成操作使用特定操作的轮询操作[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a780f-136">You can determine the polling action for a specific operation from the metadata you generate for the operation using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>|  
|<span data-ttu-id="a780f-137">**PostPollStatement**</span><span class="sxs-lookup"><span data-stu-id="a780f-137">**PostPollStatement**</span></span>|<span data-ttu-id="a780f-138">指定在指定的语句之后执行的语句块**PollingStatement**绑定属性执行。</span><span class="sxs-lookup"><span data-stu-id="a780f-138">Specifies a statement block that is executed after the statement specified by the **PollingStatement** binding property is executed.</span></span>|  
|<span data-ttu-id="a780f-139">**PollWhileDataFound**</span><span class="sxs-lookup"><span data-stu-id="a780f-139">**PollWhileDataFound**</span></span>|<span data-ttu-id="a780f-140">指定是否[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]忽略轮询间隔和连续执行轮询语句中，如果数据中轮询的表。</span><span class="sxs-lookup"><span data-stu-id="a780f-140">Specifies whether the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] ignores the polling interval and continuously executes the polling statement, if data is available in the table being polled.</span></span> <span data-ttu-id="a780f-141">如果表中可用的任何数据不，该适配器将恢复执行轮询语句按照指定的轮询间隔。</span><span class="sxs-lookup"><span data-stu-id="a780f-141">If no data is available in the table, the adapter reverts to execute the polling statement at the specified polling interval.</span></span> <span data-ttu-id="a780f-142">默认值为 false。</span><span class="sxs-lookup"><span data-stu-id="a780f-142">Default is false.</span></span>|  
  
 <span data-ttu-id="a780f-143">有关这些属性的更完整说明，请参阅[阅读有关 Oracle 数据库适配器绑定属性](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-143">For a more complete description of these properties, see [Read about the Oracle Database adapter binding properties](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md).</span></span> <span data-ttu-id="a780f-144">有关如何使用的完整说明[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]若要轮询的 Oracle 数据库，进一步阅读。</span><span class="sxs-lookup"><span data-stu-id="a780f-144">For a complete description of how to use the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] to poll the Oracle database, read further.</span></span>  
  
## <a name="how-this-topic-demonstrates-polling"></a><span data-ttu-id="a780f-145">本主题演示轮询的方式</span><span class="sxs-lookup"><span data-stu-id="a780f-145">How This Topic Demonstrates Polling</span></span>  
 <span data-ttu-id="a780f-146">本主题演示如何可以轮询使用存储的过程的 Oracle 数据库。</span><span class="sxs-lookup"><span data-stu-id="a780f-146">This topic demonstrates how you can poll the Oracle database using a stored procedure.</span></span> <span data-ttu-id="a780f-147">创建 BizTalk 项目，并生成你想要用于轮询 Oracle 数据库的存储过程的架构。</span><span class="sxs-lookup"><span data-stu-id="a780f-147">Create a BizTalk project and generate schema for the stored procedure you want to use to poll the Oracle database.</span></span> <span data-ttu-id="a780f-148">在本主题中，我们使用 GET_ACTIVITYS 存储过程来轮询 ACCOUNTACTIVITY 表。</span><span class="sxs-lookup"><span data-stu-id="a780f-148">In this topic, we use the GET_ACTIVITYS stored procedure to poll the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="a780f-149">此存储的过程时使用 SCOTT 架构中的 ACCOUNT_PKG 包。</span><span class="sxs-lookup"><span data-stu-id="a780f-149">This stored procedure is available with the ACCOUNT_PKG package in the SCOTT schema.</span></span> <span data-ttu-id="a780f-150">你可以运行这些示例数据库中创建这些对象提供的 SQL 脚本。</span><span class="sxs-lookup"><span data-stu-id="a780f-150">You can run the SQL scripts provided with the samples to create these objects in the database.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a780f-151">此主题轮询 ACCOUNTACTIVITY 表，其中数据库表创建通过使用示例运行提供的脚本中业务流程。</span><span class="sxs-lookup"><span data-stu-id="a780f-151">The orchestration in this topic polls the ACCOUNTACTIVITY table, which is a database table created by running the scripts provided with the samples.</span></span> <span data-ttu-id="a780f-152">本主题以轮询任何其他表中所述，你必须执行类似的过程。</span><span class="sxs-lookup"><span data-stu-id="a780f-152">You must perform similar procedures as described in this topic to poll any other table.</span></span>  
  
 <span data-ttu-id="a780f-153">为了演示轮询操作，我们执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="a780f-153">To demonstrate a polling operation, we do the following:</span></span>  
  
-   <span data-ttu-id="a780f-154">指定 SELECT 语句，以**PolledDataAvailableStatement**绑定属性以确定其中表轮询 (ACCOUNTACTIVITY) 有任何数据。</span><span class="sxs-lookup"><span data-stu-id="a780f-154">Specify a SELECT statement for the **PolledDataAvailableStatement** binding property to determine where the table being polled (ACCOUNTACTIVITY) has any data.</span></span> <span data-ttu-id="a780f-155">在此示例中，你可以设置为此绑定属性：</span><span class="sxs-lookup"><span data-stu-id="a780f-155">In this example, you can set this binding property as:</span></span>  
  
    ```  
    SELECT COUNT (*) FROM ACCOUNTACTIVITY  
    ```  
  
     <span data-ttu-id="a780f-156">这可确保仅当 ACCOUNTACTIVITY 表具有某些记录时，适配器都将执行轮询语句。</span><span class="sxs-lookup"><span data-stu-id="a780f-156">This ensures that the adapter executes the polling statement only when the ACCOUNTACTIVITY table has some records.</span></span>  
  
-   <span data-ttu-id="a780f-157">通过提供作为的一部分的请求消息执行存储的过程，GET_ACTIVITYS， **PollingStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-157">Execute a stored procedure, GET_ACTIVITYS, by providing the request message as part of the **PollingStatement** binding property.</span></span> <span data-ttu-id="a780f-158">此存储的过程将检索 ACCOUNTACTIVITY 表中的所有行，并且你将获得该适配器的响应消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-158">This stored procedure will retrieve all the rows in the ACCOUNTACTIVITY table and you will get a response message from the adapter.</span></span>  
  
-   <span data-ttu-id="a780f-159">作为的一部分执行一个 PL/SQL 块**PostPollStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-159">EXECUTE a PL/SQL block as part of the **PostPollStatement** binding property.</span></span> <span data-ttu-id="a780f-160">此语句将所有数据从 ACCOUNTACTIVITY 表都移到数据库中的另一个表。</span><span class="sxs-lookup"><span data-stu-id="a780f-160">This statement will move all data from ACCOUNTACTIVITY table to another table in the database.</span></span> <span data-ttu-id="a780f-161">一旦发生这种情况下, 一次**PollingStatement**将执行，它将不提取任何数据，因此 GET_ACTIVITYS 存储过程将返回一个空响应消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-161">Once this happens, the next time **PollingStatement** will be executed, it will not fetch any data and hence the GET_ACTIVITYS stored procedure will return an empty response message.</span></span>  
  
-   <span data-ttu-id="a780f-162">更多的数据添加到 ACCOUNTACTIVITY 表，直到你将继续获取空响应消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-162">Until more data is added to the ACCOUNTACTIVITY table, you will continue to get empty response messages.</span></span> <span data-ttu-id="a780f-163">因此，你必须重新填充的新记录所在 ACCOUNTACTIVITY 的表。</span><span class="sxs-lookup"><span data-stu-id="a780f-163">So, you must repopulate the ACCOUNTACTIVITY table with new records.</span></span> <span data-ttu-id="a780f-164">你可以通过运行这些示例使用提供的 more_activity_data.sql 脚本来实现。</span><span class="sxs-lookup"><span data-stu-id="a780f-164">You can do so by running the more_activity_data.sql script provided with the samples.</span></span> <span data-ttu-id="a780f-165">运行此脚本后下, 一个轮询操作将获取新记录插入到表。</span><span class="sxs-lookup"><span data-stu-id="a780f-165">After you run this script, the next polling operation will fetch the new records inserted into the table.</span></span>  
  
## <a name="how-to-receive-data-change-messages-from-oracle"></a><span data-ttu-id="a780f-166">如何从 Oracle 接收数据更改消息</span><span class="sxs-lookup"><span data-stu-id="a780f-166">How to Receive Data-change Messages from Oracle</span></span>  
 <span data-ttu-id="a780f-167">使用 Oracle 数据库上执行操作[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]与[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]涉及以下过程任务中所述[开发与 Oracle 数据库的 BizTalk 应用程序的构建基块](../../adapters-and-accelerators/adapter-oracle-database/building-blocks-to-develop-biztalk-applications-with-oracle-database.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-167">Performing an operation on Oracle database using [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] involves the following procedural tasks described in [Building Blocks to develop BizTalk Applications with Oracle Database](../../adapters-and-accelerators/adapter-oracle-database/building-blocks-to-develop-biztalk-applications-with-oracle-database.md).</span></span> <span data-ttu-id="a780f-168">若要配置的适配器轮询 Oracle 数据库使用的存储的过程：</span><span class="sxs-lookup"><span data-stu-id="a780f-168">To configure the adapter to poll Oracle database using a stored procedure:</span></span>  
  
1.  <span data-ttu-id="a780f-169">创建 BizTalk 项目，并生成你想要使用进行轮询的存储过程的架构。</span><span class="sxs-lookup"><span data-stu-id="a780f-169">Create a BizTalk project, and generate schema for the stored procedure you want to use for polling.</span></span>  
  
2.  <span data-ttu-id="a780f-170">在从 Oracle 数据库接收消息的 BizTalk 项目中创建一条消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-170">Create a message in the BizTalk project for receiving messages from Oracle database.</span></span>  
  
3.  <span data-ttu-id="a780f-171">创建业务流程从 Oracle 数据库接收消息并将它们保存到文件夹。</span><span class="sxs-lookup"><span data-stu-id="a780f-171">Create an orchestration to receive messages from Oracle database and save them to a folder.</span></span>  
  
4.  <span data-ttu-id="a780f-172">生成和部署 BizTalk 项目。</span><span class="sxs-lookup"><span data-stu-id="a780f-172">Build and deploy the BizTalk project.</span></span>  
  
5.  <span data-ttu-id="a780f-173">配置的 BizTalk 应用程序创建的物理发送和接收端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-173">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="a780f-174">你始终必须配置的入站的轮询方案单向接收端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-174">For inbound polling scenarios you must always configure a one-way receive port.</span></span> <span data-ttu-id="a780f-175">双向接收入站操作不支持端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-175">Two-way receive ports are not supported for inbound operations.</span></span>  
  
6.  <span data-ttu-id="a780f-176">启动 BizTalk 应用程序。</span><span class="sxs-lookup"><span data-stu-id="a780f-176">Start the BizTalk application.</span></span>  
  
 <span data-ttu-id="a780f-177">本主题提供执行这些任务的说明。</span><span class="sxs-lookup"><span data-stu-id="a780f-177">This topic provides instructions to perform these tasks.</span></span>  
  
## <a name="generating-schema"></a><span data-ttu-id="a780f-178">生成架构</span><span class="sxs-lookup"><span data-stu-id="a780f-178">Generating Schema</span></span>  
 <span data-ttu-id="a780f-179">你必须生成 GET_ACTIVITYS 操作的架构。</span><span class="sxs-lookup"><span data-stu-id="a780f-179">You must generate the schema for the GET_ACTIVITYS operation.</span></span> <span data-ttu-id="a780f-180">生成架构使用时执行以下任务[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a780f-180">Perform the following tasks while generating the schema using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>  
  
-   <span data-ttu-id="a780f-181">选择与具有协定类型**服务 （入站操作）**。</span><span class="sxs-lookup"><span data-stu-id="a780f-181">Select the contract type as **Service (Inbound operation)**.</span></span>  
  
-   <span data-ttu-id="a780f-182">生成架构**GET_ACTIVITYS**过程。</span><span class="sxs-lookup"><span data-stu-id="a780f-182">Generate schema for the **GET_ACTIVITYS** procedure.</span></span>  
  
 <span data-ttu-id="a780f-183">有关如何生成架构的详细信息，请参阅[浏览、 搜索和 get 元数据的 Oracle 数据库操作](../../adapters-and-accelerators/adapter-oracle-database/browse-search-and-get-metadata-for-oracle-database-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-183">For more information about how to generate schema, see [Browse, search, and get metadata for Oracle Database operations](../../adapters-and-accelerators/adapter-oracle-database/browse-search-and-get-metadata-for-oracle-database-operations.md).</span></span>  
  
## <a name="defining-messages-and-message-types"></a><span data-ttu-id="a780f-184">定义消息和消息类型</span><span class="sxs-lookup"><span data-stu-id="a780f-184">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="a780f-185">你先前生成的架构描述业务流程中的消息所需的"类型"。</span><span class="sxs-lookup"><span data-stu-id="a780f-185">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="a780f-186">一条消息通常是一个变量，为其类型由相应的架构定义。</span><span class="sxs-lookup"><span data-stu-id="a780f-186">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="a780f-187">后生成架构，你必须将其从 BizTalk 项目的业务流程视图链接到消息中。</span><span class="sxs-lookup"><span data-stu-id="a780f-187">Once the schema is generated, you must link it to the messages from the Orchestration view of the BizTalk project.</span></span>  
  
 <span data-ttu-id="a780f-188">对于本主题中，你必须创建一条消息，用于从 Oracle 接收消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-188">For this topic, you must create one message to receive messages from Oracle.</span></span>  
  
 <span data-ttu-id="a780f-189">执行以下步骤以创建消息并将它们链接到架构。</span><span class="sxs-lookup"><span data-stu-id="a780f-189">Perform the following steps to create messages and link them to schema.</span></span>  
  
#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="a780f-190">创建消息并将链接到架构</span><span class="sxs-lookup"><span data-stu-id="a780f-190">To create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="a780f-191">BizTalk 项目中添加业务流程。</span><span class="sxs-lookup"><span data-stu-id="a780f-191">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="a780f-192">从解决方案资源管理器，右键单击 BizTalk 项目名称，指向**添加**，然后单击**新项**。</span><span class="sxs-lookup"><span data-stu-id="a780f-192">From the Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="a780f-193">键入 BizTalk 业务流程的名称，然后单击**添加**。</span><span class="sxs-lookup"><span data-stu-id="a780f-193">Type a name for the BizTalk orchestration and then click **Add**.</span></span>  
  
2.  <span data-ttu-id="a780f-194">如果尚未打开，请打开 BizTalk 项目的业务流程视图窗口。</span><span class="sxs-lookup"><span data-stu-id="a780f-194">Open the orchestration view window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="a780f-195">单击**视图**，指向**其他窗口**，然后单击**业务流程视图**。</span><span class="sxs-lookup"><span data-stu-id="a780f-195">Click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
3.  <span data-ttu-id="a780f-196">在**业务流程视图**，右键单击**消息**，然后单击**新消息**。</span><span class="sxs-lookup"><span data-stu-id="a780f-196">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  
  
4.  <span data-ttu-id="a780f-197">右键单击新创建的消息中，，然后选择**属性窗口**。</span><span class="sxs-lookup"><span data-stu-id="a780f-197">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
5.  <span data-ttu-id="a780f-198">在**属性**窗格**Message_1**，执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="a780f-198">In the **Properties** pane for **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="a780f-199">使用此选项</span><span class="sxs-lookup"><span data-stu-id="a780f-199">Use this</span></span>|<span data-ttu-id="a780f-200">执行的操作</span><span class="sxs-lookup"><span data-stu-id="a780f-200">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="a780f-201">Identifier</span><span class="sxs-lookup"><span data-stu-id="a780f-201">Identifier</span></span>|<span data-ttu-id="a780f-202">类型**接收**。</span><span class="sxs-lookup"><span data-stu-id="a780f-202">Type **Receive**.</span></span>|  
    |<span data-ttu-id="a780f-203">消息类型</span><span class="sxs-lookup"><span data-stu-id="a780f-203">Message Type</span></span>|<span data-ttu-id="a780f-204">从下拉列表中，展开**架构**，然后选择*Polling.OracleEBSBindingSchema*，其中*轮询*是 BizTalk 项目的名称。</span><span class="sxs-lookup"><span data-stu-id="a780f-204">From the drop-down list, expand **Schemas**, and select *Polling.OracleEBSBindingSchema*, where *Polling* is the name of your BizTalk project.</span></span> <span data-ttu-id="a780f-205">*OracleEBSBindingSchema*是为生成的响应架构**GET_ACTIVITYS**存储过程。</span><span class="sxs-lookup"><span data-stu-id="a780f-205">*OracleEBSBindingSchema* is the response schema generated for the **GET_ACTIVITYS** stored procedure.</span></span><br /><br /> <span data-ttu-id="a780f-206">**重要说明：**因为轮询是单向操作，生成适配器的架构不包含响应节点中，并且因此没有只有一个根节点在架构中。</span><span class="sxs-lookup"><span data-stu-id="a780f-206">**Important:** Because polling is a one way operation, the schema generated by the adapter does not contain a response node, and hence there is only one root node in the schema.</span></span> <span data-ttu-id="a780f-207">如果此类架构用于消息类型，必须通过生成的架构的文件名来标识的架构。</span><span class="sxs-lookup"><span data-stu-id="a780f-207">If you use such schemas for a message type, you must identify the schema by the filename of the generated schema.</span></span><br /><br /> <span data-ttu-id="a780f-208">例如，如果你创建双向操作的架构，架构中的节点使用文件名称`OracleEBSBindingSchema`可能看起来像"请求"和"响应"。</span><span class="sxs-lookup"><span data-stu-id="a780f-208">For example, if you create schema for a two-way operation, the nodes in the schema file with a name `OracleEBSBindingSchema` may look like “Request” and “Response”.</span></span> <span data-ttu-id="a780f-209">如果你想要在业务流程映射到的请求架构中创建一条消息，你可以通过查找来确定在列表中的架构`OracleEBSBindingSchema.Request`。</span><span class="sxs-lookup"><span data-stu-id="a780f-209">If you want to create a message in the orchestration that maps to the request schema, you can identify the schema in the list by looking for `OracleEBSBindingSchema.Request`.</span></span> <span data-ttu-id="a780f-210">但是，在轮询操作时，因为的唯一节点的"轮询"，它不是轻松地标识你想要映射到，因为具有单个节点的架构不会作为列出的架构\<schemafilename\>。\<rootnodename\>。</span><span class="sxs-lookup"><span data-stu-id="a780f-210">However, in the case of polling operation, because the only node is “Poll”, it is not easy to identify the schema you want to map to because schemas with single nodes are not listed as \<schemafilename\>.\<rootnodename\>.</span></span> <span data-ttu-id="a780f-211">相反，此类架构仅的文件名按列出。</span><span class="sxs-lookup"><span data-stu-id="a780f-211">Instead, such schemas are listed by only the filename.</span></span> <span data-ttu-id="a780f-212">在这种情况下，唯一的方法来识别的架构是架构文件名，例如，OracleEBSBindingSchema。</span><span class="sxs-lookup"><span data-stu-id="a780f-212">In such a case, the only way to identify the schema is by the schema filename, for example, OracleEBSBindingSchema.</span></span>|  
  
     <span data-ttu-id="a780f-213">[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] GET_ACTIVITYS 的入站和出站操作存储过程生成架构。</span><span class="sxs-lookup"><span data-stu-id="a780f-213">The [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] generates schema for both inbound and outbound operations for the GET_ACTIVITYS stored procedure.</span></span> <span data-ttu-id="a780f-214">入站操作，必须使用架构：</span><span class="sxs-lookup"><span data-stu-id="a780f-214">You must use the schema for inbound operation to:</span></span>  
  
    -   <span data-ttu-id="a780f-215">业务流程的一部分创建将消息映射。</span><span class="sxs-lookup"><span data-stu-id="a780f-215">Map the message created as part of the orchestration.</span></span>  
  
    -   <span data-ttu-id="a780f-216">若要检索你必须为指定的操作**PollingAction**属性绑定在运行时。</span><span class="sxs-lookup"><span data-stu-id="a780f-216">To retrieve the action you must specify for the **PollingAction** binding property at run-time.</span></span>  
  
     <span data-ttu-id="a780f-217">必须使用出站操作的架构来获取请求消息必须指定作为的一部分**PollingStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-217">You must use the schema for the outbound operation to get the request message you must specify as part of the **PollingStatement** binding property.</span></span>  
  
## <a name="setting-up-the-orchestration"></a><span data-ttu-id="a780f-218">设置业务流程</span><span class="sxs-lookup"><span data-stu-id="a780f-218">Setting up the Orchestration</span></span>  
 <span data-ttu-id="a780f-219">你必须创建要使用 BizTalk 业务流程[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]用于从 Oracle 接收基于轮询的数据更改消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-219">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for receiving polling-based data-change messages from Oracle.</span></span> <span data-ttu-id="a780f-220">在此业务流程，适配器将通过执行存储的过程的一部分的请求消息指定为其接收响应**PollingStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-220">In this orchestration, the adapter receives the response by executing the stored procedure for which you specified the request message as part of the **PollingStatement** binding property.</span></span> <span data-ttu-id="a780f-221">存储过程的响应消息保存到文件位置。</span><span class="sxs-lookup"><span data-stu-id="a780f-221">The response message for the stored procedure is saved to a FILE location.</span></span> <span data-ttu-id="a780f-222">将包含轮询 Oracle 数据库典型业务流程：</span><span class="sxs-lookup"><span data-stu-id="a780f-222">A typical orchestration for polling Oracle database would contain:</span></span>  
  
-   <span data-ttu-id="a780f-223">接收和发送形状从 Oracle 接收消息并分别将发送到文件端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-223">Receive and Send shapes to receive messages from Oracle and send to a FILE port, respectively.</span></span>  
  
-   <span data-ttu-id="a780f-224">单向接收端口从 Oracle 数据库接收消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-224">A one-way receive port to receive messages from Oracle database.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="a780f-225">你始终必须配置的入站的轮询方案单向接收端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-225">For inbound polling scenarios you must always configure a one-way receive port.</span></span> <span data-ttu-id="a780f-226">双向接收入站操作不支持端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-226">Two-way receive ports are not supported for inbound operations.</span></span>  
  
-   <span data-ttu-id="a780f-227">要从 Oracle 数据库发送轮询响应单向发送端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-227">A one-way send port to send polling responses from Oracle database.</span></span>  
  
 <span data-ttu-id="a780f-228">示例业务流程如下所示。</span><span class="sxs-lookup"><span data-stu-id="a780f-228">A sample orchestration resembles the following.</span></span>  
  
 <span data-ttu-id="a780f-229">![适用于 Oracle 轮询查询的业务流程](../../adapters-and-accelerators/adapter-oracle-database/media/6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3.gif "6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3")</span><span class="sxs-lookup"><span data-stu-id="a780f-229">![Orchestration for a polling query for Oracle](../../adapters-and-accelerators/adapter-oracle-database/media/6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3.gif "6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3")</span></span>  
  
### <a name="adding-message-shapes"></a><span data-ttu-id="a780f-230">添加消息形状</span><span class="sxs-lookup"><span data-stu-id="a780f-230">Adding Message Shapes</span></span>  
 <span data-ttu-id="a780f-231">请确保为每个消息形状指定以下属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-231">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="a780f-232">刚提到业务流程中所示，形状列中列出的名称将是消息形状的名称。</span><span class="sxs-lookup"><span data-stu-id="a780f-232">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  
  
|<span data-ttu-id="a780f-233">形状</span><span class="sxs-lookup"><span data-stu-id="a780f-233">Shape</span></span>|<span data-ttu-id="a780f-234">形状类型</span><span class="sxs-lookup"><span data-stu-id="a780f-234">Shape Type</span></span>|<span data-ttu-id="a780f-235">属性</span><span class="sxs-lookup"><span data-stu-id="a780f-235">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="a780f-236">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="a780f-236">ReceiveMessage</span></span>|<span data-ttu-id="a780f-237">Receive</span><span class="sxs-lookup"><span data-stu-id="a780f-237">Receive</span></span>|<span data-ttu-id="a780f-238">-将设置**名称**到*ReceiveMessage*</span><span class="sxs-lookup"><span data-stu-id="a780f-238">- Set **Name** to *ReceiveMessage*</span></span><br /><br /> <span data-ttu-id="a780f-239">-将设置**激活**到*True*</span><span class="sxs-lookup"><span data-stu-id="a780f-239">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="a780f-240">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="a780f-240">SaveMessage</span></span>|<span data-ttu-id="a780f-241">Send</span><span class="sxs-lookup"><span data-stu-id="a780f-241">Send</span></span>|<span data-ttu-id="a780f-242">-将设置**名称**到*SaveMessage*</span><span class="sxs-lookup"><span data-stu-id="a780f-242">- Set **Name** to *SaveMessage*</span></span>|  
  
### <a name="adding-ports"></a><span data-ttu-id="a780f-243">添加端口</span><span class="sxs-lookup"><span data-stu-id="a780f-243">Adding Ports</span></span>  
 <span data-ttu-id="a780f-244">请确保为每个逻辑端口指定以下属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-244">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="a780f-245">端口列中列出的名称是在业务流程中显示的端口的名称。</span><span class="sxs-lookup"><span data-stu-id="a780f-245">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  
  
|<span data-ttu-id="a780f-246">端口</span><span class="sxs-lookup"><span data-stu-id="a780f-246">Port</span></span>|<span data-ttu-id="a780f-247">属性</span><span class="sxs-lookup"><span data-stu-id="a780f-247">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="a780f-248">OracleReceivePort</span><span class="sxs-lookup"><span data-stu-id="a780f-248">OracleReceivePort</span></span>|<span data-ttu-id="a780f-249">-将设置**标识符**到*OracleReceivePort*</span><span class="sxs-lookup"><span data-stu-id="a780f-249">- Set **Identifier** to *OracleReceivePort*</span></span><br /><br /> <span data-ttu-id="a780f-250">-将设置**类型**到*OracleReceivePortType*</span><span class="sxs-lookup"><span data-stu-id="a780f-250">- Set **Type** to *OracleReceivePortType*</span></span><br /><br /> <span data-ttu-id="a780f-251">-将设置**通信模式**到*单向*</span><span class="sxs-lookup"><span data-stu-id="a780f-251">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="a780f-252">-将设置**通信方向**到*接收*</span><span class="sxs-lookup"><span data-stu-id="a780f-252">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="a780f-253">SaveMessagePort</span><span class="sxs-lookup"><span data-stu-id="a780f-253">SaveMessagePort</span></span>|<span data-ttu-id="a780f-254">-将设置**标识符**到*SaveMessagePort*</span><span class="sxs-lookup"><span data-stu-id="a780f-254">- Set **Identifier** to *SaveMessagePort*</span></span><br /><br /> <span data-ttu-id="a780f-255">-将设置**类型**到*SaveMessagePortType*</span><span class="sxs-lookup"><span data-stu-id="a780f-255">- Set **Type** to *SaveMessagePortType*</span></span><br /><br /> <span data-ttu-id="a780f-256">-将设置**通信模式**到*单向*</span><span class="sxs-lookup"><span data-stu-id="a780f-256">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="a780f-257">-将设置**通信方向**到*发送*</span><span class="sxs-lookup"><span data-stu-id="a780f-257">- Set **Communication Direction** to *Send*</span></span>|  
  
### <a name="specify-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="a780f-258">指定消息的操作形状并将连接到端口</span><span class="sxs-lookup"><span data-stu-id="a780f-258">Specify Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="a780f-259">下表指定的属性和用于指定操作形状的消息，并链接到的端口的消息应设置其值。</span><span class="sxs-lookup"><span data-stu-id="a780f-259">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="a780f-260">前面提到的业务流程中所示，形状列中列出的名称将是消息形状的名称。</span><span class="sxs-lookup"><span data-stu-id="a780f-260">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  
  
|<span data-ttu-id="a780f-261">形状</span><span class="sxs-lookup"><span data-stu-id="a780f-261">Shape</span></span>|<span data-ttu-id="a780f-262">属性</span><span class="sxs-lookup"><span data-stu-id="a780f-262">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="a780f-263">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="a780f-263">ReceiveMessage</span></span>|<span data-ttu-id="a780f-264">-将设置**消息**到*接收*</span><span class="sxs-lookup"><span data-stu-id="a780f-264">- Set **Message** to *Receive*</span></span><br /><br /> <span data-ttu-id="a780f-265">-将设置**操作**到*OracleReceivePort.Polling.Request*</span><span class="sxs-lookup"><span data-stu-id="a780f-265">- Set **Operation** to *OracleReceivePort.Polling.Request*</span></span>|  
|<span data-ttu-id="a780f-266">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="a780f-266">SaveMessage</span></span>|<span data-ttu-id="a780f-267">-将设置**消息**到*接收*</span><span class="sxs-lookup"><span data-stu-id="a780f-267">- Set **Message** to *Receive*</span></span><br /><br /> <span data-ttu-id="a780f-268">-将设置**操作**到*SaveMessagePort.Polling.Request*</span><span class="sxs-lookup"><span data-stu-id="a780f-268">- Set **Operation** to *SaveMessagePort.Polling.Request*</span></span>|  
  
 <span data-ttu-id="a780f-269">指定这些属性后，连接的消息形状和端口，您的业务流程已完成。</span><span class="sxs-lookup"><span data-stu-id="a780f-269">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  
  
 <span data-ttu-id="a780f-270">现在必须生成 BizTalk 解决方案，并将其部署到[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a780f-270">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="a780f-271">有关详细信息，请参阅[生成和运行业务流程](../../core/building-and-running-orchestrations.md))。</span><span class="sxs-lookup"><span data-stu-id="a780f-271">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md)).</span></span>  
  
## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="a780f-272">配置 BizTalk 应用程序</span><span class="sxs-lookup"><span data-stu-id="a780f-272">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="a780f-273">部署 BizTalk 项目后，业务流程之前创建下列出**业务流程**BizTalk Server 管理控制台窗格中的。</span><span class="sxs-lookup"><span data-stu-id="a780f-273">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="a780f-274">必须使用 BizTalk Server 管理控制台配置该应用程序。</span><span class="sxs-lookup"><span data-stu-id="a780f-274">You must use the BizTalk Server Administration console to configure the application.</span></span> <span data-ttu-id="a780f-275">有关演练，请参阅[演练： 将基本的 BizTalk 应用程序部署](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-275">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>
  
 <span data-ttu-id="a780f-276">配置应用程序涉及：</span><span class="sxs-lookup"><span data-stu-id="a780f-276">Configuring an application involves:</span></span>  
  
-   <span data-ttu-id="a780f-277">选择应用程序的主机。</span><span class="sxs-lookup"><span data-stu-id="a780f-277">Selecting a host for the application.</span></span>  
  
-   <span data-ttu-id="a780f-278">映射到在 BizTalk Server 管理控制台中的物理端口业务流程中创建的端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-278">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="a780f-279">对于此业务流程，您必须：</span><span class="sxs-lookup"><span data-stu-id="a780f-279">For this orchestration you must:</span></span>  
  
    -   <span data-ttu-id="a780f-280">硬盘和其中 BizTalk 业务流程将从 Oracle 丢弃消息的相应文件端口上定义的位置。</span><span class="sxs-lookup"><span data-stu-id="a780f-280">Define a location on the hard disk and a corresponding FILE port where the BizTalk orchestration will drop the messages from Oracle.</span></span> <span data-ttu-id="a780f-281">这些消息将以响应接收端口指定轮询语句。</span><span class="sxs-lookup"><span data-stu-id="a780f-281">These messages will be in response to the polling statement that you specify for the receive port.</span></span>  
  
    -   <span data-ttu-id="a780f-282">定义一个物理 WCF 自定义或 WCF OracleDB 单向接收端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-282">Define a physical WCF-Custom or WCF-OracleDB one-way receive port.</span></span> <span data-ttu-id="a780f-283">此端口轮询 Oracle 数据库。</span><span class="sxs-lookup"><span data-stu-id="a780f-283">This port polls the Oracle database.</span></span> <span data-ttu-id="a780f-284">有关如何创建接收端口，请参阅[手动配置到 Oracle 数据库适配器的物理端口绑定](../../adapters-and-accelerators/adapter-oracle-database/manually-configure-a-physical-port-binding-to-the-oracle-database-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-284">For information about how to create receive ports, see [Manually configure a physical port binding to the Oracle Database Adapter](../../adapters-and-accelerators/adapter-oracle-database/manually-configure-a-physical-port-binding-to-the-oracle-database-adapter.md).</span></span> <span data-ttu-id="a780f-285">请确保指定的接收端口的以下绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-285">Make sure you specify the following binding properties for the receive port.</span></span>  
  
        |<span data-ttu-id="a780f-286">绑定属性</span><span class="sxs-lookup"><span data-stu-id="a780f-286">Binding Property</span></span>|<span data-ttu-id="a780f-287">值</span><span class="sxs-lookup"><span data-stu-id="a780f-287">Value</span></span>|  
        |----------------------|-----------|  
        |<span data-ttu-id="a780f-288">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="a780f-288">**InboundOperationType**</span></span>|<span data-ttu-id="a780f-289">将其设置为**轮询**。</span><span class="sxs-lookup"><span data-stu-id="a780f-289">Set this to **Polling**.</span></span>|  
        |<span data-ttu-id="a780f-290">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="a780f-290">**PolledDataAvailableStatement**</span></span>|<span data-ttu-id="a780f-291">此示例中，此绑定属性设置为：</span><span class="sxs-lookup"><span data-stu-id="a780f-291">For this example, set this binding property to:</span></span><br /><br /> `SELECT COUNT (*) FROM ACCOUNTACTIVITY`<br /><br /> <span data-ttu-id="a780f-292">这可确保仅当 ACCOUNTACTIVITY 表具有某些记录时，适配器都将执行轮询语句。</span><span class="sxs-lookup"><span data-stu-id="a780f-292">This ensures that the adapter executes the polling statement only when the ACCOUNTACTIVITY table has some records.</span></span>|  
        |<span data-ttu-id="a780f-293">**PollingAction**</span><span class="sxs-lookup"><span data-stu-id="a780f-293">**PollingAction**</span></span>|<span data-ttu-id="a780f-294">从为 GET_ACTIVITYS 过程的入站消息生成的架构中检索轮询操作。</span><span class="sxs-lookup"><span data-stu-id="a780f-294">Retrieve the polling action from the schema generated for the inbound message for the GET_ACTIVITYS procedure.</span></span> <span data-ttu-id="a780f-295">对于此示例中，此绑定属性设置为**http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/PollingPackage//ACCOUNT_PKG/GET_ACTIVITYS**。</span><span class="sxs-lookup"><span data-stu-id="a780f-295">For this example, set this binding property to **http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/PollingPackage/ /ACCOUNT_PKG/GET_ACTIVITYS**.</span></span>|  
        |<span data-ttu-id="a780f-296">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="a780f-296">**PollingStatement**</span></span>|<span data-ttu-id="a780f-297">此绑定属性，指定要调用 GET_ACTIVITYS 的请求消息存储过程。</span><span class="sxs-lookup"><span data-stu-id="a780f-297">For this binding property, specify the request message to invoke the GET_ACTIVITYS stored procedure.</span></span> <span data-ttu-id="a780f-298">你可以获取请求消息从架构生成的出站操作[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a780f-298">You can get the request message from the schema for the outbound operation generated by the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="a780f-299">你必须为此绑定属性作为输入提供整个 XML 消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-299">You must provide the entire XML message as an input for this binding property.</span></span> <span data-ttu-id="a780f-300">此示例中，此绑定属性设置为：</span><span class="sxs-lookup"><span data-stu-id="a780f-300">For this example, set this binding property to:</span></span><br /><br /> `<GET_ACTIVITYS xmlns="http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/Package/ACCOUNT_PKG/GET_ACTIVITY">   <INRECS>OPEN ? FOR SELECT * FROM ACCOUNTACTIVITY</INRECS> </GET_ACTIVITYS>`<br /><br /> <span data-ttu-id="a780f-301">GET_ACTIVITYS 参数作为存储过程采用输入的 REF CURSOR。</span><span class="sxs-lookup"><span data-stu-id="a780f-301">The GET_ACTIVITYS stored procedure takes an input REF CURSOR as parameter.</span></span>|  
        |<span data-ttu-id="a780f-302">**PostPollStatement**</span><span class="sxs-lookup"><span data-stu-id="a780f-302">**PostPollStatement**</span></span>|<span data-ttu-id="a780f-303">指定要从 ACCOUNTACTIVITY 表的所有数据都移到另一个表的后期轮询声明。</span><span class="sxs-lookup"><span data-stu-id="a780f-303">Specify the post-poll statement to move all data from ACCOUNTACTIVITY table to another table.</span></span> <span data-ttu-id="a780f-304">此示例中，此绑定属性设置为：</span><span class="sxs-lookup"><span data-stu-id="a780f-304">For this example, set this binding property to:</span></span><br /><br /> `BEGIN ACCOUNT_PKG.PROCESS_ACTIVITY(); END;`|  
  
         <span data-ttu-id="a780f-305">有关不同的绑定属性的详细信息，请参阅[阅读有关 Oracle 数据库适配器绑定属性](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-305">For more information about the different binding properties, see [Read about the Oracle Database adapter binding properties](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md).</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="a780f-306">我们建议在执行使用的入站的操作时配置的事务隔离级别和事务超时[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a780f-306">We recommend configuring the transaction isolation level and the transaction timeout while performing inbound operations using the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)].</span></span> <span data-ttu-id="a780f-307">你可以这样做通过配置接收端口时添加的服务行为。</span><span class="sxs-lookup"><span data-stu-id="a780f-307">You can do so by adding the service behavior while configuring the receive port.</span></span> <span data-ttu-id="a780f-308">有关如何添加服务行为的说明，请参阅[配置事务隔离级别和事务超时](../../adapters-and-accelerators/adapter-oracle-database/configure-transaction-isolation-level-and-transaction-timeout-with-oracle-db.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-308">For instruction on how to add the service behavior, see [Configure transaction isolation level and transaction timeout](../../adapters-and-accelerators/adapter-oracle-database/configure-transaction-isolation-level-and-transaction-timeout-with-oracle-db.md).</span></span>  
  
## <a name="starting-the-application"></a><span data-ttu-id="a780f-309">启动应用程序</span><span class="sxs-lookup"><span data-stu-id="a780f-309">Starting the Application</span></span>  
 <span data-ttu-id="a780f-310">你必须启动轮询 Oracle 数据库的 BizTalk 应用程序。</span><span class="sxs-lookup"><span data-stu-id="a780f-310">You must start the BizTalk application for polling Oracle database.</span></span> <span data-ttu-id="a780f-311">有关启动 BizTalk 应用程序的说明，请参阅[如何启动 Orchestration](../../core/how-to-start-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-311">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>  
  
 <span data-ttu-id="a780f-312">在此阶段，请确保：</span><span class="sxs-lookup"><span data-stu-id="a780f-312">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="a780f-313">WCF 自定义或 WCF OracleDB 单向接收端口，从而轮询使用为指定的存储的过程的 Oracle **PollingStatement**绑定属性，正在运行。</span><span class="sxs-lookup"><span data-stu-id="a780f-313">The WCF-Custom or WCF-OracleDB one-way receive port, which polls Oracle using the stored procedure specified for the **PollingStatement** binding property, is running.</span></span>  
  
-   <span data-ttu-id="a780f-314">文件发送端口，从而从 Oracle 数据库中接收消息，正在运行。</span><span class="sxs-lookup"><span data-stu-id="a780f-314">The FILE send port, which receives messages from Oracle database, is running.</span></span>  
  
-   <span data-ttu-id="a780f-315">BizTalk 业务流程操作正在运行。</span><span class="sxs-lookup"><span data-stu-id="a780f-315">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="executing-the-operation"></a><span data-ttu-id="a780f-316">执行该操作</span><span class="sxs-lookup"><span data-stu-id="a780f-316">Executing the Operation</span></span>  
 <span data-ttu-id="a780f-317">运行应用程序后，下面的一组操作需要置于相同的序列：</span><span class="sxs-lookup"><span data-stu-id="a780f-317">After you run the application, the following set of actions take place, in the same sequence:</span></span>  
  
-   <span data-ttu-id="a780f-318">适配器执行**PolledDataAvailableStatement**它返回一个正值，该值指示要执行的语句，为指定的适配器**PollingStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-318">The adapter executes the **PolledDataAvailableStatement** which returns a positive value indicating the adapter to execute the statement specified for **PollingStatement** binding property.</span></span>  
  
-   <span data-ttu-id="a780f-319">适配器执行为指定的存储的 GET_ACTIVITYS 过程**PollingStatement** ACCOUNTACTIVITY 表中的绑定属性，并返回所有行。</span><span class="sxs-lookup"><span data-stu-id="a780f-319">The adapter executes the GET_ACTIVITYS stored procedure specified for the **PollingStatement** binding property and returns all the rows in the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="a780f-320">从 Oracle 数据库响应如下所示：</span><span class="sxs-lookup"><span data-stu-id="a780f-320">The response from Oracle database resembles the following:</span></span>  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <GET_ACTIVITYS xmlns=" http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/PollingPackage/ACCOUNT_PKG">  
      <OUTRECS>  
        <OUTRECSRecord xmlns=" http://Microsoft.LobServices.OracleDB/2007/03/ReferencedRecordTypes/SCOTT/ACCOUNT_PKG/GET_ACTIVITYS/SCOTT/GET_ACTIVITYS">  
          <TID>1</TID>   
          <ACCOUNT>100001</ACCOUNT>   
          <AMOUNT>500</AMOUNT>   
          <DESCRIPTION />   
          <TRANSDATE>2008-06-21T15:52:19</TRANSDATE>   
          <PROCESSED>n</PROCESSED>   
        </OUTRECSRecord>  
        <OUTRECSRecord xmlns=" http://Microsoft.LobServices.OracleDB/2007/03/ReferencedRecordTypes/SCOTT/ACCOUNT_PKG/GET_ACTIVITYS/SCOTT/GET_ACTIVITYS">  
          ......  
          ......   
        </OUTRECSRecord>  
        ......  
        ......  
      </OUTRECS>  
    </GET_ACTIVITYS>  
    ```  
  
-   <span data-ttu-id="a780f-321">适配器执行后轮询语句，它将所有数据从 ACCOUNTACTIVITY 表都移动到另一个表。</span><span class="sxs-lookup"><span data-stu-id="a780f-321">The adapter executes the post-poll statement, which moves all the data from ACCOUNTACTIVITY table to another table.</span></span>  
  
-   <span data-ttu-id="a780f-322">轮询间隔后，该适配器再次执行**PolledDataAvailableStatement**。</span><span class="sxs-lookup"><span data-stu-id="a780f-322">After the polling interval, the adapter again executes **PolledDataAvailableStatement**.</span></span> <span data-ttu-id="a780f-323">因为 ACCOUNTACTIVITY 表中不有任何记录现在， **PolledDataAvailableStatement**不返回一个正值，并且因此适配器不执行为指定的语句**PollingStatement**绑定属性。</span><span class="sxs-lookup"><span data-stu-id="a780f-323">Because ACCOUNTACTIVITY table has no records now, **PolledDataAvailableStatement** does not return a positive value and hence the adapter does not execute the statement specified for the **PollingStatement** binding property.</span></span> <span data-ttu-id="a780f-324">因此，适配器客户端不会获取任何轮询消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-324">As a result, adapter client does not get any polling message.</span></span>  
  
-   <span data-ttu-id="a780f-325">适配器客户端不会获得更多的轮询消息，直到某些记录显式插入 ACCOUNTACTIVITY 表。</span><span class="sxs-lookup"><span data-stu-id="a780f-325">The adapter client will not get any more polling messages until some records are explicitly inserted into the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="a780f-326">要插入更多的记录，你可以运行这些示例使用提供的 more_activity_data.sql 脚本。</span><span class="sxs-lookup"><span data-stu-id="a780f-326">To insert more records, you can run the more_activity_data.sql script provided with the samples.</span></span> <span data-ttu-id="a780f-327">运行此脚本下, 一次后**PolledDataAvailableStatement**是执行，返回一个正值。</span><span class="sxs-lookup"><span data-stu-id="a780f-327">After you run this script, the next time **PolledDataAvailableStatement** is executed, it returns a positive value.</span></span> <span data-ttu-id="a780f-328">因此，适配器执行轮询的语句，适配器客户端可能再次收到轮询消息。</span><span class="sxs-lookup"><span data-stu-id="a780f-328">As a result, the adapter executes the polling statement and adapter clients again receive a polling message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a780f-329">[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]将继续轮询除非你显式禁用接收端口从[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="a780f-329">The [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] will continue to poll until you explicitly disable the receive port from the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="a780f-330">最佳实践</span><span class="sxs-lookup"><span data-stu-id="a780f-330">Best Practices</span></span>  
 <span data-ttu-id="a780f-331">已部署并配置 BizTalk 项目之后，你可以将配置设置导出到 XML 文件称为绑定文件。</span><span class="sxs-lookup"><span data-stu-id="a780f-331">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the bindings file.</span></span> <span data-ttu-id="a780f-332">一旦生成绑定文件，你可以从文件导的配置设置，以便不需要创建发送端口和接收相同的业务流程的端口。</span><span class="sxs-lookup"><span data-stu-id="a780f-332">Once you generate a bindings file, you can import the configuration settings from the file so that you do not need to create the send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="a780f-333">有关绑定文件的详细信息，请参阅[重复使用 Oracle 数据库适配器绑定](../../adapters-and-accelerators/adapter-oracle-database/reuse-oracle-database-adapter-bindings.md)。</span><span class="sxs-lookup"><span data-stu-id="a780f-333">For more information about binding files, see [Reuse Oracle Database Adapter bindings](../../adapters-and-accelerators/adapter-oracle-database/reuse-oracle-database-adapter-bindings.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a780f-334">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a780f-334">See Also</span></span>  
 [<span data-ttu-id="a780f-335">使用 BizTalk Server 轮询 Oracle 数据库</span><span class="sxs-lookup"><span data-stu-id="a780f-335">Poll Oracle Database using BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-oracle-database/poll-oracle-database-using-biztalk-server.md)