---
title: 升级到 BizTalk Server 2016 |Microsoft Docs
ms.custom: ''
ms.prod: biztalk-server
ms.date: 06/08/2017
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 975ec82b-ed27-4545-8e4a-0e567507c9ba
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a545f03f480a2cade3d609feb085449ab9a2f726
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65401442"
---
# <a name="upgrade-to-biztalk-server-2016"></a><span data-ttu-id="6dbe7-102">升级到 BizTalk Server 2016</span><span class="sxs-lookup"><span data-stu-id="6dbe7-102">Upgrade to BizTalk Server 2016</span></span>
<span data-ttu-id="6dbe7-103">升级到[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]从[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]，或 BizTalk Server 2013。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-103">Upgrading to [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] from [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)], or BizTalk Server 2013.</span></span>

<span data-ttu-id="6dbe7-104">本主题概述的[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]升级过程中，密钥信息和从 BizTalk Server 2013 R2 或 BizTalk Server 2013 升级的分步说明。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-104">This topic provides an overview of the [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] upgrade process, key information, and step-by-step instructions for upgrading from BizTalk Server 2013 R2 or BizTalk Server 2013.</span></span>


## <a name="upgrade-overview"></a><span data-ttu-id="6dbe7-105">升级概述</span><span class="sxs-lookup"><span data-stu-id="6dbe7-105">Upgrade overview</span></span>

- <span data-ttu-id="6dbe7-106">在升级之前，请阅读整篇文档。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-106">Read this entire document before you upgrade.</span></span> <span data-ttu-id="6dbe7-107">BizTalk Server 将很多不同的组件，内部和外部，连接到你的企业。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-107">BizTalk Server connects many disparate components, both internal and external, to your enterprise.</span></span> <span data-ttu-id="6dbe7-108">大多数实际的部署方案都会进一步扩展以包括多个服务器，最终包括物理和虚拟计算机群集。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-108">Most real-world deployment scenarios extend much farther to include multiple servers and eventually clusters of both physical and virtual computers.</span></span>

- <span data-ttu-id="6dbe7-109">没有两个 BizTalk Server 部署是相同的。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-109">No two BizTalk Server deployments are the same.</span></span> <span data-ttu-id="6dbe7-110">在升级之前，您企业的需求，收集信息并讨论使用 IT 专业人员、 系统管理员和开发人员使用 BizTalk Server 部署的作用域。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-110">Before you upgrade, gather information on your enterprise needs, and discuss the scope of your deployment with the IT Professionals, System Administrators, and Developers who use BizTalk Server.</span></span> <span data-ttu-id="6dbe7-111">通过学习此升级指南，并确定企业的具体需求，您将创建自己的部署指南。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-111">By studying this upgrade guide, and determining the specific needs of your enterprise, you are creating your own deployment roadmap.</span></span>

- <span data-ttu-id="6dbe7-112">使用 BizTalk Server 最佳做法分析器 (BPA) 来检查 BizTalk Server 部署，并生成一系列最佳实践。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-112">Use the BizTalk Server Best Practices Analyzer (BPA) to examine a BizTalk Server deployment, and generate a list of best practices.</span></span> <span data-ttu-id="6dbe7-113">BPA 只，通过读取和报告方式执行配置级别验证，并使用收集到的数据来确定是否遵循最佳实践。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-113">BPA performs configuration-level verification, by reading and reporting only, and uses the gathered data to determine whether best practices are being followed.</span></span>

### <a name="planning-your-upgrade"></a><span data-ttu-id="6dbe7-114">规划升级</span><span class="sxs-lookup"><span data-stu-id="6dbe7-114">Planning your upgrade</span></span>

<span data-ttu-id="6dbe7-115">下面是升级过程的高级视图。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-115">The following is a high-level view of the upgrade process.</span></span> <span data-ttu-id="6dbe7-116">必须按照所示顺序运行每个列出的步骤。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-116">Each of the steps listed must be run in the order shown.</span></span>

- <span data-ttu-id="6dbe7-117">操作系统升级路径</span><span class="sxs-lookup"><span data-stu-id="6dbe7-117">Operating systems upgrade paths</span></span>
- <span data-ttu-id="6dbe7-118">Microsoft SQL Server® 的升级路径</span><span class="sxs-lookup"><span data-stu-id="6dbe7-118">Microsoft SQL Server® upgrade paths</span></span>
- <span data-ttu-id="6dbe7-119">Windows® SharePoint® Services 升级</span><span class="sxs-lookup"><span data-stu-id="6dbe7-119">Windows® SharePoint® Services upgrade</span></span>
- <span data-ttu-id="6dbe7-120">安装 Visual Studio 并行</span><span class="sxs-lookup"><span data-stu-id="6dbe7-120">Install Visual Studio side-by-side</span></span>
- <span data-ttu-id="6dbe7-121">安装 Microsoft Office 2016、office 2013年并行</span><span class="sxs-lookup"><span data-stu-id="6dbe7-121">Install Microsoft Office 2016/2013 side-by-side</span></span>

### <a name="supported-upgrade-paths"></a><span data-ttu-id="6dbe7-122">支持的升级路径</span><span class="sxs-lookup"><span data-stu-id="6dbe7-122">Supported upgrade paths</span></span>
<span data-ttu-id="6dbe7-123">下表列出了支持的操作系统可以升级到[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-123">The following table lists the supported operating systems that can be upgraded to [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span> <span data-ttu-id="6dbe7-124">"是"表示在该操作系统上运行的 BizTalk Server 版本可以升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-124">“Yes” means the BizTalk Server version running on that operating system can be upgraded.</span></span> <span data-ttu-id="6dbe7-125">"否"表示不能升级在该操作系统上运行的 BizTalk Server 版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-125">“No” means the BizTalk Server version running on that operating system cannot be upgraded.</span></span> <span data-ttu-id="6dbe7-126">如果是"否"，必须在受支持的操作系统上重新创建 BizTalk 环境。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-126">When “No”, the BizTalk environment must be recreated on a supported operating system.</span></span>  <span data-ttu-id="6dbe7-127">[硬件和软件要求 BizTalk Server 2016 的](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md)列出了支持的操作系统。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-127">[Hardware and Software Requirements for BizTalk Server 2016](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md) lists the supported operating systems.</span></span>

| <span data-ttu-id="6dbe7-128">操作系统</span><span class="sxs-lookup"><span data-stu-id="6dbe7-128">Operating Systems</span></span> | <span data-ttu-id="6dbe7-129">BizTalk Server 2013 R2</span><span class="sxs-lookup"><span data-stu-id="6dbe7-129">BizTalk Server 2013 R2</span></span> |<span data-ttu-id="6dbe7-130">BizTalk Server 2013</span><span class="sxs-lookup"><span data-stu-id="6dbe7-130">BizTalk Server 2013</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6dbe7-131">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="6dbe7-131">Windows Server 2012 R2</span></span> | <span data-ttu-id="6dbe7-132">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-132">Yes</span></span> | <span data-ttu-id="6dbe7-133">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-133">No</span></span> |
| <span data-ttu-id="6dbe7-134">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="6dbe7-134">Windows Server 2012</span></span> | <span data-ttu-id="6dbe7-135">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-135">No</span></span> | <span data-ttu-id="6dbe7-136">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-136">No</span></span> |
| <span data-ttu-id="6dbe7-137">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="6dbe7-137">Windows 8.1</span></span> | <span data-ttu-id="6dbe7-138">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-138">Yes</span></span> | <span data-ttu-id="6dbe7-139">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-139">No</span></span> |
| <span data-ttu-id="6dbe7-140">Windows 8</span><span class="sxs-lookup"><span data-stu-id="6dbe7-140">Windows 8</span></span> | <span data-ttu-id="6dbe7-141">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-141">No</span></span> | <span data-ttu-id="6dbe7-142">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-142">No</span></span>
| <span data-ttu-id="6dbe7-143">Windows 7 SP1</span><span class="sxs-lookup"><span data-stu-id="6dbe7-143">Windows 7 SP1</span></span> | <span data-ttu-id="6dbe7-144">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-144">No</span></span> | <span data-ttu-id="6dbe7-145">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-145">No</span></span> |

<span data-ttu-id="6dbe7-146">下表列出了支持的 SQL Server 版本，可以升级到[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-146">The following table lists the supported SQL Server versions that can be upgraded to [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span> <span data-ttu-id="6dbe7-147">SQL Server 可承载 BizTalk Server 使用的数据库。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-147">The SQL Server hosts the databases used by BizTalk Server.</span></span> <span data-ttu-id="6dbe7-148">"是"表示 BizTalk Server 使用该 SQL Server 版本可以升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-148">“Yes” means BizTalk Server using that SQL Server version can be upgraded.</span></span> <span data-ttu-id="6dbe7-149">"否"表示使用该 SQL Server 版本的 BizTalk Server 不可升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-149">“No” means BizTalk Server using that SQL Server version cannot be upgraded.</span></span> <span data-ttu-id="6dbe7-150">如果是"否"，必须支持的 SQL Server 版本上重新创建 BizTalk 环境。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-150">When “No”, the BizTalk environment must be recreated on a supported SQL Server version.</span></span> <span data-ttu-id="6dbe7-151">[硬件和软件要求 BizTalk Server 2016 的](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md)列出了受支持的 SQL Server 版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-151">[Hardware and Software Requirements for BizTalk Server 2016](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md) lists the supported SQL Server versions.</span></span> 

> [!TIP]
> <span data-ttu-id="6dbe7-152">如果您是 SQL Server 版本不受支持，或不在以下列表中，请查看 SQL Server 升级文档。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-152">If you're SQL Server version isn't supported, or isn't in the following list, then review the SQL Server upgrade documentation.</span></span> <span data-ttu-id="6dbe7-153">SQL 升级所适用的更多版本比 BizTalk 支持。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-153">The SQL upgrade covers more versions than what BizTalk supports.</span></span> <span data-ttu-id="6dbe7-154">例如，如果您使用 SQL Server 2008，您可能能够升级 SQL Server 2016。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-154">For example, if you're using SQL Server 2008, you may be able to upgrade SQL Server 2016.</span></span> <span data-ttu-id="6dbe7-155">然后，你可以升级到[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-155">Then, you can upgrade to [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span> <span data-ttu-id="6dbe7-156">[升级到 SQL Server 2016](https://msdn.microsoft.com/library/bb677622.aspx)并[升级到 SQL Server 2014](https://msdn.microsoft.com/library/bb677622(v=sql.120).aspx)列出了可以升级的 SQL Server 版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-156">[Upgrade to SQL Server 2016](https://msdn.microsoft.com/library/bb677622.aspx) and [Upgrade to SQL Server 2014](https://msdn.microsoft.com/library/bb677622(v=sql.120).aspx) lists the SQL Server versions that can be upgraded.</span></span>

| <span data-ttu-id="6dbe7-157">SQL Server</span><span class="sxs-lookup"><span data-stu-id="6dbe7-157">SQL Server</span></span> | <span data-ttu-id="6dbe7-158">BizTalk Server 2013 R2</span><span class="sxs-lookup"><span data-stu-id="6dbe7-158">BizTalk Server 2013 R2</span></span> |<span data-ttu-id="6dbe7-159">BizTalk Server 2013</span><span class="sxs-lookup"><span data-stu-id="6dbe7-159">BizTalk Server 2013</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6dbe7-160">SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="6dbe7-160">SQL Server 2014</span></span> | <span data-ttu-id="6dbe7-161">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-161">Yes</span></span> | <span data-ttu-id="6dbe7-162">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-162">No</span></span> |
| <span data-ttu-id="6dbe7-163">SQL Server 2012 SP1</span><span class="sxs-lookup"><span data-stu-id="6dbe7-163">SQL Server 2012 SP1</span></span>| <span data-ttu-id="6dbe7-164">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-164">No</span></span> | <span data-ttu-id="6dbe7-165">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-165">No</span></span> |
| <span data-ttu-id="6dbe7-166">SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="6dbe7-166">SQL Server 2012</span></span> | <span data-ttu-id="6dbe7-167">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-167">No</span></span> | <span data-ttu-id="6dbe7-168">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-168">No</span></span> |
| <span data-ttu-id="6dbe7-169">SQL Server 2008 R2 SP1</span><span class="sxs-lookup"><span data-stu-id="6dbe7-169">SQL Server 2008 R2 SP1</span></span> | <span data-ttu-id="6dbe7-170">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-170">No</span></span> | <span data-ttu-id="6dbe7-171">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-171">No</span></span> |


<span data-ttu-id="6dbe7-172">下表列出了从受支持的版本升级路径[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 到[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-172">The following table lists the supported Edition upgrade path from [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 to [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span> <span data-ttu-id="6dbe7-173">"是"表示 [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] /2013年版本可以升级到版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-173">“Yes” means the [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 edition can be upgraded to the edition.</span></span> <span data-ttu-id="6dbe7-174">"否"表示 [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] /2013年版本无法升级到版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-174">“No” means the [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 edition cannot be upgraded to the edition.</span></span> <span data-ttu-id="6dbe7-175">如果是"否"，则必须重新创建 BizTalk 环境。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-175">When “No”, the BizTalk environment must be recreated.</span></span>

| <span data-ttu-id="6dbe7-176">BizTalk Server 2013 R2/2013</span><span class="sxs-lookup"><span data-stu-id="6dbe7-176">BizTalk Server 2013 R2/2013</span></span> | <span data-ttu-id="6dbe7-177">BizTalk Server 2016 评估版</span><span class="sxs-lookup"><span data-stu-id="6dbe7-177">BizTalk Server 2016 Evaluation Edition</span></span> | <span data-ttu-id="6dbe7-178">BizTalk Server 2016 分支版</span><span class="sxs-lookup"><span data-stu-id="6dbe7-178">BizTalk Server 2016 Branch Edition</span></span> | <span data-ttu-id="6dbe7-179">BizTalk Server 2016 开发人员版</span><span class="sxs-lookup"><span data-stu-id="6dbe7-179">BizTalk Server 2016 Developer Edition</span></span> | <span data-ttu-id="6dbe7-180">BizTalk Server 2016 标准版</span><span class="sxs-lookup"><span data-stu-id="6dbe7-180">BizTalk Server 2016 Standard Edition</span></span> | <span data-ttu-id="6dbe7-181">BizTalk Server 2016 企业版</span><span class="sxs-lookup"><span data-stu-id="6dbe7-181">BizTalk Server 2016 Enterprise Edition</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="6dbe7-182">Evaluation</span><span class="sxs-lookup"><span data-stu-id="6dbe7-182">Evaluation</span></span> | <span data-ttu-id="6dbe7-183">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-183">No</span></span> | <span data-ttu-id="6dbe7-184">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-184">No</span></span> | <span data-ttu-id="6dbe7-185">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-185">No</span></span> | <span data-ttu-id="6dbe7-186">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-186">No</span></span> | <span data-ttu-id="6dbe7-187">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-187">Yes</span></span> | 
| <span data-ttu-id="6dbe7-188">分支</span><span class="sxs-lookup"><span data-stu-id="6dbe7-188">Branch</span></span> | <span data-ttu-id="6dbe7-189">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-189">No</span></span> | <span data-ttu-id="6dbe7-190">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-190">Yes</span></span> | <span data-ttu-id="6dbe7-191">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-191">No</span></span> | <span data-ttu-id="6dbe7-192">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-192">No</span></span> | <span data-ttu-id="6dbe7-193">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-193">Yes</span></span> | 
| <span data-ttu-id="6dbe7-194">开发人员</span><span class="sxs-lookup"><span data-stu-id="6dbe7-194">Developer</span></span> | <span data-ttu-id="6dbe7-195">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-195">No</span></span> | <span data-ttu-id="6dbe7-196">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-196">No</span></span> | <span data-ttu-id="6dbe7-197">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-197">Yes</span></span> | <span data-ttu-id="6dbe7-198">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-198">No</span></span> | <span data-ttu-id="6dbe7-199">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-199">Yes</span></span> | 
| <span data-ttu-id="6dbe7-200">标准</span><span class="sxs-lookup"><span data-stu-id="6dbe7-200">Standard</span></span> | <span data-ttu-id="6dbe7-201">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-201">No</span></span> | <span data-ttu-id="6dbe7-202">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-202">No</span></span> | <span data-ttu-id="6dbe7-203">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-203">No</span></span> | <span data-ttu-id="6dbe7-204">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-204">Yes</span></span> | <span data-ttu-id="6dbe7-205">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-205">Yes</span></span> | 
| <span data-ttu-id="6dbe7-206">Enterprise</span><span class="sxs-lookup"><span data-stu-id="6dbe7-206">Enterprise</span></span> | <span data-ttu-id="6dbe7-207">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-207">No</span></span> | <span data-ttu-id="6dbe7-208">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-208">No</span></span> | <span data-ttu-id="6dbe7-209">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-209">No</span></span> | <span data-ttu-id="6dbe7-210">否</span><span class="sxs-lookup"><span data-stu-id="6dbe7-210">No</span></span> | <span data-ttu-id="6dbe7-211">是</span><span class="sxs-lookup"><span data-stu-id="6dbe7-211">Yes</span></span> | 

## <a name="before-the-upgrade--what-you-need-to-know"></a><span data-ttu-id="6dbe7-212">升级之前 – 需要知道</span><span class="sxs-lookup"><span data-stu-id="6dbe7-212">Before the upgrade – what you need to know</span></span>


- <span data-ttu-id="6dbe7-213">**权限**:执行升级的用户必须是以下用户组的成员或具有同等权限：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-213">**Permissions**: The user performing the upgrade must be a member of the following user groups or have the equivalent permissions:</span></span>

    - <span data-ttu-id="6dbe7-214">在本地计算机上的 administrators 组</span><span class="sxs-lookup"><span data-stu-id="6dbe7-214">Administrators group on the local computer</span></span>
    - <span data-ttu-id="6dbe7-215">SQL Server 上的 SQL Server 系统管理员组</span><span class="sxs-lookup"><span data-stu-id="6dbe7-215">SQL Server System Administrators group on the SQL Server</span></span>
    - <span data-ttu-id="6dbe7-216">BizTalk Server Administrators 组</span><span class="sxs-lookup"><span data-stu-id="6dbe7-216">BizTalk Server Administrators group</span></span>
    - <span data-ttu-id="6dbe7-217">单一登录 (SSO) 管理员组</span><span class="sxs-lookup"><span data-stu-id="6dbe7-217">Single Sign-On (SSO) Administrators group</span></span>

- <span data-ttu-id="6dbe7-218">**SSO**:单一登录主密钥服务器和 SSO 数据库的宿主 SQL Server 必须运行在升级过程。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-218">**SSO**: The Single Sign-On Master Secret Server and the SQL Server that hosts the SSO database must be running during the upgrade.</span></span>

- <span data-ttu-id="6dbe7-219">**网络服务帐户**:必须具有对 windir%\temp 的写访问权限。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-219">**Network Service Account**: Must have write access to %windir%\temp.</span></span>

- <span data-ttu-id="6dbe7-220">**证书**:备份 Windows 证书存储：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-220">**Certificates**: Back up the Windows certificates store:</span></span>  

    [<span data-ttu-id="6dbe7-221">Windows 7 和 Windows Server 2008 R2:导入证书</span><span class="sxs-lookup"><span data-stu-id="6dbe7-221">Windows 7 and Windows Server 2008 R2: Import a Certificate</span></span>](http://technet.microsoft.com/library/cc754489.aspx)  
    [<span data-ttu-id="6dbe7-222">Windows 7 和 Windows Server 2008 R2:导出证书</span><span class="sxs-lookup"><span data-stu-id="6dbe7-222">Windows 7 and Windows Server 2008 R2: Export a Certificate</span></span>](http://technet.microsoft.com/library/cc730988.aspx)  

- <span data-ttu-id="6dbe7-223">**DTC**:启用 Microsoft 分布式事务处理协调器 (MSDTC) ([用于优化环境的配置后步骤](../install-and-config-guides/post-configuration-steps-to-optimize-your-environment.md))，然后启用入站/出站 DTC 规则：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-223">**DTC**: Enable Microsoft Distributed Transaction Coordinator (MSDTC) ([Post-configuration steps to optimize your environment](../install-and-config-guides/post-configuration-steps-to-optimize-your-environment.md)), and then enable the Inbound/Outbound DTC rules:</span></span>

    1. <span data-ttu-id="6dbe7-224">在服务器管理器中，选择**工具**，然后打开**高级安全 Windows 防火墙**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-224">In Server Manager, select **Tools**, and open **Windows Firewall with Advanced Security**.</span></span>
    2. <span data-ttu-id="6dbe7-225">选择**入站规则**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-225">Select **Inbound Rules**.</span></span>
    3. <span data-ttu-id="6dbe7-226">在中**入站规则**，右键单击**分布式事务处理协调器**\* （根据需要），然后**启用规则**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-226">In **Inbound Rules**, right-click **Distributed Transaction Coordinator** \* (as appropriate), and then **Enable Rule**.</span></span>
    4.  <span data-ttu-id="6dbe7-227">在高级安全 Windows 防火墙中，选择**出站规则**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-227">In Windows Firewall with Advanced Security, select **Outbound Rules**.</span></span>
    5.  <span data-ttu-id="6dbe7-228">在中**出站规则**，右键单击**分布式事务处理协调器**\* （根据需要），然后**启用规则**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-228">In **Outbound Rules**, right-click **Distributed Transaction Coordinator** \* (as appropriate), and then **Enable Rule**.</span></span>

- <span data-ttu-id="6dbe7-229">**SharePoint**:客户端对象模型 (CSOM) 用于连接到 SharePoint 服务。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-229">**SharePoint**: The Client Side Object Model (CSOM) is used to connect to SharePoint Services.</span></span> <span data-ttu-id="6dbe7-230">服务器端对象模型 (SSOM) （web 服务） 中已删除[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-230">The  Server Side Object Model (SSOM) (the web service) is removed in [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span>

    <span data-ttu-id="6dbe7-231">如果使用不支持 CSOM 的 SharePoint 版本，你可以升级到受支持 SharePoint 版本：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-231">If you are using SharePoint versions that doesn't support CSOM, you may be able to upgrade to a supported SharePoint version:</span></span>

    <span data-ttu-id="6dbe7-232">[升级到 SharePoint 2016](https://technet.microsoft.com/library/cc303420(v=office.16).aspx)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-232">[Upgrade to SharePoint 2016](https://technet.microsoft.com/library/cc303420(v=office.16).aspx)</span></span>  
    <span data-ttu-id="6dbe7-233">[升级到 SharePoint 2013](https://technet.microsoft.com/library/cc303420(v=office.15).aspx)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-233">[Upgrade to SharePoint 2013](https://technet.microsoft.com/library/cc303420(v=office.15).aspx)</span></span>

- <span data-ttu-id="6dbe7-234">**.NET framework**:没有通过并行安装.NET Framework 4.5 和.NET Framework 4.6 之间的概念。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-234">**.NET Framework**: There is no concept of side-by-side installation between .NET Framework 4.5 and .NET Framework 4.6.</span></span> <span data-ttu-id="6dbe7-235">.NET Framework 4.6 二进制文件会覆盖.NET Framework 4.5 二进制文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-235">The .NET Framework 4.6 binaries overwrite .NET Framework 4.5 binaries.</span></span> <span data-ttu-id="6dbe7-236">.NET framework 4.6 是[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]要求，并不支持 （和不应安装） 在 BizTalk Server 早期版本中。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-236">.NET Framework 4.6 is a [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] requirement, and is not supported (and should not be installed) in previous BizTalk Server versions.</span></span>

- <span data-ttu-id="6dbe7-237">**Office 2016 和 Office 2013**:[安装和使用不同版本的 Office](https://support.office.com/article/Install-and-use-different-versions-of-Office-on-the-same-PC-6EBB44CE-18A3-43F9-A187-B78C513788BF)同一台计算机上。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-237">**Office 2016 and Office 2013**: [Install and use different versions of Office](https://support.office.com/article/Install-and-use-different-versions-of-Office-on-the-same-PC-6EBB44CE-18A3-43F9-A187-B78C513788BF) on the same computer.</span></span> <span data-ttu-id="6dbe7-238">此外，请查看[这些问题](https://support.microsoft.com/kb/3094527)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-238">Also, check out [these issues](https://support.microsoft.com/kb/3094527).</span></span>

- <span data-ttu-id="6dbe7-239">**BizTalkServerApplication 主机**:升级需要存在默认主机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-239">**BizTalkServerApplication Host**: The upgrade requires the existence of the default host.</span></span> <span data-ttu-id="6dbe7-240">如果与 SQL 适配器关联的默认主机实例发送端口和接收位置删除，将默认主机与 SQL 适配器相关联，然后再升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-240">If the default host instance associated with the SQL Adapter send ports and receive locations is removed, associate the default host to the SQL Adapter before upgrading.</span></span> <span data-ttu-id="6dbe7-241">升级完成后，你可以从列表中删除默认主机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-241">After upgrade is complete, you can remove the default host from the list.</span></span>

- <span data-ttu-id="6dbe7-242">**自定义绑定**:在升级后，用户定义的自定义绑定与早期版本的.NET Framework 生成不可用。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-242">**Custom Bindings**: User-defined custom bindings that are built with earlier versions of the .NET Framework are not available after you upgrade.</span></span> <span data-ttu-id="6dbe7-243">若要使用自定义绑定，手动在.NET Framework 4.6 machine.config 文件中添加自定义绑定。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-243">To use the custom bindings, manually add the custom bindings in the .NET Framework 4.6 machine.config file.</span></span>

- <span data-ttu-id="6dbe7-244">**配置文件**:备份 BizTalk Server 2013 R2/2013年中的所有自定义配置文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-244">**Configuration Files**: Back up all custom configuration files in BizTalk Server 2013 R2/2013.</span></span> <span data-ttu-id="6dbe7-245">BizTalk Server 支持的更改迁移仅在`btsntsvc.exe.config`和`bm.exe.config`文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-245">BizTalk Server supports migration of changes only in the `btsntsvc.exe.config` and `bm.exe.config` files.</span></span>



### <a name="bam-alerts"></a><span data-ttu-id="6dbe7-246">BAM 警报</span><span class="sxs-lookup"><span data-stu-id="6dbe7-246">BAM Alerts</span></span>

<span data-ttu-id="6dbe7-247">使用 BAM 警报需要 SQL Server Database Mail。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-247">SQL Server Database Mail is required to use BAM Alerts.</span></span> <span data-ttu-id="6dbe7-248">如果正在从与通知服务结合使用现有 BAM 警报定义的 SQL 版本升级 SQL Server，然后可以备份 BAM 警报定义，并在升级后部署它们。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-248">If SQL Server is being upgraded from a SQL version that used existing BAM Alert definitions with Notification Services, then you can back up your BAM alert definitions, and deploy them after upgrading.</span></span> <span data-ttu-id="6dbe7-249">使用 BM.exe 命令行工具 (`\Program Files (x86)\Microsoft BizTalk Server <your version>\Tracking`)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-249">Use the BM.exe command line tool (`\Program Files (x86)\Microsoft BizTalk Server <your version>\Tracking`).</span></span> <span data-ttu-id="6dbe7-250">具体步骤包括：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-250">Specific steps include:</span></span>

1. <span data-ttu-id="6dbe7-251">打开命令提示符并转到`\Program Files (x86)\Microsoft BizTalk Server <your version>\Tracking`。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-251">Open a command prompt and go to `\Program Files (x86)\Microsoft BizTalk Server <your version>\Tracking`.</span></span>
2. <span data-ttu-id="6dbe7-252">在命令提示符处创建一个定义文件： `bm.exe get-defxml -FileName:YourBAMDefinition.xml`</span><span class="sxs-lookup"><span data-stu-id="6dbe7-252">Create a definition file in the command prompt: `bm.exe get-defxml -FileName:YourBAMDefinition.xml`</span></span>
3. <span data-ttu-id="6dbe7-253">在[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 配置中，取消对 BAM 警报。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-253">In [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 Configuration, unconfigure BAM Alerts.</span></span>
4. <span data-ttu-id="6dbe7-254">升级到 SQL Server 2016 或 SQL Server 2014 SP1。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-254">Upgrade to SQL Server 2016 or SQL Server 2014 SP1.</span></span>
5. <span data-ttu-id="6dbe7-255">配置 SQL Server Database Mail。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-255">Configure SQL Server Database Mail.</span></span>
6. <span data-ttu-id="6dbe7-256">升级到[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-256">Upgrade to [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span>
7. <span data-ttu-id="6dbe7-257">在[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]配置中，配置 BAM 警报。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-257">In [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] Configuration, configure BAM Alerts.</span></span>
8. <span data-ttu-id="6dbe7-258">部署在命令提示符中保存的定义文件： `bm.exe update-all -DefinitionFile:YourBAMDefinition.xml`</span><span class="sxs-lookup"><span data-stu-id="6dbe7-258">Deploy the saved definition file in the command prompt: `bm.exe update-all -DefinitionFile:YourBAMDefinition.xml`</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6dbe7-259">如果没有中列出的顺序执行以下步骤或创建一个定义文件，必须在 BizTalk Server 升级后重新定义文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-259">If you don’t follow these steps in the order listed or create a definition file, you must recreate the definition files after the BizTalk Server upgrade.</span></span>
> 
> <span data-ttu-id="6dbe7-260">若要查看 BM.exe 帮助，请键入： `bm.exe help`。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-260">To view the BM.exe help, type: `bm.exe help`.</span></span>


### <a name="bam"></a><span data-ttu-id="6dbe7-261">BAM</span><span class="sxs-lookup"><span data-stu-id="6dbe7-261">BAM</span></span> 

- <span data-ttu-id="6dbe7-262">**BAM DTS 包**:停止所有 BAM 数据转换服务 (DTS) 包。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-262">**BAM DTS Packages**: Stop all BAM Data Transformation Services (DTS) packages.</span></span> <span data-ttu-id="6dbe7-263">否则为可能会丢失数据或联机分析处理 (OLAP) 多维数据集可能会损坏。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-263">Otherwise, data may be lost or an online analytical processing (OLAP) cube may corrupt.</span></span> 

- <span data-ttu-id="6dbe7-264">**磁盘空间**:可用磁盘空间应至少是现有 BAM 数据库的大小。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-264">**Disk Space**: The free disk space should be at least the size of the existing BAM databases.</span></span>

- <span data-ttu-id="6dbe7-265">**实时聚合**:如果当前版本的 BizTalk Server 中使用的 BAM 实时聚合且要升级 SQL Server，安装或升级到 SQL Server Enterprise Edition。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-265">**Real-time Aggregations**: If you are using BAM real-time aggregations in your current version of BizTalk Server and are upgrading SQL Server, install or upgrade to the SQL Server Enterprise Edition.</span></span> <span data-ttu-id="6dbe7-266">否则，升级将失败。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-266">Otherwise, the upgrade fails.</span></span>

- <span data-ttu-id="6dbe7-267">**maxTimeout 值**:如果拥有大型 BAM 数据库，更新`maxTimeout`为分布式事务到 machine.config 文件中的值：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-267">**maxTimeout value**: If you have a large BAM database, update the `maxTimeout` value for distributed transactions in your machine.config file to:</span></span>  

    ```
    <system.transactions>
       <machineSettings maxTimeout="23:59:59" />
    </system.transactions>
    ```

- <span data-ttu-id="6dbe7-268">**使用跟踪配置文件编辑器 (TPE) 启用 BAM 跟踪**:在升级后，升级以前部署的跟踪配置文件;但是，不升级相应的侦听器配置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-268">**BAM tracking enabled with Tracking Profile Editor (TPE)**: After you upgrade, tracking profiles that were previously deployed are upgraded; however, their corresponding interceptor configurations are not upgraded.</span></span> <span data-ttu-id="6dbe7-269">任何新截获的 BAM 消息可能仍具有 BizTalk Server 2013 R2/2013年引用。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-269">Any new intercepted BAM messages may still have the BizTalk Server 2013 R2/2013 references.</span></span> <span data-ttu-id="6dbe7-270">若要升级相应的侦听器配置，使用跟踪配置文件编辑器检索活动的配置文件并重新应用该配置文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-270">To upgrade the corresponding interceptor configurations, use the Tracking Profile Editor to retrieve the profile for the activity, and then reapply the profile.</span></span>

- <span data-ttu-id="6dbe7-271">**实时数据工作簿**:如果在升级后，要在 BizTalk Server 2013 R2/2013 中，使用 BAM，您必须手动重新生成实时数据工作簿。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-271">**LiveData Workbook**: If you are using BAM in BizTalk Server 2013 R2/2013, after the upgrade, you must manually regenerate the LiveData Workbook.</span></span> <span data-ttu-id="6dbe7-272">若要重新生成实时数据工作簿：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-272">To regenerate the LiveData Workbook:</span></span>

  1. <span data-ttu-id="6dbe7-273">通过运行以下命令来检索 BAM 定义：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-273">Retrieve the BAM Definition by running the following command:</span></span>  
     `BM get-defxml MyDef.xml`
  2. <span data-ttu-id="6dbe7-274">重新创建数据透视表打开 Microsoft Office Excel，然后选择 BAM 外接程序。导入*MyDef.xml*文件中创建的步骤 (1)，并重新创建数据透视表报表。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-274">Re-create the PivotTable reports by opening Microsoft Office Excel, and then selecting the BAM Add-ins. Import the *MyDef.xml* file created in step (1), and recreate the PivotTable reports.</span></span> <span data-ttu-id="6dbe7-275">保存为新的 BAM 工作簿*MyNewBook.xls*。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-275">Save the new BAM Workbook as *MyNewBook.xls*.</span></span>
  3. <span data-ttu-id="6dbe7-276">通过查找中的数据透视表名称重命名数据透视表报告*MyDef.xml*下`<Caption>`中`<BAMDefinition>\<Extension>\<OWC>\<PivotTableView>\<PivotTable>\<PivotView>\<Label>`路径。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-276">Rename the PivotTable reports by finding the PivotTable names in *MyDef.xml* under `<Caption>` in the  `<BAMDefinition>\<Extension>\<OWC>\<PivotTableView>\<PivotTable>\<PivotView>\<Label>` path.</span></span> <span data-ttu-id="6dbe7-277">使用这些名称重命名数据透视表的报表中*MyNewBook.xls*。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-277">Use these names to rename your PivotTable reports in *MyNewBook.xls*.</span></span>
  4. <span data-ttu-id="6dbe7-278">通过运行以下命令重新生成实时数据工作簿：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-278">Regenerate the LiveData Workbook by running the following command:</span></span>  
     `BM regenerate-livedataworkbook MyNewBook.xls`

     > [!NOTE]
     > <span data-ttu-id="6dbe7-279">不会重新生成实时数据工作簿重新 Excel 项目 （例如，图表） 创建原始实时数据工作簿中。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-279">Regenerated LiveData Workbooks do not recreate the Excel artifacts (for example, charts) in the original LiveData Workbook.</span></span> <span data-ttu-id="6dbe7-280">手动重新创建项目。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-280">Manually recreate the artifacts.</span></span>


### <a name="enterprise-single-sign-on-esso"></a><span data-ttu-id="6dbe7-281">企业单一登录 (ESSO)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-281">Enterprise Single Sign-On (ESSO)</span></span>

|                            <span data-ttu-id="6dbe7-282">应用场景</span><span class="sxs-lookup"><span data-stu-id="6dbe7-282">Scenario</span></span>                            |                                                                                                                                                                                                                                                                                                                                          <span data-ttu-id="6dbe7-283">详细信息</span><span class="sxs-lookup"><span data-stu-id="6dbe7-283">More info</span></span>                                                                                                                                                                                                                                                                                                                                          |
|----------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6dbe7-284">从企业单一登录的早期版本升级</span><span class="sxs-lookup"><span data-stu-id="6dbe7-284">Upgrading from an earlier version of Enterprise Single Sign-on</span></span> | <span data-ttu-id="6dbe7-285">BizTalk Server 包含企业单一登录 (ESSO) 的更新的版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-285">BizTalk Server includes an updated version of Enterprise Single Sign-On (ESSO).</span></span> <span data-ttu-id="6dbe7-286">如果使用早期版本的 BizTalk 的计算机上安装此版本中，则 ESSO 自动更新在安装过程。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-286">If you are installing this release on a computer with an earlier version of BizTalk, ESSO is automatically updated during setup.</span></span> <span data-ttu-id="6dbe7-287">我们建议你在升级之前执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-287">We recommend that you perform the following steps before upgrading:</span></span> <br/><br/> <span data-ttu-id="6dbe7-288">1.验证单一登录数据库 (SSODB) 的当前版本备份到安全位置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-288">1. Verify that a current version of the Single Sign-On database (SSODB) is backed up to a secure location.</span></span> <br/><span data-ttu-id="6dbe7-289">2.验证当前的主密钥备份到安全位置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-289">2. Verify that the current master secret key is backed up to a secure location.</span></span><br/><span data-ttu-id="6dbe7-290">3.知道主密钥的密码。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-290">3. Know the password to the master secret.</span></span><br/><br/><span data-ttu-id="6dbe7-291">在 BizTalk 组中的所有服务器都升级到同一版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-291">Upgrade all the servers in a BizTalk group to the same release.</span></span> <span data-ttu-id="6dbe7-292">此要求也适用于独立主密钥服务器。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-292">This requirement also applies to a standalone master secret server.</span></span> |
|  <span data-ttu-id="6dbe7-293">使用企业单一登录独立安装程序升级</span><span class="sxs-lookup"><span data-stu-id="6dbe7-293">Upgrade using the Enterprise Single Sign-On standalone setup</span></span>  |             <span data-ttu-id="6dbe7-294">使用以下步骤来安装，如专用主密钥服务器的独立企业单一登录的计算机上执行升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-294">Use the following steps to perform an upgrade on computers that have a standalone Enterprise Single Sign on installation, such as a dedicated master secret server.</span></span><br/><br/><span data-ttu-id="6dbe7-295">1.验证当前的主密钥备份到安全位置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-295">1. Verify that the current master secret key is backed up to a secure location.</span></span><br/><span data-ttu-id="6dbe7-296">2.验证当前版本的 SSODB 备份到安全位置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-296">2. Verify that a current version of the SSODB is backed up to a secure location.</span></span><br/><span data-ttu-id="6dbe7-297">3.运行 ESSO **Setup.exe**从[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]安装介质。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-297">3. Run the ESSO **Setup.exe** from the [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] installation media.</span></span> <span data-ttu-id="6dbe7-298">默认安装文件夹是`\Platform\SSO`。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-298">The default installation folder is `\Platform\SSO`.</span></span><br/><span data-ttu-id="6dbe7-299">4.在中**自动运行**对话框中，选择**Microsoft 企业单一登录**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-299">4. In the **Autorun** dialog box, select **Microsoft Enterprise Single Sign-On**.</span></span><br/><span data-ttu-id="6dbe7-300">5.在摘要对话框，选择**升级**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-300">5. In the Summary dialog box, select **Upgrade**.</span></span>              |

### <a name="multicomputer-environment"></a><span data-ttu-id="6dbe7-301">多计算机环境</span><span class="sxs-lookup"><span data-stu-id="6dbe7-301">Multicomputer environment</span></span>
<span data-ttu-id="6dbe7-302">在多计算机环境中，升级 SSO 主密钥服务器计算机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-302">In a multicomputer environment, upgrade the SSO master secret server computer.</span></span> <span data-ttu-id="6dbe7-303">然后，升级其他 BizTalk Server 计算机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-303">Then, upgrade the other BizTalk Server computers.</span></span> <span data-ttu-id="6dbe7-304">不支持同时升级一个组中的 BizTalk 计算机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-304">Simultaneously upgrading the BizTalk computers in a group is not supported.</span></span> <span data-ttu-id="6dbe7-305">按以下顺序一次升级一台计算机：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-305">Upgrade one computer at a time in the following order:</span></span>

1. <span data-ttu-id="6dbe7-306">单一登录主密钥服务器</span><span class="sxs-lookup"><span data-stu-id="6dbe7-306">Single Sign-On master secret server</span></span>
2. <span data-ttu-id="6dbe7-307">在运行 BizTalk Server 运行时计算机</span><span class="sxs-lookup"><span data-stu-id="6dbe7-307">Run-time computers that are running BizTalk Server</span></span>
3. <span data-ttu-id="6dbe7-308">管理工具和监视计算机</span><span class="sxs-lookup"><span data-stu-id="6dbe7-308">Administration tools and monitoring computer</span></span>
4. <span data-ttu-id="6dbe7-309">开发和运行 BizTalk Server 的任何其他剩余的计算机</span><span class="sxs-lookup"><span data-stu-id="6dbe7-309">Development and any other remaining computers that are running BizTalk Server</span></span>

<span data-ttu-id="6dbe7-310">**其他**</span><span class="sxs-lookup"><span data-stu-id="6dbe7-310">**Additional**</span></span>  
<span data-ttu-id="6dbe7-311">使用设置仪表板，可以广泛地调整 BizTalk Server 设置以优化性能。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-311">Using the Settings Dashboard, you can extensively tweak BizTalk Server settings for performance optimization.</span></span> <span data-ttu-id="6dbe7-312">此外可以修改 BizTalk 组、 BizTalk 主机和 BizTalk 主机实例设置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-312">You can also modify settings for the BizTalk Group, BizTalk Host, and BizTalk Host Instance.</span></span> <span data-ttu-id="6dbe7-313">请参阅[使用设置仪表板进行 BizTalk Server 性能调优](../core/using-settings-dashboard-for-biztalk-server-performance-tuning.md)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-313">See [Using Settings Dashboard for BizTalk Server Performance Tuning](../core/using-settings-dashboard-for-biztalk-server-performance-tuning.md).</span></span>

### <a name="general-information"></a><span data-ttu-id="6dbe7-314">常规信息</span><span class="sxs-lookup"><span data-stu-id="6dbe7-314">General information</span></span>

- <span data-ttu-id="6dbe7-315">**帐户名**:使用默认帐户名，只要有可能。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-315">**Account names**: Use the default account names whenever possible.</span></span> <span data-ttu-id="6dbe7-316">BizTalk Server 安装程序会自动配置已安装的组件要使用的默认帐户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-316">The BizTalk Server Setup program automatically configures installed components to use the default accounts.</span></span> <span data-ttu-id="6dbe7-317">如果在 Active Directory 林中有多个 BizTalk Server 组，更改帐户名，以避免冲突。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-317">If there are multiple BizTalk Server groups in an Active Directory forest, change the account names to avoid conflicts.</span></span> <span data-ttu-id="6dbe7-318">BizTalk Server 仅支持`<NetBIOS domain name>\<user>`名称格式的服务帐户和 Windows 组。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-318">BizTalk Server supports only `<NetBIOS domain name>\<user>` name formats for service accounts and Windows groups.</span></span>

- <span data-ttu-id="6dbe7-319">**带有 BAM 管理 Web 服务的帐户名称**:BizTalk Server 不支持 BAM 管理 Web 服务用户的内置帐户或无密码的帐户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-319">**Account names with BAM Management Web Service**: BizTalk Server does not support built-in accounts or accounts without passwords for the BAM Management Web Service User.</span></span> 

  <span data-ttu-id="6dbe7-320">通过此类帐户配置 BizTalk Server 似乎会成功，但 BAM 管理 Web 服务会失败。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-320">Configuring BizTalk Server with such accounts may appear to succeed, but the BAM Management Web Service fails.</span></span> 

  <span data-ttu-id="6dbe7-321">支持将此类帐户用于 BAM 应用程序池。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-321">Use of such accounts for the BAM Application pool is supported.</span></span>

- <span data-ttu-id="6dbe7-322">**BizTalk 程序集查看器**不支持在 64 位操作系统上。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-322">**BizTalk Assembly Viewer** is not supported on a 64-bit operating system.</span></span>

- <span data-ttu-id="6dbe7-323">**安装和卸载**:当你卸载 BizTalk Server 后时，手动删除 BizTalk Server 数据库。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-323">**Install and Uninstall**: When you uninstall BizTalk Server, manually delete the BizTalk Server databases.</span></span> <span data-ttu-id="6dbe7-324">如果以开发人员或评估师身份安装 BizTalk Server，请考虑在虚拟机上安装。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-324">If you are installing BizTalk Server as a developer or evaluator, consider installing on a virtual machine.</span></span> <span data-ttu-id="6dbe7-325">这样一来，如果你必须重新安装，您可以轻松回滚到预设检查点而无需完成整个卸载过程。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-325">This way, if you have to reinstall, you can easily roll back to a preset checkpoint without having to go through the uninstall process.</span></span>

- <span data-ttu-id="6dbe7-326">**32 位和 64 位计算机**:在 32 位 Windows 或 64 位 Windows 上安装 BizTalk Server 时，有一些不同之处。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-326">**32-bit and 64-bit computers**: There are few differences when installing BizTalk Server on 32-bit Windows or 64-bit Windows.</span></span> <span data-ttu-id="6dbe7-327">本文档介绍如何同时在 32 位和 64 位安装。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-327">This document covers both 32-bit and 64-bit installations.</span></span> <span data-ttu-id="6dbe7-328">说明了它们之间的差异。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-328">Differences between them are noted.</span></span>

- <span data-ttu-id="6dbe7-329">**工作组**:支持安装和配置 BizTalk Server 在一台计算机上的工作组环境中。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-329">**Workgroups**: Installing and configuring BizTalk Server in a workgroup environment on a single computer is supported.</span></span> <span data-ttu-id="6dbe7-330">在此方案中，SQL Server 和 BizTalk Server 功能和组件将安装并配置在同一计算机上。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-330">In this scenario, both SQL Server and BizTalk Server features and components are installed and configured on the same computer.</span></span>

- <span data-ttu-id="6dbe7-331">**终端服务器**:安装 BizTalk Server 使用在应用程序模式下运行的终端服务器不支持。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-331">**Terminal Server**: Installing BizTalk Server using Terminal Server running in application mode is not supported.</span></span> <span data-ttu-id="6dbe7-332">请参阅[KB 832027](https://support.microsoft.com/kb/832027)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-332">See [KB 832027](https://support.microsoft.com/kb/832027).</span></span>

- <span data-ttu-id="6dbe7-333">**无提示升级**不受支持。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-333">**Silent Upgrade** is not supported.</span></span>

- <span data-ttu-id="6dbe7-334">**不受支持的应用程序**:BizTalk Server 不支持基于不支持的 Api，例如 PAM Api、 存储的过程或直接数据库访问的自定义应用程序。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-334">**Unsupported Applications**: BizTalk Server does not support custom applications built on unsupported APIs such as PAM APIs, stored procedures, or direct database access.</span></span> <span data-ttu-id="6dbe7-335">在升级生产环境之前，请运行至少一个测试升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-335">Run at least one test upgrade before you upgrade your production environment.</span></span>

- <span data-ttu-id="6dbe7-336">**SQL Server 实例**:最好在升级平台前先升级任何 SQL Server 实例。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-336">**SQL Server instances**: It’s a good practice to upgrade any SQL Server instances before you upgrade the platform.</span></span>

## <a name="prepare-your-computer-for-upgrade"></a><span data-ttu-id="6dbe7-337">为升级准备您的计算机</span><span class="sxs-lookup"><span data-stu-id="6dbe7-337">Prepare your computer for upgrade</span></span>

|                 <span data-ttu-id="6dbe7-338">任务</span><span class="sxs-lookup"><span data-stu-id="6dbe7-338">Task</span></span>                  |                                                                                                                                                                                                                                        <span data-ttu-id="6dbe7-339">T:System.Diagnostics.Switch</span><span class="sxs-lookup"><span data-stu-id="6dbe7-339">Info</span></span>                                                                                                                                                                                                                                         |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|   <span data-ttu-id="6dbe7-340">安装重要 Windows 更新</span><span class="sxs-lookup"><span data-stu-id="6dbe7-340">Install Critical Windows Updates</span></span>    |                                                                                                                                                                                                <span data-ttu-id="6dbe7-341">从程序菜单中选择 Windows 更新。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-341">Select Windows Update from the Programs menu.</span></span> <span data-ttu-id="6dbe7-342">您可能需要重新启动计算机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-342">You may need to restart your computer.</span></span>                                                                                                                                                                                                 |
|      <span data-ttu-id="6dbe7-343">保存 BAM 警报定义</span><span class="sxs-lookup"><span data-stu-id="6dbe7-343">Save BAM Alert Definitions</span></span>       |                                    <span data-ttu-id="6dbe7-344">仅适用于当前使用现有 BAM 警报定义和 SQL Server Notification Services。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-344">Applies only if you currently use existing BAM Alert definitions with SQL Server Notification Services.</span></span> <span data-ttu-id="6dbe7-345">创建使用 BM.exe 定义文件并取消配置 BAM 警报[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 配置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-345">Create a definition file using BM.exe and unconfigure BAM Alerts in the [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013 Configuration.</span></span><br/><br/><span data-ttu-id="6dbe7-346">**在升级之前**（在本主题中） 列出了特定步骤。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-346">**Before the upgrade** (in this topic) lists the specific steps.</span></span><br/><br/><span data-ttu-id="6dbe7-347">否则，在升级后重新创建 BAM 警报定义。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-347">Otherwise, recreate the BAM Alert definitions after you upgrade.</span></span>                                    |
|          <span data-ttu-id="6dbe7-348">升级 SQL Server</span><span class="sxs-lookup"><span data-stu-id="6dbe7-348">Upgrade SQL Server</span></span>           |                                         <span data-ttu-id="6dbe7-349">升级到支持的 SQL Server 版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-349">Upgrade to a supported SQL Server version.</span></span> <span data-ttu-id="6dbe7-350">请参阅：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-350">See:</span></span><br/><br/>[<span data-ttu-id="6dbe7-351">硬件和软件要求适用于 BizTalk Server 2016</span><span class="sxs-lookup"><span data-stu-id="6dbe7-351">Hardware and Software Requirements for BizTalk Server 2016</span></span>](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md)<br/>[<span data-ttu-id="6dbe7-352">升级到 SQL Server 2016</span><span class="sxs-lookup"><span data-stu-id="6dbe7-352">Upgrade to SQL Server 2016</span></span>](https://msdn.microsoft.com/library/bb677622.aspx)<br/><span data-ttu-id="6dbe7-353">[升级到 SQL Server 2014](https://msdn.microsoft.com/library/bb677622(v=sql.120).aspx)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-353">[Upgrade to SQL Server 2014](https://msdn.microsoft.com/library/bb677622(v=sql.120).aspx)</span></span>                                          |
|    <span data-ttu-id="6dbe7-354">升级 SQL Server 客户端工具</span><span class="sxs-lookup"><span data-stu-id="6dbe7-354">Upgrade SQL Server Client Tools</span></span>    |                                                                                                                                                <span data-ttu-id="6dbe7-355">在多计算机环境中，可能在单独的计算机上安装管理工具。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-355">In a multicomputer environment, the Administration tools may be installed on a separate computer.</span></span> <span data-ttu-id="6dbe7-356">升级 SQL Server 管理客户端工具，包括管理工具。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-356">Upgrade the SQL Server Administration Client Tools, including the Management Tools.</span></span>                                                                                                                                                |
|         <span data-ttu-id="6dbe7-357">安装 Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6dbe7-357">Install Visual Studio</span></span>         |                         <span data-ttu-id="6dbe7-358">请参阅[硬件和软件要求 BizTalk Server 2016 的](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md)有关受支持的版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-358">See [Hardware and Software Requirements for BizTalk Server 2016](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md) for the supported versions.</span></span> <span data-ttu-id="6dbe7-359">可以为不同 Visual Studio 版本已安装的并排方案。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-359">Different Visual Studio versions can be installed side-by-side.</span></span> <span data-ttu-id="6dbe7-360">请参阅[Visual Studio 2015](https://msdn.microsoft.com/library/ms246609(v=vs.140).aspx)并[Visual Studio 2013](https://msdn.microsoft.com/library/ms246609(v=vs.120).aspx)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-360">See [Visual Studio 2015](https://msdn.microsoft.com/library/ms246609(v=vs.140).aspx) and [Visual Studio 2013](https://msdn.microsoft.com/library/ms246609(v=vs.120).aspx).</span></span>                         |
|            <span data-ttu-id="6dbe7-361">安装 Office</span><span class="sxs-lookup"><span data-stu-id="6dbe7-361">Install Office</span></span>             |                                     <span data-ttu-id="6dbe7-362">请参阅[安装和使用不同版本的 Office](https://support.office.com/article/Install-and-use-different-versions-of-Office-on-the-same-PC-6EBB44CE-18A3-43F9-A187-B78C513788BF)同一台计算机上。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-362">See [Install and use different versions of Office](https://support.office.com/article/Install-and-use-different-versions-of-Office-on-the-same-PC-6EBB44CE-18A3-43F9-A187-B78C513788BF) on the same computer.</span></span> <span data-ttu-id="6dbe7-363">[硬件和软件要求 BizTalk Server 2016 的](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md)列出了支持的 Office 版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-363">[Hardware and Software Requirements for BizTalk Server 2016](../install-and-config-guides/hardware-and-software-requirements-for-biztalk-server-2016.md) lists the supported Office versions.</span></span>                                     |
| <span data-ttu-id="6dbe7-364">停止 BizTalk 和 Windows 服务</span><span class="sxs-lookup"><span data-stu-id="6dbe7-364">Stop the BizTalk and Windows Services</span></span> |                                                                                                      <span data-ttu-id="6dbe7-365">-BizTalk 服务 BizTalk 组： *< 名称 >*</span><span class="sxs-lookup"><span data-stu-id="6dbe7-365">- BizTalk Service BizTalk Group:  *<Application_Name>*</span></span><br/><span data-ttu-id="6dbe7-366">-BizTalk 基本 EDI 服务</span><span class="sxs-lookup"><span data-stu-id="6dbe7-366">- BizTalk Base EDI Service</span></span><br/><span data-ttu-id="6dbe7-367">-规则引擎更新服务</span><span class="sxs-lookup"><span data-stu-id="6dbe7-367">- Rule Engine Update Service</span></span><br/><span data-ttu-id="6dbe7-368">-万维网发布服务</span><span class="sxs-lookup"><span data-stu-id="6dbe7-368">- World Wide Web Publishing Service</span></span><br/><br/><span data-ttu-id="6dbe7-369">**请注意**</span><span class="sxs-lookup"><span data-stu-id="6dbe7-369">**NOTE**</span></span><br/><span data-ttu-id="6dbe7-370">如果您安装了任何 BizTalk Server 加速器，停止 HL7 日志记录服务。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-370">If you have any BizTalk Server accelerators installed, stop the HL7 Logging Service.</span></span>                                                                                                      |
|         <span data-ttu-id="6dbe7-371">将数据库备份</span><span class="sxs-lookup"><span data-stu-id="6dbe7-371">Back up the databases</span></span>         | <span data-ttu-id="6dbe7-372">主机</span><span class="sxs-lookup"><span data-stu-id="6dbe7-372">- Master</span></span><br/><span data-ttu-id="6dbe7-373">- MSDB</span><span class="sxs-lookup"><span data-stu-id="6dbe7-373">- MSDB</span></span><br/><span data-ttu-id="6dbe7-374">-BAMArchive</span><span class="sxs-lookup"><span data-stu-id="6dbe7-374">- BAMArchive</span></span><br/><span data-ttu-id="6dbe7-375">- BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="6dbe7-375">- BAMPrimaryImport</span></span><br/><span data-ttu-id="6dbe7-376">- BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="6dbe7-376">- BAMStarSchema</span></span><br/><span data-ttu-id="6dbe7-377">- BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-377">- BizTalkDTADb</span></span><br/><span data-ttu-id="6dbe7-378">- BizTalkEDIDb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-378">- BizTalkEDIDb</span></span><br/><span data-ttu-id="6dbe7-379">- BizTalkHwsDb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-379">- BizTalkHwsDb</span></span><br/><span data-ttu-id="6dbe7-380">- BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-380">- BizTalkMgmtDb</span></span><br/><span data-ttu-id="6dbe7-381">- BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-381">- BizTalkMsgBoxDb</span></span><br/><span data-ttu-id="6dbe7-382">- BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-382">- BizTalkRuleEngineDb</span></span><br/><span data-ttu-id="6dbe7-383">- TPM</span><span class="sxs-lookup"><span data-stu-id="6dbe7-383">- TPM</span></span><br/><span data-ttu-id="6dbe7-384">- BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="6dbe7-384">- BizTalkAnalysisDb</span></span><br/><span data-ttu-id="6dbe7-385">- BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="6dbe7-385">- BAMAnalysis</span></span><br/><br/><span data-ttu-id="6dbe7-386">[SQL Server 2014:备份概述](https://technet.microsoft.com/library/ms175477(v=sql.120).aspx)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-386">[SQL Server 2014: Backup Overview](https://technet.microsoft.com/library/ms175477(v=sql.120).aspx)</span></span><br/><span data-ttu-id="6dbe7-387">[SQL Server 2012:备份概述](https://technet.microsoft.com/library/ms175477(v=sql.110).aspx)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-387">[SQL Server 2012: Backup Overview](https://technet.microsoft.com/library/ms175477(v=sql.110).aspx)</span></span> |
|  <span data-ttu-id="6dbe7-388">配置 SQL Server 数据库邮件</span><span class="sxs-lookup"><span data-stu-id="6dbe7-388">Configure SQL Server Database Mail</span></span>   |                                                                                                                      <span data-ttu-id="6dbe7-389">仅适用于您使用 BAM 警报定义和 SQL Server Notification Services。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-389">Applies only if you use BAM Alert definitions with SQL Server Notification Services.</span></span><br/><br/><span data-ttu-id="6dbe7-390">**在升级之前**（在本主题中） 列出了特定步骤。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-390">**Before the upgrade** (in this topic) lists the specific steps.</span></span><br/><br/><span data-ttu-id="6dbe7-391">否则，在升级后重新创建 BAM 警报定义。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-391">Otherwise, recreate the BAM Alert definitions after you upgrade.</span></span>                                                                                                                       |

## <a name="do-the-upgrade"></a><span data-ttu-id="6dbe7-392">执行升级</span><span class="sxs-lookup"><span data-stu-id="6dbe7-392">Do the upgrade</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6dbe7-393">安装 SQL Server，则安装程序授予系统管理员权限登录的帐户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-393">When you installed SQL Server, setup granted your logged-on account system administrator rights.</span></span> <span data-ttu-id="6dbe7-394">安装 BizTalk Server 时，还需要执行系统管理员权限。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-394">System administrator rights are also required to install BizTalk Server.</span></span> <span data-ttu-id="6dbe7-395">执行以下操作之一：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-395">Do one of the following:</span></span>
> 
> - <span data-ttu-id="6dbe7-396">使用相同的帐户安装 SQL Server 时使用</span><span class="sxs-lookup"><span data-stu-id="6dbe7-396">Use the same account you used when you installed SQL Server</span></span>  
> <span data-ttu-id="6dbe7-397">**OR**</span><span class="sxs-lookup"><span data-stu-id="6dbe7-397">**OR**</span></span>  
> - <span data-ttu-id="6dbe7-398">请确保当前登录的帐户具有系统管理员权限</span><span class="sxs-lookup"><span data-stu-id="6dbe7-398">Make sure the current logged-on account has system administrator rights</span></span>

### <a name="upgrade-steps"></a><span data-ttu-id="6dbe7-399">升级步骤</span><span class="sxs-lookup"><span data-stu-id="6dbe7-399">Upgrade steps</span></span>

1. <span data-ttu-id="6dbe7-400">关闭任何打开的程序。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-400">Close any open programs.</span></span>
2. <span data-ttu-id="6dbe7-401">运行**Setup.exe**从安装媒体。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-401">Run **Setup.exe** from the installation media.</span></span>
3. <span data-ttu-id="6dbe7-402">在入门中，选择**安装 Microsoft BizTalk Server**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-402">In Start, select **Install Microsoft BizTalk Server**.</span></span>
4. <span data-ttu-id="6dbe7-403">在中**客户信息**，输入用户名称、 组织和产品密钥。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-403">In **Customer Information**, enter your user name, organization, and product key.</span></span> <span data-ttu-id="6dbe7-404">选择“**下一步**”。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-404">Select **Next**.</span></span>
5. <span data-ttu-id="6dbe7-405">接受许可协议，然后选择**下一步**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-405">Accept the license agreement, and select **Next**.</span></span>
6. <span data-ttu-id="6dbe7-406">在客户体验改善计划，输入首选项。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-406">In Customer Experience Improvement Program, enter you preference.</span></span> <span data-ttu-id="6dbe7-407">请参阅**附录 A** （在本主题中） 有关详细信息。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-407">See **Appendix A** (in this topic) for more information.</span></span>
7. <span data-ttu-id="6dbe7-408">在中**组件安装**，查看可用组件，然后选择**下一步**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-408">In **Component Installation**, review the available components, and select **Next**.</span></span>
8. <span data-ttu-id="6dbe7-409">如果您的计算机缺少的必备软件，安装程序可以安装可再发行的必备组件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-409">If your computer is missing a prerequisite, Setup can install the redistributable prerequisites.</span></span> <span data-ttu-id="6dbe7-410">您可以：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-410">You can either:</span></span>

    - <span data-ttu-id="6dbe7-411">选择自动从 web 安装可再发行的必备组件</span><span class="sxs-lookup"><span data-stu-id="6dbe7-411">Select Automatically install the redistributable prerequisites from the web</span></span>  

      <span data-ttu-id="6dbe7-412">或</span><span class="sxs-lookup"><span data-stu-id="6dbe7-412">OR</span></span>  

    - <span data-ttu-id="6dbe7-413">选择自动安装可再发行的必备组件 CAB 文件中如果你已下载 CAB 文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-413">Select Automatically install the redistributable prerequisites from a CAB file if you downloaded the CAB file.</span></span> <span data-ttu-id="6dbe7-414">浏览到 CAB 文件的位置并选择它。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-414">Browse to the location of the CAB file and select it.</span></span>

9. <span data-ttu-id="6dbe7-415">在中**摘要**，查看可升级的组件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-415">In **Summary**, review the upgradable components.</span></span>
10. <span data-ttu-id="6dbe7-416">选择**升级**启动。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-416">Select **Upgrade** to start.</span></span>
11. <span data-ttu-id="6dbe7-417">可选：选择**使用 Microsoft Update 检查更新 （推荐） 时**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-417">Optional: Select **Use the Microsoft Update when I check for updates (recommended)**.</span></span>
12. <span data-ttu-id="6dbe7-418">在中**升级已完成**，清除**启动 BizTalk Server 配置**复选框，并选择**完成**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-418">In **Upgrade Completed**, clear the L**aunch BizTalk Server Configuration** check box, and then select **Finish**.</span></span>

<span data-ttu-id="6dbe7-419">**ADDITIONAL**</span><span class="sxs-lookup"><span data-stu-id="6dbe7-419">**ADDITIONAL**</span></span>  
<span data-ttu-id="6dbe7-420">BizTalk Server 中，升级期间会发生很多并不少见在过程中遇到错误。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-420">A lot happens during an upgrade of BizTalk Server, and it’s not uncommon to run into an error during the process.</span></span> <span data-ttu-id="6dbe7-421">但是，大多数错误可轻松纠正如果做好准备。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-421">However, most errors are easily remedied if you’re prepared.</span></span> <span data-ttu-id="6dbe7-422">我们建议阅读**附录 B** （本主题中有关如何避免升级错误，以及要执行的操作如果发生这种错误的提示。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-422">We recommend reading the **Appendix B** (in this topic) for tips on how to avoid upgrade errors, and what to do if one occurs.</span></span>

<span data-ttu-id="6dbe7-423">升级过程仅升级属于你的 BizTalk Server 的以前版本的功能。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-423">The upgrade process only upgrades features that were part of your previous version of BizTalk Server.</span></span> <span data-ttu-id="6dbe7-424">在升级过程不会安装新的功能。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-424">New features are not installed during an upgrade.</span></span> <span data-ttu-id="6dbe7-425">若要安装这些功能，在升级后重新运行安装程序中，选择**修改**，并选择你想要安装的功能。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-425">To install these features, rerun Setup after the upgrade, choose **Modify**, and select the features you want to install.</span></span> <span data-ttu-id="6dbe7-426">安装后，配置这些使用**BizTalk Server 配置管理器**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-426">Once installed, configure them using the **BizTalk Server Configuration Manager**.</span></span>

<span data-ttu-id="6dbe7-427">若要验证升级是否成功，请打开**程序和功能**并查找[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-427">To verify if the upgrade is successful, open **Programs and Features** and look for [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].</span></span> <span data-ttu-id="6dbe7-428">如果已列出，则安装成功。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-428">If it’s listed, setup succeeded.</span></span>

## <a name="post-upgrade"></a><span data-ttu-id="6dbe7-429">升级后</span><span class="sxs-lookup"><span data-stu-id="6dbe7-429">Post upgrade</span></span>
<span data-ttu-id="6dbe7-430">您无法回滚到 [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] /2013年。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-430">You cannot roll back to [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]/2013.</span></span>

- <span data-ttu-id="6dbe7-431">**如果创建了 BAM 警报定义 XML 文件**:在[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]配置中，配置 BAM 警报。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-431">**If you created a BAM Alerts definition XML file**: In [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] Configuration, configure BAM Alerts.</span></span> <span data-ttu-id="6dbe7-432">然后，部署已保存的定义。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-432">Then, deploy the saved Definitions.</span></span>

    <span data-ttu-id="6dbe7-433">**在升级之前**（在本主题中） 列出了特定步骤。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-433">**Before the upgrade** (in this topic) lists the specific steps.</span></span> <span data-ttu-id="6dbe7-434">否则，在升级后重新创建 BAM 警报定义。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-434">Otherwise, recreate the BAM Alert definitions after you upgrade.</span></span>

- <span data-ttu-id="6dbe7-435">**安装 MQSAgent**:如果 MQSAgent.dll 文件安装在远程 WebSphere MQ Server 上，安装新版 MQ 代理[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]远程 WebSphere MQ Server 上。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-435">**Install MQSAgent**: If the MQSAgent.dll file is installed on a remote WebSphere MQ Server, install a new version of the MQ Agent from [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] on the remote WebSphere MQ Server.</span></span>

- <span data-ttu-id="6dbe7-436">**启动 MSMQ**:如果使用 MSMQ 适配器，启动消息队列服务。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-436">**Start MSMQ**: If you use the MSMQ adapter, start the Message Queuing service.</span></span>

- <span data-ttu-id="6dbe7-437">**自定义 EXE 和 BRE**:如果必须引用 BizTalk Server 2010 中的业务规则引擎程序集的自定义托管可执行文件，以下代码添加到应用程序配置文件以.NET Framework 2.0 中运行此进程。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-437">**Custom EXE and BRE**: If you have a custom managed executable file that references Business Rule Engine assembly in BizTalk Server 2010, add the following to the application configuration file to run the process in the .NET Framework 2.0.</span></span>

    ```
    <?xml version="1.0" encoding="Windows-1252"?>
    <configuration> 
     <startup>
      <supportedRuntime version="v2.0.50727" />
     </startup>   
    </configuration>
    ```

- <span data-ttu-id="6dbe7-438">**SQL 代理作业**:重新配置以下 SQL Server 代理作业：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-438">**SQL Agent job**: Reconfigure the following SQL Server Agent jobs:</span></span>

    -   <span data-ttu-id="6dbe7-439">DTA 清除和存档 (BizTalkDTADb):请参阅[如何配置 DTA 清除和存档作业](../core/how-to-configure-the-dta-purge-and-archive-job.md)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-439">DTA Purge and Archive (BizTalkDTADb): See [How to Configure the DTA Purge and Archive Job](../core/how-to-configure-the-dta-purge-and-archive-job.md)</span></span>
    -   <span data-ttu-id="6dbe7-440">备份 BizTalk Server (BizTalkMgmtDb):请参阅[如何配置备份 BizTalk Server 作业](../core/how-to-configure-the-backup-biztalk-server-job.md)</span><span class="sxs-lookup"><span data-stu-id="6dbe7-440">Backup BizTalk Server (BizTalkMgmtDb): See [How to Configure the Backup BizTalk Server Job](../core/how-to-configure-the-backup-biztalk-server-job.md)</span></span>

- <span data-ttu-id="6dbe7-441">**重新启动应用程序**:重新启动升级的所有已部署应用程序。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-441">**Restart applications**: Restart all deployed applications that are upgraded.</span></span>

- <span data-ttu-id="6dbe7-442">**BAM 门户错误**:当您打开 BAM 门户时，可能会收到以下错误消息：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-442">**BAM Portal error**: When you open the BAM portal, you may receive the following error message:</span></span> 

    `The server encountered a critical failure while trying to access the list of Views. The Business Management Web Service requires Administrator's attention.` 

    <span data-ttu-id="6dbe7-443">如果运行的.NET Framework 2.0 的应用程序使用的网站上配置 BAM 门户，可以发生此错误。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-443">This error can occur if the BAM portal is configured on a website used by applications that are running .NET Framework 2.0.</span></span> <span data-ttu-id="6dbe7-444">在此方案中，托管新的网站上的 BAM 门户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-444">In this scenario, host the BAM portal on a new website.</span></span> <span data-ttu-id="6dbe7-445">若要添加的网站，请参阅[创建的 Web 站点](http://go.microsoft.com/fwlink/p/?LinkID=196470)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-445">To add a website, see [Create a Web Site](http://go.microsoft.com/fwlink/p/?LinkID=196470).</span></span> <span data-ttu-id="6dbe7-446">创建网站后, 重新配置 BAM 门户：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-446">After creating the website, reconfigure the BAM Portal:</span></span>

    1. <span data-ttu-id="6dbe7-447">打开**BizTalk Server 配置**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-447">Open **BizTalk Server Configuration**.</span></span>
    2. <span data-ttu-id="6dbe7-448">选择**取消对功能**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-448">Select **Unconfigure Features**.</span></span> <span data-ttu-id="6dbe7-449">在中**取消对功能**，选择**BAM 门户**复选框，然后选择**确定**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-449">In **Unconfigure Features**, select the **BAM Portal** check box, and select **OK**.</span></span>
    3. <span data-ttu-id="6dbe7-450">通过选择从新网站来重新配置 BAM 门户**BAM 门户网站**列表。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-450">Reconfigure the BAM portal by selecting the new website from the **BAM Portal Web Site** list.</span></span>

- <span data-ttu-id="6dbe7-451">**BizTalk 2016 Accelerator for SWIFT**:BizTalk Server 升级过程不会更新已编辑*BREDeployment.exe.config*文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-451">**BizTalk 2016 Accelerator for SWIFT**: The BizTalk Server upgrade process does not update an edited *BREDeployment.exe.config* file.</span></span> <span data-ttu-id="6dbe7-452">手动更改中的路径*BREDeployment.exe.config*文件位于`\Program Files\Microsoft BizTalk 2016 Accelerator for SWIFT\SDK\Tools`文件夹。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-452">Manually change the paths in the *BREDeployment.exe.config* file located in the `\Program Files\Microsoft BizTalk 2016 Accelerator for SWIFT\SDK\Tools` folder.</span></span>

    <span data-ttu-id="6dbe7-453">另外，A4SWIFT Web Services 和 Message Pack 配置也将丢失。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-453">Also, the A4SWIFT Web Services and Message Pack configuration is lost.</span></span> <span data-ttu-id="6dbe7-454">BizTalk Server 升级后重新配置这些设置。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-454">Reconfigure these after BizTalk Server is upgraded.</span></span>

## <a name="appendix-a-customer-experience-improvement-program"></a><span data-ttu-id="6dbe7-455">附录 A：客户体验改善计划</span><span class="sxs-lookup"><span data-stu-id="6dbe7-455">Appendix A: Customer experience improvement Program</span></span>
<span data-ttu-id="6dbe7-456">作为 BizTalk Server 中的客户体验改善计划的一部分，可以向 Microsoft 提供有用的反馈，就功能使用情况的 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-456">As part of the Customer Experience Improvement Program in BizTalk Server, you can provide useful feedback to Microsoft regarding feature usage of BizTalk Server.</span></span> <span data-ttu-id="6dbe7-457">收集的数据是匿名的不能用于确定您的身份。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-457">The data collected is anonymous, and cannot be used to identify you.</span></span> <span data-ttu-id="6dbe7-458">Microsoft 会收集功能使用情况统计信息作为此计划的一部分。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-458">Microsoft collects feature usage statistics as part of this program.</span></span>

<span data-ttu-id="6dbe7-459">通过参与此计划，可以帮助提高可靠性和性能的各种功能的 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-459">By participating in this program, you can help improve the reliability and performance of various features of BizTalk Server.</span></span> <span data-ttu-id="6dbe7-460">有关此计划及其隐私策略的详细信息，请参阅[Microsoft BizTalk Server CEIP 隐私策略](http://go.microsoft.com/fwlink/p/?LinkId=188553)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-460">For more information about this program and its privacy policy, see [Microsoft BizTalk Server CEIP Privacy Policy](http://go.microsoft.com/fwlink/p/?LinkId=188553).</span></span>

## <a name="appendix-b-known-issues"></a><span data-ttu-id="6dbe7-461">附录 B：已知问题</span><span class="sxs-lookup"><span data-stu-id="6dbe7-461">Appendix B: Known issues</span></span>

- <span data-ttu-id="6dbe7-462">**管理计算机上配置 BAM 警报**:没有单独的计算机上安装的管理、 运行时和 SQL Server 组件的多计算机环境。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-462">**Configure BAM Alerts on Administration computer**: There is a multicomputer environment with the Administration, Runtime, and SQL Server components installed on separate computers.</span></span> <span data-ttu-id="6dbe7-463">当使用 BAM 工具或 BAM 警报时，可能会出现以下问题：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-463">When working with BAM Tools or BAM Alerts, the following issues can occur:</span></span>

    <span data-ttu-id="6dbe7-464">**问题**:在 BizTalk 管理计算机上配置 BAM 工具时，会发生以下错误：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-464">**ISSUE**: When you configure BAM Tools on a BizTalk Administration computer, the following error occurs:</span></span>

    `Service BAMAlerts was not found on computer ‘.’.The specified service does not exist as an installed service.`

    <span data-ttu-id="6dbe7-465">**问题**:在部署 BAM 活动定义从运行时计算机时，会发生以下错误：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-465">**ISSUE**: When you deploy a BAM Activity Definition from Runtime computer, the following error occurs:</span></span>

    `A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) (.Net SqlClient Data Provider)`

    <span data-ttu-id="6dbe7-466">如果在运行时计算机上配置 BAM 警报，将发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-466">This occurs if BAM Alerts is configured on the Runtime computer.</span></span> <span data-ttu-id="6dbe7-467">若要解决，请在 BizTalk 管理控制台的同一计算机上配置 BAM 警报。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-467">To resolve, configure BAM Alerts on the same computer as the BizTalk Administration console.</span></span> <span data-ttu-id="6dbe7-468">不要在运行时计算机上配置 BAM 警报。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-468">Do not configure BAM Alerts on the Runtime computer.</span></span>

- <span data-ttu-id="6dbe7-469">**从失败的升级中恢复**:在升级过程中随时可能发生升级失败。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-469">**Recovering from a Failed Upgrade**: A failed upgrade can occur at any time during the upgrade.</span></span> <span data-ttu-id="6dbe7-470">如何恢复失败的升级确定哪个点发生失败的每个阶段。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-470">How you recover from a failed upgrade is determined from what point during each phase the failure occurred.</span></span>

  - <span data-ttu-id="6dbe7-471">如果升级失败时安装系统必备组件，安装程序停止进一步安装系统必备组件，并返回错误消息。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-471">If the upgrade fails when installing the prerequisites, then setup stops further installation of prerequisites, and returns a message with the error.</span></span> <span data-ttu-id="6dbe7-472">然后可以更正问题并重新运行安装程序。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-472">You can then correct the problem and rerun setup.</span></span>

  - <span data-ttu-id="6dbe7-473">如果升级失败时升级数据库，删除现有 BizTalk Server 版本中的功能或安装最新版本，安装程序停止进一步安装，并返回错误消息。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-473">If the upgrade fails when upgrading the databases, removing features from the existing BizTalk Server version, or installing the new version, then setup stops further installation, and returns a message with the error.</span></span> <span data-ttu-id="6dbe7-474">将回滚任何更改。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-474">Any changes are rolled back.</span></span> <span data-ttu-id="6dbe7-475">无法回滚到 BizTalk Server 数据库所做的更改。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-475">Changes made to the BizTalk Server databases cannot be rolled back.</span></span>

      <span data-ttu-id="6dbe7-476">如果在升级过程中删除以前的 BizTalk Server 安装的组件，您的计算机可能会处于一种状态无 BizTalk Server 组件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-476">If components of the previous BizTalk Server installation are removed during upgrade, your computer may be left in a state with no BizTalk Server components.</span></span> <span data-ttu-id="6dbe7-477">可能会保留先前安装中的功能配置信息。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-477">Feature configuration information from the previous installation may be retained.</span></span> <span data-ttu-id="6dbe7-478">并且根据升级过程失败的位置，BizTalk Server 数据库可能已升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-478">And depending on where the upgrade process fails, the BizTalk Server databases may have been upgraded.</span></span> <span data-ttu-id="6dbe7-479">可能需要还原的数据库，再次运行安装程序之前备份。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-479">It may be necessary to restore the databases which you backed up earlier before running setup again.</span></span>

  - <span data-ttu-id="6dbe7-480">如果升级失败时重新配置 BizTalk Server 功能，安装程序将返回完成比例消息。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-480">If the upgrade fails when reconfiguring the BizTalk Server features, then the setup returns a message with the level of completion.</span></span> <span data-ttu-id="6dbe7-481">如果配置升级失败或部分成功，运行 BizTalk Server 配置来完成升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-481">If configuration upgrade fails or partially succeeds, run the BizTalk Server configuration to complete the upgrade.</span></span>

    <span data-ttu-id="6dbe7-482">如果升级继续失败并且需要回退到以前版本的 BizTalk Server，必须还原您备份的数据库，然后重新安装先前的 BizTalk Server 版本。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-482">If the upgrade continues to fail and you need to regress to your previous version of BizTalk Server, you must restore the databases you backed up, and then reinstall your previous BizTalk Server version.</span></span>

- <span data-ttu-id="6dbe7-483">**使用相同的版本**:在 BizTalk 应用程序组中，无法运行具有不同版本的 BizTalk Server 的计算机。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-483">**Use the same versions**: In a BizTalk application group, you cannot run machines with different versions of BizTalk Server.</span></span> <span data-ttu-id="6dbe7-484">例如，在 BizTalk 管理控制台中，不能绑定到不同版本的 BizTalk Server 上运行的接收位置的 BizTalk Server 的一个版本上运行的发送端口。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-484">For example, in the BizTalk Administration Console, you cannot bind a send port running on one version of BizTalk Server to a receive location running on a different version of BizTalk Server.</span></span> 

- <span data-ttu-id="6dbe7-485">**重新启动 SSO 服务**:如果您有以前的 Visual Studio 版本或在计算机上安装.NET Framework 4.5，BizTalk Server 的早期版本中的 SSO 服务将停止工作。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-485">**Restart SSO Service**: If you have a previous Visual Studio version or .NET Framework 4.5 installed on your machine, then the SSO service in earlier versions of BizTalk Server stops working.</span></span> <span data-ttu-id="6dbe7-486">若要解决此问题，请运行`regasm SSOSQL.dll`命令从 Visual Studio 命令提示符。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-486">To resolve this issue, run the `regasm SSOSQL.dll` command from the Visual Studio command prompt.</span></span> <span data-ttu-id="6dbe7-487">此命令重新启动 SSO 服务。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-487">This command restarts the SSO service.</span></span>

    > [!NOTE]
    > <span data-ttu-id="6dbe7-488">64 位计算机上，运行 32 位和 64 位版本的 regasm 命令。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-488">On a 64-bit computer, run the 32-bit and 64-bit versions of the regasm command.</span></span>

- <span data-ttu-id="6dbe7-489">**无法使用 SOAP**:平台升级之后，你可能无法发送 SOAP 消息，因为权限。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-489">**Unable to use SOAP**: After a platform upgrade, you may not be able to send SOAP message because of permissions.</span></span> <span data-ttu-id="6dbe7-490">若要解决此问题，请编辑 Web.config 文件在`C:\inetpub\wwwroot\<SOAPExternalAppName>\`具有以下文本：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-490">To resolve this, edit the Web.config file at `C:\inetpub\wwwroot\<SOAPExternalAppName>\` with the following text:</span></span>

    ```
    <securityPolicy>
    <trustLevel name="Full" policyFile="internal" />
    <trustLevel name="High" policyFile="web_hightrust.config" />
    <trustLevel name="Medium" policyFile="web_mediumtrust.config" />
    <trustLevel name="Low" policyFile="web_lowtrust.config" />
    <trustLevel name="Minimal" policyFile="web_minimaltrust.config"/>
    </securityPolicy>
    <trust level="Full" originUrl="" processRequestInApplicationTrust="true"/>
    ```

    <span data-ttu-id="6dbe7-491">您可能还需要更改自定义错误模式从**仅远程**到**关闭**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-491">You may also have to change the custom error mode from **Remote Only** to **Off**.</span></span>

- <span data-ttu-id="6dbe7-492">**证书存储区**:升级后，打开发送端口或接收位置从 BizTalk Server 管理控制台中，并出现错误： `Could not open certificate store, the system cannot find the file specified (System).`</span><span class="sxs-lookup"><span data-stu-id="6dbe7-492">**Certificate Store**: After you upgrade, you open a send port or receive location from the BizTalk Server Administration console, and get error: `Could not open certificate store, the system cannot find the file specified (System).`</span></span>

    <span data-ttu-id="6dbe7-493">缺少的证书存储区时，将发生此错误。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-493">This error occurs if the certificate store is missing.</span></span>

- <span data-ttu-id="6dbe7-494">**BAM 门户**:在 64 位计算机上，不能在升级后访问 BAM 门户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-494">**BAM Portal**: On a 64-bit machine, you cannot access BAM portal after you upgrade.</span></span> <span data-ttu-id="6dbe7-495">可能的解决方法：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-495">Possible resolution:</span></span>

  1. <span data-ttu-id="6dbe7-496">创建在 web.config 文件的备份副本`%BizTalkInstallDir%\BAMPortal\web.config`。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-496">Create a backup copy of the web.config file located at `%BizTalkInstallDir%\BAMPortal\web.config`.</span></span>

  2. <span data-ttu-id="6dbe7-497">使用 bm.exe 在 BizTalk Server Tracking 文件夹中，在命令提示符处运行以下命令： `bm.exe get-config –FileName:<filepath> -Server:MyServer -Database:MyDB`</span><span class="sxs-lookup"><span data-stu-id="6dbe7-497">Using bm.exe in the BizTalk Server Tracking folder, run the following at the command prompt: `bm.exe get-config –FileName:<filepath> -Server:MyServer -Database:MyDB`</span></span>

     <span data-ttu-id="6dbe7-498">从配置 XML 文件获取的值*BAMVRoot* (xpath:BAMConfiguration\ GlobalProperty\Name="BAMVRoot").</span><span class="sxs-lookup"><span data-stu-id="6dbe7-498">From the Config XML file, get the value for *BAMVRoot* (xpath: BAMConfiguration\ GlobalProperty\Name="BAMVRoot").</span></span>

  3. <span data-ttu-id="6dbe7-499">打开列为 BAMVRoot 值的计算机上的 BizTalk Server 配置，并取消配置 BAM 门户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-499">Open the BizTalk Server Configuration on the computer that is listed as the BAMVRoot value, and unconfigure the BAM portal.</span></span>

  4. <span data-ttu-id="6dbe7-500">打开 BizTalk Server 配置，然后配置 BAM 门户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-500">Open the BizTalk Server Configuration, and configure the BAM portal.</span></span>

  5. <span data-ttu-id="6dbe7-501">从步骤 (1) 中提到的位置打开新的 web.config 文件。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-501">Open the new web.config file from location mentioned in step (1).</span></span>

  6. <span data-ttu-id="6dbe7-502">使用 web.config 文件中，备份副本设置以下值 (在`configuration\appSettings`):</span><span class="sxs-lookup"><span data-stu-id="6dbe7-502">Using the backup copy of the web.config file, set the following values (under `configuration\appSettings`):</span></span>

      - <span data-ttu-id="6dbe7-503">key="MainPageContentUrl"</span><span class="sxs-lookup"><span data-stu-id="6dbe7-503">key="MainPageContentUrl"</span></span>
      - <span data-ttu-id="6dbe7-504">key="AlertNotificationOptions"</span><span class="sxs-lookup"><span data-stu-id="6dbe7-504">key="AlertNotificationOptions"</span></span>

     > [!NOTE] 
     > <span data-ttu-id="6dbe7-505">在 64 位计算机上升级操作系统之后, 我们建议重新配置 BAM 门户。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-505">On a 64-bit machine, after you upgrade the operating system, we recommend that you reconfigure the BAM portal.</span></span>

- <span data-ttu-id="6dbe7-506">**部署 EDI BAM 活动**:升级时，可能会部分成功升级。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-506">**Deploy EDI BAM activities**: When you upgrade, the upgrade may partially succeed.</span></span> <span data-ttu-id="6dbe7-507">这可以升级 SQL Server （与已配置 EDI)。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-507">This can happen when you upgrade SQL Server (with EDI configured).</span></span> <span data-ttu-id="6dbe7-508">可能未正确升级 EDI BAM 活动。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-508">The EDI BAM activities might not be upgraded properly.</span></span> <span data-ttu-id="6dbe7-509">若要解决此问题，请使用管理凭据在命令提示符处运行以下命令部署 BAM 活动：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-509">To resolve this issue, deploy the BAM activities by running the following commands at the command prompt with administrative credentials:</span></span>

    `"<BizTalk Installation Folder>\Tracking\bm.exe" deploy-all -DefinitionFile:"<BizTalk Installation Folder>\AS2ResendActivityDefs.xml" -Server:"<BAM Database Server Name>" -Database:"<BAM Database Name>"`

    `"<BizTalk Installation Folder>\Tracking\bm.exe" update-all -DefinitionFile:"<BizTalk Installation Folder>\Microsoft.BizTalk.Configuration.EdiAS2.UpgradeR2toR3.xml" -Server:"<BAM Database Server Name>" -Database:"<BAM Database Name>"`

    `"<BizTalk Installation Folder>\Tracking\bm.exe" update-all -DefinitionFile:"<BizTalk Installation Folder>\Microsoft.BizTalk.Configuration.Batching.UpgradeR2toR3.xml" -Server:"<BAM Database Server Name>" -Database:"<BAM Database Name>"`

- <span data-ttu-id="6dbe7-510">**群集上的 SSO 错误**:在 BizTalk Server 运行时群集环境中，当您尝试升级，可能会收到一条错误消息：</span><span class="sxs-lookup"><span data-stu-id="6dbe7-510">**SSO Error on Cluster**: On a BizTalk Server runtime cluster environment, when you try to upgrade, you may receive an error message:</span></span>

    `SSO Master Secret Server service is not running on <Cluster name>.Please start the service to continue the upgrade.` 

    <span data-ttu-id="6dbe7-511">若要解决此问题，请刷新 SSO 服务 SSO 和 BizTalk Server 运行时群集中。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-511">To resolve this issue, refresh the SSO services both in the SSO and BizTalk Server runtime cluster.</span></span>

    <span data-ttu-id="6dbe7-512">**若要刷新 SSO 群集中的 SSO 服务**:</span><span class="sxs-lookup"><span data-stu-id="6dbe7-512">**To refresh the SSO services in SSO cluster**:</span></span>

  1. <span data-ttu-id="6dbe7-513">在群集管理器中，**使联机**包含群集的企业 SSO 服务资源的群集组。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-513">In Cluster Administrator, **Bring Online** the cluster group that contains the clustered Enterprise SSO service resource.</span></span> <span data-ttu-id="6dbe7-514">这应启动的所有资源的群集组中。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-514">This should start all of the resources in the cluster group.</span></span>

  2. <span data-ttu-id="6dbe7-515">**执行脱机**企业 SSO 服务的群集的实例。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-515">**Take Offline** the clustered instance of the Enterprise SSO service.</span></span> <span data-ttu-id="6dbe7-516">然后，将其置于重新**Online**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-516">And then, bring it back **Online**.</span></span>

  3. <span data-ttu-id="6dbe7-517">**移动**群集组。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-517">**Move** the cluster group.</span></span> <span data-ttu-id="6dbe7-518">此步骤应将包含群集的企业 SSO 服务资源的第一个节点到第二个节点的群集组移。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-518">This step should move the cluster group that contains the clustered Enterprise SSO services resource from the first node to the second node.</span></span>

  4. <span data-ttu-id="6dbe7-519">**执行脱机**企业 SSO 服务的群集的实例。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-519">**Take Offline** the clustered instance of the Enterprise SSO service.</span></span> <span data-ttu-id="6dbe7-520">然后，将其置于重新**Online**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-520">And then, bring it back **Online**.</span></span>

     <span data-ttu-id="6dbe7-521">**若要刷新 BizTalk Server 运行时群集中的 SSO 服务**:</span><span class="sxs-lookup"><span data-stu-id="6dbe7-521">**To refresh the SSO services in a BizTalk Server Runtime cluster**:</span></span>

  5. <span data-ttu-id="6dbe7-522">在群集管理器中，**使联机**包含群集的 BizTalk Server 运行时资源的群集组。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-522">In Cluster Administrator, **Bring Online** the cluster group that contains the clustered BizTalk Server runtime resource.</span></span> <span data-ttu-id="6dbe7-523">这应启动的所有资源的群集组中。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-523">This should start all of the resources in the cluster group.</span></span>

  6. <span data-ttu-id="6dbe7-524">**执行脱机**企业 SSO 服务的群集的实例。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-524">**Take Offline** the clustered instance of the Enterprise SSO services.</span></span> <span data-ttu-id="6dbe7-525">然后，将其置于重新**Online**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-525">And then, bring it back **Online**.</span></span>

  7. <span data-ttu-id="6dbe7-526">**移动**群集组。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-526">**Move** the cluster group.</span></span> <span data-ttu-id="6dbe7-527">此步骤应将包含群集的 BizTalk Server 运行时资源的第一个节点到第二个节点的群集组移。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-527">This step should move the cluster group that contains the clustered BizTalk Server runtime resource from the first node to the second node.</span></span>

  8. <span data-ttu-id="6dbe7-528">**执行脱机**企业 SSO 服务的群集的实例。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-528">**Take Offline** the clustered instance of the Enterprise SSO services.</span></span> <span data-ttu-id="6dbe7-529">然后，将其置于重新**Online**。</span><span class="sxs-lookup"><span data-stu-id="6dbe7-529">And then, bring it back **Online**.</span></span>
