---
title: Wcf-webhttp 适配器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 67a353e7-1ba3-427a-8e99-c9b8d83061cb
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7147247c5cbcff97b34904117121f89019796a10
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65250220"
---
# <a name="wcf-webhttp-adapter"></a>Wcf-webhttp 适配器
[!INCLUDE[btsCoName](../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用**Wcf-webhttp**适配器将消息发送到 RESTful 服务。 **Wcf-webhttp**发送适配器通过 BizTalk 消息向服务发送 HTTP 消息。 接收位置接收来自 RESTful 服务的消息。 对于 GET 和 DELETE 请求，适配器不使用任何负载。 对于 POST 和 PUT 请求，适配器使用 BizTalk 消息正文部分 HTTP 内容/负载。  

本主题演示如何创建接收位置和发送端口使用 BizTalk 管理。

## <a name="create-a-receive-location"></a>创建接收位置

> [!NOTE]
>  执行以下过程之前，你必须已添加一个单向接收端口。 请参阅[如何创建接收端口](../core/how-to-create-a-receive-port.md)。  

1. 在 BizTalk Server 管理控制台中，依次展开“ [!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]”、“BizTalk 组” 、“应用程序” ，然后展开要在其下创建接收位置的应用程序。  

2. 在左窗格中，单击“接收端口”  节点，在右窗格中，右键单击你希望将新的接收位置与其关联的接收端口，然后单击“属性” 。  

3. 在“接收端口属性”  对话框的左窗格中，选择“接收位置” ，然后在右窗格中单击“新建”  以创建新的接收位置。  

4. 在“接收位置属性”  对话框的“传输”  部分中，从“类型”  下拉列表中选择“WCF-WebHttp”  ，然后单击“配置”  以配置接收位置的传输属性。  

5. 在中**常规**选项卡上，配置用于接收消息所在的 REST 接口的终结点地址。  


   |            使用此选项             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |---------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |        **地址 (URI)**        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        必需的。 指定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 可在其中接收基于 HTTP 的 RESTful 消息的 URI。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |      **终结点标识**      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          可选。 指定终结点标识。 通过这些设置，终结点可对此接收位置进行验证。 在终结点与接收位置进行握手的过程中，Windows Communication Foundation (WCF) 基础结构将确保预期服务的标识与此元素的值保持一致。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
   | **HTTP 方法和 URL 映射** | BTS 操作映射允许用户根据传入的 HTTP 方法和 URL 子路径将传入的 HTTP 请求映射到消息上下文中的 BTS 操作。 针对一组 HTTP 方法和 URI 模板对传入的 HTTP 方法和 URL 子路径进行匹配。 如果发现匹配项，适配器将使用消息中指定的值将 **BTS.Operation** 属性提升为 BizTalk 消息上下文。<br /><br /> 可以单映射或多映射格式指定 HTTP 方法到 URL 的映射。 多映射格式如下所示：<br /><br /> `<BtsHttpUrlMapping> <Operation Name = "DelCust" Method="DELETE" Url="/Customer/12345</BtsHttpUrlMapping>`<br /><br /> 请注意，在上面的代码段中，客户 ID 是作为常数值 *12345*提供的。 但是，可能存在某些必须在运行时确定客户 ID 或任何其他查询变量的方案。 若要启用此类方案，必须在大括号 {} 内提供 URL 的变量组件。 例如，在上面的代码段中，如果将客户 ID 指定为变量，其内容将如下所示：<br /><br /> `<BtsHttpUrlMapping> <Operation Name = "DelCust" Method="DELETE" Url="/Customer/{ID}</BtsHttpUrlMapping>`<br /><br /> 在这种情况下，还必须指定在运行时必须从什么位置提取变量 **ID** 的值。 你使用 **变量映射**指定该位置。<br /><br />**注意**<br /> 在 URL 字段中，任何特殊 XML 字符必须被"转义"。 这可确保这些特殊 XML 字符是处理，并通过端口保留。 例如，`&`特殊字符必须转义为`&amp;`。 <br /><br />从：<br />`Url=”/Customer?{ID}& group=Location”`<br />若要： <br />`Url=”/Customer?{ID}&amp;group=Location”` |
   |      **变量映射**       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        如果为 HTTP 方法 URL 映射指定了变量，则必须指定变量在运行时映射到的内容。 单击“编辑”  按钮以启动“变量映射”  对话框。 在“变量”  列下，该对话框列出了你为 **HTTP 方法和 URL 映射**定义的变量。 在“属性名称”  字段中，你必须指定属性的名称，该属性提供的值将与变量相关联。 必须已将此属性定义/提升为解决方案的一部分。 你还必须在“属性命名空间”  字段中为该属性提供命名空间。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |


6. 在中**绑定**选项卡上，配置超时和编码相关的属性。  


   |                 使用此选项                  |                                                                                                                                                                                                                                                                                                                                                                                           执行的操作                                                                                                                                                                                                                                                                                                                                                                                           |
   |-------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |        **打开超时 (hh: mmss)**         |                                                                                                                                                                                                                                                               指定一个时间跨度值来表示为完成信道打开操作提供的时间间隔。 此值应大于或等于 **System.TimeSpan.Zero**。<br /><br /> 默认值：00:01:00<br /><br /> 最大值：23:59:59                                                                                                                                                                                                                                                                |
   |        **发送超时 (hh: mmss)**         |                                                                                                                                                                                   指定一个时间跨度值来表示为完成发送操作提供的时间间隔。 此值应大于或等于 **System.TimeSpan.Zero**。 如果使用请求-响应接收端口，则此值指定完成整个交互的时间跨度（即使客户端返回一条大消息）。<br /><br /> 默认值：00:01:00<br /><br /> 最大值：23:59:59                                                                                                                                                                                    |
   |        **关闭超时 (hh: mmss)**        |                                                                                                                                                                                                                                                               指定一个时间跨度值来表示为完成信道关闭操作提供的时间间隔。 此值应大于或等于 **System.TimeSpan.Zero**。<br /><br /> 默认值：00:01:00<br /><br /> 最大值：23:59:59                                                                                                                                                                                                                                                               |
   | **最大接收的消息大小 （字节）** | 指定网络上可接收的消息的最大大小（包括标头），以字节表示。 消息的大小受为每条消息分配的内存量的限制。 你可以使用此属性来降低受拒绝服务 (DoS) 攻击的可能性。<br /><br /> WCF-WebHttp 适配器在缓冲传输模式中利用 [WebHttpBinding](http://msdn.microsoft.com/library/system.servicemodel.webhttpbinding.aspx) 类与终结点进行通信。 对于缓冲传输模式， [WebHttpBinding.MaxBufferSize](http://msdn.microsoft.com/library/system.servicemodel.webhttpbinding.maxbuffersize.aspx) 属性始终等于此属性的值。<br /><br /> 默认值：65536<br /><br /> 最大值：2147483647 |
   |         **最大并发调用数**          |                                                                                                                                                                                                                                                                                    指定针对单个服务实例的并发调用的数目。 超出此限制的调用将在队列中排队。 将该值设置为 0 等效于将它设置为 **Int32.MaxValue**。<br /><br /> 默认值为 200。                                                                                                                                                                                                                                                                                    |


7. 在中**安全**选项卡上，定义的安全性功能的 Wcf-webhttp 接收位置。  


   |               使用此选项               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |--------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |          **安全模式**           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指定使用的安全类型。 包括以下有效值：<br /><br /> -                          **无**:在传输过程中不是安全的消息。<br /><br /> - **传输**:使用 HTTPS 传输提供安全性。 使用 HTTPS 对 SOAP 消息进行保护。 若要使用此模式，你必须在 Microsoft Internet 信息服务 (IIS) 中设置安全套接字层 (SSL)。<br /><br /> - **TransportWithMessageCredential**:HTTPS 传输提供完整性、 机密性和服务身份验证。 若要使用此模式，你必须在 Microsoft Internet 信息服务 (IIS) 中设置安全套接字层 (SSL)。<br /><br /> 默认值为“传输” 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   | **传输客户端凭据类型** | 指定执行客户端验证时要使用的凭据类型。 包括以下有效值：<br /><br /> - **无**:无身份验证发生在传输级别。<br /><br /> - **基本**:基本身份验证。 在基本身份验证中，用户名和密码将以明文形式通过网络发送。 你必须创建与凭据对应的域或本地用户帐户。<br /><br /> - **摘要**:摘要式身份验证。 此身份验证方法与基本身份验证方法相似，不同之处在于密码以哈希值的形式通过网络发送，以增强安全性。 摘要身份验证只可在域控制器运行 Windows Server 操作系统验证的域中使用。 你必须创建与客户端凭据对应的域或本地用户帐户。<br /><br /> -                          **Ntlm**:NTLM 身份验证。 客户端可只发送凭据而不向此接收位置发送密码。 你必须创建与客户端凭据对应的域或本地用户帐户。<br /><br /> -                          **Windows**:Windows 集成身份验证。 Windows Communication Foundation 可与 Kerberos 或 NTLM 协商，如果存在域，则首选使用 Kerberos。 如果要使用 Kerberos，则非常重要的一点是让客户端使用服务主体名称 (SPN) 标识该服务。 你必须创建与客户端凭据对应的域或本地用户帐户。<br /><br /> - **证书**:使用客户端证书的客户端身份验证。 必须将用于客户端 X.509 证书的 CA 证书链安装到此计算机的“受信任根证书颁发机构”证书存储中，以便可以针对此接收位置验证客户端。<br /><br /> **请注意****传输客户端凭据类型**属性必须与匹配的身份验证方案的 IIS 虚拟目录承载此接收位置。 例如，如果该属性设置为“Windows” ，则你还需为此接收位置所在的虚拟目录启用“集成 Windows 验证”  。 相似地，如果将该属性设置为“无” ，则你必须允许匿名访问此接收位置所在的虚拟目录。<br /><br /> 默认值为“Windows” 。 |
   | **服务证书-指纹**  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      为此接收位置指定 X.509 证书的指纹，客户端利用该指纹验证服务。 使用“浏览”  按钮，导航到“当前用户”  位置中“我的”  存储，然后即可选择指纹。<br /><br /> **请注意**必须安装到的服务证书**当前用户**承载此接收位置的接收处理程序的用户帐户的位置。<br /><br /> 最小长度：0<br /><br /> 最大长度：40<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |


8. 在中**行为**选项卡上，指定服务级别和终结点级别不同的行为。 这些行为基于.NET Framework 类。  

    | 使用此选项|执行的操作|  
    |--------------|----------------|  
    | ServiceBehavior | 扩展您的 WCF 服务在服务级别的功能。 您可以添加执行不同的操作，如定义的安全设置、 启用调试，实施限制，并使用其他.NET 类的扩展。  <br/><br/> 右击选择**ServiceBehavior**，并**将扩展添加**。 此列表显示了可用的.NET 类。|
    | EndpointBehavior | 扩展终结点级别收到的请求的它。 可以添加执行不同的操作，如接收来自基于浏览器的 ASP.NET AJAX 客户端的 HTTP 请求，在事务上指定时间间隔选择以同步方式还是以异步方式接收消息的扩展，并使用其他.NET 类。 <br/><br/> 右击选择**EndpointBehavior**，并**将扩展添加**。 此列表显示了可用的.NET 类。|

    WCF 自定义接收位置，这是类似的行为配置。 请参阅**Wcf-custom 传输属性对话框中，接收，行为**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。

9. 在中**消息**选项卡上，指定数据选择 soap**正文**元素。  


   |                使用此选项                |                                                                                   执行的操作                                                                                   |
   |----------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |       **出站 HTTP 标头**        |                                                  指定在响应消息中标记的 HTTP 标头（如果有）。                                                  |
   |    **失败时禁用位置**     |   指定是否禁用由于接收管道故障或路由故障而导致入站处理失败的接收位置。<br /><br /> 默认情况下清除此复选框。    |
   | **在失败时挂起请求消息** | 指定是否将由于接收管道故障或路由故障而导致入站处理失败的请求消息挂起。<br /><br /> 默认值为清除此复选框。 |
   | **在错误中包括异常详细信息** |                            指定发生错误时是否返回 SOAP 错误以方便进行调试。<br /><br /> 默认值为清除此复选框。                             |


10. 单击“确定” 。  

11. 在“接收位置属性”  对话框中输入相应的值，完成对接收位置的配置，然后单击“确定”  保存设置。 有关“接收位置属性”  对话框的信息，请参阅 [如何创建接收位置](../core/how-to-create-a-receive-location.md)。  

## <a name="create-the-send-port"></a>创建发送端口

1. 在 BizTalk 管理控制台中，创建新的发送端口或双击某个现有发送端口以对其进行修改。 请参阅[如何创建发送端口](../core/how-to-create-a-send-port2.md)。 配置所有发送端口选项，并指定**Wcf-webhttp**有关**类型**选项**传输**一部分**常规**选项卡。  

2. 上**常规**选项卡上，在**传输**部分中，单击**配置**按钮。  

3. 在中**常规**选项卡上，配置用于发送消息所在的 REST 接口的终结点地址。  


   |            使用此选项             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   |---------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |        **地址 (URI)**        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       必需的。 指定发送消息所在的 REST 接口的 URI。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |      **终结点标识**      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   可选。 指定终结点标识。 这些设置支持终结点进行身份验证此发送端口。 在终结点与接收位置进行握手的过程中，Windows Communication Foundation (WCF) 基础结构将确保预期服务的标识与此元素的值保持一致。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   | **HTTP 方法和 URL 映射** | BTS 操作映射允许用户根据传入的 HTTP 方法和 URL 子路径将传入的 HTTP 请求映射到消息上下文中的 BTS 操作。 针对一组 HTTP 方法和 URI 模板对传入的 HTTP 方法和 URL 子路径进行匹配。 如果发现匹配项，适配器将使用消息中指定的值将 **BTS.Operation** 属性提升为 BizTalk 消息上下文。<br /><br /> 可以单映射或多映射格式指定 HTTP 方法到 URL 的映射。 多映射格式如下所示：<br /><br /> `BtsHttpUrlMapping> <Operation Name = "DelCust" Method="DELETE" Url="/Customer/12345" /> </BtsHttpUrlMapping>`<br /><br /> 请注意，在上面的代码段中，客户 ID 是作为常数值 *12345*提供的。 但是，可能存在某些必须在运行时确定客户 ID 或任何其他查询变量的方案。 若要启用此类方案，必须在大括号 {} 内提供 URL 的变量组件。 例如，在上面的代码段中，如果将客户 ID 指定为变量，其内容将如下所示：<br /><br /> `<BtsHttpUrlMapping> <Operation Name = "DelCust" Method="DELETE" Url="/Customer/{ID}" /> </BtsHttpUrlMapping>`<br /><br /> 在这种情况下，还必须指定在运行时必须从什么位置提取变量 **ID** 的值。 你使用 **变量映射**指定该位置。 <br /><br />**注意**<br /> 在 URL 字段中，任何特殊 XML 字符必须被"转义"。 这可确保这些特殊 XML 字符是处理，并通过端口保留。 例如，`&`特殊字符必须转义为`&amp;`。 <br /><br />从：<br />`Url=”/Customer?{ID}& group=Location”`<br />若要： <br />`Url=”/Customer?{ID}&amp;group=Location”` |
   |      **变量映射**       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             如果为 HTTP 方法 URL 映射指定了变量，则必须指定变量在运行时映射到的内容。 单击“编辑”  按钮以启动“变量映射”  对话框。 在“变量”  列下，该对话框列出了你为 **HTTP 方法和 URL 映射**定义的变量。 在“属性名称”  字段中，你必须指定属性的名称，该属性提供的值将与变量相关联。 必须已将此属性定义/提升为解决方案的一部分。 你还必须在“属性命名空间”  字段中为该属性提供命名空间。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |


4. 在中**绑定**选项卡上，配置超时和编码相关的属性。  


   |                 使用此选项                  |                                                                                                                                                                                                                                                                                                                                                                                           执行的操作                                                                                                                                                                                                                                                                                                                                                                                           |
   |-------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |        **打开超时 (hh: mmss)**         |                                                                                                                                                                                                                                                               指定一个时间跨度值来表示为完成信道打开操作提供的时间间隔。 此值应大于或等于 **System.TimeSpan.Zero**。<br /><br /> 默认值：00:01:00<br /><br /> 最大值：23:59:59                                                                                                                                                                                                                                                                |
   |        **发送超时 (hh: mmss)**         |                                                                                                                                                                                   指定一个时间跨度值来表示为完成发送操作提供的时间间隔。 此值应大于或等于 **System.TimeSpan.Zero**。 如果使用请求-响应接收端口，则此值指定完成整个交互的时间跨度（即使客户端返回一条大消息）。<br /><br /> 默认值：00:01:00<br /><br /> 最大值：23:59:59                                                                                                                                                                                    |
   |        **关闭超时 (hh: mmss)**        |                                                                                                                                                                                                                                                               指定一个时间跨度值来表示为完成信道关闭操作提供的时间间隔。 此值应大于或等于 **System.TimeSpan.Zero**。<br /><br /> 默认值：00:01:00<br /><br /> 最大值：23:59:59                                                                                                                                                                                                                                                               |
   | **最大接收的消息大小 （字节）** | 指定网络上可接收的消息的最大大小（包括标头），以字节表示。 消息的大小受为每条消息分配的内存量的限制。 你可以使用此属性来降低受拒绝服务 (DoS) 攻击的可能性。<br /><br /> WCF-WebHttp 适配器在缓冲传输模式中利用 [WebHttpBinding](http://msdn.microsoft.com/library/system.servicemodel.webhttpbinding.aspx) 类与终结点进行通信。 对于缓冲传输模式， [WebHttpBinding.MaxBufferSize](http://msdn.microsoft.com/library/system.servicemodel.webhttpbinding.maxbuffersize.aspx) 属性始终等于此属性的值。<br /><br /> 默认值：65536<br /><br /> 最大值：2147483647 |


5. 在中**安全**选项卡上，定义 Wcf-webhttp 发送端口的安全功能。  


   |                使用此选项                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |           **安全模式**            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             指定使用的安全类型。 包括以下有效值：<br /><br /> -   **无**:在传输过程中不是安全的消息。<br />-   **传输**:使用 HTTPS 传输提供安全性。 使用 HTTPS 对 SOAP 消息进行保护。 服务的 X.509 证书的 CA 证书链必须安装在此计算机的受信任的根证书颁发机构证书存储中，以便可以向使用服务的证书的发送端口验证该服务。<br />-   **TransportWithMessageCredential**:HTTPS 传输提供完整性、 机密性和服务身份验证。 服务的 X.509 证书的 CA 证书链必须安装在此计算机上的受信任的根证书颁发机构证书存储中，以便可以向使用服务的证书的发送端口验证该服务。 发送端口验证由 SOAP 消息安全提供。<br /><br /> 默认值是**None**。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |  **传输客户端凭据类型**  | 指定执行客户端验证时要使用的凭据类型。 包括以下有效值：<br /><br /> -   **无**:无身份验证发生在传输级别。<br />-   **基本**:基本身份验证。 在基本身份验证中，用户名和密码将以明文形式通过网络发送。 你必须创建与凭据对应的域或本地用户帐户。<br />-   **摘要**:摘要式身份验证。 此身份验证方法与基本身份验证方法相似，不同之处在于密码以哈希值的形式通过网络发送，以增强安全性。 摘要身份验证只可在域控制器运行 Windows Server 操作系统验证的域中使用。 你必须创建与客户端凭据对应的域或本地用户帐户。<br />-   **Ntlm**:NTLM 身份验证。 客户端可只发送凭据而不向此接收位置发送密码。 你必须创建与客户端凭据对应的域或本地用户帐户。<br />-   **Windows**:Windows 集成身份验证。 Windows Communication Foundation 可与 Kerberos 或 NTLM 协商，如果存在域，则首选使用 Kerberos。 如果要使用 Kerberos，则非常重要的一点是让客户端使用服务主体名称 (SPN) 标识该服务。 你必须创建与客户端凭据对应的域或本地用户帐户。<br />-   **证书**:使用客户端证书的客户端身份验证。 必须将用于客户端 X.509 证书的 CA 证书链安装到此计算机的“受信任根证书颁发机构”证书存储中，以便可以针对此接收位置验证客户端。 **注意：** **传输客户端凭据类型**属性必须与匹配的身份验证方案的 IIS 虚拟目录承载此接收位置。 例如，如果该属性设置为“Windows” ，则你还需为此接收位置所在的虚拟目录启用“集成 Windows 验证”  。 相似地，如果将该属性设置为“无” ，则你必须允许匿名访问此接收位置所在的虚拟目录。 <br /><br /> 默认值为“Windows” 。 |
   |  **客户端证书-指纹**  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   指定用于验证到终结点的此发送端口的 X.509 证书的指纹。 可以通过导航到选择指纹**我**将存储在**当前用户**位置**浏览**按钮。 **注意：** 必须安装到客户端证书**当前用户**承载此发送处理程序的用户帐户的位置的发送端口。 <br /><br /> 最小长度：0<br /><br /> 最大长度：40<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |  **服务证书-指纹**  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指定此发送端口将消息发送到的终结点进行身份验证的 X.509 证书的指纹。 您可以选择导航到的指纹**其他人**将存储在**本地计算机**位置**浏览**按钮。<br /><br /> 最小长度：0<br /><br /> 最大长度：40<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   |       **用户名凭据**        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       指定用于发送消息的凭据。 您可以通过单击指定的属性**编辑**按钮。 如果您选择，则必须设置凭据**用户名**选项**消息客户端凭据类型**。<br /><br /> 默认值是**不使用单一登录**。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |      **使用 ACS 服务标识**      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      适用于[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)]和 BizTalk Server 2013。 <br /><br />选择此复选框，然后单击**编辑**并提供以下值，以使用服务总线进行身份验证。 这是必需的仅当服务总线调用 REST 接口的相关实体。<br /><br /> -   **访问控制服务 STS Uri** – 将此设置为`https://<Namespace>-sb.accesscontrol.windows.net/`，其中\<命名空间\>是服务总线命名空间。<br />-   **颁发者名称**– 指定颁发者名称。 通常将此值设置为 owner。<br />-   **颁发者密钥**– 指定的颁发者密钥。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   | **服务总线连接信息** |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       新开始[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。<br/><br/>选择使用共享访问签名 (SAS) 或访问控制服务 (ACS) 的服务总线命名空间。 <br/><br/>选择一个选项，然后选择**编辑**输入密钥的信息：<br/><br/> - **共享访问签名**:输入访问密钥名称和访问密钥。 这两个值中列出[Azure 门户](https://portal.azure.com)。<br/> - **访问控制服务**:输入 STS URI (`https://<yourNamespace>-sb.accesscontrol.windows.net/`)，颁发者名称和颁发者密钥。 使用 Windows PowerShell 来检索这些值，如中所述[SB 消息适配器](../core/sb-messaging-adapter.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |


6. 在中**行为**选项卡上，配置此发送端口的终结点行为。 

   |使用此选项|执行的操作|  
   |--------------|----------------|  
   | EndpointBehavior | 扩展它的终结点级别发送请求的方式。 可添加的执行不同的操作，例如扩展插件定义 SOAP 处理行为、 指定时间间隔上的事务，控件的发现功能，并使用其他.NET 类。 <br/><br/>右击选择**EndpointBehavior**，并**将扩展添加**。 此列表显示了可用的.NET 类。 |

   这是类似于 WCF 自定义发送端口的终结点行为配置。 请参阅**Wcf-custom 传输属性对话框，发送，行为**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。

7. 在中**代理**选项卡上，配置代理设置的 Wcf-webhttp 发送端口。 


   |              使用此选项               |                                                                                                                                                                                                                                                             执行的操作                                                                                                                                                                                                                                                             |
   |-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | **使用发送处理程序代理设置** |                                                                                                                                                                                            指定此发送端口是否在承载此发送端口的发送处理程序中使用的代理设置。<br /><br /> 这是默认设置。                                                                                                                                                                                             |
   |        **不使用代理**         |                                                                                                                                                                                                                   指示此发送端口使用代理服务器。<br /><br /> 默认值为清除此复选框。                                                                                                                                                                                                                   |
   |            **使用代理**            |                                                                                                                                                                                               指示此发送端口是否使用代理服务器中指定**地址**属性。<br /><br /> 默认值为清除此复选框。                                                                                                                                                                                               |
   |             **Address**             |                                                           指定代理服务器的地址。 使用**https**或**http**具体取决于安全配置的方案。 此地址可以跟一个冒号和端口号。 例如，`http://127.0.0.1:8080`。<br /><br /> 此属性需要值才**使用代理**处于选中状态。<br /><br /> 键入：String<br /><br /> 最大长度：256<br /><br /> 默认值为一个空字符串。                                                           |
   |            **用户名**            | 指定要用于身份验证的用户名。 如果使用集成身份验证，则用户名将包括域，即，域 \ 用户名。 如果使用基本或摘要式身份验证，则用户名不包括域\\。 此属性需要值才**使用代理**处于选中状态。 **注意：** Wcf-webhttp 发送适配器将使用基本身份验证代理。 <br /><br /> 键入：String<br /><br /> 最小长度：0<br /><br /> 最大长度：256<br /><br /> 默认值为一个空字符串。 |
   |            **密码**             |                                                                                                                                  指定要用于身份验证的密码。<br /><br /> 此属性需要值才**使用代理**处于选中状态。<br /><br /> 键入：String<br /><br /> 最小长度：0<br /><br /> 最大长度：256<br /><br /> 默认值为一个空字符串。                                                                                                                                  |


8. 在中**消息**选项卡上，指定如何将消息发送到 REST 接口。  


   |          使用此选项           |                                                                                                                                                                                                                                                                                                                                               执行的操作                                                                                                                                                                                                                                                                                                                                                |
   |-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |  **出站 HTTP 标头**  |                                                                                                                                                                                                                                                                                                              指定在响应消息中标记的 HTTP 标头（如果有）。                                                                                                                                                                                                                                                                                                               |
   | **为谓词取消正文** | 根据用于调用 REST 终结点的谓词，可能会或可能不需要消息负载。 例如，您可能不使用 GET 或 DELETE 谓词时需要消息负载。 但是，若要触发调用 REST 终结点使用的发送端口，可能会使用包含消息负载的虚拟消息。 将消息发送到 REST 终结点之前，必须删除虚拟消息中的消息有效负载。 可以指定为其消息负载必须删除使用的动词**为谓词取消正文**属性。<br /><br /> 例如，如果你想要使用 GET 谓词时删除消息负载，指定为此属性的值为`GET`。 |


9. 单击**确定**并**确定**次以保存设置。  

## <a name="import-wcf-extensions"></a>导入 WCF 扩展

在接收处理程序或发送处理程序中导入 WCF 扩展：

1. 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]内，展开[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]内，展开**BizTalk 组**，展开**平台设置**，然后展开**适配器**.  

2. 选择**Wcf-webhttp**，然后双击选择接收或发送处理程序。  

3. 在常规选项卡，选择**属性**。 

4. 在中**WCF 扩展**，选择**导入**，并浏览到 WCF 扩展配置文件。 


## <a name="add-a-proxy-to-the-send-handler"></a>将代理添加到的发送处理程序

可以将代理添加到发送端口或发送处理程序。 如果要在发送端口添加代理，则跳过此部分。

1. 在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，展开[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]内，展开**BizTalk 组**，展开**平台设置**，然后展开**适配器**.  

2. 选择**Wcf-webhttp**，然后选择发送处理程序。  

3. 在中**适配器处理程序属性**，然后在**常规**选项卡上，选择**属性**。  

4. 在中**代理**选项卡上，执行以下操作。  


   |   使用此选项    |                                                                                                                                                                                                                        执行的操作                                                                                                                                                                                                                        |
   |---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | **使用代理** |                                                                                                                                                                            指示此发送处理程序是否使用代理服务器。<br /><br /> 默认值为清除此复选框。                                                                                                                                                                             |
   |  **Address**  |                      指定代理服务器的地址。 使用**https**或**http**具体取决于安全配置的方案。 此地址可以跟一个冒号和端口号。 例如，`http://127.0.0.1:8080`。<br /><br /> 此属性需要值才**使用代理**处于选中状态。<br /><br /> 键入：String<br /><br /> 最大长度：256<br /><br /> 默认值为一个空字符串。                      |
   | **用户名** | 指定要用于身份验证的用户名。 如果使用集成或基本身份验证，则用户名将包括域，即，域 \ 用户名。 如果使用摘要式身份验证，则用户名不包括域\\。<br /><br /> 此属性需要值才**使用代理**处于选中状态。<br /><br /> 键入：String<br /><br /> 最小长度：0<br /><br /> 最大长度：256<br /><br /> 默认值为一个空字符串。 |
   | **密码**  |                                                                                             指定要用于身份验证的密码。<br /><br /> 此属性需要值才**使用代理**处于选中状态。<br /><br /> 键入：String<br /><br /> 最小长度：0<br /><br /> 最大长度：256<br /><br /> 默认值为一个空字符串。                                                                                             |


5. 单击**确定**直到您退出所有对话框。  

## <a name="see-also"></a>请参阅  
[SB 消息适配器](../core/sb-messaging-adapter.md)

[使用适配器](../core/using-adapters.md)

[WCF 适配器概述](../core/what-are-the-wcf-adapters.md)
