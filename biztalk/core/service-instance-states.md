---
title: 服务实例状态 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- service instances, states
- messages, processing
- states, service instances
ms.assetid: 38189538-72b3-49df-810b-e134362e35ef
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e45123ab831f06220d594b3d4e71c9c7269b1138
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65393289"
---
# <a name="service-instance-states"></a>服务实例状态
处理一条消息时，执行以下操作：  
  
- 在接收位置，接收适配器，或传输组件 — 从外部应用程序接收消息并将其提交到 BizTalk Server 进行处理。  
  
  > [!NOTE]
  >  通过以不同的格式中的系统收到消息：XML、 平面文件，或作为公司之间的电子数据交换 (EDI)。  
  
- 接收管道解密、 解码并拆装消息。  
  
- 消息引擎发送消息和及其快捷方式属性，如消息类型和源 — 到 MessageBox 数据库。  
  
- 当找到匹配的订阅时，根据一组架构和映射，并有时业务规则或驻留在主机服务器的策略被处理该消息。  
  
- 对其进行处理后，生成的消息将保存 （写入） 到 MessageBox 数据库。 快捷方式属性已被修改以指示要向何处发送该消息，例如，发送端口使用。  
  
- 根据定义为发送端口的筛选器表达式进行计算消息的快捷方式属性和 MessageBox 数据库的消息传递到相应的发送端口。  
  
- 要发送的消息必须满足对发送管道和/或发送端口的订阅。 加密消息，并将其传输。  
  
  在此循环中的每个进程生成自己的事件集。  
  
  作为服务实例 （接收端口、 业务流程、 发送端口） 通过 BizTalk Server 处理消息，这些服务实例可以是几种状态之一。 本部分讨论在其生命周期中的不同时间的这些状态是什么，并显示了示例的状态。  
  
## <a name="service-instance-states"></a>服务实例状态  
 下表显示了具有每个状态说明的服务实例的各种可能状态。  
  
|State|解释|  
|-----------|-----------------|  
|**在断点处**|活动业务流程遇到断点，通常一组由 BizTalk Server 解决方案开发人员。 此状态是仅对业务流程有效。|  
|**已准备好运行**|已激活但未更新的服务实例尚未开始运行，通常由于暂时不可用的资源，例如处理服务器上的负载过大。|  
|**在职**|运行服务实例。|  
|**冻结**|实例状态保持在 MessageBox 数据库，并且没有任何 Windows 服务正在运行该实例。|  
|**已完成，但消息被放弃**|服务实例已完成，但某些消息未被该实例。|  
|**已挂起 （可恢复）**|挂起的实例，则可以恢复它。 **重要提示：** 恢复消息实例将执行以下操作： <ul><li>恢复消息实例。</li><li>将消息发送到发送端口。</li><li>发送端口的消息传递到目标;即使发送端口未处于已启动状态。</li></ul> <br /><br /> 请注意，如果您挂起某一计划的实例，然后将其恢复该实例将进入冻结状态。|  
|**挂起 （不可恢复）**|实例已挂起，但您不能恢复它。 可以保存实例，引用的消息，然后终止该实例。<br /><br /> 请注意，如果您挂起某一计划的实例，然后将其恢复该实例将进入冻结状态。|  
|**待定挂起 / 待定终止**|状态，不是独立的状态。 您可以将其与其他状态。<br /><br /> 若要挂起或终止控制消息已发送到服务实例，但具有未尚未提取该实例。 仅允许一个待定操作一次。 当具有挂起的操作的实例被冻结时，可以终止该实例。|  
  
### <a name="tracked-service-instance-states"></a>跟踪的服务实例状态  
 下表显示了服务实例跟踪状态以及每种状态的说明。  
  
|State|解释|  
|-----------|-----------------|  
|**已启动**|任何目前在 MessageBox 中，例如，在已挂起 （可恢复） 的服务实例或在断点处的状态，显示为已启动 BizTalk 跟踪数据库中。|  
|**已完成**|服务实例处理已成功完成。|  
|**终止**|服务实例已终止。|  
  
## <a name="message-states"></a>消息状态  
 下表显示了一条消息，以及每种状态的说明的状态。  
  
|State|解释|  
|-----------|-----------------|  
|**使用**|是由服务实例正在处理的消息。|  
|**在过程中**|消息已传送到引擎，正在进行处理。 它是在内存中。|  
|**排入队列**|已排队包含已排队 （等待处理）、 已排队 （计划以后送达），并已排队 （等待重试） 实例状态。|  
|**已排队 （等待处理）**|在前面的消息按序的送达发送端口正在重试时，则消息将按序的送达方案中。|  
|**已排队 （计划以后送达）**|正在等待通过已设置的服务时段的发送端口发送消息。|  
|**已排队 （等待重试）**|该消息是与尝试重新发送该由于目标 URI 不可用的发送端口相关联。|  
|**已挂起**|包含已挂起的已挂起 （恢复） 和已挂起 （不可恢复） 实例状态。|  
|**已挂起 （可恢复）**|与消息关联的服务实例挂起时，并可以恢复。<br /><br /> 恢复消息实例将执行以下操作：<br /><br /> -恢复消息实例。<br />-将消息发送到发送端口。<br />-发送端口的消息传递到目标;即使发送端口未处于已启动状态。|  
|**挂起 （不可恢复）**|与消息关联的服务实例已挂起，但无法恢复。|  
  
## <a name="instance-states-before-and-after-an-operation"></a>实例状态操作之前和之后  
 下表显示了状态之前和之后的操作。  
  
> [!NOTE]
>  开始和结束状态显示为粗体中的左列和顶行。 该操作显示在表的正文中。  
  
|正在启动状态|应用操作后的新状态|||||||  
|--------------------|------------------------------------------|------|------|------|------|------|------|  
||**在断点处**|**在职**|**冻结**|**已挂起**|**终止**|**待定终止**|**待定挂起**|  
|**在断点处**|从调试器附加|从调试器继续|停止 Windows 服务|||终止|挂起|  
|**在断点处 （冻结）**|从调试器附加|从调试器继续|停止 Windows 服务|挂起|终止|||  
|**已准备好运行**||||挂起|终止|||  
|**已计划**||运行时提取实例由于服务时段已开始||||||  
|**在职**|||停止 Windows 服务|||终止|挂起|  
|**冻结**||运行时提取实例|停止 Windows 服务|挂起|终止|||  
|**已挂起 （可恢复）**|在调试器中的断点处恢复|恢复|||终止|||  
|**挂起 （不可恢复）**|||||终止|||  
|**已终止且带有未使用的消息**|||||终止|||  
|**待定挂起**|附加可尝试但最终会失败||停止 Windows 服务|处理请求|终止已冻结实例时才会起|||  
|**待定终止**|附加可尝试但最终会失败||停止 Windows 服务，冻结实例||请求已处理或实例已冻结|||  
  
## <a name="instance-states-during-an-operation"></a>在操作期间的实例状态  
 下表显示状态的更改时系统将执行的实例上的操作。  
  
|正在启动状态|操作||||||  
|--------------------|---------------|------|------|------|------|------|  
||**终止**|**挂起**|**恢复**|**在断点处恢复**|**Continue**|**附加**|  
|**在断点处**|终止|挂起|||在职|在断点处|  
|**在断点处 （冻结）**|终止|挂起|||在职|在断点处|  
|**准备好为运行**|终止|挂起|||||  
|**已计划**|终止|挂起|||||  
|**在职**|终止|挂起|||||  
|**冻结**|终止|挂起|||||  
|**已挂起 （可恢复）**|终止||在职|在断点处|||  
|**挂起 （不可恢复）**|终止||||||  
|**已终止且带有未使用的消息**|终止||||||  
|**待定挂起**|终止;只能冻结实例时|||||争用条件|  
|**待定终止**|终止;仅将适用，已冻结实例时|||||争用条件|  
  
> [!NOTE]
>  系统将多个控制消息传送到该实例，并不保证该实例处理它们的顺序时发生的争用条件。  
  
## <a name="see-also"></a>请参阅  
 [使用“组中心”页](../core/using-the-group-hub-page.md)