---
title: 服务实例状态 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- service instances, states
- messages, processing
- states, service instances
ms.assetid: 38189538-72b3-49df-810b-e134362e35ef
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5e6eca4af163e3b493eb2d2916f3866366c389cc
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "37022437"
---
# <a name="service-instance-states"></a>服务实例状态
在处理消息时，将会执行以下操作：  
  
- 在接收位置，接收适配器（或传输组件）从外部应用程序接收消息，并将其提交到 BizTalk Server 进行处理。  
  
  > [!NOTE]
  >  系统可以接收各种格式的消息：XML、平面文件或作为公司间的电子数据交换 (EDI)。  
  
- 接收管道解密、解码并拆装该消息。  
  
- 消息引擎将该消息及其快捷方式属性（例如消息类型和源）发送到 MessageBox 数据库。  
  
- 在找到相匹配的订阅后，将根据一组架构和映射来处理该消息，有时也根据主机服务器上的业务规则或策略来处理该消息。  
  
- 在处理完该消息后，最终生成的消息将保存（写入）到 MessageBox 数据库中。 此时已对快捷方式属性进行了修改，以指示从何处发送该消息，例如，使用哪个发送端口。  
  
- 该消息的快捷方式属性将根据为发送端口定义的筛选器表达式进行计算，然后，MessageBox 数据库将该消息传送到相应的发送端口。  
  
- 对发送管道和/或发送端口的订阅必须与要发送的消息相匹配。 将会对该消息进行加密并进行传输。  
  
  在此循环中的每个进程都会生成自己的事件集。  
  
  当服务实例（接收端口、业务流程、发送端口）处理通过 BizTalk Server 的消息时，这些服务实例的状态可以为以下状态之一。 本部分对这些状态进行了介绍，并提供了在它们生命周期的不同时间的状态示例。  
  
## <a name="service-instance-states"></a>服务实例状态  
 下表列出了服务实例的各种可能状态，并对每个状态进行了说明：  
  
|State|解释|  
|-----------|-----------------|  
|**在断点处**|活动业务流程遇到断点，通常是 BizTalk Server 解决方案开发人员设置的断点。 该状态仅对业务流程有效。|  
|**已准备好运行**|已激活但尚未开始运行的服务实例，通常由于资源暂时不可用，例如服务器的处理负载过大。|  
|**在职**|正在运行的服务实例。|  
|**冻结**|实例状态保持在 MessageBox 数据库中，并且没有 Windows 服务运行该实例。|  
|**已完成，但消息被放弃**|该服务实例已完成，但某些消息未被该实例使用。|  
|**已挂起 （可恢复）**|实例已挂起，但可恢复该实例。 **重要说明：** 恢复消息实例将执行以下操作： <ul><li>恢复消息实例。</li><li>将消息发送到发送端口。</li><li>发送端口将消息传送到目标（即使发送端口未处于“已启动”状态）。</li></ul> <br /><br /> 请注意，在你挂起某一计划实例然后恢复它时，该实例将进入冻结状态。|  
|**挂起 （不可恢复）**|实例已挂起，且不可恢复该实例。 可以保存该实例所引用的消息，然后终止该实例。<br /><br /> 请注意，在你挂起某一计划实例然后恢复它时，该实例将进入冻结状态。|  
|**待定挂起 / 待定终止**|一种状态，但不是独立的状态。 可以将其与其他状态相结合。<br /><br /> 要挂起或终止的控制消息已发送到服务实例，但该实例尚未提取该控制消息。 一次只允许一个待定操作。 当具有暂停操作的实例被冻结时，可以终止该实例。|  
  
### <a name="tracked-service-instance-states"></a>跟踪的服务实例状态  
 下表显示服务实例跟踪状态，每种状态都附有说明。  
  
|State|解释|  
|-----------|-----------------|  
|**已启动**|当前在 MessageBox 中的任何服务实例（例如处于“已挂起(可恢复)”状态或“在断点处”状态的服务实例）在 BizTalk 跟踪数据库中都显示为“已启动”。|  
|**已完成**|服务实例处理已成功完成。|  
|**终止**|服务实例已终止。|  
  
## <a name="message-states"></a>消息状态  
 下表显示消息的状态，以及每个状态的说明。  
  
|State|解释|  
|-----------|-----------------|  
|**使用**|消息正在由服务实例进行处理。|  
|**在过程中**|消息已经传送到引擎并且正在进行处理。 消息在内存中。|  
|**排入队列**|“已排队”包括 3 种状态：“已排队(等待处理)”、“已排队(计划以后送达)”和“已排队(等待重试)”。|  
|**已排队 （等待处理）**|当按序送达发送端口正在重试上一条消息时，该消息处于按序送达状态下。|  
|**已排队 （计划以后送达）**|消息正在等待通过已设置服务时段的发送端口进行发送。|  
|**已排队 （等待重试）**|该消息与由于目标 URI 不可用而正在尝试重新发送该消息的发送端口相关联。|  
|**已挂起**|“已挂起”包括“已挂起(可恢复)”和“已挂起(不可恢复)”实例状态。|  
|**已挂起 （可恢复）**|与消息相关联的服务实例已挂起，并且可以恢复。<br /><br /> 恢复消息实例将执行以下操作：<br /><br /> -恢复消息实例。<br />-将消息发送到发送端口。<br />-发送端口的消息传递到目标;即使发送端口未处于已启动状态。|  
|**挂起 （不可恢复）**|与此消息关联的服务实例已挂起，但无法恢复。|  
  
## <a name="instance-states-before-and-after-an-operation"></a>操作前后的实例状态  
 下表显示了操作前后的状态：  
  
> [!NOTE]
>  开始和结束状态在左列和顶行中加粗显示。 操作显示在表的正文中。  
  
|开始状态|应用操作后的新状态|||||||  
|--------------------|------------------------------------------|------|------|------|------|------|------|  
||**在断点处**|**在职**|**冻结**|**已挂起**|**终止**|**待定终止**|**待定挂起**|  
|**在断点处**|从调试器附加|从调试器继续|停止 Windows 服务|||Terminate|挂起|  
|**在断点处 （冻结）**|从调试器附加|从调试器继续|停止 Windows 服务|挂起|Terminate|||  
|**已准备好运行**||||挂起|Terminate|||  
|**已计划**||运行时将提取实例，因为服务时段已开始||||||  
|**在职**|||停止 Windows 服务|||Terminate|挂起|  
|**冻结**||运行时提取实例|停止 Windows 服务|挂起|Terminate|||  
|**已挂起 （可恢复）**|在调试器中从断点处恢复|恢复|||Terminate|||  
|**挂起 （不可恢复）**|||||Terminate|||  
|**已终止且带有未使用的消息**|||||Terminate|||  
|**待定挂起**|可以尝试附加，但最终会失败||停止 Windows 服务|请求已处理|只有在冻结实例时，终止才会起作用|||  
|**待定终止**|可以尝试附加，但最终会失败||停止 Windows 服务，冻结实例||请求已处理，或实例已冻结|||  
  
## <a name="instance-states-during-an-operation"></a>操作期间的实例状态  
 下表显示了系统对实例执行操作时状态的更改情况：  
  
|开始状态|运算||||||  
|--------------------|---------------|------|------|------|------|------|  
||**终止**|**挂起**|**恢复**|**在断点处恢复**|**Continue**|**附加**|  
|**在断点处**|Terminated|挂起|||在职|在断点处|  
|**在断点处 （冻结）**|Terminated|挂起|||在职|在断点处|  
|**准备好为运行**|Terminated|挂起|||||  
|**已计划**|Terminated|挂起|||||  
|**在职**|Terminated|挂起|||||  
|**冻结**|Terminated|挂起|||||  
|**已挂起 （可恢复）**|Terminated||在职|在断点处|||  
|**挂起 （不可恢复）**|Terminated||||||  
|**已终止且带有未使用的消息**|Terminated||||||  
|**待定挂起**|已终止；只有在冻结实例时才会起作用|||||争用条件|  
|**待定终止**|终止;仅将适用，已冻结实例时|||||争用条件|  
  
> [!NOTE]
>  当系统向实例传送多个控制消息，并且该实例处理控制消息的顺序得不到保证时便会发生争用条件。  
  
## <a name="see-also"></a>请参阅  
 [使用“组中心”页](../core/using-the-group-hub-page.md)