---
title: 如何创建接收调用的业务流程上的订阅 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3423309a-cb5a-40a5-9582-6ee3ac82b538
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b4c1e32e6d14673ba0a06a45e08d25c531824e1d
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65385478"
---
# <a name="how-to-create-receive-subscriptions-at-invoked-orchestrations"></a>如何创建接收调用的业务流程上的订阅
尽管您可以将消息传递作为参数通过**启动业务流程**形状在启动业务流程，在某些情况下，你可能想要从调用方业务流程向后调用的业务流程发送消息时调用。 例如，您可能不知道你想要在调用时传递什么的消息或其他业务流程可能需要动态地将消息发送到调用的业务流程。  
  
 若要将消息发送到调用的业务流程的方法是传入一个相关，因此调用的业务流程可以创建该相关帮助定义和使用该订阅，然后接收消息的订阅。 但是，您不能只需传入一个相关和预期调用的业务流程创建基于该相关订阅和接收订阅中的消息。 如果使用这种方法，从调用方业务流程向调用的业务流程发送的消息将导致错误，"找不到订户，无法路由发布的消息"。 这是由于以下原因：  
  
- 在调用的业务流程是一个争用条件。  
  
- 没有提交点调用的业务流程将发送到 MessageBox 数据库的路由，以便它可以接收消息的订阅。  
  
  若要解决此问题一种方法是执行以下步骤：  
  
1. 在调用方业务流程，你具有某个激活接收以接收消息。 调用方业务流程中接收消息、 初始化相关集，并将相关集和一个自相关接收直接绑定端口通过后**启动业务流程**形状。 传入的端口将变为调用的业务流程中的发送端口，并且将来将消息发送回调用方业务流程与同步。  
  
2. 调用的业务流程，在发送回调用方业务流程通过自相关端口的消息。 这与调用方业务流程以避免出现争用情况并创建到 MessageBox 以路由中调用的业务流程的接收订阅时提供提交点同步。  
  
3. 调用方业务流程接收通过自相关端口的消息，并将与调用的业务流程进行同步。 请注意，自相关端口接收不需要再指定相关。 现在可以安全地发送消息从调用方业务流程到调用的业务流程，并且调用的业务流程将收到根据相关的消息。  
  
   尽管上述方法可以实现目标，更好的方法是传入你想要接收所基于的相关进行初始化的消息。 在与通过自相关端口调用的业务流程同步调用方业务流程，我们建议始终传递你需要对相关进行初始化的消息中。 以下步骤提供最可靠、 最高性能方法：  
  
4. 在调用方业务流程，你具有某个激活接收以接收消息。 在收到消息后，消息传递和一个自相关接收直接绑定端口穿过**启动业务流程**形状。 您在传入的消息将用于初始化中调用的业务流程相关。 传入的端口将变为调用的业务流程中的发送端口，并且将来将消息发送回调用方业务流程与同步。  
  
5. 在调用的业务流程，初始化该相关和将消息发送回调用方业务流程。 这与调用方业务流程以避免出现争用情况并创建到 MessageBox 以路由中调用的业务流程的接收订阅时提供提交点同步。  
  
6. 调用方业务流程接收通过自相关端口的消息，并将与调用的业务流程进行同步。 请注意，自相关端口接收不需要再指定相关。 现在可以安全地发送消息从调用方业务流程到调用的业务流程，并且调用的业务流程将收到根据相关的消息。  
  
## <a name="see-also"></a>请参阅  
 [业务流程中使用的相关性](../core/using-correlations-in-orchestrations.md)   
 [如何使用自相关直接绑定端口](../core/how-to-use-self-correlating-direct-bound-ports.md)