---
title: DTA 跟踪的 Mst 的提示和技巧 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 7d72e4ac-d952-4cff-9a65-491e20945d40
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 56d36b6f6be249820e0e24e2ec76151ab47e620b
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65298646"
---
# <a name="tips-and-tricks-for-finding-mst-of-dta-tracking"></a><span data-ttu-id="89663-102">DTA 跟踪的 Mst 的提示和技巧</span><span class="sxs-lookup"><span data-stu-id="89663-102">Tips and Tricks for Finding MST of DTA Tracking</span></span>
<span data-ttu-id="89663-103">根据定义，MST 是以可重现方式度量使用常量负载的系统性能的基准。</span><span class="sxs-lookup"><span data-stu-id="89663-103">By definition, MST is a benchmark to reproducibly measure system performance using a constant load.</span></span> <span data-ttu-id="89663-104">以下是情况下，了解 MST 时特别有用。</span><span class="sxs-lookup"><span data-stu-id="89663-104">Following are situations where knowing the MST is particularly useful.</span></span>  
  
1. <span data-ttu-id="89663-105">**当你需要从系统的最低延迟**。</span><span class="sxs-lookup"><span data-stu-id="89663-105">**When you require the lowest latency from the system**.</span></span> <span data-ttu-id="89663-106">超出 MST 将导致积压工作中在系统中，从而增加的延迟的消息。</span><span class="sxs-lookup"><span data-stu-id="89663-106">Exceeding MST results in backlog in the system, which introduces increased latency for messages.</span></span> <span data-ttu-id="89663-107">即使积压只是临时的积压工作将会对延迟时间立即和负面影响。</span><span class="sxs-lookup"><span data-stu-id="89663-107">Even if the backlog is only temporary, backlog has an immediate and deleterious effect on latency.</span></span> <span data-ttu-id="89663-108">因此，了解您的系统 MST 将告诉您应在单个消息 （例如，从秒到几分钟，具体取决于你的配置） 显著处理增加的延迟之前实现的绝对最大吞吐量。</span><span class="sxs-lookup"><span data-stu-id="89663-108">So, knowing your systems MST will tell you the absolute maximum throughput you should expect to achieve before the latency of individual message processing increases dramatically (for example, from seconds to minutes depending on your configuration).</span></span>  
  
2. <span data-ttu-id="89663-109">**将与其他系统进行比较时**。</span><span class="sxs-lookup"><span data-stu-id="89663-109">**When comparing to other systems**.</span></span> <span data-ttu-id="89663-110">例如，如果你想要验证您获得预期的 MST 相比到另一个系统 （例如，本主题、 案例研究或在你的环境中的另一个系统中的方案）;度量 MST 使用稳定的输入提供了一可重现的、 明确的标准，用于比较。</span><span class="sxs-lookup"><span data-stu-id="89663-110">For example, if you want to validate that you are achieving the expected MST compared to another system (for example, the scenario in this topic, a case study, or another system in your environment); measuring MST using a steady input offers a reproducible, unambiguous standard for comparison.</span></span>  
  
   <span data-ttu-id="89663-111">不用说，但是，它可以是度量 MST 的耗时。</span><span class="sxs-lookup"><span data-stu-id="89663-111">Needless to say, however, it can be time consuming to measure MST.</span></span> <span data-ttu-id="89663-112">因此，着手进行测量它之前，应该权衡利益。</span><span class="sxs-lookup"><span data-stu-id="89663-112">Therefore, before you embark on a lengthy exercise to measure it, you should evaluate the benefits.</span></span> <span data-ttu-id="89663-113">大多数生产系统不会遇到的稳定的输入度量 MST，但负载而是随着时间推移而变化。</span><span class="sxs-lookup"><span data-stu-id="89663-113">Most production systems will not experience a steady input such as that measured by MST, but rather a load that changes over time.</span></span> <span data-ttu-id="89663-114">它是最终必须测试来验证系统在生产前的此负载配置文件。</span><span class="sxs-lookup"><span data-stu-id="89663-114">It is this load profile that must ultimately be tested to certify a system prior to production.</span></span> <span data-ttu-id="89663-115">幸运的是，您可以使用用于度量 MST 评估你的生产负载配置文件的可维持性的相同技术。</span><span class="sxs-lookup"><span data-stu-id="89663-115">Fortunately, you can use the same technique that is used to measure MST to evaluate the sustainability of your production load profile.</span></span> <span data-ttu-id="89663-116">只需运行时间不足以包含一个或多个 BizTalkDTADb 数据库数据保留时段的加载配置文件并观察关键性能指标 (KPI)。</span><span class="sxs-lookup"><span data-stu-id="89663-116">Simply run your load profile long enough to include one or more BizTalkDTADb database data retention windows and observe the key performance indicators (KPI).</span></span>  
  
   <span data-ttu-id="89663-117">务必要开始在测试运行过程中，是否 MST 还是负载状况，使用一个空的 BizTalkDTADb 数据库操作。</span><span class="sxs-lookup"><span data-stu-id="89663-117">It is important to start your test runs, whether MST or load profiles, with an empty BizTalkDTADb database.</span></span> <span data-ttu-id="89663-118">存储在 BizTalkDTADb 数据库中的数据是时间敏感，如果它未重新获取从零开始的每个测试运行，但可能会扭曲结果。</span><span class="sxs-lookup"><span data-stu-id="89663-118">The data that is stored in the BizTalkDTADb database is time sensitive and if it is not re-acquired from scratch for each test run, it can skew your results.</span></span> <span data-ttu-id="89663-119">具体取决于你的数据保留时段，这会大大增加找到 MST 所需的时间。</span><span class="sxs-lookup"><span data-stu-id="89663-119">Depending on your data retention window, this can significantly increase the time it takes to find MST.</span></span> <span data-ttu-id="89663-120">若要缓解此问题，在测试运行期间调整负载"动态"可在更多快地关注 MST。</span><span class="sxs-lookup"><span data-stu-id="89663-120">To mitigate this, adjusting load "on the fly" during test runs can be useful in more quickly zeroing in on MST.</span></span>  
  
   <span data-ttu-id="89663-121">例如，如果您发现已通过在第一个保留时段时间，Kpi 指示留有空间用于更高的吞吐量 （例如，磁盘空闲时间是仍高于零），可以以增量方式增加您的负载并观察效果。</span><span class="sxs-lookup"><span data-stu-id="89663-121">For example, if you find that you have passed your first retention window time and the KPIs indicate you have headroom for higher throughput left (for example, disk idle time is still above zero), you can incrementally increase your load and observe the effect.</span></span> <span data-ttu-id="89663-122">但是，优化您以这种方式的 MST 评估后，是必须执行从一个空的 BizTalkDTADb 数据库来验证您的评估开始运行的测试。</span><span class="sxs-lookup"><span data-stu-id="89663-122">After you have refined your MST estimate in this way, however, it is important that you perform a test run starting with an empty BizTalkDTADb database to validate your estimate.</span></span>  
  
## <a name="recommendations"></a><span data-ttu-id="89663-123">建议</span><span class="sxs-lookup"><span data-stu-id="89663-123">Recommendations</span></span>  
 <span data-ttu-id="89663-124">跟踪中的系统体系结构[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]能够跟踪范围广泛的信息，并必须管理并仔细监视。</span><span class="sxs-lookup"><span data-stu-id="89663-124">The tracking system architecture in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is capable of tracking a wide variety of information and must be managed and monitored carefully.</span></span> <span data-ttu-id="89663-125">由 MST，最将影响您性能的因素是系统的，如下所示：</span><span class="sxs-lookup"><span data-stu-id="89663-125">The factors that will most affect the performance of your system, as indicated by MST, are as follows:</span></span>  
  
- <span data-ttu-id="89663-126">系统所需的吞吐量。</span><span class="sxs-lookup"><span data-stu-id="89663-126">The desired throughput for the system.</span></span>  
  
- <span data-ttu-id="89663-127">每个消息和服务实例在系统中跟踪的信息量。</span><span class="sxs-lookup"><span data-stu-id="89663-127">The volume of information tracked for each message and service instance in the system.</span></span> <span data-ttu-id="89663-128">这将确定 BizTalkDTADb 数据库的大小的增加速度，并最终何种频率 BizTalkDTADb 数据库必须清除以避免落在后面。</span><span class="sxs-lookup"><span data-stu-id="89663-128">This will determine how quickly the size of the BizTalkDTADb database increases, and ultimately how often the BizTalkDTADb database must be purged to avoid falling behind.</span></span>  
  
- <span data-ttu-id="89663-129">多长时间，你想要保留在 BizTalkDTADb 数据库中，即，数据保持期窗口的数据。</span><span class="sxs-lookup"><span data-stu-id="89663-129">How long you wish to retain data in the BizTalkDTADb database, that is, the data retention window.</span></span> <span data-ttu-id="89663-130">该时段越长，较大 BizTalkDTADb 数据库将增加，对吞吐量造成影响。</span><span class="sxs-lookup"><span data-stu-id="89663-130">The longer the window, the larger the BizTalkDTADb database will grow, affecting throughput.</span></span>  
  
- <span data-ttu-id="89663-131">将存档的 BizTalkDTADb 数据库数据，以及清除，还是只清除以保持 BizTalkDTADb 数据库大小。</span><span class="sxs-lookup"><span data-stu-id="89663-131">Whether you archive BizTalkDTADb database data as well as purge, or just purge to maintain BizTalkDTADb database size.</span></span>  
  
  <span data-ttu-id="89663-132">查找对其进行跟踪的最大可承受吞吐量的过程[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]涉及三个关键性能指标：</span><span class="sxs-lookup"><span data-stu-id="89663-132">The process of finding the maximum sustainable throughput for tracking in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] involves three key performance indicators:</span></span>  
  
- <span data-ttu-id="89663-133">物理磁盘空闲时间 DTAdb 数据文件磁盘子系统。</span><span class="sxs-lookup"><span data-stu-id="89663-133">Physical Disk Idle Time for the DTAdb data file disk subsystem.</span></span>  
  
- <span data-ttu-id="89663-134">后台处理深度</span><span class="sxs-lookup"><span data-stu-id="89663-134">Spool depth</span></span>  
  
- <span data-ttu-id="89663-135">BizTalkDTADbData 深度</span><span class="sxs-lookup"><span data-stu-id="89663-135">BizTalkDTADbData depth</span></span>  
  
  <span data-ttu-id="89663-136">查找您的系统的 MST 或通过监视寻找这些三个关键性能指标来验证你的生产状况吞吐量：</span><span class="sxs-lookup"><span data-stu-id="89663-136">Find either your systems’ MST or validate your production profile throughput by monitoring these three key performance indicators looking for:</span></span>  
  
- <span data-ttu-id="89663-137">稳定的后台处理和 trackingdata 表深度。</span><span class="sxs-lookup"><span data-stu-id="89663-137">Stable spool and trackingdata table depth.</span></span>  
  
- <span data-ttu-id="89663-138">BizTalkDTADb 数据库数据文件磁盘物理空闲时间接近，但不是持续稳定，零。</span><span class="sxs-lookup"><span data-stu-id="89663-138">BizTalkDTADb database data file disk physical idle time near, but not continuously "pegged" at, zero.</span></span>  
  
  <span data-ttu-id="89663-139">使用 DTA 跟踪功能具有相关的性能影响。</span><span class="sxs-lookup"><span data-stu-id="89663-139">Using the DTA tracking features has an associated performance impact.</span></span>  <span data-ttu-id="89663-140">默认跟踪，不仅仅所需的后一种解决方案是在生产中，但可以进行开发和初始测试和调试变得更容易通过提供丰富的问题解决信息可以跟踪。</span><span class="sxs-lookup"><span data-stu-id="89663-140">Default tracking may track more than is needed once a solution is in production, but can make development and initial testing and debugging easier by providing ample problem resolution information.</span></span> <span data-ttu-id="89663-141">因此，我们建议在开发和初始测试期间会保留在默认跟踪。</span><span class="sxs-lookup"><span data-stu-id="89663-141">Therefore, we recommend that default tracking be left on during development and initial testing.</span></span> <span data-ttu-id="89663-142">一旦 BizTalk 上部署的解决方案是稳定且可供生产证书，包括性能测试，则建议您仔细检查需要在生产中，跟踪的信息量和它需要的时间长度保留在 BizTalkDTADb 数据库中并相应地调整。</span><span class="sxs-lookup"><span data-stu-id="89663-142">Once a solution deployed on BizTalk is stable and ready for production certification, including performance testing, it is recommended that you carefully examine the amount of information that needs to be tracked in production, and the length of time it needs to be kept in the BizTalkDTADb database and adjust accordingly.</span></span>  
  
  <span data-ttu-id="89663-143">例如，如果不需要为任一的不可否认或问题解决目的跟踪消息正文，则不要启用消息正文跟踪。</span><span class="sxs-lookup"><span data-stu-id="89663-143">For example, if message bodies do not need to be tracked for either non-repudiation or problem resolution purposes, then do not turn on message body tracking.</span></span> <span data-ttu-id="89663-144">为了说明这一点，在示例方案中所述[测试方案用于度量 MST 的 DTA 跟踪](../core/test-scenarios-for-measuring-mst-of-dta-tracking.md)，当消息正文跟踪的跟踪配置的组件已清除，MST 已增加一倍到 40 个消息/秒。</span><span class="sxs-lookup"><span data-stu-id="89663-144">To illustrate this point, in the example scenario described in [Test Scenarios for Measuring MST of DTA Tracking](../core/test-scenarios-for-measuring-mst-of-dta-tracking.md), when the message body tracking component of the tracking configuration was eliminated, the MST was doubled to 40 messages/second.</span></span>  
  
  <span data-ttu-id="89663-145">此外，请记住，即使出现了问题，在许多 （但不是全部） 情况下，消息在 MessageBox 数据库中挂起并可以检索和检查而无需跟踪消息正文。</span><span class="sxs-lookup"><span data-stu-id="89663-145">Also, keep in mind that even when problems do occur, in many (but by no means all) cases, messages are suspended in the MessageBox database and can be retrieved and inspected without needing to track message bodies.</span></span>  
  
  <span data-ttu-id="89663-146">重点放在系统负载的可持续性：</span><span class="sxs-lookup"><span data-stu-id="89663-146">Focus on the sustainability of the load you place on the system:</span></span>  
  
- <span data-ttu-id="89663-147">您的系统可以承受生产负载状况无限期地甚至与一般的维护活动？</span><span class="sxs-lookup"><span data-stu-id="89663-147">Can your system sustain the production load profile indefinitely even with normal maintenance activities?</span></span>  
  
- <span data-ttu-id="89663-148">如果发生导致系统要承受积压工作，例如计划内或计划外 BizTalkDTADb 数据库中断？</span><span class="sxs-lookup"><span data-stu-id="89663-148">What if something happens that causes the system to sustain a backlog, such as a planned or unplanned BizTalkDTADb database outage?</span></span>  
  
  <span data-ttu-id="89663-149">它是一个好办法设置基于最坏的情况和针对这些目标的测试的目标。</span><span class="sxs-lookup"><span data-stu-id="89663-149">It is a good idea to set goals based on worst case scenarios and test to those goals.</span></span> <span data-ttu-id="89663-150">例如，如果您知道存在定期计划内的维护循环将采用 BizTalkDTADb 数据库离线，在测试运行以评估系统能够从生成积压中恢复期间模拟这一中断。</span><span class="sxs-lookup"><span data-stu-id="89663-150">For example, if you know that there is a periodic planned maintenance cycle that will take the BizTalkDTADb database off line, emulate this outage during a test run to evaluate the ability of the system to recover from the resulting backlog.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="89663-151">请参阅</span><span class="sxs-lookup"><span data-stu-id="89663-151">See Also</span></span>  
 <span data-ttu-id="89663-152">[测量最大可承受跟踪吞吐量](../core/measuring-maximum-sustainable-tracking-throughput.md) </span><span class="sxs-lookup"><span data-stu-id="89663-152">[Measuring Maximum Sustainable Tracking Throughput](../core/measuring-maximum-sustainable-tracking-throughput.md) </span></span>  
 <span data-ttu-id="89663-153">[了解 DTA 跟踪性能行为](../core/understanding-dta-tracking-performance-behavior.md) </span><span class="sxs-lookup"><span data-stu-id="89663-153">[Understanding DTA Tracking Performance Behavior](../core/understanding-dta-tracking-performance-behavior.md) </span></span>  
 <span data-ttu-id="89663-154">[测量 DTA 跟踪的 MST 的测试方案](../core/test-scenarios-for-measuring-mst-of-dta-tracking.md) </span><span class="sxs-lookup"><span data-stu-id="89663-154">[Test Scenarios for Measuring MST of DTA Tracking](../core/test-scenarios-for-measuring-mst-of-dta-tracking.md) </span></span>  
 [<span data-ttu-id="89663-155">跟踪数据库的大小调整准则</span><span class="sxs-lookup"><span data-stu-id="89663-155">Tracking Database Sizing Guidelines</span></span>](../core/tracking-database-sizing-guidelines.md)