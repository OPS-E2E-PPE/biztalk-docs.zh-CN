---
title: 演练：使用 Wcf-nettcp 适配器使用消息安全模式 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c7f6e892-34ce-4132-8867-54cc3bbfe507
caps.latest.revision: 47
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 52936b6110e5e04610e1a215103b558dcbe4c1e4
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65399439"
---
# <a name="walkthrough-using-the-message-security-mode-with-the-wcf-nettcp-adapter"></a><span data-ttu-id="4a54d-102">演练：使用 Wcf-nettcp 适配器使用消息安全模式</span><span class="sxs-lookup"><span data-stu-id="4a54d-102">Walkthrough: Using the Message Security Mode with the WCF-NetTcp Adapter</span></span>

> [!NOTE]
>  <span data-ttu-id="4a54d-103">有关适配器的详细信息，请参阅[BizTalk Server 中的适配器](../core/adapters-in-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="4a54d-103">For more information about adapters, see [Adapters in BizTalk Server](../core/adapters-in-biztalk-server.md).</span></span>  

## <a name="introduction"></a><span data-ttu-id="4a54d-104">简介</span><span class="sxs-lookup"><span data-stu-id="4a54d-104">Introduction</span></span>

 <span data-ttu-id="4a54d-105">本演练演示如何配置 WCF NetTcp 适配器以使用[!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)]消息安全模式，它使用 Ws-security 规范来保护适配器传输的消息。</span><span class="sxs-lookup"><span data-stu-id="4a54d-105">This walkthrough shows how to configure the WCF-NetTcp adapter to use the [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] Message security mode, which uses the WS-Security specification to help secure messages that the adapter transmits.</span></span> <span data-ttu-id="4a54d-106">本规范描述 SOAP 邮件协议实现保密性、 完整性和 SOAP 消息级别的身份验证的增强功能。</span><span class="sxs-lookup"><span data-stu-id="4a54d-106">This specification describes enhancements to the SOAP messaging protocol to accomplish confidentiality, integrity, and authentication at the SOAP message level.</span></span> <span data-ttu-id="4a54d-107">消息安全模式需要为操作，如加密/解密和签名/验证，具体取决于安全模式组合指定将服务证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-107">Message security mode requires the service certificate to be specified for operations such as encryption/decryption and signing/verification purposes depending on the security mode combinations.</span></span>  

 <span data-ttu-id="4a54d-108">Wcf-nettcp 适配器使用 NetTcpBinding 绑定之间进行通信[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]客户端和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]远程服务。</span><span class="sxs-lookup"><span data-stu-id="4a54d-108">The WCF-NetTcp adapter uses the NetTcpBinding binding to communicate between [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] clients and [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] remote services.</span></span> <span data-ttu-id="4a54d-109">它提供了 SOAP 安全性、 可靠性和事务功能的完全访问权限。</span><span class="sxs-lookup"><span data-stu-id="4a54d-109">It provides full access to SOAP security, reliability, and transaction features.</span></span> <span data-ttu-id="4a54d-110">它允许业务流程和架构发布为[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服务，并且还提供用于使用外部 WCF 服务的业务流程的功能。</span><span class="sxs-lookup"><span data-stu-id="4a54d-110">It allows orchestrations and schemas to be published as [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] services, and also provides the ability for an orchestration to consume external WCF services.</span></span> <span data-ttu-id="4a54d-111">此适配器使用 TCP 传输和消息采用二进制编码。</span><span class="sxs-lookup"><span data-stu-id="4a54d-111">This adapter uses the TCP transport, and messages have binary encoding.</span></span> <span data-ttu-id="4a54d-112">Wcf-nettcp 适配器由发送适配器和接收适配器组成。</span><span class="sxs-lookup"><span data-stu-id="4a54d-112">The WCF-NetTcp adapter consists of both a send adapter and a receive adapter.</span></span>  

 <span data-ttu-id="4a54d-113">本演练演示如何使用 Active Directory 证书服务创建消息安全模式的证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-113">This walkthrough shows how to create certificates for Message security mode by using the Active Directory Certificate Service.</span></span> <span data-ttu-id="4a54d-114">将创建证书服务器和客户端，并配置的 Wcf-nettcp 接收位置，以便在消息安全模式下使用的证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-114">You will create certificates for the server and the client, and then configure a WCF-NetTcp receive location to use the certificates in Message security mode.</span></span> <span data-ttu-id="4a54d-115">通过使用[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]客户端，将发送到的接收位置的消息按照 XML 加密语法和处理以加密状态。</span><span class="sxs-lookup"><span data-stu-id="4a54d-115">By using a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client, you will send messages to that receive location in an encrypted state according to XML Encryption Syntax and Processing.</span></span>  

 <span data-ttu-id="4a54d-116">完成此演练后，你将了解如何执行以下任务：</span><span class="sxs-lookup"><span data-stu-id="4a54d-116">After completing this walkthrough, you will understand how to perform the following tasks:</span></span>  

- <span data-ttu-id="4a54d-117">使用 Active Directory 证书服务创建证书申请并颁发证书完成该过程。</span><span class="sxs-lookup"><span data-stu-id="4a54d-117">Use the Active Directory Certificate Service to create a certificate request and complete the process by issuing the certificate.</span></span>  

- <span data-ttu-id="4a54d-118">从[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，配置 WCF NetTcp 适配器以使用消息安全模式。</span><span class="sxs-lookup"><span data-stu-id="4a54d-118">From the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure the WCF-NetTcp adapter to use the Message security mode.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="4a54d-119">先决条件</span><span class="sxs-lookup"><span data-stu-id="4a54d-119">Prerequisites</span></span>  
 <span data-ttu-id="4a54d-120">若要执行此示例中的步骤，请确保你的环境安装以下必备组件;</span><span class="sxs-lookup"><span data-stu-id="4a54d-120">To perform the steps in this sample ensure that your environment installs the following prerequisites;</span></span>  

- <span data-ttu-id="4a54d-121">运行本示例的计算机和生成程序集和运行部署过程的计算机需要 Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]，Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)]，与 Microsoft BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="4a54d-121">Both the computer that builds the assemblies and runs the deployment process, and the computer that runs the sample, require Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)], and Microsoft BizTalk Server.</span></span>  

- <span data-ttu-id="4a54d-122">用于生成程序集和运行部署过程的计算机需要 Microsoft Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="4a54d-122">The computer used to build the assemblies and run the deployment process requires Microsoft Visual Studio.</span></span>  

- <span data-ttu-id="4a54d-123">运行示例的计算机需要[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]适配器和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]管理工具。</span><span class="sxs-lookup"><span data-stu-id="4a54d-123">The computer that runs the sample requires the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapters and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Administration Tools.</span></span> <span data-ttu-id="4a54d-124">这些是用于安装 Microsoft BizTalk Server 安装过程的选项。</span><span class="sxs-lookup"><span data-stu-id="4a54d-124">These are options to install during setup of Microsoft BizTalk Server.</span></span>  

- <span data-ttu-id="4a54d-125">在计算机上用于执行管理任务，您必须运行的成员的用户帐户作为[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Administrators 组以配置[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]内的应用程序设置[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="4a54d-125">On the computers that you use to perform administrative tasks, you must run as a user account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application settings within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="4a54d-126">此用户帐户还必须是管理主机实例和其他任务所需的应用程序部署的本地管理员组的成员。</span><span class="sxs-lookup"><span data-stu-id="4a54d-126">This user account must also be a member of the local Administrators group for application deployment, managing host instances, and other tasks that may be required.</span></span>  

- <span data-ttu-id="4a54d-127">需要的任何计算机上[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]功能，完成的一次性安装过程[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]在示例[ http://go.microsoft.com/fwlink/?LinkId=135510 ](http://go.microsoft.com/fwlink/?LinkId=135510)。</span><span class="sxs-lookup"><span data-stu-id="4a54d-127">On any computer that requires [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] capability, complete the one-time setup procedure for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] samples at [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span></span>  

- <span data-ttu-id="4a54d-128">运行示例并将一个绑定或到某一.msi 文件导入的计算机上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，确保主机不受信任的主机或导入将失败。</span><span class="sxs-lookup"><span data-stu-id="4a54d-128">On the computer that runs the sample and imports a binding or an .msi file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], ensure the host is not a trusted host or the import will fail.</span></span>  

- <span data-ttu-id="4a54d-129">运行示例的计算机上确保已安装 Active Directory 证书服务。</span><span class="sxs-lookup"><span data-stu-id="4a54d-129">On the computer that runs the sample ensure that Active Directory Certificate Services is installed.</span></span>  

- <span data-ttu-id="4a54d-130">你必须下载演练代码并将其解压缩到您的计算机。</span><span class="sxs-lookup"><span data-stu-id="4a54d-130">You must download the walkthrough code and extract it to your computer.</span></span>  <span data-ttu-id="4a54d-131">本演练是整个的一部分[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]适配器演练包。</span><span class="sxs-lookup"><span data-stu-id="4a54d-131">This walkthrough is a part of the entire [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapter Walkthrough package.</span></span> <span data-ttu-id="4a54d-132">您可以下载文件**WCFAdapterWalkthroughs.exe**从[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]开发人员中心， [ http://go.microsoft.com/fwlink/?LinkId=194140 ](http://go.microsoft.com/fwlink/?LinkId=194140)。</span><span class="sxs-lookup"><span data-stu-id="4a54d-132">You can download the file **WCFAdapterWalkthroughs.exe** from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Developer Center at [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span></span>  

## <a name="create-the-certificates-for-this-walkthrough"></a><span data-ttu-id="4a54d-133">为本演练创建证书</span><span class="sxs-lookup"><span data-stu-id="4a54d-133">Create the certificates for this walkthrough</span></span>  

1. <span data-ttu-id="4a54d-134">在本部分中将请求服务和客户端证书，颁发证书，并将它们安装到适当的存储区。</span><span class="sxs-lookup"><span data-stu-id="4a54d-134">In this section you will request service and client certificates, issue the certificates, and install them into the appropriate stores.</span></span> <span data-ttu-id="4a54d-135">Active Directory 证书服务用于创建使用受信任的证书链的证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-135">Active Directory Certificate Services is used to create a certificate with a trusted certificate chain.</span></span> <span data-ttu-id="4a54d-136">如果您未安装 Active Directory 证书服务作为必备组件的一部分，然后在计算机上安装 Active Directory 证书服务。</span><span class="sxs-lookup"><span data-stu-id="4a54d-136">If you did not install Active Directory Certificate Services as part of the Prerequisites, then install Active Directory Certificate Services on your computer.</span></span> <span data-ttu-id="4a54d-137">如果已安装，请转到步骤 2。</span><span class="sxs-lookup"><span data-stu-id="4a54d-137">If it is already installed, go to step 2.</span></span>  

   1.  <span data-ttu-id="4a54d-138">单击**启动**，依次指向**管理工具**，然后单击**服务器管理器**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-138">Click **Start**, point to **Administrative Tools**, and then click **Server Manager**.</span></span>  

   2.  <span data-ttu-id="4a54d-139">下**服务器管理器**节点中，单击**添加**，然后单击**角色**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-139">Under the **Server Manager** node, click **Add**, and then click **Roles**.</span></span>  

   3.  <span data-ttu-id="4a54d-140">这将显示**在开始之前**对话框**添加角色向导**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-140">This brings up the **Before you begin** dialog for the **Add Roles Wizard**.</span></span> <span data-ttu-id="4a54d-141">单击“下一步” 。</span><span class="sxs-lookup"><span data-stu-id="4a54d-141">Click **Next**.</span></span>  

   4.  <span data-ttu-id="4a54d-142">上**选择服务器角色**页上，选择**Active Directory 证书服务**，单击**下一步**，然后按照屏幕说明完成安装。</span><span class="sxs-lookup"><span data-stu-id="4a54d-142">On the **Select Server Roles** page, select **Active Directory Certificate Services**, click **Next**, and then follow the on-screen instructions to complete the installation.</span></span>  

2. <span data-ttu-id="4a54d-143">创建进行服务身份验证证书申请，如下所示：</span><span class="sxs-lookup"><span data-stu-id="4a54d-143">Create a certificate request for the service authentication as follows:</span></span>  

   1. <span data-ttu-id="4a54d-144">在 Internet Explorer 中，请访问网站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-144">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span> <span data-ttu-id="4a54d-145">上**欢迎**页上，单击**申请一个证书**，然后单击**高级的证书申请**上**申请一个证书**页。</span><span class="sxs-lookup"><span data-stu-id="4a54d-145">On the **Welcome** page, click **Request a Certificate**, and then click **Advanced certificate request** on the **Request a Certificate** page.</span></span>  

      > [!NOTE]
      >  <span data-ttu-id="4a54d-146">使用时[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]作为证书颁发机构并请求从一个证书申请[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]计算机，可能会收到错误 **"若要完成证书注册，CA 的网站必须将配置为使用 HTTPS身份验证"**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-146">When using [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] as the certificate authority and requesting a certificate request from a [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] computer, you may get the error **“In order to complete certificate enrollment, the Web site for the CA must be configured to use HTTPS authentication”**.</span></span> <span data-ttu-id="4a54d-147">如果发生此错误，注册网站需要使用 Web 证书 (SSL) 进行配置。</span><span class="sxs-lookup"><span data-stu-id="4a54d-147">If this error occurs, the enrollment website needs to be configured with a Web Certificate (SSL).</span></span> <span data-ttu-id="4a54d-148">请参阅下面的链接中完成此任务的详细信息：</span><span class="sxs-lookup"><span data-stu-id="4a54d-148">Refer to these links for details in accomplishing this task:</span></span>  
      > 
      >  [<span data-ttu-id="4a54d-149">AD CS:Web 注册</span><span class="sxs-lookup"><span data-stu-id="4a54d-149">AD CS: Web Enrollment</span></span>](http://technet.microsoft.com/library/cc732517.aspx)  
      > 
      >  [<span data-ttu-id="4a54d-150">IIS 服务器证书安装说明</span><span class="sxs-lookup"><span data-stu-id="4a54d-150">IIS Server Certificate Installation Instructions</span></span>](http://msdn.microsoft.com/library/ms751408.aspx)  

   2. <span data-ttu-id="4a54d-151">上**高级证书申请**页上，单击**创建并向此 CA 提交一个申请**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-151">On the **Advanced Certificate Request** page, click **Create and submit a request to this CA**.</span></span>  

   3. <span data-ttu-id="4a54d-152">上**高级证书申请**页上，键入`localhost`中**名称**文本框中，选择**服务器身份验证证书**从**需要的证书类型**下拉列表，再单击**提交**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-152">On the **Advanced Certificate Request** page, type `localhost` in the **Name** text box, select **Server Authentication Certificate** from the **Type of Certificate Needed** drop-down list, and then click **Submit**.</span></span>  

3. <span data-ttu-id="4a54d-153">创建客户端身份验证的证书申请，如下所示：</span><span class="sxs-lookup"><span data-stu-id="4a54d-153">Create a certificate request for client authentication as follows:</span></span>  

   1.  <span data-ttu-id="4a54d-154">在 Internet Explorer 中，请访问网站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-154">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span> <span data-ttu-id="4a54d-155">上**欢迎**页上，单击**申请一个证书**，然后单击**高级的证书申请**上**申请一个证书**页。</span><span class="sxs-lookup"><span data-stu-id="4a54d-155">On the **Welcome** page, click **Request a Certificate**, and then click **Advanced certificate request** on the **Request a Certificate** page.</span></span>  

   2.  <span data-ttu-id="4a54d-156">上**高级证书申请**页上，单击**创建并向此 CA 提交一个申请**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-156">On the **Advanced Certificate Request** page, click **Create and submit a request to this CA**.</span></span>  

   3.  <span data-ttu-id="4a54d-157">上**高级证书申请**页上，键入`contoso`中**名称**文本框中，选择**客户端身份验证证书**从**需要的证书类型**下拉列表，再单击**提交**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-157">On the **Advanced Certificate Request** page, type `contoso` in the **Name** text box, select **Client Authentication Certificate** from the **Type of Certificate Needed** drop-down list, and then click **Submit**.</span></span>  

   > [!NOTE]
   >  <span data-ttu-id="4a54d-158">如果在域控制器以外的计算机上运行 BizTalk Server，则使用客户端身份验证证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-158">The client authentication certificate is used if you are running BizTalk Server on machine other than the Domain Controller.</span></span> <span data-ttu-id="4a54d-159">这将在适配器的属性对话框中配置。</span><span class="sxs-lookup"><span data-stu-id="4a54d-159">This will be configured in the adapter’s property dialog.</span></span>  

4. <span data-ttu-id="4a54d-160">按以下方式使用证书颁发机构管理控制台颁发的证书：</span><span class="sxs-lookup"><span data-stu-id="4a54d-160">Issue the certificates by using the Certification Authority management console as follows:</span></span>  

   1.  <span data-ttu-id="4a54d-161">单击**启动**，依次指向**管理工具**，然后单击**证书颁发机构**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-161">Click **Start**, point to **Administrative Tools**, and then click **Certification Authority**.</span></span>  

   2.  <span data-ttu-id="4a54d-162">在中**证书颁发机构**管理控制台中，展开证书颁发机构的名称，然后双击**挂起的申请**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-162">In the **Certification Authority** management console, expand your certification authority's name, and then double-click **Pending Request**.</span></span>  

   3.  <span data-ttu-id="4a54d-163">在右窗格中**证书颁发机构**管理控制台中，右键单击服务身份验证证书的申请，指向**的所有任务**，然后单击**问题**.</span><span class="sxs-lookup"><span data-stu-id="4a54d-163">In the right pane of the **Certification Authority** management console, right-click the request for the service authentication certificate, point to **All Tasks**, and then click **Issue**.</span></span>  

   4.  <span data-ttu-id="4a54d-164">在右窗格中**证书颁发机构**管理控制台中，右键单击客户端身份验证证书的申请，指向**的所有任务**，然后单击**问题**.</span><span class="sxs-lookup"><span data-stu-id="4a54d-164">In the right pane of the **Certification Authority** management console, right-click the request for the client authentication certificate, point to **All Tasks**, and then click **Issue**.</span></span>  

   5.  <span data-ttu-id="4a54d-165">关闭**证书颁发机构**管理控制台。</span><span class="sxs-lookup"><span data-stu-id="4a54d-165">Close the **Certification Authority** management console.</span></span>  

5. <span data-ttu-id="4a54d-166">在计算机上安装颁发的证书，如下所示：</span><span class="sxs-lookup"><span data-stu-id="4a54d-166">Install the issued certificates on your computer as follows:</span></span>  

   1.  <span data-ttu-id="4a54d-167">在 Internet Explorer 中，请访问网站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-167">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span>  

   2.  <span data-ttu-id="4a54d-168">上**欢迎**页上，单击**查看挂起的证书申请的状态**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-168">On the **Welcome** page, click **View the status of a pending certificate request**.</span></span>  

   3.  <span data-ttu-id="4a54d-169">上**查看挂起的证书申请的状态**页上，单击服务器身份验证证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-169">On the **View the Status of a Pending Certificate Request** page, click the server authentication certificate.</span></span>  

   4.  <span data-ttu-id="4a54d-170">上**证书颁发**页上，单击**安装此证书**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-170">On the **Certificate Issued** page, click **Install this Certificate**.</span></span>  

   5.  <span data-ttu-id="4a54d-171">在 Internet Explorer 中，请访问网站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-171">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span>  

   6.  <span data-ttu-id="4a54d-172">上**欢迎**页上，单击**查看挂起的证书申请的状态**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-172">On the **Welcome** page, click **View the status of a pending certificate request**.</span></span>  

   7.  <span data-ttu-id="4a54d-173">上**查看挂起的证书申请的状态**页上，单击客户端身份验证证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-173">On the **View the Status of a Pending Certificate Request** page, click the client authentication certificate.</span></span>  

   8.  <span data-ttu-id="4a54d-174">上**证书颁发**页上，单击**安装此证书**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-174">On the **Certificate Issued** page, click **Install this Certificate**.</span></span>  

6. <span data-ttu-id="4a54d-175">请确保颁发的证书安装正确，如下所示：</span><span class="sxs-lookup"><span data-stu-id="4a54d-175">Make sure that the issued certificates are installed properly as follows:</span></span>  

   1.  <span data-ttu-id="4a54d-176">打开 Microsoft 管理控制台 (MMC)。</span><span class="sxs-lookup"><span data-stu-id="4a54d-176">Open Microsoft Management Console (MMC).</span></span> <span data-ttu-id="4a54d-177">若要执行此操作，请单击**启动**，单击**运行**，类型`mmc`，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-177">To do so, click **Start**, click **Run**, type `mmc`, and then click **OK**.</span></span>  

   2.  <span data-ttu-id="4a54d-178">在 MMC 中，在**文件**菜单上，单击**添加/删除管理单元中**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-178">In the MMC, on the **File** menu, click **Add/Remove Snap-in**.</span></span>  

   3.  <span data-ttu-id="4a54d-179">在“添加/删除管理单元”对话框中，单击“添加”。</span><span class="sxs-lookup"><span data-stu-id="4a54d-179">In the **Add/Remove Snap-in** dialog box, click **Add**.</span></span>  

   4.  <span data-ttu-id="4a54d-180">在中**添加独立管理单元**对话框中，选择**证书**从**可用的独立管理单元中**列表，并单击**添加**.</span><span class="sxs-lookup"><span data-stu-id="4a54d-180">In the **Add Standalone Snap-in** dialog box, select **Certificates** from the **Available standalone snap-in** list, and then click **Add**.</span></span>  

   5.  <span data-ttu-id="4a54d-181">在中**管理单元中的证书**对话框中，选择**我的用户帐户**选项，并单击**完成**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-181">In the **Certificate snap-in** dialog box, select the **My user account** option, and then click **Finish**.</span></span>  

   6.  <span data-ttu-id="4a54d-182">关闭所有打开的对话框。</span><span class="sxs-lookup"><span data-stu-id="4a54d-182">Close all of the open dialog boxes.</span></span>  

   7.  <span data-ttu-id="4a54d-183">在 MMC 中，在控制台根目录窗口中，展开**证书-当前用户**，展开**个人**，展开**证书**，并请务必证书，安装在上一步中显示。</span><span class="sxs-lookup"><span data-stu-id="4a54d-183">In the MMC, in the Console Root window, expand **Certificates - Current User**, expand **Personal**, expand **Certificates**, and then make sure that the certificates that you installed in the previous step are displayed.</span></span>  

## <a name="create-the-biztalk-application-for-this-walkthrough"></a><span data-ttu-id="4a54d-184">创建在本演练中的 BizTalk 应用程序</span><span class="sxs-lookup"><span data-stu-id="4a54d-184">Create the BizTalk application for this walkthrough</span></span>  

1. <span data-ttu-id="4a54d-185">单击**启动**，依次指向**所有程序**，指向[!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)]，然后单击**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-185">Click **Start**, point to **All Programs**, point to [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  

2. <span data-ttu-id="4a54d-186">在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，展开**BizTalk 组**，右键单击**应用程序**，指向**新建**，然后单击**应用程序**.</span><span class="sxs-lookup"><span data-stu-id="4a54d-186">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **BizTalk Group**, right-click **Applications**, point to **New**, and then click **Application**.</span></span>  

3. <span data-ttu-id="4a54d-187">在中**应用程序属性**对话框中，在**常规**选项卡上，键入`WcfMessageSecurity`，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-187">In the **Application Properties** dialog box, on the **General** tab, type `WcfMessageSecurity`, and then click **OK**.</span></span>  

4. <span data-ttu-id="4a54d-188">创建 BizTalk 应用程序，如下所示使用 Wcf-nettcp 适配器的接收位置：</span><span class="sxs-lookup"><span data-stu-id="4a54d-188">Create a receive location using the WCF-NetTcp adapter for the BizTalk application as follows:</span></span>  

   1. <span data-ttu-id="4a54d-189">在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，展开**WcfMessageSecurity**，右键单击**接收端口**，指向**新建**，然后单击**单向接收端口。**</span><span class="sxs-lookup"><span data-stu-id="4a54d-189">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WcfMessageSecurity**, right-click **Receive Ports**, point to **New**, and then click **One-way Receive Port.**</span></span>  

   2. <span data-ttu-id="4a54d-190">在中**接收端口属性**对话框中**名称**文本框中，键入`WcfMessageSecurity.OrderRequest.Receive`，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-190">In the **Receive Port Properties** dialog box, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Receive`, and then click **OK**.</span></span> <span data-ttu-id="4a54d-191">此名称的接收端口是任意，但此名称具有逻辑意义。</span><span class="sxs-lookup"><span data-stu-id="4a54d-191">The name of this receive port is strictly arbitrary but this name makes logical sense.</span></span>  

   3. <span data-ttu-id="4a54d-192">在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，右键单击**接收位置**，单击**新建**，然后单击**单向接收位置**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-192">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **Receive Locations**, click **New**, and then click **One-way Receive Location**.</span></span> <span data-ttu-id="4a54d-193">[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]客户端将发送[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]消息与此接收位置。</span><span class="sxs-lookup"><span data-stu-id="4a54d-193">The [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client will send a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message to this receive location.</span></span> <span data-ttu-id="4a54d-194">选择**WcfMessageSecurity.OrderRequest.Receive**接收端口，并单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-194">Select the **WcfMessageSecurity.OrderRequest.Receive** recive port, and then click **OK**.</span></span>  

   4. <span data-ttu-id="4a54d-195">在中**接收位置属性**对话框中**名称**文本框中，键入`WcfMessageSecurity.OrderRequest.Receive.NetTcp`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-195">In the **Receive Location Properties** dialog box, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Receive.NetTcp`.</span></span> <span data-ttu-id="4a54d-196">此名称的接收位置是任意，但此名称具有逻辑意义。</span><span class="sxs-lookup"><span data-stu-id="4a54d-196">The name of this receive location is strictly arbitrary but this name makes logical sense.</span></span>  

   5. <span data-ttu-id="4a54d-197">在中**接收位置属性**对话框中**传输**部分旁边**类型**，选择**WCF NetTcp**从下拉列表列表中，然后依次**配置**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-197">In the **Receive Location Properties** dialog box, in the **Transport** section next to **Type**, select **WCF-NetTcp** from the drop-down list, and then click **Configure**.</span></span>  

   6. <span data-ttu-id="4a54d-198">在中**Wcf-nettcp 传输属性**对话框中，在**常规**选项卡上，在**地址 (URI)** 文本框中，键入`net.tcp://localhost/WcfMessageSecurity`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-198">In the **WCF-NetTcp Transport Properties** dialog box, on the **General** tab, in the **Address (URI)** text box, type `net.tcp://localhost/WcfMessageSecurity`.</span></span>  

   7. <span data-ttu-id="4a54d-199">在中**Wcf-nettcp 传输属性**对话框中，在**安全**选项卡上，选择**消息**从**安全模式**下拉列表列表，并选择**证书**从**消息客户端凭据类型**下拉列表。</span><span class="sxs-lookup"><span data-stu-id="4a54d-199">In the **WCF-NetTcp Transport Properties** dialog box, on the **Security** tab, select **Message** from the **Security mode** drop-down list, and then select **Certificate** from the **Message client credential type** drop-down list.</span></span> <span data-ttu-id="4a54d-200">这会配置 WCF NetTcp 适配器以使用消息安全模式。</span><span class="sxs-lookup"><span data-stu-id="4a54d-200">This configures the WCF-NetTcp adapter to use the Message security mode.</span></span>  

   8. <span data-ttu-id="4a54d-201">配置要使用消息安全模式下的服务证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-201">Configure the service certificate to use with Message security mode.</span></span> <span data-ttu-id="4a54d-202">在中**Wcf-nettcp 传输属性**对话框中**服务认证**部分中，单击**浏览**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-202">In the **WCF-NetTcp Transport Properties** dialog box, in the **Service certification** section, click **Browse**.</span></span> <span data-ttu-id="4a54d-203">在中**选择服务证书**对话框中，选择在上一过程中，安装的服务器身份验证证书，然后单击**确定**关闭对话框并保存所做的更改。</span><span class="sxs-lookup"><span data-stu-id="4a54d-203">In the **Select service certificate** dialog box, select the server authentication certificate you installed in the previous procedure, and then click **OK** to close the dialog box and save the changes.</span></span>  

   9. <span data-ttu-id="4a54d-204">关闭所有打开的对话框。</span><span class="sxs-lookup"><span data-stu-id="4a54d-204">Close all of the open dialog boxes.</span></span>  

      > [!NOTE]
      >  <span data-ttu-id="4a54d-205">客户端证书进行身份验证[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]接收适配器，客户端证书的 CA 证书链必须安装在运行主机实例的计算机的受信任的根证书颁发机构证书存储有关[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]适配器。</span><span class="sxs-lookup"><span data-stu-id="4a54d-205">To authenticate the client certificates with the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] receive adapters, the CA certificate chain for the client certificates must be installed in the Trusted Root Certification Authorities certificate store of the computer running the host instances for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapters.</span></span> <span data-ttu-id="4a54d-206">因为本演练假定为在同一台计算机上是否安装了证书服务[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]客户端和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]适配器，您无需在计算机上安装的 CA 证书链。</span><span class="sxs-lookup"><span data-stu-id="4a54d-206">Because this walkthrough assumes that the certificate service is installed on the same computer as the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapters, you do not have to install the CA certificate chain on your computer.</span></span>  

5. <span data-ttu-id="4a54d-207">创建 FILE 发送端口的 BizTalk 应用程序。</span><span class="sxs-lookup"><span data-stu-id="4a54d-207">Create a FILE send port for the BizTalk application.</span></span> <span data-ttu-id="4a54d-208">这是通过业务流程表示发送订单请求输出消息的位置[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服务。</span><span class="sxs-lookup"><span data-stu-id="4a54d-208">This is the location where the order request output message will be sent by the orchestration representing the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  

   1. <span data-ttu-id="4a54d-209">在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，展开**WcfMessageSecurity**，右键单击**发送端口**，指向**新建**，然后单击**静态单向发送端口。**</span><span class="sxs-lookup"><span data-stu-id="4a54d-209">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WcfMessageSecurity**, right-click **Send Ports**, point to **New**, and then click **Static One-way Send Port.**</span></span>  

   2. <span data-ttu-id="4a54d-210">在中**发送端口属性**对话框中，在**常规**选项卡上，在**名称**文本框中，键入`WcfMessageSecurity.OrderRequest.Send.FILE`。</span><span class="sxs-lookup"><span data-stu-id="4a54d-210">In the **Send Port Properties** dialog box, on the **General**  tab, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Send.FILE`.</span></span>  

   3. <span data-ttu-id="4a54d-211">在**发送端口属性**对话框中**传输**部分旁边**类型**，选择**文件**从下拉列表中，然后单击**配置**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-211">In the **Send Port Properties** dialog box, in the **Transport** section next to **Type**, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  

   4. <span data-ttu-id="4a54d-212">在中**FILE 传输属性**对话框中，在**常规**选项卡上，键入`C:\WCFMessageSecurity\OrderRequestOut`中**目标文件夹**文本框中，，然后单击**确定**.</span><span class="sxs-lookup"><span data-stu-id="4a54d-212">In the **FILE Transport Properties** dialog box, on the **General**  tab, type `C:\WCFMessageSecurity\OrderRequestOut` in the **Destination folder** text box, and then click **OK**.</span></span>  

   5. <span data-ttu-id="4a54d-213">在中**发送端口属性**对话框中，在**筛选器**选项卡上，选择**BTS。ReceivePortName**有关**属性**字段中，输入`WcfMessageSecurity.OrderRequest.Receive`有关**值**字段，，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-213">In the **Send Port Properties** dialog box, on the **Filters** tab, select **BTS.ReceivePortName** for the **Property** field, enter `WcfMessageSecurity.OrderRequest.Receive` for the **Value** field, and then click **OK**.</span></span> <span data-ttu-id="4a54d-214">此筛选器表达式将路由传入[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]到客户端的消息**WcfMessageSecurity.OrderRequest.Receive**接收到此发送端口的端口。</span><span class="sxs-lookup"><span data-stu-id="4a54d-214">This filter expression routes the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] messages from the client into the **WcfMessageSecurity.OrderRequest.Receive** receive port to this send port.</span></span>  

## <a name="test-the-wcf-client-against-the-biztalk-application"></a><span data-ttu-id="4a54d-215">测试 WCF 客户端对 BizTalk 应用程序</span><span class="sxs-lookup"><span data-stu-id="4a54d-215">Test the WCF client against the BizTalk application</span></span>  

1. <span data-ttu-id="4a54d-216">在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，右键单击**WcfMessageSecurity**，然后单击**启动**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-216">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **WcfMessageSecurity**, and then click **Start**.</span></span> <span data-ttu-id="4a54d-217">在中**启动**对话框中，单击**启动**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-217">In the **Start** dialog box, click **Start**.</span></span>  

2. <span data-ttu-id="4a54d-218">在中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，展开**平台设置**，展开**主机实例**，右键单击**BizTalkServerApplication**或另一个相应的主机实例，然后依次**重新启动**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-218">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **Platform Settings**, expand **Host Instances**, right-click **BizTalkServerApplication** or another appropriate host instance, and then click **Restart**.</span></span>  

3. <span data-ttu-id="4a54d-219">创建名为的文件夹**C:\WCFMessageSecurity**文件夹对于此演练的工作文件夹。</span><span class="sxs-lookup"><span data-stu-id="4a54d-219">Create a folder named **C:\WCFMessageSecurity** for the working folder for this walkthrough.</span></span> <span data-ttu-id="4a54d-220">演练文件解压缩到此文件夹。</span><span class="sxs-lookup"><span data-stu-id="4a54d-220">Extract the walkthrough files to this folder.</span></span>  

4. <span data-ttu-id="4a54d-221">在中[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，打开**WcfMessageSecurity.sln**中的文件**C:\WCFMessageSecurity**文件夹。</span><span class="sxs-lookup"><span data-stu-id="4a54d-221">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], open the **WcfMessageSecurity.sln** file in the **C:\WCFMessageSecurity** folder.</span></span>  

5. <span data-ttu-id="4a54d-222">在中[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，在解决方案资源管理器，展开**WcfClient**，然后打开**Program.cs**查看。</span><span class="sxs-lookup"><span data-stu-id="4a54d-222">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], in Solution Explorer, expand **WcfClient**, and then open **Program.cs** to review.</span></span>  

   - <span data-ttu-id="4a54d-223">客户端将消息发送到 Wcf-nettcp 接收位置在前面的过程中创建。</span><span class="sxs-lookup"><span data-stu-id="4a54d-223">The client sends a message to the WCF-NetTcp receive location that you created in the previous procedure.</span></span>  

   - <span data-ttu-id="4a54d-224">客户端创建与通道**NetTcpBinding**，然后配置要使用证书进行客户端凭据类型的绑定。</span><span class="sxs-lookup"><span data-stu-id="4a54d-224">The client creates a channel with the **NetTcpBinding**, and then configures the binding to use certificates for the client credential type.</span></span>  

   - <span data-ttu-id="4a54d-225">客户端配置终结点行为，以便使用客户端身份验证在上一过程中安装的客户端身份验证证书。</span><span class="sxs-lookup"><span data-stu-id="4a54d-225">The client configures the endpoint behavior to use the client authentication certificate that you installed in the previous procedure for the client authentication.</span></span>  

   - <span data-ttu-id="4a54d-226">类中，**程序**，实现**IClientMessageInspector**并**IEndpointBehavior**接口，以便显示传出[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]从此消息在命令提示符下的客户端。</span><span class="sxs-lookup"><span data-stu-id="4a54d-226">The class, **Program**, implements the **IClientMessageInspector** and **IEndpointBehavior** interfaces to display outgoing [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] messages from this client at a command prompt.</span></span>  

6. <span data-ttu-id="4a54d-227">在中[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，在解决方案资源管理器中右键单击**WcfMessageSecurity**解决方案，，然后单击**重新生成**。</span><span class="sxs-lookup"><span data-stu-id="4a54d-227">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], in Solution Explorer, right-click the **WcfMessageSecurity** solution, and then click **Rebuild**.</span></span>  

7. <span data-ttu-id="4a54d-228">在中[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，然后在**调试**菜单中，单击**启动但不调试**以运行 WcfClient，从而发送消息到 Wcf-nettcp 接收位置。</span><span class="sxs-lookup"><span data-stu-id="4a54d-228">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], on the **Debug** menu, click **Start Without Debugging** to run the WcfClient to send a message to the WCF-NetTcp receive locations.</span></span> <span data-ttu-id="4a54d-229">在命令提示符下将出现以显示执行结果。</span><span class="sxs-lookup"><span data-stu-id="4a54d-229">A command prompt appears to show the execution result.</span></span>  

   1. <span data-ttu-id="4a54d-230">在命令提示符下，查看订单请求消息。</span><span class="sxs-lookup"><span data-stu-id="4a54d-230">At the command prompt, review the order request message.</span></span> <span data-ttu-id="4a54d-231">注意**OrderId**字段和消息的结构。</span><span class="sxs-lookup"><span data-stu-id="4a54d-231">Pay attention to the **OrderId** field and the structure of the message.</span></span>  

   2. <span data-ttu-id="4a54d-232">在命令提示符处，转至`C:\WCFMessageSecurity\OrderRequestOut`文件夹，然后确保订单请求消息发送的[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]客户端将出现。</span><span class="sxs-lookup"><span data-stu-id="4a54d-232">At the command prompt, go to the `C:\WCFMessageSecurity\OrderRequestOut` folder, and then make sure the order request message sent by the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client appears.</span></span>  

   3. <span data-ttu-id="4a54d-233">关闭命令提示符。</span><span class="sxs-lookup"><span data-stu-id="4a54d-233">Close the command prompt.</span></span>
