---
title: WCF 适配器常见问题： 常规概念 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: bbeac135-3ba8-4b0b-a8ca-4eb5eb3d3ca3
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6a33e6ba26f0ba97cb10aa2f9ee728683719dd66
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009246"
---
# <a name="wcf-adapter-faq-general-conceptual"></a><span data-ttu-id="16be1-102">WCF 适配器常见问题解答：一般概念</span><span class="sxs-lookup"><span data-stu-id="16be1-102">WCF Adapter FAQ: General Conceptual</span></span>
<span data-ttu-id="16be1-103">下面是一些常见的有关 Windows® Communication Foundation (WCF) 适配器的一般和概念性问题。</span><span class="sxs-lookup"><span data-stu-id="16be1-103">Below are some frequently asked general and conceptual questions about Windows® Communication Foundation (WCF) adapters.</span></span>  
  
## <a name="what-is-a-wcf-adapter"></a><span data-ttu-id="16be1-104">WCF 适配器是什么？</span><span class="sxs-lookup"><span data-stu-id="16be1-104">What is a WCF adapter?</span></span>  
 <span data-ttu-id="16be1-105">BizTalk 适配器是 Microsoft® BizTalk® Server 与外界通信方式的关键部分。</span><span class="sxs-lookup"><span data-stu-id="16be1-105">A BizTalk adapter is a key part of the way Microsoft® BizTalk® Server communicates with the outside world.</span></span> <span data-ttu-id="16be1-106">WCF 适配器是一个组件，它管理 BizTalk 应用程序与其需求之间的通信过程，以便将消息发送到 WCF 终结点和从 WCF 终结点接收消息。</span><span class="sxs-lookup"><span data-stu-id="16be1-106">A WCF adapter is a component that manages the communication process between a BizTalk application and its need to send messages to, and receive messages from, a WCF endpoint.</span></span> <span data-ttu-id="16be1-107">与 BizTalk Server 中，WCF 适配器显示为 WCF 绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-107">With the BizTalk Server, WCF adapters are exposed as WCF bindings.</span></span> <span data-ttu-id="16be1-108">这意味着任何可使用 WCF 绑定的 WCF 应用程序都可以直接与 WCF 适配器通信，无需 BizTalk Server 进行干预。</span><span class="sxs-lookup"><span data-stu-id="16be1-108">This means that any WCF application that can use a WCF binding can communicate with the WCF adapters directly, without needing BizTalk Server to intervene.</span></span> <span data-ttu-id="16be1-109">但是，通过 BizTalk Server 使用 WCF 适配器可让您享受 BizTalk Server 提供的许多应用程序基础结构优势。</span><span class="sxs-lookup"><span data-stu-id="16be1-109">However, using the WCF adapters through BizTalk Server gives you many of the application infrastructure benefits that BizTalk Server provides.</span></span> <span data-ttu-id="16be1-110">这些常见问题解答的焦点主要是在 BizTalk Server 环境中使用 WCF 适配器。</span><span class="sxs-lookup"><span data-stu-id="16be1-110">The focus of these FAQs is primarily using the WCF adapters from within the BizTalk Server environment.</span></span>  
  
 <span data-ttu-id="16be1-111">WCF 适配器允许 BizTalk Server 使用 WCF 绑定来发送和接收 WCF 消息。</span><span class="sxs-lookup"><span data-stu-id="16be1-111">A WCF adapter allows BizTalk Server to use the WCF bindings to send and receive WCF messages.</span></span> <span data-ttu-id="16be1-112">WCF 客户端应用程序可以将 WCF 消息发送到 BizTalk 接收位置，WCF 接收适配器在此处接收消息。</span><span class="sxs-lookup"><span data-stu-id="16be1-112">A WCF client application can send a WCF message to a BizTalk receive location, where the message is received by a WCF receive adapter.</span></span> <span data-ttu-id="16be1-113">该适配器接收 WCF 消息并将其转换为 BizTalk 消息。</span><span class="sxs-lookup"><span data-stu-id="16be1-113">The adapter takes the WCF message and converts it to a BizTalk message.</span></span> <span data-ttu-id="16be1-114">如何发生转换将取决于某些适配器配置设置（使用 BizTalk Server管理控制台配置这些设置）。</span><span class="sxs-lookup"><span data-stu-id="16be1-114">How the conversion takes place depends upon certain adapter configuration settings which are configured using the BizTalk Server Administration console.</span></span> <span data-ttu-id="16be1-115">适配器将 BizTalk 消息提交到内部 BizTalk MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="16be1-115">The adapter submits the BizTalk message to the internal BizTalk MessageBox database.</span></span> <span data-ttu-id="16be1-116">相应地，使用 WCF 适配器的 BizTalk 发送端口可以订阅此消息类型，获取 BizTalk 消息，将其转换为 WCF 消息，以及使用支持的一种 WCF 协议将 WCF 消息传输到 WCF 服务终结点。</span><span class="sxs-lookup"><span data-stu-id="16be1-116">Correspondingly, a BizTalk send port using a WCF adapter can subscribe to this message type, obtain the BizTalk message, convert it to a WCF message, and transmit the WCF message to a WCF service endpoint using one of the supported WCF protocols.</span></span>  
  
 <span data-ttu-id="16be1-117">如果在 BizTalk Server 中使用 WCF 适配器，将抽象化 BizTalk-WCF 应用程序解决方案隐藏的复杂性，如通信协议、安全问题和事务性操作的选择和实现。</span><span class="sxs-lookup"><span data-stu-id="16be1-117">Using the WCF adapters from within BizTalk Server abstracts the hidden complexities of a BizTalk-WCF application solution, such as the choice and implementation of communication protocols, security issues, and transactional operations.</span></span>  
  
## <a name="what-are-the-wcf-adapter-bindings"></a><span data-ttu-id="16be1-118">WCF 适配器绑定是什么？</span><span class="sxs-lookup"><span data-stu-id="16be1-118">What are the WCF adapter bindings?</span></span>  
 <span data-ttu-id="16be1-119">WCF 绑定分为以下两个类别之一：</span><span class="sxs-lookup"><span data-stu-id="16be1-119">WCF bindings fall into one of two categories:</span></span>  
  
-   <span data-ttu-id="16be1-120">**自定义绑定：** 实现更高绑定灵活性，存在特殊的自定义绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-120">**Custom Bindings:** For increased binding flexibility, the special custom binding exists.</span></span> <span data-ttu-id="16be1-121">这包括需要与标准绑定存在偏差的通信情况。</span><span class="sxs-lookup"><span data-stu-id="16be1-121">This covers communication situations that require deviations from the standard bindings.</span></span> <span data-ttu-id="16be1-122">WCF-Custom 和 WCF CustomIsolated 适配器允许开发大量的绑定自定义。</span><span class="sxs-lookup"><span data-stu-id="16be1-122">The WCF-Custom and WCF-CustomIsolated adapters allow development of extensive binding customizations.</span></span> <span data-ttu-id="16be1-123">通过允许将现有绑定元素（BindingElement 类）和行为应用程序（Behavior 类）组合来实现此操作。</span><span class="sxs-lookup"><span data-stu-id="16be1-123">This is done by allowing the composition of existing binding elements (the BindingElement class) and the application of behaviors (the Behavior class).</span></span>  
  
-   <span data-ttu-id="16be1-124">**标准绑定：** Microsoft 的目标是开发适配器侧重于最常见的通信方案。</span><span class="sxs-lookup"><span data-stu-id="16be1-124">**Standard bindings:** Microsoft’s goal is to develop adapters focused on the most common communication scenarios.</span></span> <span data-ttu-id="16be1-125">使用标准绑定，将通过隐藏通信协议的许多细节来简化开发人员的体验。</span><span class="sxs-lookup"><span data-stu-id="16be1-125">Using standard bindings simplifies the developer’s experience by hiding many details of the communication protocols.</span></span> <span data-ttu-id="16be1-126">BizTalk Server 中的 WCF 适配器集反映的一套.NET Framework 4.0 WCF 库中可用的绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-126">The set of WCF adapters in BizTalk Server reflects the set of bindings available in the .NET Framework 4.0 WCF libraries.</span></span> <span data-ttu-id="16be1-127">将标准绑定引入到 .NET WCF 库，是为了使典型绑定模式更易于使用。</span><span class="sxs-lookup"><span data-stu-id="16be1-127">Standard bindings were introduced to the .NET WCF libraries to make typical binding patterns easier to use.</span></span> <span data-ttu-id="16be1-128">它们涉及最常用的通信方案，包括：</span><span class="sxs-lookup"><span data-stu-id="16be1-128">They cover the most commonly used communication scenarios and include:</span></span>  
  
    -   <span data-ttu-id="16be1-129">WCF-WsHttp</span><span class="sxs-lookup"><span data-stu-id="16be1-129">WCF-WsHttp</span></span>  
  
    -   <span data-ttu-id="16be1-130">WCF-BasicHttp</span><span class="sxs-lookup"><span data-stu-id="16be1-130">WCF-BasicHttp</span></span>  
  
    -   <span data-ttu-id="16be1-131">WCF-NetTcp</span><span class="sxs-lookup"><span data-stu-id="16be1-131">WCF-NetTcp</span></span>  
  
    -   <span data-ttu-id="16be1-132">WCF-NetMsmg</span><span class="sxs-lookup"><span data-stu-id="16be1-132">WCF-NetMsmg</span></span>  
  
    -   <span data-ttu-id="16be1-133">WCF-NetNamedPipe</span><span class="sxs-lookup"><span data-stu-id="16be1-133">WCF-NetNamedPipe</span></span>  
  
 <span data-ttu-id="16be1-134">BizTalk Server R2 附带以下 WCF 适配器：</span><span class="sxs-lookup"><span data-stu-id="16be1-134">BizTalk Server R2 ships with the following WCF adapters:</span></span>  
  
1.  <span data-ttu-id="16be1-135">**WCF WSHttp 适配器：** 提供的 WS-\* 标准支持通过 HTTP 传输。</span><span class="sxs-lookup"><span data-stu-id="16be1-135">**WCF-WSHttp adapter:**  Provides the WS-\* standards support over the HTTP transport.</span></span> <span data-ttu-id="16be1-136">WCF-WSHttp 适配器实现了下列规范：WS-Transaction（用来在外部应用程序和 MessageBox 数据库之间进行事务性交互）和 WS-Security（用来实现消息安全和身份验证）。</span><span class="sxs-lookup"><span data-stu-id="16be1-136">The WCF-WSHttp adapter implements the following specifications: WS-Transaction for the transactional interactions between external applications and the MessageBox database, and WS-Security for message security and authentication.</span></span> <span data-ttu-id="16be1-137">传输协议是 HTTP 或 HTTPS，和消息编码是一个文本或消息传输优化机制 (MTOM) 编码。</span><span class="sxs-lookup"><span data-stu-id="16be1-137">The transport is HTTP or HTTPS, and message encoding is a text or Message Transmission Optimization Mechanism (MTOM) encoding.</span></span>  
  
2.  <span data-ttu-id="16be1-138">**WCF BasicHttp 适配器：** 通信与基于 ASMX 的 Web 服务和客户端以及符合 WS 其他服务的基本配置文件 1.1。</span><span class="sxs-lookup"><span data-stu-id="16be1-138">**WCF-BasicHttp adapter:** Communicates with ASMX-based Web services and clients and other services that conform to the WS-I Basic Profile 1.1.</span></span> <span data-ttu-id="16be1-139">传输协议是 HTTP 或 HTTPS，消息编码是文本编码。</span><span class="sxs-lookup"><span data-stu-id="16be1-139">The transport is HTTP or HTTPS, and message encoding is a text encoding.</span></span>  
  
3.  <span data-ttu-id="16be1-140">**WCF NetTcp 适配器：** 提供的 WS-\* 标准支持通过 TCP 传输。</span><span class="sxs-lookup"><span data-stu-id="16be1-140">**WCF-NetTcp adapter:** Provides the WS-\* standards support over the TCP transport.</span></span> <span data-ttu-id="16be1-141">WCF-NetTcp 适配器提供有效的通信并实现下列规范：WS-Transaction（用来在外部应用程序和 MessageBox 数据库之间进行事务性交互）和 WS-Security（用来实现消息安全和身份验证）。</span><span class="sxs-lookup"><span data-stu-id="16be1-141">The WCF-NetTcp adapter provides efficient communication and implements the following specifications: WS-Transaction for the transactional interactions between external applications and the MessageBox database, and WS-Security for message security and authentication.</span></span> <span data-ttu-id="16be1-142">传输为 TCP，和消息编码则是二进制编码。</span><span class="sxs-lookup"><span data-stu-id="16be1-142">The transport is TCP, and message encoding is binary encoding.</span></span>  
  
4.  <span data-ttu-id="16be1-143">**WCF NetMsmq 适配器：** 提供支持队列利用消息队列 (也称为 MSMQ) 作为传输协议和启用支持松散耦合应用程序、 故障隔离、 负载分级，并断开连接操作。</span><span class="sxs-lookup"><span data-stu-id="16be1-143">**WCF-NetMsmq adapter:** Provides support for queuing by leveraging Message Queuing (also known as MSMQ) as a transport and enables support for loosely coupled applications, failure isolation, load-leveling, and disconnected operations.</span></span>  
  
5.  <span data-ttu-id="16be1-144">**WCF NetNamedPipe 适配器：** 提供针对计算机上跨进程通信的安全优化。</span><span class="sxs-lookup"><span data-stu-id="16be1-144">**WCF-NetNamedPipe adapter:** Provides secure optimization for on-machine cross-process communication.</span></span> <span data-ttu-id="16be1-145">WCF-NetNamedPipe 适配器使用传输安全性保证传输安全，使用命名管道进行消息传送，并且使用二进制消息编码方式。</span><span class="sxs-lookup"><span data-stu-id="16be1-145">The WCF-NetNamedPipe adapter uses transport security for transfer security, named pipes for message delivery, and binary message encoding.</span></span>  
  
     <span data-ttu-id="16be1-146">每个五个适配器刚刚提到对应于 1:1 的关系中的一个 WCF 绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-146">Each of the five adapters just mentioned correspond to one WCF binding in a 1:1 relationship.</span></span> <span data-ttu-id="16be1-147">我们即将讨论的两个自定义适配器的结构与 WCF 模型稍有不同，在该结构中实际上有两个不同的自定义适配器对应于一个 WCF CustomBinding。</span><span class="sxs-lookup"><span data-stu-id="16be1-147">The structure of the two custom adapters we are about to discuss slightly breaks with the WCF model in that there are actually two distinct custom adapters that correspond to the single WCF CustomBinding.</span></span>  
  
6.  <span data-ttu-id="16be1-148">**WCF 自定义适配器：** 启用 WCF 扩展性功能的使用。</span><span class="sxs-lookup"><span data-stu-id="16be1-148">**WCF-Custom adapter:** Enables the use of WCF extensibility features.</span></span> <span data-ttu-id="16be1-149">使用此适配器可以为在 BizTalk Server 进程中托管的接收位置或发送端口选择并配置 WCF 绑定和行为信息。</span><span class="sxs-lookup"><span data-stu-id="16be1-149">The adapter allows you to select and configure a WCF binding and the behavior information for a receive location or a send port hosted in the BizTalk Server process.</span></span>  
  
7.  <span data-ttu-id="16be1-150">**WCF CustomIsolated 适配器：** 启用通过 HTTP 传输的 WCF 扩展性功能。</span><span class="sxs-lookup"><span data-stu-id="16be1-150">**WCF-CustomIsolated adapter:** Enables the use of WCF extensibility features over the HTTP transport.</span></span> <span data-ttu-id="16be1-151">使用该适配器，可以为运行于 Internet 信息服务 (IIS) 独立主机上的接收位置选择并配置 WCF 绑定和行为信息。</span><span class="sxs-lookup"><span data-stu-id="16be1-151">The adapter allows you to select and configure a WCF binding and the behavior information for a receive location running in the isolated host of Internet Information Services (IIS).</span></span>  
  
## <a name="what-is-the-difference-between-the-wcf-xxx-adapter-and-the-wcf-xxx-binding"></a><span data-ttu-id="16be1-152">WCF-xxx 适配器和 WCF-xxx 绑定之间的区别是什么？</span><span class="sxs-lookup"><span data-stu-id="16be1-152">What is the difference between the WCF-xxx adapter and the WCF-xxx binding?</span></span>  
 <span data-ttu-id="16be1-153">每个 WCF 适配器对应于一个内置的 WCF 绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-153">Each of the WCF adapters corresponds to one of the built-in WCF bindings.</span></span> <span data-ttu-id="16be1-154">在更高层面上，当提到 WCF-xxx 适配器使用 WCF-xxx 绑定时，几乎可交换使用这些术语。</span><span class="sxs-lookup"><span data-stu-id="16be1-154">At a higher level, these terms are used almost interchangeably when saying that the WCF-xxx adapter uses the WCF-xxx binding.</span></span> <span data-ttu-id="16be1-155">例如，WCF-BasicHttp 适配器使用 WCF BasicHttpBinding 类。</span><span class="sxs-lookup"><span data-stu-id="16be1-155">For example, the WCF-BasicHttp adapter uses the WCF BasicHttpBinding class.</span></span> <span data-ttu-id="16be1-156">WCF 绑定是 WCF 终结点定义的一部分。</span><span class="sxs-lookup"><span data-stu-id="16be1-156">A WCF binding is part of the definition of a WCF Endpoint.</span></span> <span data-ttu-id="16be1-157">这在 WCF 终结点的“ABC”中提到，其中这些字母代表地址、绑定和协定。</span><span class="sxs-lookup"><span data-stu-id="16be1-157">This is referred to in the “ABC” of a WCF endpoint, where these letters stand for Address, Binding and Contract.</span></span>  
  
 <span data-ttu-id="16be1-158">绑定由绑定元素的集合组成。</span><span class="sxs-lookup"><span data-stu-id="16be1-158">A binding is made up of a collection of binding elements.</span></span> <span data-ttu-id="16be1-159">每个元素都描述终结点如何与客户端通信的一些方面。</span><span class="sxs-lookup"><span data-stu-id="16be1-159">Each element describes some aspect of how the endpoint communicates with clients.</span></span> <span data-ttu-id="16be1-160">绑定必须包括：</span><span class="sxs-lookup"><span data-stu-id="16be1-160">A binding must include:</span></span>  
  
-   <span data-ttu-id="16be1-161">至少一个传输绑定元素。</span><span class="sxs-lookup"><span data-stu-id="16be1-161">At least one transport binding element.</span></span>  
  
-   <span data-ttu-id="16be1-162">至少一个消息编码绑定元素（默认情况下，传输绑定元素可提供该元素）。</span><span class="sxs-lookup"><span data-stu-id="16be1-162">At least one message-encoding binding element (which the transport binding element can provide by default).</span></span>  
  
-   <span data-ttu-id="16be1-163">任意数量的其他协议绑定元素。</span><span class="sxs-lookup"><span data-stu-id="16be1-163">Any number of other protocol binding elements.</span></span>  
  
 <span data-ttu-id="16be1-164">按此描述生成运行时环境的过程将允许每个绑定元素向该环境提供代码。</span><span class="sxs-lookup"><span data-stu-id="16be1-164">The process that builds a runtime environment out of this description allows each binding element to contribute code to that environment.</span></span> <span data-ttu-id="16be1-165">通常要求客户端与调用的 WCF 服务支持的相同绑定类型和适配器相匹配。</span><span class="sxs-lookup"><span data-stu-id="16be1-165">It is generally required for a client to match the same binding types and adapter that the called WCF Service supports.</span></span> <span data-ttu-id="16be1-166">在 WCF 级别，可在配置文件中以声明方式定义或通过代码明确定义绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-166">At the WCF level, a binding can be defined declaratively in a configuration file or explicitly through code.</span></span> <span data-ttu-id="16be1-167">WCF 适配器使用特定的 WCF 绑定来帮助通信，因此，术语“适配器”和“绑定”在用法上近乎相同。</span><span class="sxs-lookup"><span data-stu-id="16be1-167">A WCF adapter facilitates communication using a specific WCF binding, and thus the terms “adapter” and “binding” tend to become almost identical in their usage.</span></span>  
  
## <a name="when-using-the-wcf-adapters-how-do-you-decide-which-wcf-binding-to-use"></a><span data-ttu-id="16be1-168">在使用 WCF 适配器时，如何决定使用哪个 WCF 绑定？</span><span class="sxs-lookup"><span data-stu-id="16be1-168">When using the WCF adapters, how do you decide which WCF binding to use?</span></span>  
 <span data-ttu-id="16be1-169">您可以根据消息传送模式、外部约束和性能，按这种顺序做出此决定。</span><span class="sxs-lookup"><span data-stu-id="16be1-169">You can make this decision based upon the messaging pattern, external constraints, and performance, in that order.</span></span>  
  
1.  <span data-ttu-id="16be1-170">**消息传递模式：** 通信的模式是通信发生基于消息的流的方式。</span><span class="sxs-lookup"><span data-stu-id="16be1-170">**Messaging pattern:** The pattern of communication is how the communication occurs based on the flow of the message.</span></span> <span data-ttu-id="16be1-171">例如，消息可能是单向（请求）或双向（请求-响应），可能是事务性，也可能是队列形式等。</span><span class="sxs-lookup"><span data-stu-id="16be1-171">For example, the message may be one-way (request) or two-way (request-response), it may be transacted, it may be queued, and so on.</span></span>  
  
    -   <span data-ttu-id="16be1-172">如果是队列形式，则需要使用 WCF-NetMsmq 适配器，它支持单向队列事务性通信。</span><span class="sxs-lookup"><span data-stu-id="16be1-172">If it is queued, you need to use the WCF-NetMsmq adapter, which supports one-way queued transacted communication.</span></span>  
  
    -   <span data-ttu-id="16be1-173">如果模式是双向的请求-响应并且在两台计算机之间流动，则可以使用 HTTP（如果考虑尽可能的灵活）或 WCF-NetTcp（如果考虑性能）。</span><span class="sxs-lookup"><span data-stu-id="16be1-173">If the pattern is a two-way request-response and flows between two computers, you would use HTTP (if you are concerned about being as flexible as possible), or WCF-NetTcp (if you are concerned about performance).</span></span>  
  
    -   <span data-ttu-id="16be1-174">如果消息保留在一台计算机上，并且仅在两个进程之间流动，则可以使用 WCF-NetNamedPipe 绑定。</span><span class="sxs-lookup"><span data-stu-id="16be1-174">If the message remains on a single computer and flows simply between processes, you can use the WCF-NetNamedPipe binding.</span></span>  
  
2.  <span data-ttu-id="16be1-175">**外部的约束：** 可能有规定所使用的特定绑定的问题。</span><span class="sxs-lookup"><span data-stu-id="16be1-175">**External constraints:** There may be issues that dictate you use a specific binding.</span></span> <span data-ttu-id="16be1-176">例如，假定外部系统要求 SOAP Web Services 版本 1.2 和 Addressing 1.0。</span><span class="sxs-lookup"><span data-stu-id="16be1-176">For instance, suppose the external system requires SOAP Web Services version 1.2 and Addressing 1.0.</span></span> <span data-ttu-id="16be1-177">在这种情况下，最好的绑定选择是使用 WCF-WsHttp 适配器的 WSHttpBinding。</span><span class="sxs-lookup"><span data-stu-id="16be1-177">In this case, the best binding choice is WSHttpBinding using the WCF-WsHttp adapter.</span></span> <span data-ttu-id="16be1-178">很可能，外部系统还将要求配置特定的安全模式。</span><span class="sxs-lookup"><span data-stu-id="16be1-178">In all likelihood, the external system would also have requirements around the particular security mode to configure.</span></span> <span data-ttu-id="16be1-179">如果外部系统要求 Soap Web Services 1.1，可以为 HTTP 绑定使用 WCF-BasicHttp 适配器。</span><span class="sxs-lookup"><span data-stu-id="16be1-179">If the external system required Soap Web Services 1.1 you would use the WCF-BasicHttp adapter for the HTTP binding.</span></span>  
  
3.  <span data-ttu-id="16be1-180">**性能：** 调用速度可能的绑定中你选择使用应用程序中的决定性因素：</span><span class="sxs-lookup"><span data-stu-id="16be1-180">**Performance:** How fast the call is made may be a deciding factor in which binding you choose to use in your application:</span></span>  
  
    -   <span data-ttu-id="16be1-181">如果 WCF 服务和 BizTalk Server 在同一台计算机上，则使用 WCF-NetNamedPipe 适配器是最佳的性能选择。</span><span class="sxs-lookup"><span data-stu-id="16be1-181">If the WCF service is on the same computer as BizTalk Server, using the WCF-NetNamedPipe adapter is the best performance choice.</span></span>  
  
    -   <span data-ttu-id="16be1-182">如果 WCF 服务位于本地网络上，WCF-NetTcp 则会产生最佳性能。</span><span class="sxs-lookup"><span data-stu-id="16be1-182">If the WCF service is on your local network, WCF-NetTcp yields the best performance.</span></span>  
  
    -   <span data-ttu-id="16be1-183">如果性能不是主要考虑对象，并且通过 Internet 进行调用，则任何一个基于 HTTP 的适配器（WCF-WsHttp 或 WCF-BasicHttp）都是合适的适配器。</span><span class="sxs-lookup"><span data-stu-id="16be1-183">If performance is not a major concern and the call is going across the Internet, either of the HTTP-based adapters (WCF-WsHttp or WCF-BasicHttp) is the right adapter.</span></span>  
  
         <span data-ttu-id="16be1-184">不管是使用任何高级 HTTP 功能 (WCF-WsHttp) 还是只使用基本功能 (WCF-BasicHttp)，都将指示哪个基于 HTTP 的适配器是最佳的使用选择。</span><span class="sxs-lookup"><span data-stu-id="16be1-184">Whether you are using any advanced HTTP functionality (WCF-WsHttp) or just basic functionality (WCF-BasicHttp) will dictate which HTTP-based adapter is the best choice to use.</span></span>  
  
## <a name="when-do-you-use-one-of-the-two-custom-wcf-adapters"></a><span data-ttu-id="16be1-185">何时使用两个自定义 WCF 适配器之一？</span><span class="sxs-lookup"><span data-stu-id="16be1-185">When do you use one of the two custom WCF adapters?</span></span>  
 <span data-ttu-id="16be1-186">有两个自定义 WCF 适配器附带 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="16be1-186">There are two custom WCF adapters that ship with BizTalk Server.</span></span> <span data-ttu-id="16be1-187">存在两个自定义适配器的原因是因为，BizTalk Server 要求托管某个特定适配器类型需要是其系统注册的一部分。</span><span class="sxs-lookup"><span data-stu-id="16be1-187">The reason there are two custom adapters is because BizTalk Server requires that the hosting of a particular adapter type needs to be part of its registration with the system.</span></span> <span data-ttu-id="16be1-188">虽然在 WCF Framework 中仅有一种 CustomBinding 类型，但是在 BizTalk Server 中有两个自定义适配器，以在已存在的 BizTalk 适配器模型中适应这种限制。</span><span class="sxs-lookup"><span data-stu-id="16be1-188">Although there is only one CustomBinding type in the WCF  Framework, there are two custom adapters in BizTalk Server to accommodate this limitation in the pre-existing BizTalk adapter model.</span></span> <span data-ttu-id="16be1-189">在现实中，这些适配器将真正是您一直需要的仅有的适配器，因为它们允许对 WCF 通道堆栈配置实现完全控制。</span><span class="sxs-lookup"><span data-stu-id="16be1-189">In reality, these adapters are really the only adapters you ever need because they allow complete control over the WCF channel stack configuration.</span></span>  
  
 <span data-ttu-id="16be1-190">自定义适配器的唯一缺点是，它们还需要您对 WCF 配置和各种扩展性技术非常地了解。</span><span class="sxs-lookup"><span data-stu-id="16be1-190">The only drawback to custom adapters is that they also require you to be very knowledgeable about WCF configuration and the various extensibility techniques.</span></span>  <span data-ttu-id="16be1-191">简化配置是 Microsoft 为标准 WCF 绑定提供适配器的原因。</span><span class="sxs-lookup"><span data-stu-id="16be1-191">Simplifying configuration is why Microsoft provides adapters for standard WCF bindings.</span></span> <span data-ttu-id="16be1-192">预定义标准绑定是为了覆盖大多数常用的案例，并使通过 BizTalk Server 发送和接收消息尽可能地简单。</span><span class="sxs-lookup"><span data-stu-id="16be1-192">The standard bindings are predefined to cover most of the common use cases and to make sending and receiving messages through BizTalk Server as simple as possible.</span></span> <span data-ttu-id="16be1-193">使用这些自定义适配器的需求通常仅发生在标准绑定无法完整或精确地满足您的发送端口或接收位置要求。</span><span class="sxs-lookup"><span data-stu-id="16be1-193">The need to use one of these custom adapters typically occurs only when the standard bindings fail to completely or precisely meet the requirements for your send port or receive location.</span></span> <span data-ttu-id="16be1-194">例如，可能存在一个为其消息使用专有压缩方案的应用程序。</span><span class="sxs-lookup"><span data-stu-id="16be1-194">For example, there may be an application using a proprietary compression scheme for its messages.</span></span> <span data-ttu-id="16be1-195">为了对此进行支持，必须编写一个自定义绑定元素。</span><span class="sxs-lookup"><span data-stu-id="16be1-195">To support this, a custom binding element will have to be written.</span></span> <span data-ttu-id="16be1-196">使用两个标准自定义适配器之一，可配置此自定义绑定，以解决传送要求。</span><span class="sxs-lookup"><span data-stu-id="16be1-196">Using one of the two standard custom adapters allows configuration of this custom binding to handle the transmission requirement.</span></span> <span data-ttu-id="16be1-197">因此，自定义适配器允许对通过通道堆栈的通信进程的绑定配置进行更高级别的控制。</span><span class="sxs-lookup"><span data-stu-id="16be1-197">Thus, a custom adapter allows a higher level of control over the configuration of the bindings for that communication process through the channel stack.</span></span>  
  
 <span data-ttu-id="16be1-198">自定义适配器和自定义独立适配器之间的主要区别是托管，托管仅影响 BizTalk Server 的接收端。</span><span class="sxs-lookup"><span data-stu-id="16be1-198">The primary difference between the Custom and Custom Isolated adapters is one of hosting, and hosting only impacts the receive side of BizTalk Server.</span></span> <span data-ttu-id="16be1-199">WCF-CustomIsolated 适配器仅与接收位置一起使用，不与发送端口一起使用。</span><span class="sxs-lookup"><span data-stu-id="16be1-199">The WCF-CustomIsolated adapter is used with a receive location only and not with a send port.</span></span> <span data-ttu-id="16be1-200">术语“独立”是一个 BizTalk 用语，指在 BizTalk Server BtsNtSvc.exe 进程外托管。</span><span class="sxs-lookup"><span data-stu-id="16be1-200">The term “Isolated” is a BizTalk phrase that refers to being hosted outside of the BizTalk Server BtsNtSvc.exe process.</span></span> <span data-ttu-id="16be1-201">因此，当传输被托管在使用 HTTP 传输的 Internet 信息服务 (IIS) 中的标准 BtsNtSvc.exe 进程之外时，将使用 WCF-CustomIsolated 适配器。</span><span class="sxs-lookup"><span data-stu-id="16be1-201">Therefore, the WCF-CustomIsolated adapter is used when the transport is hosted outside the standard BtsNtSvc.exe process within Internet Information Services (IIS) using the HTTP transport.</span></span> <span data-ttu-id="16be1-202">WCF-Custom 适配器可以与接收位置或发送端口一起使用。</span><span class="sxs-lookup"><span data-stu-id="16be1-202">The WCF-Custom adapter can be used with either a receive location or a send port.</span></span> <span data-ttu-id="16be1-203">它在传输被托管在标准 BtsNtSvc.exe 进程中时使用。</span><span class="sxs-lookup"><span data-stu-id="16be1-203">It is used when the transport is hosted inside the standard BtsNtSvc.exe process.</span></span>  
  
## <a name="how-does-a-wcf-endpoint-relate-to-biztalk-server"></a><span data-ttu-id="16be1-204">WCF 终结点如何与 BizTalk Server 相关？</span><span class="sxs-lookup"><span data-stu-id="16be1-204">How does a WCF endpoint relate to BizTalk Server?</span></span>  
 <span data-ttu-id="16be1-205">WCF 终结点由地址、绑定和协定 (ABC) 组成。</span><span class="sxs-lookup"><span data-stu-id="16be1-205">A WCF endpoint is composed of an address, a binding, and a contract (ABC).</span></span> <span data-ttu-id="16be1-206">在 BizTalk Server 中，用户指定接收位置或发送端口的地址。</span><span class="sxs-lookup"><span data-stu-id="16be1-206">Within BizTalk Server, the user specifies the address in the receive location or send port.</span></span> <span data-ttu-id="16be1-207">绑定由用户选择的 WCF 适配器指定。</span><span class="sxs-lookup"><span data-stu-id="16be1-207">The binding is dictated by the WCF adapter the user has chosen.</span></span> <span data-ttu-id="16be1-208">协定由程序员驱动，其中指定终结点公开的接口。</span><span class="sxs-lookup"><span data-stu-id="16be1-208">The contract is programmer-driven in that it specifies the interface exposed by the endpoint.</span></span>  
  
 <span data-ttu-id="16be1-209">实际终结点以 WCF 消息发送到的接收位置形式存在。</span><span class="sxs-lookup"><span data-stu-id="16be1-209">The actual endpoint exists as a receive location to which WCF messages are sent.</span></span>  <span data-ttu-id="16be1-210">有多种方法可以公开 BizTalk Server 应用程序中的 WCF 终结点：</span><span class="sxs-lookup"><span data-stu-id="16be1-210">There are multiple ways to expose a WCF endpoint in a BizTalk Server application:</span></span>  
  
-   <span data-ttu-id="16be1-211">可以使用 BizTalk WCF 服务发布向导将 BizTalk 业务流程发布为 WCF 终结点。</span><span class="sxs-lookup"><span data-stu-id="16be1-211">You can use the BizTalk WCF Service Publishing Wizard to publish a BizTalk orchestration as a WCF endpoint.</span></span>  
  
-   <span data-ttu-id="16be1-212">可以使用 BizTalk WCF 服务发布向导在现有 BizTalk 应用程序中创建一个接收位置。</span><span class="sxs-lookup"><span data-stu-id="16be1-212">You can use the BizTalk WCF Service Publishing Wizard to create a receive location in an existing BizTalk application.</span></span>  
  
-   <span data-ttu-id="16be1-213">可以通过使用代码配置接收位置的绑定和地址手动创建一个 WCF 终结点。</span><span class="sxs-lookup"><span data-stu-id="16be1-213">You can manually create a WCF endpoint by configuring a receive location’s binding and address in code.</span></span>  <span data-ttu-id="16be1-214">在这种情况下，接收位置实际上是无类型的。</span><span class="sxs-lookup"><span data-stu-id="16be1-214">In this case the receive location is actually un-typed.</span></span>  <span data-ttu-id="16be1-215">它有一个完全按照 WCF 消息类指定的协定，从而允许其接收任何消息格式到 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="16be1-215">It has a contract that is specified purely in terms of the WCF Message class, allowing it to receive any message format into the MessageBox database.</span></span>  
  
 <span data-ttu-id="16be1-216">使用 WCF 适配器的每个 BizTalk 接收位置都公开为一个 WCF 终结点，WCF 客户端可以在其中进行调用。</span><span class="sxs-lookup"><span data-stu-id="16be1-216">Each BizTalk receive location that uses a WCF adapter is exposed as a WCF endpoint into which a WCF client can make a call.</span></span>  <span data-ttu-id="16be1-217">接收位置内部使用其自己的 WCF ServiceHost，以允许独立启用或禁用不同的接收位置。</span><span class="sxs-lookup"><span data-stu-id="16be1-217">A receive location internally uses its own WCF ServiceHost to allow the different receive locations to be enabled or disabled independently of each other.</span></span> <span data-ttu-id="16be1-218">只要启用接收位置，便存在服务终结点的生存期。</span><span class="sxs-lookup"><span data-stu-id="16be1-218">The lifetime of the service endpoint exists as long as that receive location is enabled.</span></span> <span data-ttu-id="16be1-219">因为此生存期问题，所以 WCF ServiceHosts对应接收位置，而非接收端口。</span><span class="sxs-lookup"><span data-stu-id="16be1-219">It is because of this lifetime issue that WCF ServiceHosts correspond to receive locations rather than to receive ports.</span></span> <span data-ttu-id="16be1-220">WCF 的设计确保各个 ServiceHosts 从运行时资源而言并不昂贵，许多可以在相同的可执行文件中运行，无任何问题。</span><span class="sxs-lookup"><span data-stu-id="16be1-220">The design of WCF ensures that individual ServiceHosts are not expensive in terms of runtime resources and many can be run within the same executable without any trouble.</span></span>  
  
 <span data-ttu-id="16be1-221">使用 WCF 适配器的每个 BizTalk 发送端口都对应一个对 WCF 服务的调用。</span><span class="sxs-lookup"><span data-stu-id="16be1-221">Each BizTalk send port that uses a WCF adapter corresponds to a call made to a WCF service.</span></span> <span data-ttu-id="16be1-222">当有消息发送时，BizTalk Server 将向适配器发送这些在 BizTalk WCF 适配器中创建 WCF 客户端代理的消息。</span><span class="sxs-lookup"><span data-stu-id="16be1-222">When there are messages to be sent, BizTalk Server gives the adapter those messages that correspond to the creation of the WCF client proxy within the BizTalk WCF adapter.</span></span> <span data-ttu-id="16be1-223">发送消息之后，WCF 客户端代理即被释放。</span><span class="sxs-lookup"><span data-stu-id="16be1-223">After the messages are sent the WCF client proxy is released.</span></span> <span data-ttu-id="16be1-224">发送端口上的 WCF 生存期随代理的创建、使用和释放而不断地开始和结束。</span><span class="sxs-lookup"><span data-stu-id="16be1-224">The WCF lifetime on a send port constantly comes and goes as a proxy is created, used, and torn down.</span></span>