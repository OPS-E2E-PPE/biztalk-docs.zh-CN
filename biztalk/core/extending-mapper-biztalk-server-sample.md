---
title: 扩展映射器 （BizTalk Server 示例） |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- BizTalk Mapper, examples
- XML tools
- BizTalk Mapper, extending
- examples, BizTalk Mapper
- examples, XML tools
ms.assetid: 6010a13f-b715-4766-ad91-5aa9b98589e3
caps.latest.revision: 17
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: ff0cf33f00688b5b609123a644a5d2a298ecaf01
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36995806"
---
# <a name="extending-mapper-biztalk-server-sample"></a><span data-ttu-id="7dcf3-102">扩展映射器 （BizTalk Server 示例）</span><span class="sxs-lookup"><span data-stu-id="7dcf3-102">Extending Mapper (BizTalk Server Sample)</span></span>
<span data-ttu-id="7dcf3-103">扩展映射器示例对如何使用和扩展 BizTalk 映射器进行演示。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-103">The Extending Mapper sample demonstrates how to use and extend BizTalk Mapper.</span></span> <span data-ttu-id="7dcf3-104">本示例包含多个 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 映射文件 (.btm)，其中的每个文件均阐释了 BizTalk 映射器的一个功能。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-104">The sample includes several [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] map files (.btm), each of which illustrates different features of BizTalk Mapper.</span></span>  

## <a name="what-this-sample-does"></a><span data-ttu-id="7dcf3-105">本示例的用途</span><span class="sxs-lookup"><span data-stu-id="7dcf3-105">What This Sample Does</span></span>  
 <span data-ttu-id="7dcf3-106">扩展映射器示例使用基于内容的路由 (CBR)，不使用业务流程。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-106">The Extending Mapper sample uses content-based routing (CBR) and does not use an orchestration.</span></span> <span data-ttu-id="7dcf3-107">通过在示例发送端口上指定筛选器，扩展映射器示例可直接连接到示例接收端口。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-107">By specifying a filter on the sample send port, it is connected directly to the sample receive port.</span></span> <span data-ttu-id="7dcf3-108">会在发送端口上指定一个要应用到已处理文档的映射。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-108">A map is specified on the send port to be applied to the processed document.</span></span>  

## <a name="where-to-find-this-sample"></a><span data-ttu-id="7dcf3-109">本示例所在的位置</span><span class="sxs-lookup"><span data-stu-id="7dcf3-109">Where to Find This Sample</span></span>  
 <span data-ttu-id="7dcf3-110">*\<示例路径\>* \XmlTools\ExtendingMapper</span><span class="sxs-lookup"><span data-stu-id="7dcf3-110">*\<Samples Path\>* \XmlTools\ExtendingMapper</span></span>  

 <span data-ttu-id="7dcf3-111">下表显示了本示例中的文件及其用途说明：</span><span class="sxs-lookup"><span data-stu-id="7dcf3-111">The following table shows the files in this sample and describes their purpose.</span></span>  


|                                                                             <span data-ttu-id="7dcf3-112">文件</span><span class="sxs-lookup"><span data-stu-id="7dcf3-112">File(s)</span></span>                                                                             |                                                         <span data-ttu-id="7dcf3-113">Description</span><span class="sxs-lookup"><span data-stu-id="7dcf3-113">Description</span></span>                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7dcf3-114">MapperClassLibrary\AssemblyInfo.cs、MapperClassLibrary\MapperClassLibrary.csproj、MapperClassLibrary\MapperHelper.cs 和 MapperClassLibrary\MapperClassLibrary.sln</span><span class="sxs-lookup"><span data-stu-id="7dcf3-114">MapperClassLibrary\AssemblyInfo.cs, MapperClassLibrary\MapperClassLibrary.csproj, MapperClassLibrary\MapperHelper.cs, MapperClassLibrary\MapperClassLibrary.sln</span></span> | <span data-ttu-id="7dcf3-115">Microsoft®[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]® 项目文件和 Visual C#® 源文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-115">Microsoft® [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]® project file and Visual C#® source files.</span></span> |
|                                                                           <span data-ttu-id="7dcf3-116">Cleanup.bat</span><span class="sxs-lookup"><span data-stu-id="7dcf3-116">Cleanup.bat</span></span>                                                                           |                      <span data-ttu-id="7dcf3-117">用于取消部署程序集并从全局程序集缓存 (GAC) 删除这些程序集。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-117">Used to undeploy assemblies and remove them from the global assembly cache (GAC).</span></span>                       |
|                                                                         <span data-ttu-id="7dcf3-118">Destination.xsd</span><span class="sxs-lookup"><span data-stu-id="7dcf3-118">Destination.xsd</span></span>                                                                         |                                                         <span data-ttu-id="7dcf3-119">架构文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-119">Schema file.</span></span>                                                         |
|                                                           <span data-ttu-id="7dcf3-120">ExtendingMapper.btproj、ExtendingMapper.sln</span><span class="sxs-lookup"><span data-stu-id="7dcf3-120">ExtendingMapper.btproj, ExtendingMapper.sln</span></span>                                                           |                                     <span data-ttu-id="7dcf3-121">本示例的 BizTalk 项目和解决方案文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-121">BizTalk project and solution files for this sample.</span></span>                                      |
|                                                                       <span data-ttu-id="7dcf3-122">ExtendingMapper.xml</span><span class="sxs-lookup"><span data-stu-id="7dcf3-122">ExtendingMapper.xml</span></span>                                                                       |                                                         <span data-ttu-id="7dcf3-123">源 XML。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-123">Source XML.</span></span>                                                          |
|                                                                   <span data-ttu-id="7dcf3-124">ExtendingMapperBinding.xml</span><span class="sxs-lookup"><span data-stu-id="7dcf3-124">ExtendingMapperBinding.xml</span></span>                                                                    |                                                         <span data-ttu-id="7dcf3-125">绑定 XML。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-125">Binding XML.</span></span>                                                         |
|                                                                      <span data-ttu-id="7dcf3-126">ExternalAssembly.xml</span><span class="sxs-lookup"><span data-stu-id="7dcf3-126">ExternalAssembly.xml</span></span>                                                                       |                                                    <span data-ttu-id="7dcf3-127">外部程序集 XML。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-127">External assembly XML.</span></span>                                                    |
|                                                                      <span data-ttu-id="7dcf3-128">OverridingMapXslt.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-128">OverridingMapXslt.btm</span></span>                                                                      |                                                          <span data-ttu-id="7dcf3-129">映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-129">Map file.</span></span>                                                           |
|                                                                      <span data-ttu-id="7dcf3-130">OverridingMapXslt.xml</span><span class="sxs-lookup"><span data-stu-id="7dcf3-130">OverridingMapXslt.xml</span></span>                                                                      |                                                     <span data-ttu-id="7dcf3-131">替代映射 XML。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-131">Overriding Map XML.</span></span>                                                      |
|                                                                     <span data-ttu-id="7dcf3-132">OverridingMapXslt.xslt</span><span class="sxs-lookup"><span data-stu-id="7dcf3-132">OverridingMapXslt.xslt</span></span>                                                                      |                                                 <span data-ttu-id="7dcf3-133">替代映射样式表。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-133">Overriding Map style sheet.</span></span>                                                  |
|                                                                <span data-ttu-id="7dcf3-134">Scriptor_CallExternalAssembly.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-134">Scriptor_CallExternalAssembly.btm</span></span>                                                                |                                                       <span data-ttu-id="7dcf3-135">示例映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-135">Sample map file.</span></span>                                                       |
|                                                            <span data-ttu-id="7dcf3-136">Scriptor_GlobalVariableInInlineScript.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-136">Scriptor_GlobalVariableInInlineScript.btm</span></span>                                                            |                                                       <span data-ttu-id="7dcf3-137">示例映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-137">Sample map file.</span></span>                                                       |
|                                                                   <span data-ttu-id="7dcf3-138">Scriptor_InlineScripts.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-138">Scriptor_InlineScripts.btm</span></span>                                                                    |                                                       <span data-ttu-id="7dcf3-139">示例映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-139">Sample map file.</span></span>                                                       |
|                                                                     <span data-ttu-id="7dcf3-140">Scriptor_InlineXslt.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-140">Scriptor_InlineXslt.btm</span></span>                                                                     |                                                       <span data-ttu-id="7dcf3-141">示例映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-141">Sample map file.</span></span>                                                       |
|                                                         <span data-ttu-id="7dcf3-142">Scriptor_InlineXsltCallingExternalAssembly.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-142">Scriptor_InlineXsltCallingExternalAssembly.btm</span></span>                                                          |                                                       <span data-ttu-id="7dcf3-143">示例映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-143">Sample map file.</span></span>                                                       |
|                                                                  <span data-ttu-id="7dcf3-144">Scriptor_XsltCalltemplate.btm</span><span class="sxs-lookup"><span data-stu-id="7dcf3-144">Scriptor_XsltCalltemplate.btm</span></span>                                                                  |                                                       <span data-ttu-id="7dcf3-145">示例映射文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-145">Sample map file.</span></span>                                                       |
|                                                                            <span data-ttu-id="7dcf3-146">Setup.bat</span><span class="sxs-lookup"><span data-stu-id="7dcf3-146">Setup.bat</span></span>                                                                            |                                           <span data-ttu-id="7dcf3-147">用于生成和初始化示例。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-147">Used to build and initialize the sample.</span></span>                                           |
|                                                                           <span data-ttu-id="7dcf3-148">Source.xsd</span><span class="sxs-lookup"><span data-stu-id="7dcf3-148">Source.xsd</span></span>                                                                            |                                                         <span data-ttu-id="7dcf3-149">架构文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-149">Schema file.</span></span>                                                         |

## <a name="building-and-initializing-this-sample"></a><span data-ttu-id="7dcf3-150">生成并初始化本示例</span><span class="sxs-lookup"><span data-stu-id="7dcf3-150">Building and Initializing This Sample</span></span>  
 <span data-ttu-id="7dcf3-151">使用以下过程可以生成并初始化扩展映射器示例。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-151">Use the following procedure to build and initialize the Extending Mapper sample.</span></span>  

#### <a name="to-build-and-initialize-this-sample"></a><span data-ttu-id="7dcf3-152">构建和初始化此示例</span><span class="sxs-lookup"><span data-stu-id="7dcf3-152">To build and initialize this sample</span></span>  

1. <span data-ttu-id="7dcf3-153">在命令窗口中，将目录更改 (**cd**) 的以下文件夹：</span><span class="sxs-lookup"><span data-stu-id="7dcf3-153">In a command window, change directory (**cd**) to the following folder:</span></span>  

    <span data-ttu-id="7dcf3-154">*\<示例路径\>* \XmlTools\ExtendingMapper</span><span class="sxs-lookup"><span data-stu-id="7dcf3-154">*\<Samples Path\>* \XmlTools\ExtendingMapper</span></span>  

2. <span data-ttu-id="7dcf3-155">运行 Setup.bat 文件，该文件将执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="7dcf3-155">Run the file Setup.bat, which performs the following actions:</span></span>  

   - <span data-ttu-id="7dcf3-156">为本示例创建输入 (\In) 和输出 (\Out) 文件夹。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-156">Creates the input (\In) and output (\Out) folders for this sample.</span></span>  

   - <span data-ttu-id="7dcf3-157">编译并部署该示例的 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 项目。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-157">Compiles and deploys the [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] project for this sample.</span></span>  

   - <span data-ttu-id="7dcf3-158">创建并绑定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 接收位置、发送和接收端口。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-158">Creates and binds the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receive location, and the send and receive ports.</span></span>  

     <span data-ttu-id="7dcf3-159">如果要使用 Scriptor_CallExternalAssembly.btm 或 Scriptor_InlineXsltCallingExternalAssembly.btm 映射，请在 Visual Studio 中打开 ExtendingMapper.sln 并做以下修改（否则转到步骤 3）：</span><span class="sxs-lookup"><span data-stu-id="7dcf3-159">If you want to use the Scriptor_CallExternalAssembly.btm or Scriptor_InlineXsltCallingExternalAssembly.btm maps, open ExtendingMapper.sln in Visual Studio and make the following modifications (otherwise go to step 3):</span></span>  

   1. <span data-ttu-id="7dcf3-160">在解决方案资源管理器中，打开 Scriptor_CallExternalAssembly.btm。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-160">In Solution Explorer, open Scriptor_CallExternalAssembly.btm.</span></span>  

   2. <span data-ttu-id="7dcf3-161">在映射器网格上选择脚本 functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-161">On the mapper grid, select the Scripting functoid.</span></span>  

   3. <span data-ttu-id="7dcf3-162">在属性网格中，选择**脚本**属性，并单击省略号 （...） 按钮以配置 functoid 脚本。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-162">In the property grid, select the **Script** property, and click the ellipsis (...) button to configure the functoid script.</span></span>  

   4. <span data-ttu-id="7dcf3-163">在中**配置脚本 Functoid**对话框中，选择**脚本 Functoid 配置**，并指定以下内容：</span><span class="sxs-lookup"><span data-stu-id="7dcf3-163">In the **Configure Scripting Functoid** dialog box, select the **Script Functoid Configuration**, and specify the following:</span></span>  


      |      <span data-ttu-id="7dcf3-164">将此项设置</span><span class="sxs-lookup"><span data-stu-id="7dcf3-164">Set this</span></span>       |                           <span data-ttu-id="7dcf3-165">与此</span><span class="sxs-lookup"><span data-stu-id="7dcf3-165">To this</span></span>                            |
      |---------------------|--------------------------------------------------------------|
      |   <span data-ttu-id="7dcf3-166">**脚本类型**</span><span class="sxs-lookup"><span data-stu-id="7dcf3-166">**Script Type**</span></span>   |                      <span data-ttu-id="7dcf3-167">外部程序集</span><span class="sxs-lookup"><span data-stu-id="7dcf3-167">External assembly</span></span>                       |
      | <span data-ttu-id="7dcf3-168">**脚本程序集**</span><span class="sxs-lookup"><span data-stu-id="7dcf3-168">**Script Assembly**</span></span> | <span data-ttu-id="7dcf3-169">Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary</span><span class="sxs-lookup"><span data-stu-id="7dcf3-169">Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary</span></span> |
      |  <span data-ttu-id="7dcf3-170">**脚本类**</span><span class="sxs-lookup"><span data-stu-id="7dcf3-170">**Script Class**</span></span>   |    <span data-ttu-id="7dcf3-171">Microsoft.Samples.BizTalk.ExtendingMapper.MapperHelper</span><span class="sxs-lookup"><span data-stu-id="7dcf3-171">Microsoft.Samples.BizTalk.ExtendingMapper.MapperHelper</span></span>    |
      |  <span data-ttu-id="7dcf3-172">**脚本方法**</span><span class="sxs-lookup"><span data-stu-id="7dcf3-172">**Script Method**</span></span>  |                           <span data-ttu-id="7dcf3-173">MyConcat</span><span class="sxs-lookup"><span data-stu-id="7dcf3-173">MyConcat</span></span>                           |


   5. <span data-ttu-id="7dcf3-174">从[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]**文件**菜单中，选择**保存**若要将更改保存到映射文件，然后关闭解决方案。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-174">From the [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]**File** menu, choose **Save** to save changes to the map file, and close the solution.</span></span>  

3. <span data-ttu-id="7dcf3-175">按任意键继续执行 Setup.bat。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-175">Press any key to continue with Setup.bat.</span></span>  

   > [!IMPORTANT]
   >  <span data-ttu-id="7dcf3-176">如果要使用 Scriptor_InlineXsltCallingExternalAssembly.btm，则必须编辑 ExternalAssembly.xml 文件。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-176">If you want to use Scriptor_InlineXsltCallingExternalAssembly.btm, you must edit the ExternalAssembly.xml file.</span></span> <span data-ttu-id="7dcf3-177">BizTalk 使用 ExternalAssembly.xml 将映射器扩展对象已注册的命名空间映射到 .NET 程序集。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-177">ExternalAssembly.xml is used by BizTalk to map a mapper extension object registered namespace to a .NET assembly.</span></span> <span data-ttu-id="7dcf3-178">由于将按照完全限定的名称（包括其自动生成的公钥标记）对依赖程序集进行引用，因此必须更新此值。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-178">Because the dependent assembly is referenced by its fully qualified name (including its public key token, which is automatically generated), you must update this value.</span></span> <span data-ttu-id="7dcf3-179">如果不想使用 Scriptor_InlineXsltCallingExternalAssembly.btm，则不必完成 a 到 e 的全部步骤。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-179">If you do not want to use Scriptor_InlineXsltCallingExternalAssembly.btm, you do not need to complete steps a through e.</span></span>  

4. <span data-ttu-id="7dcf3-180">在 Windows 资源管理器，导航到\<Windows 文件夹\>\assembly\\。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-180">In Windows Explorer, navigate to \<Windows folder\>\assembly\\.</span></span>  

   1. <span data-ttu-id="7dcf3-181">右键单击**Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary** ，然后选择**属性**。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-181">Right-click **Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary** and select **Properties**.</span></span>  

   2. <span data-ttu-id="7dcf3-182">复制公钥标记值。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-182">Copy the public key token value.</span></span>  

   3. <span data-ttu-id="7dcf3-183">在文本编辑器中，打开*\<示例路径\>* \XML Tools\ExtendingMapper\ExternalAssembly.xml。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-183">In a text editor, open *\<Samples Path\>* \XML Tools\ExtendingMapper\ExternalAssembly.xml.</span></span>  

   4. <span data-ttu-id="7dcf3-184">选择<strong>AssemblyName="Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary，版本 = 1.0.0.0，区域性 = 中性，PublicKeyToken = 68496d20c737d84b"</strong>属性，并替换**PublicKeyToken**公钥标记值的值中复制步骤 c。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-184">Select the <strong>AssemblyName="Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary, Version=1.0.0.0, Culture=neutral, PublicKeyToken=68496d20c737d84b"</strong>attribute, and replace the **PublicKeyToken** value with the public key token value you copied in step c.</span></span>  

   5. <span data-ttu-id="7dcf3-185">保存并关闭 ExternalAssembly.xml。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-185">Save and close ExternalAssembly.xml.</span></span>  

   > [!NOTE]
   >  <span data-ttu-id="7dcf3-186">在尝试运行本示例前，你应确认在生成和初始化过程中未报告任何错误。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-186">You should confirm that no errors were reported during the build and initialization process before attempting to run this sample.</span></span>  

#### <a name="to-configure-enlist-and-start-the-send-port"></a><span data-ttu-id="7dcf3-187">配置、登记并启动发送端口</span><span class="sxs-lookup"><span data-stu-id="7dcf3-187">To configure, enlist, and start the send port</span></span>  

1. <span data-ttu-id="7dcf3-188">单击**启动**，选择**所有程序**，选择**Microsoft BizTalk Server**，然后选择**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-188">Click **Start**, select **All Programs**, select **Microsoft BizTalk Server**, and then select **BizTalk Server Administration**.</span></span>  

2. <span data-ttu-id="7dcf3-189">在 BizTalk Server 管理控制台中，单击以展开**BizTalk Server 管理**，单击此项可展开**BizTalk 组 [\<servername\>:\<管理数据库\>]**，并单击以展开**应用程序**。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-189">In the BizTalk Server Administration console, click to expand **BizTalk Server Administration**, click to expand **BizTalk Group [\<servername\>:\<management database\>]**, and click to expand **Applications**.</span></span>  

3. <span data-ttu-id="7dcf3-190">单击此项可展开**ExtendingMapperApplication**，然后单击**发送端口**。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-190">Click to expand **ExtendingMapperApplication**, and then click **Send Ports**.</span></span>  

4. <span data-ttu-id="7dcf3-191">在右窗格中，右键单击**发送端口**，然后单击**属性**。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-191">In the right pane, right-click **Send Ports**, and then click **Properties**.</span></span>  

5. <span data-ttu-id="7dcf3-192">在中**ExtendingMapperSP – 发送端口属性**对话框中，单击**出站映射**页。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-192">In the **ExtendingMapperSP – Send Port Properties** dialog box, click the **Outbound Maps** page.</span></span>  

    <span data-ttu-id="7dcf3-193">在中**地图**列中，从下拉列表中，选择所需的映射，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-193">In the **Map** column, select the required map from the drop-down list, and then click **OK**.</span></span> <span data-ttu-id="7dcf3-194">下表对这些映射进行了说明。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-194">The maps are described in the following table.</span></span>  


   |                                 <span data-ttu-id="7dcf3-195">“要应用的映射”属性</span><span class="sxs-lookup"><span data-stu-id="7dcf3-195">Map to apply Property</span></span>                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <span data-ttu-id="7dcf3-196">Description</span><span class="sxs-lookup"><span data-stu-id="7dcf3-196">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |       <span data-ttu-id="7dcf3-197">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-197">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-198">Scriptor_CallExternalAssembly</span><span class="sxs-lookup"><span data-stu-id="7dcf3-198">Scriptor_CallExternalAssembly</span></span>        |                                                                                                                                                                                                                                                                                                                                       <span data-ttu-id="7dcf3-199">演示如何调用外部.NET 程序集从中的函数**脚本**functoid 在映射中，基于此 functoid 的输入参数。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-199">Demonstrates how to call into a function in an external .NET assembly from a **Scripting** functoid in a map, based on the input parameters to this functoid.</span></span> <span data-ttu-id="7dcf3-200">这样做有助于将任何处理逻辑与映射文件完全分离。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-200">This helps cleanly separate any processing logic from the map file.</span></span> <span data-ttu-id="7dcf3-201">此映射文件使用本示例附带的 MapperClassLibrary.dll 程序集。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-201">This map file uses the assembly MapperClassLibrary.dll that ships with this sample.</span></span>                                                                                                                                                                                                                                                                                                                                       |
   |           <span data-ttu-id="7dcf3-202">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-202">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-203">Scriptor_InlineScripts</span><span class="sxs-lookup"><span data-stu-id="7dcf3-203">Scriptor_InlineScripts</span></span>           |                                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="7dcf3-204">演示如何编写简单的内联脚本内**脚本**functoid 使用.NET 语言如 C#、 Visual Basic.NET 和 JScript.NET 的映射文件中。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-204">Demonstrates how to write simple inline scripts inside **Scripting** functoids in a map file using .NET languages such as C#, Visual Basic.NET, and JScript.NET.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                  |
   |   <span data-ttu-id="7dcf3-205">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-205">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-206">Scriptor_GlobalVariableInInlineScript</span><span class="sxs-lookup"><span data-stu-id="7dcf3-206">Scriptor_GlobalVariableInInlineScript</span></span>    |                                                                                                                                                                                                                                                                                                                                                                                        <span data-ttu-id="7dcf3-207">演示如何在的内联脚本中使用全局变量**脚本**functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-207">Demonstrates how to use global variables in the inline scripts of **Scripting** functoids.</span></span> <span data-ttu-id="7dcf3-208">全局变量通常用于维护跨不同的映射文件中的状态信息**脚本**functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-208">Global variables are usually used to maintain state information in a map file across different **Scripting** functoids.</span></span>                                                                                                                                                                                                                                                                                                                                                                                         |
   |            <span data-ttu-id="7dcf3-209">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-209">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-210">Scriptor_InlineXslt</span><span class="sxs-lookup"><span data-stu-id="7dcf3-210">Scriptor_InlineXslt</span></span>             |                                                                                                                                                                                                                                                                                                                                   <span data-ttu-id="7dcf3-211">演示如何构造使用原始内联 XSLT 在目标文档中的结构内**脚本**映射中的 functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-211">Demonstrates how to construct structure in the destination document using raw inline XSLT inside a **Scripting** functoid in the map.</span></span> <span data-ttu-id="7dcf3-212">您可以构造目标文档中使用的某些部分**脚本**具有内联 XSLT 时不能为此，在 BizTalk 映射器中使用其他 functoid 的 functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-212">You can construct some parts of the destination document using **Scripting** functoids with inline XSLT whenever it is not possible to do that in BizTalk Mapper using other functoids.</span></span>                                                                                                                                                                                                                                                                                                                                   |
   |         <span data-ttu-id="7dcf3-213">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-213">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-214">Scriptor_XsltCalltemplate</span><span class="sxs-lookup"><span data-stu-id="7dcf3-214">Scriptor_XsltCalltemplate</span></span>          |                                                                                                                                                                                                                                <span data-ttu-id="7dcf3-215">演示如何使用 XSLT 调用模板内的目标文档中创建结构**脚本**映射中的 functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-215">Demonstrates how to create structure in the destination document using an XSLT Call template inside a **Scripting** functoid in the map.</span></span> <span data-ttu-id="7dcf3-216">XSLT 是调用模板可以接受参数，因此您可以创建结构的内联 XSLT 调用模板的优于基于输入参数**脚本**functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-216">The advantage of an XSLT Call template over inline XSLT is that the call template can accept parameters, so you can create the structure based on input parameters to the **Scripting** functoid.</span></span> <span data-ttu-id="7dcf3-217">您可以构造目标文档中使用的某些部分**脚本**具有内联 XSLT 时不能为此，在 BizTalk 映射器中使用其他 functoid 的 functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-217">You can construct some parts of the destination document using **Scripting** functoids with inline XSLT whenever it is not possible to do that in BizTalk Mapper using other functoids.</span></span>                                                                                                                                                                                                                                 |
   | <span data-ttu-id="7dcf3-218">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-218">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-219">Scriptor_InlineXsltCallingExternalAssembly</span><span class="sxs-lookup"><span data-stu-id="7dcf3-219">Scriptor_InlineXsltCallingExternalAssembly</span></span> |                                                                                                                                                                                                                           <span data-ttu-id="7dcf3-220">演示如何调用外部.NET 程序集从的内联 XSLT 内的**脚本**functoid 在映射中的。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-220">Demonstrates how to call into an external .NET assembly from inside The inline XSLT of a **Scripting** functoid in a map.</span></span> <span data-ttu-id="7dcf3-221">介绍了如何覆盖**自定义扩展 XML**与自定义扩展插件文件包含要调用的外部.NET 程序集的详细信息的 externalassembly_extxml.xml 取代 BizTalk 映射器网格的属性。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-221">Explains how you can override the **Custom Extension XML** property of the BizTalk Mapper grid with the custom extension file ExternalAssembly_extxml.xml that contains the details of the external .NET assembly to invoke.</span></span> <span data-ttu-id="7dcf3-222">您可以构造目标文档中使用的某些部分**脚本**具有内联 XSLT 时不能执行该操作使用其他 functoid 在映射器 UI 中的 functoid。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-222">You can construct some parts of the destination document using **Scripting** functoids with inline XSLT whenever it is not possible to do that in the Mapper UI using other functoids.</span></span>                                                                                                                                                                                                                           |
   |             <span data-ttu-id="7dcf3-223">Microsoft.Samples.BizTalk.ExtendingMapper。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-223">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="7dcf3-224">OverridingMapXslt</span><span class="sxs-lookup"><span data-stu-id="7dcf3-224">OverridingMapXslt</span></span>              | <span data-ttu-id="7dcf3-225">演示如何使用自定义 XSLT 文件完全替代 BizTalk 映射器文件的已编译 XSLT。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-225">Demonstrates how to completely override the compiled XSLT of the BizTalk Mapper file with a custom XSLT file.</span></span> <span data-ttu-id="7dcf3-226">您可以执行此操作通过重写**自定义 XSL 路径**属性和可选**自定义扩展 XML** BizTalk 映射器网格的属性。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-226">You can do this by overriding the **Custom XSL Path**property and optionally the **Custom Extension XML** property of the BizTalk Mapper grid.</span></span> <span data-ttu-id="7dcf3-227">你提供的自定义 XSLT 文件包含在要在运行时使用的项目的已编译 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 程序集中。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-227">The custom XSLT file that you provide is included in the compiled [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] assembly of the project you want to use at run time.</span></span> <span data-ttu-id="7dcf3-228">在这种情况下将忽略映射文件 (.btm) 的内容。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-228">In this case, the contents of the map file (.btm) are ignored.</span></span> <span data-ttu-id="7dcf3-229">此映射文件使用 OverridingMapXslt.xslt 和 OverridingMapXslt.xml**自定义 XSL 路径**并**自定义扩展 XML**属性，分别。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-229">This map file uses OverridingMapXslt.xslt and OverridingMapXslt.xml for the **Custom XSL Path** and **Custom Extension XML** properties, respectively.</span></span><br /><br /> <span data-ttu-id="7dcf3-230">你可在解决方案资源管理器中对映射文件进行验证。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-230">You can validate a map file in Solution Explorer.</span></span> <span data-ttu-id="7dcf3-231">然后可以为您可以编辑和使用的模板文件将其**自定义 XSL 路径**BizTalk 映射器网格的属性。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-231">You can then use it as a template file that you can edit and use for the **Custom XSL Path** property of the BizTalk Mapper grid.</span></span> <span data-ttu-id="7dcf3-232">一旦无法使用 BizTalk 映射器生成 XSLT，你即可使用此选项。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-232">You can resort to this option whenever it is not possible to produce this XSLT using BizTalk Mapper.</span></span> |

## <a name="running-this-sample"></a><span data-ttu-id="7dcf3-233">运行本示例</span><span class="sxs-lookup"><span data-stu-id="7dcf3-233">Running This Sample</span></span>  
 <span data-ttu-id="7dcf3-234">使用以下过程运行扩展映射器示例。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-234">Use the following procedure to run the Extending Mapper sample.</span></span>  

#### <a name="to-run-this-sample"></a><span data-ttu-id="7dcf3-235">运行本示例的步骤</span><span class="sxs-lookup"><span data-stu-id="7dcf3-235">To run this sample</span></span>  

1.  <span data-ttu-id="7dcf3-236">复制到输入文件夹中，输入文件 ExtendingMapper.xml *\<示例路径\>* \XmlTools\ExtendingMapper\In。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-236">Copy the input file ExtendingMapper.xml into the input folder at *\<Samples Path\>* \XmlTools\ExtendingMapper\In.</span></span>  

2.  <span data-ttu-id="7dcf3-237">请注意，该文件将转换并路由到如何*\<示例路径\>* \XmlTools\ExtendingMapper\Out 文件夹。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-237">Notice how the file is transformed and routed to the *\<Samples Path\>* \XmlTools\ExtendingMapper\Out folder.</span></span> <span data-ttu-id="7dcf3-238">发生的转换由应用的映射确定。</span><span class="sxs-lookup"><span data-stu-id="7dcf3-238">The transformation that occurs is based on the map you applied.</span></span>  

## <a name="see-also"></a><span data-ttu-id="7dcf3-239">请参阅</span><span class="sxs-lookup"><span data-stu-id="7dcf3-239">See Also</span></span>  
 [<span data-ttu-id="7dcf3-240">XML 工具（BizTalk Server 示例文件夹）</span><span class="sxs-lookup"><span data-stu-id="7dcf3-240">XML Tools (BizTalk Server Samples Folder)</span></span>](../core/xml-tools-biztalk-server-samples-folder.md)