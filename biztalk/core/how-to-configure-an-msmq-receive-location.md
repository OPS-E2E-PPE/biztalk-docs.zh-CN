---
title: "如何配置 MSMQ 接收位置 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- MSMQ adapters, receive locations
- receive locations, MSMQ adapters
- configuring [MSMQ adapters], receive locations
ms.assetid: ba25cf43-18f1-4c19-84fb-74c7b82b95a9
caps.latest.revision: "43"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 795b72318054525485a64c9dd704b81ddf6cb6b9
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
---
# <a name="how-to-configure-an-msmq-receive-location"></a><span data-ttu-id="ae004-102">如何配置 MSMQ 接收位置</span><span class="sxs-lookup"><span data-stu-id="ae004-102">How to Configure an MSMQ Receive Location</span></span>
<span data-ttu-id="ae004-103">您可以在 BizTalk Server 管理控制台中设置 MSMQ 接收位置适配器变量。</span><span class="sxs-lookup"><span data-stu-id="ae004-103">You can set MSMQ receive location adapter variables in the BizTalk Server Administration console.</span></span> <span data-ttu-id="ae004-104">如果未设置接收位置的属性，则使用 BizTalk Server 管理控制台中设置的默认接收处理程序值。</span><span class="sxs-lookup"><span data-stu-id="ae004-104">If properties are not set in the receive location, the default receive handler values set in the BizTalk Server Administration console are used.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ae004-105">在执行以下过程之前，您必须已添加接收端口。</span><span class="sxs-lookup"><span data-stu-id="ae004-105">Before completing the following procedure you must have already added a receive port.</span></span> <span data-ttu-id="ae004-106">有关详细信息请参阅[如何创建接收端口](../core/how-to-create-a-receive-port.md)。</span><span class="sxs-lookup"><span data-stu-id="ae004-106">For more information see [How to Create a Receive Port](../core/how-to-create-a-receive-port.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="ae004-107">如果主机实例与 MSMQ 发送端口或接收位置相关联，则请验证该 MSMQ 服务正在该计算机上运行。</span><span class="sxs-lookup"><span data-stu-id="ae004-107">If a host instance is associated with an MSMQ send port or receive location, verify the MSMQ service is running on that machine.</span></span> <span data-ttu-id="ae004-108">如果该服务未运行，则 MSMQ 接收端口在启动后将随即关闭，并将发送到 MSMQ 发送端口的消息挂起。</span><span class="sxs-lookup"><span data-stu-id="ae004-108">If the service is not running, the MSMQ receive ports will shut down shortly after they are started, and messages sent to the MSMQ send ports will be suspended.</span></span>  
>   
>  <span data-ttu-id="ae004-109">在群集方案中，不仅需要运行群集 MSMQ 实例，还应在每个群集计算机上运行本地 MSMQ 服务。</span><span class="sxs-lookup"><span data-stu-id="ae004-109">In a clustered scenario, not only does the clustered MSMQ instance need to be running, but the local MSMQ service on each cluster machine should be running, as well.</span></span>  
  
## <a name="to-configure-variables-for-an-msmq-receive-location"></a><span data-ttu-id="ae004-110">配置 MSMQ 接收位置的变量</span><span class="sxs-lookup"><span data-stu-id="ae004-110">To configure variables for an MSMQ receive location</span></span>  
 <span data-ttu-id="ae004-111">请按照下列步骤为 MSMQ 接收位置配置变量：</span><span class="sxs-lookup"><span data-stu-id="ae004-111">Follow these steps to configure variables for an MSMQ receive location:</span></span>  
  
1.  <span data-ttu-id="ae004-112">在 BizTalk Server 管理控制台中，展开**BizTalk Server 管理**，展开**BizTalk 组**，展开**应用程序**，然后展开你想要创建中的接收位置的应用程序。</span><span class="sxs-lookup"><span data-stu-id="ae004-112">In the BizTalk Server Administration console, expand **BizTalk Server Administration**, expand **BizTalk Group**, expand **Applications**, and then expand the application you want to create a receive location in.</span></span>  
  
2.  <span data-ttu-id="ae004-113">在 BizTalk Server 管理控制台中，在左窗格中，单击**接收端口**节点。</span><span class="sxs-lookup"><span data-stu-id="ae004-113">In the BizTalk Server Administration console, in the left pane, click the **Receive Port** node.</span></span> <span data-ttu-id="ae004-114">随后，在右窗格中右键单击与现有接收位置关联的接收端口或要与新接收位置关联的接收端口，然后单击“属性” 。</span><span class="sxs-lookup"><span data-stu-id="ae004-114">Then in the right pane, right-click the receive port that is associated with an existing receive location or that you want to associate with a new receive location, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="ae004-115">在**接收端口属性**对话框中，在左侧的窗格中，选择**接收位置**，然后在右窗格中，双击现有接收位置或单击**新建**创建一个新接收位置。</span><span class="sxs-lookup"><span data-stu-id="ae004-115">In the **Receive Port Properties** dialog box, in the left pane, select **Receive Locations**, and then in the right pane, double-click an existing receive location or click **New**to create a new receive location.</span></span>  
  
4.  <span data-ttu-id="ae004-116">在**接收位置属性**对话框中，在**传输**旁边部分**类型**，选择**MSMQ**从下拉列表中，然后单击**配置**。</span><span class="sxs-lookup"><span data-stu-id="ae004-116">In the **Receive Location Properties** dialog box, in the **Transport** section next to **Type**, select **MSMQ** from the drop-down list, and then click **Configure**.</span></span>  
  
5.  <span data-ttu-id="ae004-117">在**MSMQ 传输属性**对话框框中，执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="ae004-117">In the **MSMQ Transport Properties** dialog box, do the following:</span></span>  
  
    |<span data-ttu-id="ae004-118">使用此选项</span><span class="sxs-lookup"><span data-stu-id="ae004-118">Use this</span></span>|<span data-ttu-id="ae004-119">执行的操作</span><span class="sxs-lookup"><span data-stu-id="ae004-119">To do this</span></span>|<span data-ttu-id="ae004-120">日期类型</span><span class="sxs-lookup"><span data-stu-id="ae004-120">Date type</span></span>|<span data-ttu-id="ae004-121">默认值</span><span class="sxs-lookup"><span data-stu-id="ae004-121">Default value</span></span>|  
    |--------------|----------------|---------------|-------------------|  
    |<span data-ttu-id="ae004-122">**密码**</span><span class="sxs-lookup"><span data-stu-id="ae004-122">**Password**</span></span>|<span data-ttu-id="ae004-123">设置用于远程队列的密码。</span><span class="sxs-lookup"><span data-stu-id="ae004-123">Set a password to use for a remote queue.</span></span>|<span data-ttu-id="ae004-124">字符串</span><span class="sxs-lookup"><span data-stu-id="ae004-124">String</span></span>|<span data-ttu-id="ae004-125">空白</span><span class="sxs-lookup"><span data-stu-id="ae004-125">Blank</span></span>|  
    |<span data-ttu-id="ae004-126">**用户名**</span><span class="sxs-lookup"><span data-stu-id="ae004-126">**User Name**</span></span>|<span data-ttu-id="ae004-127">确定与密码结合使用以访问远程队列的用户名。</span><span class="sxs-lookup"><span data-stu-id="ae004-127">Determine the user name to use, in combination with the password, for access to a remote queue.</span></span> <span data-ttu-id="ae004-128">不能使用远程计算机的本地用户作为该用户名。</span><span class="sxs-lookup"><span data-stu-id="ae004-128">You cannot use the local user of the remote computer for the user name.</span></span>|<span data-ttu-id="ae004-129">字符串</span><span class="sxs-lookup"><span data-stu-id="ae004-129">String</span></span>|<span data-ttu-id="ae004-130">空白</span><span class="sxs-lookup"><span data-stu-id="ae004-130">Blank</span></span>|  
    |<span data-ttu-id="ae004-131">**批大小**</span><span class="sxs-lookup"><span data-stu-id="ae004-131">**Batch Size**</span></span>|<span data-ttu-id="ae004-132">配置批大小。</span><span class="sxs-lookup"><span data-stu-id="ae004-132">Configure the batch size.</span></span> <span data-ttu-id="ae004-133">MSMQ 适配器将消息分批提交给 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="ae004-133">The MSMQ adapter submits messages to the MessageBox database in batches.</span></span> <span data-ttu-id="ae004-134">默认的批大小为 20，最小批大小为 1。</span><span class="sxs-lookup"><span data-stu-id="ae004-134">The default batch size is 20, and the minimum batch size is 1.</span></span> <span data-ttu-id="ae004-135">**注意：**如果**事务**接收位置的属性设置为**True**; 每个消息批提交到 MessageBox 数据库的 Microsoft 分布式上下文事务处理协调器 (MSDTC) 事务。</span><span class="sxs-lookup"><span data-stu-id="ae004-135">**Note:**  If the **Transactional** property for the receive location is set to **True**; each message batch is submitted to the MessageBox database under the context of a Microsoft Distributed Transaction Coordinator (MSDTC) transaction.</span></span> <span data-ttu-id="ae004-136">为消息批创建的 MSDTC 事务将始终处于打开状态，直到该批中的所有消息都已保存到 MessageBox 数据库并已放置到相应的订户队列中为止。</span><span class="sxs-lookup"><span data-stu-id="ae004-136">The MSDTC transaction that is created for a message batch remains open until every message in the batch has been persisted to the MessageBox and placed in the appropriate subscriber queue.</span></span> <span data-ttu-id="ae004-137">因此此 MSDTC 事务的持续时间增加作为**批大小**增加参数。</span><span class="sxs-lookup"><span data-stu-id="ae004-137">Therefore the duration of this MSDTC transaction is increased as the **Batch Size** parameter is increased.</span></span> <span data-ttu-id="ae004-138">因为同时具有大量的 MSDTC 事务打开可以对总体性能带来负面影响**批大小**参数不应设置为非常大的值如果启用事务支持。</span><span class="sxs-lookup"><span data-stu-id="ae004-138">Since having a large number of MSDTC transactions open simultaneously can negatively impact overall performance, the **Batch Size** parameter should not be set to a very large value when transaction support is enabled.</span></span>|<span data-ttu-id="ae004-139">int</span><span class="sxs-lookup"><span data-stu-id="ae004-139">Int</span></span>|<span data-ttu-id="ae004-140">20</span><span class="sxs-lookup"><span data-stu-id="ae004-140">20</span></span>|  
    |<span data-ttu-id="ae004-141">**失败**</span><span class="sxs-lookup"><span data-stu-id="ae004-141">**On Failure**</span></span>|<span data-ttu-id="ae004-142">指定适配器响应错误的方式。</span><span class="sxs-lookup"><span data-stu-id="ae004-142">Specify how the adapter should respond to an error.</span></span> <span data-ttu-id="ae004-143">将此属性设置为以下值之一：</span><span class="sxs-lookup"><span data-stu-id="ae004-143">Set this property to one of the following values:</span></span><br /><br /> <span data-ttu-id="ae004-144">-   **停止。**</span><span class="sxs-lookup"><span data-stu-id="ae004-144">-   **Stop.**</span></span> <span data-ttu-id="ae004-145">如果发生错误，则停止通过此接收位置接收消息。</span><span class="sxs-lookup"><span data-stu-id="ae004-145">Stop receiving messages through this receive location if an error condition occurs.</span></span><br /><span data-ttu-id="ae004-146">-   **Suspend(non-resumable)。**</span><span class="sxs-lookup"><span data-stu-id="ae004-146">-   **Suspend(non-resumable).**</span></span> <span data-ttu-id="ae004-147">挂起消息并将其标记为不可恢复。</span><span class="sxs-lookup"><span data-stu-id="ae004-147">Suspend messages and mark as non-resumable.</span></span><br /><span data-ttu-id="ae004-148">-   **Suspend(resumable)。**</span><span class="sxs-lookup"><span data-stu-id="ae004-148">-   **Suspend(resumable).**</span></span> <span data-ttu-id="ae004-149">挂起消息并将其标记为可恢复。</span><span class="sxs-lookup"><span data-stu-id="ae004-149">Suspend messages and mark as resumable.</span></span> <span data-ttu-id="ae004-150">**重要说明：**如果**True**选项**排序处理**属性，**停止**选项**上失败**属性，与**False**选项**事务**属性应用于同一时间，则不会挂起或留在源队列传递失败的任何消息。</span><span class="sxs-lookup"><span data-stu-id="ae004-150">**Important:**  If the **True** option for **Ordered Processing** property, the **Stop** option for the **On Failure** property, and the **False** option for the **Transactional** property are applied at the same time, then any messages that fail delivery will not be suspended or left in the source queue.</span></span> <span data-ttu-id="ae004-151">在此方案中，会发生消息丢失。</span><span class="sxs-lookup"><span data-stu-id="ae004-151">In this scenario, message loss can occur.</span></span> <span data-ttu-id="ae004-152">若要防止数据丢失，当使用**排序处理**功能，**停止**选项**上失败**应该只应用属性，如果**True**选项**事务**应用属性。</span><span class="sxs-lookup"><span data-stu-id="ae004-152">To prevent data loss, when using the **Ordered Processing** feature, the **Stop** option for the **On Failure** property should only be applied if the **True** option for the **Transactional** property is applied.</span></span> <span data-ttu-id="ae004-153">然后，在消息送达失败时，原始消息将会保留在源 MSMQ 队列中。</span><span class="sxs-lookup"><span data-stu-id="ae004-153">Then, if a message delivery failure occurs, the original message will be left in the source MSMQ queue.</span></span> <span data-ttu-id="ae004-154">如果**排序处理**属性设置为值为**False**则**上失败**属性将不会影响，如果消息传递失败仍然出现该消息将状态为挂起**已挂起 （恢复）**。</span><span class="sxs-lookup"><span data-stu-id="ae004-154">If the **Ordered Processing** property is set to a value of **False** then the **On Failure** property will not take effect and if a message delivery failure occurs the message will be suspended with a status of **Suspended (resumable)**.</span></span>|<span data-ttu-id="ae004-155">字符串</span><span class="sxs-lookup"><span data-stu-id="ae004-155">String</span></span>|<span data-ttu-id="ae004-156">已挂起(可恢复)</span><span class="sxs-lookup"><span data-stu-id="ae004-156">Suspend(resumable)</span></span>|  
    |<span data-ttu-id="ae004-157">**有序的处理**</span><span class="sxs-lookup"><span data-stu-id="ae004-157">**Ordered Processing**</span></span>|<span data-ttu-id="ae004-158">将此属性设置为**True**或**False**。</span><span class="sxs-lookup"><span data-stu-id="ae004-158">Set this property to **True** or **False**.</span></span> <span data-ttu-id="ae004-159">这表示是否按顺序处理消息。</span><span class="sxs-lookup"><span data-stu-id="ae004-159">This indicates whether to process messages serially.</span></span> <span data-ttu-id="ae004-160">将属性设置为**True**将容纳有序的消息传递时与具有 BizTalk 消息传递或业务流程发送端口结合使用**按序送达**选项设置为**True**。</span><span class="sxs-lookup"><span data-stu-id="ae004-160">Setting the property to **True** will accommodate ordered message delivery when used in conjunction with a BizTalk messaging or orchestration send port that has the **Ordered Delivery** option set to **True**.</span></span> <span data-ttu-id="ae004-161">有关详细信息请参阅[有序的消息的传递](../core/ordered-delivery-of-messages.md)。</span><span class="sxs-lookup"><span data-stu-id="ae004-161">For more information see [Ordered Delivery of Messages](../core/ordered-delivery-of-messages.md).</span></span><br /><br /> <span data-ttu-id="ae004-162">此属性设置为**True**还通过进行单线程的适配器处理大消息时可以优化资源使用情况。</span><span class="sxs-lookup"><span data-stu-id="ae004-162">Setting this property to **True** also optimizes resource usage when handling large messages by making the adapter single-threaded.</span></span> <span data-ttu-id="ae004-163">有关详细信息，请参阅[发送和接收使用 MSMQ 适配器的大型消息](../core/sending-and-receiving-large-messages-using-the-msmq-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="ae004-163">For more information, see [Sending and Receiving Large Messages Using the MSMQ Adapter](../core/sending-and-receiving-large-messages-using-the-msmq-adapter.md).</span></span>|<span data-ttu-id="ae004-164">Boolean</span><span class="sxs-lookup"><span data-stu-id="ae004-164">Boolean</span></span>|<span data-ttu-id="ae004-165">False</span><span class="sxs-lookup"><span data-stu-id="ae004-165">False</span></span>|  
    |<span data-ttu-id="ae004-166">**队列**</span><span class="sxs-lookup"><span data-stu-id="ae004-166">**Queue**</span></span>|<span data-ttu-id="ae004-167">键入有效的队列路径。</span><span class="sxs-lookup"><span data-stu-id="ae004-167">Type a valid queue path.</span></span> <span data-ttu-id="ae004-168">根据指定的队列路径，系统将执行相应的验证。</span><span class="sxs-lookup"><span data-stu-id="ae004-168">Depending on the queue path you specify, the system performs the appropriate validations.</span></span> <span data-ttu-id="ae004-169">**注意：**对要发送的 URI 端口或接收位置不能超过 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="ae004-169">**Note:**  The URI for a send port or receive location cannot exceed 256 characters.</span></span> <span data-ttu-id="ae004-170">**注意：** MSMQ 接收适配器使用轮询机制来监视每个 0.5 秒的新消息的指定的 MSMQ 队列。</span><span class="sxs-lookup"><span data-stu-id="ae004-170">**Note:**  MSMQ Receive adapter uses a polling mechanism to monitor the specified MSMQ queue for new messages every 0.5 seconds.</span></span> <span data-ttu-id="ae004-171">此 0.5 秒间隔为固定间隔。</span><span class="sxs-lookup"><span data-stu-id="ae004-171">This 0.5 second interval is a fixed interval.</span></span>|<span data-ttu-id="ae004-172">字符串</span><span class="sxs-lookup"><span data-stu-id="ae004-172">String</span></span>|<span data-ttu-id="ae004-173">空白</span><span class="sxs-lookup"><span data-stu-id="ae004-173">Blank</span></span>|  
    |<span data-ttu-id="ae004-174">**事务性**</span><span class="sxs-lookup"><span data-stu-id="ae004-174">**Transactional**</span></span>|<span data-ttu-id="ae004-175">将此属性设置为**True**或**False**。</span><span class="sxs-lookup"><span data-stu-id="ae004-175">Set this property to **True** or **False**.</span></span> <span data-ttu-id="ae004-176">**注意：**的适配器支持的与消息队列 4.0 或更高版本的远程队列事务性读取。</span><span class="sxs-lookup"><span data-stu-id="ae004-176">**Note:**  The adapter supports transactional reads of remote queues with Message Queuing 4.0 or later only.</span></span> <span data-ttu-id="ae004-177">在此方案中 BizTalk Server 和远程消息队列服务器必须运行消息队列 4.0 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="ae004-177">In this scenario both the BizTalk Server and the remote Message Queuing server must be running Message Queuing 4.0 or later.</span></span> <br /><br /> <span data-ttu-id="ae004-178">有关详细信息，请参阅[配置 MSMQ 适配器](../core/configuring-the-msmq-adapter.md)和[在群集主机内运行适配器处理程序的注意事项](../core/considerations-for-running-adapter-handlers-within-a-clustered-host1.md)。</span><span class="sxs-lookup"><span data-stu-id="ae004-178">For more information, see [Configuring the MSMQ Adapter](../core/configuring-the-msmq-adapter.md) and [Considerations for Running Adapter Handlers within a Clustered Host](../core/considerations-for-running-adapter-handlers-within-a-clustered-host1.md).</span></span>|<span data-ttu-id="ae004-179">Boolean</span><span class="sxs-lookup"><span data-stu-id="ae004-179">Boolean</span></span>|<span data-ttu-id="ae004-180">False</span><span class="sxs-lookup"><span data-stu-id="ae004-180">False</span></span>|  
  
    > [!NOTE]
    >  <span data-ttu-id="ae004-181">**用户名**和**密码**仅适用于 Windows 帐户用于访问远程队列。</span><span class="sxs-lookup"><span data-stu-id="ae004-181">The **User Name** and **Password** apply only to Windows accounts used to access remote queues.</span></span>  
  
6.  <span data-ttu-id="ae004-182">单击 **“确定”**。</span><span class="sxs-lookup"><span data-stu-id="ae004-182">Click **OK**.</span></span>  
  
7.  <span data-ttu-id="ae004-183">在**接收位置属性**对话框框中，输入适当的值来完成接收位置的配置，然后单击**确定**以保存设置。</span><span class="sxs-lookup"><span data-stu-id="ae004-183">In the **Receive Location Properties** dialog box, enter the appropriate values to complete the configuration of the receive location, and click **OK** to save settings.</span></span> <span data-ttu-id="ae004-184">璝惠**接收位置属性**对话框中，请参阅[如何创建接收位置](../core/how-to-create-a-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="ae004-184">For information about the **Receive Locations Properties** dialog box, see [How to Create a Receive Location](../core/how-to-create-a-receive-location.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ae004-185">另请参阅</span><span class="sxs-lookup"><span data-stu-id="ae004-185">See Also</span></span>  
 [<span data-ttu-id="ae004-186">配置 MSMQ 适配器</span><span class="sxs-lookup"><span data-stu-id="ae004-186">Configuring the MSMQ Adapter</span></span>](../core/configuring-the-msmq-adapter.md)