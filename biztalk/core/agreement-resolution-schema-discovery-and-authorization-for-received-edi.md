---
title: 协议解析、 架构发现和接收的 EDI 消息的授权 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 503e307c-4cb0-49b5-8751-82dcea203151
caps.latest.revision: 45
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e82722ddb6adfcd3e0f8c5d24050bb58471da378
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65359640"
---
# <a name="agreement-resolution-schema-discovery-and-authorization-for-received-edi-messages"></a><span data-ttu-id="aacab-102">协议解析、 架构发现和接收的 EDI 消息的授权</span><span class="sxs-lookup"><span data-stu-id="aacab-102">Agreement Resolution, Schema Discovery, and Authorization for Received EDI Messages</span></span>
<span data-ttu-id="aacab-103">当[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]接收 EDI 消息时，EDI 接收管道执行贸易合作伙伴协议查找、 架构发现和授权过程以确定如何处理该消息。</span><span class="sxs-lookup"><span data-stu-id="aacab-103">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives an EDI message, the EDI receive pipeline performs trading partner agreement lookup, schema discovery, and authorization processes to determine how to process the message.</span></span>  
  
## <a name="agreement-resolution"></a><span data-ttu-id="aacab-104">协议解析</span><span class="sxs-lookup"><span data-stu-id="aacab-104">Agreement Resolution</span></span>  
 <span data-ttu-id="aacab-105">EDI 接收管道执行贸易合作伙伴协议解析，通过执行一系列步骤来确定是否存在消息中的标头字段与协议定义中的属性相匹配。</span><span class="sxs-lookup"><span data-stu-id="aacab-105">The EDI receive pipeline performs a trading partner agreement resolution by performing a series of steps to determine whether there is a match between header fields in the message and properties in the agreement definition.</span></span> <span data-ttu-id="aacab-106">一次[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]已确定协议，它确定适用于交换 （见下文） 的文档架构。</span><span class="sxs-lookup"><span data-stu-id="aacab-106">Once [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement, it determines the document schema that applies to the interchange (see below).</span></span> <span data-ttu-id="aacab-107">它使用与匹配协议和相关的架构相关联的属性来验证并处理接收的消息。</span><span class="sxs-lookup"><span data-stu-id="aacab-107">It uses the properties associated with the matching agreement and the relevant schema to validate and process the received message.</span></span>  
  
 <span data-ttu-id="aacab-108">若要执行协议解析[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]继续，如下所示：</span><span class="sxs-lookup"><span data-stu-id="aacab-108">To perform agreement resolution, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] proceeds as follows:</span></span>  
  
1. <span data-ttu-id="aacab-109">通过匹配发送方限定符和标识符和接收方限定符和标识符与协议属性中的交换标头中来解析协议。</span><span class="sxs-lookup"><span data-stu-id="aacab-109">Resolve the agreement by matching the sender qualifier and identifier, and the receiver qualifier and identifier, in the interchange header with those in the properties of an agreement.</span></span>  
  
2. <span data-ttu-id="aacab-110">如果第 1 步不成功，进行匹配的发送方限定符和标识符与协议属性中交换标头中的来解析协议。</span><span class="sxs-lookup"><span data-stu-id="aacab-110">If step 1 does not succeed, resolve the agreement by matching just the sender qualifier and identifier in the interchange header with those in the properties of an agreement.</span></span> <span data-ttu-id="aacab-111">此外，因为第一步未成功，则可以安全地假定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将接收消息。</span><span class="sxs-lookup"><span data-stu-id="aacab-111">Also, because the first step did not succeed, it is safe to assume that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be receiving the message.</span></span> <span data-ttu-id="aacab-112">因此，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]尝试与接收方限定符和标识符与以下匹配：</span><span class="sxs-lookup"><span data-stu-id="aacab-112">Hence, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tries to match the receiver qualifier and identifier with the following:</span></span>  
  
   -   <span data-ttu-id="aacab-113">值"BT"和"HostX12Recvr"（适用于 X12 编码的消息） 和</span><span class="sxs-lookup"><span data-stu-id="aacab-113">Values “BT” and “HostX12Recvr” (for X12-encoded messages) and</span></span>  
  
   -   <span data-ttu-id="aacab-114">值"BT"和"HostEdifactRecvr"（适用于 EDIFACT 编码的消息）</span><span class="sxs-lookup"><span data-stu-id="aacab-114">Values “BT” and “HostEdifactRecvr” (for EDIFACT-encoded messages)</span></span>  
  
   > [!IMPORTANT]
   > - <span data-ttu-id="aacab-115">**BizTalk Server 2013 R2，2013年和 2010年**:ISA5、 ISA6、 ISA7、 ISA8、 UNB2.1、 UNB2.2、 UNB3.1 和 UNB3.2 字段是必需的协议设置中。</span><span class="sxs-lookup"><span data-stu-id="aacab-115">**BizTalk Server 2013 R2, 2013, and 2010**: The ISA5, ISA6, ISA7, ISA8, UNB2.1, UNB2.2, UNB3.1, and UNB3.2 fields are mandatory in the agreement settings.</span></span>  
   >   -   <span data-ttu-id="aacab-116">**BizTalk Server 2009 和 2006 R2**:ISA7、 ISA8、 UNB3.1 和 UNB3.2 字段不是参与方设置中必需的。</span><span class="sxs-lookup"><span data-stu-id="aacab-116">**BizTalk Server 2009 and 2006 R2**: The ISA7, ISA8, UNB3.1, and UNB3.2 fields are not mandatory in the party settings.</span></span> <span data-ttu-id="aacab-117">如果这些字段保留为空，则 EDI 引擎提供 ISA5、 ISA6、 UNB2.1 和 UNB2.2 的值为基础的解析。</span><span class="sxs-lookup"><span data-stu-id="aacab-117">If the fields are left blank, the EDI engine gives a resolution based on the values of ISA5, ISA6, UNB2.1, and UNB2.2.</span></span>  
   >   -   <span data-ttu-id="aacab-118">若要支持从 BizTalk Server 2009 和 2006 R2 与较新版本的 BizTalk Server 的解决方法，硬编码 （HostX12Recvr 和 HostEdifactRecvr） 和限定符 (BT) 引入。</span><span class="sxs-lookup"><span data-stu-id="aacab-118">To support the resolutions from BizTalk Server 2009 and 2006 R2 to newer versions of BizTalk Server, the hard coded IDs (HostX12Recvr and HostEdifactRecvr) and qualifiers (BT) are introduced.</span></span>  
   >   -   <span data-ttu-id="aacab-119">EDIFACT 消息应遵循[UNECE 准则](http://www.unece.org/tradewelcome/areas-of-work/un-centre-for-trade-facilitation-and-e-business-uncefact/outputs/standards/unedifact/tradeedifactrules.html)消息语法和规则。</span><span class="sxs-lookup"><span data-stu-id="aacab-119">Your EDIFACT messages should follow the [UNECE guidelines](http://www.unece.org/tradewelcome/areas-of-work/un-centre-for-trade-facilitation-and-e-business-uncefact/outputs/standards/unedifact/tradeedifactrules.html) for message syntax and rules.</span></span>  
  
3. <span data-ttu-id="aacab-120">如果第 2 步不成功，则使用后备协议属性。</span><span class="sxs-lookup"><span data-stu-id="aacab-120">If step 2 does not succeed, use the fallback agreement properties.</span></span>  
  
   <span data-ttu-id="aacab-121">在第一个步骤中，对于 X12，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将使用以下值来执行匹配：</span><span class="sxs-lookup"><span data-stu-id="aacab-121">In the first step, for X12, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the following values to make the match:</span></span>  
  
- <span data-ttu-id="aacab-122">ISA05 （发送方限定符）</span><span class="sxs-lookup"><span data-stu-id="aacab-122">ISA05 (sender qualifier)</span></span>  
  
- <span data-ttu-id="aacab-123">ISA06 （发送方标识符）</span><span class="sxs-lookup"><span data-stu-id="aacab-123">ISA06 (sender identifier)</span></span>  
  
- <span data-ttu-id="aacab-124">ISA07 （接收方限定符）</span><span class="sxs-lookup"><span data-stu-id="aacab-124">ISA07 (receiver qualifier)</span></span>  
  
- <span data-ttu-id="aacab-125">ISA08 （接收方标识符）</span><span class="sxs-lookup"><span data-stu-id="aacab-125">ISA08 (receiver identifier)</span></span>  
  
  <span data-ttu-id="aacab-126">对于 EDIFACT，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将使用以下值来执行匹配：</span><span class="sxs-lookup"><span data-stu-id="aacab-126">For EDIFACT, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the following values to make the match:</span></span>  
  
- <span data-ttu-id="aacab-127">UNB2.1 （发送方标识符）</span><span class="sxs-lookup"><span data-stu-id="aacab-127">UNB2.1 (sender identifier)</span></span>  
  
- <span data-ttu-id="aacab-128">UNB2.2 （发送方限定符）</span><span class="sxs-lookup"><span data-stu-id="aacab-128">UNB2.2 (sender qualifier)</span></span>  
  
- <span data-ttu-id="aacab-129">UNB3.1 （接收方标识符）</span><span class="sxs-lookup"><span data-stu-id="aacab-129">UNB3.1 (receiver identifier)</span></span>  
  
- <span data-ttu-id="aacab-130">UNB3.2 （接收方限定符）</span><span class="sxs-lookup"><span data-stu-id="aacab-130">UNB3.2 (receiver qualifier)</span></span>  
  
  <span data-ttu-id="aacab-131">用于匹配的协议属性中定义**标识符**方向特定协议选项卡的页面**协议属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="aacab-131">The agreement properties used for the match are defined in the **Identifiers** page of the direction-specific agreement tabs of the **Agreement Properties** dialog box.</span></span>  
  
  <span data-ttu-id="aacab-132">这四个接收方和发送端属性唯一地标识贸易合作伙伴协议。</span><span class="sxs-lookup"><span data-stu-id="aacab-132">These four receive-side and send-side properties uniquely identify the trading partner agreement.</span></span> <span data-ttu-id="aacab-133">使用四个属性可以更大的灵活性在接收端处理。</span><span class="sxs-lookup"><span data-stu-id="aacab-133">Using the four properties gives you more flexibility in receive-side processing.</span></span> <span data-ttu-id="aacab-134">例如，这种协议解析的方法可能，可将发送到多个参与方，而无需创建多个确认的发送端口。</span><span class="sxs-lookup"><span data-stu-id="aacab-134">For example, this method of agreement resolution may enable you to send acknowledgments to multiple parties without creating multiple send ports.</span></span>  
  
  <span data-ttu-id="aacab-135">如果[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]不能解析协议使用所有四个发送方和接收方限定符和标识符，它将尝试解析协议只使用发送方限定符和标识符。</span><span class="sxs-lookup"><span data-stu-id="aacab-135">If [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] cannot resolve the agreement using all four sender and receiver qualifiers and identifiers, it will attempt to resolve the agreement using just the sender qualifier and identifier.</span></span> <span data-ttu-id="aacab-136">对于 X12，这些字段为 ISA05 和 ISA06;对于 EDIFACT，这些字段为 UNB2.1 和 UNB2.2。</span><span class="sxs-lookup"><span data-stu-id="aacab-136">For X12, these fields are ISA05 and ISA06; for EDIFACT, these fields are UNB2.1 and UNB2.2.</span></span> <span data-ttu-id="aacab-137">与发送方和接收方属性匹配一样[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]交换标头中的值匹配与协议属性中定义**标识符**的方向特定的协议选项卡页**协议属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="aacab-137">As with a match of sender and receiver properties, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] matches the values in the interchange header with the agreement properties defined in the **Identifiers** page of the direction-specific agreement tabs of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="aacab-138">如果只使用发送方限定符和标识符来解析协议，接收方限定符和标识符应未定义的双向协议选项卡中**协议属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="aacab-138">If only the sender qualifier and identifier are used to resolve the agreement, the receiver qualifier and identifier should be undefined in the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
  <span data-ttu-id="aacab-139">如果不找到任何协议，则[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]使用备用贸易合作伙伴协议中，除非端口设置要求身份验证。</span><span class="sxs-lookup"><span data-stu-id="aacab-139">If no agreement is found, then [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses the fallback trading partner agreement, unless the port setting requires authentication.</span></span> <span data-ttu-id="aacab-140">如果端口设置要求验证 (如果**身份验证失败时删除消息**或**身份验证失败时保留消息**上选择**常规**页**接收端口属性**)，协议是必需的接收端口接收的任何交换。</span><span class="sxs-lookup"><span data-stu-id="aacab-140">If the port setting requires authentication (if either **Drop messages if authentication fails** or **Keep messages if authentication fails** is selected on the **General** page of the **Receive Port Properties**), an agreement is required for any interchange received by the receive port.</span></span> <span data-ttu-id="aacab-141">在这种情况下，如果不通过匹配交换标头与协议属性来解析协议，使用后备协议属性来确定协议不是允许。</span><span class="sxs-lookup"><span data-stu-id="aacab-141">In this case, if the agreement is not resolved by matching the interchange header with agreement properties, using the fallback agreement properties to determine the agreement is not allowed.</span></span> <span data-ttu-id="aacab-142">交换将被视为与身份验证已失败，如果不找到任何协议，并且将被挂起。</span><span class="sxs-lookup"><span data-stu-id="aacab-142">The interchange will be treated as though authentication had failed if no agreement is found, and will be suspended.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="aacab-143">EDI 管道中的消息将转到后续步骤协议中解析直到该消息通过相应步骤得到处于启用状态的协议解析。</span><span class="sxs-lookup"><span data-stu-id="aacab-143">A message in the EDI pipeline goes to the succeeding step in Agreement Resolution till the message gets resolved with the step having Agreement in enable state.</span></span> <span data-ttu-id="aacab-144">例如，如果消息的协议解析的第一步中得到解析，但协议处于禁用状态则消息将转到后续步骤进行解析。</span><span class="sxs-lookup"><span data-stu-id="aacab-144">For example, if the message gets resolved in the first step of Agreement Resolution but the Agreement is in a disabled state then the message goes to the succeeding step for resolution.</span></span>  
  
## <a name="schema-discovery"></a><span data-ttu-id="aacab-145">架构发现</span><span class="sxs-lookup"><span data-stu-id="aacab-145">Schema Discovery</span></span>  
 <span data-ttu-id="aacab-146">之后[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]已确定解析消息，则它必须确定它应使用验证和处理消息的架构的协议。</span><span class="sxs-lookup"><span data-stu-id="aacab-146">After [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement that resolves to the message, it must determine the schema that it should use to validate and process the message.</span></span> <span data-ttu-id="aacab-147">它是使用中标识的属性**本地主机设置**页的单向 （发送端） 的协议选项卡**协议属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="aacab-147">It does so using the properties identified in the **Local Host Settings** page of the one-way (send side) agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="aacab-148">若要确定架构，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]必须首先确定架构命名空间。</span><span class="sxs-lookup"><span data-stu-id="aacab-148">To determine the schema, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must first determine the schema namespace.</span></span> <span data-ttu-id="aacab-149">EDI 拆装器将使用默认命名空间的标准架构附带[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，或者确定要用于自定义架构的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aacab-149">The EDI Disassembler will either use a default namespace for the standard schemas shipped with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], or it will determine the namespace to be used for a custom schema.</span></span>  
  
 <span data-ttu-id="aacab-150">**本地主机设置**页的单向协议选项卡**协议属性**对话框中，您可以设置网格的值来确定自定义的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aacab-150">The **Local Host Settings** page of the one-way agreement tab of the **Agreement Properties** dialog box enables you to set up a grid of values to determine a custom namespace.</span></span> <span data-ttu-id="aacab-151">如果在该网格中不找到任何匹配项，EDI 拆装器将使用默认的命名空间中**目标命名空间**字段标记为默认行。</span><span class="sxs-lookup"><span data-stu-id="aacab-151">If no match is found in that grid, the EDI Disassembler uses the default namespace in the **Target namespace** field marked for the default row.</span></span>  
  
### <a name="x12-schema-discovery"></a><span data-ttu-id="aacab-152">X12 架构发现</span><span class="sxs-lookup"><span data-stu-id="aacab-152">X12 Schema Discovery</span></span>  
 <span data-ttu-id="aacab-153">对于 X12 编码的消息，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]确定自定义命名空间使用的应用程序发送方标识符 (GS02) 和事务集 ID (ST01) 从传入的交换标头。</span><span class="sxs-lookup"><span data-stu-id="aacab-153">For X12-encoded messages, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines a custom namespace using the application sender identifier (GS02) and the transaction set ID (ST01) from the header of the incoming interchange.</span></span> <span data-ttu-id="aacab-154">它会尝试查找这些值与值之间的匹配中的 GS02 和 ST01 属性**自定义目标命名空间**中的网格**本地主机设置**页面 (下**事务集设置**) 的双向协议选项卡的**协议属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="aacab-154">It attempts to find a match between these values and the values for the GS02 and ST01 properties in the **Customize target namespace** grid in the **Local Host Settings** page (under **Transaction Set Settings**) of the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="aacab-155">如果它找到的匹配项，它将使用网格的同一行中的目标命名空间来确定用于验证和处理消息的架构。</span><span class="sxs-lookup"><span data-stu-id="aacab-155">If it finds a match, it will use the target namespace identified in the same row of the grid to determine which schema to us to validate and process the message.</span></span> <span data-ttu-id="aacab-156">如果不确定的目标命名空间，则将使用默认目标命名空间。</span><span class="sxs-lookup"><span data-stu-id="aacab-156">If the target namespace is not determined, then the default target namespace will be used.</span></span> <span data-ttu-id="aacab-157">如果在不确定任何命名空间**目标命名空间**字段标记为默认行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将使用默认情况下X12编码的消息，备用协议属性中标识的目标命名空间`http://schemas.microsoft.com/BizTalk/Edi/X12/2006`.</span><span class="sxs-lookup"><span data-stu-id="aacab-157">If no namespace is identified in the **Target namespace** field marked for the default row, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the target namespace identified in the fallback agreement properties for X12-encoded messages, which by default is `http://schemas.microsoft.com/BizTalk/Edi/X12/2006`.</span></span>  
  
 <span data-ttu-id="aacab-158">对于 X12 交换后发现的目标命名空间，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]使用以下信息来确定架构：</span><span class="sxs-lookup"><span data-stu-id="aacab-158">For X12 interchanges, after the target namespace is discovered, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines the schema using the following information:</span></span>  
  
- <span data-ttu-id="aacab-159">只是发现的目标命名空间</span><span class="sxs-lookup"><span data-stu-id="aacab-159">The target namespace just discovered</span></span>  
  
- <span data-ttu-id="aacab-160">版本/发行版中的前五个字符的 ST03 (如果 GS07 = = X-公认标准委员会 X12)。</span><span class="sxs-lookup"><span data-stu-id="aacab-160">The version/release in the first five characters of ST03 (if GS07 == X - Accredited Standards Committee X12).</span></span> <span data-ttu-id="aacab-161">如果 ST03 不存在/无效或者不会产生架构解析，则版本由前五个字符的 GS08 或 ISA12 (如果 GS07 ！ = X)。</span><span class="sxs-lookup"><span data-stu-id="aacab-161">If ST03 is not present/invalid or does not result in the schema resolution, then the version is determined by the first five characters of GS08 or of ISA12 (if GS07 != X).</span></span>  
  
- <span data-ttu-id="aacab-162">ST01 中的 DocType。</span><span class="sxs-lookup"><span data-stu-id="aacab-162">The DocType in ST01.</span></span>  
  
  <span data-ttu-id="aacab-163">EDI 拆装器将连接编码类型、 版本/发行版和 DocType 来确定架构名称，例如，"X12_00401_864"。</span><span class="sxs-lookup"><span data-stu-id="aacab-163">The EDI Disassembler concatenates the encoding type, version/release, and DocType to determine the schema name, for example, "X12_00401_864".</span></span> <span data-ttu-id="aacab-164">它然后再连接目标命名空间与架构名称，例如， `http://schemas.microsoft.com/BizTalk/Edi/X12/2006/X12#X12_00401_864`。</span><span class="sxs-lookup"><span data-stu-id="aacab-164">It then concatenates the target namespace with the schema name, for example, `http://schemas.microsoft.com/BizTalk/Edi/X12/2006/X12#X12_00401_864`.</span></span>  
  
  <span data-ttu-id="aacab-165">对于传入 HIPAA 837 交换，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]支持三种 HIPAA 837 架构：</span><span class="sxs-lookup"><span data-stu-id="aacab-165">For an incoming HIPAA 837 interchange, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] supports three HIPAA 837 schemas:</span></span>  
  
|<span data-ttu-id="aacab-166">837 架构</span><span class="sxs-lookup"><span data-stu-id="aacab-166">837 Schema</span></span>|<span data-ttu-id="aacab-167">版本 4010 中的 GS08 值</span><span class="sxs-lookup"><span data-stu-id="aacab-167">GS08 Value in version 4010</span></span>|<span data-ttu-id="aacab-168">版本 5010 中的 GS08/ST03 值</span><span class="sxs-lookup"><span data-stu-id="aacab-168">GS08/ST03 Value in version 5010</span></span>|  
|----------------|--------------------------------|--------------------------------------|  
|<span data-ttu-id="aacab-169">Claim-Dental_837D</span><span class="sxs-lookup"><span data-stu-id="aacab-169">Claim-Dental_837D</span></span>|<span data-ttu-id="aacab-170">004010X097A1</span><span class="sxs-lookup"><span data-stu-id="aacab-170">004010X097A1</span></span>|<span data-ttu-id="aacab-171">005010X224A1</span><span class="sxs-lookup"><span data-stu-id="aacab-171">005010X224A1</span></span>|  
|<span data-ttu-id="aacab-172">Claim-Institutional_837I</span><span class="sxs-lookup"><span data-stu-id="aacab-172">Claim-Institutional_837I</span></span>|<span data-ttu-id="aacab-173">004010X096A1</span><span class="sxs-lookup"><span data-stu-id="aacab-173">004010X096A1</span></span>|<span data-ttu-id="aacab-174">005010X223A1</span><span class="sxs-lookup"><span data-stu-id="aacab-174">005010X223A1</span></span>|  
|<span data-ttu-id="aacab-175">Claim-Professional_837P</span><span class="sxs-lookup"><span data-stu-id="aacab-175">Claim-Professional_837P</span></span>|<span data-ttu-id="aacab-176">004010X098A1</span><span class="sxs-lookup"><span data-stu-id="aacab-176">004010X098A1</span></span>|<span data-ttu-id="aacab-177">005010X222</span><span class="sxs-lookup"><span data-stu-id="aacab-177">005010X222</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="aacab-178">在 HIPAA 版本中，为事务集 278 （医疗保健服务审核），请求和响应对的 GS08 和 ST01 共享相同的值。</span><span class="sxs-lookup"><span data-stu-id="aacab-178">In HIPAA versions, for the transaction set 278 (Health Care Services Review), both the request and response pairs share the same value for GS08 and ST01.</span></span> <span data-ttu-id="aacab-179">具体取决于你可以区分 278 BHT02 字段中的触发器值请求 / 响应版本 5010 中：</span><span class="sxs-lookup"><span data-stu-id="aacab-179">Depending on the trigger values in BHT02 field you may differentiate between a 278 Request/ Response in version 5010:</span></span>  
> 
> 1. <span data-ttu-id="aacab-180">任一值 01、 13 和 36 BHT02 中的表示医疗保健服务审核请求</span><span class="sxs-lookup"><span data-stu-id="aacab-180">Any of the values 01, 13 and 36 in BHT02 indicates a Health Care Services Review Request</span></span>  
>    2.  <span data-ttu-id="aacab-181">BHT02 中的 11 表示医疗保健服务审核响应</span><span class="sxs-lookup"><span data-stu-id="aacab-181">11 in BHT02 indicates Health Care Services Review Response</span></span>  
  
### <a name="edifact-schema-discovery"></a><span data-ttu-id="aacab-182">EDIFACT 架构发现</span><span class="sxs-lookup"><span data-stu-id="aacab-182">EDIFACT Schema Discovery</span></span>  
 <span data-ttu-id="aacab-183">对于 EDIFACT 编码的消息，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]确定自定义命名空间： 使用消息类型 (UNH2.1)、 消息版本号 (UNH2.2)、 消息发行版号 (UNH2.3)、 分配的代码 (UNH2.5)、 功能组 ID (UNG2.1) 和应用程序发送代码从传入的交换标头中的限定符 (UNG2.2)。</span><span class="sxs-lookup"><span data-stu-id="aacab-183">For EDIFACT-encoded messages, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines a custom namespace using the message type (UNH2.1), message version number (UNH2.2), message release number (UNH2.3), assigned code (UNH2.5), functional group ID (UNG2.1), and application send code qualifier (UNG2.2) from the header of the incoming interchange.</span></span> <span data-ttu-id="aacab-184">它会尝试查找这些值与值之间的匹配中的 UNH2.1、 UNH2.2、 UNH2.3、 UNH2.5、 UNG2.1 和 UNG2.2 属性**自定义目标命名空间**网格 (下**事务集设置**)双向协议选项卡的**协议属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="aacab-184">It then attempts to find a match between these values and the values for the UNH2.1, UNH2.2, UNH2.3, UNH2.5, UNG2.1, and UNG2.2 properties in the **Customize target namespace** grid (under **Transaction Set Settings**) of the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="aacab-185">如果它找到的匹配项，它将使用网格的同一行中的目标命名空间来确定要用于验证和处理消息的架构。</span><span class="sxs-lookup"><span data-stu-id="aacab-185">If it finds a match, it will use the target namespace identified in the same row of the grid to determine which schema to use to validate and process the message.</span></span> <span data-ttu-id="aacab-186">如果不确定的目标命名空间，则将使用默认目标命名空间。</span><span class="sxs-lookup"><span data-stu-id="aacab-186">If the target namespace is not determined, then the default target namespace will be used.</span></span> <span data-ttu-id="aacab-187">如果在不确定任何命名空间**目标命名空间**字段标记为默认行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将使用目标命名空间对于 EDIFACT 编码的消息，后备协议属性中默认情况下为`http://schemas.microsoft.com/BizTalk/Edi/EDIFACT/2006`.</span><span class="sxs-lookup"><span data-stu-id="aacab-187">If no namespace is identified in the **Target namespace** field marked for the default row, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the target namespace identified in the fallback agreement properties for EDIFACT-encoded messages, which by default is `http://schemas.microsoft.com/BizTalk/Edi/EDIFACT/2006`.</span></span>  
  
 <span data-ttu-id="aacab-188">对于 EDIFACT 交换，一旦发现目标命名空间，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]使用以下信息来确定架构：</span><span class="sxs-lookup"><span data-stu-id="aacab-188">For EDIFACT interchanges, once the target namespace is discovered, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines the schema using the following information:</span></span>  
  
- <span data-ttu-id="aacab-189">只是发现的目标命名空间。</span><span class="sxs-lookup"><span data-stu-id="aacab-189">The target namespace just discovered.</span></span>  
  
- <span data-ttu-id="aacab-190">UNH2.2 中的消息版本数。</span><span class="sxs-lookup"><span data-stu-id="aacab-190">The message version number in UNH2.2.</span></span>  
  
- <span data-ttu-id="aacab-191">UNH2.3 中的消息发行版号。</span><span class="sxs-lookup"><span data-stu-id="aacab-191">The message release number in UNH2.3.</span></span>  
  
- <span data-ttu-id="aacab-192">UNH2.1 中的消息类型。</span><span class="sxs-lookup"><span data-stu-id="aacab-192">The message type in UNH2.1.</span></span>  
  
- <span data-ttu-id="aacab-193">UNH2.5 中分配的代码。</span><span class="sxs-lookup"><span data-stu-id="aacab-193">The assigned code in UNH2.5.</span></span>  
  
  <span data-ttu-id="aacab-194">EDI 拆装器将连接编码类型、 版本、 发布和消息类型来确定架构名称，例如，"EFACT_D94A_CONTEN"。</span><span class="sxs-lookup"><span data-stu-id="aacab-194">The EDI Disassembler concatenates the encoding type, the version, the release, and the message type to determine the schema name, for example, " EFACT_D94A_CONTEN".</span></span> <span data-ttu-id="aacab-195">它然后再连接目标命名空间与架构名称，例如， `http://schemas.microsoft.com/BizTalk/Edi/Edifact/2006/EFACT#EFACT_D94A_CONTEN`。</span><span class="sxs-lookup"><span data-stu-id="aacab-195">It then concatenates the target namespace with the schema name, for example, `http://schemas.microsoft.com/BizTalk/Edi/Edifact/2006/EFACT#EFACT_D94A_CONTEN`.</span></span>  
  
  <span data-ttu-id="aacab-196">如果消息中存在 UNH2.5，则 EDI 拆装器将首先尝试使用 UNH2.5 的值作为架构名称，如"EFACT_D94A_CONTEN_TEST"的一部分找到的匹配架构。</span><span class="sxs-lookup"><span data-stu-id="aacab-196">If UNH2.5 is present in the message, the EDI Disassembler will first attempt to find a matching schema by using the value of UNH2.5 as part of the schema name, for example “EFACT_D94A_CONTEN_TEST”.</span></span> <span data-ttu-id="aacab-197">如果不找到任何匹配架构，则 EDI 拆装器将回退到查找无 UNH2.5 值的架构。</span><span class="sxs-lookup"><span data-stu-id="aacab-197">If no matching schema is found, the EDI Disassembler will fall back to finding the schema without the UNH2.5 value.</span></span>  
  
## <a name="authorization"></a><span data-ttu-id="aacab-198">授权</span><span class="sxs-lookup"><span data-stu-id="aacab-198">Authorization</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="aacab-199">检查为协议消息中的字段定义的授权和安全字段的值。</span><span class="sxs-lookup"><span data-stu-id="aacab-199">checks the values of the authorization and security fields defined for the agreement with the fields in the message.</span></span> <span data-ttu-id="aacab-200">如果存在不匹配，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将挂起该交换。</span><span class="sxs-lookup"><span data-stu-id="aacab-200">If there is a mismatch, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will suspend the interchange.</span></span> <span data-ttu-id="aacab-201">对于 EDIFACT 编码的消息，这些字段是收件人引用密码 （UNB6.1 和 UNB6.2）。</span><span class="sxs-lookup"><span data-stu-id="aacab-201">For EDIFACT-encoded messages, these fields are the recipient reference password (UNB6.1 and UNB6.2).</span></span> <span data-ttu-id="aacab-202">对于 X12 编码的消息，这些字段是授权限定符和信息 (ISA1-2) 和安全限定符和信息 (ISA3-4)。</span><span class="sxs-lookup"><span data-stu-id="aacab-202">For X12-encoded messages, these fields are the Authorization qualifier and information (ISA1-2) and Security qualifier and information (ISA3-4).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aacab-203">请参阅</span><span class="sxs-lookup"><span data-stu-id="aacab-203">See Also</span></span>  
 [<span data-ttu-id="aacab-204">BizTalk Server 如何接收 EDI 消息</span><span class="sxs-lookup"><span data-stu-id="aacab-204">How BizTalk Server Receives EDI Messages</span></span>](../core/how-biztalk-server-receives-edi-messages.md)