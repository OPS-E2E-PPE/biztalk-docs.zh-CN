---
title: 协议在 EDI 处理中的角色 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d81b0449-6656-49f7-a781-5fd60031b3d5
caps.latest.revision: 25
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d2125ca348cc8f333b1b223404371ae13b113fe1
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36980430"
---
# <a name="the-role-of-agreements-in-edi-processing"></a><span data-ttu-id="5854f-102">协议在 EDI 处理中的角色</span><span class="sxs-lookup"><span data-stu-id="5854f-102">The Role of Agreements in EDI Processing</span></span>
<span data-ttu-id="5854f-103">组织使用 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 来从一个或多个贸易合作伙伴接收 EDI 消息，以及向其发送 EDI 消息。</span><span class="sxs-lookup"><span data-stu-id="5854f-103">An organization uses [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to receive EDI messages from, and send EDI messages to, one or more trading partners.</span></span> <span data-ttu-id="5854f-104">然后贸易合作伙伴定义作为组织内业务实体的业务配置文件。</span><span class="sxs-lookup"><span data-stu-id="5854f-104">The trading partners, in turn define business profiles that are business entities within an organization.</span></span> <span data-ttu-id="5854f-105">如何将业务配置文件交换消息定义为两个业务配置文件之间的贸易合作伙伴协议的一部分。</span><span class="sxs-lookup"><span data-stu-id="5854f-105">How business profiles exchange messages is defined as part of trading partner agreements between two business profiles.</span></span> <span data-ttu-id="5854f-106">有关详细信息，请参阅[贸易合作伙伴管理解决方案的构建基块](../core/building-blocks-of-a-trading-partner-management-solution.md)。</span><span class="sxs-lookup"><span data-stu-id="5854f-106">For more information, see [Building Blocks of a Trading Partner Management Solution](../core/building-blocks-of-a-trading-partner-management-solution.md).</span></span>  
  
 <span data-ttu-id="5854f-107">在贸易合作伙伴管理 (TPM) 用户界面中创建一个贸易伙伴协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-107">You create a trading partner agreement in the Trading Partner Management (TPM) user interface.</span></span> <span data-ttu-id="5854f-108">TPM 屏幕位于**参与方**节点的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="5854f-108">The TPM screens are in the **Parties** node of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console.</span></span>  
  
## <a name="configuring-an-agreement-for-edi-processing"></a><span data-ttu-id="5854f-109">为 EDI 处理配置协议</span><span class="sxs-lookup"><span data-stu-id="5854f-109">Configuring an Agreement for EDI Processing</span></span>  
 <span data-ttu-id="5854f-110">全部使用 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 交换 EDI 消息的贸易合作伙伴都必须就通信参数达成一致。</span><span class="sxs-lookup"><span data-stu-id="5854f-110">All trading partners that will be exchanging EDI messages using [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must agree upon communication parameters.</span></span> <span data-ttu-id="5854f-111">实现此目标之后，托管 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的组织必须在 TPM 中创建贸易合作伙伴，包括自己的贸易合作伙伴，创建业务配置文件，以及业务配置文件之间的贸易合作伙伴协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-111">After they have done this, the organization hosting [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must create the trading partners in TPM (including a trading partner for itself), create the business profiles, and the trading partner agreement between the business profiles.</span></span> <span data-ttu-id="5854f-112">作为贸易合作伙伴协议的一部分，您可以就 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 如何从贸易合作伙伴的业务配置文件接收 EDI 消息，以及如何向其发送 EDI 消息来设置这些属性。</span><span class="sxs-lookup"><span data-stu-id="5854f-112">As part of the trading partner agreement, you set the properties for how [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives an EDI message from, and send an EDI message to, the trading partner’s business profile.</span></span> <span data-ttu-id="5854f-113">其他贸易合作伙伴也必须执行相同操作；若要交换消息，两端的配置必须兼容。</span><span class="sxs-lookup"><span data-stu-id="5854f-113">On their end, the other trading partners must do the same, and to exchange messages, the configurations must be compatible.</span></span>  
  
 <span data-ttu-id="5854f-114">必须定义下列属性集，才能进行 EDI 通信。</span><span class="sxs-lookup"><span data-stu-id="5854f-114">You must define the following sets of properties for EDI communications.</span></span>  
  
- <span data-ttu-id="5854f-115">定义贸易合作伙伴的一般情况（如名称、发送端口以及签名证书）的贸易合作伙伴属性。</span><span class="sxs-lookup"><span data-stu-id="5854f-115">Trading partner properties that define general aspects of the trading partner, such as name, send ports, and the signing certificate.</span></span>  
  
- <span data-ttu-id="5854f-116">定义业务标识的业务配置文件属性。</span><span class="sxs-lookup"><span data-stu-id="5854f-116">Business profile properties that define the business identities.</span></span>  
  
- <span data-ttu-id="5854f-117">作为贸易合作伙伴协议的一部分的 EDI 属性，定义了 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 将如何处理贸易合作伙伴的传入消息，以及如何生成将要发送到贸易合作伙伴的传出消息。</span><span class="sxs-lookup"><span data-stu-id="5854f-117">EDI properties, as part of the trading partner agreement, that defines how [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will process an incoming message from a trading partner and how it will generate an outgoing message bound to the trading partner.</span></span>  
  
- <span data-ttu-id="5854f-118">作为贸易合作伙伴协议一部分的 AS2 属性，定义了 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 将如何执行传入和传出 AS2 通信。</span><span class="sxs-lookup"><span data-stu-id="5854f-118">AS2 properties, as part of the trading partner agreement, that defines how [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will perform AS2 communications, both incoming and outgoing.</span></span> <span data-ttu-id="5854f-119">仅当通过 AS2 发送 EDI 消息时，这些属性才会影响 EDI 通信。</span><span class="sxs-lookup"><span data-stu-id="5854f-119">These properties affect EDI communications only when an EDI message is sent over AS2.</span></span>  
  
  > [!NOTE]
  >  <span data-ttu-id="5854f-120">将单独指定相同业务配置文件之间的 AS2 协议和 EDI 消息协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-120">The AS2 agreement and the EDI messaging agreement between the same business profiles are specified separately.</span></span> <span data-ttu-id="5854f-121">两个协议共同形成合作关系。</span><span class="sxs-lookup"><span data-stu-id="5854f-121">The two agreements together form a partnership.</span></span>  
  
  <span data-ttu-id="5854f-122">贸易合作伙伴协议属性确定以下特定处理：</span><span class="sxs-lookup"><span data-stu-id="5854f-122">Trading partner agreement properties determine the following specific processing:</span></span>  
  
- <span data-ttu-id="5854f-123">EDI 信封处理和生成</span><span class="sxs-lookup"><span data-stu-id="5854f-123">EDI envelope processing and generation</span></span>  
  
- <span data-ttu-id="5854f-124">确认处理和生成</span><span class="sxs-lookup"><span data-stu-id="5854f-124">ACK processing and generation</span></span>  
  
- <span data-ttu-id="5854f-125">验证传入和传出的 EDI 消息</span><span class="sxs-lookup"><span data-stu-id="5854f-125">Validation of incoming and outgoing EDI messages</span></span>  
  
- <span data-ttu-id="5854f-126">批处理创建</span><span class="sxs-lookup"><span data-stu-id="5854f-126">Batch creation</span></span>  
  
- <span data-ttu-id="5854f-127">状态报告</span><span class="sxs-lookup"><span data-stu-id="5854f-127">Status reporting</span></span>  
  
  <span data-ttu-id="5854f-128">有关业务标识，可以有特定值，如**D-U-N-S (Dun & Bradstreet)**。</span><span class="sxs-lookup"><span data-stu-id="5854f-128">For business identities, there can be specific values, such as **D-U-N-S (Dun & Bradstreet)**.</span></span> <span data-ttu-id="5854f-129">特定名称具有特定限定符，例如“01”表示 Duns。</span><span class="sxs-lookup"><span data-stu-id="5854f-129">Specific names have specific qualifiers, such as "01" for Duns.</span></span> <span data-ttu-id="5854f-130">如果业务标识名不是特定的，则使用“ZZ”表示 X12 编码消息，使用“ZZZ”表示 EDIFACT 编码消息，指示由单独实体双方定义的名称。</span><span class="sxs-lookup"><span data-stu-id="5854f-130">When a business identity name is not specific, "ZZ" is used for X12-encoded messages and "ZZZ" is used for EDIFACT-encoded messages, indicating a name mutually defined by separate entities.</span></span> <span data-ttu-id="5854f-131">然后，值和限定符标识业务配置文件。</span><span class="sxs-lookup"><span data-stu-id="5854f-131">The value and qualifier then identifies the business profile.</span></span> <span data-ttu-id="5854f-132">业务标识名仅供参考；BizTalk 运行时在处理时不会使用业务标识名。</span><span class="sxs-lookup"><span data-stu-id="5854f-132">The name of the business identity is for informational purposes only; it is not used by the BizTalk runtime for processing.</span></span>  
  
## <a name="determining-an-agreement-for-edi-processing"></a><span data-ttu-id="5854f-133">确定用于 EDI 处理的协议</span><span class="sxs-lookup"><span data-stu-id="5854f-133">Determining an Agreement for EDI Processing</span></span>  
 <span data-ttu-id="5854f-134">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 在接收 EDI 消息时都会尝试确定消息解析到的贸易合作伙伴协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-134">Any time [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives an EDI message, it attempts to determine the trading partner agreement that the message resolves to.</span></span> <span data-ttu-id="5854f-135">它会通过将定义为协议一部分的发送方限定符、发送方标识符、接收方限定符、接收方标识符和消息进行匹配，以尝试解析贸易合作伙伴协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-135">It attempts to resolve the trading partner agreement by making a match between the message and the sender qualifier, sender identifier, receiver qualifier, and receiver identifier defined as part of the agreement.</span></span> <span data-ttu-id="5854f-136">此过程的更多详细信息，请参阅[协议解析、 架构发现和收到的 EDI 消息的授权](../core/agreement-resolution-schema-discovery-and-authorization-for-received-edi.md)。</span><span class="sxs-lookup"><span data-stu-id="5854f-136">For more details on this process, see [Agreement Resolution, Schema Discovery, and Authorization for Received EDI Messages](../core/agreement-resolution-schema-discovery-and-authorization-for-received-edi.md).</span></span>  
  
 <span data-ttu-id="5854f-137">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 在生成要发送的 EDI 消息时都会尝试确定与要接收该消息的业务配置文件相关联的协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-137">Any time [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] generates an EDI message to send, it attempts to determine the agreement that associates with the business profile to which the message will be sent.</span></span> <span data-ttu-id="5854f-138">它使用以下任何参数在消息和协议之间进行匹配，以尝试解析协议：</span><span class="sxs-lookup"><span data-stu-id="5854f-138">It attempts to resolve the agreement by making a match between the message and the agreement using any of the following:</span></span>  
  
- <span data-ttu-id="5854f-139">上下文属性 AgreementPartIdForSend</span><span class="sxs-lookup"><span data-stu-id="5854f-139">Context property AgreementPartIdForSend</span></span>  
  
- <span data-ttu-id="5854f-140">上下文属性 AgreementNameForSend、SenderPartyNameForSend 和 ReceiverPartyNameForSend</span><span class="sxs-lookup"><span data-stu-id="5854f-140">Context properties AgreementNameForSend, SenderPartyNameForSend, and ReceiverPartyNameForSend</span></span>  
  
- <span data-ttu-id="5854f-141">发件人限定符和标识符，以及接收方限定符和标识符</span><span class="sxs-lookup"><span data-stu-id="5854f-141">Sender qualifiers and identifiers, and receiver qualifiers and identifiers</span></span>  
  
- <span data-ttu-id="5854f-142">发送端口名称</span><span class="sxs-lookup"><span data-stu-id="5854f-142">Send port name</span></span>  
  
  <span data-ttu-id="5854f-143">此过程的更多详细信息，请参阅[协议解析和架构确定传出 EDI 消息的](../core/agreement-resolution-and-schema-determination-for-outgoing-edi-messages.md)。</span><span class="sxs-lookup"><span data-stu-id="5854f-143">For more details on this process, see [Agreement Resolution and Schema Determination for Outgoing EDI Messages](../core/agreement-resolution-and-schema-determination-for-outgoing-edi-messages.md).</span></span>  
  
## <a name="using-edi-global-properties"></a><span data-ttu-id="5854f-144">使用 EDI 全局属性</span><span class="sxs-lookup"><span data-stu-id="5854f-144">Using EDI Global Properties</span></span>  
 <span data-ttu-id="5854f-145">如果 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 不能确定传入或传出消息的协议，它将使用备用协议来处理传入交换或生成传出交换。</span><span class="sxs-lookup"><span data-stu-id="5854f-145">If [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] cannot determine the agreement for either an incoming or outgoing message, it will use the fallback agreement to process the incoming interchange or generate the outgoing interchange.</span></span> <span data-ttu-id="5854f-146">通过右键单击来设置备用协议**参与方**中的节点[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台，然后单击**X12 回退设置**（对于 X12 编码的消息） 或**EDIFACT 后备设置**（EDIFACT 编码的消息）。</span><span class="sxs-lookup"><span data-stu-id="5854f-146">The fallback agreements are set by right-clicking the **Parties** node in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console and clicking **X12 Fallback Settings** (for X12-encoded messages) or **EDIFACT Fallback Settings** (EDIFACT-encoded messages).</span></span> <span data-ttu-id="5854f-147">有关全局属性的详细信息，请参阅[配置全局或后备协议属性](../core/configuring-global-or-fallback-agreement-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="5854f-147">For more information on global properties, see [Configuring Global or Fallback Agreement Properties](../core/configuring-global-or-fallback-agreement-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5854f-148">只有 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 不能确定交换的协议时，才使用备用协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-148">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use fallback agreement only if it cannot determine the agreement for an interchange.</span></span> <span data-ttu-id="5854f-149">如果已确定协议，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 将不会使用属性（没有为贸易合作伙伴之间的协议定义）的备用协议的属性值。</span><span class="sxs-lookup"><span data-stu-id="5854f-149">If an agreement has been determined, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will not use a property value from the fallback agreement for a property that has not been defined for the agreement between two trading partners.</span></span>  
  
 <span data-ttu-id="5854f-150">如果端口设置需要进行身份验证，则不会使用备用协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-150">Fallback agreements will not be used if port settings require authentication.</span></span> <span data-ttu-id="5854f-151">如果接收端口的端口设置要求验证 (如果**身份验证失败时删除消息**或**身份验证失败时保留消息**上选择**常规**页的**接收端口属性**对话框)，协议是必需的接收端口接收的任何交换。</span><span class="sxs-lookup"><span data-stu-id="5854f-151">If the port settings for a receive port require authentication (if either **Drop messages if authentication fails** or **Keep messages if authentication fails** is selected on the **General** page of the **Receive Port Properties** dialog box), an agreement is required for any interchange received by the receive port.</span></span> <span data-ttu-id="5854f-152">在这种情况下不使用备用协议。</span><span class="sxs-lookup"><span data-stu-id="5854f-152">In this case, fallback agreements are not used.</span></span> <span data-ttu-id="5854f-153">如果未确定交换的协议，该交换将被视为验证失败，并且会被挂起。</span><span class="sxs-lookup"><span data-stu-id="5854f-153">If no agreement is determined for an interchange, the interchange will be treated as though authentication had failed, and will be suspended.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5854f-154">请参阅</span><span class="sxs-lookup"><span data-stu-id="5854f-154">See Also</span></span>  
 <span data-ttu-id="5854f-155">[协议解析、 架构发现和接收的 EDI 消息的授权](../core/agreement-resolution-schema-discovery-and-authorization-for-received-edi.md) </span><span class="sxs-lookup"><span data-stu-id="5854f-155">[Agreement Resolution, Schema Discovery, and Authorization for Received EDI Messages](../core/agreement-resolution-schema-discovery-and-authorization-for-received-edi.md) </span></span>  
 <span data-ttu-id="5854f-156">[协议解析和传出 EDI 消息的架构确定](../core/agreement-resolution-and-schema-determination-for-outgoing-edi-messages.md) </span><span class="sxs-lookup"><span data-stu-id="5854f-156">[Agreement Resolution and Schema Determination for Outgoing EDI Messages](../core/agreement-resolution-and-schema-determination-for-outgoing-edi-messages.md) </span></span>  
 <span data-ttu-id="5854f-157">[配置 EDI 属性](../core/configuring-edi-properties.md) </span><span class="sxs-lookup"><span data-stu-id="5854f-157">[Configuring EDI Properties](../core/configuring-edi-properties.md) </span></span>  
 <span data-ttu-id="5854f-158">[配置全局或后备协议属性](../core/configuring-global-or-fallback-agreement-properties.md) </span><span class="sxs-lookup"><span data-stu-id="5854f-158">[Configuring Global or Fallback Agreement Properties](../core/configuring-global-or-fallback-agreement-properties.md) </span></span>  
 [<span data-ttu-id="5854f-159">EDI 参与方的已知问题</span><span class="sxs-lookup"><span data-stu-id="5854f-159">Known Issues with EDI Parties</span></span>](../core/known-issues-with-edi-parties.md)