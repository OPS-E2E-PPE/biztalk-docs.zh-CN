---
title: 主机阻止性能计数器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- host throttling, performance counters
ms.assetid: b9090d1c-86be-40db-b814-cc116a426d95
caps.latest.revision: 22
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2b5f4d6d9683bcfa277ddfcdfe82b07ead198290
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65387537"
---
# <a name="host-throttling-performance-counters"></a>主机阻止性能计数器
本部分介绍的性能监视器计数器，用于测量影响主机阻止的系统参数。 以下性能计数器都可以访问每个主机实例下**biztalk: Message Agent**性能对象类别：  
  
|计数器|Description|  
|-------------|-----------------|  
|活动的实例计数|内存中处于活动状态的服务实例数。 对于业务流程引擎服务实例是指每个正在运行的业务流程调度实例。 对于终结点管理器中，服务实例也可能对应，到单个无状态消息，或有状态消息的集合。 **注意：** 有状态实例是维护有关与实例关联的消息的某些状态信息。 属于有状态实例的消息是以某种形式彼此相关。 例如，用于维护有关排序的信息的按序的发送端口会被视为有状态实例。 大多数消息传送方案涉及到其中的消息被处理完全相互独立的无状态实例。 每个无状态实例对应于 EPM 内的单个消息。|  
|数据库会话|正在使用的并行 MessageBox 数据库连接数。|  
|数据库会话阈值|用于并行数据库会话的当前阈值。 此值最初设置为**数据库连接**值**基于资源的阻止**选项卡中**设置仪表板**。 此值是基于过程的数据库会话使用率自动进行优化。 如果在任何时候，并行数据库会话数超过此阈值，实现主机阻止。|  
|数据库大小|此进程已发布的数据库队列中的消息数。 对于所有主机和后台处理和跟踪表中的项目数的情况下，此值度量由队列表中的项的数目。 如果进程发布到多个队列，此计数器反映所有队列的加权的平均值。 **注意：** 如果重新启动主机时，保留在内存中的统计信息都将丢失。 由于一些开销，BizTalk Server 会恢复收集统计信息，仅当有至少 100 时发布与 5%的总计将发布重新启动的主机进程内。|  
|高数据库会话|-   0:Normal<br />-   1:数据库会话数超出阈值|  
|数据库规模过大|-   0:Normal<br />-   1:数据库已增大超过阈值<br /><br /> 此计数器将设置为值 1，任何一个条件列出的则**DB 中的消息数**出现阈值。 [如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)提供有关此阻止阈值的信息。|  
|高进程内消息计数|-   0:Normal<br />-   1:进程内消息计数超出限制|  
|高消息送达速率|-   0:Normal<br />-   1:消息送达速率超出消息处理速率|  
|高消息发布速率|-   0:Normal<br />-   1:发布请求速率超出完成速率|  
|高进程内存|-   0:Normal<br />-   1:进程内存超出阈值|  
|系统内存过高|-   0:Normal<br />-   1:系统内存超出阈值|  
|高的线程数|-   0:Normal<br />-   1:线程数超出阈值|  
|进程内消息计数|传递到 XLANG 引擎或出站尚未处理的消息引擎的内存中消息数。|  
|进程内消息计数阈值|用于进程内消息数的当前阈值。|  
|消息传送延迟 （毫秒）|以毫秒为单位的当前延迟时间施加于每个消息送达批 （如果要中止消息传递时适用）。|  
|消息送达传入速率|在给定的示例间隔中传送到业务流程引擎或消息引擎每秒消息数。|  
|消息送达传出速率|每秒正在处理的业务流程引擎或消息引擎在给定的示例间隔中的消息数。|  
|消息送达阻止状态|一个标志，指示系统是否要阻止消息送达 （影响 XLANG 消息处理和出站传输）。<br /><br /> -   0:不限制<br />-   1:由于不均衡消息送达速率限制 （输入的速率超出输出速率）<br />-   3:由于高进程内消息数而阻止<br />-   4:由于进程内存压力而阻止<br />-   5:由于系统内存压力而阻止<br />-   9:由于高的线程数而阻止<br />-   10:由于传递的用户替代而阻止|  
|消息传递限制状态持续时间|由于系统进入此状态的秒数。 如果主机处于阻止状态，多长时间它已阻止;如果它未进行限制，应用阻止之后的时间长度。|  
|消息送达阻止用户重写|此计数器反映了引擎监视和解释，如下所示的用户重写：<br /><br /> -   0:不重写<br />-   1:始终阻止消息送达<br />-   2:不阻止消息送达<br /><br /> 此替代是可在中配置**基于速率的阻止**选项卡**设置仪表板**。|  
|消息发布延迟 （毫秒）|对每个 （如果被阻止消息发布和批处理不免除限制适用） 的消息发布批规定的以毫秒为单位当前延迟时间。|  
|消息发布传入速率|每秒发送到在给定的示例间隔中发布的数据库的消息数。|  
|消息发布传出速率|在给定的示例间隔中实际发布数据库中每秒消息数。|  
|消息发布阻止状态|一个标志，指示系统是否要阻止消息发布 （影响 XLANG 消息处理和入站的传输）。<br /><br /> -   0:不限制<br />-   2:由于不均衡消息发布速率限制 （输入的速率超出输出速率）<br />-   4:由于进程内存压力而阻止<br />-   5:由于系统内存压力而阻止<br />-   6:由于数据库增长而阻止<br />-   8:由于会话数过高而阻止<br />-   9:由于高的线程数而阻止<br />-   11:由于发布的用户替代而阻止|  
|消息发布阻止状态持续时间|由于系统进入此状态的秒数。 如果主机处于阻止状态，多长时间它已阻止;如果它未进行限制，应用阻止之后的时间长度。|  
|消息发布阻止用户重写|此计数器反映了引擎监视和解释，如下所示的用户重写：<br /><br /> -   0:不重写<br />-   1:始终阻止消息发布<br />-   2:不阻止消息发布<br /><br /> 此替代是可在中配置**基于速率的阻止**选项卡**设置仪表板**。|  
|物理内存使用率 (MB)|以 mb 为单位在计算机上的所有进程使用的物理内存量。|  
|进程内存使用率 (MB)|以 mb 为单位的进程内存占用。 这是最多个进程的工作集大小和页面文件的进程分配的总空间。|  
|进程内存使用情况阈值 (MB)|用于以 mb 为单位的进程内存占用量的当前阈值。 此值最初设置为**进程虚拟**中的值**设置仪表板**。 如果指定一个百分比值，它是根据计算的可用内存来提交|  
|服务类别 ID|此性能计数器实例对应的 GUID 的服务类的开头部分的十进制值。 一个进程可以承载多个服务类和消息代理性能计数器则显示最频繁使用的服务类别的数据。|  
|线程计数|在进程内正在使用的线程数。|  
|线程计数阈值|用于进程中的线程数的当前阈值。 此值最初设置为**线程**值**基于资源的阻止**选项卡中**设置仪表板**。 此值是自动优化，具体取决于当前进程的线程要求。 如果进程中的线程数的时间超过此阈值，任何时候，实现主机阻止。|  
|已提交的总批|服务类别提交的数据库批数。|  
|传递的消息总数|传递到业务流程引擎或终结点管理器 (EPM) 的出站消息数。|  
|已发布的消息总数|已发布的消息数。|  
  
> [!NOTE]
>  **Biztalk: Message Agent**性能计数器提供用于分析主机的阻止行为的显式目的并且因此将不会捕获数据除非指定的主机主动处理文档。 此行为通过设计，可防止占用系统线程使用性能监视器时阻止活动未按预期发生。  
  
## <a name="to-access-performance-counters"></a>若要访问性能计数器  
 使用以下步骤访问性能计数器。  
  
#### <a name="if-you-are-using-windows-2008"></a>如果您使用的 Windows 2008  
  
1.  单击**启动**，依次指向**管理工具**，然后单击**性能监视器**。  
  
2.  在中**性能监视器**对话框框中，展开**监视工具**，选择**性能监视器**，然后单击**添加**。  
  
3.  在中**添加计数器**对话框中，从**可用的计数器**列表中，展开**biztalk: Message Agent**性能计数器对象，然后选择要进行的计数器监视。  
  
4.  在中**选定对象的实例**列表中，选择要监视的所选的计数器，然后单击的特定实例**添加**。  若要选择的所有可用的计数器实例，请选择\<**所有实例**\>。  
  
5.  添加计数器之后, 单击**确定**。  
  
     所选的性能计数器随即显示在**性能监视器**屏幕。  
  
## <a name="see-also"></a>请参阅  
 [限制设计建议](../core/throttling-design-recommendations.md)   
 [BizTalk Server 如何实现主机阻止](../core/how-biztalk-server-implements-host-throttling.md)   
 [使用设置仪表板进行 BizTalk Server 性能调整](../core/using-settings-dashboard-for-biztalk-server-performance-tuning.md)