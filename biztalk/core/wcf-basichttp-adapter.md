---
title: WCF BasicHttp 适配器 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- WCF-BasicHttp adapters
ms.assetid: 51bc56be-3c78-4bf9-87b6-8fb1435d8cde
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 27d0e731fd63ce01e9cc1c2604eb8f83141e024e
ms.sourcegitcommit: 8418b1a8f38b7f56979cd6e203f0b591e2f40fe1
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/28/2018
ms.locfileid: "25976091"
---
# <a name="wcf-basichttp-adapter"></a>WCF-BasicHttp 适配器
[!INCLUDE[btsCoName](../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用 WCF BasicHttp 适配器接收和发送通过 WCF 服务请求[BasicHttpBinding 类](https://msdn.microsoft.com/library/system.servicemodel.basichttpbinding.aspx)。 WCF BasicHttp 适配器使您能够发布业务流程和作为 WCF 服务的架构，并使用与外部 WCF 服务 **BasicHttpBinding**。  
  
借助 WCF-BasicHttp 适配器，您可以通过以文本编码的 HTTP 或 HTTPS 传输，采用符合 WS-I 基本配置文件 1.1 且基于 ASMX 的早期 Web 服务和客户端实现跨计算机通信。 但是，您将无法利用 WS-* 协议支持的功能。  
  
 下表总结了 WCF BasicHttp 适配器的特征︰
  
|Description|特征|  
|-----------------|--------------------|  
|互操作性水平|基本配置文件|  
|消息编码|文本或 MTOM|  
|边界|跨计算机|  
|传输协议|HTTP 或 HTTPS|  
|安全模式|无、消息、传输、TransportWithMessageCredential 和 TransportCredentialOnly|  
|客户端身份验证机制|传输安全性和消息安全性|  
|是否支持 WS-ReliableMessaging|否|  
|是否支持 WS-AtomicTransaction|否|  
|支持单向消息传送|是|  
|支持双向消息传送|是|  
|接收适配器的主机类型|隔离|  
|发送适配器的主机类型|进程内|  
  
 WCF BasicHttp 适配器包含两个适配器-接收适配器和一个发送适配器。 

本主题演示如何创建接收位置和发送端口使用 BizTalk 管理。 你还可以[创建接收位置和以编程方式发送端口](../core/create-the-receive-location-and-send-port-programmatically.md)。

## <a name="before-you-begin"></a>开始之前

- 从开始[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]，此发送适配器可以用于服务总线使用访问控制服务 (ACS) 或共享访问签名 (SAS) 到 athenticate。 我们建议使用服务总线进行身份验证时使用共享访问签名 (SAS)。 

    当你创建了服务总线命名空间时，不自动创建 Access Control (ACS) 命名空间。 如果使用 ACS 进行身份验证，你可能需要创建一个新的 ACS 命名空间。 请参阅[SB 消息适配器](../core/sb-messaging-adapter.md)更多详细信息，包括检索 ACS 密钥值的步骤。

- WCF BasicHttp 适配器优于 SOAP 适配器在以下方案︰  
  
    -   WCF 适配器文档每秒速率是通常优于 SOAP 适配器。    
    -   SOAP 适配器已序列化和反序列化.NET 类型与原始 XML 数据; 之间的消息的缺点这在某些情况下会导致不需要的数据修改。 WCF 适配器采用保留数据流的方法。    
    -   WCF 适配器所发布的架构与在 BizTalk 运行时所使用的架构实质上相同。 与此相反，SOAP 适配器所返回的元数据是通过对生成的用于表示架构的 .NET 类进行反射而生成的。 因为 .NET 不保留 XSD 架构的所有细微差别，所以公开的 WSDL 可能不会精确反映 BizTalk 运行时使用的架构。    
    -   如果需要它是更轻松地将从 WCF BasicHttp 迁移到 WCF WSHttp。  
-  您可使用 WCF-BasicHttp 接收适配器通过 HTTP 或 HTTPS 协议接收 WCF 服务请求。  您可使用 WCF-BasicHttp 发送适配器及 HTTP 或 HTTPS 协议通过无类型约定调用 WCF 服务。  

## <a name="create-the-receive-location"></a>创建接收位置

此接收位置可以配置为单向或请求-响应 （双向）。  

> [!NOTE]
>  之前完成以下步骤，你必须已添加接收端口。 请参阅 [如何创建接收端口](../core/how-to-create-a-receive-port.md)。  
> 
> 你还可以[以编程方式创建接收位置](../core/create-the-receive-location-and-send-port-programmatically.md)。 
  
1.  在 BizTalk 管理控制台中，展开 **BizTalk Server 管理**, ，展开 **BizTalk 组**, ，展开 **应用程序**, ，然后展开要创建中的接收位置的应用程序。  
  
2.  在 BizTalk 管理控制台的左窗格中，单击“接收端口”  节点。 随后，在右窗格中右键单击与现有接收位置关联的接收端口或要与新接收位置关联的接收端口，然后单击“属性” 。  
  
3.  在“接收端口属性”  对话框的左窗格中，选择“接收位置” ，然后在右窗格中双击现有的接收位置或单击“新建”  以创建新的接收位置。  
  
4.  在 **接收位置属性** 对话框中，在 **传输** 旁边部分 **类型**, ，选择 **WCF BasicHttp** 从下拉列表，然后单击 **配置**。  
  
5.  在 **WCF BasicHttp 传输属性**, 上 **常规** 选项卡上，配置终结点地址和 WCF BasicHttp 的服务标识接收位置︰  

    > [!NOTE]
    >  如果你使用 **传输** 或 **TransportWithMessageCredential** 为 **安全模式**, ，必须设置了安全套接字层 (SSL) 在 Microsoft Internet 信息服务 (IIS)。  
    
    |使用此选项|動作|  
    |--------------|----------------|  
    |**地址 (URI)**|必需的。 指定此接收位置的 URI。 指定虚拟目录以及 BizTalk WCF 服务发布向导生成的.svc 文件名称-例如，/path/service.svc。<br /><br /> 默认值: /<br /><br /> 最小长度︰ 1<br /><br /> 最大长度︰ 255|  
    |**终结点标识**|可选。 指定的标识服务的此接收位置提供通过单击 **编辑** 按钮。 可以为指定的值 **终结点标识** 属性而异的安全配置。 通过这些设置，客户端可对此接收位置进行验证。 在客户端与服务进行握手的过程中，Windows Communication Foundation (WCF) 基础结构将确保预期服务的标识与此元素的值保持一致。<br /><br /> 默认值为空字符串。<br /><br /> 最小长度：0<br /><br /> 最大长度：32767|  
  
6.  在 **WCF BasicHttp 传输属性** 对话框中，在 **绑定** 选项卡上，配置的超时和编码属性︰
    
    |使用此选项|動作|  
    |--------------|----------------|  
    |**打开超时 (hh:mmss)**|指定時間值，表示可供完成通道開啟作業的時間間隔。 這個值應大於或等於 **System.TimeSpan.Zero**。<br /><br /> 預設值：00:01:00<br /><br /> 最大值：23:59:59|  
    |**发送超时时 (hh:mmss)**|指定時間值，表示可供完成傳送作業的時間間隔。 這個值應大於或等於 **System.TimeSpan.Zero**。 如果您使用要求-回應接收埠，這個值會指定完成整個互動的時間長度，即使服務傳回很大的訊息也是如此。<br /><br /> 預設值：00:01:00<br /><br /> 最大值：23:59:59|  
    |**关闭超时 (hh:mmss)**|指定時間值，表示可供完成通道關閉作業的時間間隔。 這個值應大於或等於 **System.TimeSpan.Zero**。<br /><br /> 預設值：00:01:00<br /><br /> 最大值：23:59:59|  
    |**收到的最大消息大小 （字节）**|以位元組為單位，指定可在網路上接收的訊息大小上限 (含標頭)。 訊息的大小受限於配置給每個訊息的記憶體數量。 你可以使用此属性来降低受拒绝服务 (DoS) 攻击的可能性。<br /><br /> WCF BasicHttp 适配器利用 [BasicHttpBinding](http://go.microsoft.com/fwlink/?LinkId=81086) 在缓冲的传输模式中与终结点进行通信的类。 对于缓冲的传输模式中， [BasicHttpBinding.MaxBufferSize](http://go.microsoft.com/fwlink/?LinkId=80659) 属性也始终等于此属性的值。<br /><br /> 預設值：65536<br /><br /> 最大值：2147483647|  
    |**消息编码**|指定用來為 SOAP 訊息編碼的編碼器。 有效值包括下列各項：<br /><br /> -   **文本**： 使用文本消息编码器。<br />-   **Mtom**︰ 使用消息传输组织机制 1.0 (MTOM) 编码器。<br /><br /> 默认值是 **文本**。|  
    |**文本编码**|指定的字符集编码要用于在绑定上发出消息时 **消息编码** 属性设置为 **文本**。 有效值包括下列各項：<br /><br /> -   **utf 16BE (unicodeFFFE)**: Unicode BigEndian 编码。<br />-   **utf-16**: 16 位编码。<br />-   **utf-8**: 8 位编码<br /><br /> 默认值是 **utf-8**。|  
    |**最大并发调用**|指定對單一服務執行個體的並行呼叫數目。 超出上限的呼叫將排入佇列。 将该值设置为 0 等效于将它设置为 **Int32.MaxValue**。<br /><br /> 默认值为 200。|  
  
7.  在 **WCF BasicHttp 传输属性** 对话框中，在 **安全** 选项卡上，定义的安全功能︰
  
    |使用此选项|動作|  
    |--------------|----------------|  
    |**安全模式**|指定使用的安全性類型。 有效值包括下列各項：<br /><br /> -   **无**： 在传输过程不保护消息。<br />-   **传输**︰ 使用 HTTPS 传输提供安全性。 使用 HTTPS 來維護 SOAP 訊息的安全。 若要使用這個模式，您必須在 Microsoft Internet Information Services (IIS) 中設定「安全通訊端層」(SSL)。<br />-   **消息**︰ 使用 HTTP 传输的 SOAP 消息安全提供安全性。 根據預設，SOAP **Body** 會進行加密及簽署。 仅有的有效 **消息客户端凭据类型** 对于 WCF Basic 适配器是 **证书**。 這種模式需要使用 HTTP 傳輸。 使用此安全模式时，此服务证书接收位置需要通过提供 **服务证书的指纹** 属性。<br />-   **TransportWithMessageCredential**︰ 由 HTTPS 传输提供完整性、 保密性和服务身份验证。 若要使用此模式，你必须在 Microsoft Internet 信息服务 (IIS) 中设置安全套接字层 (SSL)。<br />-   **TransportCredentialOnly**︰ 此模式下不提供消息完整性和保密性。 但提供基于 HTTP 的客户端验证。 此模式应慎重使用。 此模式适用于传输安全性通过其他途径（如 IPSec）提供且 WCF 基础结构只提供客户端验证的环境。 如果你选择 **证书** 为 **传输客户端凭据类型** 此安全模式中的属性，此服务证书接收位置需要通过提供 **服务证书的指纹** 属性。<br /><br /> 默认值是 **无**。|  
    |**传输客户端凭据类型**|指定执行客户端验证时要使用的凭据类型。 有效值包括：<br /><br /> -   **无**： 无身份验证发生在传输级别。<br />-   **基本**︰ 基本身份验证。 在基本身份验证中，用户名和密码将以明文形式通过网络发送。 你必须创建与凭据对应的域或本地用户帐户。<br />-   **摘要式**︰ 摘要式身份验证。 此身份验证方法与基本身份验证方法相似，不同之处在于密码以哈希值的形式通过网络发送，以增强安全性。 摘要身份验证只可在域控制器运行 Windows Server 操作系统验证的域中使用。 你必须创建与客户端凭据对应的域或本地用户帐户。<br />-   **Ntlm**: NTLM 身份验证。 客户端可只发送凭据而不向此接收位置发送密码。 你必须创建与客户端凭据对应的域或本地用户帐户。<br />-   **Windows**: Windows 集成身份验证。 Windows Communication Foundation 可与 Kerberos 或 NTLM 协商，如果存在域，则首选使用 Kerberos。 如果要使用 Kerberos，则非常重要的一点是让客户端使用服务主体名称 (SPN) 标识该服务。 你必须创建与客户端凭据对应的域或本地用户帐户。<br />-   **证书**︰ 使用客户端证书的客户端身份验证。 必须将用于客户端 X.509 证书的 CA 证书链安装到此计算机的“受信任根证书颁发机构”证书存储中，以便可以针对此接收位置验证客户端。 **注意︰**   **传输客户端凭据类型** 属性必须与匹配的身份验证方案的 IIS 虚拟目录承载该接收位置。 例如，如果该属性设置为“Windows” ，则你还需为此接收位置所在的虚拟目录启用“集成 Windows 验证”  。 相似地，如果将该属性设置为“无” ，则你必须允许匿名访问此接收位置所在的虚拟目录。 <br /><br /> 默认值是 **无**。|  
    |**消息客户端凭据类型**|指定使用基于消息的安全性对客户端执行验证时所用的凭据类型。 有效值包括：<br /><br /> -   **用户名**︰ 允许此接收位置需要客户端进行身份验证使用 **用户名** 凭据。 你必须创建的域或本地用户帐户对应的客户端凭据。<br />-   **证书**︰ 客户端进行身份验证到此接收位置使用客户端证书。 用戶端 X.509 憑證的 CA 憑證鏈結必須安裝在這部電腦的「信任的根憑證授權單位」憑證存放區中，才可以向這個接收位置驗證用戶端。<br /><br /> 默认值是 **用户名**。|  
    |**算法套件**|指定訊息加密和 Key Wrap 演算法。 這些演算法會對應到安全性原則語言 (WS-SecurityPolicy) 規格中所指定的演算法。 可能的值為：<br /><br /> -   **Basic128**： 使用 Aes128 加密，对消息摘要的 Sha1，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic128Rsa15**︰ 对消息加密使用 Aes128，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **Basic128Sha256**︰ 对消息加密使用 Aes256，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic128Sha256Rsa15**︰ 对消息加密使用 Aes128，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br />-   **Basic192**︰ 使用 Aes192 加密，对消息摘要的 Sha1，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic192Rsa15**︰ 对消息加密使用 Aes192，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **Basic192Sha256**︰ 对消息加密使用 Aes192，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic192Sha256Rsa15**︰ 对消息加密使用 Aes192，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br />-   **Basic256**︰ 使用 Aes256 加密，对消息摘要的 Sha1，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic256Rsa15**︰ 对消息加密使用 Aes256，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **Basic256Sha256**︰ 对消息加密使用 Aes256，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic256Sha256Rsa15**︰ 对消息加密使用 Aes256，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br />-   **TripleDes**︰ 使用 TripleDes 加密，对消息摘要，Rsa oaep-mgf1p 对密钥包装 Sha1。<br />-   **TripleDesRsa15**︰ 使用 TripleDes 加密，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **TripleDesSha256**︰ 对消息加密使用 TripleDes，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **TripleDesSha256Rsa15**︰ 对消息加密使用 TripleDes，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br /><br /> 預設值為 **[Basic256]**。|  
    |**服务证书的指纹**|針對此接收位置指定用戶端用來驗證服務之 X.509 憑證的憑證指紋。 使用“浏览”  按钮，导航到“当前用户”  位置中“我的”  存储，然后即可选择指纹。 **注意︰**  必须安装到的服务证书 **当前用户** 承载此接收位置接收处理程序的用户帐户的位置。 <br /><br /> 最小長度：00<br /><br /> 最大長度：40<br /><br /> 默认值为空字符串。|  
    |**使用单一登录**|使用单一登录检索客户端凭据以发放 SSO 票证。 此选项可仅用于列出在以下部分中，"Enterprise 上单一登录可支持性 WCF BasicHttp 接收适配器。"的安全配置<br /><br /> 默认值为清除此复选框。|  
  
    **企业单一登录可支持性的 WCF BasicHttp 接收适配器**  
    此适配器可以从仅在以下表所示的安全配置的 SSO 服务器发出的 SSO 票证︰
    
    |**安全模式**|**传输客户端凭据类型**|**消息客户端凭据类型**|  
    |-----------------------|------------------------------------------|----------------------------------------|  
    |**传输**|**基本**|N/A|  
    |**传输**|**摘要**|N/A|  
    |**传输**|**Ntlm**|N/A|  
    |**传输**|**Windows**|N/A|  
    |**传输**|**证书**|N/A|  
    |**消息**|N/A|**用户名**|  
    |**TransportWithMessageCredential**|N/A|**用户名**|  
    |**TransportCredentialOnly**|**基本**|N/A|  
    |**TransportCredentialOnly**|**摘要**|N/A|  
    |**TransportCredentialOnly**|**Ntlm**|N/A|  
    |**TransportCredentialOnly**|**Windows**|N/A|  
    |**TransportCredentialOnly**|**证书**|N/A|  
  
8.  在 **WCF BasicHttp 传输属性** 对话框中，在 **消息** 选项卡上，指定 SOAP 数据选择 **正文** 元素︰  
  
    |使用此选项|動作|  
    |--------------|----------------|  
    |**信封--完整\<soap 信封：\>**|從內送訊息的整個 SOAP **信封** 建立 BizTalk 訊息內文部分。<br /><br /> 預設值為清除核取方塊。|  
    |**正文--内容\<soap： 正文\>元素**|使用內送訊息的 SOAP **Body** 元素內容來建立 BizTalk 訊息內文部分。 如果 **Body** 元素有一個以上的子元素，則只有第一個元素會成為 BizTalk 訊息內文部分。<br /><br /> 這是預設值。|  
    |**路径--由正文路径定位的内容**|使用 **[內文路徑運算式]** 文字方塊中的內文路徑運算式，建立 BizTalk 訊息內文部分。 內文路徑運算式會依照內送訊息 SOAP **Body** 元素的直系子元素來進行評估。<br /><br /> 預設值為清除核取方塊。|  
    |**正文路径表达式**|輸入內文路徑運算式，以識別用來建立 BizTalk 訊息內文部分的內送訊息特定部分。 這個內文路徑運算式會依照內送訊息 SOAP **Body** 元素的直系子項目來進行評估。 如果此內文路徑運算式傳回一個以上的節點，則只會為 BizTalk 訊息內文部分選擇第一個節點。 如果選取了 **[路徑 -- 內容由內文路徑定位]** 選項，就需要此屬性。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大長度：32767<br /><br /> 預設為空字串。|  
    |**节点编码**|指定的编码，WCF BasicHttp 接收适配器使用要解码识别由正文路径表达式中的节点类型 **正文路径表达式** 文本框。<br /><br /> 如果选择了“路径 -- 按正文路径定位内容”  选项，则此属性是必需的。 有效值包括下列各項：<br /><br /> -   **Base64**: Base64 编码。<br />-   **十六进制**︰ 十六进制编码。<br />-   **字符串**︰ 文本编码的 utf-8<br />-   **XML**: WCF 适配器使用由正文路径表达式中所选节点的外部 XML 创建 BizTalk 消息正文 **正文路径表达式** 文本框。<br /><br /> 預設值是 **[XML]**。|  
    |**正文--BizTalk 响应消息正文**|使用 BizTalk 訊息內文部分建立外寄回應訊息的 SOAP **內文** 元素內容。 此屬性只適用於要求-回應接收位置。<br /><br /> 這是預設值。|  
    |**指定模板的模板--内容**|使用 [XML]  文字方塊中提供的範本來建立外寄訊息的 SOAP **內文** 元素內容。 此屬性只適用於要求-回應接收位置。<br /><br /> 預設值為清除核取方塊。|  
    |**XML**|針對外寄訊息的 SOAP **內文** 元素內容，輸入 XML 格式的範本。 如果選取了 **[範本 -- BizTalk 回應訊息本文]** 選項，就需要此屬性。 此屬性只適用於要求-回應接收位置。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大長度：32767<br /><br /> 默认值是 **\<bts 消息正文 xmlns ="http://www.microsoft.com/schemas/bts2007"编码 ="xml"\>**。|  
    |**挂起失败的请求消息**|指定是否擱置因接收管線失敗或路由失敗而造成輸入處理失敗的要求訊息。<br /><br /> 預設值為清除核取方塊。|  
    |**错误中包括异常详细信息**|指定是否要將在錯誤發生時傳回 SOAP 錯誤以方便偵錯。<br /><br /> 默认值为清除此复选框。|   
 
 
## <a name="create-the-send-port"></a>创建发送端口

> [!NOTE] 
> 你还可以[以编程方式创建发送端口](../core/create-the-receive-location-and-send-port-programmatically.md)。

1.  在 BizTalk 管理控制台中，创建一个新的发送端口或双击某个现有发送端口以对其进行修改。 有关详细信息，请参阅[如何创建发送端口](../core/how-to-create-a-send-port2.md)。 配置所有发送端口选项并指定 **WCF BasicHttp** 为 **类型** 选项 **传输** 部分 **常规** 选项卡。  
  
2.  上 **常规** 选项卡上，在 **传输** 部分中，单击 **配置** 按钮旁边 **类型**。  
  
3.  在 **WCF BasicHttp 传输属性** 对话框中，在 **常规** 选项卡上配置的终结点地址，服务标识，与 **SOAPAction** WCF BasicHttp 发送端口的 HTTP 标头︰  

    > [!NOTE]
    >  如果指定 **https** 方案为 **地址 (URI)** 属性，你必须配置 **安全模式** 属性 **传输** 或 **TransportWithMessageCredential**。 你可以使用 **安全** 选项卡来配置 **安全模式** 属性。  
      
    |使用此选项|動作|  
    |--------------|----------------|  
    |**地址 (URI)**|必需的。 指定此发送端口的完全限定 URI。 使用 **https** 或 **http** 根据安全配置的方案。<br /><br /> 最大长度︰ 255<br /><br /> 默认值：30http://localhost/|  
    |**终结点标识**|可选。 指定此发送端口预期的服务标识。 这些设置支持此发送端口对服务进行验证。 在客户端与服务进行握手的过程中，Windows Communication Foundation (WCF) 基础结构将确保预期服务的标识与此元素的值保持一致。 可以为指定的值 **标识** 属性而异的安全配置。<br /><br /> 默认值为清除此复选框。| 
    |**動作**|指定 **SOAPAction** 传出消息的 HTTP 标头字段。 此外可以通过消息上下文属性设置此属性 **WCF。操作** 在管道或业务流程。 你可以通过两种方式指定此值︰ 单个操作格式和操作映射格式。 如果将此属性设置中的单个操作格式-例如， http://contoso.com/Svc/Op1- **SOAPAction**标头为传出消息始终设置为此属性中指定的值。<br /><br /> 如果在操作映射格式，传出中设置此属性 **SOAPAction** 标头由 **BTS。操作** 上下文属性。 例如，如果此属性设置为以下 XML 格式和**BTS。操作**属性设置为 Op1，WCF 发送适配器使用http://contoso.com/Svc/Op1为传出**SOAPAction**标头。<br /><br /> \<BtsActionMapping\><br /><br /> \<Operation Name="Op1" Action="http://contoso.com/Svc/Op1" \><br /><br /> \<Operation Name="Op2" Action="http://contoso.com/Svc/Op2" \><br /><br /> \</BtsActionMapping\><br /><br /> 如果传出消息来自于业务流程端口，动态设置业务流程实例 **BTS。操作** 与操作名称的端口的属性。 如果使用基于内容的路由路由传出消息，则可以设置 **BTS。操作** 管道组件中的属性。<br /><br /> 最小长度：0<br /><br /> 最大長度：32767<br /><br /> 默认值为空字符串。|
 
4.  在 **WCF BasicHttp 传输属性**, 上 **绑定** 选项卡上，配置的超时和编码属性︰ 

    |使用此选项|動作|  
    |--------------|----------------|  
    |**打开超时 (hh:mmss)**|指定時間值，表示可供完成通道開啟作業的時間間隔。 這個值應大於或等於 **System.TimeSpan.Zero**。<br /><br /> 預設值：00:01:00<br /><br /> 最大值：23:59:59|  
    |**发送超时时 (hh:mmss)**|指定時間值，表示可供完成傳送作業的時間間隔。 這個值應大於或等於 **System.TimeSpan.Zero**。 如果您使用請求-回應傳送埠，這個值會指定完成整個互動的時間長度，即使服務傳回很大的訊息也是如此。<br /><br /> 預設值：00:01:00<br /><br /> 最大值：23:59:59|  
    |**关闭超时 (hh:mmss)**|指定時間值，表示可供完成通道關閉作業的時間間隔。 此值应大于或等于 **System.TimeSpan.Zero**。<br /><br /> 預設值：00:01:00<br /><br /> 最大值：23:59:59|  
    |**收到的最大消息大小 （字节）**|以位元組為單位，指定可在網路上接收的訊息大小上限 (含標頭)。 訊息的大小受限於配置給每個訊息的記憶體數量。 你可以使用此属性来降低受拒绝服务 (DoS) 攻击的可能性。<br /><br /> WCF BasicHttp 适配器利用 [BasicHttpBinding](http://go.microsoft.com/fwlink/?LinkId=81086) 在缓冲的传输模式中与终结点进行通信的类。 对于缓冲的传输模式中， [BasicHttpBinding.MaxBufferSize](http://go.microsoft.com/fwlink/?LinkId=80659) 属性也始终等于此属性的值。<br /><br /> 預設值：65536<br /><br /> 最大值：2147483647|  
    |**消息编码**|指定用來為 SOAP 訊息編碼的編碼器。 有效值包括下列各項：<br /><br /> -   **文本**： 使用文本消息编码器。<br />-   **Mtom**︰ 使用消息传输组织机制 1.0 (MTOM) 编码器。<br /><br /> 默认值︰ **文本**|  
    |**文本编码**|指定的字符集编码要用于在绑定上发出消息时 **消息编码** 属性设置为 **文本**。 有效值包括下列各項：<br /><br /> -   **utf 16BE (unicodeFFFE)**: Unicode BigEndian 编码。<br />-   **utf-16**: 16 位编码。<br />-   **utf-8**: 8 位编码<br /><br /> 默认值︰ **utf-8**|  
  
5.  在 **WCF BasicHttp 传输属性** 对话框中，在 **安全** 选项卡上，定义 WCF BasicHttp 发送端口的安全功能︰
 
    |使用此选项|動作|  
    |--------------|----------------|  
    |**安全模式**|指定使用的安全性類型。 有效值包括下列各項：<br /><br /> -   **无**： 在传输过程不保护消息。<br />-   **传输**︰ 使用 HTTPS 传输提供安全性。 使用 HTTPS 來維護 SOAP 訊息的安全。 此服務之 X.509 憑證的 CA 憑證鏈結必須安裝在這部電腦的「信任的根憑證授權單位」憑證存放區中，才可以使用此服務的憑證向傳送埠驗證此服務。<br />-   **消息**︰ 使用 SOAP 消息安全提供安全性。 默认情况下，SOAP **正文** 元素进行加密和签名。 仅有的有效 **消息客户端凭据类型** 对于 WCF BasicHttp 发送适配器是 **证书**。 此模式需要 HTTP 传输。<br />-   **TransportWithMessageCredential**︰ 由 HTTPS 传输提供完整性、 保密性和服务身份验证。 此服務之 X.509 憑證的 CA 憑證鏈結必須安裝在這部電腦的「信任的根憑證授權單位」憑證存放區中，才可以使用此服務的憑證向傳送埠驗證此服務。 发送端口验证由 SOAP 消息安全性提供。<br />-   **TransportCredentialOnly**︰ 此模式下不提供消息完整性和保密性。 但提供基于 HTTP 的客户端验证。 此模式应慎重使用。 此模式适用于传输安全性通过其他途径（如 IPSec）提供且 WCF 基础结构只提供客户端验证的环境。<br /><br /> 默认值是 **无**。|  
    |**传输客户端凭据类型**|指定执行发送端口验证时使用的凭据类型。 有效值包括：<br /><br /> -   **无**： 无身份验证发生在传输级别。<br />-   **基本**︰ 基本身份验证。 在基本身份验证中，用户名和密码将以明文形式通过网络发送。 此选项需要配置 **客户端凭据** 属性。<br />-   **摘要式**︰ 摘要式身份验证。 此身份验证方法与基本身份验证方法相似，不同之处在于密码以哈希值的形式通过网络发送，以增强安全性。 摘要身份验证只可在域控制器运行 Windows Server 操作系统验证的域中使用。 此选项需要配置 **客户端凭据** 属性。<br />-   **Ntlm**: NTLM 身份验证。 服务使用运行此发送端口的用户帐户来验证此发送端口。<br />-   **Windows**: Windows 集成身份验证。 服务使用运行此发送端口的用户帐户来验证此发送端口。<br />-   **证书**︰ 使用通过指定的客户端证书的客户端身份验证 **客户端证书的指纹** 属性。 使用此凭据类型时，需要通过提供服务证书 **服务证书的指纹** 属性。<br /><br /> 默认值是 **无**。|  
    |**消息客户端凭据类型**|指定使用基于消息的安全性对客户端执行验证时所用的凭据类型。 有效值包括：<br /><br /> -   **用户名**： 此发送端口到具有的服务进行身份验证**用户名**凭据。 对于 WCF-BasicHttp 发送适配器，不支持此功能。<br />-   **证书**︰ 此发送端口使用通过指定的客户端证书对服务进行身份验证 **客户端证书的指纹** 属性。 此外，当使用此凭据类型，则需要通过提供服务证书 **服务证书的指纹** 属性。<br /><br /> 默认值是 **用户名**。|  
    |**算法套件**|指定訊息加密和 Key Wrap 演算法。 這些演算法會對應到安全性原則語言 (WS-SecurityPolicy) 規格中所指定的演算法。 可能的值為：<br /><br /> -   **Basic128**： 使用 Aes128 加密，对消息摘要的 Sha1，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic128Rsa15**︰ 对消息加密使用 Aes128，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **Basic128Sha256**︰ 对消息加密使用 Aes256，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic128Sha256Rsa15**︰ 对消息加密使用 Aes128，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br />-   **Basic192**︰ 使用 Aes192 加密，对消息摘要的 Sha1，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic192Rsa15**︰ 对消息加密使用 Aes192，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **Basic192Sha256**︰ 对消息加密使用 Aes192，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic192Sha256Rsa15**︰ 对消息加密使用 Aes192，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br />-   **Basic256**︰ 使用 Aes256 加密，对消息摘要的 Sha1，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic256Rsa15**︰ 对消息加密使用 Aes256，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **Basic256Sha256**︰ 对消息加密使用 Aes256，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **Basic256Sha256Rsa15**︰ 对消息加密使用 Aes256，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br />-   **TripleDes**︰ 使用 TripleDes 加密，对消息摘要，Rsa oaep-mgf1p 对密钥包装 Sha1。<br />-   **TripleDesRsa15**︰ 使用 TripleDes 加密，对消息摘要的 Sha1，对密钥包装使用 Rsa15。<br />-   **TripleDesSha256**︰ 对消息加密使用 TripleDes，对消息摘要的 Sha256，对密钥包装的 Rsa-oaep-mgf1p。<br />-   **TripleDesSha256Rsa15**︰ 对消息加密使用 TripleDes，对消息摘要的 Sha256，对密钥包装使用 Rsa15。<br /><br /> 預設值為 **[Basic256]**。|  
    |**客户端证书的指纹**|指定用于向服务验证此发送端口的 X.509 证书的指纹。 你可以通过导航到选择指纹 **我** 将存储在 **当前用户** 位置与 **浏览** 按钮。 **注意︰**  必须安装到客户端证书 **当前用户** 承载该发送处理程序的用户帐户的位置发送端口。 <br /><br /> 最小长度：0<br /><br /> 最大長度：40<br /><br /> 預設為空字串。|  
    |**服务证书的指纹**|指定用于验证服务（此发送端口要将消息发送到的服务）的 X.509 证书的指纹。 你可以选择导航到的指纹 **其他人** 将存储在 **本地计算机** 位置与 **浏览** 按钮。<br /><br /> 最小長度：00<br /><br /> 最大長度：40<br /><br /> 預設為空字串。|  
    |**用户名凭据**|指定用來傳送訊息的認證。 你可以通过单击指定属性 **编辑** 按钮。 此选项仅对下面的“WCF-BasicHttp 发送适配器的企业单一登录可支持性”部分中列出的安全配置有效。<br /><br /> 默认值是 **不使用单一登录**。|  
    |**服务总线连接信息** | 新开头[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]。<br/><br/>选择使用共享访问签名 (SAS) 或 Service Bus 命名空间的访问控制服务 (ACS)。 <br/><br/>选择一个选项，然后选择 **编辑** 输入的密钥信息︰<br/><br/> - **共享访问签名**： 输入访问密钥名称和访问密钥。 这两个值中列出 [Azure 门户](https://portal.azure.com)。<br/> - **访问控制服务**： 输入 STS URI (`https://<yourNamespace>-sb.accesscontrol.windows.net/`)，颁发者名称和颁发者密钥。 使用 Windows PowerShell 检索这些值中所述[SB 消息适配器](../core/sb-messaging-adapter.md)。 |
  
    **企业单一登录可支持性 WCF BasicHttp 发送适配器**  
    WCF-BasicHttp 发送适配器仅在下表所示的安全配置下，才可从 SSO 服务器兑换 SSO 票证以获取用户凭据。  
  
    |**安全模式**|**传输客户端凭据类型**|**消息客户端凭据类型**|  
    |-----------------------|------------------------------------------|----------------------------------------|  
    |**传输**|**基本**|N/A|  
    |**传输**|**摘要**|N/A|  
    |**TransportCredentialOnly**|**基本**|N/A|  
    |**TransportCredentialOnly**|**摘要**|N/A|  
    |**消息**|N/A|**用户名**|  
    |**TransportWithMessageCredential**|N/A|**用户名**|   
 
 
6.  在 **WCF BasicHttp 传输属性** 对话框中，在 **代理** 选项卡上配置的代理设置 WCF BasicHttp 发送端口︰ 

    |使用此选项|执行的操作|  
    |--------------|----------------|  
    |**使用处理程序的默认代理设置**|指定此发送端口是否使用承载此发送端口的发送处理程序中的代理设置。<br /><br /> 這是預設值。|  
    |**不使用代理服务器**|指出這個傳送埠是否要使用 Proxy 伺服器。<br /><br /> 預設值為清除核取方塊。|  
    |**使用代理服务器**|指示此发送端口使用中指定的代理服务器 **地址** 属性。<br /><br /> 預設值為清除核取方塊。|  
    |**地址**|指定 Proxy 伺服器的位址。 使用 **https** 或 **http** 根据安全配置的方案。 這個位址後面可以加上冒號和連接埠編號， 例如， http://127.0.0.1:8080。<br /><br /> 此属性，则需要值才 **使用代理** 选择。<br /><br /> 類型：字串<br /><br /> 最大長度：256<br /><br /> 預設為空字串。|  
    |**用户名称**|指定要用於驗證的使用者名稱。 若使用整合式驗證，則使用者名稱會包括網域，即「網域\使用者名稱」。 如果使用基本或摘要式身份验证，则用户名不包括域\\。 此属性，则需要值才 **使用代理** 选择。 **注意︰**  WCF BasicHttp 发送适配器使用代理的基本身份验证。 <br /><br /> 类型：字符串<br /><br /> 最小長度：00<br /><br /> 最大長度：256<br /><br /> 預設為空字串。|  
    |**密码**|指定要用於驗證的密碼。<br /><br /> 此属性，则需要值才 **使用代理** 选择。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大長度：256<br /><br /> 默认值为空字符串。|  
  
7.  在 **WCF BasicHttp 传输属性** 对话框中，在 **消息** 选项卡上，指定 SOAP 数据选择 **正文** 元素。 

    |使用此选项|動作|  
    |--------------|----------------|  
    |**正文--BizTalk 请求消息正文**|使用 BizTalk 消息正文部分创建的 SOAP 内容 **正文** 传出消息的元素。<br /><br /> 這是預設值。|  
    |**指定模板的模板--内容**|使用 [XML]  文字方塊中提供的範本來建立外寄訊息的 SOAP **內文** 元素內容。<br /><br /> 預設值為清除核取方塊。|  
    |**XML**|針對外寄訊息的 SOAP **內文** 元素內容，輸入 XML 格式的範本。 如果选择了“模板 -- BizTalk 响应消息正文”  选项，则此属性是必需的。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大长度：32767<br /><br /> 默认值是 < bts 消息正文<br /><br /> xmlns ="http://www.microsoft.com/schemas/bts2007"编码 ="xml"/ >。|  
    |**信封--完整\<soap 信封：\>**|從內送訊息的整個 SOAP **信封** 建立 BizTalk 訊息內文部分。 此屬性只對請求-回應連接埠有效。<br /><br /> 預設值為清除核取方塊。|  
    |**正文--内容\<soap： 正文\>元素**|使用內送訊息的 SOAP **Body** 元素內容來建立 BizTalk 訊息內文部分。 如果 **Body** 元素有一個以上的子元素，則只有第一個元素會成為 BizTalk 訊息內文部分。 此屬性只對請求-回應連接埠有效。<br /><br /> 這是預設值。|  
    |**路径--由正文路径定位的内容**|使用 **[內文路徑運算式]** 文字方塊中的內文路徑運算式，建立 BizTalk 訊息內文部分。 內文路徑運算式會依照內送訊息 SOAP **Body** 元素的直系子元素來進行評估。 此屬性只對請求-回應連接埠有效。<br /><br /> 預設值為清除核取方塊。|  
    |**正文路径表达式**|輸入內文路徑運算式，以識別用來建立 BizTalk 訊息內文部分的內送訊息特定部分。 此正文路径表达式针对 SOAP 的即时子元素进行评估 **正文** 传入消息的节点。 如果此內文路徑運算式傳回一個以上的節點，則只會為 BizTalk 訊息內文部分選擇第一個節點。 如果選取了 **[路徑 -- 內容由內文路徑定位]** 選項，就需要此屬性。 此屬性只對請求-回應連接埠有效。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大長度：32767<br /><br /> 預設為空字串。|  
    |**节点编码**|指定 WCF BasicHttp 发送适配器用于解码识别由正文路径表达式中的节点的编码类型 **正文路径表达式** 文本框。 如果选择了“路径 -- 按正文路径定位内容”  选项，则此属性是必需的。 此屬性只對請求-回應連接埠有效。 有效值包括下列各項：<br /><br /> -   **Base64**: Base64 编码。<br />-   **十六进制**︰ 十六进制编码。<br />-   **字符串**︰ 文本编码的 utf-8<br />-   **XML**: WCF 适配器使用由正文路径表达式中所选节点的外部 XML 创建 BizTalk 消息正文 **正文路径表达式** 文本框。<br /><br /> 預設值是 **[XML]**。|  
    |**传播故障消息**|選取此核取方塊可將輸出處理失敗的訊息路由至訂閱應用程式 (例如另一個接收埠或協調流程排程)。 清除核取方塊以擱置失敗的訊息，並產生負值通知 (NACK)。 此屬性只對請求-回應連接埠有效。<br /><br /> 默认值为选中此复选框。|  

## <a name="add-a-proxy-to-the-send-handler"></a>将代理添加到发送处理程序

可以将代理添加到发送端口中或发送处理程序。 如果要在发送端口添加代理，则跳过此部分。

1.  在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台中，展开[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理，展开**BizTalk 组**，展开**平台设置**，然后展开**适配器**.  
  
2.  选择 **WCF BasicHttp**, ，然后双选择发送处理程序。  
  
3.  在 **适配器处理程序属性**, 上 **常规** 选项卡上，选择 **属性**。  
  
4.  在 **代理** 选项卡上，执行以下操作。  
  
    |使用|動作|  
    |--------------|----------------|  
    |**使用代理服务器**|指示此发送处理程序是否使用代理服务器。<br /><br /> 預設值為清除核取方塊。|  
    |**地址**|指定 Proxy 伺服器的位址。 使用 **https** 或 **http** 根据安全配置的方案。 這個位址後面可以加上冒號和連接埠編號， 例如， http://127.0.0.1:8080。<br /><br /> 此属性，则需要值才 **使用代理** 选择。<br /><br /> 類型：字串<br /><br /> 最大長度：256<br /><br /> 預設為空字串。|  
    |**用户名称**|指定要用於驗證的使用者名稱。 若使用整合式或基本驗證，則使用者名稱也包括網域，即「網域\使用者名稱」。 如果使用摘要式身份验证，则用户名不包括域\\。<br /><br /> 此属性，则需要值才 **使用代理** 选择。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大長度：256<br /><br /> 預設為空字串。|  
    |**密码**|指定要用於驗證的密碼。<br /><br /> 此属性，则需要值才 **使用代理** 选择。<br /><br /> 類型：字串<br /><br /> 最小長度：00<br /><br /> 最大長度：256<br /><br /> 預設為空字串。|  
  
5.  单击 **确定** 直到退出所有对话框。  

 ## <a name="see-also"></a>另请参阅
 
[WCF 适配器概述](../core/what-are-the-wcf-adapters.md)

[SB 消息适配器](../core/sb-messaging-adapter.md)

[使用适配器](../core/using-adapters.md)
 