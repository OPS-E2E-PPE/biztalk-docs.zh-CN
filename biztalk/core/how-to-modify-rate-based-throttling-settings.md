---
title: 如何修改速率基于限制设置 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
f1_keywords:
- Bts10.settings.HostRate
ms.assetid: a99dfb29-dee6-4a43-8d34-45179d9d0b5e
caps.latest.revision: 14
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: ea7c1352df6583ce2ff1ee17ee5fb667c7156bf8
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36997246"
---
# <a name="how-to-modify-rate-based-throttling-settings"></a>如何修改基于速率的阻止设置
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 中的基于速率的阻止功能，应用于包含业务流程或发送适配器的主机实例，这些适配器接收和传送或处理已发布到 MessageBox 的消息。 使用 [!INCLUDE[btsSettingsDashboard](../includes/btssettingsdashboard-md.md)]，您可以跨 BizTalk 组，修改给定主机的基于速率的阻止功能配置设置。 这些设置将应用于分配到给定主机的所有主机实例。 本主题提供了修改这些设置的分步过程。  

 以下情况可以触发基于速率的阻止功能条件：  

-   主机实例使用的内存数量、线程数和数据库连接数，超过了阻止阈值。  

-   主机实例的“Message delivery incoming rate”超出“Message delivery outgoing rate”* 指定的“加速因子(百分比)”值。  

-   主机实例同时处理的消息数超过了“每 CPU 的进程内消息数”* 框上可用的 CPU 数。  

## <a name="prerequisites"></a>必要條件  
 若要执行此操作，则必须以 BizTalk Server Administrators 组成员的身份登录。  

### <a name="to-modify-the-rate-based-throttling-settings-of-a-host"></a>修改主机基于速率的阻止设置  

1. 在中**BizTalk Server 管理控制台**，展开[!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]，右键单击**BizTalk 组**，然后单击**设置**。  

2. 在中**BizTalk 设置仪表板**对话框中，在**主机**选项卡上，单击**基于速率的阻止**选项卡。  

3. 执行以下操作，单击**应用**以应用修改并转到另一个选项卡。否则，请单击**确定**应用所做的修改并退出设置仪表板。  


   | 使用此选项 |                                                                           执行的操作                                                                            | 边界值 | 默认值 | 升级逻辑 |
   |----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------|---------------|---------------|
   | **主机** | 从下拉列表中，选择代表 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 运行时实例的主机。 |        -        |       -       |       -       |

    **发布**  


   |             使用此选项             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                  执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                        边界值                                         | 默认值 |                                           升级逻辑                                           |
   |----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------|
   |  **最小样本数**   | 指定消息的最小数目[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将示例**取样时段**考虑基于速率的阻止功能之前。<br /><br /> 如果实际的取样时段中的样本数低于此值，则样本将被放弃且不应用限制。 此值应该与中等负载下可以发布消息的速率一致。 例如，如果希望系统在中等负载下每秒 1,000 个文档处理，则此参数应设置为 1,000\*取样时段 （秒） (或更准确地说，1 \* **取样时段持续时间**（秒）)。 如果此值设置过低，则系统可能会在低负载下触发阻止条件。 如果此值设置过大，则可能会由于样本不足而导致此方法无法生效。 |                               1 – Integer 类型的最大值                                |      100      |                                                 -                                                 |
   |   **采样时段持续时间**   |                                                                                                                                                                                                                                                                                                                                                       指定以秒为单位度量的时段，用于基于所收集的样本来计算发布速率。 如果发布单个消息需要较高的延迟时间，则应增加该持续时间。                                                                                                                                                                                                                                                                                                                                                        |                               1 – Integer 类型的最大值                                |     15000     |                                                 -                                                 |
   |    **加速因子**     |                                                                                                                   指定用于控制在触发阻止条件之前允许请求速率高于完成速率的程度的百分比。<br /><br /> 例如，如果消息发布速率为每秒 200 条，并且此参数设置为 125，则系统允许的每秒最多 250 个消息发布 (125% \* 200 = 250) 应用阻止功能前。 指定此参数的值会导致系统更主动的方式限制，可能导致过度阻止太小。 指定此参数的值太大，可以在下，限制会导致并防止发生阻止机制识别合法的阻止条件。                                                                                                                    |                               1 – Integer 类型的最大值                                |      125      |                                                 -                                                 |
   |   **最大阻止延迟时间**   |                                                                                                                                                                                                                                                                                                                                            指定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 因为阻止而实施消息实例的最大延迟（以毫秒为单位）。 实际延迟时间取决于阻止条件的严重性。                                                                                                                                                                                                                                                                                                                                             |                               1 – Integer 类型的最大值                                |    300000     |                                                 -                                                 |
   |     **阻止重写**      |                                                                                                                                                                                                                                                                                                                                                                                                                                        指定是否要重写消息发布阻止。                                                                                                                                                                                                                                                                                                                                                                                                                                        | 0： 不会重写<br /><br /> 1： 启动阻止条件<br /><br /> 2： 不限制 |       0       | 从注册表中读取的阻止参数应当一对一地映射到主机实例参数。 |
   | **阻止重写严重性** |                                                                                                                                                                                                                                                                                                                                                                      指定入站阻止条件的严重性。<br /><br /> 启动时的入站阻止条件的严重性较大值会增大**阻止重写**设置为 1。                                                                                                                                                                                                                                                                                                                                                                       |                                            1 – 1000                                            |      100      |                                所有主机实例的最小值。                                |

    **传递**  


   |             使用此选项             |                                                                                                                                                                                                                                                                                                                                                                                                                                           执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                        边界值                                         | 默认值 |                                           升级逻辑                                           |
   |----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------|
   |  **最小样本数**   | 指定最小的消息数的示例将 BizTalk**取样时段**考虑基于速率的阻止功能之前。<br /><br /> 如果实际的取样时段中的样本数低于此值，则样本将被放弃且不应用限制。 此值应该与中等负载下可以传送消息的速率一致。 例如，如果希望系统在中等负载下每秒 1,000 个文档处理，则此参数应设置为 1,000\*取样时段 （秒） (或更准确地说，1 \* **取样时段** （秒） 这种情况下)。<br /><br /> 如果此值设置过低，则系统可能会在低负载下触发阻止条件。 如果此值设置过大，则可能会由于样本不足而导致此方法无法生效。 |                               1 – Integer 类型的最大值                                |      100      |                                                 -                                                 |
   |   **采样时段持续时间**   |                                                                                                                                                                                                                                                                                                                                     指定以秒为单位度量的时段，用于基于所收集的样本来计算处理速率。 如果处理单个消息需要较大的延迟时间，则应增加该持续时间。                                                                                                                                                                                                                                                                                                                                     |                               1 – Integer 类型的最大值                                |     15000     |                                                 -                                                 |
   |    **加速因子**     |                                                                           指定用于控制在触发阻止条件之前允许向业务流程或消息引擎传送的速率高于完成速率的程度的百分比。<br /><br /> 例如，如果每秒 200 条的速率处理消息并且此参数设置为 125，则系统允许每秒最多 250 个消息的处理 (125% \* 200 = 250) 应用阻止功能前。 如果将此参数指定为过小的值，则会导致系统更主动地进行阻止，从而可能导致过度阻止。 如果将此参数指定为过高的值，则会导致不易应用阻止功能，并且不利于阻止机制识别合法的阻止条件。                                                                           |                               1 – Integer 类型的最大值                                |      125      |                                                 -                                                 |
   |   **最大阻止延迟时间**   |                                                                                                                                                                                                                                                                                                                              指定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 因为阻止而实施消息实例的最大延迟。 实际延迟时间取决于阻止条件的严重性。                                                                                                                                                                                                                                                                                                                               |                               1 – Integer 类型的最大值                                |    300000     |                                                 -                                                 |
   |     **阻止重写**      |                                                                                                                                                                                                                                                                                                                                                                                                                  指定是否要重写消息传递阻止。                                                                                                                                                                                                                                                                                                                                                                                                                  | 0： 不会重写<br /><br /> 1： 启动阻止条件<br /><br /> 2： 不限制 |       0       | 从注册表中读取的阻止参数应当一对一地映射到主机实例参数。 |
   | **阻止重写严重性** |                                                                                                                                                                                                                                                                                                                                              确定出站阻止条件的严重性。<br /><br /> 启动时的出站阻止条件的严重性较大值会增大**阻止重写**设置为 1。                                                                                                                                                                                                                                                                                                                                              |                                            1 – 1000                                            |      100      |                                所有主机实例的最小值。                                |

   > [!NOTE]
   >  若要还原默认设置，请单击**还原为默认值**。  

## <a name="see-also"></a>请参阅  
 [如何修改主机设置](../core/how-to-modify-host-settings.md)