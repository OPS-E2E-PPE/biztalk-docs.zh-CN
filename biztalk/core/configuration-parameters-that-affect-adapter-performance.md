---
title: "适配器性能影响的配置参数 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 90bbb9fb-0b31-45f0-a54c-7b2025e653b9
caps.latest.revision: "23"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 46bbb5a1c796149f762ce438aed7df5c256bf465
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="configuration-parameters-that-affect-adapter-performance"></a><span data-ttu-id="9b301-102">影响适配器性能的配置参数</span><span class="sxs-lookup"><span data-stu-id="9b301-102">Configuration Parameters that Affect Adapter Performance</span></span>
<span data-ttu-id="9b301-103">本部分介绍可能会影响 BizTalk Server 适配器性能的配置设置。</span><span class="sxs-lookup"><span data-stu-id="9b301-103">This section describes configuration settings that can affect the performance of BizTalk Server adapters.</span></span>  
  
## <a name="clr-hosting-thread-values-for-the-host"></a><span data-ttu-id="9b301-104">主机的 CLR 宿主线程值</span><span class="sxs-lookup"><span data-stu-id="9b301-104">CLR Hosting thread values for the host</span></span>  
 <span data-ttu-id="9b301-105">因为 Windows 线程是 Windows 进程可用的最基本的可执行单元，因此，有必要为与 BizTalk 主机实例相关联的 .NET 线程池分配足够的线程以防止线程不足。</span><span class="sxs-lookup"><span data-stu-id="9b301-105">Because a Windows thread is the most basic executable unit available to a Windows process, it is important to allocate enough threads to the .NET thread pool associated with an instance of a BizTalk host to prevent thread starvation.</span></span> <span data-ttu-id="9b301-106">线程不足时，没有足够的线程用于执行请求的作业，因此可能会对性能造成负面影响。</span><span class="sxs-lookup"><span data-stu-id="9b301-106">When thread starvation occurs, there are not enough threads available to perform the requested work, which can negatively impact performance.</span></span> <span data-ttu-id="9b301-107">同时应注意防止为与主机相关联的 .NET 线程池分配不必要的过多线程。</span><span class="sxs-lookup"><span data-stu-id="9b301-107">At the same time, care should be taken to prevent allocating more threads to the .NET thread pool associated with a host than is necessary.</span></span> <span data-ttu-id="9b301-108">为与主机相关联的 .NET 线程池分配过多的线程会增加上下文切换，也会对总体性能造成负面影响。</span><span class="sxs-lookup"><span data-stu-id="9b301-108">The allocation of too many threads to the .NET thread pool associated with a host may increase context switching, which can also negatively impact overall performance.</span></span> <span data-ttu-id="9b301-109">Windows 内核从运行一个线程切换到运行另一个线程时，会发生上下文切换，这可能是一个成本高昂的 CPU 操作。</span><span class="sxs-lookup"><span data-stu-id="9b301-109">Context switching occurs when the Windows kernel switches from running one thread to a different thread and can be an expensive CPU operation.</span></span>  
  
 <span data-ttu-id="9b301-110">通过在 BizTalk Server 设置仪表板中配置相应的值，可以修改与 BizTalk 主机实例相关联的 .NET 线程池中可用的 Windows 线程数。</span><span class="sxs-lookup"><span data-stu-id="9b301-110">Modify the number of Windows threads available in the .NET thread pool associated with an instance of a BizTalk host by configuring the appropriate  values in the BizTalk Server Settings Dashboard.</span></span> <span data-ttu-id="9b301-111">有关修改.NET CLR 值的详细信息，请参阅[如何修改.NET CLR 设置](http://msdn.microsoft.com/library/ff629681\(v=BTS.70\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="9b301-111">For more information on modifying the .NET CLR values, see [How to Modify .NET CLR Settings](http://msdn.microsoft.com/library/ff629681\(v=BTS.70\).aspx).</span></span>  
  
## <a name="aspnet-settings-that-can-impact-http-or-soap-adapter-performance"></a><span data-ttu-id="9b301-112">可能影响 HTTP 或 SOAP 适配器性能的 ASP.NET 设置</span><span class="sxs-lookup"><span data-stu-id="9b301-112">ASP.NET settings that can impact HTTP or SOAP Adapter performance</span></span>  
 <span data-ttu-id="9b301-113">以下设置可应用于的 ASP.NET 应用程序承载 Web 应用程序与之通信的 HTTP 或 SOAP 适配器。</span><span class="sxs-lookup"><span data-stu-id="9b301-113">The following settings can be applied to an ASP.NET application that hosts a Web application that the HTTP or SOAP adapter communicates with.</span></span> <span data-ttu-id="9b301-114">这些参数是在作为该 Web 应用程序宿主的服务器的 web.config 或 machine.config 文件中设置的。</span><span class="sxs-lookup"><span data-stu-id="9b301-114">These parameters are set in the web.config or machine.config files of the server hosting the Web application.</span></span> <span data-ttu-id="9b301-115">请修改这些设置以适合 HTTP 或 SOAP 适配器发送端口生成的负载。</span><span class="sxs-lookup"><span data-stu-id="9b301-115">Modify these settings to accommodate the load that is generated by your HTTP or SOAP adapter send port.</span></span> <span data-ttu-id="9b301-116">有关这些设置的详细信息，请参阅[争用、 性能不佳和死锁在 ASP.NET 应用程序的 Web 服务请求时](http://go.microsoft.com/fwlink/p/?LinkId=196842)。</span><span class="sxs-lookup"><span data-stu-id="9b301-116">For more information about these settings, see [Contention, poor performance, and deadlocks when you make Web service requests from ASP.NET applications](http://go.microsoft.com/fwlink/p/?LinkId=196842).</span></span>  
  
|<span data-ttu-id="9b301-117">**参数**</span><span class="sxs-lookup"><span data-stu-id="9b301-117">**Parameter**</span></span>|<span data-ttu-id="9b301-118">**配置文件节**</span><span class="sxs-lookup"><span data-stu-id="9b301-118">**Section of configuration file**</span></span>|<span data-ttu-id="9b301-119">**默认值**</span><span class="sxs-lookup"><span data-stu-id="9b301-119">**Default value**</span></span>|<span data-ttu-id="9b301-120">**建议的值**</span><span class="sxs-lookup"><span data-stu-id="9b301-120">**Recommended value**</span></span>|  
|-------------------|---------------------------------------|-----------------------|---------------------------|  
|<span data-ttu-id="9b301-121">**minFreeThreads**</span><span class="sxs-lookup"><span data-stu-id="9b301-121">**minFreeThreads**</span></span><br /><br /> <span data-ttu-id="9b301-122">允许执行新请求的自由线程的最小数目。</span><span class="sxs-lookup"><span data-stu-id="9b301-122">The minimum number of free threads to allow execution of new requests.</span></span> <span data-ttu-id="9b301-123">ASP.NET 为需要额外线程完成其处理的请求保留了多个自由线程。</span><span class="sxs-lookup"><span data-stu-id="9b301-123">ASP.NET keeps this many threads free for requests that require additional threads to complete their processing.</span></span>|<span data-ttu-id="9b301-124">\<httpRuntime ></span><span class="sxs-lookup"><span data-stu-id="9b301-124">\<httpRuntime></span></span>|<span data-ttu-id="9b301-125">8</span><span class="sxs-lookup"><span data-stu-id="9b301-125">8</span></span>|<span data-ttu-id="9b301-126">88 * 托管 Web 应用程序的服务器上的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b301-126">88 * the number of processors on the server hosting the Web application.</span></span>|  
|<span data-ttu-id="9b301-127">**minFreeLocalRequestFreeThreads**</span><span class="sxs-lookup"><span data-stu-id="9b301-127">**minFreeLocalRequestFreeThreads**</span></span><br /><br /> <span data-ttu-id="9b301-128">ASP.NET 保持用于执行新的本地请求的最小可用线程数。</span><span class="sxs-lookup"><span data-stu-id="9b301-128">The minimum number of free threads that ASP.NET keeps available to allow execution of new local requests.</span></span> <span data-ttu-id="9b301-129">此线程数目是为从本地主机传入的请求而保留的，以防某些请求在其处理期间发出对本地主机的子请求。</span><span class="sxs-lookup"><span data-stu-id="9b301-129">This number of threads is kept reserved for requests coming from the local host, in case some requests issue child requests to the local host during their processing.</span></span> <span data-ttu-id="9b301-130">这可以避免由于递归重入 Web 服务器而可能带来的死锁。</span><span class="sxs-lookup"><span data-stu-id="9b301-130">This avoids a possible deadlock with recursive reentry into the Web server.</span></span>|<span data-ttu-id="9b301-131">\<httpRuntime ></span><span class="sxs-lookup"><span data-stu-id="9b301-131">\<httpRuntime></span></span>|<span data-ttu-id="9b301-132">4</span><span class="sxs-lookup"><span data-stu-id="9b301-132">4</span></span>|<span data-ttu-id="9b301-133">76 * 托管 Web 应用程序的服务器上的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b301-133">76 * the number of processors on the server hosting the Web application.</span></span>|  
|<span data-ttu-id="9b301-134">**executionTimeout**</span><span class="sxs-lookup"><span data-stu-id="9b301-134">**executionTimeout**</span></span><br /><br /> <span data-ttu-id="9b301-135">指示在被 ASP.NET 自动关闭前，允许执行请求的最大秒数。</span><span class="sxs-lookup"><span data-stu-id="9b301-135">Indicates the maximum number of seconds that a request is allowed to execute before being automatically shut down by ASP.NET.</span></span>|<span data-ttu-id="9b301-136">\<httpRuntime ></span><span class="sxs-lookup"><span data-stu-id="9b301-136">\<httpRuntime></span></span>|<span data-ttu-id="9b301-137">90</span><span class="sxs-lookup"><span data-stu-id="9b301-137">90</span></span>|<span data-ttu-id="9b301-138">90</span><span class="sxs-lookup"><span data-stu-id="9b301-138">90</span></span>|  
|<span data-ttu-id="9b301-139">**maxconnection**</span><span class="sxs-lookup"><span data-stu-id="9b301-139">**maxconnection**</span></span><br /><br /> <span data-ttu-id="9b301-140">确定可以向特定的 IP 地址建立多少个连接。</span><span class="sxs-lookup"><span data-stu-id="9b301-140">Determines how many connections can be made to a specific IP address.</span></span>|<span data-ttu-id="9b301-141">\<connectionManagement ></span><span class="sxs-lookup"><span data-stu-id="9b301-141">\<connectionManagement></span></span>|<span data-ttu-id="9b301-142">2</span><span class="sxs-lookup"><span data-stu-id="9b301-142">2</span></span><br /><br /> <span data-ttu-id="9b301-143">如果此设置的值为 2，则符合 HTTP 1.1 规范的 IETF RFC，因此此值可供用户使用，但不利于优化高吞吐量。</span><span class="sxs-lookup"><span data-stu-id="9b301-143">A value of 2 for this setting conforms to the IETF RFC for the HTTP 1.1 specification and is suitable for user scenarios but is not optimized for high throughput.</span></span>|<span data-ttu-id="9b301-144">12 * 托管 Web 应用程序的服务器上的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b301-144">12 * the number of processors on the server hosting the Web application.</span></span>|  
|<span data-ttu-id="9b301-145">**maxWorkerThreads**</span><span class="sxs-lookup"><span data-stu-id="9b301-145">**maxWorkerThreads**</span></span><br /><br /> <span data-ttu-id="9b301-146">按 CPU 配置用于进程的辅助线程的最大数目。</span><span class="sxs-lookup"><span data-stu-id="9b301-146">Configures the maximum amount of worker threads to be used for the process on a per-CPU basis.</span></span>|<span data-ttu-id="9b301-147">\<processModel ></span><span class="sxs-lookup"><span data-stu-id="9b301-147">\<processModel></span></span>|<span data-ttu-id="9b301-148">20</span><span class="sxs-lookup"><span data-stu-id="9b301-148">20</span></span>|<span data-ttu-id="9b301-149">100**注意：**此值隐式乘以在服务器上的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b301-149">100 **Note:**  This value is implicitly multiplied by the number of processors on the server.</span></span>|  
|<span data-ttu-id="9b301-150">**minWorkerThreads**</span><span class="sxs-lookup"><span data-stu-id="9b301-150">**minWorkerThreads**</span></span>|<span data-ttu-id="9b301-151">\<processModel ></span><span class="sxs-lookup"><span data-stu-id="9b301-151">\<processModel></span></span>|<span data-ttu-id="9b301-152">1</span><span class="sxs-lookup"><span data-stu-id="9b301-152">1</span></span>|<span data-ttu-id="9b301-153">**maxWorkerThreads** / 2**注意：** minWorkerThreads 参数不在默认情况下配置文件中。</span><span class="sxs-lookup"><span data-stu-id="9b301-153">**maxWorkerThreads** / 2 **Note:**  The minWorkerThreads parameter is not in the configuration file by default.</span></span> <span data-ttu-id="9b301-154">你必须添加此参数。</span><span class="sxs-lookup"><span data-stu-id="9b301-154">You must add it.</span></span> <span data-ttu-id="9b301-155">**注意：**此值隐式乘以在服务器上的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b301-155">**Note:**  This value is implicitly multiplied by the number of processors on the server.</span></span>|  
|<span data-ttu-id="9b301-156">**maxIoThreads**</span><span class="sxs-lookup"><span data-stu-id="9b301-156">**maxIoThreads**</span></span><br /><br /> <span data-ttu-id="9b301-157">ASP.NET 使用此参数来限制所使用的完成线程数。</span><span class="sxs-lookup"><span data-stu-id="9b301-157">Used by ASP.NET to limit the number completion threads used.</span></span>|<span data-ttu-id="9b301-158">\<processModel ></span><span class="sxs-lookup"><span data-stu-id="9b301-158">\<processModel></span></span>|<span data-ttu-id="9b301-159">20</span><span class="sxs-lookup"><span data-stu-id="9b301-159">20</span></span>|<span data-ttu-id="9b301-160">100</span><span class="sxs-lookup"><span data-stu-id="9b301-160">100</span></span><br /><br /> <span data-ttu-id="9b301-161">此值将隐式乘以服务器上的处理器数。</span><span class="sxs-lookup"><span data-stu-id="9b301-161">This value is implicitly multiplied by the number of processors on the server.</span></span>|  
  
 <span data-ttu-id="9b301-162">如果承载的 Web 服务的计算机运行的 ASP.NET 2.0 或更高版本，则可以设置**autoConfig = true** processModel 部分要自动配置以下设置以实现最佳的 Machine.config 文件中基于机配置上的性能：</span><span class="sxs-lookup"><span data-stu-id="9b301-162">If the computer hosting the Web services is running ASP.NET 2.0 or later, then you can set **autoConfig=true** in the processModel section of the Machine.config file to automatically configure the following settings to achieve optimal performance based on the machine configuration:</span></span>  
  
-   <span data-ttu-id="9b301-163">**MaxWorkerThreads**属性。</span><span class="sxs-lookup"><span data-stu-id="9b301-163">The **maxWorkerThreads** attribute.</span></span>  
  
-   <span data-ttu-id="9b301-164">**MaxIoThreads**属性。</span><span class="sxs-lookup"><span data-stu-id="9b301-164">The **maxIoThreads** attribute.</span></span>  
  
-   <span data-ttu-id="9b301-165">**MinFreeThreads** httpRuntime 元素的属性。</span><span class="sxs-lookup"><span data-stu-id="9b301-165">The **minFreeThreads** attribute of the httpRuntime element.</span></span>  
  
-   <span data-ttu-id="9b301-166">**MinLocalRequestFreeThreads** httpRuntime 元素的属性。</span><span class="sxs-lookup"><span data-stu-id="9b301-166">The **minLocalRequestFreeThreads** attribute of the httpRuntime element.</span></span>  
  
-   <span data-ttu-id="9b301-167">**MaxConnection**属性\<connectionManagement > 元素 （网络设置）。</span><span class="sxs-lookup"><span data-stu-id="9b301-167">The **maxConnection** attribute of the \<connectionManagement> Element (Network Settings) element.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9b301-168">**ProcessModel**部分可以设置仅在 Machine.config 文件，并且会影响服务器运行的所有 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="9b301-168">The **processModel** section can be set only within the Machine.config file and affects all ASP.NET applications that are running on the server.</span></span>  
  
 <span data-ttu-id="9b301-169">有关详细信息**processModel** machine.config 文件的元素，请参阅 Microsoft MSDN 网站在[http://go.microsoft.com/fwlink/p/?LinkId=62307](http://go.microsoft.com/fwlink/p/?LinkId=62307)。</span><span class="sxs-lookup"><span data-stu-id="9b301-169">For more information about the **processModel** element of the machine.config file see the Microsoft MSDN Web site at [http://go.microsoft.com/fwlink/p/?LinkId=62307](http://go.microsoft.com/fwlink/p/?LinkId=62307).</span></span>  
  
## <a name="registry-setting-that-governs-the-tcp-window-size"></a><span data-ttu-id="9b301-170">控制 TCP 窗口大小的注册表设置</span><span class="sxs-lookup"><span data-stu-id="9b301-170">Registry setting that governs the TCP window size</span></span>  
 <span data-ttu-id="9b301-171">以下注册表设置控制 TCP 窗口大小，它是在连接过程中可以缓冲的接收数据的数量（以字节为单位）。</span><span class="sxs-lookup"><span data-stu-id="9b301-171">The following registry setting governs the TCP window size, which is the amount of receive data (in bytes) that can be buffered during a connection.</span></span> <span data-ttu-id="9b301-172">如果未将此参数设置为最佳值，则适配器性能会受到负面影响。</span><span class="sxs-lookup"><span data-stu-id="9b301-172">If this parameter is not set to an optimal value then adapter performance can be impacted negatively.</span></span> <span data-ttu-id="9b301-173">实现此注册表设置可增大 TCP 窗口大小。</span><span class="sxs-lookup"><span data-stu-id="9b301-173">Implement this registry setting to increase the TCP window size.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="9b301-174">如果注册表编辑器使用不当，则可能会产生严重问题，导致重新安装操作系统。</span><span class="sxs-lookup"><span data-stu-id="9b301-174">If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system.</span></span> <span data-ttu-id="9b301-175">Microsoft 不保证可以解决因注册表编辑器使用不当而造成的问题。</span><span class="sxs-lookup"><span data-stu-id="9b301-175">Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly.</span></span> <span data-ttu-id="9b301-176">请慎用注册表编辑器，风险自负。</span><span class="sxs-lookup"><span data-stu-id="9b301-176">Use Registry Editor at your own risk.</span></span> <span data-ttu-id="9b301-177">在修改注册表之前，请务必备份注册表，并确保你知道在发生问题时如何使用备份进行还原。</span><span class="sxs-lookup"><span data-stu-id="9b301-177">Before you modify the Registry, always back up the registry, and verify that you know how to restore the backup if a problem occurs.</span></span>  
  
 <span data-ttu-id="9b301-178">若要增大默认的 TCP 窗口大小，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="9b301-178">To increase the default TCP windows size, follow these steps:</span></span>  
  
1.  <span data-ttu-id="9b301-179">依次单击 **启动”**和 **运行”**，键入 **regedit.exe**，然后单击 **确定”** 以启动注册表编辑器。</span><span class="sxs-lookup"><span data-stu-id="9b301-179">Click **Start**, click **Run**, type **regedit.exe**, and then click **OK** to start Registry Editor.</span></span>  
  
     <span data-ttu-id="9b301-180">导航到**HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\\**</span><span class="sxs-lookup"><span data-stu-id="9b301-180">Navigate to **HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\\**</span></span>  
  
2.  <span data-ttu-id="9b301-181">下**参数**密钥，使用指示的值创建以下的 DWORD 条目。</span><span class="sxs-lookup"><span data-stu-id="9b301-181">Under the **Parameters** key, create the following DWORD entry with the indicated value.</span></span>  
  
    |<span data-ttu-id="9b301-182">DWORD 项</span><span class="sxs-lookup"><span data-stu-id="9b301-182">DWORD entry</span></span>|<span data-ttu-id="9b301-183">默认值</span><span class="sxs-lookup"><span data-stu-id="9b301-183">Default value</span></span>|<span data-ttu-id="9b301-184">推荐值</span><span class="sxs-lookup"><span data-stu-id="9b301-184">Recommended value</span></span>|  
    |-----------------|-------------------|-----------------------|  
    |<span data-ttu-id="9b301-185">**TcpWindowSize**</span><span class="sxs-lookup"><span data-stu-id="9b301-185">**TcpWindowSize**</span></span><br /><br /> <span data-ttu-id="9b301-186">此设置确定计算机的最大 TCP 接收窗口大小。</span><span class="sxs-lookup"><span data-stu-id="9b301-186">This setting determines the maximum TCP receive window size of the computer.</span></span> <span data-ttu-id="9b301-187">接收窗口指定发送方在不会收到确认的情况下可以传输的字节数。</span><span class="sxs-lookup"><span data-stu-id="9b301-187">The receive window specifies the number of bytes a sender can transmit without receiving an acknowledgment.</span></span> <span data-ttu-id="9b301-188">通常，较大的接收窗口会改善高带宽网络的性能。</span><span class="sxs-lookup"><span data-stu-id="9b301-188">Generally, larger receive windows improve performance over high bandwidth networks.</span></span>|<span data-ttu-id="9b301-189">17520</span><span class="sxs-lookup"><span data-stu-id="9b301-189">17520</span></span>|<span data-ttu-id="9b301-190">设置为以太网最大段大小 (MSS) 1460 的倍数，最大为 64240。</span><span class="sxs-lookup"><span data-stu-id="9b301-190">Set to a multiple of the Ethernet Maximum Segment Size (MSS) of 1460 up to a maximum of 64240.</span></span> <span data-ttu-id="9b301-191">如果使用 Windows 比例，则设置为最多 65535。</span><span class="sxs-lookup"><span data-stu-id="9b301-191">If Windows scaling is used, set to a maximum of 65535.</span></span>|  
  
    > [!NOTE]
    >  <span data-ttu-id="9b301-192">要使所做的更改生效，必须重新启动计算机。</span><span class="sxs-lookup"><span data-stu-id="9b301-192">You must restart your computer for these changes to take effect.</span></span>  
  
3.  <span data-ttu-id="9b301-193">关闭“注册表编辑器”。</span><span class="sxs-lookup"><span data-stu-id="9b301-193">Close Registry Editor.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9b301-194">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9b301-194">See Also</span></span>  
 [<span data-ttu-id="9b301-195">性能和容量规划</span><span class="sxs-lookup"><span data-stu-id="9b301-195">Performance and Capacity Planning</span></span>](../core/performance-and-capacity-planning.md)