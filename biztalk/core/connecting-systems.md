---
title: "将系统连接 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 4c4895e5-7272-415f-a0de-905256fa0a43
caps.latest.revision: "16"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 67d042d067fa68c6d54d95f3b0e658c20db4961d
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="connecting-systems"></a><span data-ttu-id="a600f-102">连接系统</span><span class="sxs-lookup"><span data-stu-id="a600f-102">Connecting Systems</span></span>
<span data-ttu-id="a600f-103">若要进行集成，必须在不同计算机上的不同软件之间进行有效的消息交换。</span><span class="sxs-lookup"><span data-stu-id="a600f-103">The effective exchange of messages across different software on different machines is an absolute requirement for integration.</span></span> <span data-ttu-id="a600f-104">考虑到现有通信方式多种多样，[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 必须支持各种协议和消息格式。</span><span class="sxs-lookup"><span data-stu-id="a600f-104">Given the diversity of communication styles that exist, [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] must support a variety of protocols and message formats.</span></span> <span data-ttu-id="a600f-105">如后文所述，该引擎的一个重要部分专用于实现此通信。</span><span class="sxs-lookup"><span data-stu-id="a600f-105">As described next, a significant portion of the engine is devoted to making this communication work.</span></span> <span data-ttu-id="a600f-106">但请注意，该引擎内部只使用 XML 文档。</span><span class="sxs-lookup"><span data-stu-id="a600f-106">One important fact to keep in mind, however, is that the engine works only with XML documents internally.</span></span> <span data-ttu-id="a600f-107">不管消息以何种格式到达，在收到消息后都必须将其转换为 XML 文档。</span><span class="sxs-lookup"><span data-stu-id="a600f-107">Whatever format a message arrives in, it must be converted to an XML document after it is received.</span></span> <span data-ttu-id="a600f-108">同样，如果文档的收件人无法以 XML 格式接收文档，则引擎会将其转换为目标所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a600f-108">Similarly, if the recipient of a document can’t accept that document as XML, the engine converts it into the format expected by the target.</span></span>  
  
## <a name="sending-and-receiving-messages-adapters"></a><span data-ttu-id="a600f-109">发送和接收消息： 适配器</span><span class="sxs-lookup"><span data-stu-id="a600f-109">Sending and Receiving Messages: Adapters</span></span>  
 <span data-ttu-id="a600f-110">由于 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 必须与其他各种软件进行通信，因此它依赖适配器来实现此类通信。</span><span class="sxs-lookup"><span data-stu-id="a600f-110">Because [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] must talk to a variety of other software, it relies on adapters to make this possible.</span></span> <span data-ttu-id="a600f-111">适配器用于实现某种通信机制，例如特定的协议。</span><span class="sxs-lookup"><span data-stu-id="a600f-111">An adapter is an implementation of a communication mechanism, such as a particular protocol.</span></span> <span data-ttu-id="a600f-112">开发人员确定在给定情况下要使用的适配器。</span><span class="sxs-lookup"><span data-stu-id="a600f-112">A developer determines which adapters to use in a given situation.</span></span> <span data-ttu-id="a600f-113">例如，开发人员可以选择 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 提供的内置适配器之一，也可以使用为诸如 Windows SharePoint Services 之类的常用产品创建的适配器，甚至可以创建自定义适配器。</span><span class="sxs-lookup"><span data-stu-id="a600f-113">He might choose one of the built-in adapters [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] provides, for example, or use an adapter created for a popular product such as Windows SharePoint Services, or even create a custom adapter.</span></span> <span data-ttu-id="a600f-114">在上述每一种情况下，适配器都是构建在称为“适配器框架”的标准结构之上的。</span><span class="sxs-lookup"><span data-stu-id="a600f-114">In each of these cases, the adapter is built on a standard base called the Adapter Framework.</span></span> <span data-ttu-id="a600f-115">此框架为创建和运行适配器提供了常用方法，并且支持用于管理所有适配器类型的相同工具。</span><span class="sxs-lookup"><span data-stu-id="a600f-115">This framework provides a common way to create and run adapters, and it also supports the same tools used to manage all of the adapter types.</span></span>  
  
 <span data-ttu-id="a600f-116">Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 包括以下本地适配器：</span><span class="sxs-lookup"><span data-stu-id="a600f-116">Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] includes the following native adapters:</span></span>  
  
-   <span data-ttu-id="a600f-117">文件适配器： 支持读取和写入 Windows 文件系统中的文件。</span><span class="sxs-lookup"><span data-stu-id="a600f-117">File adapter: supports reading from and writing to files in the Windows file system.</span></span> <span data-ttu-id="a600f-118">由于业务流程中包含的应用程序可能会经常访问本地或网络中的同一文件系统，因此通过文件交换消息可能较为方便。</span><span class="sxs-lookup"><span data-stu-id="a600f-118">Because the applications involved in a business process can often access the same file system, either locally or across a network, exchanging messages through files can be a convenient option.</span></span>  
  
-   <span data-ttu-id="a600f-119">FTP 适配器： 支持发送和接收文件传输协议 (FTP) 服务器和 BizTalk Server 之间的信息。</span><span class="sxs-lookup"><span data-stu-id="a600f-119">FTP adapter: supports sending and receiving information between a File Transport Protocol (FTP) Server and BizTalk Server.</span></span>  
  
-   <span data-ttu-id="a600f-120">HTTP 适配器： 支持发送和接收使用 HTTP 的信息。</span><span class="sxs-lookup"><span data-stu-id="a600f-120">HTTP adapter: supports sending and receiving information using HTTP.</span></span> [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]<span data-ttu-id="a600f-121"> 公开了一个或多个 URL，以便其他应用程序能够向其发送数据，然后该引擎可使用此适配器将数据发送给其他 URL。</span><span class="sxs-lookup"><span data-stu-id="a600f-121"> exposes one or more URLs to allow other applications to send data to it, and it can use this adapter to send data to other URLs.</span></span>  
  
-   <span data-ttu-id="a600f-122">MSMQ 适配器： 支持发送和接收消息使用 Microsoft 消息队列 (MSMQ)。</span><span class="sxs-lookup"><span data-stu-id="a600f-122">MSMQ adapter: supports sending and receiving messages using Microsoft Message Queuing (MSMQ).</span></span>  
  
-   <span data-ttu-id="a600f-123">WebSphere MQ 适配器： 支持发送和接收使用 IBM WebSphere MQ （以前称为 MQSeries） 的消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-123">WebSphere MQ adapter: supports sending and receiving messages using IBM’s WebSphere MQ (formerly known as MQSeries).</span></span>  
  
-   <span data-ttu-id="a600f-124">POP3 适配器： 支持在接收电子邮件和使用邮局协议 (POP3) 的第三版其附件。</span><span class="sxs-lookup"><span data-stu-id="a600f-124">POP3 adapter: supports receiving e-mail messages and their attachments using version three of the Post Office Protocol (POP3).</span></span>  
  
-   <span data-ttu-id="a600f-125">SMTP 适配器： 支持使用 SMTP 发送消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-125">SMTP adapter: supports sending messages using SMTP.</span></span> <span data-ttu-id="a600f-126">使用标准电子邮件地址标识参与方。</span><span class="sxs-lookup"><span data-stu-id="a600f-126">Standard e-mail addresses are used to identify the parties.</span></span>  
  
-   <span data-ttu-id="a600f-127">SOAP 适配器： 支持发送和接收 Web 服务请求，以使连接到 Web 服务的 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="a600f-127">SOAP adapter: supports sending and receiving Web service requests to enable BizTalk Server to connect to Web Services.</span></span>  
  
-   <span data-ttu-id="a600f-128">WCF 适配器： 支持发送和接收使用 Windows Communication Foundation 的信息。</span><span class="sxs-lookup"><span data-stu-id="a600f-128">WCF adapters: supports sending and receiving information using Windows Communication Foundation.</span></span>  
  
-   <span data-ttu-id="a600f-129">Windows SharePoint Services (WSS) 适配器： 支持访问和发布 Microsoft Windows SharePoint 文档库中存储的文档。</span><span class="sxs-lookup"><span data-stu-id="a600f-129">Windows SharePoint Services (WSS) adapter: supports accessing and publishing documents stored in Microsoft Windows SharePoint document libraries.</span></span>  
  
 <span data-ttu-id="a600f-130">Microsoft 还提供了用于常用商业软件的适配器，包括：</span><span class="sxs-lookup"><span data-stu-id="a600f-130">Adapters for commonly-used business software are also available from Microsoft, these include:</span></span>  
  
-   <span data-ttu-id="a600f-131">用于 JD Edwards OneWorld 的 Microsoft BizTalk 适配器</span><span class="sxs-lookup"><span data-stu-id="a600f-131">Microsoft BizTalk Adapter for JD Edwards OneWorld</span></span>  
  
-   <span data-ttu-id="a600f-132">用于 JD Edwards EnterpriseOne 的 Microsoft BizTalk 适配器</span><span class="sxs-lookup"><span data-stu-id="a600f-132">Microsoft BizTalk Adapter for JD Edwards EnterpriseOne</span></span>  
  
-   <span data-ttu-id="a600f-133">用于 PeopleSoft Enterprise 的 Microsoft BizTalk 适配器</span><span class="sxs-lookup"><span data-stu-id="a600f-133">Microsoft BizTalk Adapter for PeopleSoft Enterprise</span></span>  
  
-   <span data-ttu-id="a600f-134">用于 TIBCO Rendezvous 的 Microsoft BizTalk 适配器</span><span class="sxs-lookup"><span data-stu-id="a600f-134">Microsoft BizTalk Adapter for TIBCO Rendezvous</span></span>  
  
-   <span data-ttu-id="a600f-135">用于 TIBCO Enterprise Message Service 的 Microsoft BizTalk 适配器</span><span class="sxs-lookup"><span data-stu-id="a600f-135">Microsoft BizTalk Adapter for TIBCO Enterprise Message Service</span></span>  
  
 <span data-ttu-id="a600f-136">有关这些适配器的详细信息，请参阅[BizTalk Server 中的适配器](../core/adapters-in-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a600f-136">For more information about these adapters, see [Adapters in BizTalk Server](../core/adapters-in-biztalk-server.md).</span></span>  
  
 <span data-ttu-id="a600f-137">无论使用哪一种适配器来接收数据，通常都必须对该适配器接收到的消息进行处理，然后业务流程才能访问这些消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-137">Whichever adapter is used to receive data, the messages it receives must commonly be processed before they can be accessed by an orchestration.</span></span> <span data-ttu-id="a600f-138">同样，通常需要对业务流程生成的传出消息进行处理，然后适配器才能发送这些消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-138">Similarly, outgoing messages produced by an orchestration often need to be processed before they are sent by an adapter.</span></span>  
  
## <a name="processing-messages-pipelines"></a><span data-ttu-id="a600f-139">处理消息： 管道</span><span class="sxs-lookup"><span data-stu-id="a600f-139">Processing Messages: Pipelines</span></span>  
 <span data-ttu-id="a600f-140">业务流程中涉及的应用程序通过交换各种类型的文档进行通信： 有关示例，采购订单和发票。</span><span class="sxs-lookup"><span data-stu-id="a600f-140">The applications underlying a business process communicate by exchanging various kinds of documents: for examples, purchase orders and  invoices.</span></span> <span data-ttu-id="a600f-141">如果要使用 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 应用程序来执行业务流程，则该应用程序必须能够正确地处理包含这些文档的消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-141">For a [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] application to execute a business process, it must be able to correctly deal with the messages that contain these documents.</span></span> <span data-ttu-id="a600f-142">此处理过程可能包含多个步骤，因此将通过消息管道来执行。</span><span class="sxs-lookup"><span data-stu-id="a600f-142">This processing can involve multiple steps, and hence is performed by a message pipeline.</span></span> <span data-ttu-id="a600f-143">传入消息通过接收管道处理，而传出消息则通过发送管道处理。</span><span class="sxs-lookup"><span data-stu-id="a600f-143">Incoming messages are processed through a receive pipeline, while outgoing messages go through a send pipeline.</span></span>  
  
 <span data-ttu-id="a600f-144">例如，即使越来越多的应用程序已设计为可理解 XML 文档，但目前仍有许多（很可能是大多数）应用程序无法理解 XML 文档。</span><span class="sxs-lookup"><span data-stu-id="a600f-144">For example, even though more applications are being designed to understand XML documents, many—probably the majority today—cannot.</span></span> <span data-ttu-id="a600f-145">由于 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 内部只使用 XML 文档，因此它必须提供一种可实现其他格式与 XML 之间相互转换的方法。</span><span class="sxs-lookup"><span data-stu-id="a600f-145">Because [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] works only with XML documents internally, it must provide a way to convert other formats to and from XML.</span></span> <span data-ttu-id="a600f-146">此外，还可能需要其他服务，例如对消息发送方进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="a600f-146">Other services may also be required, such as authenticating the sender of a message.</span></span> <span data-ttu-id="a600f-147">为了以模块化且可自定义的方式处理这些任务和其他任务，将分若干个阶段来构造管道，其中每个阶段均包含一个或多个启用 .NET 的组件或组件对象模型 (COM) 组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-147">To handle these and other tasks in a modular, yet customizable way, a pipeline is constructed from some number of stages, each of which contains one or more .NET-enabled or Component Object Model (COM) components.</span></span> <span data-ttu-id="a600f-148">每个组件处理特定的消息处理部分。</span><span class="sxs-lookup"><span data-stu-id="a600f-148">Each component handles a particular part of message processing.</span></span> [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]<span data-ttu-id="a600f-149">提供地址的最常见的用例的许多标准组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-149"> provides several standard components that address the most common cases.</span></span> <span data-ttu-id="a600f-150">如果这些组件无法满足需要，开发人员也可以为接收管道和发送管道创建自定义组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-150">If these aren’t sufficient, developers can also create custom components for both receive and send pipelines.</span></span>  
  
 ![](../core/media/understandingbts-05-pipelinereceive.gif "UnderstandingBTS_05_PipelineReceive")  
  
 <span data-ttu-id="a600f-151">上图显示了接收管道中的各个阶段以及为每个阶段提供的标准组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-151">The figure above illustrates the stages in a receive pipeline, along with the standard components provided for each one.</span></span> <span data-ttu-id="a600f-152">这些阶段及其关联组件如下：</span><span class="sxs-lookup"><span data-stu-id="a600f-152">Those stages and their associated components are:</span></span>  
  
-   <span data-ttu-id="a600f-153">解码：[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]对于这一阶段，MIME/SMIME 解码器提供一个标准的组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-153">Decode: [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] provides one standard component for this stage, the MIME/SMIME Decoder.</span></span> <span data-ttu-id="a600f-154">此组件可以处理 MIME 或 Secure MIME (S/MIME) 格式的消息以及消息中包含的任何附件。</span><span class="sxs-lookup"><span data-stu-id="a600f-154">This component can handle messages and any attachments they contain in either MIME or Secure MIME (S/MIME) format.</span></span> <span data-ttu-id="a600f-155">该组件可将这两种类型的消息转换为 XML，还可以对 S/MIME 消息进行解密并验证其数字签名。</span><span class="sxs-lookup"><span data-stu-id="a600f-155">The component converts both types of messages into XML, and it can also decrypt S/MIME messages and verify their digital signatures.</span></span>  
  
-   <span data-ttu-id="a600f-156">反汇编： 提供了三个标准组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-156">Disassemble: Three standard components are provided.</span></span> <span data-ttu-id="a600f-157">平面文件拆装器组件可将平面文件转换为 XML 文档。</span><span class="sxs-lookup"><span data-stu-id="a600f-157">The Flat File Disassembler component turns flat files into XML documents.</span></span> <span data-ttu-id="a600f-158">这些文件可以是位置文件，其中每条记录的长度和结构相同；也可以是分隔文件，这些文件使用指定字符来分隔文件中的记录。</span><span class="sxs-lookup"><span data-stu-id="a600f-158">These files can be positional, where each record has the same length and structure, or delimited, with a designated character used to separate records in the file.</span></span> <span data-ttu-id="a600f-159">第二个标准组件为 XML 拆装器，用于解析已使用 XML 进行说明的传入消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-159">The second standard component, the XML Disassembler, parses incoming messages that are already described using XML.</span></span> <span data-ttu-id="a600f-160">第三个标准组件为 BizTalk 框架拆装器，该组件如今已不常使用。</span><span class="sxs-lookup"><span data-stu-id="a600f-160">The third standard component, one that’s not often used today, is the BizTalk Framework Disassembler.</span></span> <span data-ttu-id="a600f-161">该组件使用 BizTalk 框架定义的可靠消息传送机制来接受所发送的消息， BizTalk 框架是在 BizTalk Server 2000 中实现的 。</span><span class="sxs-lookup"><span data-stu-id="a600f-161">It accepts messages sent using the reliable messaging mechanism defined by the BizTalk Framework, which was implemented in BizTalk Server 2000.</span></span>  
  
-   <span data-ttu-id="a600f-162">验证：[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]对于这一阶段中提供的 XML 验证程序组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-162">Validate: [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] provides an XML Validator component for this stage.</span></span> <span data-ttu-id="a600f-163">顾名思义，此组件可根据指定的架构或架构组对拆装阶段生成的 XML 文档进行验证，如果文档与任一架构不符，则返回错误。</span><span class="sxs-lookup"><span data-stu-id="a600f-163">As its name suggests, this component validates an XML document produced by the Disassemble stage against a specified schema or group of schemas, returning an error if the document doesn’t conform to one of those schemas.</span></span>  
  
-   <span data-ttu-id="a600f-164">解析方： 对此阶段，参与方解析的唯一标准组件尝试确定此消息的发件人的身份。</span><span class="sxs-lookup"><span data-stu-id="a600f-164">Resolve Party: the only standard component for this stage, Party Resolution, attempts to determine an identity for this message’s sender.</span></span> <span data-ttu-id="a600f-165">如果已对消息进行数字签名，则使用该签名在 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 的管理数据库中查找 Windows 标识。</span><span class="sxs-lookup"><span data-stu-id="a600f-165">If the message was digitally signed, the signature is used to look up a Windows identity in the Management database in [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span> <span data-ttu-id="a600f-166">（正如稍后部分中将介绍的一样，BizTalk Server 的管理工具也使用此数据库。）如果消息包含 Windows 用户的已验证安全标识符 (SID)，则使用此标识。</span><span class="sxs-lookup"><span data-stu-id="a600f-166">(As described later, this database is also used by BizTalk Server’s management tools.) If the message carries the authenticated security identifier (SID) of a Windows user, this identity is used.</span></span> <span data-ttu-id="a600f-167">如果这两种机制都无法成功，则为消息发送方分配默认的匿名标识。</span><span class="sxs-lookup"><span data-stu-id="a600f-167">If neither mechanism succeeds, the message’s sender is assigned a default anonymous identity.</span></span>  
  
 ![](../core/media/understandingbts-06-pipelinesend.gif "UnderstandingBTS_06_PipelineSend")  
  
 <span data-ttu-id="a600f-168">按照所使用的发送管道的定义，传出消息可能也要经历多个阶段。</span><span class="sxs-lookup"><span data-stu-id="a600f-168">Outgoing messages can also go through multiple stages, as defined by the send pipeline in use.</span></span> <span data-ttu-id="a600f-169">上图显示了发送管道的各个阶段和标准组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-169">The figure above shows the stages and standard components for a send pipeline.</span></span> <span data-ttu-id="a600f-170">它们分别是：</span><span class="sxs-lookup"><span data-stu-id="a600f-170">They are:</span></span>  
  
-   <span data-ttu-id="a600f-171">预配置： 提供了没有标准的组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-171">Pre-assemble: No standard components are provided.</span></span> <span data-ttu-id="a600f-172">不过，可以根据需要在此处插入自定义组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-172">Instead, custom components can be inserted here as needed.</span></span>  
  
-   <span data-ttu-id="a600f-173">配置： 并行接收管道中的拆装阶段，此阶段还具有三个标准组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-173">Assemble: Paralleling the Disassemble stage in a receive pipeline, this stage also has three standard components.</span></span> <span data-ttu-id="a600f-174">平面文件组装器将 XML 消息转换为位置平面文件或分隔平面文件，XML 组装器则支持向传出 XML 消息添加信封以及对其进行其他更改。</span><span class="sxs-lookup"><span data-stu-id="a600f-174">The Flat File Assembler converts an XML message into a positional or delimited flat file, and the XML Assembler supports adding an envelope and making other changes to an outgoing XML message.</span></span> <span data-ttu-id="a600f-175">第三个组件为 BizTalk 框架组装器，它使用 BizTalk 框架消息传送技术将消息打包以便进行可靠传输。</span><span class="sxs-lookup"><span data-stu-id="a600f-175">The third option, the BizTalk Framework Assembler, packages messages for reliable transmission using the BizTalk Framework messaging technology.</span></span>  
  
-   <span data-ttu-id="a600f-176">进行编码：[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]对于这一阶段，MIME/SMIME 编码器定义只有一个标准的组件。</span><span class="sxs-lookup"><span data-stu-id="a600f-176">Encode: [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] defines only one standard component for this stage, the MIME/SMIME Encoder.</span></span> <span data-ttu-id="a600f-177">此组件以 MIME 或 S/MIME 格式打包传出消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-177">This component packages outgoing messages in either MIME or S/MIME format.</span></span> <span data-ttu-id="a600f-178">如果使用 S/MIME，则还可以对消息进行数字签名和/或加密。</span><span class="sxs-lookup"><span data-stu-id="a600f-178">If S/MIME is used, the message can also be digitally signed and/or encrypted.</span></span>  
  
 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]<span data-ttu-id="a600f-179"> 定义了一些默认管道，其中包括可用于处理以 XML 表示的消息的简单接收/发送对。</span><span class="sxs-lookup"><span data-stu-id="a600f-179"> defines some default pipelines, including a simple receive/send pair that can be used for handling messages that are already expressed in XML.</span></span> <span data-ttu-id="a600f-180">开发人员还可以使用管道设计器来创建自定义管道。</span><span class="sxs-lookup"><span data-stu-id="a600f-180">A developer can also create custom pipelines using the Pipeline Designer.</span></span> <span data-ttu-id="a600f-181">运行在 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 内的此工具提供了一个图形界面，使用该界面，开发人员可以使用任何所需的操作来拖放组件以创建管道。</span><span class="sxs-lookup"><span data-stu-id="a600f-181">This tool, which runs inside [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], provides a graphical interface that enables the developer to drag and drop components to create pipelines with whatever behavior is required.</span></span>  
  
## <a name="choosing-messages-subscriptions"></a><span data-ttu-id="a600f-182">选择消息： 订阅</span><span class="sxs-lookup"><span data-stu-id="a600f-182">Choosing Messages: Subscriptions</span></span>  
 <span data-ttu-id="a600f-183">在消息已通过适配器和接收管道进行传递后，下一步是确定该消息要传递到的目标。</span><span class="sxs-lookup"><span data-stu-id="a600f-183">After a message has made its way through an adapter and a receive pipeline, the next step is to determine where it should go.</span></span> <span data-ttu-id="a600f-184">消息通常以业务流程为目标，但消息也可能直接传递到发送管道，这样就允许将 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 仅用作消息传送系统。</span><span class="sxs-lookup"><span data-stu-id="a600f-184">A message is most often targeted to an orchestration, but it’s also possible for a message to go directly to a send pipeline, allowing [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] to be used as purely a messaging system.</span></span> <span data-ttu-id="a600f-185">无论在哪种情况下，均使用订阅来实现消息与其目标的匹配。</span><span class="sxs-lookup"><span data-stu-id="a600f-185">In either case, this matching of messages with their destinations is done using subscriptions.</span></span>  
  
 <span data-ttu-id="a600f-186">接收管道对消息进行处理后，将创建包含消息的各种属性的消息上下文。</span><span class="sxs-lookup"><span data-stu-id="a600f-186">When a message is processed by a receive pipeline, a message context is created that contains various properties of the message.</span></span> <span data-ttu-id="a600f-187">业务流程或发送管道可以根据这些属性的值来订阅消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-187">An orchestration or a send pipeline can subscribe to messages based on the values of these properties.</span></span> <span data-ttu-id="a600f-188">例如，业务流程可以创建匹配的"发票"的类型的所有消息或从 QwickBank corporation，收到"发票"的类型的所有消息或收到的 QwickBank corporation 的"发票"的类型的所有消息的订阅提供多个 $10000 的。</span><span class="sxs-lookup"><span data-stu-id="a600f-188">For example, an orchestration might create a subscription that matches all messages of the type “Invoice”, or all messages of the type “Invoice” received from the QwickBank corporation, or all messages of the type “Invoice” received from the QwickBank corporation that are for more than $10,000.</span></span> <span data-ttu-id="a600f-189">但是指定了该值，订阅其订阅服务器中返回匹配订阅定义的条件的那些消息。</span><span class="sxs-lookup"><span data-stu-id="a600f-189">However it is specified, a subscription returns to its subscriber only those messages that match the criteria that the subscription defines.</span></span> <span data-ttu-id="a600f-190">接收到的消息可以通过实例化某些业务流程来启动业务流程，也可以激活正在运行的业务流程中的其他步骤。</span><span class="sxs-lookup"><span data-stu-id="a600f-190">A received message might initiate a business process by instantiating some orchestration or it might activate another step in an already running business process.</span></span> <span data-ttu-id="a600f-191">同样，当业务流程发送消息时，会根据发送管道已建立的订阅将消息与发送管道进行匹配。</span><span class="sxs-lookup"><span data-stu-id="a600f-191">Similarly, when an orchestration sends a message, that message is matched to a send pipeline based on a subscription that pipeline has established.</span></span>  
  
-   <span data-ttu-id="a600f-192">在 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] 中，也有可能订阅特定的错误情况。</span><span class="sxs-lookup"><span data-stu-id="a600f-192">In [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)], it is also possible to subscribe to specific error conditions.</span></span> <span data-ttu-id="a600f-193">错误消息可以按特定方式进行处理，也可以路由到特定目标，例如 Windows SharePoint Services 文件夹。</span><span class="sxs-lookup"><span data-stu-id="a600f-193">An error message can be processed in a particular way or routed to a specific destination, such as a Windows SharePoint Services folder.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a600f-194">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a600f-194">See Also</span></span>  
 <span data-ttu-id="a600f-195">[BizTalk Server Messaging Engine](../core/the-biztalk-server-messaging-engine.md) </span><span class="sxs-lookup"><span data-stu-id="a600f-195">[The BizTalk Server Messaging Engine](../core/the-biztalk-server-messaging-engine.md) </span></span>  
 <span data-ttu-id="a600f-196">[发布和订阅体系结构](../core/publish-and-subscribe-architecture.md) </span><span class="sxs-lookup"><span data-stu-id="a600f-196">[Publish and Subscribe Architecture](../core/publish-and-subscribe-architecture.md) </span></span>  
 <span data-ttu-id="a600f-197">[适配器](../core/adapters.md) </span><span class="sxs-lookup"><span data-stu-id="a600f-197">[Adapters](../core/adapters.md) </span></span>  
 [<span data-ttu-id="a600f-198">管道</span><span class="sxs-lookup"><span data-stu-id="a600f-198">Pipelines</span></span>](../core/pipelines.md)