---
title: "EDI 标头和尾部 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 5cf1dae3-9570-413d-a85d-94dcbb561906
caps.latest.revision: "20"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 655a7261da5dc66687fdf0cd623802854c0fa4ef
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="edi-headers-and-trailers"></a><span data-ttu-id="99567-102">EDI 的头部和尾部</span><span class="sxs-lookup"><span data-stu-id="99567-102">EDI Headers and Trailers</span></span>
<span data-ttu-id="99567-103">EDI 交换的各部分由标头和尾部分隔，而标头和尾部必须遵循 X12 或 EDIFACT 标准。</span><span class="sxs-lookup"><span data-stu-id="99567-103">The parts of an EDI interchange are delimited by headers and trailers that must conform to the X12 or EDIFACT standards.</span></span> <span data-ttu-id="99567-104">交换控制标头和尾部只出现一次；功能组和事务集标头和尾部可重复出现，前提是事务集和组在交换内是按批处理的。</span><span class="sxs-lookup"><span data-stu-id="99567-104">The interchange control header and trailer occur just once; the functional group and transaction set headers and trailers are repeated if the transaction sets and groups are batched within the interchange.</span></span> <span data-ttu-id="99567-105">每个标头和尾部均由一系列数据元素组成，这些元素包含有关标头和尾部所含内容的信息。</span><span class="sxs-lookup"><span data-stu-id="99567-105">Each of the headers and trailers consists of a series of data elements that contain information about the content that the header and trailer contain.</span></span>  
  
 <span data-ttu-id="99567-106">X12 和 EDIFACT 的标头和尾部很相似。</span><span class="sxs-lookup"><span data-stu-id="99567-106">The headers and trailers for both X12 and EDIFACT are similar.</span></span> <span data-ttu-id="99567-107">主要区别在于，在 EDIFACT 中，交换中使用的分隔符是在 UNA 服务字符串建议标头中定义的。</span><span class="sxs-lookup"><span data-stu-id="99567-107">The major difference is the UNA Service String Advice header for EDIFACT, which defines the separators used in the interchange.</span></span> <span data-ttu-id="99567-108">而在 X12 编码中，分隔符是在 ISA 交换控制标头中定义的。</span><span class="sxs-lookup"><span data-stu-id="99567-108">In X12 encoding, the separators are defined in the ISA Interchange Control Header.</span></span>  
  
 <span data-ttu-id="99567-109">交换控制和功能组标头和尾部表示为信封段。</span><span class="sxs-lookup"><span data-stu-id="99567-109">The interchange control and functional group headers and trailers are denoted as envelope segments.</span></span> <span data-ttu-id="99567-110">当 BizTalk Server 将传入交换分割成事务集时，它将这些信封段另存为上下文属性。</span><span class="sxs-lookup"><span data-stu-id="99567-110">When BizTalk Server splits an incoming interchange as transaction sets, it saves these envelope segments as context properties.</span></span> <span data-ttu-id="99567-111">对路由非常有用的主要信封属性可作为单独的属性使用。</span><span class="sxs-lookup"><span data-stu-id="99567-111">Key envelope properties that are useful for routing are available as individual properties.</span></span> <span data-ttu-id="99567-112">当保留交换时，不会出现这种情况，此时信封数据属于消息自身的一部分。</span><span class="sxs-lookup"><span data-stu-id="99567-112">This does not occur when the interchange is preserved, in which case the envelope data is part of the message itself.</span></span>  
  
 <span data-ttu-id="99567-113">当 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 生成传出消息时，它根据贸易合作伙伴协议来确定标头和尾部，或者在未确定任何参与方时根据全局协议确定。</span><span class="sxs-lookup"><span data-stu-id="99567-113">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] generates an outgoing message, it bases the headers and trailers on trading partner agreements (or global agreements if no party has been determined).</span></span>  
  
 <span data-ttu-id="99567-114">标头字段和尾部字段，以及用于在交换中分隔它们的分隔符均在两个参与方之间的协议中进行定义。</span><span class="sxs-lookup"><span data-stu-id="99567-114">The header and trailer fields, and the separator characters used to separate them in interchanges, are both defined in the agreement between the two parties.</span></span> <span data-ttu-id="99567-115">按照对协议的规定，切勿在交换、组或事务集的任何头字段或尾字段的定义中使用分隔符。</span><span class="sxs-lookup"><span data-stu-id="99567-115">A separator character must not be used in the definition of any of the interchange, group, or transaction set header or trailer fields, as defined for the agreement.</span></span> <span data-ttu-id="99567-116">如果使用了这样的分隔符，则在作为发送方的 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的 EDI 组装器中或在接收方的拆装器中将无法处理交换。</span><span class="sxs-lookup"><span data-stu-id="99567-116">If they are, the interchange will fail processing either in the EDI Assembler of the sending [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] or in the disassembler of the receiving party.</span></span> <span data-ttu-id="99567-117">如果交换为出站批，它在 EDI 组装器中将失败，因为组装器会根据头控制（服务）架构验证信封。</span><span class="sxs-lookup"><span data-stu-id="99567-117">The interchange will fail in the EDI Assembler if it is an outbound batch, because the Assembler will validate the envelope against the header control (service) schema.</span></span> <span data-ttu-id="99567-118">如果交换未进行批处理，EDI 组装器会将其序列化，但交换在接收协议的拆装器中将无法处理。</span><span class="sxs-lookup"><span data-stu-id="99567-118">If the interchange is unbatched, the EDI Assembler will serialize it, but it will fail processing in the disassembler at the receiving agreement.</span></span>  
  
## <a name="x12-headers-and-trailers"></a><span data-ttu-id="99567-119">X12 的标头和尾部</span><span class="sxs-lookup"><span data-stu-id="99567-119">X12 Headers and Trailers</span></span>  
 <span data-ttu-id="99567-120">X12 编码消息的标头和尾部如下所示：</span><span class="sxs-lookup"><span data-stu-id="99567-120">The headers and trailers for an X12-encoded message are as follows:</span></span>  
  
```  
ISA Interchange Control Header  
  GS Functional Group Header  
    ST Transaction Set Header  
    SE Transaction Set Trailer  
  GE Functional Group Trailer  
IEA Interchange Control Trailer  
```  
  
 <span data-ttu-id="99567-121">如果 ISA 标头后面紧跟 IEA 尾部，则交换为空。</span><span class="sxs-lookup"><span data-stu-id="99567-121">If an ISA header is followed immediately by an IEA trailer, the interchange is empty.</span></span> <span data-ttu-id="99567-122">如果事务集存在，则 GS 标头和 GE 尾部必须存在，否则它们将受条件限制。</span><span class="sxs-lookup"><span data-stu-id="99567-122">If a transaction set exists, the GS header and GE trailer must be present; otherwise, they are conditional.</span></span>  
  
 <span data-ttu-id="99567-123">在 X12 编码的消息中，ISA 交换控制标头字段是固定长度。</span><span class="sxs-lookup"><span data-stu-id="99567-123">The ISA interchange control header fields in an X12-encoded message are of fixed length.</span></span> <span data-ttu-id="99567-124">对于某些字段，可以输入小于字段固定长度的值。</span><span class="sxs-lookup"><span data-stu-id="99567-124">For some of the fields, you can enter a value less than the fixed length of the field.</span></span> <span data-ttu-id="99567-125">如果这样做，交换必须包含尾部空格（对于字符串字段）或前导零（对于数字字段），以便每个字段都具有所需长度。</span><span class="sxs-lookup"><span data-stu-id="99567-125">If you do so, the interchange must contain trailing spaces (for a string field) or leading zeroes (for a numerical field) so that each field is of the required length.</span></span> <span data-ttu-id="99567-126">当创建出站交换时，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 将输入尾部空格或前导零，以便创建长度正确的交换控制标头。</span><span class="sxs-lookup"><span data-stu-id="99567-126">When creating an outbound interchange, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will enter trailing spaces or leading zeroes to create an interchange control header of the right length.</span></span> <span data-ttu-id="99567-127">GS 组标头字段和 ST 事务集标头字段的长度不固定。</span><span class="sxs-lookup"><span data-stu-id="99567-127">The GS group header fields and the ST transaction set header fields are not of fixed length.</span></span>  
  
 <span data-ttu-id="99567-128">在 X12 编码中，功能安全标头、功能保证标头、功能安全值段和功能安全尾部段均超出 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI 和 AS2 的范围。</span><span class="sxs-lookup"><span data-stu-id="99567-128">In X12 encoding, the functional security header, functional assurance header, functional security value segment, and functional security trailer segments are beyond the scope of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI and AS2.</span></span> <span data-ttu-id="99567-129">如果收到具有这些段的交换，则会挂起交换并显示错误日志，指示无法识别这些段。</span><span class="sxs-lookup"><span data-stu-id="99567-129">If an interchange with these segments is received, it will be suspended with an error log indicating that these are unidentified segments.</span></span>  
  
 <span data-ttu-id="99567-130">ST01 字段是事务集 ID 代码；ST02 字段是事务集控制编号。</span><span class="sxs-lookup"><span data-stu-id="99567-130">The ST01 field is the transaction set ID Code; the ST02 field is the transaction set control number.</span></span> <span data-ttu-id="99567-131">ST03 字段是架构版本标识符。</span><span class="sxs-lookup"><span data-stu-id="99567-131">The ST03 field is the schema version identifier.</span></span> <span data-ttu-id="99567-132">SE01 字段指示事务集中包含的段数；SE02 字段与 ST02 字段（事务集控制编号）相同。</span><span class="sxs-lookup"><span data-stu-id="99567-132">The SE01 field indicates the number of segments included in the transaction set; the SE02 field is the same as the ST02 field (the transaction set control number).</span></span> <span data-ttu-id="99567-133">当解析传入消息时，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 将验证事务集中的段数是否与 SE01 字段的值相对应。</span><span class="sxs-lookup"><span data-stu-id="99567-133">When parsing an incoming message, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will verify that the number of segments in the transaction set corresponds to the value of the SE01 field.</span></span> <span data-ttu-id="99567-134">当生成传出消息时，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 会将 SE01 字段设置为事务集中的正确段数。</span><span class="sxs-lookup"><span data-stu-id="99567-134">When generating an outgoing message, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will set the SE01 field to the correct number of segments in the transaction set.</span></span>  
  
 <span data-ttu-id="99567-135">要序列化到传出 EDI 交换中的 XML 事务集应当具有事务集标头和尾部。</span><span class="sxs-lookup"><span data-stu-id="99567-135">An XML transaction set being serialized into an outgoing EDI interchange should have a transaction set header and trailer.</span></span> <span data-ttu-id="99567-136">但是，如果没有事务集标头或尾部，EDI 组装器将处理相应消息。</span><span class="sxs-lookup"><span data-stu-id="99567-136">However, the EDI Assembler will process the message if it does not have a transaction set header or trailer.</span></span> <span data-ttu-id="99567-137">X12 和 EDIFACT 架构中的事务集标头和尾部段对 XML 事务集而言是可选的。</span><span class="sxs-lookup"><span data-stu-id="99567-137">Transaction set header and trailer segments in X12 and EDIFACT schemas are optional for XML transaction sets.</span></span> <span data-ttu-id="99567-138">如果事务没有标头或尾部，则 EDISend 或 AS2EDISend 发送管道中的 EDI 组装器将会向其添加事务集标头和尾部值。</span><span class="sxs-lookup"><span data-stu-id="99567-138">If a transaction does not have a header or trailer, the EDI Assembler in the EDISend or AS2EDISend send pipeline will add transaction set header and trailer values to it.</span></span> <span data-ttu-id="99567-139">这些值将基于映射或计算。</span><span class="sxs-lookup"><span data-stu-id="99567-139">These values will be based on mappings or calculations.</span></span> <span data-ttu-id="99567-140">EDI 组装器将会为交换 XML（保留批）、批处理的事务集 XML 和事务集 XML 执行此操作。</span><span class="sxs-lookup"><span data-stu-id="99567-140">The EDI Assembler will do this for interchange XML (a preserved batch), batched transaction set XML, and transaction set XML.</span></span> <span data-ttu-id="99567-141">有关详细信息，请参阅[X12 事务设置标头和预告片段](../core/how-the-edi-assembler-works.md#BKMK_X12)或[EDIFACT 事务设置标头和预告片段](../core/how-the-edi-assembler-works.md#BKMK_EDIFACT)。</span><span class="sxs-lookup"><span data-stu-id="99567-141">For more information, see [X12 Transaction Set Header and Trailer Segments](../core/how-the-edi-assembler-works.md#BKMK_X12) or [EDIFACT Transaction Set Header and Trailer Segments](../core/how-the-edi-assembler-works.md#BKMK_EDIFACT).</span></span>  
  
## <a name="edifact-headers-and-trailers"></a><span data-ttu-id="99567-142">EDIFACT 的标头和尾部</span><span class="sxs-lookup"><span data-stu-id="99567-142">EDIFACT Headers and Trailers</span></span>  
 <span data-ttu-id="99567-143">EDIFACT 编码消息的标头和尾部如下所示：</span><span class="sxs-lookup"><span data-stu-id="99567-143">The headers and trailers for an EDIFACT-encoded message are as follows:</span></span>  
  
```  
UNA Service String Advice  
UNB Interchange Control Header  
  UNG Functional Group Header  
    UNH Message Header  
    UNT Message Trailer  
  UNE Functional Group Trailer  
UNZ Interchange Control Trailer  
```  
  
 <span data-ttu-id="99567-144">无需 UNA 标头。</span><span class="sxs-lookup"><span data-stu-id="99567-144">The UNA header is not required.</span></span> <span data-ttu-id="99567-145">但 UNB 标头是必需的。</span><span class="sxs-lookup"><span data-stu-id="99567-145">The UNB header is required.</span></span> <span data-ttu-id="99567-146">如果 UNA 标头存在，则其中将包含要在处理传入消息时使用的分隔符，否则将使用为 EfactDelimiters 管道属性定义的分隔符。</span><span class="sxs-lookup"><span data-stu-id="99567-146">If the UNA header is present, it contains the delimiters to use when processing the incoming message; otherwise the separators defined for the EfactDelimiters pipeline property will be used.</span></span>  
  
 <span data-ttu-id="99567-147">如果 UNB 标头后面紧跟 UNZ 尾部，则交换为空。</span><span class="sxs-lookup"><span data-stu-id="99567-147">If a UNB header is followed immediately by a UNZ trailer, the interchange is empty.</span></span> <span data-ttu-id="99567-148">如果 UNG 标头后面紧跟 UNE 尾部，则组为空。</span><span class="sxs-lookup"><span data-stu-id="99567-148">If a UNG header is followed immediately by a UNE trailer, the group is empty.</span></span> <span data-ttu-id="99567-149">UNG 标头和 UNE 尾部对是条件元素，不一定必须出现在消息中。</span><span class="sxs-lookup"><span data-stu-id="99567-149">The UNG header and UNE trailer pair are conditional and do not have to be present in a message.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="99567-150">另请参阅</span><span class="sxs-lookup"><span data-stu-id="99567-150">See Also</span></span>  
 [<span data-ttu-id="99567-151">EDI 消息结构</span><span class="sxs-lookup"><span data-stu-id="99567-151">EDI Message Structure</span></span>](../core/edi-message-structure.md)