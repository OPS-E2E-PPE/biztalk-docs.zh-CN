---
title: 有关消息和实例数据跟踪的安全注意事项 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- permissions, HAT
- MessageBox database, HAT
- Tracking database, HAT
- security, HAT
- HAT, permissions
- HAT, security
- Management database, HAT
ms.assetid: 83e47dc2-c8e2-42a2-9c85-d511e7dae83f
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 3ff40db932a7fa1932830289557e1e0bb71b61c7
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36974566"
---
# <a name="security-considerations-for-message-and-instance-data-tracking"></a><span data-ttu-id="be759-102">消息和实例数据跟踪的安全注意事项</span><span class="sxs-lookup"><span data-stu-id="be759-102">Security Considerations for Message and Instance Data Tracking</span></span>
<span data-ttu-id="be759-103">出于安全方面的原因，消息和服务实例跟踪不使用浏览器或 URL，这与以前版本的 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 不同。</span><span class="sxs-lookup"><span data-stu-id="be759-103">For security reasons, message and service instance tracking does not use browsers or URLs as in previous releases of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="be759-104">此监视选项是作为 BizTalk Server 管理控制台中“组概述”页的一部分包含在内的。</span><span class="sxs-lookup"><span data-stu-id="be759-104">This monitoring option is included as a part of the Group Overview page in the BizTalk Server Administration Console.</span></span>  <span data-ttu-id="be759-105">对于向后兼容性，出于安全方面的原因，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 仍在 shell 中承载 Microsoft Internet Explorer。</span><span class="sxs-lookup"><span data-stu-id="be759-105">For backward compatibility, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] still hosts Microsoft Internet Explorer inside a shell for security reasons.</span></span>  

 <span data-ttu-id="be759-106">通过跟踪消息和服务实例数据，您可以访问疑难解答和优化 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 环境所需的详细技术信息。</span><span class="sxs-lookup"><span data-stu-id="be759-106">By tracking message and service instance data, you can access the technical details necessary to troubleshoot and optimize your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="be759-107">由于此跟踪数据非常强大，因此，应在生产环境中限制访问该数据，以免恶意用户或未经授权用户造成破坏。</span><span class="sxs-lookup"><span data-stu-id="be759-107">Because this tracking data is powerful, you should limit access to it in your production environment so that malicious or unauthorized users do not cause damage.</span></span> <span data-ttu-id="be759-108">建议您遵循以下准则，以便能够在您的环境中安全地使用 BizTalk Server 管理控制台。</span><span class="sxs-lookup"><span data-stu-id="be759-108">It is recommended you follow these guidelines for securing and using the BizTalk Server Administration Console in your environment.</span></span>  

- <span data-ttu-id="be759-109">您必须以 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 操作员组成员身份登录，才能使用 BizTalk Server 管理控制台查看数据。</span><span class="sxs-lookup"><span data-stu-id="be759-109">You must be logged on as a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Operators group to view data using the BizTalk Server Administration Console.</span></span> <span data-ttu-id="be759-110">若要访问 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理控制台的“组概述”部分中的消息主体，您必须以 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理员组成员的身份登录。</span><span class="sxs-lookup"><span data-stu-id="be759-110">To access message bodies in the Group Overview section of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, you must be logged on as a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span>  

   <span data-ttu-id="be759-111">使用消息和服务实例跟踪时，可以访问以下数据库：</span><span class="sxs-lookup"><span data-stu-id="be759-111">When you use message and service instance tracking, you can access the following databases:</span></span>  


  |               <span data-ttu-id="be759-112">“数据库”</span><span class="sxs-lookup"><span data-stu-id="be759-112">Database</span></span>               |                                                                                                   <span data-ttu-id="be759-113">用户组/权限</span><span class="sxs-lookup"><span data-stu-id="be759-113">User Group/Permissions</span></span>                                                                                                   |
  |--------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  |  <span data-ttu-id="be759-114">BizTalk 管理 (BizTalkMgmtDb)</span><span class="sxs-lookup"><span data-stu-id="be759-114">BizTalk Management (BizTalkMgmtDb)</span></span>  |              [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="be759-115"> 管理员、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 操作员</span><span class="sxs-lookup"><span data-stu-id="be759-115"> Administrators, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Operators</span></span>               |
  | <span data-ttu-id="be759-116">BizTalk MessageBox (BizTalkMsgBoxDb)</span><span class="sxs-lookup"><span data-stu-id="be759-116">BizTalk MessageBox (BizTalkMsgBoxDb)</span></span> | [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="be759-117"> 管理员、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 操作员或读写权限</span><span class="sxs-lookup"><span data-stu-id="be759-117"> Administrators, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Operators, or read-write permissions</span></span> |
  |   <span data-ttu-id="be759-118">BizTalk 跟踪 (BizTalkDTADb)</span><span class="sxs-lookup"><span data-stu-id="be759-118">BizTalk Tracking (BizTalkDTADb)</span></span>    | [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="be759-119"> 管理员、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 操作员或只读权限</span><span class="sxs-lookup"><span data-stu-id="be759-119"> Administrators, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Operators, or read-only permissions</span></span>  |


- <span data-ttu-id="be759-120">消息和服务实例跟踪会根据查询参数，生成关于 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 环境中所有主机的报告。</span><span class="sxs-lookup"><span data-stu-id="be759-120">Message and service instance tracking generates reports about all hosts in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment based on the parameters of a query.</span></span> <span data-ttu-id="be759-121">为了将信息泄漏的可能性降至最低，只有 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理员组的成员才能使用 BizTalk Server 管理控制台来执行这些查询。</span><span class="sxs-lookup"><span data-stu-id="be759-121">To minimize the potential of information disclosure, only members of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group can use the BizTalk Server Administration Console to execute these querries.</span></span> <span data-ttu-id="be759-122">但是，如果您不希望所有 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理员都能够访问此跟踪进程生成的数据，可以限制他们对这些数据的访问权限，方法是向 BizTalk 跟踪数据库 (BizTalkDTADb) 中的 HM_EVENT_WRITER 和 BAM_EVENT_WRITER 这两个 SQL Server 角色中添加相应的用户或从中删除这些用户。</span><span class="sxs-lookup"><span data-stu-id="be759-122">However, if you do not want all [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators to have access to the data this tracking process produces, you can limit their access to the data by adding/removing users from the HM_EVENT_WRITER and BAM_EVENT_WRITER SQL Server roles in the BizTalk Tracking (BizTalkDTADb) database.</span></span>  

- <span data-ttu-id="be759-123">BizTalk 使用 BAM_EVENT_WRITER 和 HM_EVENT_WRITER 这两个 SQL Server 角色来授予或拒绝其成员在跟踪数据库中读取/写入跟踪数据的权限，而不通过角色成员身份来授予或拒绝。</span><span class="sxs-lookup"><span data-stu-id="be759-123">BizTalk uses the BAM_EVENT_WRITER and HM_EVENT_WRITER SQL Server roles to grant/deny their members permissions to read/write the tracking data in the Tracking database, but not through role membership.</span></span> <span data-ttu-id="be759-124">请不要删除这两个 SQL Server 角色。</span><span class="sxs-lookup"><span data-stu-id="be759-124">Do not remove these SQL Server roles.</span></span> <span data-ttu-id="be759-125">将跟踪主机更改为非跟踪主机（或与之相反）时，将调用 adm_ChangeHostTrackingPrivilege 存储过程。</span><span class="sxs-lookup"><span data-stu-id="be759-125">When you change a host from hosting to not hosting tracking (or vice versa), the adm_ChangeHostTrackingPrivilege stored procedure is called.</span></span> <span data-ttu-id="be759-126">此存储过程将读取 BAM_EVENT_WRITER 和 HM_EVENT_WRITER 这两个 SQL Server 角色的定义，并将相应的 GRANT/DENY 语句应用于主机 Windows 组。</span><span class="sxs-lookup"><span data-stu-id="be759-126">This stored procedure reads the definition of the BAM_EVENT_WRITER and HM_EVENT_WRITER SQL Server roles and apply the corresponding GRANT/DENY statements to the Host Windows group.</span></span> <span data-ttu-id="be759-127">这与向这两个 SQL 角色添加主机 Windows 组的效果相同。</span><span class="sxs-lookup"><span data-stu-id="be759-127">This achieves the same effect as adding the Host Windows group to these SQL roles.</span></span>  

- <span data-ttu-id="be759-128">如果您配置 BizTalk Server 管理控制台首选项，以从存档数据库查看数据，在这种情况下，跟踪查询将连接到存放存档数据的数据库，而非当前活动的 BizTalk 跟踪数据库 (BizTalkDTADb)。</span><span class="sxs-lookup"><span data-stu-id="be759-128">When you configure the BizTalk Server Administration Console preferences to view data from an archived database, In this case the tracking queries connect to the databases that hold the archived data, not to the currently active BizTalk Tracking (BizTalkDTADb) database.</span></span>  

- <span data-ttu-id="be759-129">您不能跨网络地址转换 (NAT) 防火墙调试实时业务流程。</span><span class="sxs-lookup"><span data-stu-id="be759-129">You cannot debug live orchestrations across Network Address Translation (NAT) firewalls.</span></span> <span data-ttu-id="be759-130">必须在处理域中具有管理计算机，才能调试实时业务流程。</span><span class="sxs-lookup"><span data-stu-id="be759-130">You must have an administration computer on the Processing domain in order to debug live orchestrations.</span></span>  

- <span data-ttu-id="be759-131">根据您对跟踪和管道的配置，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 可能会存储消息上下文中包含的敏感信息。</span><span class="sxs-lookup"><span data-stu-id="be759-131">Depending on how you configure tracking and the pipelines, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] may store sensitive information contained in the message context.</span></span> <span data-ttu-id="be759-132">如果您使用 WMI 或跟踪将消息正文保存到某文件位置，请确保该位置具有加强的任意访问控制列表 (DACL)，以便只有 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理员才具有读取这些消息正文的权限。</span><span class="sxs-lookup"><span data-stu-id="be759-132">If you use WMI or tracking to save message bodies to a file location, ensure that the location has a strong discretionary access control list (DACL) so that only [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators have read permissions to these message bodies.</span></span> <span data-ttu-id="be759-133">请向保存消息正文的所有位置（包括可用来存档和还原消息正文的非 BizTalk 数据库）应用相同的 DACL。</span><span class="sxs-lookup"><span data-stu-id="be759-133">Apply the same DACL to any location you save the message bodies, including non-BizTalk databases where you may archive and restore them.</span></span>  

- <span data-ttu-id="be759-134">必须手动授予 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理员组访问跟踪分析服务器数据库 (BizTalkAnalysisDb) 的权限；默认情况下，只有 OLAP 管理员才具有这种权限。</span><span class="sxs-lookup"><span data-stu-id="be759-134">You must manually grant permissions to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to access the Tracking Analysis Server (BizTalkAnalysisDb) database; by default, only OLAP administrators have permissions to it.</span></span>  

## <a name="see-also"></a><span data-ttu-id="be759-135">请参阅</span><span class="sxs-lookup"><span data-stu-id="be759-135">See Also</span></span>  
 <span data-ttu-id="be759-136">[规划消息和实例跟踪](../core/planning-for-message-and-instance-tracking.md) </span><span class="sxs-lookup"><span data-stu-id="be759-136">[Planning for Message and Instance Tracking](../core/planning-for-message-and-instance-tracking.md) </span></span>  
 [<span data-ttu-id="be759-137">查看跟踪的消息和实例数据</span><span class="sxs-lookup"><span data-stu-id="be759-137">Viewing Tracked Message and Instance Data</span></span>](../core/viewing-tracked-message-and-instance-data.md)