---
title: 如何配置 Windows SharePoint Services 发送端口 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Windows SharePoint Services adapters, send ports
- configuring [Windows SharePoint Services adapters], send ports
- send ports, Windows SharePoint Services adapters
ms.assetid: 7713d3cc-cd8d-43db-8dac-2a7442632b87
caps.latest.revision: 24
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 80519762ea56b3df93e6bb21bafb854e377257bd
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65341939"
---
# <a name="how-to-configure-a-windows-sharepoint-services-send-port"></a>如何配置 Windows SharePoint Services 发送端口
本主题介绍如何创建和使用 BizTalk Server 管理控制台配置 Windows SharePoint Services 发送端口。  

### <a name="to-create-and-configure-a-windows-sharepoint-services-send-port"></a>若要创建和配置 Windows SharePoint Services 发送端口  

1. 在 BizTalk Server 管理控制台中，创建新的发送端口或双击某个现有发送端口以对其进行修改。 有关详细信息，请参阅[如何创建发送端口](../core/how-to-create-a-send-port2.md)。 配置所有发送端口选项，并指定**Windows SharePoint Services 传输属性**有关**类型**选项**传输**部分**常规**选项卡。  

2. 上**常规**选项卡上，在**传输**部分中下, 一步**类型**，单击**配置**。  

3. 在中**Windows SharePoint Services 传输属性**对话框框中，执行以下操作：  


   |              使用此选项               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   执行的操作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |-------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |      适配器 Web 服务端口       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      安装 Windows SharePoint Services 适配器 Web services 的 IIS 网站的 HTTP 端口。 默认情况下，这是端口 80 上配置默认 Web 站点。 如果有任何其他 IIS Web 站点比默认网站上配置 Windows SharePoint Services Web 服务，必须将更新此值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   |               超时               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       以毫秒为单位，用于对 Windows SharePoint Services 适配器 Web services 的适配器运行时 Web 服务调用的超时。 您可能需要增加此值，如果消息或批大小超过适配器预期的平均值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   |       目标文件夹 URL        |                                                                                                                                                                                                                                                                                                                                      Windows SharePoint Services 目标文件夹 URL，相对于 SharePoint 站点。 例如，Shared Documents、 Shared Documents/Purchase Orders / 或 Lists/Tasks。 通过指定的 URL 列表中，例如，Lists/Tasks，可以将消息发送到 SharePoint 列表。 如果您指定为目标的列表，消息正文将不会保存与列表项，但从消息中提取的值仍将升级到 SharePoint 列。 **注意：** 有时，SharePoint 文档库、 列表或文件夹 URL 是不同于该项目的名称。 请查看 Internet Explorer 查找正确的 URL 中的地址栏。                                                                                                                                                                                                                                                                                                                                      |
   |              Filename               |                                                                                                                                                                                                     （可选）Windows SharePoint Services 文件名。 您可以键入如 purchaseorder0001.xml 之类或表达式的文本值。 例如，表达式可以包括文本、 宏和 XPATH 查询的任意组合："PurchOrd-%XPATH=//po:PurchaseOrderId%-%MessageID%.xml". 如果不提供任何文件名称，文件名将为原始文件，如果业务流程未定义的文件名称提供业务流程或 Msg-%MessageID%.xml 的值的名称。 **注意：** 时向列表发送消息，Filename 属性中指定的值将被忽略，并将不会保存在任何 SharePoint 栏。 SharePoint 列表中没有文件名列。 相反，更新标题列使用其中一个可用的 16 列。 <br /><br /> 有关表达式的详细信息，请参阅[Windows SharePoint Services 适配器表达式](../core/windows-sharepoint-services-adapter-expressions.md)。                                                                                                                                                                                                     |
   |         命名空间别名          |                                                                                                                                                                                                                                                                                                                                                                                               （可选）以逗号或分号分隔的命名空间别名定义列表。 使用此字段可以定义等文件名或栏值字段中引入的 XPATH 查询使用的命名空间别名。 例如，po ='<http://OrderProcess/POrder>'，conf ='<http://OrderProcess/Confirmation>' xmlns =""; ipsol = {D8217CF1-4EF7-4bb5-A30D-765ECB09E0D9}。 **注意：** 此属性不会覆盖 WSS。业务流程定义 ConfigNamespacesAliases 消息上下文属性。 而是将合并两个值。                                                                                                                                                                                                                                                                                                                                                                                               |
   |              Overwrite              |                                                                                                                                                                                                                                                                                                                                                                     确定是否覆盖现有文件。 选择是覆盖现有文件。 选择否将引发错误并挂起消息时已存在具有相同名称的文件。 选择重命名重命名该文件。 选择业务流程，可以使用业务流程定义的值。 **注意：** 发送大量消息具有相同名称的覆盖属性设置为 Yes 时可能会导致 SharePoint 错误记录在事件查看器。 这些错误不会影响适配器的功能。 将重试失败的所有消息。                                                                                                                                                                                                                                                                                                                                                                      |
   |         SharePoint 站点 URL         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Windows SharePoint Services 网站的完整的 URL。 例如， http://BizTalkServer/sites/TestSite。 **注意：** URI 发送端口或接收位置不能超过 256 个字符。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |    Microsoft Office 集成     |                                                                                                             Optional 以更改文档，以便在 InfoPath 等 Office 应用程序中自动打开或保存为文档-如果发现没有 InfoPath 解决方案。 是以更改文档，以便在 InfoPath 等 Office 应用程序中自动打开，或如果不找到任何 InfoPath 解决方案，则挂起消息。 是 （InfoPath 表单库） 来更改要使用窗体库中找到，如果将消息发送到 Windows SharePoint Services InfoPath 表单库的 InfoPath 解决方案的 InfoPath 等 Office 应用程序中自动打开的文档。 如果窗体库没有 InfoPath 解决方案，将挂起该消息。 否将文档保存为作为-是无需进行任何更改。 业务流程若要使用业务流程定义的值。 对于二进制消息，否，否则必须使用可选值。 **注意：** 在至少一个属性对模板文档库和 Microsoft Office 集成设置为是时，模板 Namespace 列或模板后备文档库和模板回退 Namespace 列是必需。                                                                                                             |
   |     模板文档库      |                                                                                                                                                                                                                                 输入存储 InfoPath 解决方案的 SharePoint 文档库的名称。  例如，`My Solutions`。 这是适配器将寻找匹配的 InfoPath 解决方案的第一个位置。 如果找不到一种解决方案，适配器将在模板后备文档库中查找。 **注意：** 当模板 Namespace 列字段不为空时，此字段是必需的。 **注意：** 文档库必须具有至少一个类型的单行文本填充与命名空间和可用此 InfoPath 解决方案中，打开的 XML 文档的根节点或只具有根节点的 SharePoint 栏。 有关详细信息，请参阅[演练：模块 2-将集成 Office 与 Windows SharePoint Services 适配器](../core/walkthrough-module-2--integrate-office-with-the-sharepoint-adapter-in-biztalk.md)。                                                                                                                                                                                                                                  |
   | 模板后备文档库 | 输入存储 InfoPath 解决方案的 SharePoint 文档库的名称。  例如，模板。 如果在模板文档库中找不到解决方案，适配器将只搜索匹配的 InfoPath 解决方案此文档库。 模板后备文档库和模板文档库字段可用于两组 InfoPath 解决方案。 有适用于所有通用目的的通用 InfoPath 解决方案和仅用于特定合作伙伴的专用的 InfoPath 解决方案。 模板后备文档库字段应指向通用解决方案，并模板文档库应指向该特定合作伙伴的专用解决方案。 **注意：** 模板后备 Namespace 栏字段不为空时，此字段是必需的。 **注意：** 文档库必须具有至少一个类型的单行文本填充与命名空间和可用此 InfoPath 解决方案中，打开的 XML 文档的根节点或只具有根节点的 SharePoint 栏。 有关详细信息，请参阅[演练：模块 2-将集成 Office 与 Windows SharePoint Services 适配器](../core/walkthrough-module-2--integrate-office-with-the-sharepoint-adapter-in-biztalk.md)。 |
   | 模板后备 Namespace 栏 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      这是存储 InfoPath 解决方案命名空间的模板后备文档库 SharePoint 列的名称。 例如，Namespace。 **注意：** 在模板后备文档库字段不为空时，此字段是必需的。 **注意：** 此字段是区分大小写。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   |     模板 Namespace 列      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               这是存储 InfoPath 解决方案命名空间的模板文档库 SharePoint 栏的名称。 例如，Namespace。 **注意：** 在模板文档库字段不为空时，此字段是必需的。 **注意：** 此字段是区分大小写。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |             列 `n`              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         这是目标文档库中存在的 Windows SharePoint Services 栏的名称。 这是应使用从消息中提取或栏值字段中指定的值来更新列。 **注意：** 可以指定最多 16 个列。 **注意：** 此字段是区分大小写。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |          列`n`值           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             输入要为此消息设置的栏值。 您可以键入如 Purchase Order 或表达式的文本值。 表达式可以包括文本、 宏和 XPATH 查询的任意组合。 例如，"%xpath=//po:poamount%"、"%sendingorchestrationid%"。 **注意：** 可以指定最多 16 个列的值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |


4. 单击**确定**并**确定**次以保存设置。  

## <a name="see-also"></a>请参阅  
 [如何配置 Windows SharePoint Services 接收位置](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md)   
 [如何配置 Windows SharePoint Services 发送处理程序](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md)   
 [如何创建发送端口](../core/how-to-create-a-send-port2.md)   
 [Windows SharePoint Services 适配器属性参考](../core/windows-sharepoint-services-adapter-properties-reference.md)   
 [Windows SharePoint Services 适配器表达式](../core/windows-sharepoint-services-adapter-expressions.md)   
 [支持的 Windows SharePoint Services 栏类型](../core/supported-windows-sharepoint-services-column-types.md)