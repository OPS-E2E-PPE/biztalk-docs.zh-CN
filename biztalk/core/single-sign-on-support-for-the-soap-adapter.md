---
title: 单一登录 SOAP 适配器的支持 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SSO, SOAP adapters
- SOAP adapters, SharePoint Portal Server
- SOAP adapters, SSO
- SharePoint Portal server
ms.assetid: c7bf755c-c37d-4b19-9817-a7f42e1e9656
caps.latest.revision: 18
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 96dfe91651f074649c500ec4e40d6b2c01e649d5
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65247199"
---
# <a name="single-sign-on-support-for-the-soap-adapter"></a><span data-ttu-id="91e5a-102">SOAP 适配器的单一登录支持</span><span class="sxs-lookup"><span data-stu-id="91e5a-102">Single Sign-On Support for the SOAP Adapter</span></span>
<span data-ttu-id="91e5a-103">可以使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台，可将企业单一登录 (SSO) 配置为用于 SOAP 接收位置或发送端口。</span><span class="sxs-lookup"><span data-stu-id="91e5a-103">You can use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console to configure Enterprise Single Sign-On (SSO) for use with the SOAP receive location or send port.</span></span> <span data-ttu-id="91e5a-104">本主题介绍 SSO 与 SOAP 适配器的工作方式。</span><span class="sxs-lookup"><span data-stu-id="91e5a-104">This topic describes how SSO works with the SOAP adapter.</span></span>  
  
 <span data-ttu-id="91e5a-105">**接收位置的 SOAP 的单一登录支持**</span><span class="sxs-lookup"><span data-stu-id="91e5a-105">**Single Sign-On Support for SOAP Receive Locations**</span></span>  
  
 <span data-ttu-id="91e5a-106">SOAP 接收位置支持两个版本的 SSO —[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]企业 SSO 和 Microsoft SharePoint Portal Server SSO。</span><span class="sxs-lookup"><span data-stu-id="91e5a-106">SOAP receive locations support two versions of SSO—[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Enterprise SSO and Microsoft SharePoint Portal Server SSO.</span></span> <span data-ttu-id="91e5a-107">运行 BizTalk Web Services 发布向导来启用对 SharePoint Portal Server SSO 的支持。</span><span class="sxs-lookup"><span data-stu-id="91e5a-107">Run the BizTalk Web Services Publishing Wizard to enable support for SharePoint Portal Server SSO.</span></span> <span data-ttu-id="91e5a-108">有关启用 SharePoint Portal Server SSO 的详细信息，请参阅[发布 Web Services](../core/publishing-web-services.md)。</span><span class="sxs-lookup"><span data-stu-id="91e5a-108">For more information about enabling SharePoint Portal Server SSO, see [Publishing Web Services](../core/publishing-web-services.md).</span></span> <span data-ttu-id="91e5a-109">通过使用 SOAP 接收位置属性页启用 BizTalk 企业单一登录。</span><span class="sxs-lookup"><span data-stu-id="91e5a-109">Enable BizTalk Enterprise Single Sign-On by using the property pages for the SOAP receive location.</span></span> <span data-ttu-id="91e5a-110">有关为 SOAP 接收位置启用企业 SSO 的详细信息，请参阅[如何配置 SOAP 接收位置](../core/how-to-configure-a-soap-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="91e5a-110">For more information about enabling Enterprise SSO for the SOAP receive location, see [How to Configure a SOAP Receive Location](../core/how-to-configure-a-soap-receive-location.md).</span></span>  
  
 <span data-ttu-id="91e5a-111">**企业 SSO 支持对 SOAP 接收位置**</span><span class="sxs-lookup"><span data-stu-id="91e5a-111">**Enterprise SSO Support for SOAP Receive Locations**</span></span>  
  
 <span data-ttu-id="91e5a-112">Internet 信息服务 (IIS) 从 Web 客户端接收的 SOAP 请求，然后 IIS 对用户进行身份验证并传递到 SOAP 适配器的安全标识符。</span><span class="sxs-lookup"><span data-stu-id="91e5a-112">Internet Information Services (IIS) receives a SOAP request from a Web client, and then IIS authenticates the user and passes the security identifier to the SOAP adapter.</span></span> <span data-ttu-id="91e5a-113">如果 IIS 身份验证方法是摘要式身份验证、 基本身份验证或集成 Windows 身份验证，SOAP 适配器将调用 SSO 凭据存储区以获取加密的票证基于经过身份验证的用户。</span><span class="sxs-lookup"><span data-stu-id="91e5a-113">If the IIS authentication method is Digest authentication, Basic authentication, or Integrated Windows Authentication, the SOAP adapter calls the SSO credential store to obtain an encrypted ticket based on the authenticated user.</span></span> <span data-ttu-id="91e5a-114">此票证将被视为**SSOTicket**消息上下文属性中的属性。</span><span class="sxs-lookup"><span data-stu-id="91e5a-114">This ticket is stored as the **SSOTicket** property in the context property of the message.</span></span>  
  
 <span data-ttu-id="91e5a-115">在直通方案中，BizTalk 消息引擎将定向到 MessageBox 数据库的消息。</span><span class="sxs-lookup"><span data-stu-id="91e5a-115">In the pass-through scenario, the BizTalk Messaging Engine directs the message to the MessageBox database.</span></span> <span data-ttu-id="91e5a-116">当发送适配器从 MessageBox 数据库接收消息时，它调用 RedeemTicket 方法使用加密票证和应用程序名称，以从 SSO 存储中检索应用程序的安全凭据。</span><span class="sxs-lookup"><span data-stu-id="91e5a-116">When a send adapter receives the message from the MessageBox database, it calls the RedeemTicket method with the encrypted ticket along with the application name to retrieve the security credentials for the application from the SSO store.</span></span> <span data-ttu-id="91e5a-117">然后，发送适配器使用外部凭据连接到该应用程序并处理该请求。</span><span class="sxs-lookup"><span data-stu-id="91e5a-117">The send adapter then uses the external credentials to connect to the application and process the request.</span></span> <span data-ttu-id="91e5a-118">有关关联应用程序的详细信息，请参阅[SSO 关联应用程序](../core/sso-affiliate-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="91e5a-118">For more information about the affiliate applications, see [SSO Affiliate Applications](../core/sso-affiliate-applications.md).</span></span>  
  
 <span data-ttu-id="91e5a-119">在业务流程调用发送适配器的情况下，BizTalk 消息引擎将消息发送到 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="91e5a-119">In scenarios where an orchestration invokes the send adapter, the BizTalk Messaging Engine sends the message to the MessageBox database.</span></span> <span data-ttu-id="91e5a-120">业务流程应确保同时**SSOTicket**上下文属性和**Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID**是包含该票证在消息上下文属性维护。</span><span class="sxs-lookup"><span data-stu-id="91e5a-120">The orchestration should ensure that both the **SSOTicket** context property and the **Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID** context property of the message that contains the ticket are maintained.</span></span> <span data-ttu-id="91e5a-121">当适配器从 MessageBox 数据库接收此消息时，适配器调用 RedeemTicket 方法使用加密票证以从 SSO 存储中检索后端凭据。</span><span class="sxs-lookup"><span data-stu-id="91e5a-121">When the adapter receives this message from the MessageBox database, the adapter calls the RedeemTicket method with the encrypted ticket to retrieve the back-end credentials from the SSO store.</span></span> <span data-ttu-id="91e5a-122">具体而言，设计该业务流程的用户应将此属性复制到消息。</span><span class="sxs-lookup"><span data-stu-id="91e5a-122">The user designing the orchestration should specifically copy this property to the message.</span></span>  
  
 <span data-ttu-id="91e5a-123">**SharePoint Portal Server SSO 支持对 SOAP 接收位置**</span><span class="sxs-lookup"><span data-stu-id="91e5a-123">**SharePoint Portal Server SSO Support for SOAP Receive Locations**</span></span>  
  
 <span data-ttu-id="91e5a-124">将与 SharePoint Portal Server 集成时[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]支持仅通过 SOAP 适配器使用 Microsoft SharePoint Portal Server SSO。</span><span class="sxs-lookup"><span data-stu-id="91e5a-124">When integrating with SharePoint Portal Server, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] supports the use of Microsoft SharePoint Portal Server SSO only through the SOAP adapter.</span></span> <span data-ttu-id="91e5a-125">SharePoint Portal Server 创建 SSO 票证，并将其发送到 BizTalk Server 中的 SOAP 请求的 SOAP 标头。</span><span class="sxs-lookup"><span data-stu-id="91e5a-125">SharePoint Portal Server creates SSO tickets and sends them to BizTalk Server in a SOAP header of the SOAP request.</span></span> <span data-ttu-id="91e5a-126">当 SOAP 适配器收到包含 SSO 票证请求时，该票证存储作为**SSOTicket**消息上下文属性中的属性。</span><span class="sxs-lookup"><span data-stu-id="91e5a-126">When the SOAP adapter receives a request containing an SSO ticket, the ticket is stored as the **SSOTicket** property in the context property of the message.</span></span> <span data-ttu-id="91e5a-127">此相同的属性会包含的企业 SSO 票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-127">This same property would contain an Enterprise SSO ticket.</span></span> <span data-ttu-id="91e5a-128">只能将一个 SSO 票证与 BizTalk 消息相关联。</span><span class="sxs-lookup"><span data-stu-id="91e5a-128">Only one SSO ticket can be associated with a BizTalk message.</span></span>  
  
 <span data-ttu-id="91e5a-129">在直通和业务流程的情况下，接收从 SharePoint Portal Server SSO 票证的处理时相同 SOAP 适配器使用企业 SSO 创建的票证的。</span><span class="sxs-lookup"><span data-stu-id="91e5a-129">In both pass-through and orchestration scenarios, the handling of an SSO ticket received from SharePoint Portal Server is the same as if the ticket were created by the SOAP adapter using Enterprise SSO.</span></span> <span data-ttu-id="91e5a-130">当发送适配器收到消息时，它将调用**RedeemTicket**方法使用加密票证生成该 SharePoint Portal Server。</span><span class="sxs-lookup"><span data-stu-id="91e5a-130">When a send adapter receives a message, it calls the **RedeemTicket** method with the encrypted ticket that SharePoint Portal Server generated.</span></span> <span data-ttu-id="91e5a-131">发送适配器不需要注意，存在不同的 SSO 票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-131">The send adapter does not need to be aware that different SSO tickets exist.</span></span> <span data-ttu-id="91e5a-132">**RedeemTicket**方法将确定哪种 SSO 系统生成票证，并从相应的位置兑换。</span><span class="sxs-lookup"><span data-stu-id="91e5a-132">The **RedeemTicket** method will determine which SSO system generated the ticket and redeem it from the appropriate place.</span></span>  
  
 <span data-ttu-id="91e5a-133">**组合使用企业 SSO 和 SharePoint Portal Server SSO**</span><span class="sxs-lookup"><span data-stu-id="91e5a-133">**Combined Use of Enterprise SSO and SharePoint Portal Server SSO**</span></span>  
  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="91e5a-134">支持同时使用这两种 SSO 系统。</span><span class="sxs-lookup"><span data-stu-id="91e5a-134">supports the simultaneous use of both SSO systems.</span></span> <span data-ttu-id="91e5a-135">API 可以区分每种 SSO 生成的票证，并将相应的 SSO 数据库中兑换这些。</span><span class="sxs-lookup"><span data-stu-id="91e5a-135">The API can differentiate between the tickets generated by each SSO and will redeem them from the appropriate SSO database.</span></span> <span data-ttu-id="91e5a-136">如果同时使用这两种 SSO 系统，下列规则确定哪种 SSO 票证 SOAP 接收位置将提升为**SSOTicket**上下文属性：</span><span class="sxs-lookup"><span data-stu-id="91e5a-136">If you use both SSO systems at the same time, the following rules determine which SSO ticket the SOAP receive location promotes to the **SSOTicket** context property:</span></span>  
  
- <span data-ttu-id="91e5a-137">如果既不 SSO 已启用，则不会升级票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-137">If neither SSO is enabled, do not promote a ticket.</span></span>  
  
- <span data-ttu-id="91e5a-138">如果启用企业 SSO，但未启用 SharePoint Portal Server SSO，检索并升级企业 SSO 票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-138">If the Enterprise SSO is enabled, but the SharePoint Portal Server SSO is not enabled, retrieve and promote the Enterprise SSO ticket.</span></span>  
  
- <span data-ttu-id="91e5a-139">如果启用 SharePoint Portal Server SSO，但未启用企业 SSO，升级现有的 SharePoint Portal Server SSO 票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-139">If the SharePoint Portal Server SSO is enabled, but the Enterprise SSO is not enabled, promote the existing SharePoint Portal Server SSO ticket.</span></span>  
  
- <span data-ttu-id="91e5a-140">如果启用了企业和 SharePoint Portal Server SSO:</span><span class="sxs-lookup"><span data-stu-id="91e5a-140">If both the Enterprise and SharePoint Portal Server SSO are enabled:</span></span>  
  
  -   <span data-ttu-id="91e5a-141">如果收到的 SharePoint Portal Server SSO 票证，则升级该票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-141">If the SharePoint Portal Server SSO ticket is received, promote that ticket.</span></span>  
  
  -   <span data-ttu-id="91e5a-142">如果未接收到 SharePoint Portal Server SSO 票证，检索并升级企业 SSO 票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-142">If the SharePoint Portal Server SSO ticket is not received, retrieve and promote the Enterprise SSO ticket.</span></span>  
  
  <span data-ttu-id="91e5a-143">**SOAP 发送适配器的单一登录支持**</span><span class="sxs-lookup"><span data-stu-id="91e5a-143">**Single Sign-On Support for the SOAP Send Adapter**</span></span>  
  
  <span data-ttu-id="91e5a-144">如果启用 SSO，则当 SOAP 发送端口收到的消息**Secure**属性 (**SSOTicket**)，它将调用 SSO 服务器以验证并兑换票证关联应用程序。</span><span class="sxs-lookup"><span data-stu-id="91e5a-144">If SSO is enabled, when a SOAP send port receives a message with the **Secure** property (**SSOTicket**), it calls the SSO server to validate and redeem the ticket for an affiliate application.</span></span> <span data-ttu-id="91e5a-145">管理应用程序、 关联管理员或 SSO 关联应用程序的管理员可调用 SSO 以兑换票证。</span><span class="sxs-lookup"><span data-stu-id="91e5a-145">The administration application, affiliate administrators, or SSO administrators for the affiliate application can call SSO to redeem a ticket.</span></span> <span data-ttu-id="91e5a-146">然后，SSO 对票证进行解密，并获取后端凭据。</span><span class="sxs-lookup"><span data-stu-id="91e5a-146">SSO then decrypts the ticket and obtains the back-end credentials.</span></span> <span data-ttu-id="91e5a-147">直通和业务流程方案是相同的 SOAP 发送端口，如本主题的"企业 SSO 支持的 SOAP 接收位置"部分中所述[SOAP 适配器的单一登录支持](../core/single-sign-on-support-for-the-soap-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="91e5a-147">The pass-through and orchestration scenarios are the same for the SOAP send port, as described in the "Enterprise SSO Support for SOAP Receive Locations" section of the topic [Single Sign-On Support for the SOAP Adapter](../core/single-sign-on-support-for-the-soap-adapter.md).</span></span>  
  
  <span data-ttu-id="91e5a-148">默认情况下，SOAP 发送端口不会启用 SSO。</span><span class="sxs-lookup"><span data-stu-id="91e5a-148">By default, the SOAP send port does not enable SSO.</span></span> <span data-ttu-id="91e5a-149">有关为 SOAP 发送端口启用 SSO 的详细信息，请参阅[如何配置 SOAP 发送端口](../core/how-to-configure-a-soap-send-port.md)。</span><span class="sxs-lookup"><span data-stu-id="91e5a-149">For more information about enabling SSO for the SOAP send port, see [How to Configure a SOAP Send Port](../core/how-to-configure-a-soap-send-port.md).</span></span>