---
title: "BizTalk Server 如何实施限制的主机 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- host throttling, rate based throttling
- host throttling, outbound
- host throttling, algorithm
- host throttling, components
- host throttling, inbound
- host throttling, resource based throttling
- host throttling, user controlled throttling
- host throttling, strategies
ms.assetid: 46d3c3de-66b9-4c8a-8369-e68563fc9c40
caps.latest.revision: "27"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1944b61f9710b02f4e6db18a38972849847c532e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="how-biztalk-server-implements-host-throttling"></a><span data-ttu-id="9f10a-102">BizTalk Server 如何实现主机阻止</span><span class="sxs-lookup"><span data-stu-id="9f10a-102">How BizTalk Server Implements Host Throttling</span></span>
<span data-ttu-id="9f10a-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]持续限制机制的主机监视限制条件，计算的重要程度限制条件，并将应用渐进式限制，具体取决于计算严重性的主机。</span><span class="sxs-lookup"><span data-stu-id="9f10a-103">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host throttling mechanism continually monitors for a throttling condition, calculates the severity of the throttling condition, and applies host throttling progressively depending on the calculated severity.</span></span> <span data-ttu-id="9f10a-104">此限制的机制是自我调整和默认配置选项都适用于大多数[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]处理方案。</span><span class="sxs-lookup"><span data-stu-id="9f10a-104">The throttling mechanism is self tuning and the default configuration options are suitable for the majority of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processing scenarios.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="9f10a-105">主机限制公开可用于优化限制用于特定方案的几个可配置选项。</span><span class="sxs-lookup"><span data-stu-id="9f10a-105"> host throttling exposes several configurable options that can be used to tune throttling for specific scenarios.</span></span> <span data-ttu-id="9f10a-106">有关更改这些配置选项的信息，请参阅[如何修改主机设置](../core/how-to-modify-host-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-106">For information about changing these configuration options, see [How to Modify Host Settings](../core/how-to-modify-host-settings.md).</span></span>  
  
## <a name="components-of-the-host-throttling-algorithm"></a><span data-ttu-id="9f10a-107">主机阻止算法的组成部分</span><span class="sxs-lookup"><span data-stu-id="9f10a-107">Components of the host throttling algorithm</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="9f10a-108"> 在应用主机阻止时使用以下算法：</span><span class="sxs-lookup"><span data-stu-id="9f10a-108"> uses the following algorithm when applying host throttling:</span></span>  
  
1.  <span data-ttu-id="9f10a-109">持续监视以下参数以确定它们是否超出特定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-109">Continuously monitor the following parameters to see if they exceed certain thresholds.</span></span> <span data-ttu-id="9f10a-110">如果参数值超出该参数的阈值，则阻止条件成立。</span><span class="sxs-lookup"><span data-stu-id="9f10a-110">If the values for the parameter exceed the threshold for the parameter then a throttling condition exists.</span></span>  
  
    -   <span data-ttu-id="9f10a-111">占用的内存量（系统范围的内存和主机进程内存）。</span><span class="sxs-lookup"><span data-stu-id="9f10a-111">Amount of memory in use (both systemwide and host process memory).</span></span>  
  
    -   <span data-ttu-id="9f10a-112">要送达或处理的进程内消息数（用于出站阻止的阈值）。</span><span class="sxs-lookup"><span data-stu-id="9f10a-112">Number of in-process messages being delivered or processed (threshold for outbound throttling).</span></span>  
  
    -   <span data-ttu-id="9f10a-113">使用的线程数。</span><span class="sxs-lookup"><span data-stu-id="9f10a-113">Number of threads in use.</span></span>  
  
    -   <span data-ttu-id="9f10a-114">数据库大小，按所有主机队列表中的项数以及后台处理和跟踪表中的项数来衡量。</span><span class="sxs-lookup"><span data-stu-id="9f10a-114">Database size, measured by the number of items in the queue tables for all hosts and the number of items in the spool and tracking tables.</span></span>  
  
    -   <span data-ttu-id="9f10a-115">并行数据库连接数。</span><span class="sxs-lookup"><span data-stu-id="9f10a-115">Number of concurrent database connections.</span></span>  
  
    -   <span data-ttu-id="9f10a-116">消息发布（入站）和送达或处理（出站）速率。</span><span class="sxs-lookup"><span data-stu-id="9f10a-116">Rate of message publishing (inbound) and delivery or processing (outbound).</span></span>  
  
2.  <span data-ttu-id="9f10a-117">确定阻止条件的严重性。</span><span class="sxs-lookup"><span data-stu-id="9f10a-117">Determine the severity of the throttling condition.</span></span> <span data-ttu-id="9f10a-118">阻止条件按严重性排列如下（从最严重到最不严重）：</span><span class="sxs-lookup"><span data-stu-id="9f10a-118">Throttling conditions are ranked in severity as follows (from most severe to least severe).</span></span>  
  
    -   <span data-ttu-id="9f10a-119">占用的主机进程内存超出阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-119">Host process memory in use exceeds threshold.</span></span>  
  
    -   <span data-ttu-id="9f10a-120">进程内消息数超出阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-120">Number of in-process messages exceeds threshold.</span></span>  
  
    -   <span data-ttu-id="9f10a-121">使用的线程数超出阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-121">Count of threads in use exceeds threshold.</span></span>  
  
    -   <span data-ttu-id="9f10a-122">数据库大小超出阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-122">Database size exceeds threshold.</span></span>  
  
    -   <span data-ttu-id="9f10a-123">其他所有阻止条件。</span><span class="sxs-lookup"><span data-stu-id="9f10a-123">All other throttling conditions.</span></span>  
  
3.  <span data-ttu-id="9f10a-124">基于阻止条件的严重性以渐进方式应用阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-124">Progressively apply throttling based upon the severity of the throttling condition(s).</span></span> <span data-ttu-id="9f10a-125">随着严重级别的提高，也将更为主动地应用阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-125">Throttling is applied more aggressively as the severity level increases.</span></span> <span data-ttu-id="9f10a-126">渐进式阻止按如下方式来实现：</span><span class="sxs-lookup"><span data-stu-id="9f10a-126">Progressive throttling is achieved as follows:</span></span>  
  
    -   <span data-ttu-id="9f10a-127">检测到一个或多个阻止条件并指定严重性。</span><span class="sxs-lookup"><span data-stu-id="9f10a-127">One or more throttling conditions are detected and assigned a severity.</span></span>  
  
    -   <span data-ttu-id="9f10a-128">基于严重性最高的条件发出实现阻止的指令。</span><span class="sxs-lookup"><span data-stu-id="9f10a-128">An instruction to implement throttling is issued based on the condition with the highest severity.</span></span> <span data-ttu-id="9f10a-129">根据阻止条件，如果该条件持续存在，则可能会降低各种线程池的大小，并可能会通过冻结正在运行的业务流程来释放内存。</span><span class="sxs-lookup"><span data-stu-id="9f10a-129">Depending on the throttling condition, if the condition persists, the size of various thread pools may be reduced and memory may be freed by dehydrating running orchestrations.</span></span>  
  
    -   <span data-ttu-id="9f10a-130">根据消息是入站还是出站，在发布或处理消息时应用延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-130">A delay is applied in the publishing or processing of the message, depending on whether the message is inbound or outbound.</span></span> <span data-ttu-id="9f10a-131">延迟时间的长短与阻止条件的严重性成比例；因此，与严重性较低的阻止条件相比，严重性较高的阻止条件将会产生更长的阻止时间。</span><span class="sxs-lookup"><span data-stu-id="9f10a-131">The delay period is proportional to the severity of the throttling condition, so higher severity throttling conditions will initiate a longer throttling period than lower severity throttling conditions.</span></span> <span data-ttu-id="9f10a-132">随着阻止条件的变化，将根据阻止机制在特定范围内延长和缩短此延迟时间。</span><span class="sxs-lookup"><span data-stu-id="9f10a-132">This delay period is adjusted up and down within certain ranges by the throttling mechanism as conditions change.</span></span> <span data-ttu-id="9f10a-133">通过公开当前延迟期**消息传递的延迟 (ms)**和**消息发布延迟 (ms)**与关联的性能计数器**BizTalk:Message 代理**性能对象类别。</span><span class="sxs-lookup"><span data-stu-id="9f10a-133">The current delay period is exposed through the **Message delivery delay (ms)** and the **Message publishing delay (ms)** performance counters associated with the **BizTalk:Message Agent** performance object category.</span></span> <span data-ttu-id="9f10a-134">这些性能对象计数器记录在该主题[主机限制性能计数器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-134">These performance object counters are documented in the topic [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  
  
    -   <span data-ttu-id="9f10a-135">阻止机制继续检查是否存在阻止条件。</span><span class="sxs-lookup"><span data-stu-id="9f10a-135">The throttling mechanism continues to check if a throttling condition is present.</span></span> <span data-ttu-id="9f10a-136">如果阻止条件得以缓解，则取消对阻止的消息的阻止，并允许线程池和其他资源在不受限制的模式下工作。</span><span class="sxs-lookup"><span data-stu-id="9f10a-136">If the throttling conditions are mitigated then the throttled messages are unblocked and the thread pool and other resources are allowed to operate in an unrestricted mode.</span></span> <span data-ttu-id="9f10a-137">如果系统继续工作并且不存在任何阻止条件，则将大幅度缩短延迟时间。</span><span class="sxs-lookup"><span data-stu-id="9f10a-137">If the system continues to operate without any throttling conditions, the delay period is greatly reduced.</span></span> <span data-ttu-id="9f10a-138">如果阻止条件持续存在，则延迟时间将根据该条件的严重性按比例递增，并对后续消息应用更长时间的延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-138">If the throttling condition persists, the delay amount is incremented proportional to the severity of the condition and subsequent messages are subject to the higher delay.</span></span>  
  
    -   <span data-ttu-id="9f10a-139">如果延迟时间已过，则将不再进行阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-139">Throttling is no longer implemented when the delay period has elapsed.</span></span>  
  
## <a name="type-of-throttling-conditions"></a><span data-ttu-id="9f10a-140">阻止条件的类型</span><span class="sxs-lookup"><span data-stu-id="9f10a-140">Type of throttling conditions</span></span>  
 <span data-ttu-id="9f10a-141">有三种主要类型的限制条件： 速率基于、 基于，资源和业务流程。</span><span class="sxs-lookup"><span data-stu-id="9f10a-141">There are three primary types of throttling conditions: rate based, resource based, and orchestration.</span></span>  
  
1.  <span data-ttu-id="9f10a-142">**限制基于费率**划分为两个类别; （已发布） 的入站和出站 （提供）：</span><span class="sxs-lookup"><span data-stu-id="9f10a-142">**Rate based throttling** is divided into two categories; inbound (published) and outbound (delivered):</span></span>  
  
    -   <span data-ttu-id="9f10a-143">对于入站 （已发布） 的消息，BizTalk Server 限制的消息的发布，如果**消息发布传入速率**主机实例超出**消息发布传出速率\***指定**速率 overdrive 因素 （百分比）**值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-143">For inbound (published) messages, BizTalk Server throttles publishing of messages if The **Message publishing incoming rate** for the host instance exceeds the **Message publishing outgoing rate\*** the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="9f10a-144">**速率 overdrive 因素 （百分比）**参数是可在配置**消息发布限制设置**对话框。</span><span class="sxs-lookup"><span data-stu-id="9f10a-144">The **Rate overdrive factor (percent)** parameter is configurable on the **Message Publishing Throttling Settings** dialog box.</span></span> <span data-ttu-id="9f10a-145">对入站消息进行基于速率的阻止主要是通过在将消息成批发布到 MessageBox 数据库之前引入延迟来实现的。</span><span class="sxs-lookup"><span data-stu-id="9f10a-145">Rate based throttling for inbound messages is accomplished primarily by inducing a delay before publishing the batch of messages into the MessageBox database.</span></span> <span data-ttu-id="9f10a-146">不会采取其他任何措施来实现对入站消息的基于速率的阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-146">No other action is taken to accomplish rate based throttling for inbound messages.</span></span>  
  
    -   <span data-ttu-id="9f10a-147">对于出站 （发送） 的消息，BizTalk Server 限制的消息传送，如果**消息传送传入速率**主机实例超出**传出速率的消息传递** \*指定**速率 overdrive 因素 （百分比）**值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-147">For outbound (delivered) messages, BizTalk Server throttles delivery of messages if The **Message delivery incoming rate** for the host instance exceeds the **Message delivery outgoing rate** \* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="9f10a-148">**速率 overdrive 因素 （百分比）**参数是可在配置**消息处理限制设置**对话框。</span><span class="sxs-lookup"><span data-stu-id="9f10a-148">The **Rate overdrive factor (percent)** parameter is configurable on the **Message Processing Throttling Settings** dialog box.</span></span> <span data-ttu-id="9f10a-149">对出站消息进行基于速率的阻止主要是通过在将消息从内存中队列中删除并将消息送达端点管理器 (EPM) 或业务流程引擎以便进行处理之前引入延迟来实现的。</span><span class="sxs-lookup"><span data-stu-id="9f10a-149">Rate based throttling for outbound messages is accomplished primarily by inducing a delay before removing the messages from the in-memory queue and delivering the messages to the End Point Manager (EPM) or orchestration engine for processing.</span></span> <span data-ttu-id="9f10a-150">不会采取其他任何措施来实现对出站消息的基于速率的阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-150">No other action is taken to accomplish rate based throttling for outbound messages.</span></span>  
  
         <span data-ttu-id="9f10a-151">有关速率 overdrive 因素和其他基于率的限制值的详细信息，请参阅[如何修改速率基于限制设置](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-151">For more information about the rate overdrive factor and other rate-based throttling values, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>  
  
2.  <span data-ttu-id="9f10a-152">**基于资源的限制**监视系统资源，如线程、 内存和数据库大小，并可以应用于任何服务类。</span><span class="sxs-lookup"><span data-stu-id="9f10a-152">**Resource based throttling** monitors system resources such as threads, memory, and database size and can be applied to any service class.</span></span> <span data-ttu-id="9f10a-153">有关基于资源的限制值的详细信息，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-153">For more information about resource-based throttling values, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>  
  
3.  <span data-ttu-id="9f10a-154">**业务流程限制**可以防止冻结和何时暂停/恢复订阅。</span><span class="sxs-lookup"><span data-stu-id="9f10a-154">**Orchestration throttling** can prevent dehydration and when to pause/resume subscriptions.</span></span> <span data-ttu-id="9f10a-155">有关限制值的业务流程的详细信息，请参阅[如何修改业务流程限制设置](../core/how-to-modify-orchestration-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-155">For more information about orchestration throttling values, see [How to Modify Orchestration Throttling Settings](../core/how-to-modify-orchestration-throttling-settings.md).</span></span>  
  
## <a name="throttling-condition-triggers-actions-and-mitigation-strategies"></a><span data-ttu-id="9f10a-156">阻止条件触发器、操作和缓解策略</span><span class="sxs-lookup"><span data-stu-id="9f10a-156">Throttling condition triggers, actions, and mitigation strategies</span></span>  
 <span data-ttu-id="9f10a-157">本部分介绍了各种阻止条件的触发器、阻止机制生成的操作以及可用来缓解阻止条件的措施。</span><span class="sxs-lookup"><span data-stu-id="9f10a-157">This section describes the triggers for various throttling conditions, the resultant actions by the throttling mechanism, and techniques that may be employed to mitigate the throttling condition.</span></span>  
  
### <a name="inbound-throttling"></a><span data-ttu-id="9f10a-158">入站阻止</span><span class="sxs-lookup"><span data-stu-id="9f10a-158">Inbound Throttling</span></span>  
 <span data-ttu-id="9f10a-159">BizTalk 阻止机制对业务流程引擎 (XLANG) 和入站适配器应用入站阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-159">The BizTalk throttling mechanism applies inbound throttling to the orchestration engine (XLANG) and to inbound adapters.</span></span>  
  
 <span data-ttu-id="9f10a-160">使用**限制状态消息发布**和**限制状态持续时间的消息发布**与关联的计数器**BizTalk:MessageAgent**性能要测量的当前限制的状态和持续时间限制的对象类别。</span><span class="sxs-lookup"><span data-stu-id="9f10a-160">Use the **Message publishing throttling state** and **Message publishing throttling state duration** counters associated with **BizTalk:MessageAgent** performance object category to measure the current throttling state and duration of throttling.</span></span> <span data-ttu-id="9f10a-161">有关可用的主机限制性能计数器的详细信息，请参阅[主机限制性能计数器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-161">For more information about the available host throttling performance counters, see [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  
  
 <span data-ttu-id="9f10a-162">入站阻止可导致入站消息在源积压。</span><span class="sxs-lookup"><span data-stu-id="9f10a-162">Inbound throttling can cause inbound messages to backlog at the source.</span></span> <span data-ttu-id="9f10a-163">如果对接收适配器应用入站阻止，则接收适配器可能会停止接收消息，直到阻止条件得以缓解。</span><span class="sxs-lookup"><span data-stu-id="9f10a-163">If inbound throttling is applied to a receive adapter then the receive adapter may stop receiving messages until the throttling condition is mitigated.</span></span>  
  
|<span data-ttu-id="9f10a-164">消息发布</span><span class="sxs-lookup"><span data-stu-id="9f10a-164">Message Publishing</span></span><br /><br /> <span data-ttu-id="9f10a-165">阻止状态</span><span class="sxs-lookup"><span data-stu-id="9f10a-165">throttling state</span></span>|<span data-ttu-id="9f10a-166">阻止条件的触发器</span><span class="sxs-lookup"><span data-stu-id="9f10a-166">Trigger for throttling condition</span></span>|<span data-ttu-id="9f10a-167">采取的阻止操作</span><span class="sxs-lookup"><span data-stu-id="9f10a-167">Throttling actions taken</span></span>|<span data-ttu-id="9f10a-168">缓解策略</span><span class="sxs-lookup"><span data-stu-id="9f10a-168">Mitigation strategy</span></span>|<span data-ttu-id="9f10a-169">性能对象</span><span class="sxs-lookup"><span data-stu-id="9f10a-169">Performance object</span></span>|<span data-ttu-id="9f10a-170">性能计数器</span><span class="sxs-lookup"><span data-stu-id="9f10a-170">Performance counter</span></span>|  
|---------------------------------------------|--------------------------------------|------------------------------|-------------------------|------------------------|-------------------------|  
|<span data-ttu-id="9f10a-171">2</span><span class="sxs-lookup"><span data-stu-id="9f10a-171">2</span></span>|<span data-ttu-id="9f10a-172">**消息发布传入速率**主机实例超出**消息发布传出速率\***指定**速率 overdrive 因素 （百分比）**值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-172">**Message publishing incoming rate** for the host instance exceeds the **Message publishing outgoing rate\*** the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="9f10a-173">数据库无法保持发布速率。</span><span class="sxs-lookup"><span data-stu-id="9f10a-173">The database cannot keep up with the publishing rate.</span></span>|<span data-ttu-id="9f10a-174">在动态计算的时间段内之前阻止发布线程**消息发布的传入速率**位于等同于**消息发布传出速率**\*指定的**速率 overdrive 因素 （百分比）**值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-174">Block the publishing thread for a dynamically computed time period until the **Message Publishing Incoming Rate** is at par with the **Message Publishing Outgoing Rate** \* the specified **Rate overdrive factor (percent)** value.</span></span>|<span data-ttu-id="9f10a-175">使用性能计数器确定消息发布传入速率和消息发布传出速率。</span><span class="sxs-lookup"><span data-stu-id="9f10a-175">Use performance counters to determine the message publishing incoming and message publishing outgoing rate.</span></span> <span data-ttu-id="9f10a-176">为你的环境使用适当的加速因子。</span><span class="sxs-lookup"><span data-stu-id="9f10a-176">Consider an appropriate overdrive factor for your environment.</span></span><br /><br /> <span data-ttu-id="9f10a-177">验证值提供有关**采样窗口持续时间**和**最小样本数**参数适于你的方案。</span><span class="sxs-lookup"><span data-stu-id="9f10a-177">Verify that the values supplied for the **Sampling window duration** and **Minimum number of samples** parameters are appropriate for your scenario.</span></span><br /><br /> <span data-ttu-id="9f10a-178">有关这些参数的详细信息，请参阅[如何修改速率基于限制设置](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-178">For more information about these parameters, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-179">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-179">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-180">Message publishing incoming rate</span><span class="sxs-lookup"><span data-stu-id="9f10a-180">Message publishing incoming rate</span></span><br /><br /> <span data-ttu-id="9f10a-181">Message publishing outgoing rate</span><span class="sxs-lookup"><span data-stu-id="9f10a-181">Message publishing outgoing rate</span></span>|  
|<span data-ttu-id="9f10a-182">4</span><span class="sxs-lookup"><span data-stu-id="9f10a-182">4</span></span>|<span data-ttu-id="9f10a-183">进程内存超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-183">Process memory exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="9f10a-184">如果要发布的批具有很高的内存要求，或者正在处理消息的线程过多，则可能发生此情况。</span><span class="sxs-lookup"><span data-stu-id="9f10a-184">This can occur if the batch to be published has steep memory requirements or too many threads are processing messages</span></span>|<span data-ttu-id="9f10a-185">减少由 EPM 使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-185">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="9f10a-186">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="9f10a-186">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="9f10a-187">如果将批中的消息保存到数据库具有很高的内存要求，则在将消息保存到数据库之前，也会对发布线程应用渐进式延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-187">If there is a steep memory requirement to persist the messages in a batch to the database, the publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span><br /><br /> <span data-ttu-id="9f10a-188">是否出于进程内存压力而阻止发布批取决于多种因素，包括批中的消息数，或者批中是否存在冻结或消息删除命令。</span><span class="sxs-lookup"><span data-stu-id="9f10a-188">Whether the publishing batch will be blocked or not due to process memory pressure depends on several factors including the number of messages in the batch or if there are dehydration or message deletion commands in the batch.</span></span>|<span data-ttu-id="9f10a-189">考虑通过减少 EPM 线程池和/或适配器批的大小来降低负荷量。</span><span class="sxs-lookup"><span data-stu-id="9f10a-189">Consider reducing the amount of load by reducing the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="9f10a-190">如果进程不占用了过多内存，请考虑增加**进程虚拟**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-190">If the process is not consuming excessive memory, consider increasing the **Process virtual** threshold for the host.</span></span><br /><br /> <span data-ttu-id="9f10a-191">有关更改的详细信息**进程虚拟**值，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-191">For more information about changing the **Process virtual** value, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-192">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-192">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-193">High process memory</span><span class="sxs-lookup"><span data-stu-id="9f10a-193">High process memory</span></span><br /><br /> <span data-ttu-id="9f10a-194">进程内存使用率 (MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-194">Process memory usage (MB)</span></span><br /><br /> <span data-ttu-id="9f10a-195">Process memory usage threshold (MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-195">Process memory usage threshold (MB)</span></span>|  
|<span data-ttu-id="9f10a-196">6</span><span class="sxs-lookup"><span data-stu-id="9f10a-196">6</span></span>|<span data-ttu-id="9f10a-197">主机消息队列大小、后台处理表大小或跟踪表大小超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-197">Host message queue size, the spool table size or the tracking table size exceed the specified threshold.</span></span><br /><br /> <span data-ttu-id="9f10a-198">此条件的可能原因包括：</span><span class="sxs-lookup"><span data-stu-id="9f10a-198">Possible reasons for this condition include:</span></span><br /><br /> <span data-ttu-id="9f10a-199">-SQL 代理作业 BizTalk Server 用于维护未运行的 BizTalk Server 数据库，或运行速度变慢。</span><span class="sxs-lookup"><span data-stu-id="9f10a-199">-   The SQL Agent jobs used by BizTalk Server to maintain the BizTalk Server databases not running or are running slowly.</span></span><br /><span data-ttu-id="9f10a-200">-下游组件不会及时处理从内存中队列的消息。</span><span class="sxs-lookup"><span data-stu-id="9f10a-200">-   Down-stream components are not processing messages from the in-memory queue in a timely manner.</span></span><br /><span data-ttu-id="9f10a-201">-挂起的消息数很高。</span><span class="sxs-lookup"><span data-stu-id="9f10a-201">-   Number of suspended messages is high.</span></span><br /><span data-ttu-id="9f10a-202">的已达到最大可持续加载系统。</span><span class="sxs-lookup"><span data-stu-id="9f10a-202">-   Maximum sustainable load for the system has been reached.</span></span>|<span data-ttu-id="9f10a-203">减少由 EPM 使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-203">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="9f10a-204">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="9f10a-204">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="9f10a-205">在将消息保存到数据库之前，也会对发布线程应用渐进式延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-205">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>|<span data-ttu-id="9f10a-206">确保 BizTalk Server 用于维护 BizTalk Server 数据库的 SQL 代理作业正在运行且没有故障。</span><span class="sxs-lookup"><span data-stu-id="9f10a-206">Ensure that the SQL Agent jobs used by BizTalk Server to maintain the BizTalk Server databases are running and are not failing.</span></span><br /><br /> <span data-ttu-id="9f10a-207">根据需要终止和恢复挂起的实例。</span><span class="sxs-lookup"><span data-stu-id="9f10a-207">Terminate and resume suspended instances as needed.</span></span><br /><br /> <span data-ttu-id="9f10a-208">增加的默认值为**消息在数据库中的计数**考虑到保存 BizTalk 数据库的 SQL server 的空间要求的阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-208">Increase the default value for the **Message count in DB** threshold taking into consideration the space requirements of the SQL server that houses the BizTalk databases.</span></span><br /><br /> <span data-ttu-id="9f10a-209">如果你的数据库是适当地设置大小以处理额外的消息积压工作，请考虑增加**假脱机乘数**和**跟踪数据乘数**值，以允许在假脱机中使用其他积压工作和跟踪表。</span><span class="sxs-lookup"><span data-stu-id="9f10a-209">If your database is sized appropriately to handle additional message backlog, consider increasing the **Spool multiplier** and **Tracking data multiplier** values to allow additional backlog in the Spool and Tracking tables.</span></span><br /><br /> <span data-ttu-id="9f10a-210">有关更改的值的详细信息，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-210">For more information about changing the values, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-211">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-211">BizTalk:MessageAgent</span></span><br /><br /> <span data-ttu-id="9f10a-212">BizTalk:Message Box:General Counters </span><span class="sxs-lookup"><span data-stu-id="9f10a-212">BizTalk:Message Box:General Counters</span></span><br /><br /> <span data-ttu-id="9f10a-213">BizTalk:Message Box:Host Counters</span><span class="sxs-lookup"><span data-stu-id="9f10a-213">BizTalk:Message Box:Host Counters</span></span>|<span data-ttu-id="9f10a-214">MessageAgent /Database size</span><span class="sxs-lookup"><span data-stu-id="9f10a-214">MessageAgent /Database size</span></span><br /><br /> <span data-ttu-id="9f10a-215">Message Box:General Counters /Spool size</span><span class="sxs-lookup"><span data-stu-id="9f10a-215">Message Box:General Counters /Spool size</span></span><br /><br /> <span data-ttu-id="9f10a-216">Message Box:General Counters /Tracking data size</span><span class="sxs-lookup"><span data-stu-id="9f10a-216">Message Box:General Counters /Tracking data size</span></span><br /><br /> <span data-ttu-id="9f10a-217">Message Box:Host Counters/Host queue – length</span><span class="sxs-lookup"><span data-stu-id="9f10a-217">Message Box:Host Counters/Host queue – length</span></span><br /><br /> <span data-ttu-id="9f10a-218">Message Box:Host Counters/Host queue - suspended msgs – length</span><span class="sxs-lookup"><span data-stu-id="9f10a-218">Message Box:Host Counters/Host queue - suspended msgs – length</span></span>|  
|<span data-ttu-id="9f10a-219">8</span><span class="sxs-lookup"><span data-stu-id="9f10a-219">8</span></span>|<span data-ttu-id="9f10a-220">主机实例使用的数据库会话数超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-220">Database sessions being used by the host instance exceed the specified threshold.</span></span>|<span data-ttu-id="9f10a-221">减少由 EPM 使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-221">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="9f10a-222">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="9f10a-222">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="9f10a-223">在将消息保存到数据库之前，也会对发布线程应用渐进式延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-223">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>|<span data-ttu-id="9f10a-224">请考虑增加**数据库连接**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-224">Consider increasing the **Database connections** threshold for the host.</span></span><br /><br /> <span data-ttu-id="9f10a-225">更改此值的详细信息，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-225">For more information on changing this value, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-226">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-226">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-227">Database session</span><span class="sxs-lookup"><span data-stu-id="9f10a-227">Database session</span></span>|  
|<span data-ttu-id="9f10a-228">9</span><span class="sxs-lookup"><span data-stu-id="9f10a-228">9</span></span>|<span data-ttu-id="9f10a-229">进程线程数超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-229">Process thread count exceeds the specified threshold.</span></span>|<span data-ttu-id="9f10a-230">减少由 EPM 使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-230">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="9f10a-231">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="9f10a-231">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="9f10a-232">在将消息保存到数据库之前，也会对发布线程应用渐进式延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-232">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>|<span data-ttu-id="9f10a-233">考虑调整不同线程池的大小，以确保系统不会创建大量线程。</span><span class="sxs-lookup"><span data-stu-id="9f10a-233">Consider adjusting the different thread pool sizes to ensure that the system does not create a large number of threads.</span></span><br /><br /> <span data-ttu-id="9f10a-234">有关修改线程池大小的详细信息，请参阅[如何修改常规设置](../core/how-to-modify-general-settings.md)和[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-234">For more information about modifying the thread pool sizes, see [How to Modify General Settings](../core/how-to-modify-general-settings.md) and [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-235">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-235">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-236">Thread count</span><span class="sxs-lookup"><span data-stu-id="9f10a-236">Thread count</span></span><br /><br /> <span data-ttu-id="9f10a-237">Thread count threshold</span><span class="sxs-lookup"><span data-stu-id="9f10a-237">Thread count threshold</span></span>|  
|<span data-ttu-id="9f10a-238">5</span><span class="sxs-lookup"><span data-stu-id="9f10a-238">5</span></span>|<span data-ttu-id="9f10a-239">系统内存超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-239">System memory exceeds the specified threshold.</span></span>|<span data-ttu-id="9f10a-240">减少由 EPM 使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-240">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="9f10a-241">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="9f10a-241">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="9f10a-242">如果将批中的消息保存到数据库具有很高的内存要求，则在将消息保存到数据库之前，也会对发布线程应用渐进式延迟。</span><span class="sxs-lookup"><span data-stu-id="9f10a-242">If there is a steep memory requirement to persist the messages in a batch to the database, the publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span><br /><br /> <span data-ttu-id="9f10a-243">是否出于进程内存压力而阻止发布批取决于多种因素，包括批中的消息数，或者批中是否存在冻结或消息删除命令。</span><span class="sxs-lookup"><span data-stu-id="9f10a-243">Whether the publishing batch will be blocked or not due to process memory pressure depends on several factors including the number of messages in the batch or if there are dehydration or message deletion commands in the batch.</span></span>|<span data-ttu-id="9f10a-244">考虑通过减少 EPM 线程池的默认大小和/或适配器批的大小来降低负荷量。</span><span class="sxs-lookup"><span data-stu-id="9f10a-244">Consider reducing load by reducing the default size of the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="9f10a-245">如果进程不占用了过多内存，请考虑增加**全局物理**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-245">If the process is not consuming excessive memory, consider increasing the **Global Physical** threshold for the host.</span></span><br /><br /> <span data-ttu-id="9f10a-246">有关详细信息更改**全局物理**阈值，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-246">For more information on changing the **Global Physical** threshold, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-247">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-247">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-248">Physical memory usage (MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-248">Physical memory usage (MB)</span></span><br /><br /> <span data-ttu-id="9f10a-249">Physical memory usage threshold (MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-249">Physical memory usage threshold (MB)</span></span>|  
  
### <a name="outbound-throttling"></a><span data-ttu-id="9f10a-250">出站阻止</span><span class="sxs-lookup"><span data-stu-id="9f10a-250">Outbound Throttling</span></span>  
 <span data-ttu-id="9f10a-251">BizTalk 阻止机制对业务流程引擎 (XLANG) 和出站适配器应用出站阻止。</span><span class="sxs-lookup"><span data-stu-id="9f10a-251">The BizTalk throttling mechanism applies outbound throttling to the orchestration engine (XLANG) and to outbound adapters.</span></span>  
  
 <span data-ttu-id="9f10a-252">使用**限制状态的消息传递**和**限制状态持续时间的消息传递**与关联的计数器**BizTalk:MessageAgent**性能对象若要测量的当前限制的状态和持续时间限制的类别。</span><span class="sxs-lookup"><span data-stu-id="9f10a-252">Use the **Message delivery throttling state** and **Message delivery throttling state duration** counters associated with **BizTalk:MessageAgent** performance object category to measure the current throttling state and duration of throttling.</span></span> <span data-ttu-id="9f10a-253">有关可用的主机限制性能计数器请参阅[主机限制性能计数器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-253">For more information about the available host throttling performance counters see [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  
  
 <span data-ttu-id="9f10a-254">出站阻止可能导致消息送达延迟，消息可能会在内存中队列中堆积，并可能导致出列线程被阻止，直到阻止条件得以缓解。</span><span class="sxs-lookup"><span data-stu-id="9f10a-254">Outbound throttling can cause delayed message delivery and messages may build up in the in-memory queue and cause de-queue threads to be blocked until the throttling condition is mitigated.</span></span> <span data-ttu-id="9f10a-255">当出列线程被阻止后，不会从 MessageBox 中请求任何其他消息放入内存中队列中以进行出站送达。</span><span class="sxs-lookup"><span data-stu-id="9f10a-255">When de-queue threads are blocked no additional messages are pulled from the MessageBox into the in-memory queue for outbound delivery.</span></span>  
  
|<span data-ttu-id="9f10a-256">消息送达</span><span class="sxs-lookup"><span data-stu-id="9f10a-256">Message Delivery</span></span><br /><br /> <span data-ttu-id="9f10a-257">阻止状态</span><span class="sxs-lookup"><span data-stu-id="9f10a-257">throttling state</span></span>|<span data-ttu-id="9f10a-258">阻止条件的触发器</span><span class="sxs-lookup"><span data-stu-id="9f10a-258">Trigger for throttling condition</span></span>|<span data-ttu-id="9f10a-259">采取的阻止操作</span><span class="sxs-lookup"><span data-stu-id="9f10a-259">Throttling actions taken</span></span>|<span data-ttu-id="9f10a-260">缓解策略</span><span class="sxs-lookup"><span data-stu-id="9f10a-260">Mitigation Strategy</span></span>|<span data-ttu-id="9f10a-261">性能对象</span><span class="sxs-lookup"><span data-stu-id="9f10a-261">Performance Object</span></span>|<span data-ttu-id="9f10a-262">性能计数器</span><span class="sxs-lookup"><span data-stu-id="9f10a-262">Performance Counter</span></span>|  
|-------------------------------------------|--------------------------------------|------------------------------|-------------------------|------------------------|-------------------------|  
|<span data-ttu-id="9f10a-263">1</span><span class="sxs-lookup"><span data-stu-id="9f10a-263">1</span></span>|<span data-ttu-id="9f10a-264">**消息传送传入速率**主机实例超出**传出速率的消息传递\***指定**速率 overdrive 因素 （百分比）**值</span><span class="sxs-lookup"><span data-stu-id="9f10a-264">**Message delivery incoming rate** for the host instance exceeds the **Message delivery outgoing rate \*** the specified **Rate overdrive factor (percent)** value</span></span><br /><br /> <span data-ttu-id="9f10a-265">如果处理复杂度太高，出站适配器速度太慢或者系统资源出现暂时短缺，都会导致此情况。</span><span class="sxs-lookup"><span data-stu-id="9f10a-265">This can be caused by high processing complexity, slow outbound adapters, or a momentary shortage of system resources.</span></span>|<span data-ttu-id="9f10a-266">直到传入速率位于等同于消息传递在动态计算的时间段内阻止传递线程**传出速率的消息传递\***指定**速率据以加快因素 （百分比）**值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-266">Block the delivery thread for a dynamically computed time period until the Message delivery incoming rate is at par with the **Message delivery outgoing rate \*** the specified **Rate overdrive factor (percent)** value.</span></span>|<span data-ttu-id="9f10a-267">使用性能计数器确定消息送达传入速率和消息送达传出速率。</span><span class="sxs-lookup"><span data-stu-id="9f10a-267">Use performance counters to determine the message delivery incoming and message delivery outgoing rate.</span></span> <span data-ttu-id="9f10a-268">请考虑适当针对你的环境的驱动器因素。</span><span class="sxs-lookup"><span data-stu-id="9f10a-268">Consider an appropriate over drive factor for your environment.</span></span><br /><br /> <span data-ttu-id="9f10a-269">验证值提供有关**采样窗口持续时间**和**最小样本数**参数适于你的方案。</span><span class="sxs-lookup"><span data-stu-id="9f10a-269">Verify that the values supplied for the **Sampling window duration** and **Minimum number of samples** parameters are appropriate for your scenario.</span></span><br /><br /> <span data-ttu-id="9f10a-270">有关这些参数的详细信息，请参阅[如何修改速率基于限制设置](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-270">For more information about these parameters, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-271">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-271">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-272">Message delivery incoming rate</span><span class="sxs-lookup"><span data-stu-id="9f10a-272">Message delivery incoming rate</span></span><br /><br /> <span data-ttu-id="9f10a-273">Message publishing outgoing rate</span><span class="sxs-lookup"><span data-stu-id="9f10a-273">Message publishing outgoing rate</span></span>|  
|<span data-ttu-id="9f10a-274">4</span><span class="sxs-lookup"><span data-stu-id="9f10a-274">4</span></span>|<span data-ttu-id="9f10a-275">进程内存超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-275">Process memory exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="9f10a-276">在需要占用大量内存的处理方案中、在处理大量消息时或者在发送适配器尝试同时处理大量消息时可能发生此情况。</span><span class="sxs-lookup"><span data-stu-id="9f10a-276">This can occur in memory intensive processing scenarios, when processing large messages, or when send adapters are attempting to process a high number of messages simultaneously.</span></span>|<span data-ttu-id="9f10a-277">降低向适配器或 XLANG 的消息送达速度。</span><span class="sxs-lookup"><span data-stu-id="9f10a-277">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="9f10a-278">根据需要，通过冻结服务实例和缩减缓存来降低进程内存占用率。</span><span class="sxs-lookup"><span data-stu-id="9f10a-278">Reduce process memory consumption by dehydrating service instances and shrinking cache when applicable.</span></span><br /><br /> <span data-ttu-id="9f10a-279">减少由 EPM 和/或消息代理使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-279">Reduce the size of the thread pools used by the EPM and/or the Message Agent.</span></span><br /><br /> <span data-ttu-id="9f10a-280">定期强制执行 .NET 垃圾回收 (GC)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-280">Periodically force a .NET garbage collection (GC).</span></span>|<span data-ttu-id="9f10a-281">如果系统由于基于进程内存的阻止而没有处于空闲状态，则可能无需采取任何操作。</span><span class="sxs-lookup"><span data-stu-id="9f10a-281">If the system is not becoming idle due to process memory based throttling, no action may be required.</span></span><br /><br /> <span data-ttu-id="9f10a-282">如果**进程内消息计数**计数器值较高和 CPU 使用率是否即使在没有进程内存限制基于，任何其他操作可能需要过大。</span><span class="sxs-lookup"><span data-stu-id="9f10a-282">If the **In-process message count** counter is high and the CPU utilization is not excessive even when there is process memory based throttling, no additional action may be required.</span></span><br /><br /> <span data-ttu-id="9f10a-283">如果系统看起来过度限制，请考虑增加与关联的值**进程虚拟**主机的阈值，并验证主机实例不会生成"内存不足"错误。</span><span class="sxs-lookup"><span data-stu-id="9f10a-283">If the system appears to be over-throttling, consider increasing the value associated with the **Process virtual** threshold for the host and verify that the host instance does not generate an "out of memory" error.</span></span> <span data-ttu-id="9f10a-284">如果通过增加引发"内存不足"错误**进程虚拟**阈值，请考虑减少的值**内部消息队列大小**和**进程内消息**阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-284">If an "out of memory" error is raised by increasing the **Process virtual** threshold, then consider reducing the values for the **Internal message queue size** and **In-process messages** thresholds.</span></span> <span data-ttu-id="9f10a-285">此策略特别适用于大型消息处理方案。</span><span class="sxs-lookup"><span data-stu-id="9f10a-285">This strategy is particularly relevant in large message processing scenarios.</span></span><br /><br /> <span data-ttu-id="9f10a-286">有关这些参数的详细信息，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-286">For more information about these parameters, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-287">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-287">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-288">High process memory</span><span class="sxs-lookup"><span data-stu-id="9f10a-288">High process memory</span></span><br /><br /> <span data-ttu-id="9f10a-289">Process memory usage(MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-289">Process memory usage(MB)</span></span><br /><br /> <span data-ttu-id="9f10a-290">Process memory usage threshold (MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-290">Process memory usage threshold (MB)</span></span><br /><br /> <span data-ttu-id="9f10a-291">In-process message count</span><span class="sxs-lookup"><span data-stu-id="9f10a-291">In-process message count</span></span><br /><br /> <span data-ttu-id="9f10a-292">Active instance count</span><span class="sxs-lookup"><span data-stu-id="9f10a-292">Active instance count</span></span>|  
|<span data-ttu-id="9f10a-293">3</span><span class="sxs-lookup"><span data-stu-id="9f10a-293">3</span></span>|<span data-ttu-id="9f10a-294">送达服务类别的进程内消息数超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-294">Number of in-process messages delivered to a service class exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="9f10a-295">如果处理复杂度太高，出站适配器速度太慢或者系统资源出现暂时短缺，都会导致此情况。</span><span class="sxs-lookup"><span data-stu-id="9f10a-295">This can be caused by high processing complexity, slow outbound adapters, or a momentary shortage of system resources.</span></span>|<span data-ttu-id="9f10a-296">降低向适配器或 XLANG 的消息送达速度。</span><span class="sxs-lookup"><span data-stu-id="9f10a-296">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="9f10a-297">减少由消息代理使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-297">Reduce the size of the thread pool used by the Message Agent.</span></span>|<span data-ttu-id="9f10a-298">如果发生过度限制，请考虑增加与关联的值**进程内消息**阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-298">If over-throttling occurs, consider increasing the value associated with the **In-process messages** threshold.</span></span><br /><br /> <span data-ttu-id="9f10a-299">有关此参数的详细信息，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)**注意：**增加此值可能产生负面影响发送适配器性能和/或增加内存进程使用。</span><span class="sxs-lookup"><span data-stu-id="9f10a-299">For more information about this parameter, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md) **Note:**  Increasing this value may adversely impact send adapter performance and/or increase the memory usage of the process.</span></span>|<span data-ttu-id="9f10a-300">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-300">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-301">In-process message count</span><span class="sxs-lookup"><span data-stu-id="9f10a-301">In-process message count</span></span><br /><br /> <span data-ttu-id="9f10a-302">In-process message count threshold</span><span class="sxs-lookup"><span data-stu-id="9f10a-302">In-process message count threshold</span></span>|  
|<span data-ttu-id="9f10a-303">9</span><span class="sxs-lookup"><span data-stu-id="9f10a-303">9</span></span>|<span data-ttu-id="9f10a-304">进程线程数超出指定阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-304">Process thread count exceeds the specified threshold.</span></span>|<span data-ttu-id="9f10a-305">减少由 EPM 和/或消息代理使用的线程池的大小</span><span class="sxs-lookup"><span data-stu-id="9f10a-305">Reduce the size of the thread pools used by the EPM and/or the Message Agent</span></span>|<span data-ttu-id="9f10a-306">考虑调整不同线程池的大小，以确保系统不会创建大量线程。</span><span class="sxs-lookup"><span data-stu-id="9f10a-306">Consider adjusting the different thread pool sizes to ensure that the system does not create a large number of threads.</span></span><br /><br /> <span data-ttu-id="9f10a-307">有关修改线程池大小的详细信息，请参阅[如何修改常规设置](../core/how-to-modify-general-settings.md)和[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-307">For more information about modifying the thread pool sizes, see [How to Modify General Settings](../core/how-to-modify-general-settings.md) and [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-308">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-308">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-309">Thread count</span><span class="sxs-lookup"><span data-stu-id="9f10a-309">Thread count</span></span><br /><br /> <span data-ttu-id="9f10a-310">Thread count threshold</span><span class="sxs-lookup"><span data-stu-id="9f10a-310">Thread count threshold</span></span>|  
|<span data-ttu-id="9f10a-311">5</span><span class="sxs-lookup"><span data-stu-id="9f10a-311">5</span></span>|<span data-ttu-id="9f10a-312">系统内存超出阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-312">System memory exceeds a threshold.</span></span>|<span data-ttu-id="9f10a-313">降低向适配器或 XLANG 的消息送达速度。</span><span class="sxs-lookup"><span data-stu-id="9f10a-313">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="9f10a-314">根据需要，通过冻结服务实例和缩减缓存来降低进程内存占用率。</span><span class="sxs-lookup"><span data-stu-id="9f10a-314">Reduce process memory consumption by dehydrating service instances and shrinking cache when applicable.</span></span><br /><br /> <span data-ttu-id="9f10a-315">减少由 EPM 和/或消息代理使用的线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="9f10a-315">Reduce the size of the thread pools used by the EPM and/or the Message Agent.</span></span>|<span data-ttu-id="9f10a-316">考虑通过减少 EPM 线程池的默认大小和/或适配器批的大小来降低负荷量。</span><span class="sxs-lookup"><span data-stu-id="9f10a-316">Consider reducing load by reducing the default size of the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="9f10a-317">如果进程不占用了过多内存，请考虑增加**全局物理**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="9f10a-317">If the process is not consuming excessive memory, consider increasing the **Global Physical** threshold for the host.</span></span><br /><br /> <span data-ttu-id="9f10a-318">有关更改的详细信息**全局物理**阈值，请参阅[如何修改资源基于限制设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="9f10a-318">For more information about changing the **Global Physical** threshold, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>|<span data-ttu-id="9f10a-319">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="9f10a-319">BizTalk:MessageAgent</span></span>|<span data-ttu-id="9f10a-320">Physical memory usage (MB)</span><span class="sxs-lookup"><span data-stu-id="9f10a-320">Physical memory usage (MB)</span></span>|