---
title: BizTalk Server 如何实现主机阻止 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- host throttling, rate based throttling
- host throttling, outbound
- host throttling, algorithm
- host throttling, components
- host throttling, inbound
- host throttling, resource based throttling
- host throttling, user controlled throttling
- host throttling, strategies
ms.assetid: 46d3c3de-66b9-4c8a-8369-e68563fc9c40
caps.latest.revision: 27
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 659e4f9db894a9a822d50b1a5e0bc2a7e2850dcb
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65387514"
---
# <a name="how-biztalk-server-implements-host-throttling"></a><span data-ttu-id="a2580-102">BizTalk Server 如何实现主机阻止</span><span class="sxs-lookup"><span data-stu-id="a2580-102">How BizTalk Server Implements Host Throttling</span></span>
<span data-ttu-id="a2580-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]主机阻止机制不断监视阻止条件，计算阻止条件的严重性和应用主机阻止以渐进方式具体取决于计算出的严重性。</span><span class="sxs-lookup"><span data-stu-id="a2580-103">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host throttling mechanism continually monitors for a throttling condition, calculates the severity of the throttling condition, and applies host throttling progressively depending on the calculated severity.</span></span> <span data-ttu-id="a2580-104">该阻止机制具有自我优化和默认配置选项都适用于大多数[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]处理方案。</span><span class="sxs-lookup"><span data-stu-id="a2580-104">The throttling mechanism is self tuning and the default configuration options are suitable for the majority of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processing scenarios.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="a2580-105">主机阻止公开可用于优化限制为特定方案的多个可配置选项。</span><span class="sxs-lookup"><span data-stu-id="a2580-105">host throttling exposes several configurable options that can be used to tune throttling for specific scenarios.</span></span> <span data-ttu-id="a2580-106">有关更改这些配置选项的信息，请参阅[如何修改主机设置](../core/how-to-modify-host-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-106">For information about changing these configuration options, see [How to Modify Host Settings](../core/how-to-modify-host-settings.md).</span></span>  

## <a name="components-of-the-host-throttling-algorithm"></a><span data-ttu-id="a2580-107">主机阻止算法的组件</span><span class="sxs-lookup"><span data-stu-id="a2580-107">Components of the host throttling algorithm</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="a2580-108">应用主机阻止时，请使用以下算法：</span><span class="sxs-lookup"><span data-stu-id="a2580-108">uses the following algorithm when applying host throttling:</span></span>  

1.  <span data-ttu-id="a2580-109">持续监视以下参数以确定它们是否超出特定阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-109">Continuously monitor the following parameters to see if they exceed certain thresholds.</span></span> <span data-ttu-id="a2580-110">如果参数的值超出该参数的阈值则存在阻止条件。</span><span class="sxs-lookup"><span data-stu-id="a2580-110">If the values for the parameter exceed the threshold for the parameter then a throttling condition exists.</span></span>  

    -   <span data-ttu-id="a2580-111">使用 （系统范围内和进程内存的主机） 的内存量。</span><span class="sxs-lookup"><span data-stu-id="a2580-111">Amount of memory in use (both systemwide and host process memory).</span></span>  

    -   <span data-ttu-id="a2580-112">进程内消息数要送达或处理 （出站阻止阈值）。</span><span class="sxs-lookup"><span data-stu-id="a2580-112">Number of in-process messages being delivered or processed (threshold for outbound throttling).</span></span>  

    -   <span data-ttu-id="a2580-113">使用中的线程数。</span><span class="sxs-lookup"><span data-stu-id="a2580-113">Number of threads in use.</span></span>  

    -   <span data-ttu-id="a2580-114">数据库大小、 的队列表中的项目数来度量为所有主机和后台处理和跟踪表中的项的数目。</span><span class="sxs-lookup"><span data-stu-id="a2580-114">Database size, measured by the number of items in the queue tables for all hosts and the number of items in the spool and tracking tables.</span></span>  

    -   <span data-ttu-id="a2580-115">并行数据库连接数。</span><span class="sxs-lookup"><span data-stu-id="a2580-115">Number of concurrent database connections.</span></span>  

    -   <span data-ttu-id="a2580-116">消息发布 （入站） 速率和传送或处理 （出站）。</span><span class="sxs-lookup"><span data-stu-id="a2580-116">Rate of message publishing (inbound) and delivery or processing (outbound).</span></span>  

2.  <span data-ttu-id="a2580-117">确定阻止条件的严重性。</span><span class="sxs-lookup"><span data-stu-id="a2580-117">Determine the severity of the throttling condition.</span></span> <span data-ttu-id="a2580-118">阻止条件按严重性，如下所示 （从最严重到最不严重） 排列。</span><span class="sxs-lookup"><span data-stu-id="a2580-118">Throttling conditions are ranked in severity as follows (from most severe to least severe).</span></span>  

    -   <span data-ttu-id="a2580-119">在使用中的主机进程内存超出阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-119">Host process memory in use exceeds threshold.</span></span>  

    -   <span data-ttu-id="a2580-120">进程内消息数超出了阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-120">Number of in-process messages exceeds threshold.</span></span>  

    -   <span data-ttu-id="a2580-121">使用的线程数超出阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-121">Count of threads in use exceeds threshold.</span></span>  

    -   <span data-ttu-id="a2580-122">数据库大小超过了阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-122">Database size exceeds threshold.</span></span>  

    -   <span data-ttu-id="a2580-123">所有其他限制条件。</span><span class="sxs-lookup"><span data-stu-id="a2580-123">All other throttling conditions.</span></span>  

3.  <span data-ttu-id="a2580-124">以渐进方式应用基于阻止条件的严重性。</span><span class="sxs-lookup"><span data-stu-id="a2580-124">Progressively apply throttling based upon the severity of the throttling condition(s).</span></span> <span data-ttu-id="a2580-125">严重性级别提升为更主动的方式应用阻止。</span><span class="sxs-lookup"><span data-stu-id="a2580-125">Throttling is applied more aggressively as the severity level increases.</span></span> <span data-ttu-id="a2580-126">渐进式阻止的实现，如下所示：</span><span class="sxs-lookup"><span data-stu-id="a2580-126">Progressive throttling is achieved as follows:</span></span>  

    -   <span data-ttu-id="a2580-127">一个或多个阻止条件检测，并分配的严重性。</span><span class="sxs-lookup"><span data-stu-id="a2580-127">One or more throttling conditions are detected and assigned a severity.</span></span>  

    -   <span data-ttu-id="a2580-128">基于具有最高严重级别的条件发出实现阻止的指令。</span><span class="sxs-lookup"><span data-stu-id="a2580-128">An instruction to implement throttling is issued based on the condition with the highest severity.</span></span> <span data-ttu-id="a2580-129">根据阻止条件，如果问题仍然存在，可能会降低各种线程池的大小，并且可能会通过冻结正在运行的业务流程释放内存。</span><span class="sxs-lookup"><span data-stu-id="a2580-129">Depending on the throttling condition, if the condition persists, the size of various thread pools may be reduced and memory may be freed by dehydrating running orchestrations.</span></span>  

    -   <span data-ttu-id="a2580-130">在发布或处理消息，具体取决于消息是入站或出站时应用延迟。</span><span class="sxs-lookup"><span data-stu-id="a2580-130">A delay is applied in the publishing or processing of the message, depending on whether the message is inbound or outbound.</span></span> <span data-ttu-id="a2580-131">延迟时间是阻止条件的严重性成正比，因此阻止条件的严重性较高将启动更长的阻止时间长于阻止条件的严重性较低。</span><span class="sxs-lookup"><span data-stu-id="a2580-131">The delay period is proportional to the severity of the throttling condition, so higher severity throttling conditions will initiate a longer throttling period than lower severity throttling conditions.</span></span> <span data-ttu-id="a2580-132">根据条件更改，此延迟时间一定范围内向上和向下调整阻止机制。</span><span class="sxs-lookup"><span data-stu-id="a2580-132">This delay period is adjusted up and down within certain ranges by the throttling mechanism as conditions change.</span></span> <span data-ttu-id="a2580-133">通过公开当前延迟时间**消息传递的延迟 (ms)** 并**消息发布延迟 (ms)** 与关联的性能计数器**biztalk: Message Agent**性能对象类别。</span><span class="sxs-lookup"><span data-stu-id="a2580-133">The current delay period is exposed through the **Message delivery delay (ms)** and the **Message publishing delay (ms)** performance counters associated with the **BizTalk:Message Agent** performance object category.</span></span> <span data-ttu-id="a2580-134">主题中介绍了这些性能对象计数器[主机阻止性能计数器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-134">These performance object counters are documented in the topic [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  

    -   <span data-ttu-id="a2580-135">该阻止机制继续检查是否存在阻止条件。</span><span class="sxs-lookup"><span data-stu-id="a2580-135">The throttling mechanism continues to check if a throttling condition is present.</span></span> <span data-ttu-id="a2580-136">如果阻止条件得以缓解阻止的消息的未被阻止，并允许线程池和其他资源在不受限制的模式下操作。</span><span class="sxs-lookup"><span data-stu-id="a2580-136">If the throttling conditions are mitigated then the throttled messages are unblocked and the thread pool and other resources are allowed to operate in an unrestricted mode.</span></span> <span data-ttu-id="a2580-137">如果系统继续运行而无需任何阻止条件，大大降低延迟时间。</span><span class="sxs-lookup"><span data-stu-id="a2580-137">If the system continues to operate without any throttling conditions, the delay period is greatly reduced.</span></span> <span data-ttu-id="a2580-138">如果阻止条件持续存在，则延迟时间条件的严重性按比例递增，并随后的消息可能会有所延迟较长。</span><span class="sxs-lookup"><span data-stu-id="a2580-138">If the throttling condition persists, the delay amount is incremented proportional to the severity of the condition and subsequent messages are subject to the higher delay.</span></span>  

    -   <span data-ttu-id="a2580-139">在延迟期过后将不再实现限制。</span><span class="sxs-lookup"><span data-stu-id="a2580-139">Throttling is no longer implemented when the delay period has elapsed.</span></span>  

## <a name="type-of-throttling-conditions"></a><span data-ttu-id="a2580-140">阻止条件的类型</span><span class="sxs-lookup"><span data-stu-id="a2580-140">Type of throttling conditions</span></span>  
 <span data-ttu-id="a2580-141">有三种主要类型的阻止条件： 基于速率的、 基于资源和业务流程。</span><span class="sxs-lookup"><span data-stu-id="a2580-141">There are three primary types of throttling conditions: rate based, resource based, and orchestration.</span></span>  

1. <span data-ttu-id="a2580-142">**基于速率的阻止**分为两类; 入站 （发布） 和出站 （送达）：</span><span class="sxs-lookup"><span data-stu-id="a2580-142">**Rate based throttling** is divided into two categories; inbound (published) and outbound (delivered):</span></span>  

   - <span data-ttu-id="a2580-143">对于入站 （已发布的） 消息，BizTalk Server 将阻止消息发布而如果**消息发布传入速率**主机实例超出**消息发布传出速率\\**\* 指定**加速因子 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="a2580-143">For inbound (published) messages, BizTalk Server throttles publishing of messages if The **Message publishing incoming rate** for the host instance exceeds the **Message publishing outgoing rate\\**\* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="a2580-144">**加速因子 （百分比）** 参数是可在配置**消息发布阻止设置**对话框。</span><span class="sxs-lookup"><span data-stu-id="a2580-144">The **Rate overdrive factor (percent)** parameter is configurable on the **Message Publishing Throttling Settings** dialog box.</span></span> <span data-ttu-id="a2580-145">基于速率的阻止入站消息的主要通过将消息成批发布到 MessageBox 数据库之前引入延迟。</span><span class="sxs-lookup"><span data-stu-id="a2580-145">Rate based throttling for inbound messages is accomplished primarily by inducing a delay before publishing the batch of messages into the MessageBox database.</span></span> <span data-ttu-id="a2580-146">不执行任何其他操作来实现对入站消息进行基于速率的阻止。</span><span class="sxs-lookup"><span data-stu-id="a2580-146">No other action is taken to accomplish rate based throttling for inbound messages.</span></span>  

   - <span data-ttu-id="a2580-147">对于出站 （送达的） 消息，BizTalk Server 将阻止的消息如果**消息送达传入速率**主机实例超出**消息送达传出速率** \*指定**加速因子 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="a2580-147">For outbound (delivered) messages, BizTalk Server throttles delivery of messages if The **Message delivery incoming rate** for the host instance exceeds the **Message delivery outgoing rate** \* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="a2580-148">**加速因子 （百分比）** 参数是可在配置**消息处理阻止设置**对话框。</span><span class="sxs-lookup"><span data-stu-id="a2580-148">The **Rate overdrive factor (percent)** parameter is configurable on the **Message Processing Throttling Settings** dialog box.</span></span> <span data-ttu-id="a2580-149">基于速率的出站消息阻止功能主要通过将引入从内存中队列中删除消息并将消息送达端点管理器 (EPM) 或业务流程引擎进行处理之前延迟。</span><span class="sxs-lookup"><span data-stu-id="a2580-149">Rate based throttling for outbound messages is accomplished primarily by inducing a delay before removing the messages from the in-memory queue and delivering the messages to the End Point Manager (EPM) or orchestration engine for processing.</span></span> <span data-ttu-id="a2580-150">不执行任何其他操作来实现对出站消息进行基于速率的阻止。</span><span class="sxs-lookup"><span data-stu-id="a2580-150">No other action is taken to accomplish rate based throttling for outbound messages.</span></span>  

      <span data-ttu-id="a2580-151">有关加速因子和其他基于速率的阻止值的详细信息，请参阅[如何修改速率基于阻止设置](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-151">For more information about the rate overdrive factor and other rate-based throttling values, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>  

2. <span data-ttu-id="a2580-152">**基于资源的阻止**监视系统资源，例如线程、 内存和数据库大小，并可以应用于任何服务类。</span><span class="sxs-lookup"><span data-stu-id="a2580-152">**Resource based throttling** monitors system resources such as threads, memory, and database size and can be applied to any service class.</span></span> <span data-ttu-id="a2580-153">有关基于资源的阻止值的详细信息，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-153">For more information about resource-based throttling values, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>  

3. <span data-ttu-id="a2580-154">**业务流程阻止**可防止冻结以及确定何时暂停/恢复订阅。</span><span class="sxs-lookup"><span data-stu-id="a2580-154">**Orchestration throttling** can prevent dehydration and when to pause/resume subscriptions.</span></span> <span data-ttu-id="a2580-155">有关业务流程阻止值的详细信息，请参阅[如何修改业务流程阻止设置](../core/how-to-modify-orchestration-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-155">For more information about orchestration throttling values, see [How to Modify Orchestration Throttling Settings](../core/how-to-modify-orchestration-throttling-settings.md).</span></span>  

## <a name="throttling-condition-triggers-actions-and-mitigation-strategies"></a><span data-ttu-id="a2580-156">阻止条件触发器、 操作和缓解策略</span><span class="sxs-lookup"><span data-stu-id="a2580-156">Throttling condition triggers, actions, and mitigation strategies</span></span>  
 <span data-ttu-id="a2580-157">本部分介绍各种阻止条件触发器、 生成的阻止机制和技术的措施来缓解阻止条件的操作。</span><span class="sxs-lookup"><span data-stu-id="a2580-157">This section describes the triggers for various throttling conditions, the resultant actions by the throttling mechanism, and techniques that may be employed to mitigate the throttling condition.</span></span>  

### <a name="inbound-throttling"></a><span data-ttu-id="a2580-158">入站阻止</span><span class="sxs-lookup"><span data-stu-id="a2580-158">Inbound Throttling</span></span>  
 <span data-ttu-id="a2580-159">BizTalk 阻止机制应用入站阻止对业务流程引擎 (XLANG) 和入站适配器。</span><span class="sxs-lookup"><span data-stu-id="a2580-159">The BizTalk throttling mechanism applies inbound throttling to the orchestration engine (XLANG) and to inbound adapters.</span></span>  

 <span data-ttu-id="a2580-160">使用**消息发布阻止状态**并**消息发布阻止状态持续时间**与关联的计数器**biztalk: Messageagent**性能对象类别来测量当前阻止状态和阻止持续时间。</span><span class="sxs-lookup"><span data-stu-id="a2580-160">Use the **Message publishing throttling state** and **Message publishing throttling state duration** counters associated with **BizTalk:MessageAgent** performance object category to measure the current throttling state and duration of throttling.</span></span> <span data-ttu-id="a2580-161">有关可用的主机阻止性能计数器的详细信息，请参阅[主机阻止性能计数器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-161">For more information about the available host throttling performance counters, see [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  

 <span data-ttu-id="a2580-162">入站阻止可导致入站的消息在源积压。</span><span class="sxs-lookup"><span data-stu-id="a2580-162">Inbound throttling can cause inbound messages to backlog at the source.</span></span> <span data-ttu-id="a2580-163">如果入站阻止功能应用于接收适配器接收适配器可能会停止接收消息，直到阻止条件得以缓解。</span><span class="sxs-lookup"><span data-stu-id="a2580-163">If inbound throttling is applied to a receive adapter then the receive adapter may stop receiving messages until the throttling condition is mitigated.</span></span>  


| <span data-ttu-id="a2580-164">消息发布</span><span class="sxs-lookup"><span data-stu-id="a2580-164">Message Publishing</span></span><br /><br /> <span data-ttu-id="a2580-165">限制状态</span><span class="sxs-lookup"><span data-stu-id="a2580-165">throttling state</span></span> |                                                                                                                                                                                                                                                  <span data-ttu-id="a2580-166">阻止条件的触发器</span><span class="sxs-lookup"><span data-stu-id="a2580-166">Trigger for throttling condition</span></span>                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                        <span data-ttu-id="a2580-167">采取的阻止操作</span><span class="sxs-lookup"><span data-stu-id="a2580-167">Throttling actions taken</span></span>                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="a2580-168">缓解策略</span><span class="sxs-lookup"><span data-stu-id="a2580-168">Mitigation strategy</span></span>                                                                                                                                                                                                                                                                                                                                                                                                  |                                                 <span data-ttu-id="a2580-169">性能对象</span><span class="sxs-lookup"><span data-stu-id="a2580-169">Performance object</span></span>                                                  |                                                                                                                                <span data-ttu-id="a2580-170">性能计数器</span><span class="sxs-lookup"><span data-stu-id="a2580-170">Performance counter</span></span>                                                                                                                                 |
|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                        <span data-ttu-id="a2580-171">2</span><span class="sxs-lookup"><span data-stu-id="a2580-171">2</span></span>                        |                                                                                                                                                   <span data-ttu-id="a2580-172">**消息发布传入速率**实例的主机超过**消息发布传出速率\\** \*指定**加速因子 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="a2580-172">**Message publishing incoming rate** for the host instance exceeds the **Message publishing outgoing rate\\**\* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="a2580-173">数据库不能跟上发布的速率。</span><span class="sxs-lookup"><span data-stu-id="a2580-173">The database cannot keep up with the publishing rate.</span></span>                                                                                                                                                   |                                                                                                                                                                                 <span data-ttu-id="a2580-174">阻止发布线程，直到在动态计算出的时间段内**Message Publishing Incoming Rate**是，这等同于**Message Publishing Outgoing Rate** \*指定的**加速因子 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="a2580-174">Block the publishing thread for a dynamically computed time period until the **Message Publishing Incoming Rate** is at par with the **Message Publishing Outgoing Rate** \* the specified **Rate overdrive factor (percent)** value.</span></span>                                                                                                                                                                                  |                                                                                                                                                  <span data-ttu-id="a2580-175">使用性能计数器来确定消息发布传入消息发布传出速率。</span><span class="sxs-lookup"><span data-stu-id="a2580-175">Use performance counters to determine the message publishing incoming and message publishing outgoing rate.</span></span> <span data-ttu-id="a2580-176">请考虑您的环境相应因子。</span><span class="sxs-lookup"><span data-stu-id="a2580-176">Consider an appropriate overdrive factor for your environment.</span></span><br /><br /> <span data-ttu-id="a2580-177">验证是否为提供的值**取样时段**并**最小样本数**参数是适用于你的方案。</span><span class="sxs-lookup"><span data-stu-id="a2580-177">Verify that the values supplied for the **Sampling window duration** and **Minimum number of samples** parameters are appropriate for your scenario.</span></span><br /><br /> <span data-ttu-id="a2580-178">有关这些参数的详细信息，请参阅[如何修改速率基于阻止设置](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-178">For more information about these parameters, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>                                                                                                                                                   |                                                <span data-ttu-id="a2580-179">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-179">BizTalk:MessageAgent</span></span>                                                 |                                                                                                   <span data-ttu-id="a2580-180">消息发布传入速率</span><span class="sxs-lookup"><span data-stu-id="a2580-180">Message publishing incoming rate</span></span><br /><br /> <span data-ttu-id="a2580-181">消息发布传出速率</span><span class="sxs-lookup"><span data-stu-id="a2580-181">Message publishing outgoing rate</span></span>                                                                                                    |
|                        <span data-ttu-id="a2580-182">4</span><span class="sxs-lookup"><span data-stu-id="a2580-182">4</span></span>                        |                                                                                                                                                                         <span data-ttu-id="a2580-183">进程内存超出指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-183">Process memory exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="a2580-184">发生这种情况要发布的批处理具有很高的内存要求或过多的线程所处理的消息</span><span class="sxs-lookup"><span data-stu-id="a2580-184">This can occur if the batch to be published has steep memory requirements or too many threads are processing messages</span></span>                                                                                                                                                                          | <span data-ttu-id="a2580-185">减少由 EPM 线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-185">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="a2580-186">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="a2580-186">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="a2580-187">如果有很高的内存要求将保存到数据库的一批中的消息，对发布线程还渐进式延迟之前会将消息保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="a2580-187">If there is a steep memory requirement to persist the messages in a batch to the database, the publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span><br /><br /> <span data-ttu-id="a2580-188">是否将阻止发布批或出于进程内存不足的情况取决于许多因素，包括批中的消息或是否存在冻结或消息删除命令批处理中的数字。</span><span class="sxs-lookup"><span data-stu-id="a2580-188">Whether the publishing batch will be blocked or not due to process memory pressure depends on several factors including the number of messages in the batch or if there are dehydration or message deletion commands in the batch.</span></span> |                                                                                                                                                                                   <span data-ttu-id="a2580-189">请考虑通过减少 EPM 线程池，和/或适配器批的大小来降低负荷量。</span><span class="sxs-lookup"><span data-stu-id="a2580-189">Consider reducing the amount of load by reducing the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="a2580-190">如果进程并未占用过多的内存，请考虑增大**进程虚拟**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-190">If the process is not consuming excessive memory, consider increasing the **Process virtual** threshold for the host.</span></span><br /><br /> <span data-ttu-id="a2580-191">有关更改的详细信息**进程虚拟**值，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-191">For more information about changing the **Process virtual** value, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                    |                                                <span data-ttu-id="a2580-192">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-192">BizTalk:MessageAgent</span></span>                                                 |                                                                                     <span data-ttu-id="a2580-193">高进程内存</span><span class="sxs-lookup"><span data-stu-id="a2580-193">High process memory</span></span><br /><br /> <span data-ttu-id="a2580-194">进程内存使用率 (MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-194">Process memory usage (MB)</span></span><br /><br /> <span data-ttu-id="a2580-195">进程内存使用情况阈值 (MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-195">Process memory usage threshold (MB)</span></span>                                                                                      |
|                        <span data-ttu-id="a2580-196">6</span><span class="sxs-lookup"><span data-stu-id="a2580-196">6</span></span>                        | <span data-ttu-id="a2580-197">承载消息队列大小、 后台处理表大小或跟踪表大小超过指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-197">Host message queue size, the spool table size or the tracking table size exceed the specified threshold.</span></span><br /><br /> <span data-ttu-id="a2580-198">这种情况的可能原因包括：</span><span class="sxs-lookup"><span data-stu-id="a2580-198">Possible reasons for this condition include:</span></span><br /><br /> <span data-ttu-id="a2580-199">SQL 代理作业 BizTalk Server 用于维护 BizTalk Server 数据库未运行或运行速度变慢。</span><span class="sxs-lookup"><span data-stu-id="a2580-199">-   The SQL Agent jobs used by BizTalk Server to maintain the BizTalk Server databases not running or are running slowly.</span></span><br /><span data-ttu-id="a2580-200">-下游组件未及时处理来自内存中队列的消息。</span><span class="sxs-lookup"><span data-stu-id="a2580-200">-   Down-stream components are not processing messages from the in-memory queue in a timely manner.</span></span><br /><span data-ttu-id="a2580-201">-挂起的消息数太多。</span><span class="sxs-lookup"><span data-stu-id="a2580-201">-   Number of suspended messages is high.</span></span><br /><span data-ttu-id="a2580-202">的已达到最大可承受负载的系统。</span><span class="sxs-lookup"><span data-stu-id="a2580-202">-   Maximum sustainable load for the system has been reached.</span></span> |                                                                                                                                                                      <span data-ttu-id="a2580-203">减少由 EPM 线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-203">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="a2580-204">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="a2580-204">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="a2580-205">对发布线程还渐进式延迟之前会将消息保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="a2580-205">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>                                                                                                                                                                      | <span data-ttu-id="a2580-206">请确保 SQL 代理作业 BizTalk Server 用于维护 BizTalk Server 数据库正在运行且没有故障。</span><span class="sxs-lookup"><span data-stu-id="a2580-206">Ensure that the SQL Agent jobs used by BizTalk Server to maintain the BizTalk Server databases are running and are not failing.</span></span><br /><br /> <span data-ttu-id="a2580-207">终止，并根据需要恢复挂起的实例。</span><span class="sxs-lookup"><span data-stu-id="a2580-207">Terminate and resume suspended instances as needed.</span></span><br /><br /> <span data-ttu-id="a2580-208">增加的默认值为**DB 中的消息数**考虑承载 BizTalk 数据库的 SQL server 的空间要求的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-208">Increase the default value for the **Message count in DB** threshold taking into consideration the space requirements of the SQL server that houses the BizTalk databases.</span></span><br /><br /> <span data-ttu-id="a2580-209">如果你的数据库适当地设置大小，以处理其他消息积压，请考虑增大**后台乘数**并**跟踪数据乘数**值，以允许更多的积压在假脱机和跟踪表。</span><span class="sxs-lookup"><span data-stu-id="a2580-209">If your database is sized appropriately to handle additional message backlog, consider increasing the **Spool multiplier** and **Tracking data multiplier** values to allow additional backlog in the Spool and Tracking tables.</span></span><br /><br /> <span data-ttu-id="a2580-210">有关更改这些值的详细信息，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-210">For more information about changing the values, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span> | <span data-ttu-id="a2580-211">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-211">BizTalk:MessageAgent</span></span><br /><br /> <span data-ttu-id="a2580-212">Biztalk: Message Box: General Counters</span><span class="sxs-lookup"><span data-stu-id="a2580-212">BizTalk:Message Box:General Counters</span></span><br /><br /> <span data-ttu-id="a2580-213">Biztalk: Message Box: Host Counters</span><span class="sxs-lookup"><span data-stu-id="a2580-213">BizTalk:Message Box:Host Counters</span></span> | <span data-ttu-id="a2580-214">MessageAgent /Database 大小</span><span class="sxs-lookup"><span data-stu-id="a2580-214">MessageAgent /Database size</span></span><br /><br /> <span data-ttu-id="a2580-215">消息框： 常规计数器 /Spool 大小</span><span class="sxs-lookup"><span data-stu-id="a2580-215">Message Box:General Counters /Spool size</span></span><br /><br /> <span data-ttu-id="a2580-216">消息框： 常规计数器 /Tracking 数据大小</span><span class="sxs-lookup"><span data-stu-id="a2580-216">Message Box:General Counters /Tracking data size</span></span><br /><br /> <span data-ttu-id="a2580-217">消息框： 主机计数器/主机队列-长度</span><span class="sxs-lookup"><span data-stu-id="a2580-217">Message Box:Host Counters/Host queue – length</span></span><br /><br /> <span data-ttu-id="a2580-218">消息框： 主机计数器/主机队列-挂起的消息-长度</span><span class="sxs-lookup"><span data-stu-id="a2580-218">Message Box:Host Counters/Host queue - suspended msgs – length</span></span> |
|                        <span data-ttu-id="a2580-219">8</span><span class="sxs-lookup"><span data-stu-id="a2580-219">8</span></span>                        |                                                                                                                                                                                                                         <span data-ttu-id="a2580-220">主机实例正在使用的数据库会话超过指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-220">Database sessions being used by the host instance exceed the specified threshold.</span></span>                                                                                                                                                                                                                          |                                                                                                                                                                      <span data-ttu-id="a2580-221">减少由 EPM 线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-221">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="a2580-222">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="a2580-222">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="a2580-223">对发布线程还渐进式延迟之前会将消息保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="a2580-223">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>                                                                                                                                                                      |                                                                                                                                                                                                                                                                                <span data-ttu-id="a2580-224">请考虑增大**数据库连接**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-224">Consider increasing the **Database connections** threshold for the host.</span></span><br /><br /> <span data-ttu-id="a2580-225">更改此值的详细信息，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-225">For more information on changing this value, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                                                |                                                <span data-ttu-id="a2580-226">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-226">BizTalk:MessageAgent</span></span>                                                 |                                                                                                                                  <span data-ttu-id="a2580-227">数据库会话</span><span class="sxs-lookup"><span data-stu-id="a2580-227">Database session</span></span>                                                                                                                                  |
|                        <span data-ttu-id="a2580-228">9</span><span class="sxs-lookup"><span data-stu-id="a2580-228">9</span></span>                        |                                                                                                                                                                                                                                       <span data-ttu-id="a2580-229">进程线程数超出指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-229">Process thread count exceeds the specified threshold.</span></span>                                                                                                                                                                                                                                        |                                                                                                                                                                      <span data-ttu-id="a2580-230">减少由 EPM 线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-230">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="a2580-231">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="a2580-231">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="a2580-232">对发布线程还渐进式延迟之前会将消息保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="a2580-232">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>                                                                                                                                                                      |                                                                                                                                                                                                         <span data-ttu-id="a2580-233">请考虑调整不同线程池大小，以确保系统不会创建大量的线程。</span><span class="sxs-lookup"><span data-stu-id="a2580-233">Consider adjusting the different thread pool sizes to ensure that the system does not create a large number of threads.</span></span><br /><br /> <span data-ttu-id="a2580-234">有关修改线程池大小的详细信息，请参阅[如何修改常规设置](../core/how-to-modify-general-settings.md)并[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-234">For more information about modifying the thread pool sizes, see [How to Modify General Settings](../core/how-to-modify-general-settings.md) and [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                         |                                                <span data-ttu-id="a2580-235">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-235">BizTalk:MessageAgent</span></span>                                                 |                                                                                                                  <span data-ttu-id="a2580-236">线程计数</span><span class="sxs-lookup"><span data-stu-id="a2580-236">Thread count</span></span><br /><br /> <span data-ttu-id="a2580-237">线程计数阈值</span><span class="sxs-lookup"><span data-stu-id="a2580-237">Thread count threshold</span></span>                                                                                                                   |
|                        <span data-ttu-id="a2580-238">5</span><span class="sxs-lookup"><span data-stu-id="a2580-238">5</span></span>                        |                                                                                                                                                                                                                                           <span data-ttu-id="a2580-239">系统内存超出指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-239">System memory exceeds the specified threshold.</span></span>                                                                                                                                                                                                                                           | <span data-ttu-id="a2580-240">减少由 EPM 线程池的大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-240">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="a2580-241">阻止 EPM 线程以防止处理新的消息批。</span><span class="sxs-lookup"><span data-stu-id="a2580-241">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="a2580-242">如果有很高的内存要求将保存到数据库的一批中的消息，对发布线程还渐进式延迟之前会将消息保存到数据库。</span><span class="sxs-lookup"><span data-stu-id="a2580-242">If there is a steep memory requirement to persist the messages in a batch to the database, the publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span><br /><br /> <span data-ttu-id="a2580-243">是否将阻止发布批或出于进程内存不足的情况取决于许多因素，包括批中的消息或是否存在冻结或消息删除命令批处理中的数字。</span><span class="sxs-lookup"><span data-stu-id="a2580-243">Whether the publishing batch will be blocked or not due to process memory pressure depends on several factors including the number of messages in the batch or if there are dehydration or message deletion commands in the batch.</span></span> |                                                                                                                                                                                <span data-ttu-id="a2580-244">请考虑通过减少 EPM 线程池的默认大小和/或适配器批的大小来减少负载。</span><span class="sxs-lookup"><span data-stu-id="a2580-244">Consider reducing load by reducing the default size of the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="a2580-245">如果进程并未占用过多的内存，请考虑增大**全局物理**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-245">If the process is not consuming excessive memory, consider increasing the **Global Physical** threshold for the host.</span></span><br /><br /> <span data-ttu-id="a2580-246">有关更改的详细信息**全局物理**阈值，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-246">For more information on changing the **Global Physical** threshold, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                |                                                <span data-ttu-id="a2580-247">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-247">BizTalk:MessageAgent</span></span>                                                 |                                                                                                    <span data-ttu-id="a2580-248">物理内存使用率 (MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-248">Physical memory usage (MB)</span></span><br /><br /> <span data-ttu-id="a2580-249">物理内存使用情况阈值 (MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-249">Physical memory usage threshold (MB)</span></span>                                                                                                     |

### <a name="outbound-throttling"></a><span data-ttu-id="a2580-250">出站阻止</span><span class="sxs-lookup"><span data-stu-id="a2580-250">Outbound Throttling</span></span>  
 <span data-ttu-id="a2580-251">BizTalk 阻止机制应用出站阻止对业务流程引擎 (XLANG) 和出站适配器。</span><span class="sxs-lookup"><span data-stu-id="a2580-251">The BizTalk throttling mechanism applies outbound throttling to the orchestration engine (XLANG) and to outbound adapters.</span></span>  

 <span data-ttu-id="a2580-252">使用**消息传递限制状态**并**限制状态持续时间的消息传递**与关联的计数器**biztalk: Messageagent**性能对象类别来测量当前阻止状态和阻止持续时间。</span><span class="sxs-lookup"><span data-stu-id="a2580-252">Use the **Message delivery throttling state** and **Message delivery throttling state duration** counters associated with **BizTalk:MessageAgent** performance object category to measure the current throttling state and duration of throttling.</span></span> <span data-ttu-id="a2580-253">有关可用的主机阻止性能计数器请参阅[主机阻止性能计数器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-253">For more information about the available host throttling performance counters see [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  

 <span data-ttu-id="a2580-254">出站阻止功能可能会导致延迟的消息传递和消息可能会生成内存中队列中并可能导致出列线程被阻止，直到阻止条件得以缓解。</span><span class="sxs-lookup"><span data-stu-id="a2580-254">Outbound throttling can cause delayed message delivery and messages may build up in the in-memory queue and cause de-queue threads to be blocked until the throttling condition is mitigated.</span></span> <span data-ttu-id="a2580-255">当出列线程被阻止任何额外的消息从 MessageBox 中提取到的内存中队列的出站送达。</span><span class="sxs-lookup"><span data-stu-id="a2580-255">When de-queue threads are blocked no additional messages are pulled from the MessageBox into the in-memory queue for outbound delivery.</span></span>  


| <span data-ttu-id="a2580-256">消息传递</span><span class="sxs-lookup"><span data-stu-id="a2580-256">Message Delivery</span></span><br /><br /> <span data-ttu-id="a2580-257">限制状态</span><span class="sxs-lookup"><span data-stu-id="a2580-257">throttling state</span></span> |                                                                                                                                    <span data-ttu-id="a2580-258">阻止条件的触发器</span><span class="sxs-lookup"><span data-stu-id="a2580-258">Trigger for throttling condition</span></span>                                                                                                                                     |                                                                                                                                                   <span data-ttu-id="a2580-259">采取的阻止操作</span><span class="sxs-lookup"><span data-stu-id="a2580-259">Throttling actions taken</span></span>                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span data-ttu-id="a2580-260">缓解策略</span><span class="sxs-lookup"><span data-stu-id="a2580-260">Mitigation Strategy</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  <span data-ttu-id="a2580-261">性能对象</span><span class="sxs-lookup"><span data-stu-id="a2580-261">Performance Object</span></span>  |                                                                               <span data-ttu-id="a2580-262">性能计数器</span><span class="sxs-lookup"><span data-stu-id="a2580-262">Performance Counter</span></span>                                                                               |
|-----------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       <span data-ttu-id="a2580-263">1</span><span class="sxs-lookup"><span data-stu-id="a2580-263">1</span></span>                       | <span data-ttu-id="a2580-264">**消息送达传入速率**实例的主机超过**消息送达传出速率\\**  \*指定**加速因子 （百分比）** 值</span><span class="sxs-lookup"><span data-stu-id="a2580-264">**Message delivery incoming rate** for the host instance exceeds the **Message delivery outgoing rate \\**\* the specified **Rate overdrive factor (percent)** value</span></span><br /><br /> <span data-ttu-id="a2580-265">这可能引起高处理复杂性、 出站适配器速度缓慢或系统资源出现暂时短缺。</span><span class="sxs-lookup"><span data-stu-id="a2580-265">This can be caused by high processing complexity, slow outbound adapters, or a momentary shortage of system resources.</span></span> |                                                 <span data-ttu-id="a2580-266">直到 Message delivery incoming rate 等于这等同于在动态计算出的时间段内阻止送达线程**消息送达传出速率\\**  \*指定**速率加速因子 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="a2580-266">Block the delivery thread for a dynamically computed time period until the Message delivery incoming rate is at par with the **Message delivery outgoing rate \\**\* the specified **Rate overdrive factor (percent)** value.</span></span>                                                 |                                                                                                                                                                                                                                                  <span data-ttu-id="a2580-267">使用性能计数器来确定消息送达传入和传出速率的消息传递。</span><span class="sxs-lookup"><span data-stu-id="a2580-267">Use performance counters to determine the message delivery incoming and message delivery outgoing rate.</span></span> <span data-ttu-id="a2580-268">通过为您的环境的驱动器身份，请考虑适当。</span><span class="sxs-lookup"><span data-stu-id="a2580-268">Consider an appropriate over drive factor for your environment.</span></span><br /><br /> <span data-ttu-id="a2580-269">验证是否为提供的值**取样时段**并**最小样本数**参数是适用于你的方案。</span><span class="sxs-lookup"><span data-stu-id="a2580-269">Verify that the values supplied for the **Sampling window duration** and **Minimum number of samples** parameters are appropriate for your scenario.</span></span><br /><br /> <span data-ttu-id="a2580-270">有关这些参数的详细信息，请参阅[如何修改速率基于阻止设置](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-270">For more information about these parameters, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                   | <span data-ttu-id="a2580-271">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-271">BizTalk:MessageAgent</span></span> |                                                   <span data-ttu-id="a2580-272">消息送达传入速率</span><span class="sxs-lookup"><span data-stu-id="a2580-272">Message delivery incoming rate</span></span><br /><br /> <span data-ttu-id="a2580-273">消息发布传出速率</span><span class="sxs-lookup"><span data-stu-id="a2580-273">Message publishing outgoing rate</span></span>                                                   |
|                       <span data-ttu-id="a2580-274">4</span><span class="sxs-lookup"><span data-stu-id="a2580-274">4</span></span>                       |                             <span data-ttu-id="a2580-275">进程内存超出指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-275">Process memory exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="a2580-276">这在内存密集型处理方案中，处理大消息时或发生时发送适配器尝试同时处理大量消息。</span><span class="sxs-lookup"><span data-stu-id="a2580-276">This can occur in memory intensive processing scenarios, when processing large messages, or when send adapters are attempting to process a high number of messages simultaneously.</span></span>                              | <span data-ttu-id="a2580-277">消息传递到适配器或 XLANG 变慢。</span><span class="sxs-lookup"><span data-stu-id="a2580-277">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="a2580-278">降低进程内存占用，通过冻结服务实例和缩减缓存时适用。</span><span class="sxs-lookup"><span data-stu-id="a2580-278">Reduce process memory consumption by dehydrating service instances and shrinking cache when applicable.</span></span><br /><br /> <span data-ttu-id="a2580-279">减少由 EPM 和/或消息代理使用的线程池大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-279">Reduce the size of the thread pools used by the EPM and/or the Message Agent.</span></span><br /><br /> <span data-ttu-id="a2580-280">定期强制执行.NET 垃圾回收 (GC)。</span><span class="sxs-lookup"><span data-stu-id="a2580-280">Periodically force a .NET garbage collection (GC).</span></span> | <span data-ttu-id="a2580-281">如果系统不成为进程基于内存的阻止功能而进入空闲状态，可能不需要执行任何操作。</span><span class="sxs-lookup"><span data-stu-id="a2580-281">If the system is not becoming idle due to process memory based throttling, no action may be required.</span></span><br /><br /> <span data-ttu-id="a2580-282">如果**进程内消息计数**计数器值较高和 CPU 使用率不是过多，即使没有基于进程内存的限制，可能需要执行任何其他操作。</span><span class="sxs-lookup"><span data-stu-id="a2580-282">If the **In-process message count** counter is high and the CPU utilization is not excessive even when there is process memory based throttling, no additional action may be required.</span></span><br /><br /> <span data-ttu-id="a2580-283">如果系统表现为过度阻止，请考虑增大与关联的值**进程虚拟**主机的阈值，并验证主机实例不会生成"内存不足"错误。</span><span class="sxs-lookup"><span data-stu-id="a2580-283">If the system appears to be over-throttling, consider increasing the value associated with the **Process virtual** threshold for the host and verify that the host instance does not generate an "out of memory" error.</span></span> <span data-ttu-id="a2580-284">如果通过增加引发"内存不足"错误**进程虚拟**阈值，请考虑减小的值**内部消息队列大小**和**进程内消息数**阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-284">If an "out of memory" error is raised by increasing the **Process virtual** threshold, then consider reducing the values for the **Internal message queue size** and **In-process messages** thresholds.</span></span> <span data-ttu-id="a2580-285">此策略是特别适用于大型消息处理方案。</span><span class="sxs-lookup"><span data-stu-id="a2580-285">This strategy is particularly relevant in large message processing scenarios.</span></span><br /><br /> <span data-ttu-id="a2580-286">有关这些参数的详细信息，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-286">For more information about these parameters, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span> | <span data-ttu-id="a2580-287">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-287">BizTalk:MessageAgent</span></span> | <span data-ttu-id="a2580-288">高进程内存</span><span class="sxs-lookup"><span data-stu-id="a2580-288">High process memory</span></span><br /><br /> <span data-ttu-id="a2580-289">进程内存 usage(MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-289">Process memory usage(MB)</span></span><br /><br /> <span data-ttu-id="a2580-290">进程内存使用情况阈值 (MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-290">Process memory usage threshold (MB)</span></span><br /><br /> <span data-ttu-id="a2580-291">进程内消息计数</span><span class="sxs-lookup"><span data-stu-id="a2580-291">In-process message count</span></span><br /><br /> <span data-ttu-id="a2580-292">活动的实例计数</span><span class="sxs-lookup"><span data-stu-id="a2580-292">Active instance count</span></span> |
|                       <span data-ttu-id="a2580-293">3</span><span class="sxs-lookup"><span data-stu-id="a2580-293">3</span></span>                       |                                     <span data-ttu-id="a2580-294">送达服务类别的进程内消息数超出指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-294">Number of in-process messages delivered to a service class exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="a2580-295">这可能引起高处理复杂性、 出站适配器速度缓慢或系统资源出现暂时短缺。</span><span class="sxs-lookup"><span data-stu-id="a2580-295">This can be caused by high processing complexity, slow outbound adapters, or a momentary shortage of system resources.</span></span>                                      |                                                                                                  <span data-ttu-id="a2580-296">消息传递到适配器或 XLANG 变慢。</span><span class="sxs-lookup"><span data-stu-id="a2580-296">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="a2580-297">减少由消息代理使用的线程池大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-297">Reduce the size of the thread pool used by the Message Agent.</span></span>                                                                                                   |                                                                                                                                                                                                                                                                                            <span data-ttu-id="a2580-298">如果出现过度阻止情况，请考虑增大与关联的值**进程内消息数**阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-298">If over-throttling occurs, consider increasing the value associated with the **In-process messages** threshold.</span></span><br /><br /> <span data-ttu-id="a2580-299">有关此参数的详细信息，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)**注意：** 增加此值可能会产生负面影响发送适配器的性能和/或提高进程的内存使用率。</span><span class="sxs-lookup"><span data-stu-id="a2580-299">For more information about this parameter, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md) **Note:**  Increasing this value may adversely impact send adapter performance and/or increase the memory usage of the process.</span></span>                                                                                                                                                                                                                                                                                             | <span data-ttu-id="a2580-300">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-300">BizTalk:MessageAgent</span></span> |                                                     <span data-ttu-id="a2580-301">进程内消息计数</span><span class="sxs-lookup"><span data-stu-id="a2580-301">In-process message count</span></span><br /><br /> <span data-ttu-id="a2580-302">进程内消息计数阈值</span><span class="sxs-lookup"><span data-stu-id="a2580-302">In-process message count threshold</span></span>                                                     |
|                       <span data-ttu-id="a2580-303">9</span><span class="sxs-lookup"><span data-stu-id="a2580-303">9</span></span>                       |                                                                                                                          <span data-ttu-id="a2580-304">进程线程数超出指定的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-304">Process thread count exceeds the specified threshold.</span></span>                                                                                                                          |                                                                                                                         <span data-ttu-id="a2580-305">减少由 EPM 和/或消息代理使用的线程池大小</span><span class="sxs-lookup"><span data-stu-id="a2580-305">Reduce the size of the thread pools used by the EPM and/or the Message Agent</span></span>                                                                                                                          |                                                                                                                                                                                                                                                                                                       <span data-ttu-id="a2580-306">请考虑调整不同线程池大小，以确保系统不会创建大量的线程。</span><span class="sxs-lookup"><span data-stu-id="a2580-306">Consider adjusting the different thread pool sizes to ensure that the system does not create a large number of threads.</span></span><br /><br /> <span data-ttu-id="a2580-307">有关修改线程池大小的详细信息，请参阅[如何修改常规设置](../core/how-to-modify-general-settings.md)并[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-307">For more information about modifying the thread pool sizes, see [How to Modify General Settings](../core/how-to-modify-general-settings.md) and [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                                                                        | <span data-ttu-id="a2580-308">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-308">BizTalk:MessageAgent</span></span> |                                                                 <span data-ttu-id="a2580-309">线程计数</span><span class="sxs-lookup"><span data-stu-id="a2580-309">Thread count</span></span><br /><br /> <span data-ttu-id="a2580-310">线程计数阈值</span><span class="sxs-lookup"><span data-stu-id="a2580-310">Thread count threshold</span></span>                                                                 |
|                       <span data-ttu-id="a2580-311">5</span><span class="sxs-lookup"><span data-stu-id="a2580-311">5</span></span>                       |                                                                                                                                   <span data-ttu-id="a2580-312">系统内存超出阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-312">System memory exceeds a threshold.</span></span>                                                                                                                                    |                                <span data-ttu-id="a2580-313">消息传递到适配器或 XLANG 变慢。</span><span class="sxs-lookup"><span data-stu-id="a2580-313">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="a2580-314">降低进程内存占用，通过冻结服务实例和缩减缓存时适用。</span><span class="sxs-lookup"><span data-stu-id="a2580-314">Reduce process memory consumption by dehydrating service instances and shrinking cache when applicable.</span></span><br /><br /> <span data-ttu-id="a2580-315">减少由 EPM 和/或消息代理使用的线程池大小。</span><span class="sxs-lookup"><span data-stu-id="a2580-315">Reduce the size of the thread pools used by the EPM and/or the Message Agent.</span></span>                                 |                                                                                                                                                                                                                                                                             <span data-ttu-id="a2580-316">请考虑通过减少 EPM 线程池的默认大小和/或适配器批的大小来减少负载。</span><span class="sxs-lookup"><span data-stu-id="a2580-316">Consider reducing load by reducing the default size of the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="a2580-317">如果进程并未占用过多的内存，请考虑增大**全局物理**主机的阈值。</span><span class="sxs-lookup"><span data-stu-id="a2580-317">If the process is not consuming excessive memory, consider increasing the **Global Physical** threshold for the host.</span></span><br /><br /> <span data-ttu-id="a2580-318">有关更改的详细信息**全局物理**阈值，请参阅[如何修改资源基于阻止设置](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="a2580-318">For more information about changing the **Global Physical** threshold, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                                             | <span data-ttu-id="a2580-319">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="a2580-319">BizTalk:MessageAgent</span></span> |                                                                           <span data-ttu-id="a2580-320">物理内存使用率 (MB)</span><span class="sxs-lookup"><span data-stu-id="a2580-320">Physical memory usage (MB)</span></span>                                                                            |

