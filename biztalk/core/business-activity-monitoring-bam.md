---
title: 业务活动监视 (BAM) |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- BAM, tools
- utilities, Tracking Profile Deployment Utility
- BAM, deployment process
- BAM
- BAM, presentation layers
- BAM, Tracking Profile Deployment utility
- BAM, about BAM
- BAM, data storage
- BAM Management utility
- Tracking Profile Deployment utility
- BAM, runtime process
- BAM, design time
- BAM, data insertion
- BAM, data consumption
- BAM, BAM Management utility
- BAM, processing
ms.assetid: a8ad48b1-6891-4bbb-b125-27d224e49293
caps.latest.revision: 17
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 258294a8a51e6f8e80e360668123e522acf6ff15
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36972302"
---
# <a name="business-activity-monitoring-bam"></a><span data-ttu-id="cfc0c-102">业务活动监视 (BAM)</span><span class="sxs-lookup"><span data-stu-id="cfc0c-102">Business Activity Monitoring (BAM)</span></span>
<span data-ttu-id="cfc0c-103">下图显示了业务活动监视 (BAM) 功能的结构：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-103">The following diagram illustrates the architecture for the Business Activity Monitoring (BAM) feature.</span></span>  
  
 <span data-ttu-id="cfc0c-104">![](../core/media/architecture-bam-01.gif "architecture_bam_01")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-104">![](../core/media/architecture-bam-01.gif "architecture_bam_01")</span></span>  
  
## <a name="tools"></a><span data-ttu-id="cfc0c-105">工具</span><span class="sxs-lookup"><span data-stu-id="cfc0c-105">Tools</span></span>  
 <span data-ttu-id="cfc0c-106">您可以使用以下工具设计、开发和部署与 BAM 相集成的 BizTalk 解决方案：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-106">You can use the following tools to design, develop, and deploy BizTalk solutions that integrate with BAM.</span></span>  
  
-   <span data-ttu-id="cfc0c-107">**Microsoft Excel**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-107">**Microsoft Excel**.</span></span> <span data-ttu-id="cfc0c-108">用于 Excel 的 BAM 加载项提供的用户界面可以指导业务分析员完成活动和视图的创建过程。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-108">The BAM Add-In for Excel provides a user interface that guides business analysts during the creation of Activities and Views.</span></span> <span data-ttu-id="cfc0c-109">Excel 既可用作业务分析员的设计工具，也可用作业务用户的数据使用工具。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-109">Excel serves as both a design tool for business analysts and a data consumption tool for business users.</span></span> <span data-ttu-id="cfc0c-110">有关 BAM 外接程序 excel 的详细信息，请参阅[使用 excel BAM 外接程序的要求](../core/requirements-for-using-the-bam-add-in-for-excel.md)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-110">For more information about the BAM Add-In for Excel, see [Requirements for Using the BAM Add-In for Excel](../core/requirements-for-using-the-bam-add-in-for-excel.md).</span></span>  
  
-   <span data-ttu-id="cfc0c-111">**BAM 管理实用程序**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-111">**BAM Management Utility**.</span></span> <span data-ttu-id="cfc0c-112">BAM 管理实用程序是一种部署工具，通过该工具，可以将 Excel 中创建的 BAM 定义部署到企业中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-112">The BAM Management Utility is a deployment tool that allows BAM definitions created in Excel to be deployed into the enterprise.</span></span> <span data-ttu-id="cfc0c-113">BAM 管理实用程序可创建必需的 SQL Server 数据库、Analysis Services 多维数据集、SQL Notification Services 数据库以及 DTS 或 SSIS 任务（取决于安装的 SQL Server 的版本）。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-113">The BAM Management Utility creates the necessary SQL Server databases, Analysis Services cubes, SQL Notification Services databases, and DTS or SSIS tasks (depending on which version of SQL Server is installed).</span></span> <span data-ttu-id="cfc0c-114">有关 BAM 管理器的详细信息，请参阅[BAM 管理实用程序](../core/bam-management-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-114">For more information about the BAM Manager, see [BAM Management Utility](../core/bam-management-utility.md).</span></span>  
  
-   <span data-ttu-id="cfc0c-115">**跟踪配置文件编辑器**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-115">**Tracking Profile Editor**.</span></span> <span data-ttu-id="cfc0c-116">通过跟踪配置文件编辑器，BizTalk 开发人员可以将业务分析员定义的数据元素映射到包含业务流程和消息传送的 BizTalk 实现中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-116">The Tracking Profile Editor enables BizTalk developers to map the data elements defined by business analysts into the BizTalk implementation including Orchestrations and Messaging.</span></span> <span data-ttu-id="cfc0c-117">有关跟踪配置文件编辑器的详细信息，请参阅[跟踪配置文件编辑器](../core/tracking-profile-editor.md)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-117">For more information about the Tracking Profile Editor, see [Tracking Profile Editor](../core/tracking-profile-editor.md).</span></span>  
  
-   <span data-ttu-id="cfc0c-118">**跟踪配置文件部署实用程序**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-118">**Tracking Profile Deployment Utility**.</span></span> <span data-ttu-id="cfc0c-119">通过跟踪配置文件部署实用程序，IT 专业人员可将新跟踪配置文件和更新的跟踪配置文件部署到 BAM 基础结构中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-119">The Tracking Profile Deployment Utility allows IT professionals to deploy new and updated tracking profiles to the BAM infrastructure.</span></span> <span data-ttu-id="cfc0c-120">有关跟踪配置文件部署工具的详细信息，请参阅[跟踪配置文件部署实用程序](../core/tracking-profile-deployment-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-120">For more information about the Tracking Profile Deploy tool, see [Tracking Profile Deployment Utility](../core/tracking-profile-deployment-utility.md).</span></span>  
  
## <a name="presentation"></a><span data-ttu-id="cfc0c-121">表示形式</span><span class="sxs-lookup"><span data-stu-id="cfc0c-121">Presentation</span></span>  
 <span data-ttu-id="cfc0c-122">表示层包括：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-122">The presentation layer consists of the following:</span></span>  
  
- <span data-ttu-id="cfc0c-123">**BAM 门户**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-123">**BAM Portal**.</span></span> <span data-ttu-id="cfc0c-124">Microsoft 中的 BAM 门户[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]提供向业务流程的实时、 端到端可见性。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-124">The BAM portal in Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provides real-time, end-to-end visibility into a business process.</span></span> <span data-ttu-id="cfc0c-125">它是集合的基于 Web 的功能，它包含的 ASP.NET 页。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-125">It is a Web-based feature that consists of a collection of ASP.NET  pages.</span></span> <span data-ttu-id="cfc0c-126">您可以自定义 BAM，为用户改善性能和体验。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-126">You can customize BAM to enhance the performance and experience for your users.</span></span> <span data-ttu-id="cfc0c-127">有关 BAM 门户的详细信息，请参阅[BAM 门户](../core/bam-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-127">For more information about the BAM Portal, see [BAM Portal](../core/bam-portal.md).</span></span>  
  
- <span data-ttu-id="cfc0c-128">**Microsoft Excel**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-128">**Microsoft Excel**.</span></span> <span data-ttu-id="cfc0c-129">用于 Excel 的 BAM 加载项提供的用户界面可以指导业务分析员完成活动和视图的创建过程。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-129">The BAM Add-In for Excel provides a user interface that guides business analysts during the creation of Activities and Views.</span></span> <span data-ttu-id="cfc0c-130">Excel 既可用作业务分析员的设计工具，也可用作业务用户的数据使用工具。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-130">Excel serves as both a design tool for business analysts and a data consumption tool for business users.</span></span> <span data-ttu-id="cfc0c-131">有关 BAM 外接程序 excel 的详细信息，请参阅[使用 excel BAM 外接程序的要求](../core/requirements-for-using-the-bam-add-in-for-excel.md)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-131">For more information about the BAM Add-In for Excel, see [Requirements for Using the BAM Add-In for Excel](../core/requirements-for-using-the-bam-add-in-for-excel.md).</span></span>  
  
- <span data-ttu-id="cfc0c-132">**自定义用户界面**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-132">**Custom User Interface**.</span></span> <span data-ttu-id="cfc0c-133">ISV 和开发人员可以创建用于显示 BAM 数据的自定义应用程序</span><span class="sxs-lookup"><span data-stu-id="cfc0c-133">ISV’s and developers can create custom applications that display BAM data</span></span>  
  
## <a name="processing"></a><span data-ttu-id="cfc0c-134">处理</span><span class="sxs-lookup"><span data-stu-id="cfc0c-134">Processing</span></span>  
 <span data-ttu-id="cfc0c-135">处理层包括：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-135">The processing layer consists of the following:</span></span>  
  
- <span data-ttu-id="cfc0c-136">**BAM 管理 Web Service**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-136">**BAM Management Web Service**.</span></span> <span data-ttu-id="cfc0c-137">BAM 门户应用程序使用此 Web 服务进行通信与 BAM 主导入表 (PIT)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-137">This Web service is used by the BAM Portal application to communicate with the BAM Primary Import Tables (PIT).</span></span> <span data-ttu-id="cfc0c-138">使用配置期间创建的注册表中存储的模拟凭据可以完成与数据库的通信。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-138">The communication with the database is done using impersonated credentials stored in the registry which is created during configuration.</span></span> <span data-ttu-id="cfc0c-139">此 Web 服务公开的方法自定义客户端可以用于获取视图及其详细信息、 相关的活动和数据透视表布局的任何用户。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-139">Methods exposed by this Web service can be used by custom clients to get views and their details, related activities, and pivot table layouts for any user.</span></span> <span data-ttu-id="cfc0c-140">还可以将其用于管理数据库中的警报。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-140">They can also be used to manage alerts in the database.</span></span>  
  
- <span data-ttu-id="cfc0c-141">**事件总线**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-141">**Event Bus** .</span></span> <span data-ttu-id="cfc0c-142">BAM 事件总线服务可处理存储于源数据库中的跟踪数据（流），并且以查询表格式将这些数据保存在目标数据库中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-142">The BAM Event Bus Service processes tracking data (streams) stored in a source database and persists that data in a query table format in the destination database.</span></span>  
  
- <span data-ttu-id="cfc0c-143">**SQL Notification Services**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-143">**SQL Notification Services**.</span></span> <span data-ttu-id="cfc0c-144">SQL Notification Services 可评估由业务用户定义的实例和聚合 BAM 警报。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-144">SQL Notification Services evaluates the Instance and Aggregate BAM alerts that are defined by the business user.</span></span>  
  
  <span data-ttu-id="cfc0c-145">下图显示了 BAM 结构的基础物理流程。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-145">The following diagram illustrates the underlying physical processes for the BAM architecture.</span></span>  
  
  <span data-ttu-id="cfc0c-146">![](../core/media/architecture-bam-02.gif "architecture_bam_02")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-146">![](../core/media/architecture-bam-02.gif "architecture_bam_02")</span></span>  
  
## <a name="design-time-experience"></a><span data-ttu-id="cfc0c-147">设计时体验</span><span class="sxs-lookup"><span data-stu-id="cfc0c-147">Design time experience</span></span>  
 <span data-ttu-id="cfc0c-148">下图显示了设计时体验：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-148">The following diagram illustrates the design time experience.</span></span>  
  
 <span data-ttu-id="cfc0c-149">![](../core/media/architecture-bam-03.gif "architecture_bam_03")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-149">![](../core/media/architecture-bam-03.gif "architecture_bam_03")</span></span>  
  
 <span data-ttu-id="cfc0c-150">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-150">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-151">跟踪配置文件编辑器假定 BizTalk Server 已配置，至少部署了一个 BAM 定义（使用 BM.exe），并且包括主导入数据库在内的基础结构已创建。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-151">The Tracking Profile Editor assumes that BizTalk Server has been configured, that at least one BAM definition has already been deployed (using BM.exe), and that the infrastructure, including the Primary Import Database has been created.</span></span> <span data-ttu-id="cfc0c-152">跟踪配置文件编辑器将使用 BizTalk 配置期间创建的注册表项来确定管理数据库所处的位置。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-152">The Tracking Profile Editor uses a registry key that is set during BizTalk configuration to determine where the Management database is located.</span></span>  
  
    1.  <span data-ttu-id="cfc0c-153">BAM 一旦发现主导入数据库，就会枚举该数据库中的活动。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-153">BAM enumerates the activities within the Primary Import Database once it is discovered.</span></span> <span data-ttu-id="cfc0c-154">BizTalk 开发人员将选择从 BAM 主导入数据库中请求的已部署活动。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-154">BizTalk developers select the deployed activities which get pulled from the BAM Primary Import database.</span></span>  
  
    2.  <span data-ttu-id="cfc0c-155">通过浏览从 BizTalk 管理数据库中检索的已部署程序集，BizTalk 开发人员可以将其映射到物理实现。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-155">The BizTalk developer maps this to a physical implementation by browsing the deployed assemblies retrieved from the BizTalk Management database.</span></span>  
  
    3.  <span data-ttu-id="cfc0c-156">一旦开发人员确实将此项映射到 BizTalk 项目，元数据就会提交到 BizTalk Server 运行时，以收集和存储数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-156">Once the developer has visually mapped this to the BizTalk artifacts, metadata is submitted to the BizTalk Server runtime to collect and store the data.</span></span> <span data-ttu-id="cfc0c-157">这是通过批注（对于用于解码已收集数据的消息传送信息）和跟踪配置文件（用于检索运行时数据）来实现的。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-157">This is done via annotations (for messaging information used to decode the collected data) and the tracking profile (used to retrieve the runtime data).</span></span>  
  
2.  <span data-ttu-id="cfc0c-158">Microsoft Excel 既可用作设计时工具，也可用作数据使用或表示工具。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-158">Microsoft Excel is used as both a design time tool and a data consumption or presentation tool.</span></span> <span data-ttu-id="cfc0c-159">利用设计时 Excel 体验，用户可以通过创建 BAM 活动和视图来构造 BAM 定义。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-159">The design time Excel experience allows users to construct a BAM definition by creating BAM Activities and Views.</span></span> <span data-ttu-id="cfc0c-160">并且可以创建最终显示在 BAM 门户中的数据透视控件和图形。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-160">It also allows for the creation of the pivot controls and graphs that are ultimately displayed in the BAM portal.</span></span>  
  
## <a name="deployment"></a><span data-ttu-id="cfc0c-161">部署</span><span class="sxs-lookup"><span data-stu-id="cfc0c-161">Deployment</span></span>  
 <span data-ttu-id="cfc0c-162">存在两种类别的部署</span><span class="sxs-lookup"><span data-stu-id="cfc0c-162">There are two categories of deployment</span></span>  
  
- <span data-ttu-id="cfc0c-163">构建动态基础结构</span><span class="sxs-lookup"><span data-stu-id="cfc0c-163">Building out the dynamic infrastructure</span></span>  
  
- <span data-ttu-id="cfc0c-164">检测运行时以收集数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-164">Instrumenting the runtime to collect data.</span></span>  
  
  <span data-ttu-id="cfc0c-165">下图显示了 BAM 部署：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-165">The following diagram illustrates BAM deployment.</span></span>  
  
  <span data-ttu-id="cfc0c-166">![](../core/media/architecture-bam-04.gif "architecture_bam_04")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-166">![](../core/media/architecture-bam-04.gif "architecture_bam_04")</span></span>  
  
  <span data-ttu-id="cfc0c-167">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-167">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-168">BAM 管理实用程序用于构建动态基础结构。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-168">The BAM Management Utility is used to build out the dynamic infrastructure.</span></span> <span data-ttu-id="cfc0c-169">使用 BAM 定义或设计时 Excel 工作簿以及 BAM 配置 XML 文件，BAM 管理实用程序可以生成所有必需的数据库以及系统运行所需的相应 DTS 或 SSIS 任务。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-169">Using the BAM definition or a design time Excel workbook plus the BAM Configuration XML file, the BAM Management Utility builds all the necessary databases and the corresponding DTS or SSIS tasks necessary for the system to operate.</span></span>  
  
    1.  <span data-ttu-id="cfc0c-170">构造 BAM 主导入数据库和所有支持的存储过程、触发器以及 DTS 或 SSIS 任务。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-170">The BAM Primary Import database and all the supporting stored procedures, triggers, and DTS or SSIS tasks are constructed.</span></span>  
  
    2.  <span data-ttu-id="cfc0c-171">可以定义 BAM 存档数据库，但只有在执行存档 DTS 或 SSIS 任务后，才能创建该数据库。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-171">The BAM Archive database is defined, but not created, until the Archiving DTS or SSIS task is executed.</span></span>  
  
    3.  <span data-ttu-id="cfc0c-172">如果定义了 BAM OLAP 聚合，则该数据库为 BAM 星型架构数据库。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-172">The BAM Star Schema database if BAM OLAP Aggregations were defined.</span></span> <span data-ttu-id="cfc0c-173">您可以确定是否是否已定义聚合**实时聚合**Excel 电子表格中的按钮处于禁用状态或**CreateOlapCube**设置为**true**中BAM 定义和配置 XML 文件具有一个部署单元，以便**AnalysisDatabase**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-173">You can determine if aggregations have been defined if the **Real Time Aggregation** button in the Excel spreadsheet is disabled or the **CreateOlapCube** is set to **true** in the BAM Definition and the Configuration XML file has a Deployment Unit for **AnalysisDatabase**.</span></span>  
  
    4.  <span data-ttu-id="cfc0c-174">必须定义 BAM 定义和配置 XML 的聚合（不是 RTA），以便创建 BAM OLAP 多维数据集。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-174">The BAM Definition and Configuration XML have to have an Aggregation defined that is not an RTA in order for a BAM OLAP cube to be created.</span></span>  
  
    5.  <span data-ttu-id="cfc0c-175">BAM 管理器进程的分离型视图显示：调用通知服务进程 (nscontrol.exe) 以创建 SQL NS 数据库。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-175">Exploded view of the BAM Manager process shows that the Notification Services process (nscontrol.exe) is called to create the SQL NS databases.</span></span>  
  
2.  <span data-ttu-id="cfc0c-176">跟踪配置文件编辑器用户界面具有一个部署命令，该命令可以检测运行时以跟踪和解码来自运行时系统的数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-176">The Tracking Profile Editor UI has a deployment command which instruments the runtime to track and decode data from the runtime systems.</span></span> <span data-ttu-id="cfc0c-177">在这种情况下它会促使**批注**到 BAM 主导入数据库 （如果将数据从消息传送系统请求）。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-177">In this case it pushes **annotations** into the BAM Primary Import database (if data is pulled from the messaging system).</span></span> <span data-ttu-id="cfc0c-178">跟踪配置文件将插入到由 BizTalk 运行时使用的 BizTalk 管理数据库中以确定要发布到 BAM 系统的数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-178">A tracking profile is inserted into the BizTalk Management database which is used by the BizTalk Runtime to determine what data to publish to the BAM system.</span></span>  
  
3.  <span data-ttu-id="cfc0c-179">BizTalk 跟踪部署命令行工具允许将跟踪配置文件发布到 BAM 主导入数据库和管理数据库，这一点与跟踪配置文件编辑器的作用相类似；但该命令行工具不支持映射功能。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-179">The BizTalk Tracking Deployment command line tool allows Tracking Profiles to be published to the BAM Primary Import database and Management database, which is similar to what the Tracking Profile Editor does; however the command line tool does not allow mapping capabilities.</span></span>  
  
## <a name="data-consumption"></a><span data-ttu-id="cfc0c-180">数据使用</span><span class="sxs-lookup"><span data-stu-id="cfc0c-180">Data Consumption</span></span>  
 <span data-ttu-id="cfc0c-181">数据使用表示这样一个进程：在其中，业务用户将使用 BAM 基础结构已收集的信息。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-181">Data consumption refers to the process in which a business user consumes the information that the BAM infrastructure has collected.</span></span> <span data-ttu-id="cfc0c-182">假定此时，BAM 定义已创建（定义要收集哪些数据以及如何查看这些数据）、已部署（动态地创建基础结构）、并已映射到物理实现（定义从何处收集数据，以及在某些情况下将编写代码以推送至系统）。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-182">It is assumed at this point, that the BAM definition has been created (defining what data to collect and how to view it), that the BAM definition has been deployed (dynamically creating the infrastructure), and that the BAM definition has been mapped to the physical implementation (defining where to collect the data, and in some cases writing code to push into the system).</span></span>  
  
 <span data-ttu-id="cfc0c-183">下图显示了数据使用的过程：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-183">The following diagram illustrates the process of data consumption.</span></span>  
  
 <span data-ttu-id="cfc0c-184">![](../core/media/architecture-bam-05.gif "architecture_bam_05")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-184">![](../core/media/architecture-bam-05.gif "architecture_bam_05")</span></span>  
  
 <span data-ttu-id="cfc0c-185">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-185">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-186">BAM 门户将拆分为两个进程：以 Internet 信息服务为宿主的 Internet Explorer 和 BAM Web 门户进程。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-186">The BAM portal is split out into two processes, Internet Explorer and the BAM Web portal process hosted in Internet Information Services.</span></span>  
  
    1.  <span data-ttu-id="cfc0c-187">Internet Explorer 使用连接到 BAM 门户网站的业务用户的安全上下文。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-187">Internet Explorer uses the security context of the business user connecting to the BAM Portal Web site.</span></span> <span data-ttu-id="cfc0c-188">BAM 门户网站是一种使用 BAM 管理 Web Services 收集信息的 ASPX 应用程序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-188">The BAM Portal Web site is an ASPX application that uses the BAM Management Web Service to collect information.</span></span>  
  
    2.  <span data-ttu-id="cfc0c-189">BAM 门户调用 BAM 管理 Web Services 来检索信息，例如特定业务用户可查看的 BAM 活动/视图。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-189">The BAM Portal calls the BAM Management Web Service to retrieve information such as what BAM Activities/Views the particular business user can see.</span></span> <span data-ttu-id="cfc0c-190">BAM 管理 Web Services 能够模拟业务用户是非常重要的，因此，典型部署应是在同一台计算机上承载 BAM 门户和 Web Services。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-190">It is critical that the BAM Management Web Service is able to impersonate the business user, therefore, the typical deployment is the BAM Portal and the Web Service are hosted on the same machine</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="cfc0c-191">如果您的企业支持将 Kerberos 和 Active Directory 设置为支持委托功能，则该门户和 Web Services 可位于不同的计算机上。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-191">If your enterprise supports Kerberos and Active Directory is set up to support delegation, it is possible that the Portal and Web Service can be located on different machines.</span></span>  
  
    3.  <span data-ttu-id="cfc0c-192">Web Services 可调用 BAM 主导入中的存储过程，以执行安全检查、检索元数据以及检索与 BAM 实时聚合有关的信息。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-192">The Web Service calls stored procedures in the BAM Primary Import to perform security checks, retrieve metadata, and retrieve information about BAM Real Time Aggregations.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="cfc0c-193">BAM 门户使用名为的未记录的 Web 服务的当前**查询 Web 服务**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-193">Currently the BAM Portal uses an undocumented Web Service called the **Query Web Service**.</span></span> <span data-ttu-id="cfc0c-194">现在尚不支持该功能，而且在下一版本中可能会不赞成使用该功能。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-194">This is not supported and will most likely be deprecated in the next release.</span></span>  
  
    4.  <span data-ttu-id="cfc0c-195">Internet Explorer 是 Office Web Controls (OWC) 的宿主，而后者直接与 BAM Analysis Services 多维数据集进行连接。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-195">Internet Explorer hosts the Office Web Controls (OWC) which makes direct connections to the BAM Analysis Services cubes.</span></span>  
  
2.  <span data-ttu-id="cfc0c-196">“导出”</span><span class="sxs-lookup"><span data-stu-id="cfc0c-196">Excel</span></span>  
  
## <a name="runtime"></a><span data-ttu-id="cfc0c-197">运行时</span><span class="sxs-lookup"><span data-stu-id="cfc0c-197">Runtime</span></span>  
 <span data-ttu-id="cfc0c-198">在定义了 BAM 定义、基础结构已构建完成以及开发人员已测试所需系统启用可见性功能后，数据就可以开始在系统中进行传输了。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-198">After the BAM Definition has been defined, the infrastructure has been built out, and the developer has instrumented the necessary systems to enable visibility, data can begin flowing through the system.</span></span>  
  
### <a name="data-insertion"></a><span data-ttu-id="cfc0c-199">插入数据</span><span class="sxs-lookup"><span data-stu-id="cfc0c-199">Data Insertion</span></span>  
 <span data-ttu-id="cfc0c-200">数据流入 BAM 系统的主要方法之一就是通过 BizTalk 服务 (BTSNTSvc.exe)。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-200">One of the primary ways data flows into the BAM system is via the BizTalk Service (BTSNTSvc.exe).</span></span> <span data-ttu-id="cfc0c-201">设计 BizTalk 服务的结构，以便它可以包含逻辑子系统。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-201">The BizTalk Service is architected such that it can contain logical subsystems.</span></span>  
  
 <span data-ttu-id="cfc0c-202">下图对此过程进行了说明：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-202">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="cfc0c-203">![](../core/media/architecture-bam-06.gif "architecture_bam_06")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-203">![](../core/media/architecture-bam-06.gif "architecture_bam_06")</span></span>  
  
 <span data-ttu-id="cfc0c-204">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-204">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-205">一个子系统将作为 BizTalk Server 引擎本身的宿主。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-205">One subsystem hosts the BizTalk Server engine itself.</span></span> <span data-ttu-id="cfc0c-206">而该引擎负责执行业务流程和消息传送。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-206">The engine is responsible for executing orchestrations and messaging.</span></span>  
  
2.  <span data-ttu-id="cfc0c-207">另一个子系统为事件总线服务。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-207">Another subsystem is the Event Bus Service.</span></span> <span data-ttu-id="cfc0c-208">而该事件总线服务负责将已缓冲的事件流数据写入 BAM 主导入数据库中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-208">The Event Bus Service is responsible for writing Buffered Event Stream data into the BAM Primary Import database.</span></span>  
  
### <a name="booting-the-runtime"></a><span data-ttu-id="cfc0c-209">启动运行时</span><span class="sxs-lookup"><span data-stu-id="cfc0c-209">Booting the runtime</span></span>  
 <span data-ttu-id="cfc0c-210">在启动 BizTalk 服务时，每个子系统都会加载该子系统运行所需的元数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-210">When the BizTalk Service starts, each subsystem loads metadata that is necessary for the subsystems to operate.</span></span>  
  
 <span data-ttu-id="cfc0c-211">下图对此过程进行了说明：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-211">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="cfc0c-212">![](../core/media/architecture-bam-07.gif "architecture_bam_07")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-212">![](../core/media/architecture-bam-07.gif "architecture_bam_07")</span></span>  
  
 <span data-ttu-id="cfc0c-213">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-213">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-214">在 BizTalk 引擎执行（业务流程或消息传送）期间，它将调用用于规定数据从该引擎流入 BAM 的侦听器。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-214">When the BizTalk Engine is executing (either orchestrations or messaging), it calls into interceptors which regulate the data flow from the engine into BAM.</span></span> <span data-ttu-id="cfc0c-215">在该引擎调用侦听器时，该侦听器将根据业务流程或消息传送项目的执行顺序来分析该引擎所处的位置。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-215">When the engine calls the interceptor, the interceptor analyzes where the engine is at in relation to the order of execution for the orchestration or messaging artifacts.</span></span> <span data-ttu-id="cfc0c-216">如果需要从当前正执行引擎的位置处检索数据，则侦听器将收集相应的数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-216">If there is data that needs to be retrieved from the location where the engine is currently executing, the interceptor gathers the appropriate data.</span></span> <span data-ttu-id="cfc0c-217">用于确定需捕获的数据及其捕获位置的元数据存储在跟踪配置文件中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-217">The metadata that determines where the data needs to be captured and what data needs to be captured is housed in the Tracking Profile.</span></span> <span data-ttu-id="cfc0c-218">在 BizTalk 服务启动期间，该引擎的侦听器将与 BizTalk 管理数据库进行联系以为要执行的项目请求相应的跟踪配置文件。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-218">During booting of the BizTalk Service, the engine’s interceptors will contact the BizTalk Management database to pull the appropriate Tracking Profile for the artifacts being executed.</span></span>  
  
2.  <span data-ttu-id="cfc0c-219">事件总线服务的主要功能是将数据 BLOB（由 BizTalk 引擎写入）转换为可用数据项，并将数据插入 BAM 主导入数据库中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-219">The Event Bus Service's primary function is to convert data blobs (written by the BizTalk Engine) into usable data items and insert the data into the BAM Primary Import database.</span></span> <span data-ttu-id="cfc0c-220">消息传送侦听器将以压缩格式写入原始数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-220">The messaging interceptor writes the raw data in a compressed form.</span></span> <span data-ttu-id="cfc0c-221">这样就可以避免出现大内存工作集。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-221">This is done to avoid a large memory working set.</span></span> <span data-ttu-id="cfc0c-222">若要事件总线服务可将消息传送数据转换为可用数据项，则必须首先加载可解释原始数据的元数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-222">In order for the Event Bus Service to convert messaging data into usable data items, it must first load metadata that can interpret the raw data.</span></span> <span data-ttu-id="cfc0c-223">此元数据被称为**批注**。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-223">This metadata is known as **annotations**.</span></span> <span data-ttu-id="cfc0c-224">通过跟踪配置文件编辑器或命令行跟踪配置文件部署工具将批注元数据放置在此处。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-224">The annotation metadata was put there via the Tracking Profile Editor or the command line Tracking Profile Deploy tool.</span></span> <span data-ttu-id="cfc0c-225">如果部署的解决方案不检索来自消息传送的数据，则不存在任何批注。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-225">If the solution deployed does not retrieve data from messaging there will not be any annotations.</span></span> <span data-ttu-id="cfc0c-226">业务流程侦听器将对足够多的信息（以原始格式）进行编码，以便事件总线服务在没有任何附加批注的情况下也可以正确解码。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-226">Orchestration interceptors encode enough information in the raw form for the Event Bus Service to properly decode without having additional annotations.</span></span>  
  
### <a name="storing-data"></a><span data-ttu-id="cfc0c-227">存储数据</span><span class="sxs-lookup"><span data-stu-id="cfc0c-227">Storing data</span></span>  
 <span data-ttu-id="cfc0c-228">本部分将讨论如何从 BizTalk 服务中捕获数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-228">This section discusses how data is captured from the BizTalk Service.</span></span>  
  
 <span data-ttu-id="cfc0c-229">下图对此过程进行了说明：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-229">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="cfc0c-230">![](../core/media/architecture-bam-08.gif "architecture_bam_08")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-230">![](../core/media/architecture-bam-08.gif "architecture_bam_08")</span></span>  
  
 <span data-ttu-id="cfc0c-231">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-231">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-232">如前所述，BizTalk 引擎具有在运行时执行业务流程和消息传送解决方案期间调用的侦听器。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-232">The BizTalk engine, as described earlier, has interceptors that are called during runtime execution of orchestrations and messaging solutions.</span></span> <span data-ttu-id="cfc0c-233">根据跟踪配置文件信息，侦听器将确定要捕获的数据，然后将这些数据以二进制的形式发送到 BizTalk MessageBox。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-233">Based on the Tracking Profile information, the interceptors will determine what data to capture and then send it to the BizTalk MessageBox in a binary form.</span></span> <span data-ttu-id="cfc0c-234">存在一个 TrackingData 表，该表用于保存运行时期间捕获的序列化 BLOB 数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-234">There is a TrackingData table which holds serialized blob data captured during runtime.</span></span> <span data-ttu-id="cfc0c-235">在处理期间，有时候引擎需要存储执行期间保存在内存中的数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-235">During the processing, there are times when the engine needs to store data that it holds in memory during execution.</span></span> <span data-ttu-id="cfc0c-236">这些时候称为持久化点，而引擎将决定这些点在何时发生。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-236">These are known as persistence points, and the engine decides when these points occur.</span></span> <span data-ttu-id="cfc0c-237">在发生持久化点时，还将刷新从侦听器捕获的数据，并将这些数据保留在同一事务内。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-237">When a persistence point happens, the data that was captured from the interceptors is also flushed and persisted within the same transaction.</span></span> <span data-ttu-id="cfc0c-238">这将确保引擎中的数据与 BAM 最终可以查看的数据的一致性。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-238">This ensures the consistency of the data in the engine and ultimately what BAM can see.</span></span> <span data-ttu-id="cfc0c-239">如果发生故障并且事务回滚，则关联的 BAM 数据也将回滚。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-239">If a failure occurs and the transaction is rolled back, the associated BAM data will also be rolled back.</span></span>  
  
2.  <span data-ttu-id="cfc0c-240">事件总线服务与引擎位于同一可执行进程中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-240">The Event Bus service is housed in the same executable process as the engine.</span></span> <span data-ttu-id="cfc0c-241">该服务从 BTS 引擎存储的 TrackingData 表（或任何 BufferedEventStream 数据源）中提取数据。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-241">The service feeds off of data in the TrackingData table stored by the BTS Engine (or any BufferedEventStream data source).</span></span> <span data-ttu-id="cfc0c-242">该图将介绍程序集 – Microsoft.BizTalk.Bam.EventObservation。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-242">The picture depicts an assembly – Microsoft.BizTalk.Bam.EventObservation.</span></span> <span data-ttu-id="cfc0c-243">此程序集不公开从 BufferedEventStream 检索数据的方法。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-243">This assembly does not expose a method of retrieving the data from the BufferedEventStream.</span></span> <span data-ttu-id="cfc0c-244">此代码位于事件总线服务本身。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-244">This code is housed in the Event Bus Service itself.</span></span> <span data-ttu-id="cfc0c-245">检索数据，然后准备将其存储于主导入数据库中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-245">The data is retrieved and then prepared to be stored in the Primary Import database.</span></span> <span data-ttu-id="cfc0c-246">通常，二进制数据为序列化的 .NET 对象，在该对象的属性从其移至已格式化的 SQL 语句后将解除其冻结。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-246">For the most part, the binary data are serialized .NET objects which are rehydrated after which properties are moved from the object to formatted SQL statements.</span></span>  
  
3.  <span data-ttu-id="cfc0c-247">进行数据存储时，事件总线服务尝试使用较大的批。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-247">When storage of the data occurs, the Event Bus service attempts a large batch.</span></span> <span data-ttu-id="cfc0c-248">该批包含对 BAM 管理器部署工具生成的存储过程的调用。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-248">The batch contains calls to stored procedures that were generated by the Bam Manager deployment tool.</span></span> <span data-ttu-id="cfc0c-249">由于大量的数据库活动或其他表锁定的因素，该批可能无法存储。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-249">Due to high database activity or other table locking circumstances, the batch storage could fail.</span></span> <span data-ttu-id="cfc0c-250">发生故障时，该批将会重试若干次。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-250">In the event of a failure, the batch is tried a couple more times.</span></span> <span data-ttu-id="cfc0c-251">若重试失败，则该批将分为几个更小的批，然后重试。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-251">If the retries fail, the batch is broken up into smaller batches and retried.</span></span> <span data-ttu-id="cfc0c-252">如果仍然失败，则该批将移至 FailedTracking 表。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-252">If this fails, the batch is moved to the FailedTracking table.</span></span>  
  
### <a name="custom-data-insertion"></a><span data-ttu-id="cfc0c-253">自定义数据插入</span><span class="sxs-lookup"><span data-stu-id="cfc0c-253">Custom data insertion</span></span>  
 <span data-ttu-id="cfc0c-254">上一部分演示了 BAM 如何使用不同的方法从 BizTalk Server 主机中检索数据的详细信息。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-254">The previous section demonstrated the details of how BAM retrieves data from the BizTalk Server host using a variety of different methods.</span></span> <span data-ttu-id="cfc0c-255">其中包括了间接使用跟踪配置文件编辑器来创建配置文件，以及更直接的方法，在代码内直接使用事件流方法。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-255">Indirectly using the Tracking Profile Editor to create a profile, and more directly using the Event Stream methods directly within code.</span></span> <span data-ttu-id="cfc0c-256">但是，并非所有与 BAM 相关的数据都一定在 BizTalk 中可用。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-256">However, not all data relevant to BAM is necessarily available in BizTalk.</span></span> <span data-ttu-id="cfc0c-257">因此，存在可用于自定义写入应用程序的程序集。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-257">Therefore there is an assembly available to custom written applications.</span></span>  
  
 <span data-ttu-id="cfc0c-258">下图对此过程进行了说明：</span><span class="sxs-lookup"><span data-stu-id="cfc0c-258">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="cfc0c-259">![](../core/media/architecture-bam-09.gif "architecture_bam_09")</span><span class="sxs-lookup"><span data-stu-id="cfc0c-259">![](../core/media/architecture-bam-09.gif "architecture_bam_09")</span></span>  
  
 <span data-ttu-id="cfc0c-260">以下步骤介绍了上图中所描述的顺序。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-260">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="cfc0c-261">自定义应用程序必须能够加载[Microsoft.BizTalk.Bam.EventObservation](http://msdn.microsoft.com/library/microsoft.biztalk.bam.eventobservation.aspx)程序集访问的数据插入 BAM 活动的 BAM 方法。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-261">The custom application must be able to load the [Microsoft.BizTalk.Bam.EventObservation](http://msdn.microsoft.com/library/microsoft.biztalk.bam.eventobservation.aspx) assembly to access the BAM methods of inserting data into a BAM Activity.</span></span> <span data-ttu-id="cfc0c-262">存在两种已公开的主要类：DirectEventStream 和 BufferedEventStream。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-262">There are two primary classes that are exposed, DirectEventStream and BufferedEventStream.</span></span> <span data-ttu-id="cfc0c-263">上图中，重点介绍了 DirectEventStream 类。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-263">In the illustration above, the DirectEventStream class is highlighted.</span></span> <span data-ttu-id="cfc0c-264">此类是直接写入主导入数据库的。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-264">This class writes directly to the Primary Import database.</span></span> <span data-ttu-id="cfc0c-265">这是将数据写入 BAM 活动的最常用的方法。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-265">This is the most common method of writing data into a BAM activity.</span></span>  
  
2.  <span data-ttu-id="cfc0c-266">与 BizTalk 用于存储数据的方法相似，BufferedEventStream 类将二进制 BLOB 写入间接数据库。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-266">Similar to the method in which BizTalk stores data, the BufferedEventStream class writes binary blobs into an indirect database.</span></span> <span data-ttu-id="cfc0c-267">在这种情况下，BizTalk MessageBox 用作中间存储。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-267">In this case, the BizTalk MessageBox is used as the intermediate store.</span></span> <span data-ttu-id="cfc0c-268">您所选择的类取决于若干条件；但性能是主要考虑因素。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-268">Which class you choose depends on several things; however performance is a primary concern.</span></span> <span data-ttu-id="cfc0c-269">BufferedEventStream 类将对数据进行批处理并保持较高的吞吐量。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-269">The BufferedEventStream class will batch data and sustain higher throughput.</span></span> <span data-ttu-id="cfc0c-270">但其不足之处在于，数据不能直接写入。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-270">The drawback is that the data is not written immediately.</span></span>  
  
3.  <span data-ttu-id="cfc0c-271">与用于插入数据的 BizTalk 方法一样，事件总线服务将处理二进制数据，对其进行解码，并最终将其存储在 BAM 主导入数据库中。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-271">As with the BizTalk method of inserting data, the Event Bus Service will process the binary data, decode it, and ultimately store it within the BAM Primary Import database.</span></span> <span data-ttu-id="cfc0c-272">上述过程仅对于通过 BufferedEventStream 类写入数据是必需的。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-272">This is only required for data written via the BufferedEventStream class.</span></span>  
  
## <a name="distributed-navigation"></a><span data-ttu-id="cfc0c-273">分布式导航</span><span class="sxs-lookup"><span data-stu-id="cfc0c-273">Distributed Navigation</span></span>  
 <span data-ttu-id="cfc0c-274">用户使用 BAM 门户的分布式导航功能可以跨远程边界查看活动关系。</span><span class="sxs-lookup"><span data-stu-id="cfc0c-274">The BAM portal distributed navigation feature allows users to see activity relationships across remote boundaries.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cfc0c-275">请参阅</span><span class="sxs-lookup"><span data-stu-id="cfc0c-275">See Also</span></span>  
 [<span data-ttu-id="cfc0c-276">管理和跟踪体系结构</span><span class="sxs-lookup"><span data-stu-id="cfc0c-276">Management and Tracking Architecture</span></span>](../core/management-and-tracking-architecture.md)