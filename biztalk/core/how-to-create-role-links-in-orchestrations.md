---
title: 如何在业务流程中创建角色链接 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: cc386ac2-a851-4342-9ceb-0b6faddf4ece
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8bf9dd0026fd0da3a83e847639cbbd130400ccd9
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65385447"
---
# <a name="how-to-create-role-links-in-orchestrations"></a><span data-ttu-id="3e4c1-102">如何在业务流程中创建角色链接</span><span class="sxs-lookup"><span data-stu-id="3e4c1-102">How to Create Role Links in Orchestrations</span></span>
<span data-ttu-id="3e4c1-103">以下是你将需要完成在您的业务流程中使用角色链接的基本任务：</span><span class="sxs-lookup"><span data-stu-id="3e4c1-103">The following are the basic tasks you will need to complete to use role links in your orchestration:</span></span>  
  
-   <span data-ttu-id="3e4c1-104">创建参与方和发送端口并将其与相互关联。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-104">Create parties and send ports and associate them with each other.</span></span>  
  
-   <span data-ttu-id="3e4c1-105">使用以下过程创建角色链接类型并添加端口类型。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-105">Use the following procedure to create role link types and add the port types.</span></span>  
  
    |<span data-ttu-id="3e4c1-106">若要创建角色链接类型</span><span class="sxs-lookup"><span data-stu-id="3e4c1-106">To create a role link type</span></span>|  
    |--------------------------------|  
    |<span data-ttu-id="3e4c1-107">1.在业务流程视图窗口中，展开**类型**，右键单击**角色链接类型**，然后单击**新建角色链接类型**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-107">1.  In the Orchestration View window, expand **Types**, right-click **Role Link Types**, and then click **New Role Link Type**.</span></span><br /><span data-ttu-id="3e4c1-108">2.单击刚刚创建的角色链接类型。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-108">2.  Click the role link type you just created.</span></span> <span data-ttu-id="3e4c1-109">在属性窗口中**标识符**字段中，键入`Provider_Consumer_RoleLinkType`。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-109">In the Properties window, in the **Identifier** field, type `Provider_Consumer_RoleLinkType`.</span></span><br /><span data-ttu-id="3e4c1-110">3.展开**Provider_Consumer_RoleLinkType**，然后单击**Role_1**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-110">3.  Expand **Provider_Consumer_RoleLinkType**, and then click **Role_1**.</span></span> <span data-ttu-id="3e4c1-111">在属性窗口中**标识符**字段中，键入`ConsumerRole`。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-111">In the Properties window, in the **Identifier** field, type `ConsumerRole`.</span></span><br /><span data-ttu-id="3e4c1-112">4.右键单击**ConsumerRole**，然后单击**添加端口类型**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-112">4.  Right-click **ConsumerRole**, and then click **Add Port Type**.</span></span> <span data-ttu-id="3e4c1-113">这将启动端口类型向导。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-113">This starts the Port Type Wizard.</span></span><br /><span data-ttu-id="3e4c1-114">5.上**欢迎使用端口类型向导**页上，单击**下一步**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-114">5.  On the **Welcome to the Port Type Wizard** page, click **Next**.</span></span><br /><span data-ttu-id="3e4c1-115">6.上**选择端口类型或创建新的端口类型**页上，选择**创建新的端口类型**，然后**端口类型名称**，类型`ConsumerPortType`。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-115">6.  On the **Select a Port Type or create a new Port Type** page, select **Create a new Port Type**, and then for **Port Type Name**, type `ConsumerPortType`.</span></span><br /><span data-ttu-id="3e4c1-116">7.有关**通信模式**，选择**单向**，并为**访问限制**，选择**公有-无限制**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-116">7.  For **Communication Pattern**, select **One-Way**, and for **Access Restrictions**, select **Public - no limit**.</span></span> <span data-ttu-id="3e4c1-117">单击“下一步” 。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-117">Click **Next**.</span></span><br /><span data-ttu-id="3e4c1-118">8.上**完成端口向导**页上，单击**完成**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-118">8.  On the **Completing the Port Wizard** page, click **Finish**.</span></span><br /><span data-ttu-id="3e4c1-119">9.右键单击**Provider_Consumer_RoleLinkType**，然后单击**新角色**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-119">9. Right-click **Provider_Consumer_RoleLinkType**, and then click **New Role**.</span></span><br /><span data-ttu-id="3e4c1-120">10.单击**Role_1**，然后在属性窗口中**标识符**字段中，键入`ProviderRole`。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-120">10. Click **Role_1**, and then in the Properties window, in the **Identifier** field, type `ProviderRole`.</span></span><br /><span data-ttu-id="3e4c1-121">11.右键单击**ProviderRole**，然后单击**添加端口类型**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-121">11. Right-click **ProviderRole**, and then click **Add Port Type**.</span></span> <span data-ttu-id="3e4c1-122">这将启动端口类型向导。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-122">This starts the Port Type Wizard.</span></span><br /><span data-ttu-id="3e4c1-123">12.上**欢迎使用端口类型向导**页上，单击**下一步**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-123">12. On the **Welcome to the Port Type Wizard** page, click **Next**.</span></span><br /><span data-ttu-id="3e4c1-124">13.上**选择端口类型或创建新的端口类型**页上，选择**创建新的端口类型**，然后**端口类型名称**，类型`ProviderPortType`。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-124">13. On the **Select a Port Type or create a new Port Type** page, select **Create a new Port Type**, and then for **Port Type Name**, type `ProviderPortType`.</span></span><br /><span data-ttu-id="3e4c1-125">14.有关**通信模式**，选择**单向**，并为**访问限制**，选择**公有-无限制**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-125">14. For **Communication Pattern**, select **One-Way**, and for **Access Restrictions**, select **Public - no limit**.</span></span> <span data-ttu-id="3e4c1-126">单击“下一步” 。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-126">Click **Next**.</span></span><br /><span data-ttu-id="3e4c1-127">15.上**完成端口向导**页上，单击**完成**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-127">15. On the **Completing the Port Wizard** page, click **Finish**.</span></span> <span data-ttu-id="3e4c1-128">**注意：**     置于角色链接内配置的端口不会保留其关联的绑定信息。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-128">**Note:**      Configured ports placed inside of role links do not retain their associated binding information.</span></span>|  
  
     <span data-ttu-id="3e4c1-129">在前面的过程中，创建包含两个角色的角色链接类型 — ProviderRole 将接收和处理消息从使用者和 ConsumerRole，您的业务流程将使用提供的发送端口与该角色将消息发送到使用者。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-129">In the preceding procedure, you create a role link type that contains two roles—a ProviderRole that will receive and process messages from the consumer and a ConsumerRole that your orchestration will use the send port provided with the role to send messages to the consumer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3e4c1-130">角色链接类型可以包含一个提供者角色和使用者角色，并且它可以包含其中任何一个或之一，具体取决于您的业务流程的每个需要。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-130">The role link type can contain a provider role and a consumer role, and it can include one of either or one of each, depending on your business process needs.</span></span>  
  
-   <span data-ttu-id="3e4c1-131">使用以下过程将角色链接添加到您的业务流程。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-131">Use the following procedure to add role links to your orchestration.</span></span>  
  
    |<span data-ttu-id="3e4c1-132">若要使用角色链接向导创建角色链接</span><span class="sxs-lookup"><span data-stu-id="3e4c1-132">To create a role link by using the Role Link Wizard</span></span>|  
    |---------------------------------------------------------|  
    |<span data-ttu-id="3e4c1-133">1.在业务流程工具箱中拖动**角色链接**形状添加到设计图面。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-133">1.  In the orchestration Toolbox, drag the **Role Link** shape to the design surface.</span></span> <span data-ttu-id="3e4c1-134">这将启动角色链接向导。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-134">This starts the Role Link Wizard.</span></span><br /><span data-ttu-id="3e4c1-135">2.上**欢迎使用角色链接向导**页上，单击**下一步**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-135">2.  On the **Welcome to the Role Link Wizard** page, click **Next**.</span></span><br /><span data-ttu-id="3e4c1-136">3.上**角色链接名称**页上，在**名称**字段中，键入`Provider_Consumer`。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-136">3.  On the **Role Link Name** page, in the **Name** field, type `Provider_Consumer`.</span></span> <span data-ttu-id="3e4c1-137">单击“下一步” 。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-137">Click **Next**.</span></span><br /><span data-ttu-id="3e4c1-138">4.上**角色链接类型**页上，选择**使用现有角色链接类型**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-138">4.  On the **Role Link Type** page, select **Use an existing Role Link Type**.</span></span> <span data-ttu-id="3e4c1-139">在中**角色链接类型名称**下拉列表中，选择**Provider_Consumer_RoleLinkType**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-139">In the **Role Link Type Name** drop-down list, select **Provider_Consumer_RoleLinkType**.</span></span> <span data-ttu-id="3e4c1-140">单击“下一步” 。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-140">Click **Next**.</span></span><br /><span data-ttu-id="3e4c1-141">5.上**角色标识**页上，选择**ProviderRole**从**此业务流程将实现哪个角色来接收和处理来自合作伙伴的消息？** 下拉列表。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-141">5.  On the **Role Identification** page, select **ProviderRole** from the **Which role will this orchestration implement to receive and process messages from partners?** drop-down list.</span></span> <span data-ttu-id="3e4c1-142">向导会自动选择**ConsumerRole**有关**此业务流程将使用下面的角色将消息发送到该角色内端口上的合作伙伴**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-142">The wizard automatically selects **ConsumerRole** for **This orchestration will use the role below to send messages to partners on ports inside the role**.</span></span> <span data-ttu-id="3e4c1-143">单击“下一步” 。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-143">Click **Next**.</span></span><br /><span data-ttu-id="3e4c1-144">6.上**角色链接用法**页上，选择**我会将第一条消息发送到我的合作伙伴的角色**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-144">6.  On the **Role Link Usage** page, select **I will be sending the first message to my partner's role**.</span></span> <span data-ttu-id="3e4c1-145">单击 **“完成”**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-145">Click **Finish**.</span></span>|  
  
     <span data-ttu-id="3e4c1-146">在前面的过程中，您将 ConsumerRole 进一步定义为初始化角色。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-146">In the preceding procedure, you further define the ConsumerRole as the initiating role.</span></span> <span data-ttu-id="3e4c1-147">这意味着，您的业务流程会向通过 ConsumerRole 提供的端口使用者发送第一条消息，然后 ProviderRole 将接收从使用者进行进一步处理发送的消息。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-147">This means that your orchestration will send the first message to the consumer through the port provided by the ConsumerRole and then the ProviderRole will receive the message sent back from the consumer for further processing.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="3e4c1-148">如果角色链接类型中只有一个角色，需要通过选择业务流程中定义你的角色**提供者角色：我将接收第一条消息**或**使用者角色：我将发送第一条消息**而不是执行步骤 5 中前面的过程。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-148">If there is only one role in the role link type, you need to define your role in the business process by selecting either **Provider Role: I will be receiving the first message** or **Consumer Role: I will be sending the first message** instead of performing step 5 in the preceding procedure.</span></span>  
  
-   <span data-ttu-id="3e4c1-149">设计业务流程。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-149">Design your business process.</span></span> <span data-ttu-id="3e4c1-150">您可以利用相关集来确保传入消息与业务流程的相应实例相匹配。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-150">You can leverage correlation sets to ensure that an incoming message matches the appropriate instance of an orchestration.</span></span>  
  
-   <span data-ttu-id="3e4c1-151">将与端口相关联**发送**并**接收**形状。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-151">Associate the ports with **Send** and **Receive** shapes.</span></span> <span data-ttu-id="3e4c1-152">此外，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="3e4c1-152">In addition, do the following:</span></span>  
  
    -   <span data-ttu-id="3e4c1-153">如果初始化角色是发送消息的使用者，显式设置**DestinationParty**属性 （仅一次） 在业务流程中的。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-153">If the initiating role is a consumer for sending messages, explicitly set the **DestinationParty** property (once and only once) in your orchestration.</span></span> <span data-ttu-id="3e4c1-154">若要执行此操作，设置的值**DestinationParty**中**表达式**形状，如下面的示例，其中，ConfirmOrder 是角色链接的名称，PartnerName 和 OrganizationName 是参数中所示参与方：</span><span class="sxs-lookup"><span data-stu-id="3e4c1-154">To do so, set the value of the **DestinationParty** in the **Expression** shape, as in the following example, where ConfirmOrder is the name of a role link, and PartnerName and OrganizationName are parameters of a party:</span></span>  
  
        ```  
        ConfirmOrder(Microsoft.XLANGs.BaseTypes.DestinationParty) = new Microsoft.XLANGs.BaseTypes.Party("PartnerName", "OrganizationName");  
        ```  
  
    -   <span data-ttu-id="3e4c1-155">如果初始化角色是用于接收消息，提供商**DestinationParty**接收方会自动初始化属性。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-155">If the initiating role is a provider for receiving messages, the **DestinationParty** property is initialized automatically by the receiver.</span></span> <span data-ttu-id="3e4c1-156">**DestinationParty**设置为提供程序本身。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-156">The **DestinationParty** is set to the provider itself.</span></span> <span data-ttu-id="3e4c1-157">**SourceParty**属性是只读的并且提供通过受信任的管道组件以解析参与方名称基于安全标识符 (SID) 发件人或与该参与方相关联的证书。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-157">The **SourceParty** property is read-only, and is supplied through a trusted pipeline component to resolve the party name based on the security identifier (SID) of the sender or on a certificate associated with the party.</span></span> <span data-ttu-id="3e4c1-158">运行该管道组件的主机必须标记为**受信任验证**。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-158">The host running the pipeline component must be marked as **Authentication Trusted**.</span></span> <span data-ttu-id="3e4c1-159">你可以获取的值**SourceParty**中**表达式**形状使用下面的示例代码：</span><span class="sxs-lookup"><span data-stu-id="3e4c1-159">You can get the value of the **SourceParty** in the **Expression** shape by using the following sample code:</span></span>  
  
        ```  
        PartyName = Buyer_Supplier(Microsoft.XLANGs.BaseTypes.SourceParty);  
        ```  
  
## <a name="examples-of-using-role-links"></a><span data-ttu-id="3e4c1-160">使用角色链接的示例</span><span class="sxs-lookup"><span data-stu-id="3e4c1-160">Examples of Using Role Links</span></span>  
  
-   [<span data-ttu-id="3e4c1-161">PartyResolution（BizTalk Server 示例）</span><span class="sxs-lookup"><span data-stu-id="3e4c1-161">PartyResolution (BizTalk Server Sample)</span></span>](../core/partyresolution-biztalk-server-sample.md)  
  
-   <span data-ttu-id="3e4c1-162">从 BizTalk Server 代码示例可在下载 SDK 示例"使用角色链接" [ http://go.microsoft.com/fwlink/?LinkId=73703 ](http://go.microsoft.com/fwlink/?LinkId=73703)。</span><span class="sxs-lookup"><span data-stu-id="3e4c1-162">Download the SDK sample "Using Role Links" from the BizTalk Server code samples available at [http://go.microsoft.com/fwlink/?LinkId=73703](http://go.microsoft.com/fwlink/?LinkId=73703).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3e4c1-163">请参阅</span><span class="sxs-lookup"><span data-stu-id="3e4c1-163">See Also</span></span>  
 <span data-ttu-id="3e4c1-164">[在业务流程中使用角色链接](../core/using-role-links-in-orchestrations.md) </span><span class="sxs-lookup"><span data-stu-id="3e4c1-164">[Using Role Links in Orchestrations](../core/using-role-links-in-orchestrations.md) </span></span>  
 <span data-ttu-id="3e4c1-165">[如何使用角色链接形状](../core/how-to-use-the-role-link-shape.md) </span><span class="sxs-lookup"><span data-stu-id="3e4c1-165">[How to Use the Role Link Shape](../core/how-to-use-the-role-link-shape.md) </span></span>  
 [<span data-ttu-id="3e4c1-166">如何使用角色链接向导</span><span class="sxs-lookup"><span data-stu-id="3e4c1-166">How to Use the Role Link Wizard</span></span>](../core/how-to-use-the-role-link-wizard.md)