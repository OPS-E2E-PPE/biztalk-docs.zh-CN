---
title: 在业务流程中实现设计模式 |Microsoft Docs
description: 聚合器、 基于内容的路由、 动态路由器、 错误处理、 消息中转站和 BizTalk Server 中的多个设计模式
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f62ba955-018a-40e7-b303-497acc906019
caps.latest.revision: 14
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 932a9563c338be0e5e29a2968ea4da52e1b65045
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65332427"
---
# <a name="implement-design-patterns-in-orchestrations"></a><span data-ttu-id="9f884-103">在业务流程中实现设计模式</span><span class="sxs-lookup"><span data-stu-id="9f884-103">Implement Design Patterns in Orchestrations</span></span>
<span data-ttu-id="9f884-104">本部分讨论 BizTalk Server 编程，以及企业集成模式的常见模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-104">This section discusses the common patterns of BizTalk Server programming as well as enterprise integration patterns.</span></span> <span data-ttu-id="9f884-105">可利用单一模式或组合使用多个模式来设计您的业务流程，然后使用 BizTalk 业务流程设计器中的形状实现该设计。</span><span class="sxs-lookup"><span data-stu-id="9f884-105">You can leverage a single pattern or combine multiple patterns to design your business process and then implement the design by using shapes in BizTalk Orchestration Designer.</span></span>  
  
## <a name="design-patterns"></a><span data-ttu-id="9f884-106">设计模式</span><span class="sxs-lookup"><span data-stu-id="9f884-106">Design Patterns</span></span>  
 <span data-ttu-id="9f884-107">以下条目简要介绍每种模式，并指向的主题或示例，用于演示如何实现使用 BizTalk 业务流程设计器的模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-107">The following entries briefly describe each pattern and point to the topics or samples that show how to implement the patterns using BizTalk Orchestration Designer.</span></span>  
  
### <a name="aggregator"></a><span data-ttu-id="9f884-108">聚合器</span><span class="sxs-lookup"><span data-stu-id="9f884-108">Aggregator</span></span>  
 <span data-ttu-id="9f884-109">聚合器是从多个源接收的信息，并且合并为单个消息的模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-109">Aggregator is the pattern of receiving information from multiple sources and consolidating it into a single message.</span></span> <span data-ttu-id="9f884-110">此模式的示例，请参阅中的 Aggregate.odx[聚合器 （BizTalk Server 示例）](../core/aggregator-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-110">For an example of this pattern, see Aggregate.odx in [Aggregator (BizTalk Server Sample)](../core/aggregator-biztalk-server-sample.md).</span></span>  
  
### <a name="calling-pipelines-from-an-orchestration"></a><span data-ttu-id="9f884-111">从业务流程调用管道</span><span class="sxs-lookup"><span data-stu-id="9f884-111">Calling Pipelines from an Orchestration</span></span>  
 <span data-ttu-id="9f884-112">可以调用发送和接收管道从你的业务流程。</span><span class="sxs-lookup"><span data-stu-id="9f884-112">You can call send and receive pipelines from your orchestrations.</span></span> <span data-ttu-id="9f884-113">这允许重用管道，并有助于保持业务流程与管道阶段的分离。</span><span class="sxs-lookup"><span data-stu-id="9f884-113">This allows the reuse of pipelines and helps maintain the decoupling of an orchestration from the pipeline stages.</span></span> <span data-ttu-id="9f884-114">此模式的示例，请参阅中的 Aggregate.odx[聚合器 （BizTalk Server 示例）](../core/aggregator-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-114">For an example of this pattern, see Aggregate.odx in [Aggregator (BizTalk Server Sample)](../core/aggregator-biztalk-server-sample.md).</span></span> <span data-ttu-id="9f884-115">另一个示例是中的 CMP.odx[组合消息处理器 （BizTalk Server 示例）](../core/composed-message-processor-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-115">Another example is CMP.odx in [Composed Message Processor (BizTalk Server Sample)](../core/composed-message-processor-biztalk-server-sample.md).</span></span> <span data-ttu-id="9f884-116">另请参阅[如何使用表达式执行管道](../core/how-to-use-expressions-to-execute-pipelines.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-116">See also [How to Use Expressions to Execute Pipelines](../core/how-to-use-expressions-to-execute-pipelines.md).</span></span>  
  
### <a name="composed-message-processor"></a><span data-ttu-id="9f884-117">组合的消息处理器</span><span class="sxs-lookup"><span data-stu-id="9f884-117">Composed Message Processor</span></span>  
 <span data-ttu-id="9f884-118">组合的消息处理器是处理中的聚合或批交换消息的各个项的模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-118">Composed Message Processor is the pattern of processing individual items from an aggregated or batched interchange message.</span></span> <span data-ttu-id="9f884-119">此模式的示例，请参阅中的 CMP.odx[组合消息处理器 （BizTalk Server 示例）](../core/composed-message-processor-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-119">For an example of this pattern, see CMP.odx in [Composed Message Processor (BizTalk Server Sample)](../core/composed-message-processor-biztalk-server-sample.md).</span></span>  
  
### <a name="content-based-router"></a><span data-ttu-id="9f884-120">基于内容的路由器</span><span class="sxs-lookup"><span data-stu-id="9f884-120">Content-Based Router</span></span>  
 <span data-ttu-id="9f884-121">基于内容的路由器是确定基于消息内容的某些部分消息的收件人的模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-121">Content-Based Router is the pattern of determining the recipient of a message based on some part of the message content.</span></span> <span data-ttu-id="9f884-122">此模式的示例，请参阅[CBRSample （BizTalk Server 示例）](../core/cbrsample-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-122">For an example of this pattern, see [CBRSample (BizTalk Server Sample)](../core/cbrsample-biztalk-server-sample.md).</span></span>  
  
### <a name="dynamic-router"></a><span data-ttu-id="9f884-123">动态路由器</span><span class="sxs-lookup"><span data-stu-id="9f884-123">Dynamic Router</span></span>  
 <span data-ttu-id="9f884-124">动态路由器是处理的确定目标地址，以及基于消息结果的传输协议的模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-124">Dynamic Router is the pattern of determining the destination address as well as the transport protocol based on the result of message processing.</span></span> <span data-ttu-id="9f884-125">您可以使用动态发送端口或**角色链接**形状来实现此模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-125">You can use a dynamic send port or a **Role Link** shape to implement this pattern.</span></span> <span data-ttu-id="9f884-126">此模式的示例，请参阅参阅中的 ReceiveSend.odx [SendMail](../core/sendmail.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-126">For an example of this pattern, see ReceiveSend.odx in [SendMail](../core/sendmail.md).</span></span> <span data-ttu-id="9f884-127">另一个示例是中的 SupplierProcess.odx [PartyResolution （BizTalk Server 示例）](../core/partyresolution-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-127">Another example is SupplierProcess.odx in [PartyResolution (BizTalk Server Sample)](../core/partyresolution-biztalk-server-sample.md).</span></span>  
  
### <a name="error-handling"></a><span data-ttu-id="9f884-128">错误处理</span><span class="sxs-lookup"><span data-stu-id="9f884-128">Error Handling</span></span>  
 <span data-ttu-id="9f884-129">BizTalk Server 允许您指定的消息作为将失败消息放在挂起队列中的默认行为的替代方法传送失败进行自动的处理。</span><span class="sxs-lookup"><span data-stu-id="9f884-129">BizTalk Server allows you to designate automated handling of messaging failures as an alternative to the default behavior of placing failed messages in the Suspended queue.</span></span> <span data-ttu-id="9f884-130">可以将失败的消息路由至订阅端口，以便进行报告或处理。</span><span class="sxs-lookup"><span data-stu-id="9f884-130">You can route failed messages to a subscribing port for reporting or processing.</span></span> <span data-ttu-id="9f884-131">此模式的示例，请参阅参阅中的 ResubmitLogic.odx[错误处理 （BizTalk Server 示例文件夹）](../core/error-handling-biztalk-server-samples-folder.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-131">For an example of this pattern, see ResubmitLogic.odx in [Error Handling (BizTalk Server Samples Folder)](../core/error-handling-biztalk-server-samples-folder.md).</span></span>  
  
### <a name="exception-handling-and-compensation"></a><span data-ttu-id="9f884-132">异常处理和补偿</span><span class="sxs-lookup"><span data-stu-id="9f884-132">Exception Handling and Compensation</span></span>  
 <span data-ttu-id="9f884-133">可以使用异常处理程序和一个**引发异常**形状或**表达式**异常处理的形状。</span><span class="sxs-lookup"><span data-stu-id="9f884-133">You can use an exception handler and a **Throw Exception** shape or an **Expression** shape for exception handling.</span></span> <span data-ttu-id="9f884-134">例如，可以将下面的代码中放置**表达式**形状引发的异常:，</span><span class="sxs-lookup"><span data-stu-id="9f884-134">For example, you can place the following code in the **Expression** shape to throw the exception:,</span></span>  
  
```  
excp = new System.Exception();  
throw(excp);  
```  
  
 <span data-ttu-id="9f884-135">可以使用补偿模块和一个**补偿**形状上已提交的事务执行补偿。</span><span class="sxs-lookup"><span data-stu-id="9f884-135">You can use a compensation block and a **Compensate** shape to perform the compensation on the transactions that have been committed.</span></span> <span data-ttu-id="9f884-136">此模式的示例，请参阅中的 UpdateContact.odx[补偿 （BizTalk Server 示例）](../core/compensation-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-136">For an example of this pattern, see UpdateContact.odx in [Compensation (BizTalk Server Sample)](../core/compensation-biztalk-server-sample.md).</span></span> <span data-ttu-id="9f884-137">另一个示例是在[自定义异常](../core/custom-exceptions.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-137">Another example is in [Custom Exceptions](../core/custom-exceptions.md).</span></span>  
  
### <a name="message-broker"></a><span data-ttu-id="9f884-138">消息代理</span><span class="sxs-lookup"><span data-stu-id="9f884-138">Message Broker</span></span>  
 <span data-ttu-id="9f884-139">消息代理是确定消息的目标，同时仍维持对消息流控制的模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-139">Message Broker is the pattern of determining the destination of a message and still maintaining control over the message flow.</span></span> <span data-ttu-id="9f884-140">有关详细信息，请参阅[在 OrderBroker 业务流程中处理](../core/processing-in-the-orderbroker-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-140">For more, see  [Processing in the OrderBroker Orchestration](../core/processing-in-the-orderbroker-orchestration.md).</span></span>  
  
### <a name="message-filter"></a><span data-ttu-id="9f884-141">消息筛选器</span><span class="sxs-lookup"><span data-stu-id="9f884-141">Message Filter</span></span>  
 <span data-ttu-id="9f884-142">消息筛选器模式可以选择符合特定处理条件的消息。</span><span class="sxs-lookup"><span data-stu-id="9f884-142">The Message Filter pattern selects messages meeting particular criteria for processing.</span></span> <span data-ttu-id="9f884-143">您可以通过向激活添加筛选器表达式来实现此模式**接收**形状。</span><span class="sxs-lookup"><span data-stu-id="9f884-143">You can implement this pattern by adding the filter expression to an activated **Receive** shape.</span></span> <span data-ttu-id="9f884-144">有关详细信息，请参阅[使用筛选器与接收消息形状](../core/using-filters-with-the-receive-message-shape.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-144">For more information, see [Using Filters With the Receive Message Shape](../core/using-filters-with-the-receive-message-shape.md).</span></span>  
  
### <a name="message-translator"></a><span data-ttu-id="9f884-145">消息转换器</span><span class="sxs-lookup"><span data-stu-id="9f884-145">Message Translator</span></span>  
 <span data-ttu-id="9f884-146">消息转换器模式将消息从一种形式转换为另一种形式。</span><span class="sxs-lookup"><span data-stu-id="9f884-146">The Message Translator pattern converts a message from one form to another form.</span></span> <span data-ttu-id="9f884-147">您可以通过使用与 BizTalk 映射实现此模式**转换**形状在业务流程中的。</span><span class="sxs-lookup"><span data-stu-id="9f884-147">You can implement this pattern by using a BizTalk map with a **Transform** shape in an orchestration.</span></span> <span data-ttu-id="9f884-148">此模式的示例，请参阅中的 HelloOrchestration.odx [HelloWorld （BizTalk Server 示例）](../core/helloworld-biztalk-server-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="9f884-148">For an example of this pattern, see HelloOrchestration.odx in [HelloWorld (BizTalk Server Sample)](../core/helloworld-biztalk-server-sample.md).</span></span>  
  
### <a name="parallel-convoy"></a><span data-ttu-id="9f884-149">并行保护</span><span class="sxs-lookup"><span data-stu-id="9f884-149">Parallel Convoy</span></span>  
 <span data-ttu-id="9f884-150">并行保护模式可以使多个单一项连接在一起以实现类似的单个项不能通过本身来完成。</span><span class="sxs-lookup"><span data-stu-id="9f884-150">The Parallel Convoy pattern enables multiple single items to join together to achieve something that an individual item cannot accomplish by itself.</span></span> <span data-ttu-id="9f884-151">一组相关项可以按任意顺序到达，但 BizTalk Server 必须在启动进程之前收到所有项。</span><span class="sxs-lookup"><span data-stu-id="9f884-151">The set of related items can arrive in any order, but BizTalk Server must receive all of them before starting the process.</span></span> 
  
### <a name="scatter-and-gather"></a><span data-ttu-id="9f884-152">分散与收集</span><span class="sxs-lookup"><span data-stu-id="9f884-152">Scatter and Gather</span></span>  
 <span data-ttu-id="9f884-153">分散与收集模式，将消息发送给多个收件人和消息，以接收来自每个收件人。</span><span class="sxs-lookup"><span data-stu-id="9f884-153">The Scatter and Gather pattern enables messages to be sent to multiple recipients and messages to be received back from each recipient.</span></span> <span data-ttu-id="9f884-154">您可以通过使用拆分器模式和聚合器模式来实现此模式。</span><span class="sxs-lookup"><span data-stu-id="9f884-154">You can implement this pattern by using the Splitter pattern and the Aggregator pattern.</span></span> <span data-ttu-id="9f884-155">使用聚合器模式来组装使用拆分器模式得到结果并将其下放置**并行操作**形状。</span><span class="sxs-lookup"><span data-stu-id="9f884-155">You use the Aggregator pattern to assemble the results from using the Splitter pattern and put them under a **Parallel Actions** shape.</span></span> 
  
### <a name="sequential-convoy"></a><span data-ttu-id="9f884-156">顺序保护</span><span class="sxs-lookup"><span data-stu-id="9f884-156">Sequential Convoy</span></span>  
 <span data-ttu-id="9f884-157">顺序保护模式可以使多个单一项连接在一起以实现类似的单个项不能通过本身来完成。</span><span class="sxs-lookup"><span data-stu-id="9f884-157">The Sequential Convoy pattern enables multiple single items to join together to achieve something that an individual item cannot accomplish by itself.</span></span> <span data-ttu-id="9f884-158">顺序保护是一组具有预定义的顺序的相关项。</span><span class="sxs-lookup"><span data-stu-id="9f884-158">A sequential convoy is a set of related items that have a predefined order.</span></span> <span data-ttu-id="9f884-159">虽然这些项不需要是完全相同，但 BizTalk Server 必须按顺序接收项。</span><span class="sxs-lookup"><span data-stu-id="9f884-159">Although the items do not have to be exactly the same, BizTalk Server must receive the items in a sequential order.</span></span> 
  
### <a name="splitter"></a><span data-ttu-id="9f884-160">拆分器</span><span class="sxs-lookup"><span data-stu-id="9f884-160">Splitter</span></span>  
 <span data-ttu-id="9f884-161">拆分器模式获取一条消息，并将它拆分为多条消息。</span><span class="sxs-lookup"><span data-stu-id="9f884-161">The Splitter pattern takes a single message and splits it into multiple messages.</span></span>  
  
### <a name="suspend-with-retry"></a><span data-ttu-id="9f884-162">挂起并重试</span><span class="sxs-lookup"><span data-stu-id="9f884-162">Suspend with Retry</span></span>  
 <span data-ttu-id="9f884-163">挂起并重试模式使业务流程错误时将消息挂起。</span><span class="sxs-lookup"><span data-stu-id="9f884-163">The Suspend with Retry pattern enables the orchestration to suspend a message when there is an error.</span></span> <span data-ttu-id="9f884-164">挂起发生在循环中，以便该业务流程挂起、 请求干预，和固定的次数然后重试该操作。</span><span class="sxs-lookup"><span data-stu-id="9f884-164">The suspension occurs within a loop so that the orchestration suspends, asks for intervention, and then retries the operation a fixed number of times.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9f884-165">请参阅</span><span class="sxs-lookup"><span data-stu-id="9f884-165">See Also</span></span>  
 [<span data-ttu-id="9f884-166">设计业务流程流</span><span class="sxs-lookup"><span data-stu-id="9f884-166">Designing Orchestration Flow</span></span>](../core/designing-orchestration-flow.md)