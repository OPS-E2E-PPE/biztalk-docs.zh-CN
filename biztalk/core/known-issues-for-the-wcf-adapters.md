---
title: 用于 WCF 适配器的已知问题 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 423c6021-5fb7-48c9-9319-11e7a18c775c
caps.latest.revision: 54
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 05951b5bfd2f586cdaf88bc11bdf12f505ef15b1
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65330735"
---
# <a name="known-issues-for-the-wcf-adapters"></a><span data-ttu-id="4cee9-102">WCF 适配器的已知的问题</span><span class="sxs-lookup"><span data-stu-id="4cee9-102">Known Issues for the WCF Adapters</span></span>
<span data-ttu-id="4cee9-103">本主题介绍 BizTalk Server 附带的 WCF 适配器的已知的问题。</span><span class="sxs-lookup"><span data-stu-id="4cee9-103">This topic describes the known issues for the WCF adapters included with BizTalk Server.</span></span>  
  
## <a name="a-message-that-fails-in-the-inbound-soap-marshaling-processing-is-not-suspended-in-wcf-receive-adapters"></a><span data-ttu-id="4cee9-104">在入站 SOAP 封送处理中的失败 WCF 中不会挂起消息接收适配器</span><span class="sxs-lookup"><span data-stu-id="4cee9-104">A message that fails in the inbound SOAP marshaling processing is not suspended in WCF receive adapters</span></span>  
 <span data-ttu-id="4cee9-105">当消息到达 WCF 接收适配器，WCF 适配器从传入 SOAP 消息创建 BizTalk 消息，然后将 BizTalk 消息传递到由终结点管理器管理的传输代理。</span><span class="sxs-lookup"><span data-stu-id="4cee9-105">When a message arrives at a WCF receive adapter, the WCF adapter creates a BizTalk message from the incoming SOAP message, and then passes the BizTalk message to the transport proxy, which is managed by the Endpoint Manager.</span></span> <span data-ttu-id="4cee9-106">如果适配器无法创建 BizTalk 消息时读取 SOAP 信封和正文，则消息未挂起，因为适配器使用快速、 非缓存和只进读取器来访问 SOAP 消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-106">If the adapter fails to read the SOAP envelope and body while creating the BizTalk message, the message is not suspended because the adapter uses the fast, non-cached, and forward-only reader to access the SOAP message.</span></span>  
  
 <span data-ttu-id="4cee9-107">应检查失败的消息在事件日志。</span><span class="sxs-lookup"><span data-stu-id="4cee9-107">You should check the event log for the failed message.</span></span> <span data-ttu-id="4cee9-108">例如，可以在使用的正文路径表达式**消息**WCF 适配器传输属性对话框中，指定如何通过 WCF 适配器传入的 SOAP 消息创建入站的 BizTalk 消息正文中的选项卡。</span><span class="sxs-lookup"><span data-stu-id="4cee9-108">For example, you can use a body path expression on the **Messages** tab in the WCF adapter transport properties dialog box to specify how to create the inbound BizTalk message body from a SOAP message incoming through the WCF adapter.</span></span> <span data-ttu-id="4cee9-109">当传入的 SOAP 消息的无效的正文路径表达式上提供了为**消息**选项卡上，则适配器无法创建 BizTalk 消息且无法挂起传入消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-109">When an invalid body path expression for the incoming SOAP message is supplied on the **Messages** tab, the adapter fails to create the BizTalk message and cannot suspend the incoming message.</span></span> <span data-ttu-id="4cee9-110">详细了解如何在使用的正文路径表达式**消息**选项卡上，请参阅[WCF 适配器指定消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="4cee9-110">For more information about how to use the body path expression on the **Messages** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
 <span data-ttu-id="4cee9-111">下图显示**消息**选项卡可以在其中指定如何从传入 SOAP 消息创建入站的 BizTalk 消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-111">The following figure shows the **Messages** tab on which you can specify how to create inbound BizTalk messages from the incoming SOAP messages.</span></span>  
  
## <a name="a-message-that-fails-in-the-inbound-soap-marshaling-processing-is-not-suspended-in-wcf-send-adapters"></a><span data-ttu-id="4cee9-112">在 WCF 发送适配器不挂起入站 SOAP 封送处理中失败的消息</span><span class="sxs-lookup"><span data-stu-id="4cee9-112">A message that fails in the inbound SOAP marshaling processing is not suspended in WCF send adapters</span></span>  
 <span data-ttu-id="4cee9-113">要求-响应 WCF 发送端口可以接收 WCF 消息作为响应消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-113">The solicit-response WCF send port can receive a WCF message as a response message.</span></span> <span data-ttu-id="4cee9-114">当消息到达 WCF 发送适配器，WCF 适配器从传入 SOAP 消息创建 BizTalk 消息，然后将 BizTalk 消息传递到由终结点管理器管理的传输代理。</span><span class="sxs-lookup"><span data-stu-id="4cee9-114">When the message arrives at the WCF send adapter, the WCF adapter creates the BizTalk message from the incoming SOAP message, and then passes the BizTalk message to the transport proxy, which is managed by the Endpoint Manager.</span></span> <span data-ttu-id="4cee9-115">如果适配器无法创建 BizTalk 消息时读取 SOAP 信封和正文，则消息未挂起，因为适配器使用快速、 非缓存和只进读取器来访问 SOAP 消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-115">If the adapter fails to read the SOAP envelope and body while creating the BizTalk message, the message is not suspended because the adapter uses the fast, non-cached, and forward-only reader to access the SOAP message.</span></span>  
  
 <span data-ttu-id="4cee9-116">应检查失败的消息在事件日志。</span><span class="sxs-lookup"><span data-stu-id="4cee9-116">You should check the event log for the failed message.</span></span> <span data-ttu-id="4cee9-117">例如，可以使用 XPath 表达式上**消息**WCF 适配器传输属性对话框中，指定如何通过 WCF 适配器传入的 SOAP 消息创建入站的 BizTalk 消息正文中的选项卡。</span><span class="sxs-lookup"><span data-stu-id="4cee9-117">For example, you can use an XPath expression on the **Messages** tab in the WCF adapter transport properties dialog box to specify how to create the inbound BizTalk message body from a SOAP message incoming through the WCF adapter.</span></span> <span data-ttu-id="4cee9-118">当传入的 SOAP 消息的 XPath 表达式无效上提供了为**消息**选项卡上，则适配器无法创建 BizTalk 消息且无法挂起传入消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-118">When an invalid XPath expression for the incoming SOAP message is supplied on the **Messages** tab, the adapter fails to create the BizTalk message and cannot suspend the incoming message.</span></span> <span data-ttu-id="4cee9-119">有关如何在使用 XPath 表达式的详细信息**消息**选项卡上，请参阅[WCF 适配器指定消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="4cee9-119">For more information about how to use the XPath expression on the **Messages** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
 <span data-ttu-id="4cee9-120">下图显示**消息**Wcf-netnamedpipe 发送适配器作为示例的选项卡。</span><span class="sxs-lookup"><span data-stu-id="4cee9-120">The following figure shows the **Messages** tab of the WCF-NetNamedPipe send adapter as an example.</span></span>  
  
 <span data-ttu-id="4cee9-121">![WCF 中的消息选项卡发送适配器](../core/media/54623ccf-49a9-4b6a-9487-da0d94bab64d.gif "54623ccf-49a9-4b6a-9487-da0d94bab64d")</span><span class="sxs-lookup"><span data-stu-id="4cee9-121">![The Messages tab in the WCF send adapters](../core/media/54623ccf-49a9-4b6a-9487-da0d94bab64d.gif "54623ccf-49a9-4b6a-9487-da0d94bab64d")</span></span>  
  
## <a name="messages-can-be-lost-when-using-onewaybindingelement-in-a-two-way-transport-with-custom-binding-in-non-transactional-wcf-receive-locations"></a><span data-ttu-id="4cee9-122">消息可能会丢失时 OneWayBindingElement 将双向传输中使用自定义绑定中非事务性 WCF 接收位置</span><span class="sxs-lookup"><span data-stu-id="4cee9-122">Messages can be lost when using OneWayBindingElement in a two-way transport with custom binding in non-transactional WCF receive locations</span></span>  
 <span data-ttu-id="4cee9-123">在双向通信中，WCF 适配器将发送响应，直到在 MessageBox 数据库中保存的消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-123">In a two-way communication, WCF adapters will send the response back until the messages have been persisted in the MessageBox database.</span></span> <span data-ttu-id="4cee9-124">但是，使用**OneWayBindingElement**调度到 WCF 适配器收到的消息之前生成虚拟响应。</span><span class="sxs-lookup"><span data-stu-id="4cee9-124">However, using **OneWayBindingElement** generates a dummy response immediately before dispatching the received message to the WCF adapter.</span></span> <span data-ttu-id="4cee9-125">因此，如果配置自定义绑定与**OneWayBindingElement**在非事务性的双向传输通道堆栈中接收位置，因为 WCF 适配器处理接收到消息可能会丢失以单向形式的消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-125">Therefore, if you configure a custom binding with a **OneWayBindingElement** in the channel stack for two-way transport in non-transactional receive locations, messages can be lost because the WCF adapters process the received messages in the one-way fashion.</span></span>  
  
## <a name="default-values-of-the-readerquotas-attributes-in-the-wcf-custom-and-wcf-customisolated-transport-properties-dialog-boxes-are-used-when-constructing-the-bindings"></a><span data-ttu-id="4cee9-126">默认构造绑定时，将使用 Wcf-custom 和 Wcf-customisolated 传输属性对话框中 ReaderQuotas 属性的值</span><span class="sxs-lookup"><span data-stu-id="4cee9-126">Default values of the ReaderQuotas attributes in the WCF-Custom and WCF-CustomIsolated transport properties dialog boxes are used when constructing the bindings</span></span>  
 <span data-ttu-id="4cee9-127">在 Wcf-custom 和 Wcf-customisolated 传输属性对话框中， **ReaderQuotas**属性值显示为零。</span><span class="sxs-lookup"><span data-stu-id="4cee9-127">In the WCF-Custom and WCF-CustomIsolated transport properties dialog boxes, the **ReaderQuotas** attribute values are shown as zero.</span></span> <span data-ttu-id="4cee9-128">但是，当构造绑定，使用以下值：</span><span class="sxs-lookup"><span data-stu-id="4cee9-128">However, when constructing the bindings, the following values are used:</span></span>  
  
|<span data-ttu-id="4cee9-129">特性</span><span class="sxs-lookup"><span data-stu-id="4cee9-129">Attribute</span></span>|<span data-ttu-id="4cee9-130">Description</span><span class="sxs-lookup"><span data-stu-id="4cee9-130">Description</span></span>|<span data-ttu-id="4cee9-131">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="4cee9-131">Value</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="4cee9-132">maxArrayLength</span><span class="sxs-lookup"><span data-stu-id="4cee9-132">maxArrayLength</span></span>|<span data-ttu-id="4cee9-133">一个正整数，指定最大允许的数组长度。</span><span class="sxs-lookup"><span data-stu-id="4cee9-133">A positive integer that specifies the maximum allowed array length.</span></span>|<span data-ttu-id="4cee9-134">16384</span><span class="sxs-lookup"><span data-stu-id="4cee9-134">16384</span></span>|  
|<span data-ttu-id="4cee9-135">maxBytesPerRead</span><span class="sxs-lookup"><span data-stu-id="4cee9-135">maxBytesPerRead</span></span>|<span data-ttu-id="4cee9-136">每次读取返回一个正整数，指定的最大允许字节数。</span><span class="sxs-lookup"><span data-stu-id="4cee9-136">A positive integer that specifies the maximum allowed bytes returned per read.</span></span>|<span data-ttu-id="4cee9-137">4096</span><span class="sxs-lookup"><span data-stu-id="4cee9-137">4096</span></span>|  
|<span data-ttu-id="4cee9-138">maxDepth</span><span class="sxs-lookup"><span data-stu-id="4cee9-138">maxDepth</span></span>|<span data-ttu-id="4cee9-139">一个正整数，指定每次读取的最大嵌套的节点深度。</span><span class="sxs-lookup"><span data-stu-id="4cee9-139">A positive integer that specifies the maximum nested node depth per read.</span></span>|<span data-ttu-id="4cee9-140">32</span><span class="sxs-lookup"><span data-stu-id="4cee9-140">32</span></span>|  
|<span data-ttu-id="4cee9-141">maxNameTableCharCount</span><span class="sxs-lookup"><span data-stu-id="4cee9-141">maxNameTableCharCount</span></span>|<span data-ttu-id="4cee9-142">一个正整数，指定表名称中允许的最大字符数。</span><span class="sxs-lookup"><span data-stu-id="4cee9-142">A positive integer that specifies the maximum characters allowed in a table name.</span></span>|<span data-ttu-id="4cee9-143">16384</span><span class="sxs-lookup"><span data-stu-id="4cee9-143">16384</span></span>|  
|<span data-ttu-id="4cee9-144">maxStringContentLength</span><span class="sxs-lookup"><span data-stu-id="4cee9-144">maxStringContentLength</span></span>|<span data-ttu-id="4cee9-145">一个正整数，指定 XML 元素内容中允许的最大字符数。</span><span class="sxs-lookup"><span data-stu-id="4cee9-145">A positive integer that specifies the maximum characters allowed in XML element content.</span></span>|<span data-ttu-id="4cee9-146">8192</span><span class="sxs-lookup"><span data-stu-id="4cee9-146">8192</span></span>|  
  
## <a name="the-wcf-receive-locations-may-be-disabled-if-you-change-the-wcf-adapter-type-and-keep-the-same-address"></a><span data-ttu-id="4cee9-147">WCF 接收位置可能会禁用，如果更改 WCF 适配器类型并保持相同的地址</span><span class="sxs-lookup"><span data-stu-id="4cee9-147">The WCF receive locations may be disabled if you change the WCF adapter type and keep the same address</span></span>  
 <span data-ttu-id="4cee9-148">如果更改适配器类型 — 例如，将 WCF 适配器类型从 Wcf-nettcp 更改为带 NetTcp 绑定的 WCF 自定义 — 并保持相同的地址，可能会由于缓存问题在终结点管理器中禁用接收位置。</span><span class="sxs-lookup"><span data-stu-id="4cee9-148">If you change the adapter type—for example, change the WCF adapter type from WCF-NetTcp to WCF-Custom with NetTcp Binding—and keep the same address, the receive location may be disabled because of the caching problem in the Endpoint Manager.</span></span> <span data-ttu-id="4cee9-149">若要解决此问题，可以执行以下任一操作：</span><span class="sxs-lookup"><span data-stu-id="4cee9-149">To work around this, you can do either of the following:</span></span>  
  
-   <span data-ttu-id="4cee9-150">重新启动 BTSNTSvc 服务。</span><span class="sxs-lookup"><span data-stu-id="4cee9-150">Restart the BTSNTSvc service.</span></span>  
  
-   <span data-ttu-id="4cee9-151">将 URI 更改为不同的地址并保存它，然后更改回原始地址 URI 并再次保存。</span><span class="sxs-lookup"><span data-stu-id="4cee9-151">Change the URI to a different address and save it, and then change the URI back to the original address and save it again.</span></span>  
  
## <a name="the-wcf-action-set-in-the-orchestration-does-not-override-the-action-setting-in-the-static-send-port"></a><span data-ttu-id="4cee9-152">在业务流程中设置的 WCF 操作不重写静态发送端口中的操作设置</span><span class="sxs-lookup"><span data-stu-id="4cee9-152">The WCF action set in the orchestration does not override the action setting in the static send port</span></span>  
 <span data-ttu-id="4cee9-153">如果您设置**WCF。操作**业务流程中的上下文属性，您需要将**操作**字段留空，WCF 适配器传输属性对话框中的。</span><span class="sxs-lookup"><span data-stu-id="4cee9-153">If you set the **WCF.Action** context property in the orchestration, you need to leave the **Action** field blank in the WCF adapter transport properties dialog box.</span></span> <span data-ttu-id="4cee9-154">如果还在静态发送端口中指定的操作**WCF。操作**在静态发送端口设置的值将重写业务流程中设置的上下文属性。</span><span class="sxs-lookup"><span data-stu-id="4cee9-154">If you also specify an action in the static send port, the **WCF.Action** context property you set in the orchestration will be overridden by the value you set in the static send port.</span></span>  
  
## <a name="propagating-a-fault-message-is-not-supported-in-the-transactional-send"></a><span data-ttu-id="4cee9-155">在事务性发送中不支持传播错误消息</span><span class="sxs-lookup"><span data-stu-id="4cee9-155">Propagating a fault message is not supported in the transactional send</span></span>  
 <span data-ttu-id="4cee9-156">**传播错误消息**要求响应发送端口中的选项可以将路由到某个订阅应用程序出站处理失败的消息。</span><span class="sxs-lookup"><span data-stu-id="4cee9-156">The **Propagate fault message** option in the solicit-response send ports allows you to route the messages that fail the outbound processing to a subscribing application.</span></span> <span data-ttu-id="4cee9-157">但是，如果**启用事务**还在传输属性对话框中选中复选框和该事务被中止或无法使用错误响应到达适配器时，你将无法传播将错误消息为任何订阅应用程序</span><span class="sxs-lookup"><span data-stu-id="4cee9-157">However, if the **Enable transactions** check box is also selected in the transport properties dialog box and the transaction is aborted or not usable when the fault response arrives to the adapter, you will not be able to propagate the fault messages to any subscribing applications</span></span>  
  
## <a name="the-msmq-cluster-resource-group-needs-to-be-restarted-before-restarting-the-biztalk-host-cluster-resource-group-during-the-cluster-failover"></a><span data-ttu-id="4cee9-158">需要在群集故障转移期间重新启动 BizTalk 主机群集资源组之前重新启动 MSMQ 群集资源组</span><span class="sxs-lookup"><span data-stu-id="4cee9-158">The MSMQ cluster resource group needs to be restarted before restarting the BizTalk Host cluster resource group during the cluster failover</span></span>  
 <span data-ttu-id="4cee9-159">在故障转移群集方案中，当故障转移发生时，MSMQ 群集资源组需要重新启动 BizTalk 主机群集资源组之前，必须重新启动。</span><span class="sxs-lookup"><span data-stu-id="4cee9-159">In a failover cluster scenario, when a failover is taking place, the MSMQ cluster resource group needs to be restarted before restarting the BizTalk Host cluster resource group.</span></span> <span data-ttu-id="4cee9-160">如果您不能执行此操作，与 MSMQ 接收位置可能被禁用。</span><span class="sxs-lookup"><span data-stu-id="4cee9-160">If you fail to do so, the MSMQ receive locations may be disabled.</span></span> <span data-ttu-id="4cee9-161">若要解决此问题，可以使 BizTalk 主机群集资源组依赖于 MSMQ 群集资源组，以确保 BizTalk 主机群集资源组之前启动 MSMQ 群集资源组。</span><span class="sxs-lookup"><span data-stu-id="4cee9-161">To work around this issue, you can make the BizTalk Host cluster resource group dependent on the MSMQ cluster resource group to ensure that the MSMQ cluster resource group starts before the BizTalk Host cluster resource group.</span></span> <span data-ttu-id="4cee9-162">或者，可以重新启动 BizTalk 主机群集资源组，若要解决此问题。</span><span class="sxs-lookup"><span data-stu-id="4cee9-162">Alternatively, you can restart the BizTalk Host cluster resource group to work around this issue.</span></span>  
  
## <a name="you-receive-an-error-when-sending-messages-to-a-wcf-service-that-uses-wsfederationhttpbinding-in-the-endpoint"></a><span data-ttu-id="4cee9-163">将消息发送到终结点中使用 wsFederationHttpBinding 的 WCF 服务时收到错误</span><span class="sxs-lookup"><span data-stu-id="4cee9-163">You receive an error when sending messages to a WCF service that uses wsFederationHttpBinding in the endpoint</span></span>  
 <span data-ttu-id="4cee9-164">收到如下错误：</span><span class="sxs-lookup"><span data-stu-id="4cee9-164">You receive an error similar to the following:</span></span>  
  
```  
The adapter failed to transmit message going to send port "MySendPort" with URL "http://localohost/MywsFedHttp". It will be retransmitted after the retry interval specified for this Send Port. Details:"The channel is configured to use interactive initializer 'System.ServiceModel.Security.InfocardInteractiveChannelInitializer', but the channel was Opened without calling DisplayInitializationUI.  Call DisplayInitializationUI before calling Open or other methods on this channel.".  
```  
  
 <span data-ttu-id="4cee9-165">这种行为是默认设置。</span><span class="sxs-lookup"><span data-stu-id="4cee9-165">This behavior is by design.</span></span> <span data-ttu-id="4cee9-166">WCF 适配器不能将消息发送到正在使用的 WCF 服务**wsFederationHttpBinding**中其终结点。</span><span class="sxs-lookup"><span data-stu-id="4cee9-166">WCF adapters cannot send messages to the WCF services that are using **wsFederationHttpBinding** in their endpoints.</span></span>  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-enable-you-to-select-message-types-or-port-types-from-the-wsdl"></a><span data-ttu-id="4cee9-167">BizTalk WCF 服务使用向导不会启用从 WSDL 选择消息类型或端口类型</span><span class="sxs-lookup"><span data-stu-id="4cee9-167">The BizTalk WCF Service Consuming Wizard does not enable you to select message types or port types from the WSDL</span></span>  
 <span data-ttu-id="4cee9-168">BizTalk WCF 服务使用向导不允许导入 WCF 服务时从 WSDL 选择消息类型或端口类型。</span><span class="sxs-lookup"><span data-stu-id="4cee9-168">The BizTalk WCF Service Consuming Wizard does not enable you to select message types or port types from the WSDL when importing the WCF services.</span></span> <span data-ttu-id="4cee9-169">若要解决此限制，可以使用下面的代码来获取架构，然后将所需的架构添加到 BizTalk 项目：</span><span class="sxs-lookup"><span data-stu-id="4cee9-169">To work around this limitation, you can use the following code to obtain the schemas and then add the desired schemas to your BizTalk projects:</span></span>  
  
```  
svcutil.exe /t:metadata http://service/metadataendpoint  
```  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-allow-the-combination-of-one-way-and-request-response-operations"></a><span data-ttu-id="4cee9-170">BizTalk WCF 服务使用向导不允许组合的单向和请求-响应操作</span><span class="sxs-lookup"><span data-stu-id="4cee9-170">The BizTalk WCF Service Consuming Wizard does not allow the combination of one-way and request-response operations</span></span>  
 <span data-ttu-id="4cee9-171">BizTalk WCF 服务使用向导不允许您导入具有单向端口类型和请求-响应操作。</span><span class="sxs-lookup"><span data-stu-id="4cee9-171">The BizTalk WCF Service Consuming Wizard does not allow you to import the port types that have a combination of one-way and request-response operations.</span></span> <span data-ttu-id="4cee9-172">若要解决此问题，可以使用 Servicemodel 元数据实用工具生成端口类型。</span><span class="sxs-lookup"><span data-stu-id="4cee9-172">To work around this, you can use the ServiceModel Metadata Utility Tool to generate the port types.</span></span>  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-allow-you-to-set-certificate-credentials-when-retrieving-the-wsdl"></a><span data-ttu-id="4cee9-173">BizTalk WCF 服务使用向导不允许您检索 WSDL 时设置证书凭据</span><span class="sxs-lookup"><span data-stu-id="4cee9-173">The BizTalk WCF Service Consuming Wizard does not allow you to set certificate credentials when retrieving the WSDL</span></span>  
 <span data-ttu-id="4cee9-174">BizTalk WCF 服务使用向导不允许您检索 WSDL 时设置证书凭据。</span><span class="sxs-lookup"><span data-stu-id="4cee9-174">The BizTalk WCF Service Consuming Wizard does not allow you to set certificate credentials when retrieving the WSDL.</span></span> <span data-ttu-id="4cee9-175">若要解决此问题，可以使用 ServiceModel Metadata Utility Tool 生成的 WSDL，并从你想要使用的证书凭据的 WCF 服务的 XSD 文件在 svcutil.exe.config 文件中，设置并将其导入 BizTalk WCF 服务通过选择使用向导**元数据文件 （WSDL 和 XSD）** 选项**元数据来源**页。</span><span class="sxs-lookup"><span data-stu-id="4cee9-175">To work around this, you can use the ServiceModel Metadata Utility Tool to generate the WSDL and XSD files from the WCF services you wish to consume with the certificate credentials set in the svcutil.exe.config file, and then import them into the BizTalk WCF Service Consuming Wizard by choosing **Metadata Files (WSDL and XSD)** option in the **Metadata source** page.</span></span>  
  
## <a name="wcf-adapters-do-not-support-one-way-operations"></a><span data-ttu-id="4cee9-176">WCF 适配器不支持单向操作</span><span class="sxs-lookup"><span data-stu-id="4cee9-176">WCF adapters do not support one-way operations</span></span>  
 <span data-ttu-id="4cee9-177">你将收到错误消息如下所示通过 WCF 适配器 （Wcf-netmsmq 接收适配器） 除外使用 WCF 服务发布时如果**IsOneWay**属性设置为**true**客户端。</span><span class="sxs-lookup"><span data-stu-id="4cee9-177">You will receive an error message similar to the following when consuming WCF services published with the WCF adapters (except for the WCF-NetMsmq receive adapter) if the **IsOneWay** property is set to **true** at client side.</span></span> <span data-ttu-id="4cee9-178">这是因为**System.ServiceModel.OperationContractAttribute.IsOneWay**通过 WCF 适配器 （Wcf-netmsmq 使用发布的服务接收适配器除外） 发布的 WCF 服务的属性设置为**false**甚至对于单向接收位置。</span><span class="sxs-lookup"><span data-stu-id="4cee9-178">This is because the **System.ServiceModel.OperationContractAttribute.IsOneWay** property of WCF services published with the WCF adapters (except for services published with the WCF-NetMsmq receive adapter) is set to **false** even for the one-way receive locations.</span></span>  
  
```  
The channel received an unexpected input message while closing. Your Channel.Close() calls are not synchronized.  
```  
  
 <span data-ttu-id="4cee9-179">使用指定的 WCF 服务时，将收到错误消息如下所示**IsOneWay**属性设置为**true**。</span><span class="sxs-lookup"><span data-stu-id="4cee9-179">You will receive an error message similar to the following when consuming the WCF services specified with the **IsOneWay** property set to **true**.</span></span> <span data-ttu-id="4cee9-180">从发送的邮件[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将挂起且可恢复。</span><span class="sxs-lookup"><span data-stu-id="4cee9-180">The messages you sent from [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be suspended and resumable.</span></span>  
  
```  
The request operation at net.tcp://localhost:8088/MyService/tcp did not receive a reply within timeout 00:01:00.  
```  
  
## <a name="a-memory-leak-may-occur-when-sending-messages-to-non-transactional-msmq-queues-using-wcf-netmsmq-binding"></a><span data-ttu-id="4cee9-181">将消息发送到使用 Wcf-netmsmq 绑定的非事务性 MSMQ 队列时，可能会发生内存泄漏</span><span class="sxs-lookup"><span data-stu-id="4cee9-181">A memory leak may occur when sending messages to non-transactional MSMQ queues using WCF-NetMsmq binding</span></span>  
 <span data-ttu-id="4cee9-182">将消息发送到使用 Wcf-netmsmq 绑定的非事务性 MSMQ 队列时，BizTalk NT 服务中可能发生内存泄漏。</span><span class="sxs-lookup"><span data-stu-id="4cee9-182">A memory leak may occur in the BizTalk NT service when sending messages to non-transactional MSMQ queues using WCF-NetMsmq binding.</span></span> <span data-ttu-id="4cee9-183">这可能会发生或将消息发送到非事务性 MSMQ 队列使用 netMsmqBinding 与 Wcf-custom 传输时将消息发送到非事务性 MSMQ 队列使用 Wcf-netmsmq 传输。</span><span class="sxs-lookup"><span data-stu-id="4cee9-183">This may occur when you send messages to a non-transactional MSMQ queue using WCF-NetMsmq transport or when you send messages to a non-transactional MSMQ queue using netMsmqBinding with WCF-Custom transport.</span></span>  
  
 <span data-ttu-id="4cee9-184">若要解决此问题，必须安装.NET Framework 3.0 修补程序知识库文章 936512 在中所述[ http://go.microsoft.com/fwlink/?LinkId=92962 ](http://go.microsoft.com/fwlink/?LinkId=92962)。</span><span class="sxs-lookup"><span data-stu-id="4cee9-184">To resolve the issue, you must install .NET Framework 3.0 hotfix described in the KB article 936512 at [http://go.microsoft.com/fwlink/?LinkId=92962](http://go.microsoft.com/fwlink/?LinkId=92962).</span></span> <span data-ttu-id="4cee9-185">此修补程序不需要重新启动系统，但需要重新启动 BizTalk NT 服务的宿主的发送端口，使用 Wcf-netmsmq 绑定。</span><span class="sxs-lookup"><span data-stu-id="4cee9-185">The hotfix does not require a system reboot but it is necessary to restart the BizTalk NT service which hosts the send ports that using WCF-NetMsmq binding.</span></span>  
  
## <a name="you-may-receive-exception-when-communicating-with-apache-web-servers-using-wcf-basichttp-adapter"></a><span data-ttu-id="4cee9-186">与 Apache Web 服务器使用 Wcf-basichttp 适配器进行通信时，可能会收到异常</span><span class="sxs-lookup"><span data-stu-id="4cee9-186">You may receive exception when communicating with Apache Web servers using WCF-BasicHttp adapter</span></span>  
 <span data-ttu-id="4cee9-187">使用时 Wcf-basichttp 适配器使用传输安全性与 Apache Web 服务器，通信可能会收到类似于以下各项的异常：</span><span class="sxs-lookup"><span data-stu-id="4cee9-187">When you use WCF-BasicHttp adapter with transport security to communicate with an Apache Web server, you may receive the exception similar to the followings:</span></span>  
  
```  
System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send.  
System.IO.IOException: Unable to write data to the transport connection: An established connection was aborted by the software in your host machine. System.Net.Sockets.SocketException: An established connection was aborted by the software in your host machine  
```  
  
 <span data-ttu-id="4cee9-188">若要解决此问题，需要使用而不是 WCF BasicHttp 适配器的 WCF 自定义适配器与如下所示的 Apache Web 服务器进行通信：</span><span class="sxs-lookup"><span data-stu-id="4cee9-188">To work around this, you need to use WCF-Custom adapter instead of WCF-BasicHttp adapter to communicate with the Apache Web servers as following:</span></span>  
  
1.  <span data-ttu-id="4cee9-189">创建发送端口并将传输类型设置为**WCF 自定义**。</span><span class="sxs-lookup"><span data-stu-id="4cee9-189">Create a send port and set the transport type to **WCF-Custom**.</span></span>  
  
2.  <span data-ttu-id="4cee9-190">在中**Wcf-custom 传输属性**对话框中，在**绑定**选项卡上，选择**customBinding**从**绑定类型**下拉列表。</span><span class="sxs-lookup"><span data-stu-id="4cee9-190">In the **WCF-Custom Transport Properties** dialog box, on the **Binding** tab, select **customBinding** from the **Binding Type** drop-down list.</span></span>  
  
3.  <span data-ttu-id="4cee9-191">下**CustomeBindingElement**，右键单击**httpTransport**，然后单击**删除扩展**。</span><span class="sxs-lookup"><span data-stu-id="4cee9-191">Under **CustomeBindingElement**, right-click **httpTransport**, and then click **Remove extension**.</span></span>  
  
4.  <span data-ttu-id="4cee9-192">右键单击**CustomeBindingElement**，然后单击**将扩展添加**。</span><span class="sxs-lookup"><span data-stu-id="4cee9-192">Right-click **CustomeBindingElement**, and then click **Add extension**.</span></span>  
  
5.  <span data-ttu-id="4cee9-193">在中**选择绑定元素扩展**对话框中，选择**httpTransport** ，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="4cee9-193">In the **Select Binding Element Extension** dialog box, select **httpTransport** and then click **OK**.</span></span>  
  
6.  <span data-ttu-id="4cee9-194">单击**httpTransport**，然后在**配置**窗格中，设置的值**keepAliveEnabled**到**False**。</span><span class="sxs-lookup"><span data-stu-id="4cee9-194">Click **httpTransport**, and then in the **Configuration** pane, set the value of **keepAliveEnabled** to **False**.</span></span>  
  
7.  <span data-ttu-id="4cee9-195">单击**textMessageEncoding**，然后在**配置**窗格中，设置的值**messageVersion**到`Soap11WSAddressing10`。</span><span class="sxs-lookup"><span data-stu-id="4cee9-195">Click **textMessageEncoding**, and then in the **Configuration** pane, set the value of **messageVersion** to `Soap11WSAddressing10`.</span></span>  
  
8.  <span data-ttu-id="4cee9-196">您可能需要根据需要配置其他属性。</span><span class="sxs-lookup"><span data-stu-id="4cee9-196">You may need to configure additional properties as needed.</span></span>  
  
## <a name="biztalk-server-does-not-work-with-wcf-clients-that-using-clientviabehavior-for-multiple-hop-conversations"></a><span data-ttu-id="4cee9-197">BizTalk Server 并不适用于 WCF 客户端使用 ClientViaBehavior 的多跃点会话</span><span class="sxs-lookup"><span data-stu-id="4cee9-197">BizTalk Server does not work with WCF clients that using ClientViaBehavior for multiple-hop conversations</span></span>  
 <span data-ttu-id="4cee9-198">WCF 客户端使用 ClientViaBehavior，当直接网络目标不是要调用的应用程序不需要知道最终目标时，启用多跃点对话的消息的预期的处理器时。</span><span class="sxs-lookup"><span data-stu-id="4cee9-198">WCF clients use ClientViaBehavior when the immediate network destination is not the intended processor of the message to enable multiple-hop conversations when the calling application does not necessarily know the ultimate destination.</span></span> <span data-ttu-id="4cee9-199">如果指定 ClientViaBehavior 并将收件人地址设置为远程服务其中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将充当中介，您将收到错误消息如下所示：</span><span class="sxs-lookup"><span data-stu-id="4cee9-199">If you specify the ClientViaBehavior and set the To address to a remote service where [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be acting as an intermediary, you will receive the error message similar to the following:</span></span>  
  
```  
The message with To 'net.tcp://localhost:5555/test.svc' cannot be processed at the receiver, due to an AddressFilter mismatch at the EndpointDispatcher. Check that the sender and receiver's EndpointAddresses agree  
```