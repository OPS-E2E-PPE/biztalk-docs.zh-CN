---
title: 适用于这些 WCF 适配器的已知问题 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 423c6021-5fb7-48c9-9319-11e7a18c775c
caps.latest.revision: 54
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 26c296dfb2ca1f05a2f403aa31a73b67934fb23a
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009750"
---
# <a name="known-issues-for-the-wcf-adapters"></a><span data-ttu-id="dae1e-102">WCF 适配器的已知的问题</span><span class="sxs-lookup"><span data-stu-id="dae1e-102">Known Issues for the WCF Adapters</span></span>
<span data-ttu-id="dae1e-103">本主题介绍 BizTalk Server 附带的 WCF 适配器的已知的问题。</span><span class="sxs-lookup"><span data-stu-id="dae1e-103">This topic describes the known issues for the WCF adapters included with BizTalk Server.</span></span>  
  
## <a name="a-message-that-fails-in-the-inbound-soap-marshaling-processing-is-not-suspended-in-wcf-receive-adapters"></a><span data-ttu-id="dae1e-104">在入站 SOAP 封送处理中失败的消息不会在 WCF 接收适配器中挂起</span><span class="sxs-lookup"><span data-stu-id="dae1e-104">A message that fails in the inbound SOAP marshaling processing is not suspended in WCF receive adapters</span></span>  
 <span data-ttu-id="dae1e-105">在消息到达 WCF 接收适配器时，WCF 适配器将从传入的 SOAP 消息创建 BizTalk 消息，然后将 BizTalk 消息传递到由终结点管理器管理的传输代理。</span><span class="sxs-lookup"><span data-stu-id="dae1e-105">When a message arrives at a WCF receive adapter, the WCF adapter creates a BizTalk message from the incoming SOAP message, and then passes the BizTalk message to the transport proxy, which is managed by the Endpoint Manager.</span></span> <span data-ttu-id="dae1e-106">如果创建 BizTalk 消息时该适配器无法读取 SOAP 信封和正文，则消息不会挂起，因为该适配器使用快速、非缓存的只进读取器来访问 SOAP 消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-106">If the adapter fails to read the SOAP envelope and body while creating the BizTalk message, the message is not suspended because the adapter uses the fast, non-cached, and forward-only reader to access the SOAP message.</span></span>  
  
 <span data-ttu-id="dae1e-107">您应该检查事件日志中的失败消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-107">You should check the event log for the failed message.</span></span> <span data-ttu-id="dae1e-108">例如，可以使用正文路径表达式上**消息**WCF 适配器传输属性对话框中的选项卡来指定如何通过 WCF 适配器传入 SOAP 消息创建入站的 BizTalk 消息正文。</span><span class="sxs-lookup"><span data-stu-id="dae1e-108">For example, you can use a body path expression on the **Messages** tab in the WCF adapter transport properties dialog box to specify how to create the inbound BizTalk message body from a SOAP message incoming through the WCF adapter.</span></span> <span data-ttu-id="dae1e-109">当传入的 SOAP 消息的正文无效路径表达式提供上**消息**选项卡上，则适配器将失败，创建 BizTalk 消息和无法挂起传入的消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-109">When an invalid body path expression for the incoming SOAP message is supplied on the **Messages** tab, the adapter fails to create the BizTalk message and cannot suspend the incoming message.</span></span> <span data-ttu-id="dae1e-110">有关如何使用正文路径表达式上**消息**选项卡上，请参阅[为 WCF 适配器指定消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="dae1e-110">For more information about how to use the body path expression on the **Messages** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
 <span data-ttu-id="dae1e-111">下图显示**消息**在其，您可以指定如何创建从传入的 SOAP 消息的入站的 BizTalk 消息的选项卡。</span><span class="sxs-lookup"><span data-stu-id="dae1e-111">The following figure shows the **Messages** tab on which you can specify how to create inbound BizTalk messages from the incoming SOAP messages.</span></span>  
  
## <a name="a-message-that-fails-in-the-inbound-soap-marshaling-processing-is-not-suspended-in-wcf-send-adapters"></a><span data-ttu-id="dae1e-112">在入站 SOAP 封送处理中失败的消息不会在 WCF 发送适配器中挂起</span><span class="sxs-lookup"><span data-stu-id="dae1e-112">A message that fails in the inbound SOAP marshaling processing is not suspended in WCF send adapters</span></span>  
 <span data-ttu-id="dae1e-113">要求-响应 WCF 发送端口可以接收 WCF 消息作为响应消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-113">The solicit-response WCF send port can receive a WCF message as a response message.</span></span> <span data-ttu-id="dae1e-114">当消息到达 WCF 发送适配器时，WCF 适配器将从传入的 SOAP 消息创建 BizTalk 消息，然后将 BizTalk 消息传递到由终结点管理器管理的传输代理。</span><span class="sxs-lookup"><span data-stu-id="dae1e-114">When the message arrives at the WCF send adapter, the WCF adapter creates the BizTalk message from the incoming SOAP message, and then passes the BizTalk message to the transport proxy, which is managed by the Endpoint Manager.</span></span> <span data-ttu-id="dae1e-115">如果创建 BizTalk 消息时该适配器无法读取 SOAP 信封和正文，则消息不会挂起，因为该适配器使用快速、非缓存的只进读取器来访问 SOAP 消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-115">If the adapter fails to read the SOAP envelope and body while creating the BizTalk message, the message is not suspended because the adapter uses the fast, non-cached, and forward-only reader to access the SOAP message.</span></span>  
  
 <span data-ttu-id="dae1e-116">您应该检查事件日志中的失败消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-116">You should check the event log for the failed message.</span></span> <span data-ttu-id="dae1e-117">例如，可以使用 XPath 表达式上**消息**WCF 适配器传输属性对话框中的选项卡来指定如何通过 WCF 适配器传入 SOAP 消息创建入站的 BizTalk 消息正文。</span><span class="sxs-lookup"><span data-stu-id="dae1e-117">For example, you can use an XPath expression on the **Messages** tab in the WCF adapter transport properties dialog box to specify how to create the inbound BizTalk message body from a SOAP message incoming through the WCF adapter.</span></span> <span data-ttu-id="dae1e-118">当将无效的 XPath 表达式为传入的 SOAP 消息提供上**消息**选项卡上，则适配器将失败，创建 BizTalk 消息和无法挂起传入的消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-118">When an invalid XPath expression for the incoming SOAP message is supplied on the **Messages** tab, the adapter fails to create the BizTalk message and cannot suspend the incoming message.</span></span> <span data-ttu-id="dae1e-119">有关如何使用 XPath 表达式上**消息**选项卡上，请参阅[为 WCF 适配器指定消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="dae1e-119">For more information about how to use the XPath expression on the **Messages** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
 <span data-ttu-id="dae1e-120">下图显示**消息**作为示例的 WCF NetNamedPipe 发送适配器的选项卡。</span><span class="sxs-lookup"><span data-stu-id="dae1e-120">The following figure shows the **Messages** tab of the WCF-NetNamedPipe send adapter as an example.</span></span>  
  
 <span data-ttu-id="dae1e-121">![在 WCF 消息选项卡发送适配器](../core/media/54623ccf-49a9-4b6a-9487-da0d94bab64d.gif "54623ccf-49a9-4b6a-9487-da0d94bab64d")</span><span class="sxs-lookup"><span data-stu-id="dae1e-121">![The Messages tab in the WCF send adapters](../core/media/54623ccf-49a9-4b6a-9487-da0d94bab64d.gif "54623ccf-49a9-4b6a-9487-da0d94bab64d")</span></span>  
  
## <a name="messages-can-be-lost-when-using-onewaybindingelement-in-a-two-way-transport-with-custom-binding-in-non-transactional-wcf-receive-locations"></a><span data-ttu-id="dae1e-122">如果在非事务性 WCF 接收位置将双向传输中的 OneWayBindingElement 用于自定义绑定，则消息可能会丢失</span><span class="sxs-lookup"><span data-stu-id="dae1e-122">Messages can be lost when using OneWayBindingElement in a two-way transport with custom binding in non-transactional WCF receive locations</span></span>  
 <span data-ttu-id="dae1e-123">在双向通信中，WCF 适配器将发送回响应，直到消息已保存在 MessageBox 数据库中。</span><span class="sxs-lookup"><span data-stu-id="dae1e-123">In a two-way communication, WCF adapters will send the response back until the messages have been persisted in the MessageBox database.</span></span> <span data-ttu-id="dae1e-124">但是，使用**OneWayBindingElement**调度到 WCF 适配器收到的消息之前立即生成 dummy 响应。</span><span class="sxs-lookup"><span data-stu-id="dae1e-124">However, using **OneWayBindingElement** generates a dummy response immediately before dispatching the received message to the WCF adapter.</span></span> <span data-ttu-id="dae1e-125">因此，如果配置自定义绑定用于**OneWayBindingElement**中非事务性的双向传输协议通道堆栈中接收位置、 消息可能会丢失，因为 WCF 适配器处理接收方式单向消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-125">Therefore, if you configure a custom binding with a **OneWayBindingElement** in the channel stack for two-way transport in non-transactional receive locations, messages can be lost because the WCF adapters process the received messages in the one-way fashion.</span></span>  
  
## <a name="default-values-of-the-readerquotas-attributes-in-the-wcf-custom-and-wcf-customisolated-transport-properties-dialog-boxes-are-used-when-constructing-the-bindings"></a><span data-ttu-id="dae1e-126">构造绑定时，将使用“WCF-Custom 传输属性”和“WCF-CustomIsolated 传输属性”对话框中 ReaderQuotas 属性的默认值</span><span class="sxs-lookup"><span data-stu-id="dae1e-126">Default values of the ReaderQuotas attributes in the WCF-Custom and WCF-CustomIsolated transport properties dialog boxes are used when constructing the bindings</span></span>  
 <span data-ttu-id="dae1e-127">中的 WCF 自定义和 WCF CustomIsolated 传输属性对话框框中， **ReaderQuotas**属性值将显示为零。</span><span class="sxs-lookup"><span data-stu-id="dae1e-127">In the WCF-Custom and WCF-CustomIsolated transport properties dialog boxes, the **ReaderQuotas** attribute values are shown as zero.</span></span> <span data-ttu-id="dae1e-128">然而，构造绑定时，将使用以下值：</span><span class="sxs-lookup"><span data-stu-id="dae1e-128">However, when constructing the bindings, the following values are used:</span></span>  
  
|<span data-ttu-id="dae1e-129">Attribute</span><span class="sxs-lookup"><span data-stu-id="dae1e-129">Attribute</span></span>|<span data-ttu-id="dae1e-130">Description</span><span class="sxs-lookup"><span data-stu-id="dae1e-130">Description</span></span>|<span data-ttu-id="dae1e-131">值</span><span class="sxs-lookup"><span data-stu-id="dae1e-131">Value</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="dae1e-132">maxArrayLength</span><span class="sxs-lookup"><span data-stu-id="dae1e-132">maxArrayLength</span></span>|<span data-ttu-id="dae1e-133">正整数，指定允许的最大数组长度。</span><span class="sxs-lookup"><span data-stu-id="dae1e-133">A positive integer that specifies the maximum allowed array length.</span></span>|<span data-ttu-id="dae1e-134">16384</span><span class="sxs-lookup"><span data-stu-id="dae1e-134">16384</span></span>|  
|<span data-ttu-id="dae1e-135">maxBytesPerRead</span><span class="sxs-lookup"><span data-stu-id="dae1e-135">maxBytesPerRead</span></span>|<span data-ttu-id="dae1e-136">正整数，指定允许每次读取时返回的最大字节数。</span><span class="sxs-lookup"><span data-stu-id="dae1e-136">A positive integer that specifies the maximum allowed bytes returned per read.</span></span>|<span data-ttu-id="dae1e-137">4096</span><span class="sxs-lookup"><span data-stu-id="dae1e-137">4096</span></span>|  
|<span data-ttu-id="dae1e-138">maxDepth</span><span class="sxs-lookup"><span data-stu-id="dae1e-138">maxDepth</span></span>|<span data-ttu-id="dae1e-139">正整数，指定每次读取的最大嵌套节点深度。</span><span class="sxs-lookup"><span data-stu-id="dae1e-139">A positive integer that specifies the maximum nested node depth per read.</span></span>|<span data-ttu-id="dae1e-140">32</span><span class="sxs-lookup"><span data-stu-id="dae1e-140">32</span></span>|  
|<span data-ttu-id="dae1e-141">maxNameTableCharCount</span><span class="sxs-lookup"><span data-stu-id="dae1e-141">maxNameTableCharCount</span></span>|<span data-ttu-id="dae1e-142">正整数，指定表名称中允许的最大字符数。</span><span class="sxs-lookup"><span data-stu-id="dae1e-142">A positive integer that specifies the maximum characters allowed in a table name.</span></span>|<span data-ttu-id="dae1e-143">16384</span><span class="sxs-lookup"><span data-stu-id="dae1e-143">16384</span></span>|  
|<span data-ttu-id="dae1e-144">maxStringContentLength</span><span class="sxs-lookup"><span data-stu-id="dae1e-144">maxStringContentLength</span></span>|<span data-ttu-id="dae1e-145">正整数，指定 XML 元素内容中允许的最大字符数。</span><span class="sxs-lookup"><span data-stu-id="dae1e-145">A positive integer that specifies the maximum characters allowed in XML element content.</span></span>|<span data-ttu-id="dae1e-146">8192</span><span class="sxs-lookup"><span data-stu-id="dae1e-146">8192</span></span>|  
  
## <a name="the-wcf-receive-locations-may-be-disabled-if-you-change-the-wcf-adapter-type-and-keep-the-same-address"></a><span data-ttu-id="dae1e-147">如果更改 WCF 适配器类型并保持相同的地址，则可能会禁用 WCF 接收位置</span><span class="sxs-lookup"><span data-stu-id="dae1e-147">The WCF receive locations may be disabled if you change the WCF adapter type and keep the same address</span></span>  
 <span data-ttu-id="dae1e-148">如果更改适配器类型 — 例如，将从 WCF NetTcp WCF 适配器类型更改为使用 NetTcp 绑定的 WCF 自定义，并保留相同的地址，接收位置可能由于缓存问题在终结点管理器中禁用。</span><span class="sxs-lookup"><span data-stu-id="dae1e-148">If you change the adapter type—for example, change the WCF adapter type from WCF-NetTcp to WCF-Custom with NetTcp Binding—and keep the same address, the receive location may be disabled because of the caching problem in the Endpoint Manager.</span></span> <span data-ttu-id="dae1e-149">若要解决此问题，您可以执行以下操作之一：</span><span class="sxs-lookup"><span data-stu-id="dae1e-149">To work around this, you can do either of the following:</span></span>  
  
-   <span data-ttu-id="dae1e-150">重新启动 BTSNTSvc 服务。</span><span class="sxs-lookup"><span data-stu-id="dae1e-150">Restart the BTSNTSvc service.</span></span>  
  
-   <span data-ttu-id="dae1e-151">将 URI 更改为其他地址并保存，然后将 URI 改回原始地址并再次保存。</span><span class="sxs-lookup"><span data-stu-id="dae1e-151">Change the URI to a different address and save it, and then change the URI back to the original address and save it again.</span></span>  
  
## <a name="the-wcf-action-set-in-the-orchestration-does-not-override-the-action-setting-in-the-static-send-port"></a><span data-ttu-id="dae1e-152">业务流程中设置的 WCF 操作不会重写静态发送端口中的操作设置</span><span class="sxs-lookup"><span data-stu-id="dae1e-152">The WCF action set in the orchestration does not override the action setting in the static send port</span></span>  
 <span data-ttu-id="dae1e-153">如果你设置**WCF。操作**业务流程中的上下文属性，您需要离开**操作**字段保留为空白在 WCF 适配器传输属性对话框中。</span><span class="sxs-lookup"><span data-stu-id="dae1e-153">If you set the **WCF.Action** context property in the orchestration, you need to leave the **Action** field blank in the WCF adapter transport properties dialog box.</span></span> <span data-ttu-id="dae1e-154">如果你还在静态发送端口中，指定操作**WCF。操作**静态发送端口中设置的值时将替代在业务流程中设置的上下文属性。</span><span class="sxs-lookup"><span data-stu-id="dae1e-154">If you also specify an action in the static send port, the **WCF.Action** context property you set in the orchestration will be overridden by the value you set in the static send port.</span></span>  
  
## <a name="propagating-a-fault-message-is-not-supported-in-the-transactional-send"></a><span data-ttu-id="dae1e-155">事务性发送中不支持传播错误消息</span><span class="sxs-lookup"><span data-stu-id="dae1e-155">Propagating a fault message is not supported in the transactional send</span></span>  
 <span data-ttu-id="dae1e-156">**传播错误消息**请求-响应发送端口中的选项允许你传送失败对订阅应用程序的出站处理的消息。</span><span class="sxs-lookup"><span data-stu-id="dae1e-156">The **Propagate fault message** option in the solicit-response send ports allows you to route the messages that fail the outbound processing to a subscribing application.</span></span> <span data-ttu-id="dae1e-157">但是，如果**启用事务**同时传输的属性对话框中选中复选框和则中止此事务或不在错误响应到达时到适配器可用，你将无法传播错误消息转换为任何订阅的应用程序</span><span class="sxs-lookup"><span data-stu-id="dae1e-157">However, if the **Enable transactions** check box is also selected in the transport properties dialog box and the transaction is aborted or not usable when the fault response arrives to the adapter, you will not be able to propagate the fault messages to any subscribing applications</span></span>  
  
## <a name="the-msmq-cluster-resource-group-needs-to-be-restarted-before-restarting-the-biztalk-host-cluster-resource-group-during-the-cluster-failover"></a><span data-ttu-id="dae1e-158">在群集故障转移期间，需要先重新启动 MSMQ 群集资源组，然后再重新启动 BizTalk 主机群集资源组</span><span class="sxs-lookup"><span data-stu-id="dae1e-158">The MSMQ cluster resource group needs to be restarted before restarting the BizTalk Host cluster resource group during the cluster failover</span></span>  
 <span data-ttu-id="dae1e-159">在故障转移群集方案中，如果发生故障转移，则需要先重新启动 MSMQ 群集资源组，然后再重新启动 BizTalk 主机群集资源组。</span><span class="sxs-lookup"><span data-stu-id="dae1e-159">In a failover cluster scenario, when a failover is taking place, the MSMQ cluster resource group needs to be restarted before restarting the BizTalk Host cluster resource group.</span></span> <span data-ttu-id="dae1e-160">如果没有这样做，则可能会禁用 MSMQ 接收位置。</span><span class="sxs-lookup"><span data-stu-id="dae1e-160">If you fail to do so, the MSMQ receive locations may be disabled.</span></span> <span data-ttu-id="dae1e-161">若要解决此问题，您可以使 BizTalk 主机群集资源组依赖于 MSMQ 群集资源组，以确保 MSMQ 群集资源组在 BizTalk 主机群集资源组之前启动。</span><span class="sxs-lookup"><span data-stu-id="dae1e-161">To work around this issue, you can make the BizTalk Host cluster resource group dependent on the MSMQ cluster resource group to ensure that the MSMQ cluster resource group starts before the BizTalk Host cluster resource group.</span></span> <span data-ttu-id="dae1e-162">或者，您可以重新启动 BizTalk 主机群集资源组来解决此问题。</span><span class="sxs-lookup"><span data-stu-id="dae1e-162">Alternatively, you can restart the BizTalk Host cluster resource group to work around this issue.</span></span>  
  
## <a name="you-receive-an-error-when-sending-messages-to-a-wcf-service-that-uses-wsfederationhttpbinding-in-the-endpoint"></a><span data-ttu-id="dae1e-163">将消息发送到在终结点中使用 wsFederationHttpBinding 的 WCF 服务时收到错误</span><span class="sxs-lookup"><span data-stu-id="dae1e-163">You receive an error when sending messages to a WCF service that uses wsFederationHttpBinding in the endpoint</span></span>  
 <span data-ttu-id="dae1e-164">您会收到类似如下的错误：</span><span class="sxs-lookup"><span data-stu-id="dae1e-164">You receive an error similar to the following:</span></span>  
  
```  
The adapter failed to transmit message going to send port "MySendPort" with URL "http://localohost/MywsFedHttp". It will be retransmitted after the retry interval specified for this Send Port. Details:"The channel is configured to use interactive initializer 'System.ServiceModel.Security.InfocardInteractiveChannelInitializer', but the channel was Opened without calling DisplayInitializationUI.  Call DisplayInitializationUI before calling Open or other methods on this channel.".  
```  
  
 <span data-ttu-id="dae1e-165">这种行为是默认设置。</span><span class="sxs-lookup"><span data-stu-id="dae1e-165">This behavior is by design.</span></span> <span data-ttu-id="dae1e-166">WCF 适配器不能将消息发送到使用 WCF 服务**wsFederationHttpBinding**其终结点中。</span><span class="sxs-lookup"><span data-stu-id="dae1e-166">WCF adapters cannot send messages to the WCF services that are using **wsFederationHttpBinding** in their endpoints.</span></span>  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-enable-you-to-select-message-types-or-port-types-from-the-wsdl"></a><span data-ttu-id="dae1e-167">使用 BizTalk WCF 服务使用向导不能从 WSDL 选择消息类型或端口类型</span><span class="sxs-lookup"><span data-stu-id="dae1e-167">The BizTalk WCF Service Consuming Wizard does not enable you to select message types or port types from the WSDL</span></span>  
 <span data-ttu-id="dae1e-168">导入 WCF 服务时，使用 BizTalk WCF 服务使用向导不能从 WSDL 选择消息类型或端口类型。</span><span class="sxs-lookup"><span data-stu-id="dae1e-168">The BizTalk WCF Service Consuming Wizard does not enable you to select message types or port types from the WSDL when importing the WCF services.</span></span> <span data-ttu-id="dae1e-169">若要消除此限制，您可以使用以下代码获取架构，然后将所需架构添加到 BizTalk 项目：</span><span class="sxs-lookup"><span data-stu-id="dae1e-169">To work around this limitation, you can use the following code to obtain the schemas and then add the desired schemas to your BizTalk projects:</span></span>  
  
```  
svcutil.exe /t:metadata http://service/metadataendpoint  
```  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-allow-the-combination-of-one-way-and-request-response-operations"></a><span data-ttu-id="dae1e-170">BizTalk WCF 服务使用向导不允许单向操作和请求响应操作组合</span><span class="sxs-lookup"><span data-stu-id="dae1e-170">The BizTalk WCF Service Consuming Wizard does not allow the combination of one-way and request-response operations</span></span>  
 <span data-ttu-id="dae1e-171">BizTalk WCF 服务使用向导不允许导入具有单向操作和请求响应操作组合的端口类型。</span><span class="sxs-lookup"><span data-stu-id="dae1e-171">The BizTalk WCF Service Consuming Wizard does not allow you to import the port types that have a combination of one-way and request-response operations.</span></span> <span data-ttu-id="dae1e-172">若要解决此问题，您可以使用 ServiceModel 元数据实用工具生成端口类型。</span><span class="sxs-lookup"><span data-stu-id="dae1e-172">To work around this, you can use the ServiceModel Metadata Utility Tool to generate the port types.</span></span>  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-allow-you-to-set-certificate-credentials-when-retrieving-the-wsdl"></a><span data-ttu-id="dae1e-173">BizTalk WCF 服务使用向导不允许在检索 WSDL 时设置证书凭据</span><span class="sxs-lookup"><span data-stu-id="dae1e-173">The BizTalk WCF Service Consuming Wizard does not allow you to set certificate credentials when retrieving the WSDL</span></span>  
 <span data-ttu-id="dae1e-174">BizTalk WCF 服务使用向导不允许在检索 WSDL 时设置证书凭据。</span><span class="sxs-lookup"><span data-stu-id="dae1e-174">The BizTalk WCF Service Consuming Wizard does not allow you to set certificate credentials when retrieving the WSDL.</span></span> <span data-ttu-id="dae1e-175">若要解决此问题，可以使用 ServiceModel 元数据实用工具生成的 WSDL，并从你想要使用的证书凭据的 WCF 服务的 XSD 文件在 svcutil.exe.config 文件中，设置和将其导入 BizTalk WCF 服务使用向导通过选择**元数据文件 （WSDL 和 XSD）** 选项**元数据源**页。</span><span class="sxs-lookup"><span data-stu-id="dae1e-175">To work around this, you can use the ServiceModel Metadata Utility Tool to generate the WSDL and XSD files from the WCF services you wish to consume with the certificate credentials set in the svcutil.exe.config file, and then import them into the BizTalk WCF Service Consuming Wizard by choosing **Metadata Files (WSDL and XSD)** option in the **Metadata source** page.</span></span>  
  
## <a name="wcf-adapters-do-not-support-one-way-operations"></a><span data-ttu-id="dae1e-176">WCF 适配器不支持单向操作</span><span class="sxs-lookup"><span data-stu-id="dae1e-176">WCF adapters do not support one-way operations</span></span>  
 <span data-ttu-id="dae1e-177">你将收到错误消息类似于以下使用 WCF 服务发布与 WCF 适配器 （除了对于 WCF NetMsmq 收到适配器） 时如果**IsOneWay**属性设置为**true**在客户端。</span><span class="sxs-lookup"><span data-stu-id="dae1e-177">You will receive an error message similar to the following when consuming WCF services published with the WCF adapters (except for the WCF-NetMsmq receive adapter) if the **IsOneWay** property is set to **true** at client side.</span></span> <span data-ttu-id="dae1e-178">这是因为**System.ServiceModel.OperationContractAttribute.IsOneWay**发布具有 WCF 适配器 （用于与 WCF NetMsmq 发布服务接收适配器时除外） 的 WCF 服务的属性设置为**false**甚至为单向接收位置。</span><span class="sxs-lookup"><span data-stu-id="dae1e-178">This is because the **System.ServiceModel.OperationContractAttribute.IsOneWay** property of WCF services published with the WCF adapters (except for services published with the WCF-NetMsmq receive adapter) is set to **false** even for the one-way receive locations.</span></span>  
  
```  
The channel received an unexpected input message while closing. Your Channel.Close() calls are not synchronized.  
```  
  
 <span data-ttu-id="dae1e-179">使用与指定的 WCF 服务时，将收到错误消息类似于以下**IsOneWay**属性设置为**true**。</span><span class="sxs-lookup"><span data-stu-id="dae1e-179">You will receive an error message similar to the following when consuming the WCF services specified with the **IsOneWay** property set to **true**.</span></span> <span data-ttu-id="dae1e-180">从发送的消息[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将挂起，并可恢复。</span><span class="sxs-lookup"><span data-stu-id="dae1e-180">The messages you sent from [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be suspended and resumable.</span></span>  
  
```  
The request operation at net.tcp://localhost:8088/MyService/tcp did not receive a reply within timeout 00:01:00.  
```  
  
## <a name="a-memory-leak-may-occur-when-sending-messages-to-non-transactional-msmq-queues-using-wcf-netmsmq-binding"></a><span data-ttu-id="dae1e-181">在使用 WCF-NetMsmq 绑定将消息发送到非事务性 MSMQ 队列时，可能发生内存泄漏</span><span class="sxs-lookup"><span data-stu-id="dae1e-181">A memory leak may occur when sending messages to non-transactional MSMQ queues using WCF-NetMsmq binding</span></span>  
 <span data-ttu-id="dae1e-182">在使用 WCF-NetMsmq 绑定将消息发送到非事务性 MSMQ 队列时，BizTalk NT 服务中可能发生内存泄漏。</span><span class="sxs-lookup"><span data-stu-id="dae1e-182">A memory leak may occur in the BizTalk NT service when sending messages to non-transactional MSMQ queues using WCF-NetMsmq binding.</span></span> <span data-ttu-id="dae1e-183">在使用 WCF-NetMsmq 传输将消息发送到非事务性 MSMQ 队列，或者通过将 netMsmqBinding 与 WCF-Custom 传输一起使用，将消息发送到非事务性 MSMQ 队列时，可能发生这种问题。</span><span class="sxs-lookup"><span data-stu-id="dae1e-183">This may occur when you send messages to a non-transactional MSMQ queue using WCF-NetMsmq transport or when you send messages to a non-transactional MSMQ queue using netMsmqBinding with WCF-Custom transport.</span></span>  
  
 <span data-ttu-id="dae1e-184">若要解决此问题，必须安装.NET Framework 3.0 修补程序 KB 文中所述 936512 在[http://go.microsoft.com/fwlink/?LinkId=92962](http://go.microsoft.com/fwlink/?LinkId=92962)。</span><span class="sxs-lookup"><span data-stu-id="dae1e-184">To resolve the issue, you must install .NET Framework 3.0 hotfix described in the KB article 936512 at [http://go.microsoft.com/fwlink/?LinkId=92962](http://go.microsoft.com/fwlink/?LinkId=92962).</span></span> <span data-ttu-id="dae1e-185">该修补程序不要求重新启动系统，但需要重新启动承载使用 WCF-NetMsmq 绑定的发送端口的 BizTalk NT 服务。</span><span class="sxs-lookup"><span data-stu-id="dae1e-185">The hotfix does not require a system reboot but it is necessary to restart the BizTalk NT service which hosts the send ports that using WCF-NetMsmq binding.</span></span>  
  
## <a name="you-may-receive-exception-when-communicating-with-apache-web-servers-using-wcf-basichttp-adapter"></a><span data-ttu-id="dae1e-186">如果使用 WCF-BasicHttp 适配器与 Apache Web 服务器进行通信，则可能会发生异常</span><span class="sxs-lookup"><span data-stu-id="dae1e-186">You may receive exception when communicating with Apache Web servers using WCF-BasicHttp adapter</span></span>  
 <span data-ttu-id="dae1e-187">如果将 WCF-BasicHttp 适配器与传输安全性一起使用来与 Apache Web 服务器进行通信，则可能会发生类似如下的异常：</span><span class="sxs-lookup"><span data-stu-id="dae1e-187">When you use WCF-BasicHttp adapter with transport security to communicate with an Apache Web server, you may receive the exception similar to the followings:</span></span>  
  
```  
System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send.  
System.IO.IOException: Unable to write data to the transport connection: An established connection was aborted by the software in your host machine. System.Net.Sockets.SocketException: An established connection was aborted by the software in your host machine  
```  
  
 <span data-ttu-id="dae1e-188">若要解决此问题，您需要使用 WCF-Custom 适配器（而非 WCF-BasicHttp 适配器）与 Apache Web 服务器进行通信，如下所示：</span><span class="sxs-lookup"><span data-stu-id="dae1e-188">To work around this, you need to use WCF-Custom adapter instead of WCF-BasicHttp adapter to communicate with the Apache Web servers as following:</span></span>  
  
1.  <span data-ttu-id="dae1e-189">创建发送端口和设置的传输类型为**WCF 自定义**。</span><span class="sxs-lookup"><span data-stu-id="dae1e-189">Create a send port and set the transport type to **WCF-Custom**.</span></span>  
  
2.  <span data-ttu-id="dae1e-190">在**WCF 自定义传输属性**对话框中，在**绑定**选项卡上，选择**customBinding**从**绑定类型**下拉列表。</span><span class="sxs-lookup"><span data-stu-id="dae1e-190">In the **WCF-Custom Transport Properties** dialog box, on the **Binding** tab, select **customBinding** from the **Binding Type** drop-down list.</span></span>  
  
3.  <span data-ttu-id="dae1e-191">下**CustomeBindingElement**，右键单击**httpTransport**，然后单击**删除扩展**。</span><span class="sxs-lookup"><span data-stu-id="dae1e-191">Under **CustomeBindingElement**, right-click **httpTransport**, and then click **Remove extension**.</span></span>  
  
4.  <span data-ttu-id="dae1e-192">右键单击**CustomeBindingElement**，然后单击**将扩展添加**。</span><span class="sxs-lookup"><span data-stu-id="dae1e-192">Right-click **CustomeBindingElement**, and then click **Add extension**.</span></span>  
  
5.  <span data-ttu-id="dae1e-193">在**选择绑定元素扩展**对话框中，选择**httpTransport** ，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="dae1e-193">In the **Select Binding Element Extension** dialog box, select **httpTransport** and then click **OK**.</span></span>  
  
6.  <span data-ttu-id="dae1e-194">单击**httpTransport**，然后在**配置**窗格中，设置的值**keepAliveEnabled**到**False**。</span><span class="sxs-lookup"><span data-stu-id="dae1e-194">Click **httpTransport**, and then in the **Configuration** pane, set the value of **keepAliveEnabled** to **False**.</span></span>  
  
7.  <span data-ttu-id="dae1e-195">单击**textMessageEncoding**，然后在**配置**窗格中，设置的值**messageVersion**到`Soap11WSAddressing10`。</span><span class="sxs-lookup"><span data-stu-id="dae1e-195">Click **textMessageEncoding**, and then in the **Configuration** pane, set the value of **messageVersion** to `Soap11WSAddressing10`.</span></span>  
  
8.  <span data-ttu-id="dae1e-196">可以根据需要配置其他属性。</span><span class="sxs-lookup"><span data-stu-id="dae1e-196">You may need to configure additional properties as needed.</span></span>  
  
## <a name="biztalk-server-does-not-work-with-wcf-clients-that-using-clientviabehavior-for-multiple-hop-conversations"></a><span data-ttu-id="dae1e-197">BizTalk Server 无法将使用 ClientViaBehavior 的 WCF 客户端用于多跃点会话</span><span class="sxs-lookup"><span data-stu-id="dae1e-197">BizTalk Server does not work with WCF clients that using ClientViaBehavior for multiple-hop conversations</span></span>  
 <span data-ttu-id="dae1e-198">当直接网络目标不是消息的预期处理器，且调用应用程序无需了解最终目标时，WCF 客户端会使用 ClientViaBehavior 启用多跃点会话。</span><span class="sxs-lookup"><span data-stu-id="dae1e-198">WCF clients use ClientViaBehavior when the immediate network destination is not the intended processor of the message to enable multiple-hop conversations when the calling application does not necessarily know the ultimate destination.</span></span> <span data-ttu-id="dae1e-199">如果指定 ClientViaBehavior 并将“收件人”地址设置为远程服务（其中 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 将充当桥梁），您将收到类似如下内容的错误消息：</span><span class="sxs-lookup"><span data-stu-id="dae1e-199">If you specify the ClientViaBehavior and set the To address to a remote service where [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be acting as an intermediary, you will receive the error message similar to the following:</span></span>  
  
```  
The message with To 'net.tcp://localhost:5555/test.svc' cannot be processed at the receiver, due to an AddressFilter mismatch at the EndpointDispatcher. Check that the sender and receiver's EndpointAddresses agree  
```