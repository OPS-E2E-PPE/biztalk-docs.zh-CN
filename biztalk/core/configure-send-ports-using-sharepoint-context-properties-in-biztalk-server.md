---
title: 如何配置发送端口使用 Windows Sharepoint Services 上下文属性 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Windows SharePoint Services adapters, InfoPath forms
- configuring [Windows SharePoint Services adapters], InfoPath forms
- Windows SharePoint Services adapters, Windows SharePoint Services
- InfoPath forms, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], Windows SharePoint Services
- Windows SharePoint Services adapters, send ports
- configuring [Windows SharePoint Services adapters], send ports
- send ports, Windows SharePoint Services adapters
- Windows SharePoint Services, Windows SharePoint Services adapters
ms.assetid: 1ff50fb8-7ba0-47b8-9476-d57413989346
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e766272f33bf23166ba412a76498e4240ab3343b
ms.sourcegitcommit: 36350889f318e1f7e0ac9506dc8df794d475bda6
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/20/2018
ms.locfileid: "25970667"
---
# <a name="how-to-configure-send-ports-using-windows-sharepoint-services-context-properties"></a><span data-ttu-id="5da1c-102">如何配置发送端口使用 Windows Sharepoint Services 上下文属性</span><span class="sxs-lookup"><span data-stu-id="5da1c-102">How to Configure Send Ports Using Windows Sharepoint Services Context Properties</span></span>
<span data-ttu-id="5da1c-103">本主题介绍如何使用 BizTalk 业务流程中的 Windows SharePoint Services 上下文属性在运行时配置 Windows Sharepoint Services 发送端口。</span><span class="sxs-lookup"><span data-stu-id="5da1c-103">This topic describes how to configure Windows SharePoint Services send ports at runtime using Windows Sharepoint Services context properties from a BizTalk orchestration.</span></span> <span data-ttu-id="5da1c-104">这一机制还可用于配置 Windows SharePoint Services 动态和后期绑定发送端口。</span><span class="sxs-lookup"><span data-stu-id="5da1c-104">The same mechanism can be used to configure Windows SharePoint Services dynamic and late-bound send ports.</span></span> <span data-ttu-id="5da1c-105">动态发送端口的配置属性是在运行时通过业务流程设置的。</span><span class="sxs-lookup"><span data-stu-id="5da1c-105">The configuration properties for a dynamic send port are set in an orchestration at runtime.</span></span> <span data-ttu-id="5da1c-106">适配器属性中公开 **Windows SharePoint Services 传输属性** 对话框还可应用于动态或后期绑定的发送端口。</span><span class="sxs-lookup"><span data-stu-id="5da1c-106">Adapter properties that are exposed in the **Windows SharePoint Services Transport Properties** dialog box can also be applied to a dynamic or late bound send port.</span></span> <span data-ttu-id="5da1c-107">若要使用 Windows Sharepoint Services 适配器上下文属性为动态或后期绑定发送端口设置配置属性，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="5da1c-107">To set configuration properties for a dynamic or late bound send port using the Windows Sharepoint Services adapter context properties follow these steps:</span></span>  
  
### <a name="to-set-configuration-properties-for-a-send-port-using-windows-sharepoint-services-adapter-context-properties"></a><span data-ttu-id="5da1c-108">使用 Windows Sharepoint Services 适配器上下文属性为发送端口设置配置属性</span><span class="sxs-lookup"><span data-stu-id="5da1c-108">To set configuration properties for a send port using Windows Sharepoint Services adapter context properties</span></span>  
  
1.  <span data-ttu-id="5da1c-109">对于动态发送端口，要创建动态单向发送端口，请按照主题中的步骤[如何创建发送端口](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="5da1c-109">For dynamic send ports, to create a Dynamic One-way send port, follow the steps in the topic [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span>  
  
2.  <span data-ttu-id="5da1c-110">使用 **消息分配** 中调整 **构造消息** 形状中业务流程以设置配置属性的出站消息。</span><span class="sxs-lookup"><span data-stu-id="5da1c-110">Use a **Message Assignment** shape within a **Construct Message** shape in an orchestration to set the configuration properties for the outbound message.</span></span> <span data-ttu-id="5da1c-111">有关如何设置出站消息的配置属性的示例，请参阅[演练： 模块 3-从业务流程访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="5da1c-111">For an example of how to set the configuration properties for an outbound message see [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="5da1c-112">**构造一条新消息** 本主题的部分演示如何设置配置的出站消息的属性。</span><span class="sxs-lookup"><span data-stu-id="5da1c-112">The **Construct a new message** section of this topic illustrates how to set configuration properties of an outbound message.</span></span> <span data-ttu-id="5da1c-113">可以在中设置的属性关联的适配器上下文属性 **Windows SharePoint Services 传输属性** 下表中列出对话框中︰</span><span class="sxs-lookup"><span data-stu-id="5da1c-113">The adapter context properties that correlate to the properties that can be set in the **Windows SharePoint Services Transport Properties** dialog box are listed in the table below:</span></span>  
  
    |<span data-ttu-id="5da1c-114">传输属性</span><span class="sxs-lookup"><span data-stu-id="5da1c-114">Transport Property</span></span>|<span data-ttu-id="5da1c-115">适配器上下文属性</span><span class="sxs-lookup"><span data-stu-id="5da1c-115">Adapter Context Property</span></span>|<span data-ttu-id="5da1c-116">数据类型</span><span class="sxs-lookup"><span data-stu-id="5da1c-116">Data Type</span></span>|<span data-ttu-id="5da1c-117">注释</span><span class="sxs-lookup"><span data-stu-id="5da1c-117">Comments</span></span>|  
    |------------------------|------------------------------|---------------|--------------|  
    |<span data-ttu-id="5da1c-118">适配器 Web Services 端口</span><span class="sxs-lookup"><span data-stu-id="5da1c-118">Adapter Web Service Port</span></span>|<span data-ttu-id="5da1c-119">WSS.ConfigAdapterWSPort</span><span class="sxs-lookup"><span data-stu-id="5da1c-119">WSS.ConfigAdapterWSPort</span></span>|<span data-ttu-id="5da1c-120">int</span><span class="sxs-lookup"><span data-stu-id="5da1c-120">Int</span></span>|<span data-ttu-id="5da1c-121">有效值为从 1 到 65535。</span><span class="sxs-lookup"><span data-stu-id="5da1c-121">Valid values are from 1 to 65535</span></span><br /><br /> <span data-ttu-id="5da1c-122">默认值为 80</span><span class="sxs-lookup"><span data-stu-id="5da1c-122">The default value is 80</span></span>|  
    |<span data-ttu-id="5da1c-123">超时</span><span class="sxs-lookup"><span data-stu-id="5da1c-123">Timeout</span></span>|<span data-ttu-id="5da1c-124">WSS.ConfigTimeout</span><span class="sxs-lookup"><span data-stu-id="5da1c-124">WSS.ConfigTimeout</span></span>|<span data-ttu-id="5da1c-125">int</span><span class="sxs-lookup"><span data-stu-id="5da1c-125">Int</span></span>|<span data-ttu-id="5da1c-126">有效值为从 1000年到 2147483647 之间</span><span class="sxs-lookup"><span data-stu-id="5da1c-126">Valid values are from 1000 to 2147483647</span></span><br /><br /> <span data-ttu-id="5da1c-127">默认值为 100000</span><span class="sxs-lookup"><span data-stu-id="5da1c-127">The default value is 100000</span></span><br /><br /> <span data-ttu-id="5da1c-128">指定值 0 表示无限超时。</span><span class="sxs-lookup"><span data-stu-id="5da1c-128">Specify a value of 0 to indicate an infinite timeout.</span></span>|  
    |<span data-ttu-id="5da1c-129">目标文件夹 URL</span><span class="sxs-lookup"><span data-stu-id="5da1c-129">Destination Folder URL</span></span>|<span data-ttu-id="5da1c-130">不适用</span><span class="sxs-lookup"><span data-stu-id="5da1c-130">NA</span></span>|<span data-ttu-id="5da1c-131">不适用</span><span class="sxs-lookup"><span data-stu-id="5da1c-131">NA</span></span>|<span data-ttu-id="5da1c-132">为使用动态端口，这设置间接的设置 **Microsoft.XLANGs.BaseTypes.Address** 属性具有表达式形状中业务流程的动态端口。</span><span class="sxs-lookup"><span data-stu-id="5da1c-132">For dynamic ports, this is set indirectly by setting the **Microsoft.XLANGs.BaseTypes.Address** property of the dynamic port with an expression shape in an orchestration.</span></span> <span data-ttu-id="5da1c-133">对于后期绑定端口，由于此属性始终被物理发送端口值覆盖，因此无法在运行时设置。</span><span class="sxs-lookup"><span data-stu-id="5da1c-133">For late-bound ports this property cannot be set at runtime since it is always overridden by the physical send port value.</span></span>|  
    |<span data-ttu-id="5da1c-134">Filename</span><span class="sxs-lookup"><span data-stu-id="5da1c-134">Filename</span></span>|<span data-ttu-id="5da1c-135">WSS.Filename</span><span class="sxs-lookup"><span data-stu-id="5da1c-135">WSS.Filename</span></span>|<span data-ttu-id="5da1c-136">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-136">String</span></span>|<span data-ttu-id="5da1c-137">支持除之外的传输属性中的所有可用的文件名宏使用 **%filename%** 和 **%扩展 %** 宏。</span><span class="sxs-lookup"><span data-stu-id="5da1c-137">Supports the use of all filename macros that can be used in the transport properties except for the **%Filename%** and **%Extension%** macros.</span></span>|  
    |<span data-ttu-id="5da1c-138">命名空间别名</span><span class="sxs-lookup"><span data-stu-id="5da1c-138">Namespaces Aliases</span></span>|<span data-ttu-id="5da1c-139">WSS.ConfigNamespaceAliases</span><span class="sxs-lookup"><span data-stu-id="5da1c-139">WSS.ConfigNamespaceAliases</span></span>|<span data-ttu-id="5da1c-140">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-140">String</span></span>|<span data-ttu-id="5da1c-141">如果在运行时为消息设置的命名空间别名与为消息路由到的发送端口设置的命名空间别名完全匹配，则这些命名空间将合并，并且会发生路由错误。</span><span class="sxs-lookup"><span data-stu-id="5da1c-141">If a namespace alias set for a message at runtime exactly matches the namespace alias set for the send port that the message is routed to then the namespaces are merged and a routing error occurs.</span></span> <span data-ttu-id="5da1c-142">若要避免此问题，请确保指定的命名空间别名不相同。</span><span class="sxs-lookup"><span data-stu-id="5da1c-142">To prevent this problem ensure that the specified namespace aliases are not identical.</span></span> <span data-ttu-id="5da1c-143">例如，如果在业务流程中使用以下表达式来设置消息的命名空间别名：</span><span class="sxs-lookup"><span data-stu-id="5da1c-143">For example if the following expression is used in an orchestration to set the namespace alias for a message:</span></span><br /><br /> `Message_Task(WSS.ConfigNamespaceAliases)= "orchns='http://OrderProcess.PurchaseOrder'";`<br /><br /> <span data-ttu-id="5da1c-144">如果此消息路由到指定的以下值发送端口和 **Namespace 别名** 属性︰</span><span class="sxs-lookup"><span data-stu-id="5da1c-144">and if this message is routed to a send port that specifies the following value for the **Namespace Aliases** property:</span></span><br /><br /> <span data-ttu-id="5da1c-145">orchns =http://OrderProcess.PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="5da1c-145">orchns='http://OrderProcess.PurchaseOrder'</span></span><br /><br /> <span data-ttu-id="5da1c-146">那么当 BizTalk Server 尝试将消息路由到此发送端口时便会发生错误。</span><span class="sxs-lookup"><span data-stu-id="5da1c-146">then an error will occur when BizTalk Server attempts to route the message to this send port.</span></span> <span data-ttu-id="5da1c-147">要解决此问题可以指定以下值以查找 **Namespace 别名** 发送端口的属性︰</span><span class="sxs-lookup"><span data-stu-id="5da1c-147">To resolve this problem you could specify the following value for the **Namespace Aliases** property of the send port:</span></span><br /><br /> <span data-ttu-id="5da1c-148">**orchns2**=http://OrderProcess.PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="5da1c-148">**orchns2**='http://OrderProcess.PurchaseOrder'</span></span>|  
    |<span data-ttu-id="5da1c-149">Overwrite</span><span class="sxs-lookup"><span data-stu-id="5da1c-149">Overwrite</span></span>|<span data-ttu-id="5da1c-150">WSS.ConfigOverwrite</span><span class="sxs-lookup"><span data-stu-id="5da1c-150">WSS.ConfigOverwrite</span></span>|<span data-ttu-id="5da1c-151">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-151">String</span></span>|<span data-ttu-id="5da1c-152">有效值包括：</span><span class="sxs-lookup"><span data-stu-id="5da1c-152">Valid values are:</span></span><br /><br /> <span data-ttu-id="5da1c-153">-"是"</span><span class="sxs-lookup"><span data-stu-id="5da1c-153">- "yes"</span></span><br /><br /> <span data-ttu-id="5da1c-154">-"否"</span><span class="sxs-lookup"><span data-stu-id="5da1c-154">- "no"</span></span><br /><br /> <span data-ttu-id="5da1c-155">-"重命名"</span><span class="sxs-lookup"><span data-stu-id="5da1c-155">- "rename"</span></span>|  
    |<span data-ttu-id="5da1c-156">SharePoint 站点 URL</span><span class="sxs-lookup"><span data-stu-id="5da1c-156">SharePoint Site URL</span></span>|<span data-ttu-id="5da1c-157">WSS.InListUrl</span><span class="sxs-lookup"><span data-stu-id="5da1c-157">WSS.InListUrl</span></span>|<span data-ttu-id="5da1c-158">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-158">String</span></span>|<span data-ttu-id="5da1c-159">为使用动态端口，这设置间接的设置 **Microsoft.XLANGs.BaseTypes.Address** 属性具有表达式形状中业务流程的动态端口。</span><span class="sxs-lookup"><span data-stu-id="5da1c-159">For dynamic ports, this is set indirectly by setting the **Microsoft.XLANGs.BaseTypes.Address** property of the dynamic port with an expression shape in an orchestration.</span></span> <span data-ttu-id="5da1c-160">对于后期绑定端口，由于此属性始终被物理发送端口值覆盖，因此无法在运行时设置。</span><span class="sxs-lookup"><span data-stu-id="5da1c-160">For late-bound ports this property cannot be set at runtime since it is always overridden by the physical send port value.</span></span>|  
    |<span data-ttu-id="5da1c-161">Microsoft Office 集成</span><span class="sxs-lookup"><span data-stu-id="5da1c-161">Microsoft Office Integration</span></span>|<span data-ttu-id="5da1c-162">WSS.ConfigOfficeIntegration</span><span class="sxs-lookup"><span data-stu-id="5da1c-162">WSS.ConfigOfficeIntegration</span></span>|<span data-ttu-id="5da1c-163">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-163">String</span></span>|<span data-ttu-id="5da1c-164">有效值包括：</span><span class="sxs-lookup"><span data-stu-id="5da1c-164">Valid values are:</span></span><br /><br /> <span data-ttu-id="5da1c-165">-"是"</span><span class="sxs-lookup"><span data-stu-id="5da1c-165">- "yes"</span></span><br /><br /> <span data-ttu-id="5da1c-166">-"否"</span><span class="sxs-lookup"><span data-stu-id="5da1c-166">- "no"</span></span><br /><br /> <span data-ttu-id="5da1c-167">-"yesformlibrary"</span><span class="sxs-lookup"><span data-stu-id="5da1c-167">- "yesformlibrary"</span></span><br /><br /> <span data-ttu-id="5da1c-168">-"可选"</span><span class="sxs-lookup"><span data-stu-id="5da1c-168">- "optional"</span></span>|  
    |<span data-ttu-id="5da1c-169">模板文档库</span><span class="sxs-lookup"><span data-stu-id="5da1c-169">Templates Document Library</span></span>|<span data-ttu-id="5da1c-170">WSS.ConfigTemplatesDocLib</span><span class="sxs-lookup"><span data-stu-id="5da1c-170">WSS.ConfigTemplatesDocLib</span></span>|<span data-ttu-id="5da1c-171">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-171">String</span></span>|<span data-ttu-id="5da1c-172">无</span><span class="sxs-lookup"><span data-stu-id="5da1c-172">None</span></span>|  
    |<span data-ttu-id="5da1c-173">模板后备文档库</span><span class="sxs-lookup"><span data-stu-id="5da1c-173">Templates Fallback Document Library</span></span>|<span data-ttu-id="5da1c-174">WSS.ConfigCustomTemplatesDocLib</span><span class="sxs-lookup"><span data-stu-id="5da1c-174">WSS.ConfigCustomTemplatesDocLib</span></span>|<span data-ttu-id="5da1c-175">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-175">String</span></span>|<span data-ttu-id="5da1c-176">InclusionThresholdSetting</span><span class="sxs-lookup"><span data-stu-id="5da1c-176">None</span></span>|  
    |<span data-ttu-id="5da1c-177">模板后备命名空间栏</span><span class="sxs-lookup"><span data-stu-id="5da1c-177">Templates Fallback Namespace Column</span></span>|<span data-ttu-id="5da1c-178">WSS.ConfigCustomTemplatesNamespaceCol</span><span class="sxs-lookup"><span data-stu-id="5da1c-178">WSS.ConfigCustomTemplatesNamespaceCol</span></span>|<span data-ttu-id="5da1c-179">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-179">String</span></span>|<span data-ttu-id="5da1c-180">无</span><span class="sxs-lookup"><span data-stu-id="5da1c-180">None</span></span>|  
    |<span data-ttu-id="5da1c-181">模板命名空间栏</span><span class="sxs-lookup"><span data-stu-id="5da1c-181">Templates Namespace Column</span></span>|<span data-ttu-id="5da1c-182">WSS.ConfigTemplatesNamespaceCol</span><span class="sxs-lookup"><span data-stu-id="5da1c-182">WSS.ConfigTemplatesNamespaceCol</span></span>|<span data-ttu-id="5da1c-183">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-183">String</span></span>|<span data-ttu-id="5da1c-184">无</span><span class="sxs-lookup"><span data-stu-id="5da1c-184">None</span></span>|  
    |<span data-ttu-id="5da1c-185">列 `n`</span><span class="sxs-lookup"><span data-stu-id="5da1c-185">Column `n`</span></span>|<span data-ttu-id="5da1c-186">WSS.ConfigPropertiesXml</span><span class="sxs-lookup"><span data-stu-id="5da1c-186">WSS.ConfigPropertiesXml</span></span><br /><br /> <span data-ttu-id="5da1c-187">在中设置列名称\<PropertyName*x*\>*columnname*\</ PropertyName*x* \>字段。</span><span class="sxs-lookup"><span data-stu-id="5da1c-187">Column name is set in \<PropertyName*x*\>*columnname*\</ PropertyName*x*\> field.</span></span>|<span data-ttu-id="5da1c-188">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-188">String</span></span>|<span data-ttu-id="5da1c-189">无</span><span class="sxs-lookup"><span data-stu-id="5da1c-189">None</span></span>|  
    |<span data-ttu-id="5da1c-190">列 `n` 值</span><span class="sxs-lookup"><span data-stu-id="5da1c-190">Column `n` Value</span></span>|<span data-ttu-id="5da1c-191">WSS.ConfigPropertiesXml</span><span class="sxs-lookup"><span data-stu-id="5da1c-191">WSS.ConfigPropertiesXml</span></span><br /><br /> <span data-ttu-id="5da1c-192">在中设置列值\<PropertySource*x*\>*columnvalue*\</ PropertySource*x* \>字段。</span><span class="sxs-lookup"><span data-stu-id="5da1c-192">Column value is set in \<PropertySource*x*\>*columnvalue*\</ PropertySource*x*\> field.</span></span>|<span data-ttu-id="5da1c-193">字符串</span><span class="sxs-lookup"><span data-stu-id="5da1c-193">String</span></span>|<span data-ttu-id="5da1c-194">支持除之外的传输属性中的所有可用的文件名宏使用 **%filename%** 和 **%扩展 %** 宏。</span><span class="sxs-lookup"><span data-stu-id="5da1c-194">Supports the use of all filename macros that can be used in the transport properties except for the **%Filename%** and **%Extension%** macros.</span></span>|  
  
    > [!NOTE]
    >  <span data-ttu-id="5da1c-195">为上下文属性提供的值都是区分大小写的。</span><span class="sxs-lookup"><span data-stu-id="5da1c-195">The values supplied for context properties are case sensitive.</span></span> <span data-ttu-id="5da1c-196">在使用上下文属性设置动态端口的配置值时，需确保使用正确的大小写格式，否则，如果 BizTalk 尝试将文档路由到指定的发送端口，将会出现错误。</span><span class="sxs-lookup"><span data-stu-id="5da1c-196">When setting configuration values for a dynamic port with context properties ensure that you use the proper case or an error will occur when BizTalk attempts to route the document to the designated send port.</span></span>  
  
3.  <span data-ttu-id="5da1c-197">使用表达式形状中业务流程将 **Microsoft.XLANGs.BaseTypes.Address** 属性动态发送端口。</span><span class="sxs-lookup"><span data-stu-id="5da1c-197">Use an expression shape in an orchestration to set the **Microsoft.XLANGs.BaseTypes.Address** property for the dynamic send port.</span></span> <span data-ttu-id="5da1c-198">此属性用于指定动态发送端口将消息路由到的 URI。</span><span class="sxs-lookup"><span data-stu-id="5da1c-198">This property is used to specify the URI that the dynamic send port routes the message to.</span></span> <span data-ttu-id="5da1c-199">有关如何设置的示例**Microsoft.XLANGs.BaseTypes.Address**动态发送端口属性请参阅**创建一个表达式**主题的部分[演练： 模块 3-从业务流程访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="5da1c-199">For an example of how to set the **Microsoft.XLANGs.BaseTypes.Address** property for a dynamic send port see the **Create an expression** section of the topic [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="5da1c-200">有关 Windows Sharepoint Services 适配器上下文属性的详细信息请参阅[Windows SharePoint Services 适配器属性参考](../core/windows-sharepoint-services-adapter-properties-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="5da1c-200">For more information about the Windows Sharepoint Services adapter context properties see [Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md).</span></span>  
  
     <span data-ttu-id="5da1c-201">另外，也可以在业务流程中动态设置后期绑定 Windows Sharepoint Services 发送端口的某些属性。</span><span class="sxs-lookup"><span data-stu-id="5da1c-201">It is also possible to dynamically set certain properties of a late bound Windows Sharepoint Services send port in an orchestration.</span></span> <span data-ttu-id="5da1c-202">这样，Windows SharePoint Services 端口将配置两次，一次是通过 Windows SharePoint Services 上下文属性，一次是通过“Windows SharePoint Services 传输属性”对话框。</span><span class="sxs-lookup"><span data-stu-id="5da1c-202">If this is done, the Windows SharePoint Services port will be configured twice, once through the Windows SharePoint Services context properties and once through the Windows SharePoint Services Transport Properties dialog box.</span></span> <span data-ttu-id="5da1c-203">默认情况下，在“Windows SharePoint Services 传输属性”对话框中指定的配置优先于在上下文属性中指定的配置属性。</span><span class="sxs-lookup"><span data-stu-id="5da1c-203">By default, the configuration specified in the Windows SharePoint Services Transport Properties dialog box takes precedence over the configuration properties specified in the context properties.</span></span> <span data-ttu-id="5da1c-204">若要使用在上下文属性中指定的配置，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="5da1c-204">In order to use the configuration specified in the context properties follow these steps:</span></span>  
  
    1.  <span data-ttu-id="5da1c-205">若要创建一个静态单向发送端口，请按照本主题中的步骤[如何创建发送端口](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="5da1c-205">To create a Static One-way send port, follow the steps in the topic [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span>  
  
    2.  <span data-ttu-id="5da1c-206">设置为发送端口属性时，通过输入适当的值的定义发送端口的 URI **Sharepoint 站点 URL** 和 **目标文件夹 URL** 属性。</span><span class="sxs-lookup"><span data-stu-id="5da1c-206">When setting the properties for the send port, define the URI for the send port by entering the appropriate values for the **Sharepoint Site URL** and **Destination Folder URL** properties.</span></span>  
  
    3.  <span data-ttu-id="5da1c-207">设置的值 **覆盖** 属性 **Orchestration** 如果想要使用的上下文属性所定义的值 **WSS。ConfigOverwrite** 业务流程中。</span><span class="sxs-lookup"><span data-stu-id="5da1c-207">Set the value of the **Overwrite** property to **Orchestration** if you want to use the value defined by the context property **WSS.ConfigOverwrite** in an orchestration.</span></span>  
  
    4.  <span data-ttu-id="5da1c-208">设置 **Microsoft Office 集成** 属性 **Orchestration** 如果想要使用的上下文属性所定义的值 **WSS。ConfigOfficeIntegration** 业务流程中。</span><span class="sxs-lookup"><span data-stu-id="5da1c-208">Set the **Microsoft Office Integration** property to **Orchestration** if you want to use the value defined by the context property **WSS.ConfigOfficeIntegration** in an orchestration.</span></span>  
  
    5.  <span data-ttu-id="5da1c-209">输入的值为 **-1** 为任何发送端口属性使用整数数据类型，如果你想要在业务流程中设置的上下文属性为这些值。</span><span class="sxs-lookup"><span data-stu-id="5da1c-209">Enter a value of **-1** for any send port properties that use the integer data type if you want to set those values with a context property in an orchestration.</span></span>  
  
    6.  <span data-ttu-id="5da1c-210">对于使用字符串数据类型的任何发送端口属性，若要使用业务流程中的上下文属性设置它们的值，请将其留空。</span><span class="sxs-lookup"><span data-stu-id="5da1c-210">Leave blank any send port properties that use the string data type if you want to set those values with a context property in an orchestration.</span></span> <span data-ttu-id="5da1c-211">这不适用于 **Sharepoint 站点 URL** 和 **目标文件夹 URL** 属性。</span><span class="sxs-lookup"><span data-stu-id="5da1c-211">This does not apply to the **Sharepoint Site URL** and **Destination Folder URL** properties.</span></span> <span data-ttu-id="5da1c-212">必须将这些属性指定在 **Windows Sharepoint Services 传输属性** 对话框。</span><span class="sxs-lookup"><span data-stu-id="5da1c-212">These properties must be specified in the **Windows Sharepoint Services Transport Properties** dialog box.</span></span>  
  
    7.  <span data-ttu-id="5da1c-213">使用 **消息分配** 中调整 **构造消息** 形状中业务流程以设置配置属性的出站消息。</span><span class="sxs-lookup"><span data-stu-id="5da1c-213">Use a **Message Assignment** shape within a **Construct Message** shape in an orchestration to set the configuration properties for the outbound message.</span></span> <span data-ttu-id="5da1c-214">有关如何设置出站消息的配置属性的示例，请参阅[演练： 模块 3-从业务流程访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="5da1c-214">For an example of how to set the configuration properties for an outbound message see [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="5da1c-215">**构造一条新消息** 本主题的部分演示如何设置配置的出站消息的属性。</span><span class="sxs-lookup"><span data-stu-id="5da1c-215">The **Construct a new message** section of this topic illustrates how to set configuration properties of an outbound message.</span></span>  
  
    8.  <span data-ttu-id="5da1c-216">值配置为 -1（使用整数数据类型的属性）、“业务流程”（下拉枚举属性）或留空（使用字符串数据类型的属性）的任何发送端口属性都将在运行时使用业务流程中指定的上下文属性进行设置。</span><span class="sxs-lookup"><span data-stu-id="5da1c-216">Any send port properties that are configured with a value of -1 (for properties that use the integer data type), "Orchestration" (for drop-down enumeration properties) or are left blank (for properties that use the string data type) will be set at run time with the context property that was specified in the orchestration.</span></span>  
  
 <span data-ttu-id="5da1c-217">如果你使用 Windows SharePoint Services 适配器接收带有嵌入的附件的 InfoPath 窗体，然后将 InfoPath 窗体发送到 SharePoint 文档库，完成以下步骤以保留该窗体中任何 InfoPath 处理指令︰</span><span class="sxs-lookup"><span data-stu-id="5da1c-217">If you use the Windows SharePoint Services adapter to receive InfoPath forms with embedded attachments and then send the InfoPath forms to a SharePoint document library, complete the following steps to preserve any InfoPath processing instructions that are in the form:</span></span>  
  
### <a name="to-preserve-infopath-processing-instructions-for-infopath-forms-with-embedded-attachments-processed-by-biztalk-server"></a><span data-ttu-id="5da1c-218">为具有 BizTalk Server 处理的嵌入附件的 InfoPath 表单保留 InfoPath 处理指令</span><span class="sxs-lookup"><span data-stu-id="5da1c-218">To preserve InfoPath processing instructions for InfoPath forms with embedded attachments processed by BizTalk Server</span></span>  
  
1.  <span data-ttu-id="5da1c-219">如果你使用地图中业务流程进行映射数据从一个 InfoPath 窗体复制到另一个的 InfoPath 窗体，确保已将 **复制处理指令 (Pi)** 中映射到属性 **是**。</span><span class="sxs-lookup"><span data-stu-id="5da1c-219">If you are using a map in the orchestration to map data from one InfoPath form to another InfoPath form, ensure that you have set the **Copy Processing Instructions (PIs)** property in the map to **Yes**.</span></span> <span data-ttu-id="5da1c-220">此参数设置下 **自定义标头** 部分 **网格属性** 地图的页。</span><span class="sxs-lookup"><span data-stu-id="5da1c-220">This parameter is set under the **Custom Header** section of the **Grid Properties** page for the map.</span></span>  
  
2.  <span data-ttu-id="5da1c-221">如果使用的不是业务流程中的映射，请在消息赋值形状中使用以下表达式来更新输出消息：</span><span class="sxs-lookup"><span data-stu-id="5da1c-221">If you are not using a map in the orchestration, update the output message using the following expression in a message assignment shape:</span></span>  
  
    ```  
    NewMessage(XMLNORM.ProcessingInstructionOption) = 1;  
    NewMessage(XMLNORM.ProcessingInstruction) = "<?mso-infoPath-file-attachment-present?>"  
    ```  
  
     <span data-ttu-id="5da1c-222">在更高版本，表达式中 *NewMessage* 是要添加到处理指令的输出消息。</span><span class="sxs-lookup"><span data-stu-id="5da1c-222">In the expression above, *NewMessage* is the output message that you are adding the processing instructions to.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5da1c-223">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5da1c-223">See Also</span></span>  
 [<span data-ttu-id="5da1c-224">如何创建发送端口</span><span class="sxs-lookup"><span data-stu-id="5da1c-224">How to Create a Send Port</span></span>](../core/how-to-create-a-send-port2.md)