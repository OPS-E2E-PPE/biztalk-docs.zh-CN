---
title: 如何配置发送端口使用 Windows Sharepoint Services 上下文属性 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Windows SharePoint Services adapters, InfoPath forms
- configuring [Windows SharePoint Services adapters], InfoPath forms
- Windows SharePoint Services adapters, Windows SharePoint Services
- InfoPath forms, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], Windows SharePoint Services
- Windows SharePoint Services adapters, send ports
- configuring [Windows SharePoint Services adapters], send ports
- send ports, Windows SharePoint Services adapters
- Windows SharePoint Services, Windows SharePoint Services adapters
ms.assetid: 1ff50fb8-7ba0-47b8-9476-d57413989346
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 54fed879058c43529eb4d0f62972eeaf88373de4
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65391448"
---
# <a name="how-to-configure-send-ports-using-windows-sharepoint-services-context-properties"></a><span data-ttu-id="e81f4-102">如何配置发送端口使用 Windows Sharepoint Services 上下文属性</span><span class="sxs-lookup"><span data-stu-id="e81f4-102">How to Configure Send Ports Using Windows Sharepoint Services Context Properties</span></span>
<span data-ttu-id="e81f4-103">本主题介绍如何使用 BizTalk 业务流程中的 Windows Sharepoint Services 上下文属性在运行时配置 Windows SharePoint Services 发送端口。</span><span class="sxs-lookup"><span data-stu-id="e81f4-103">This topic describes how to configure Windows SharePoint Services send ports at runtime using Windows Sharepoint Services context properties from a BizTalk orchestration.</span></span> <span data-ttu-id="e81f4-104">可以使用相同的机制来配置 Windows SharePoint Services 动态和后期绑定发送端口。</span><span class="sxs-lookup"><span data-stu-id="e81f4-104">The same mechanism can be used to configure Windows SharePoint Services dynamic and late-bound send ports.</span></span> <span data-ttu-id="e81f4-105">在运行时业务流程中设置动态发送端口的配置属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-105">The configuration properties for a dynamic send port are set in an orchestration at runtime.</span></span> <span data-ttu-id="e81f4-106">适配器属性中公开的**Windows SharePoint Services 传输属性**对话框还可以应用于动态或后期绑定的发送端口。</span><span class="sxs-lookup"><span data-stu-id="e81f4-106">Adapter properties that are exposed in the **Windows SharePoint Services Transport Properties** dialog box can also be applied to a dynamic or late bound send port.</span></span> <span data-ttu-id="e81f4-107">要设置配置属性为动态或后期绑定的发送端口使用 Windows Sharepoint Services 适配器上下文属性，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="e81f4-107">To set configuration properties for a dynamic or late bound send port using the Windows Sharepoint Services adapter context properties follow these steps:</span></span>  

### <a name="to-set-configuration-properties-for-a-send-port-using-windows-sharepoint-services-adapter-context-properties"></a><span data-ttu-id="e81f4-108">若要设置使用 Windows Sharepoint Services 适配器上下文属性的发送端口的配置属性</span><span class="sxs-lookup"><span data-stu-id="e81f4-108">To set configuration properties for a send port using Windows Sharepoint Services adapter context properties</span></span>  

1. <span data-ttu-id="e81f4-109">对于动态发送端口，若要创建动态单向发送端口，请执行本主题中的步骤[如何创建发送端口](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="e81f4-109">For dynamic send ports, to create a Dynamic One-way send port, follow the steps in the topic [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span>  

2. <span data-ttu-id="e81f4-110">使用**消息赋值**形状内**构造消息**形状在业务流程来设置出站消息的配置属性中。</span><span class="sxs-lookup"><span data-stu-id="e81f4-110">Use a **Message Assignment** shape within a **Construct Message** shape in an orchestration to set the configuration properties for the outbound message.</span></span> <span data-ttu-id="e81f4-111">有关如何设置出站消息的配置属性的示例，请参阅[演练：模块 3-从业务流程中访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="e81f4-111">For an example of how to set the configuration properties for an outbound message see [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="e81f4-112">**构造新消息**本主题的部分说明了如何设置出站消息的配置属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-112">The **Construct a new message** section of this topic illustrates how to set configuration properties of an outbound message.</span></span> <span data-ttu-id="e81f4-113">将可以在中设置的属性相关联的适配器上下文属性**Windows SharePoint Services 传输属性**对话框下表中列出：</span><span class="sxs-lookup"><span data-stu-id="e81f4-113">The adapter context properties that correlate to the properties that can be set in the **Windows SharePoint Services Transport Properties** dialog box are listed in the table below:</span></span>  


   |         <span data-ttu-id="e81f4-114">传输属性</span><span class="sxs-lookup"><span data-stu-id="e81f4-114">Transport Property</span></span>          |                                                  <span data-ttu-id="e81f4-115">适配器上下文属性</span><span class="sxs-lookup"><span data-stu-id="e81f4-115">Adapter Context Property</span></span>                                                   | <span data-ttu-id="e81f4-116">数据类型</span><span class="sxs-lookup"><span data-stu-id="e81f4-116">Data Type</span></span> |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <span data-ttu-id="e81f4-117">注释</span><span class="sxs-lookup"><span data-stu-id="e81f4-117">Comments</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |      <span data-ttu-id="e81f4-118">适配器 Web 服务端口</span><span class="sxs-lookup"><span data-stu-id="e81f4-118">Adapter Web Service Port</span></span>       |                                                   <span data-ttu-id="e81f4-119">WSS.ConfigAdapterWSPort</span><span class="sxs-lookup"><span data-stu-id="e81f4-119">WSS.ConfigAdapterWSPort</span></span>                                                   |    <span data-ttu-id="e81f4-120">smallint</span><span class="sxs-lookup"><span data-stu-id="e81f4-120">Int</span></span>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-121">有效值为从 1 到 65535 之间</span><span class="sxs-lookup"><span data-stu-id="e81f4-121">Valid values are from 1 to 65535</span></span><br /><br /> <span data-ttu-id="e81f4-122">默认值为 80</span><span class="sxs-lookup"><span data-stu-id="e81f4-122">The default value is 80</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |               <span data-ttu-id="e81f4-123">超时</span><span class="sxs-lookup"><span data-stu-id="e81f4-123">Timeout</span></span>               |                                                      <span data-ttu-id="e81f4-124">WSS.ConfigTimeout</span><span class="sxs-lookup"><span data-stu-id="e81f4-124">WSS.ConfigTimeout</span></span>                                                      |    <span data-ttu-id="e81f4-125">smallint</span><span class="sxs-lookup"><span data-stu-id="e81f4-125">Int</span></span>    |                                                                                                                                                                                                                                                                                                                                                                                                                             <span data-ttu-id="e81f4-126">有效值为从 1000年到 2147483647 之间</span><span class="sxs-lookup"><span data-stu-id="e81f4-126">Valid values are from 1000 to 2147483647</span></span><br /><br /> <span data-ttu-id="e81f4-127">默认值为 100000</span><span class="sxs-lookup"><span data-stu-id="e81f4-127">The default value is 100000</span></span><br /><br /> <span data-ttu-id="e81f4-128">指定的值为 0，表示无限超时。</span><span class="sxs-lookup"><span data-stu-id="e81f4-128">Specify a value of 0 to indicate an infinite timeout.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |       <span data-ttu-id="e81f4-129">目标文件夹 URL</span><span class="sxs-lookup"><span data-stu-id="e81f4-129">Destination Folder URL</span></span>        |                                                             <span data-ttu-id="e81f4-130">不适用</span><span class="sxs-lookup"><span data-stu-id="e81f4-130">NA</span></span>                                                              |    <span data-ttu-id="e81f4-131">不适用</span><span class="sxs-lookup"><span data-stu-id="e81f4-131">NA</span></span>     |                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-132">对于动态端口，这间接通过设置设置**Microsoft.XLANGs.BaseTypes.Address**具有表达式形状在业务流程中的动态端口的属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-132">For dynamic ports, this is set indirectly by setting the **Microsoft.XLANGs.BaseTypes.Address** property of the dynamic port with an expression shape in an orchestration.</span></span> <span data-ttu-id="e81f4-133">因为它始终由物理重写不能在运行时设置此属性的后期绑定端口将发送端口值。</span><span class="sxs-lookup"><span data-stu-id="e81f4-133">For late-bound ports this property cannot be set at runtime since it is always overridden by the physical send port value.</span></span>                                                                                                                                                                                                                                                                                                                                                    |
   |              <span data-ttu-id="e81f4-134">Filename</span><span class="sxs-lookup"><span data-stu-id="e81f4-134">Filename</span></span>               |                                                        <span data-ttu-id="e81f4-135">WSS.Filename</span><span class="sxs-lookup"><span data-stu-id="e81f4-135">WSS.Filename</span></span>                                                         |  <span data-ttu-id="e81f4-136">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-136">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                               <span data-ttu-id="e81f4-137">支持除传输属性中的所有文件名宏，可以在使用 **%filename%** 并 **%extension%** 宏。</span><span class="sxs-lookup"><span data-stu-id="e81f4-137">Supports the use of all filename macros that can be used in the transport properties except for the **%Filename%** and **%Extension%** macros.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                |
   |         <span data-ttu-id="e81f4-138">命名空间别名</span><span class="sxs-lookup"><span data-stu-id="e81f4-138">Namespaces Aliases</span></span>          |                                                 <span data-ttu-id="e81f4-139">WSS.ConfigNamespaceAliases</span><span class="sxs-lookup"><span data-stu-id="e81f4-139">WSS.ConfigNamespaceAliases</span></span>                                                  |  <span data-ttu-id="e81f4-140">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-140">String</span></span>   | <span data-ttu-id="e81f4-141">如果消息在运行时设置完全的命名空间别名与为消息路由到发送端口设置的命名空间别名相匹配的命名空间将合并然后和发生路由错误。</span><span class="sxs-lookup"><span data-stu-id="e81f4-141">If a namespace alias set for a message at runtime exactly matches the namespace alias set for the send port that the message is routed to then the namespaces are merged and a routing error occurs.</span></span> <span data-ttu-id="e81f4-142">若要避免此问题，请确保指定的命名空间别名不相同。</span><span class="sxs-lookup"><span data-stu-id="e81f4-142">To prevent this problem ensure that the specified namespace aliases are not identical.</span></span> <span data-ttu-id="e81f4-143">例如，如果下面的表达式用于业务流程中设置的命名空间别名一条消息：</span><span class="sxs-lookup"><span data-stu-id="e81f4-143">For example if the following expression is used in an orchestration to set the namespace alias for a message:</span></span><br /><br /> `Message_Task(WSS.ConfigNamespaceAliases)= "orchns='http://OrderProcess.PurchaseOrder'";`<br /><br /> <span data-ttu-id="e81f4-144">如果此消息将路由到发送端口，指定以下值以查找**Namespace 别名**属性：</span><span class="sxs-lookup"><span data-stu-id="e81f4-144">and if this message is routed to a send port that specifies the following value for the **Namespace Aliases** property:</span></span><br /><br /> <span data-ttu-id="e81f4-145">orchns =<http://OrderProcess.PurchaseOrder></span><span class="sxs-lookup"><span data-stu-id="e81f4-145">orchns='<http://OrderProcess.PurchaseOrder>'</span></span><br /><br /> <span data-ttu-id="e81f4-146">然后，BizTalk Server 尝试将消息路由到此发送端口时，将会出错。</span><span class="sxs-lookup"><span data-stu-id="e81f4-146">then an error will occur when BizTalk Server attempts to route the message to this send port.</span></span> <span data-ttu-id="e81f4-147">若要解决此问题可以指定以下值以查找**Namespace 别名**发送端口的属性：</span><span class="sxs-lookup"><span data-stu-id="e81f4-147">To resolve this problem you could specify the following value for the **Namespace Aliases** property of the send port:</span></span><br /><br /> <span data-ttu-id="e81f4-148">**orchns2**='<http://OrderProcess.PurchaseOrder>'</span><span class="sxs-lookup"><span data-stu-id="e81f4-148">**orchns2**='<http://OrderProcess.PurchaseOrder>'</span></span> |
   |              <span data-ttu-id="e81f4-149">Overwrite</span><span class="sxs-lookup"><span data-stu-id="e81f4-149">Overwrite</span></span>              |                                                     <span data-ttu-id="e81f4-150">WSS.ConfigOverwrite</span><span class="sxs-lookup"><span data-stu-id="e81f4-150">WSS.ConfigOverwrite</span></span>                                                     |  <span data-ttu-id="e81f4-151">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-151">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                               <span data-ttu-id="e81f4-152">有效值为</span><span class="sxs-lookup"><span data-stu-id="e81f4-152">Valid values are:</span></span><br /><br /> <span data-ttu-id="e81f4-153">-"是 yes"</span><span class="sxs-lookup"><span data-stu-id="e81f4-153">- "yes"</span></span><br /><br /> <span data-ttu-id="e81f4-154">-"no"</span><span class="sxs-lookup"><span data-stu-id="e81f4-154">- "no"</span></span><br /><br /> <span data-ttu-id="e81f4-155">-"重命名"</span><span class="sxs-lookup"><span data-stu-id="e81f4-155">- "rename"</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |         <span data-ttu-id="e81f4-156">SharePoint 站点 URL</span><span class="sxs-lookup"><span data-stu-id="e81f4-156">SharePoint Site URL</span></span>         |                                                        <span data-ttu-id="e81f4-157">WSS.InListUrl</span><span class="sxs-lookup"><span data-stu-id="e81f4-157">WSS.InListUrl</span></span>                                                        |  <span data-ttu-id="e81f4-158">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-158">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-159">对于动态端口，这间接通过设置设置**Microsoft.XLANGs.BaseTypes.Address**具有表达式形状在业务流程中的动态端口的属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-159">For dynamic ports, this is set indirectly by setting the **Microsoft.XLANGs.BaseTypes.Address** property of the dynamic port with an expression shape in an orchestration.</span></span> <span data-ttu-id="e81f4-160">因为它始终由物理重写不能在运行时设置此属性的后期绑定端口将发送端口值。</span><span class="sxs-lookup"><span data-stu-id="e81f4-160">For late-bound ports this property cannot be set at runtime since it is always overridden by the physical send port value.</span></span>                                                                                                                                                                                                                                                                                                                                                    |
   |    <span data-ttu-id="e81f4-161">Microsoft Office 集成</span><span class="sxs-lookup"><span data-stu-id="e81f4-161">Microsoft Office Integration</span></span>     |                                                 <span data-ttu-id="e81f4-162">WSS.ConfigOfficeIntegration</span><span class="sxs-lookup"><span data-stu-id="e81f4-162">WSS.ConfigOfficeIntegration</span></span>                                                 |  <span data-ttu-id="e81f4-163">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-163">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                              <span data-ttu-id="e81f4-164">有效值为</span><span class="sxs-lookup"><span data-stu-id="e81f4-164">Valid values are:</span></span><br /><br /> <span data-ttu-id="e81f4-165">-"是 yes"</span><span class="sxs-lookup"><span data-stu-id="e81f4-165">- "yes"</span></span><br /><br /> <span data-ttu-id="e81f4-166">-"no"</span><span class="sxs-lookup"><span data-stu-id="e81f4-166">- "no"</span></span><br /><br /> <span data-ttu-id="e81f4-167">-"yesformlibrary"</span><span class="sxs-lookup"><span data-stu-id="e81f4-167">- "yesformlibrary"</span></span><br /><br /> <span data-ttu-id="e81f4-168">-"可选"</span><span class="sxs-lookup"><span data-stu-id="e81f4-168">- "optional"</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |     <span data-ttu-id="e81f4-169">模板文档库</span><span class="sxs-lookup"><span data-stu-id="e81f4-169">Templates Document Library</span></span>      |                                                  <span data-ttu-id="e81f4-170">WSS.ConfigTemplatesDocLib</span><span class="sxs-lookup"><span data-stu-id="e81f4-170">WSS.ConfigTemplatesDocLib</span></span>                                                  |  <span data-ttu-id="e81f4-171">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-171">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-172">None</span><span class="sxs-lookup"><span data-stu-id="e81f4-172">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   | <span data-ttu-id="e81f4-173">模板后备文档库</span><span class="sxs-lookup"><span data-stu-id="e81f4-173">Templates Fallback Document Library</span></span> |                                               <span data-ttu-id="e81f4-174">WSS.ConfigCustomTemplatesDocLib</span><span class="sxs-lookup"><span data-stu-id="e81f4-174">WSS.ConfigCustomTemplatesDocLib</span></span>                                               |  <span data-ttu-id="e81f4-175">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-175">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-176">None</span><span class="sxs-lookup"><span data-stu-id="e81f4-176">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   | <span data-ttu-id="e81f4-177">模板后备 Namespace 栏</span><span class="sxs-lookup"><span data-stu-id="e81f4-177">Templates Fallback Namespace Column</span></span> |                                            <span data-ttu-id="e81f4-178">WSS.ConfigCustomTemplatesNamespaceCol</span><span class="sxs-lookup"><span data-stu-id="e81f4-178">WSS.ConfigCustomTemplatesNamespaceCol</span></span>                                            |  <span data-ttu-id="e81f4-179">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-179">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-180">None</span><span class="sxs-lookup"><span data-stu-id="e81f4-180">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |     <span data-ttu-id="e81f4-181">模板 Namespace 列</span><span class="sxs-lookup"><span data-stu-id="e81f4-181">Templates Namespace Column</span></span>      |                                               <span data-ttu-id="e81f4-182">WSS.ConfigTemplatesNamespaceCol</span><span class="sxs-lookup"><span data-stu-id="e81f4-182">WSS.ConfigTemplatesNamespaceCol</span></span>                                               |  <span data-ttu-id="e81f4-183">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-183">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-184">None</span><span class="sxs-lookup"><span data-stu-id="e81f4-184">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |             <span data-ttu-id="e81f4-185">列 `n`</span><span class="sxs-lookup"><span data-stu-id="e81f4-185">Column `n`</span></span>              |    <span data-ttu-id="e81f4-186">WSS.ConfigPropertiesXml</span><span class="sxs-lookup"><span data-stu-id="e81f4-186">WSS.ConfigPropertiesXml</span></span><br /><br /> <span data-ttu-id="e81f4-187">在中设置列名称\<PropertyName*x*\>*columnname*\</ PropertyName*x* \>字段。</span><span class="sxs-lookup"><span data-stu-id="e81f4-187">Column name is set in \<PropertyName*x*\>*columnname*\</ PropertyName*x*\> field.</span></span>    |  <span data-ttu-id="e81f4-188">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-188">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="e81f4-189">None</span><span class="sxs-lookup"><span data-stu-id="e81f4-189">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |          <span data-ttu-id="e81f4-190">列`n`值</span><span class="sxs-lookup"><span data-stu-id="e81f4-190">Column `n` Value</span></span>           | <span data-ttu-id="e81f4-191">WSS.ConfigPropertiesXml</span><span class="sxs-lookup"><span data-stu-id="e81f4-191">WSS.ConfigPropertiesXml</span></span><br /><br /> <span data-ttu-id="e81f4-192">列的值设置\<PropertySource*x*\>*columnvalue*\</ PropertySource*x* \>字段。</span><span class="sxs-lookup"><span data-stu-id="e81f4-192">Column value is set in \<PropertySource*x*\>*columnvalue*\</ PropertySource*x*\> field.</span></span> |  <span data-ttu-id="e81f4-193">String</span><span class="sxs-lookup"><span data-stu-id="e81f4-193">String</span></span>   |                                                                                                                                                                                                                                                                                                                                                                                                                               <span data-ttu-id="e81f4-194">支持除传输属性中的所有文件名宏，可以在使用 **%filename%** 并 **%extension%** 宏。</span><span class="sxs-lookup"><span data-stu-id="e81f4-194">Supports the use of all filename macros that can be used in the transport properties except for the **%Filename%** and **%Extension%** macros.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                |

   > [!NOTE]
   >  <span data-ttu-id="e81f4-195">为上下文属性提供的值是区分大小写。</span><span class="sxs-lookup"><span data-stu-id="e81f4-195">The values supplied for context properties are case sensitive.</span></span> <span data-ttu-id="e81f4-196">设置与上下文属性动态端口的配置值时请确保使用正确的大小写，否则 BizTalk 尝试将文档路由到指定发送端口时，将会出错。</span><span class="sxs-lookup"><span data-stu-id="e81f4-196">When setting configuration values for a dynamic port with context properties ensure that you use the proper case or an error will occur when BizTalk attempts to route the document to the designated send port.</span></span>  

3. <span data-ttu-id="e81f4-197">使用表达式形状在业务流程中设置**Microsoft.XLANGs.BaseTypes.Address**属性的动态发送端口。</span><span class="sxs-lookup"><span data-stu-id="e81f4-197">Use an expression shape in an orchestration to set the **Microsoft.XLANGs.BaseTypes.Address** property for the dynamic send port.</span></span> <span data-ttu-id="e81f4-198">此属性用于指定动态发送端口将路由到消息的 URI。</span><span class="sxs-lookup"><span data-stu-id="e81f4-198">This property is used to specify the URI that the dynamic send port routes the message to.</span></span> <span data-ttu-id="e81f4-199">有关如何设置的示例**Microsoft.XLANGs.BaseTypes.Address**请参阅动态发送端口的属性**创建一个表达式**主题的部分[演练：模块 3-从业务流程中访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="e81f4-199">For an example of how to set the **Microsoft.XLANGs.BaseTypes.Address** property for a dynamic send port see the **Create an expression** section of the topic [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="e81f4-200">有关 Windows Sharepoint Services 适配器上下文属性的详细信息请参阅[Windows SharePoint Services 适配器属性参考](../core/windows-sharepoint-services-adapter-properties-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="e81f4-200">For more information about the Windows Sharepoint Services adapter context properties see [Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md).</span></span>  

    <span data-ttu-id="e81f4-201">还有可能动态设置某些属性的后期绑定的 Windows Sharepoint Services 发送端口在业务流程中。</span><span class="sxs-lookup"><span data-stu-id="e81f4-201">It is also possible to dynamically set certain properties of a late bound Windows Sharepoint Services send port in an orchestration.</span></span> <span data-ttu-id="e81f4-202">如果执行此操作，一次一次通过 Windows SharePoint Services 上下文属性和 Windows SharePoint Services 传输属性对话框中，将两次，配置 Windows SharePoint Services 端口。</span><span class="sxs-lookup"><span data-stu-id="e81f4-202">If this is done, the Windows SharePoint Services port will be configured twice, once through the Windows SharePoint Services context properties and once through the Windows SharePoint Services Transport Properties dialog box.</span></span> <span data-ttu-id="e81f4-203">默认情况下，在 Windows SharePoint Services 传输属性对话框中指定的配置优先于上下文属性中指定的配置属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-203">By default, the configuration specified in the Windows SharePoint Services Transport Properties dialog box takes precedence over the configuration properties specified in the context properties.</span></span> <span data-ttu-id="e81f4-204">若要使用的上下文中指定的配置属性执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="e81f4-204">In order to use the configuration specified in the context properties follow these steps:</span></span>  

   1.  <span data-ttu-id="e81f4-205">若要创建静态单向发送端口，请按照本主题中的步骤[如何创建发送端口](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="e81f4-205">To create a Static One-way send port, follow the steps in the topic [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span>  

   2.  <span data-ttu-id="e81f4-206">设置发送端口属性时请输入相应的值来定义发送端口的 URI **Sharepoint 站点 URL**并**目标文件夹 URL**属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-206">When setting the properties for the send port, define the URI for the send port by entering the appropriate values for the **Sharepoint Site URL** and **Destination Folder URL** properties.</span></span>  

   3.  <span data-ttu-id="e81f4-207">设置的值**覆盖**属性设置为**业务流程**如果你想要使用定义的上下文属性的值**WSS。ConfigOverwrite**在业务流程中。</span><span class="sxs-lookup"><span data-stu-id="e81f4-207">Set the value of the **Overwrite** property to **Orchestration** if you want to use the value defined by the context property **WSS.ConfigOverwrite** in an orchestration.</span></span>  

   4.  <span data-ttu-id="e81f4-208">设置**Microsoft Office 集成**属性设置为**业务流程**如果你想要使用定义的上下文属性的值**WSS。ConfigOfficeIntegration**在业务流程中。</span><span class="sxs-lookup"><span data-stu-id="e81f4-208">Set the **Microsoft Office Integration** property to **Orchestration** if you want to use the value defined by the context property **WSS.ConfigOfficeIntegration** in an orchestration.</span></span>  

   5.  <span data-ttu-id="e81f4-209">输入的值为**为-1**的任何发送端口属性，如果你想要在业务流程中设置上下文属性的那些值，请使用整数数据类型。</span><span class="sxs-lookup"><span data-stu-id="e81f4-209">Enter a value of **-1** for any send port properties that use the integer data type if you want to set those values with a context property in an orchestration.</span></span>  

   6.  <span data-ttu-id="e81f4-210">将使用字符串数据类型，如果你想要在业务流程中设置上下文属性的那些值的任何发送端口属性留空。</span><span class="sxs-lookup"><span data-stu-id="e81f4-210">Leave blank any send port properties that use the string data type if you want to set those values with a context property in an orchestration.</span></span> <span data-ttu-id="e81f4-211">这不适用于**Sharepoint 站点 URL**并**目标文件夹 URL**属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-211">This does not apply to the **Sharepoint Site URL** and **Destination Folder URL** properties.</span></span> <span data-ttu-id="e81f4-212">这些属性必须指定**Windows Sharepoint Services 传输属性**对话框。</span><span class="sxs-lookup"><span data-stu-id="e81f4-212">These properties must be specified in the **Windows Sharepoint Services Transport Properties** dialog box.</span></span>  

   7.  <span data-ttu-id="e81f4-213">使用**消息赋值**形状内**构造消息**形状在业务流程来设置出站消息的配置属性中。</span><span class="sxs-lookup"><span data-stu-id="e81f4-213">Use a **Message Assignment** shape within a **Construct Message** shape in an orchestration to set the configuration properties for the outbound message.</span></span> <span data-ttu-id="e81f4-214">有关如何设置出站消息的配置属性的示例，请参阅[演练：模块 3-从业务流程中访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="e81f4-214">For an example of how to set the configuration properties for an outbound message see [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="e81f4-215">**构造新消息**本主题的部分说明了如何设置出站消息的配置属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-215">The **Construct a new message** section of this topic illustrates how to set configuration properties of an outbound message.</span></span>  

   8.  <span data-ttu-id="e81f4-216">任何发送端口属性配置值为-1 （适用于使用整数数据类型的属性），"业务流程"（下拉枚举属性） 或留在运行时将会为空 （适用于使用字符串数据类型的属性）在业务流程中指定的上下文属性。</span><span class="sxs-lookup"><span data-stu-id="e81f4-216">Any send port properties that are configured with a value of -1 (for properties that use the integer data type), "Orchestration" (for drop-down enumeration properties) or are left blank (for properties that use the string data type) will be set at run time with the context property that was specified in the orchestration.</span></span>  

   <span data-ttu-id="e81f4-217">如果使用的 Windows SharePoint Services 适配器接收具有嵌入附件的 InfoPath 窗体并发送到 SharePoint 文档库中的 InfoPath 窗体，完成以下步骤以保留中的任何 InfoPath 处理指令窗体：</span><span class="sxs-lookup"><span data-stu-id="e81f4-217">If you use the Windows SharePoint Services adapter to receive InfoPath forms with embedded attachments and then send the InfoPath forms to a SharePoint document library, complete the following steps to preserve any InfoPath processing instructions that are in the form:</span></span>  

### <a name="to-preserve-infopath-processing-instructions-for-infopath-forms-with-embedded-attachments-processed-by-biztalk-server"></a><span data-ttu-id="e81f4-218">若要保留具有 BizTalk Server 处理的嵌入附件的 InfoPath 窗体的 InfoPath 处理指令</span><span class="sxs-lookup"><span data-stu-id="e81f4-218">To preserve InfoPath processing instructions for InfoPath forms with embedded attachments processed by BizTalk Server</span></span>  

1.  <span data-ttu-id="e81f4-219">如果在业务流程中使用映射将映射到另一个 InfoPath 窗体从一个 InfoPath 表单数据，请确保您已设置了**复制处理指令 (Pi)** 属性映射到**是**。</span><span class="sxs-lookup"><span data-stu-id="e81f4-219">If you are using a map in the orchestration to map data from one InfoPath form to another InfoPath form, ensure that you have set the **Copy Processing Instructions (PIs)** property in the map to **Yes**.</span></span> <span data-ttu-id="e81f4-220">此参数设置下**自定义标头**一部分**网格属性**代码图的页。</span><span class="sxs-lookup"><span data-stu-id="e81f4-220">This parameter is set under the **Custom Header** section of the **Grid Properties** page for the map.</span></span>  

2.  <span data-ttu-id="e81f4-221">如果不在业务流程中使用映射，来更新输出消息在消息赋值形状中使用以下表达式：</span><span class="sxs-lookup"><span data-stu-id="e81f4-221">If you are not using a map in the orchestration, update the output message using the following expression in a message assignment shape:</span></span>  

    ```  
    NewMessage(XMLNORM.ProcessingInstructionOption) = 1;  
    NewMessage(XMLNORM.ProcessingInstruction) = "<?mso-infoPath-file-attachment-present?>"  
    ```  

     <span data-ttu-id="e81f4-222">在上面的表达式*NewMessage*是要添加到处理指令的输出消息。</span><span class="sxs-lookup"><span data-stu-id="e81f4-222">In the expression above, *NewMessage* is the output message that you are adding the processing instructions to.</span></span>  

## <a name="see-also"></a><span data-ttu-id="e81f4-223">请参阅</span><span class="sxs-lookup"><span data-stu-id="e81f4-223">See Also</span></span>  
 [<span data-ttu-id="e81f4-224">如何创建发送端口</span><span class="sxs-lookup"><span data-stu-id="e81f4-224">How to Create a Send Port</span></span>](../core/how-to-create-a-send-port2.md)