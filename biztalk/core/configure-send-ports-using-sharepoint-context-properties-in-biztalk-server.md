---
title: 如何配置发送端口使用 Windows Sharepoint Services 上下文属性 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Windows SharePoint Services adapters, InfoPath forms
- configuring [Windows SharePoint Services adapters], InfoPath forms
- Windows SharePoint Services adapters, Windows SharePoint Services
- InfoPath forms, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], Windows SharePoint Services
- Windows SharePoint Services adapters, send ports
- configuring [Windows SharePoint Services adapters], send ports
- send ports, Windows SharePoint Services adapters
- Windows SharePoint Services, Windows SharePoint Services adapters
ms.assetid: 1ff50fb8-7ba0-47b8-9476-d57413989346
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 54fed879058c43529eb4d0f62972eeaf88373de4
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65391448"
---
# <a name="how-to-configure-send-ports-using-windows-sharepoint-services-context-properties"></a>如何配置发送端口使用 Windows Sharepoint Services 上下文属性
本主题介绍如何使用 BizTalk 业务流程中的 Windows Sharepoint Services 上下文属性在运行时配置 Windows SharePoint Services 发送端口。 可以使用相同的机制来配置 Windows SharePoint Services 动态和后期绑定发送端口。 在运行时业务流程中设置动态发送端口的配置属性。 适配器属性中公开的**Windows SharePoint Services 传输属性**对话框还可以应用于动态或后期绑定的发送端口。 要设置配置属性为动态或后期绑定的发送端口使用 Windows Sharepoint Services 适配器上下文属性，请执行以下步骤：  

### <a name="to-set-configuration-properties-for-a-send-port-using-windows-sharepoint-services-adapter-context-properties"></a>若要设置使用 Windows Sharepoint Services 适配器上下文属性的发送端口的配置属性  

1. 对于动态发送端口，若要创建动态单向发送端口，请执行本主题中的步骤[如何创建发送端口](../core/how-to-create-a-send-port2.md)。  

2. 使用**消息赋值**形状内**构造消息**形状在业务流程来设置出站消息的配置属性中。 有关如何设置出站消息的配置属性的示例，请参阅[演练：模块 3-从业务流程中访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。 **构造新消息**本主题的部分说明了如何设置出站消息的配置属性。 将可以在中设置的属性相关联的适配器上下文属性**Windows SharePoint Services 传输属性**对话框下表中列出：  


   |         传输属性          |                                                  适配器上下文属性                                                   | 数据类型 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  注释                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |      适配器 Web 服务端口       |                                                   WSS.ConfigAdapterWSPort                                                   |    smallint    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    有效值为从 1 到 65535 之间<br /><br /> 默认值为 80                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |               超时               |                                                      WSS.ConfigTimeout                                                      |    smallint    |                                                                                                                                                                                                                                                                                                                                                                                                                             有效值为从 1000年到 2147483647 之间<br /><br /> 默认值为 100000<br /><br /> 指定的值为 0，表示无限超时。                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |       目标文件夹 URL        |                                                             不适用                                                              |    不适用     |                                                                                                                                                                                                                                                                                                                                                    对于动态端口，这间接通过设置设置**Microsoft.XLANGs.BaseTypes.Address**具有表达式形状在业务流程中的动态端口的属性。 因为它始终由物理重写不能在运行时设置此属性的后期绑定端口将发送端口值。                                                                                                                                                                                                                                                                                                                                                    |
   |              Filename               |                                                        WSS.Filename                                                         |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                               支持除传输属性中的所有文件名宏，可以在使用 **%filename%** 并 **%extension%** 宏。                                                                                                                                                                                                                                                                                                                                                                                                                                |
   |         命名空间别名          |                                                 WSS.ConfigNamespaceAliases                                                  |  String   | 如果消息在运行时设置完全的命名空间别名与为消息路由到发送端口设置的命名空间别名相匹配的命名空间将合并然后和发生路由错误。 若要避免此问题，请确保指定的命名空间别名不相同。 例如，如果下面的表达式用于业务流程中设置的命名空间别名一条消息：<br /><br /> `Message_Task(WSS.ConfigNamespaceAliases)= "orchns='http://OrderProcess.PurchaseOrder'";`<br /><br /> 如果此消息将路由到发送端口，指定以下值以查找**Namespace 别名**属性：<br /><br /> orchns =<http://OrderProcess.PurchaseOrder><br /><br /> 然后，BizTalk Server 尝试将消息路由到此发送端口时，将会出错。 若要解决此问题可以指定以下值以查找**Namespace 别名**发送端口的属性：<br /><br /> **orchns2**='<http://OrderProcess.PurchaseOrder>' |
   |              Overwrite              |                                                     WSS.ConfigOverwrite                                                     |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                                               有效值为<br /><br /> -"是 yes"<br /><br /> -"no"<br /><br /> -"重命名"                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |         SharePoint 站点 URL         |                                                        WSS.InListUrl                                                        |  String   |                                                                                                                                                                                                                                                                                                                                                    对于动态端口，这间接通过设置设置**Microsoft.XLANGs.BaseTypes.Address**具有表达式形状在业务流程中的动态端口的属性。 因为它始终由物理重写不能在运行时设置此属性的后期绑定端口将发送端口值。                                                                                                                                                                                                                                                                                                                                                    |
   |    Microsoft Office 集成     |                                                 WSS.ConfigOfficeIntegration                                                 |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                              有效值为<br /><br /> -"是 yes"<br /><br /> -"no"<br /><br /> -"yesformlibrary"<br /><br /> -"可选"                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |     模板文档库      |                                                  WSS.ConfigTemplatesDocLib                                                  |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   | 模板后备文档库 |                                               WSS.ConfigCustomTemplatesDocLib                                               |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   | 模板后备 Namespace 栏 |                                            WSS.ConfigCustomTemplatesNamespaceCol                                            |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |     模板 Namespace 列      |                                               WSS.ConfigTemplatesNamespaceCol                                               |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |             列 `n`              |    WSS.ConfigPropertiesXml<br /><br /> 在中设置列名称\<PropertyName*x*\>*columnname*\</ PropertyName*x* \>字段。    |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |          列`n`值           | WSS.ConfigPropertiesXml<br /><br /> 列的值设置\<PropertySource*x*\>*columnvalue*\</ PropertySource*x* \>字段。 |  String   |                                                                                                                                                                                                                                                                                                                                                                                                                               支持除传输属性中的所有文件名宏，可以在使用 **%filename%** 并 **%extension%** 宏。                                                                                                                                                                                                                                                                                                                                                                                                                                |

   > [!NOTE]
   >  为上下文属性提供的值是区分大小写。 设置与上下文属性动态端口的配置值时请确保使用正确的大小写，否则 BizTalk 尝试将文档路由到指定发送端口时，将会出错。  

3. 使用表达式形状在业务流程中设置**Microsoft.XLANGs.BaseTypes.Address**属性的动态发送端口。 此属性用于指定动态发送端口将路由到消息的 URI。 有关如何设置的示例**Microsoft.XLANGs.BaseTypes.Address**请参阅动态发送端口的属性**创建一个表达式**主题的部分[演练：模块 3-从业务流程中访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。 有关 Windows Sharepoint Services 适配器上下文属性的详细信息请参阅[Windows SharePoint Services 适配器属性参考](../core/windows-sharepoint-services-adapter-properties-reference.md)。  

    还有可能动态设置某些属性的后期绑定的 Windows Sharepoint Services 发送端口在业务流程中。 如果执行此操作，一次一次通过 Windows SharePoint Services 上下文属性和 Windows SharePoint Services 传输属性对话框中，将两次，配置 Windows SharePoint Services 端口。 默认情况下，在 Windows SharePoint Services 传输属性对话框中指定的配置优先于上下文属性中指定的配置属性。 若要使用的上下文中指定的配置属性执行以下步骤：  

   1.  若要创建静态单向发送端口，请按照本主题中的步骤[如何创建发送端口](../core/how-to-create-a-send-port2.md)。  

   2.  设置发送端口属性时请输入相应的值来定义发送端口的 URI **Sharepoint 站点 URL**并**目标文件夹 URL**属性。  

   3.  设置的值**覆盖**属性设置为**业务流程**如果你想要使用定义的上下文属性的值**WSS。ConfigOverwrite**在业务流程中。  

   4.  设置**Microsoft Office 集成**属性设置为**业务流程**如果你想要使用定义的上下文属性的值**WSS。ConfigOfficeIntegration**在业务流程中。  

   5.  输入的值为**为-1**的任何发送端口属性，如果你想要在业务流程中设置上下文属性的那些值，请使用整数数据类型。  

   6.  将使用字符串数据类型，如果你想要在业务流程中设置上下文属性的那些值的任何发送端口属性留空。 这不适用于**Sharepoint 站点 URL**并**目标文件夹 URL**属性。 这些属性必须指定**Windows Sharepoint Services 传输属性**对话框。  

   7.  使用**消息赋值**形状内**构造消息**形状在业务流程来设置出站消息的配置属性中。 有关如何设置出站消息的配置属性的示例，请参阅[演练：模块 3-从业务流程中访问 SharePoint 属性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。 **构造新消息**本主题的部分说明了如何设置出站消息的配置属性。  

   8.  任何发送端口属性配置值为-1 （适用于使用整数数据类型的属性），"业务流程"（下拉枚举属性） 或留在运行时将会为空 （适用于使用字符串数据类型的属性）在业务流程中指定的上下文属性。  

   如果使用的 Windows SharePoint Services 适配器接收具有嵌入附件的 InfoPath 窗体并发送到 SharePoint 文档库中的 InfoPath 窗体，完成以下步骤以保留中的任何 InfoPath 处理指令窗体：  

### <a name="to-preserve-infopath-processing-instructions-for-infopath-forms-with-embedded-attachments-processed-by-biztalk-server"></a>若要保留具有 BizTalk Server 处理的嵌入附件的 InfoPath 窗体的 InfoPath 处理指令  

1.  如果在业务流程中使用映射将映射到另一个 InfoPath 窗体从一个 InfoPath 表单数据，请确保您已设置了**复制处理指令 (Pi)** 属性映射到**是**。 此参数设置下**自定义标头**一部分**网格属性**代码图的页。  

2.  如果不在业务流程中使用映射，来更新输出消息在消息赋值形状中使用以下表达式：  

    ```  
    NewMessage(XMLNORM.ProcessingInstructionOption) = 1;  
    NewMessage(XMLNORM.ProcessingInstruction) = "<?mso-infoPath-file-attachment-present?>"  
    ```  

     在上面的表达式*NewMessage*是要添加到处理指令的输出消息。  

## <a name="see-also"></a>请参阅  
 [如何创建发送端口](../core/how-to-create-a-send-port2.md)