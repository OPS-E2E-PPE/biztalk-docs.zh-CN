---
title: "UpdateEx 方法 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: UpdateEx method
ms.assetid: 2fa9c9cc-fd01-4765-8c31-facac188a19d
caps.latest.revision: "5"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7a6a64c6709eb9806612518c551372ba45d1a454
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="updateex-method"></a><span data-ttu-id="caf03-102">UpdateEx 方法</span><span class="sxs-lookup"><span data-stu-id="caf03-102">UpdateEx Method</span></span>
<span data-ttu-id="caf03-103">用于更新属性基于输入的密钥参数 (key1、 key2，...</span><span class="sxs-lookup"><span data-stu-id="caf03-103">Used to update properties based on the input key parameters (key1, key2, …</span></span> <span data-ttu-id="caf03-104">keyn)。</span><span class="sxs-lookup"><span data-stu-id="caf03-104">keyn).</span></span> <span data-ttu-id="caf03-105">使用 `UpdateEx` 时，不能删除集合中的项目。</span><span class="sxs-lookup"><span data-stu-id="caf03-105">When using `UpdateEx`, you cannot delete items in a collection.</span></span> <span data-ttu-id="caf03-106">可使用单独方法进行删除。</span><span class="sxs-lookup"><span data-stu-id="caf03-106">A separate method facilitates deletion.</span></span> <span data-ttu-id="caf03-107">有关详细信息，请参阅[DeleteOnly 方法](../core/deleteonly-method.md)。</span><span class="sxs-lookup"><span data-stu-id="caf03-107">For more information, see [DeleteOnly Method](../core/deleteonly-method.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="caf03-108">语法</span><span class="sxs-lookup"><span data-stu-id="caf03-108">Syntax</span></span>  
  
```  
UpdateEx (key1, key2, ... keyn, correctionMode, interactiveMode,  
    properties)  
```  
  
## <a name="parameters"></a><span data-ttu-id="caf03-109">Parameters</span><span class="sxs-lookup"><span data-stu-id="caf03-109">Parameters</span></span>  
  
|<span data-ttu-id="caf03-110">参数</span><span class="sxs-lookup"><span data-stu-id="caf03-110">Parameter</span></span>|<span data-ttu-id="caf03-111">Description</span><span class="sxs-lookup"><span data-stu-id="caf03-111">Description</span></span>|  
|---------------|-----------------|  
|`key`|<span data-ttu-id="caf03-112">服务器数据库中必须存在的一组参数，或发生的错误。</span><span class="sxs-lookup"><span data-stu-id="caf03-112">A set of parameters that must exist in the server database, or an error occurs.</span></span> <span data-ttu-id="caf03-113">这些键对应于为特定组件接口定义的一组 Get 键。</span><span class="sxs-lookup"><span data-stu-id="caf03-113">These keys correspond to the set of Get Keys as defined for the particular component interface.</span></span>|  
|`correctionMode`|<span data-ttu-id="caf03-114">布尔型标志。</span><span class="sxs-lookup"><span data-stu-id="caf03-114">A Boolean flag.</span></span> <span data-ttu-id="caf03-115">设置为 true 时，可通过更新字段值或将新项插入集合来修改生效日期项的组件接口。</span><span class="sxs-lookup"><span data-stu-id="caf03-115">When set to true, allows modifications to component interfaces with effective-dated items either by updating the field values, or by inserting new items into a collection.</span></span> <span data-ttu-id="caf03-116">特别是，允许在当前生效日期之前修改具有 EFFDT 的项目。</span><span class="sxs-lookup"><span data-stu-id="caf03-116">Specifically, it allows modification to items that have EFFDT prior to the current effective date.</span></span> <span data-ttu-id="caf03-117">如果此标志未设置为 TRUE，则对这些项目的任何修改将导致从 PeopleSoft 服务器返回错误。</span><span class="sxs-lookup"><span data-stu-id="caf03-117">Without this flag set to TRUE, any modification to these items results in an error returned from PeopleSoft server.</span></span><br /><br /> <span data-ttu-id="caf03-118">仅对包含生效日期项的组件接口公开 `correctionMode` 参数。</span><span class="sxs-lookup"><span data-stu-id="caf03-118">The `correctionMode` argument is only exposed for those component interfaces that contain effective-dated items.</span></span> <span data-ttu-id="caf03-119">否则，不会作为参数的一部分显示。</span><span class="sxs-lookup"><span data-stu-id="caf03-119">Otherwise, it is not shown as part of the argument.</span></span><br /><br /> <span data-ttu-id="caf03-120">您应避免在生产环境中将 `correctionMode` 设置为 TRUE。</span><span class="sxs-lookup"><span data-stu-id="caf03-120">You should avoid setting `correctionMode` to TRUE in a production environment.</span></span> <span data-ttu-id="caf03-121">（这是也 PeopleSoft 的建议。）不应修改过去的 EFFDT 键确定已发生的事件。</span><span class="sxs-lookup"><span data-stu-id="caf03-121">(This is also the recommendation from PeopleSoft.) Events that have already occurred as determined by the past EFFDT key should not be modified.</span></span> <span data-ttu-id="caf03-122">允许创建审核记录。</span><span class="sxs-lookup"><span data-stu-id="caf03-122">This allows for the creation of an audit trail.</span></span> <span data-ttu-id="caf03-123">`UpdateEx` 中的 `correctionMode` 标志允许跳过此安全机制。</span><span class="sxs-lookup"><span data-stu-id="caf03-123">The `correctionMode` flag in `UpdateEx` allows this safety mechanism to be bypassed.</span></span> <span data-ttu-id="caf03-124">建议的做法是通过设置项目中的字段并添加（而不是删除）更新项目来停用过去的事件。</span><span class="sxs-lookup"><span data-stu-id="caf03-124">The recommended practice is for past events to be deactivated by setting a field in the item, and adding (instead of deleting) the updated item.</span></span>|  
|`interactiveMode`|<span data-ttu-id="caf03-125">用于错误处理的标志。</span><span class="sxs-lookup"><span data-stu-id="caf03-125">A flag used for error handling.</span></span><br /><br /> <span data-ttu-id="caf03-126">访问组件接口中的属性时，PeopleSoft Enterprise 的 BizTalk 适配器使用 PeopleSoft 提供的用于读写组件接口中各个字段的 API；但是，这些更改并不是逐一传播到 PeopleSoft 服务器的。</span><span class="sxs-lookup"><span data-stu-id="caf03-126">When accessing properties in a component interface, BizTalk Adapter for PeopleSoft Enterprise uses PeopleSoft-provided APIs that read and write individual fields in the component interface; however, these changes are not propagated to the PeopleSoft server one at a time.</span></span> <span data-ttu-id="caf03-127">psjoa.jar（与 PeopleSoft Enterprise 的 BizTalk 适配器交互）会将所有更改打包，然后将这些更改通过一个程序包发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="caf03-127">Instead, the psjoa.jar (with which BizTalk Adapter for PeopleSoft Enterprise interacts) packages all the changes and sends the changes to the server in one package.</span></span> <span data-ttu-id="caf03-128">如果各个更新中有任何一个失败，则会返回一般错误，但未指明确切问题。</span><span class="sxs-lookup"><span data-stu-id="caf03-128">If any of the individual updates fail, a generic error is returned, which does not pinpoint the actual error.</span></span> <span data-ttu-id="caf03-129">将交互模式设置为 TRUE 时，每个字段更新都会单独发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="caf03-129">With the interactive mode set to TRUE, every field update is sent to the server individually.</span></span> <span data-ttu-id="caf03-130">这样会对性能产生实质影响，但是在更新失败的情况下（例如，如果使用无效的值设置字段）会提供特定错误信息。</span><span class="sxs-lookup"><span data-stu-id="caf03-130">This has a substantial impact on performance, but it does provide specific error information if the update fails (for example, if an invalid value is used for setting a field).</span></span><br /><br /> <span data-ttu-id="caf03-131">`interactiveMode` 可提供最佳性能，并提供字段更新级别的错误报告。</span><span class="sxs-lookup"><span data-stu-id="caf03-131">The `interactiveMode` provides maximum performance and provides error reporting at the field update level.</span></span> <span data-ttu-id="caf03-132">要正确使用此功能，建议您将 `interactiveMode` 设置为 FALSE 来进行常规调用。</span><span class="sxs-lookup"><span data-stu-id="caf03-132">To use this feature properly, it is recommended that you make normal calls with `interactiveMode` set to FALSE.</span></span> <span data-ttu-id="caf03-133">这应该不会对性能带来影响。</span><span class="sxs-lookup"><span data-stu-id="caf03-133">There should be no impact on performance.</span></span> <span data-ttu-id="caf03-134">如果返回错误，则可以将 `interactiveMode` 标志设置为 TRUE 来重试同一调用。</span><span class="sxs-lookup"><span data-stu-id="caf03-134">If an error is returned, the same call can be retried with the `interactiveMode` flag set to TRUE.</span></span> <span data-ttu-id="caf03-135">调用失败时，服务器将返回更准确的错误消息。</span><span class="sxs-lookup"><span data-stu-id="caf03-135">When the call fails, the server returns a more precise error message.</span></span>|  
  
### <a name="remarks"></a><span data-ttu-id="caf03-136">注释</span><span class="sxs-lookup"><span data-stu-id="caf03-136">Remarks</span></span>  
 <span data-ttu-id="caf03-137">调用此函数时，将使用输入参数属性替换与这些键相对应的记录的属性。</span><span class="sxs-lookup"><span data-stu-id="caf03-137">When you call this function, the properties of the record corresponding to the keys are replaced by the input parameter properties.</span></span> <span data-ttu-id="caf03-138">将删除原始记录的所有集合，并替换为输入参数中的集合。</span><span class="sxs-lookup"><span data-stu-id="caf03-138">All collections with the original records are deleted and replaced by those in the input parameter.</span></span> <span data-ttu-id="caf03-139">这些集合的大小无需匹配，因为 `UpdateEx` 中的过程将删除所有现有集合项目，然后插入指定项目。</span><span class="sxs-lookup"><span data-stu-id="caf03-139">The sizes of these collections do not have to matchbecause the procedure within `UpdateEx` is to delete all existing collection items and then insert the given ones.</span></span>  
  
 <span data-ttu-id="caf03-140">如果组件接口的属性包含生效日期项目，则属性参数必须包含所有未来的生效日期项目，因为原始列表已被替换。</span><span class="sxs-lookup"><span data-stu-id="caf03-140">If the properties of the component interface contain effective dated items, the properties parameter must contain all future effective-dated items because the original list is replaced.</span></span> <span data-ttu-id="caf03-141">这提供了添加和删除未来的生效日期项目的机制；但是，如果属性还包含过去的生效日期项目，则会因为无法修改过去的生效日期项目而返回错误。</span><span class="sxs-lookup"><span data-stu-id="caf03-141">This provides the mechanism for adding and deleting future effective-dated items; however, if the properties also contain past effective-dated items, an error is returned because past effective-dated items cannot be modified.</span></span> <span data-ttu-id="caf03-142">如果还包含当前的生效日期项目，则将忽略该项目。</span><span class="sxs-lookup"><span data-stu-id="caf03-142">If the current effective-dated item is also included, it is ignored.</span></span> <span data-ttu-id="caf03-143">这允许客户端调用`Get()`与`getHistoryItems`参数设置为 False，和修改任何将来的有效日期项或添加新将来生效日期的项目，以及将作为参数传递结构中`UpdateEx()`函数。</span><span class="sxs-lookup"><span data-stu-id="caf03-143">This permits the client to call `Get()` with the `getHistoryItems` parameter set to False, and modify any future effective-dated items or add new future effective-dated items, and pass in the structure as parameter for the `UpdateEx()` function.</span></span>  
  
 <span data-ttu-id="caf03-144">如果组件接口没有任何键，这种情况下只存在一个实例，则 `UpdateEx()` 方法的格式如下：</span><span class="sxs-lookup"><span data-stu-id="caf03-144">If the component interface does not have a key, as in the case where only one instance can exist, the `UpdateEx()` method has the form:</span></span>  
  
```  
UpdateEx(correctionMode, interactiveMode, properties)  
```  
  
> [!NOTE]
>  <span data-ttu-id="caf03-145">如果启用了组件接口中的 PeopleSoft `UpdateEx()` 和 `Get` 函数，则将提供 PeopleSoft Enterprise 的 BizTalk 适配器的 `Save` 方法。</span><span class="sxs-lookup"><span data-stu-id="caf03-145">The BizTalk Adapter for PeopleSoft Enterprise `UpdateEx()` method is provided if the PeopleSoft `Get` and `Save` functions in the component interface are enabled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="caf03-146">另请参阅</span><span class="sxs-lookup"><span data-stu-id="caf03-146">See Also</span></span>  
 [<span data-ttu-id="caf03-147">附录 a： 组件接口方法</span><span class="sxs-lookup"><span data-stu-id="caf03-147">Appendix A: Component Interface Methods</span></span>](../core/appendix-a-component-interface-methods.md)