---
title: UpdateEx 方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- UpdateEx method
ms.assetid: 2fa9c9cc-fd01-4765-8c31-facac188a19d
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5ac317a9c91f13dce2dadf74b3027ebf4d33390f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65398630"
---
# <a name="updateex-method"></a><span data-ttu-id="d814e-102">UpdateEx 方法</span><span class="sxs-lookup"><span data-stu-id="d814e-102">UpdateEx Method</span></span>
<span data-ttu-id="d814e-103">用于更新属性基于输入键参数 (key1、 key2，...</span><span class="sxs-lookup"><span data-stu-id="d814e-103">Used to update properties based on the input key parameters (key1, key2, …</span></span> <span data-ttu-id="d814e-104">keyn)。</span><span class="sxs-lookup"><span data-stu-id="d814e-104">keyn).</span></span> <span data-ttu-id="d814e-105">当使用`UpdateEx`，不能删除集合中的项。</span><span class="sxs-lookup"><span data-stu-id="d814e-105">When using `UpdateEx`, you cannot delete items in a collection.</span></span> <span data-ttu-id="d814e-106">一个单独的方法进行删除。</span><span class="sxs-lookup"><span data-stu-id="d814e-106">A separate method facilitates deletion.</span></span> <span data-ttu-id="d814e-107">有关详细信息，请参阅[DeleteOnly 方法](../core/deleteonly-method.md)。</span><span class="sxs-lookup"><span data-stu-id="d814e-107">For more information, see [DeleteOnly Method](../core/deleteonly-method.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="d814e-108">语法</span><span class="sxs-lookup"><span data-stu-id="d814e-108">Syntax</span></span>  
  
```  
UpdateEx (key1, key2, ... keyn, correctionMode, interactiveMode,  
    properties)  
```  
  
## <a name="parameters"></a><span data-ttu-id="d814e-109">Parameters</span><span class="sxs-lookup"><span data-stu-id="d814e-109">Parameters</span></span>  
  
|<span data-ttu-id="d814e-110">参数</span><span class="sxs-lookup"><span data-stu-id="d814e-110">Parameter</span></span>|<span data-ttu-id="d814e-111">Description</span><span class="sxs-lookup"><span data-stu-id="d814e-111">Description</span></span>|  
|---------------|-----------------|  
|`key`|<span data-ttu-id="d814e-112">将出现一组必须存在于服务器数据库或错误的参数。</span><span class="sxs-lookup"><span data-stu-id="d814e-112">A set of parameters that must exist in the server database, or an error occurs.</span></span> <span data-ttu-id="d814e-113">为特定组件接口定义，这些项对应于 Get 关键字组。</span><span class="sxs-lookup"><span data-stu-id="d814e-113">These keys correspond to the set of Get Keys as defined for the particular component interface.</span></span>|  
|`correctionMode`|<span data-ttu-id="d814e-114">一个布尔型标志。</span><span class="sxs-lookup"><span data-stu-id="d814e-114">A Boolean flag.</span></span> <span data-ttu-id="d814e-115">何时设置为 true，允许修改的组件接口的有效日期项，方法是更新的字段值，或将新项插入到集合。</span><span class="sxs-lookup"><span data-stu-id="d814e-115">When set to true, allows modifications to component interfaces with effective-dated items either by updating the field values, or by inserting new items into a collection.</span></span> <span data-ttu-id="d814e-116">具体而言，它允许在当前的生效日期之前具有 EFFDT 的项目的修改。</span><span class="sxs-lookup"><span data-stu-id="d814e-116">Specifically, it allows modification to items that have EFFDT prior to the current effective date.</span></span> <span data-ttu-id="d814e-117">如果没有此标志设置为 TRUE，对这些项的任何修改会导致从 PeopleSoft 服务器返回错误。</span><span class="sxs-lookup"><span data-stu-id="d814e-117">Without this flag set to TRUE, any modification to these items results in an error returned from PeopleSoft server.</span></span><br /><br /> <span data-ttu-id="d814e-118">`correctionMode`参数仅公开为这些组件接口，即包含有效日期项。</span><span class="sxs-lookup"><span data-stu-id="d814e-118">The `correctionMode` argument is only exposed for those component interfaces that contain effective-dated items.</span></span> <span data-ttu-id="d814e-119">否则，它不会显示作为参数的一部分。</span><span class="sxs-lookup"><span data-stu-id="d814e-119">Otherwise, it is not shown as part of the argument.</span></span><br /><br /> <span data-ttu-id="d814e-120">应避免设置`correctionMode`到生产环境中，则返回 TRUE。</span><span class="sxs-lookup"><span data-stu-id="d814e-120">You should avoid setting `correctionMode` to TRUE in a production environment.</span></span> <span data-ttu-id="d814e-121">（这是也 PeopleSoft 的建议。）不应修改过去的 EFFDT 键确定已发生的事件。</span><span class="sxs-lookup"><span data-stu-id="d814e-121">(This is also the recommendation from PeopleSoft.) Events that have already occurred as determined by the past EFFDT key should not be modified.</span></span> <span data-ttu-id="d814e-122">这允许创建审核线索。</span><span class="sxs-lookup"><span data-stu-id="d814e-122">This allows for the creation of an audit trail.</span></span> <span data-ttu-id="d814e-123">`correctionMode`标记中`UpdateEx`允许绕过此安全机制。</span><span class="sxs-lookup"><span data-stu-id="d814e-123">The `correctionMode` flag in `UpdateEx` allows this safety mechanism to be bypassed.</span></span> <span data-ttu-id="d814e-124">建议的做法是过去的事件将通过在项目中，设置一个字段并添加 （而不删除） 停用更新后的项目。</span><span class="sxs-lookup"><span data-stu-id="d814e-124">The recommended practice is for past events to be deactivated by setting a field in the item, and adding (instead of deleting) the updated item.</span></span>|  
|`interactiveMode`|<span data-ttu-id="d814e-125">一个标志，用于错误处理。</span><span class="sxs-lookup"><span data-stu-id="d814e-125">A flag used for error handling.</span></span><br /><br /> <span data-ttu-id="d814e-126">访问组件接口中的属性时，适用于 PeopleSoft Enterprise 的 BizTalk 适配器使用 PeopleSoft 提供的 Api 的读取和写入组件接口; 中的各个字段但是，这些更改将不会传播到 PeopleSoft 服务器一次。</span><span class="sxs-lookup"><span data-stu-id="d814e-126">When accessing properties in a component interface, BizTalk Adapter for PeopleSoft Enterprise uses PeopleSoft-provided APIs that read and write individual fields in the component interface; however, these changes are not propagated to the PeopleSoft server one at a time.</span></span> <span data-ttu-id="d814e-127">相反，psjoa.jar （与用于 PeopleSoft Enterprise 的 BizTalk 适配器进行交互） 包的所有更改，并将所做的更改发送到一个包中的服务器。</span><span class="sxs-lookup"><span data-stu-id="d814e-127">Instead, the psjoa.jar (with which BizTalk Adapter for PeopleSoft Enterprise interacts) packages all the changes and sends the changes to the server in one package.</span></span> <span data-ttu-id="d814e-128">如果任何单个更新失败，一般会返回错误，这不会不找出实际的错误。</span><span class="sxs-lookup"><span data-stu-id="d814e-128">If any of the individual updates fail, a generic error is returned, which does not pinpoint the actual error.</span></span> <span data-ttu-id="d814e-129">将交互模式设置为 TRUE 时，每个字段更新为发送到服务器单独。</span><span class="sxs-lookup"><span data-stu-id="d814e-129">With the interactive mode set to TRUE, every field update is sent to the server individually.</span></span> <span data-ttu-id="d814e-130">这对性能，有重大影响，但如果更新失败 （例如，如果无效的值用于设置的字段） 提供特定错误的信息。</span><span class="sxs-lookup"><span data-stu-id="d814e-130">This has a substantial impact on performance, but it does provide specific error information if the update fails (for example, if an invalid value is used for setting a field).</span></span><br /><br /> <span data-ttu-id="d814e-131">`interactiveMode`提供最大性能，并提供错误报告字段更新级别。</span><span class="sxs-lookup"><span data-stu-id="d814e-131">The `interactiveMode` provides maximum performance and provides error reporting at the field update level.</span></span> <span data-ttu-id="d814e-132">若要正确使用此功能，建议进行常规调用`interactiveMode`设置为 FALSE。</span><span class="sxs-lookup"><span data-stu-id="d814e-132">To use this feature properly, it is recommended that you make normal calls with `interactiveMode` set to FALSE.</span></span> <span data-ttu-id="d814e-133">在性能上应该有任何影响。</span><span class="sxs-lookup"><span data-stu-id="d814e-133">There should be no impact on performance.</span></span> <span data-ttu-id="d814e-134">如果返回错误，则使用，可以重试同一调用`interactiveMode`标志设置为 TRUE。</span><span class="sxs-lookup"><span data-stu-id="d814e-134">If an error is returned, the same call can be retried with the `interactiveMode` flag set to TRUE.</span></span> <span data-ttu-id="d814e-135">当调用失败时，服务器将返回更精确的错误消息。</span><span class="sxs-lookup"><span data-stu-id="d814e-135">When the call fails, the server returns a more precise error message.</span></span>|  
  
### <a name="remarks"></a><span data-ttu-id="d814e-136">备注</span><span class="sxs-lookup"><span data-stu-id="d814e-136">Remarks</span></span>  
 <span data-ttu-id="d814e-137">当调用此函数时，密钥相对应的记录的属性替换为输入的参数属性。</span><span class="sxs-lookup"><span data-stu-id="d814e-137">When you call this function, the properties of the record corresponding to the keys are replaced by the input parameter properties.</span></span> <span data-ttu-id="d814e-138">与原始记录的所有集合中删除，并替换为输入参数中。</span><span class="sxs-lookup"><span data-stu-id="d814e-138">All collections with the original records are deleted and replaced by those in the input parameter.</span></span> <span data-ttu-id="d814e-139">这些集合的大小不具有匹配，因为中的过程`UpdateEx`是删除所有现有集合项目，然后插入指定的项目。</span><span class="sxs-lookup"><span data-stu-id="d814e-139">The sizes of these collections do not have to matchbecause the procedure within `UpdateEx` is to delete all existing collection items and then insert the given ones.</span></span>  
  
 <span data-ttu-id="d814e-140">如果组件接口的属性包含生效日期的项目，则属性参数必须包含所有将来的有效日期项，因为原始列表已被替换。</span><span class="sxs-lookup"><span data-stu-id="d814e-140">If the properties of the component interface contain effective dated items, the properties parameter must contain all future effective-dated items because the original list is replaced.</span></span> <span data-ttu-id="d814e-141">这提供了机制，用于添加和删除未来的生效日期项目;但是，如果属性还包含过去的生效日期项目，被返回错误因为过去的生效日期的项不能进行修改。</span><span class="sxs-lookup"><span data-stu-id="d814e-141">This provides the mechanism for adding and deleting future effective-dated items; however, if the properties also contain past effective-dated items, an error is returned because past effective-dated items cannot be modified.</span></span> <span data-ttu-id="d814e-142">如果还包括当前有效日期项，则将忽略它。</span><span class="sxs-lookup"><span data-stu-id="d814e-142">If the current effective-dated item is also included, it is ignored.</span></span> <span data-ttu-id="d814e-143">这允许客户端调用`Get()`与`getHistoryItems`参数设置为 False，并修改任何未来生效日期项目或添加新未来生效日期项目，并将作为参数传递的结构中`UpdateEx()`函数。</span><span class="sxs-lookup"><span data-stu-id="d814e-143">This permits the client to call `Get()` with the `getHistoryItems` parameter set to False, and modify any future effective-dated items or add new future effective-dated items, and pass in the structure as parameter for the `UpdateEx()` function.</span></span>  
  
 <span data-ttu-id="d814e-144">如果组件接口没有键，其中可存在一个实例，如`UpdateEx()`方法采用以下格式：</span><span class="sxs-lookup"><span data-stu-id="d814e-144">If the component interface does not have a key, as in the case where only one instance can exist, the `UpdateEx()` method has the form:</span></span>  
  
```  
UpdateEx(correctionMode, interactiveMode, properties)  
```  
  
> [!NOTE]
>  <span data-ttu-id="d814e-145">用于 PeopleSoft Enterprise 的 BizTalk 适配器`UpdateEx()`方法提供如果 PeopleSoft`Get`和`Save`启用组件接口中的函数。</span><span class="sxs-lookup"><span data-stu-id="d814e-145">The BizTalk Adapter for PeopleSoft Enterprise `UpdateEx()` method is provided if the PeopleSoft `Get` and `Save` functions in the component interface are enabled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d814e-146">请参阅</span><span class="sxs-lookup"><span data-stu-id="d814e-146">See Also</span></span>  
 [<span data-ttu-id="d814e-147">附录 a:组件接口方法</span><span class="sxs-lookup"><span data-stu-id="d814e-147">Appendix A: Component Interface Methods</span></span>](../core/appendix-a-component-interface-methods.md)