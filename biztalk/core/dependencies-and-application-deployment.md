---
title: 依赖项和应用程序部署 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- deploying [applications], dependencies
- assemblies, dependencies
- artifacts, dependencies
- applications, dependencies
ms.assetid: b78c5a0d-b042-4862-bce7-59469365b369
caps.latest.revision: 20
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1b2111891b79dd343c121746db7f9959c92464df
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65389663"
---
# <a name="dependencies-and-application-deployment"></a><span data-ttu-id="c600e-102">依赖项和应用程序部署</span><span class="sxs-lookup"><span data-stu-id="c600e-102">Dependencies and Application Deployment</span></span>
<span data-ttu-id="c600e-103">本主题介绍如何在两个或多个 BizTalk 应用程序中的项目之间的依赖关系会影响应用程序部署和维护。</span><span class="sxs-lookup"><span data-stu-id="c600e-103">This topic describes how dependencies between artifacts in two or more BizTalk applications affect application deployment and maintenance.</span></span>  
  
 <span data-ttu-id="c600e-104">当一个项目需要使用另一个项目才能正常运行时，就说要*依赖*于其他项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-104">When one artifact needs to use another artifact in order to function properly, it is said to be *dependent* on another artifact.</span></span> <span data-ttu-id="c600e-105">此依赖关系的一个示例是当业务流程需要使用特定架构进行消息解析或特定管道以便正确传输消息时。</span><span class="sxs-lookup"><span data-stu-id="c600e-105">An example of such a dependency is when an orchestration needs to use a specific schema for message resolution or a specific pipeline in order to transmit messages correctly.</span></span> <span data-ttu-id="c600e-106">在这两个方案，该业务流程是依赖于其他项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-106">In both of these scenarios, the orchestration is dependent on another artifact.</span></span>  
  
 <span data-ttu-id="c600e-107">可以更新应用程序中的某个项目之前，您必须先取消部署它，以及依赖于它的所有项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-107">Before you can update an artifact in an application, you must first undeploy it, along with any artifacts that depend on it.</span></span> <span data-ttu-id="c600e-108">项目的依赖关系存在于同一应用程序中，BizTalk Server 将自动处理更新和依赖的项目取消部署和重新部署任务。</span><span class="sxs-lookup"><span data-stu-id="c600e-108">When artifacts that have dependencies exist in the same application, BizTalk Server automatically handles the undeployment and redeployment tasks for the updated and dependent artifacts.</span></span> <span data-ttu-id="c600e-109">当项目的依赖关系存在于不同的应用程序中时，但是，这不是种。</span><span class="sxs-lookup"><span data-stu-id="c600e-109">When artifacts that have dependencies exist in different applications, however, this is not the case.</span></span> <span data-ttu-id="c600e-110">必须执行手动步骤来取消部署具有依赖项，然后才能更新所依赖的项目的项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-110">You must take manual steps to undeploy the artifacts that have the dependencies before you can update an artifact on which they depend.</span></span> <span data-ttu-id="c600e-111">之后，你必须手动重新部署依存项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-111">Afterwards, you must manually redeploy the dependent artifacts.</span></span>  
  
 <span data-ttu-id="c600e-112">若要无需执行这些手动步骤，当你想要更新某个项目上的其他项目所依赖，您可以尝试在同一应用程序将依赖项的所有项目放在一起。</span><span class="sxs-lookup"><span data-stu-id="c600e-112">To avoid the need to take these manual steps when you want to update an artifact on which other artifacts depend, you can attempt to keep all artifacts with dependencies together in the same application.</span></span> <span data-ttu-id="c600e-113">这并不总是有可能，但是。</span><span class="sxs-lookup"><span data-stu-id="c600e-113">This is not always possible, however.</span></span> <span data-ttu-id="c600e-114">如中所述[项目，必须是唯一的应用程序或组](../core/artifacts-that-must-be-unique-in-an-application-or-group.md)，大多数类型的项目必须是 BizTalk 组中唯一。</span><span class="sxs-lookup"><span data-stu-id="c600e-114">As described in [Artifacts That Must Be Unique in an Application or Group](../core/artifacts-that-must-be-unique-in-an-application-or-group.md), most types of artifacts must be unique in a BizTalk group.</span></span> <span data-ttu-id="c600e-115">不能在同一组中的两个不同应用程序中具有相同的项目，即使这两个应用程序包含依赖于相同的项目的项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-115">You cannot have the same artifact in two different applications in the same group, even if both applications contain artifacts that depend on the same artifact.</span></span>  
  
 <span data-ttu-id="c600e-116">在此情况下，您可以将所需的项目添加到一个应用程序，然后添加对该应用程序中包含的项目的依赖于它的任何其他应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="c600e-116">When this happens, you can add the needed artifact to one application and then add a reference to that application from any other applications containing artifacts that depend on it.</span></span> <span data-ttu-id="c600e-117">时添加到应用程序的引用，请在应用程序中的项目可以使用它所引用的应用程序中的所有项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-117">When you add a reference to an application, artifacts in the application can use any artifacts in the application that it references.</span></span> <span data-ttu-id="c600e-118">有关添加引用的说明，请参阅[如何添加对另一个应用程序的引用](../core/how-to-add-a-reference-to-another-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-118">For instructions on adding a reference, see [How to Add a Reference to Another Application](../core/how-to-add-a-reference-to-another-application.md).</span></span>  
  
 <span data-ttu-id="c600e-119">下图描绘了两个应用程序的每个依赖于第三个应用程序中的项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-119">The following diagram depicts two applications that each depend on artifacts in a third application.</span></span> <span data-ttu-id="c600e-120">订单处理应用程序使用 Schema1，而它包含在架构应用程序，因此 Order Processing 应用程序包含对架构应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="c600e-120">The Order Processing application uses Schema1, which is contained in the Schemas application, so the Order Processing application contains a reference to the Schemas application.</span></span> <span data-ttu-id="c600e-121">抵押应用程序使用 Schema2，它也会包含在架构应用程序，并同样以前的应用程序包含对后者的引用。</span><span class="sxs-lookup"><span data-stu-id="c600e-121">The Mortgage application uses Schema2, which is also contained in the Schemas application, and likewise the former application contains a reference to the latter.</span></span>  
  
 <span data-ttu-id="c600e-122">![两个应用程序引用第三个应用程序](../core/media/applicationdependencies.gif "ApplicationDependencies")</span><span class="sxs-lookup"><span data-stu-id="c600e-122">![Two applications reference a third application](../core/media/applicationdependencies.gif "ApplicationDependencies")</span></span>  
  
 <span data-ttu-id="c600e-123">添加到另一个应用程序的引用创建会影响部署和管理这两个应用程序的方式在两个应用程序之间的依赖项。</span><span class="sxs-lookup"><span data-stu-id="c600e-123">Adding a reference from one application to another creates a dependency between the two applications that affects how you deploy and manage both applications.</span></span> <span data-ttu-id="c600e-124">由于本主题后面所述的应用程序依赖关系的不同效果，我们建议你遵循有关将项目添加到应用程序的最佳实践，如中所述[部署 BizTalk 应用程序最佳做法](../core/best-practices-for-deploying-a-biztalk-application.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-124">Because of the various effects of application dependencies described later in this topic, we recommend that you follow the best practices for adding artifacts to application, as described in [Best Practices for Deploying a BizTalk Application](../core/best-practices-for-deploying-a-biztalk-application.md).</span></span>  
  
 <span data-ttu-id="c600e-125">下图说明了在更新的程序集的依赖关系链，并且取决于正在更新的程序集的所有程序集存在于同一应用程序时所涉及的步骤。</span><span class="sxs-lookup"><span data-stu-id="c600e-125">The following diagram illustrates the steps involved in updating an assembly when there is a chain of dependency, and all assemblies that depend on the assembly being updated exist in the same application.</span></span>  
  
 <span data-ttu-id="c600e-126">![更新的程序集具有依赖项](../core/media/simpleadminredeploy.gif "SimpleAdminRedeploy")</span><span class="sxs-lookup"><span data-stu-id="c600e-126">![Updating an assembly with dependencies](../core/media/simpleadminredeploy.gif "SimpleAdminRedeploy")</span></span>  
  
 <span data-ttu-id="c600e-127">下图说明了在更新的程序集的被更新的程序集上的依赖关系链时所涉及的步骤和某个依赖程序集存在于不同的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c600e-127">The following diagram illustrates the steps involved in updating an assembly when there is a chain of dependencies on the assembly being updated, and one of the dependent assemblies exists in a different application.</span></span>  
  
 <span data-ttu-id="c600e-128">![更新具有外部依赖项的程序集](../core/media/complexadminredeploy.gif "ComplexAdminRedeploy")</span><span class="sxs-lookup"><span data-stu-id="c600e-128">![Updating an assembly with external dependencies](../core/media/complexadminredeploy.gif "ComplexAdminRedeploy")</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c600e-129">若要更新的程序集是自动执行此操作之前执行完全停止的原因取消登记业务流程，并停止并终止所有消息。</span><span class="sxs-lookup"><span data-stu-id="c600e-129">The reason to perform a full stop before updating an assembly is that doing this automatically unenlists the orchestration, and stops and terminates all messages.</span></span> <span data-ttu-id="c600e-130">如果需要继续处理消息，你可以部署同一程序集的不同版本，从而避免停止和终止消息的需要。</span><span class="sxs-lookup"><span data-stu-id="c600e-130">If you need to continue processing messages, you can deploy a different version of the same assembly and thereby avoid the need to stop and terminate messages.</span></span> <span data-ttu-id="c600e-131">有关详细信息，请参阅[更新 BizTalk 应用程序](../core/updating-biztalk-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-131">For more information, see [Updating BizTalk Applications](../core/updating-biztalk-applications.md).</span></span>  
  
 <span data-ttu-id="c600e-132">应用程序之间的依赖关系，可能会导致以下影响：</span><span class="sxs-lookup"><span data-stu-id="c600e-132">The following effects may result from dependencies between applications:</span></span>  
  
-   <span data-ttu-id="c600e-133">**停止某一项目。**</span><span class="sxs-lookup"><span data-stu-id="c600e-133">**Stopping an artifact.**</span></span> <span data-ttu-id="c600e-134">如果您停止一个应用程序 （这可能导致停止整个应用程序） 中的项目取决于其他应用程序，将从属应用程序将无法正常工作。</span><span class="sxs-lookup"><span data-stu-id="c600e-134">If you stop an artifact in one application (which may result from stopping the entire application) that another application depends on, the dependent application will not function correctly.</span></span> <span data-ttu-id="c600e-135">有关停止应用程序的详细信息，请参阅[如何启动和停止 BizTalk 应用程序](../core/how-to-start-and-stop-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-135">For more information about stopping an application, see [How to Start and Stop a BizTalk Application](../core/how-to-start-and-stop-a-biztalk-application.md).</span></span>  
  
-   <span data-ttu-id="c600e-136">**删除或更改项目的状态。**</span><span class="sxs-lookup"><span data-stu-id="c600e-136">**Removing or changing the state of an artifact.**</span></span> <span data-ttu-id="c600e-137">如果您添加从应用程序的不同而不同的引用，对项目的另一个应用程序依赖于或删除该项目的状态进行任何更改具有依存关系的应用程序将无法正常工作。</span><span class="sxs-lookup"><span data-stu-id="c600e-137">When you add a reference from one application to another and make any changes to the state of an artifact on which another application depends or remove the artifact, the application that has the dependency will not function correctly.</span></span> <span data-ttu-id="c600e-138">有关更改项目的状态的详细信息，请参阅部分中针对相应项目中[管理项目](../core/managing-artifacts.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-138">For more information about changing the state of an artifact, see the section on the appropriate artifact in [Managing Artifacts](../core/managing-artifacts.md).</span></span>  
  
-   <span data-ttu-id="c600e-139">**导入具有依存关系的应用程序。**</span><span class="sxs-lookup"><span data-stu-id="c600e-139">**Importing applications that have dependencies.**</span></span> <span data-ttu-id="c600e-140">如果你想要将应用程序导入不同的 BizTalk 组并在该组中运行它，您还必须导入此应用程序所依赖的所有项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-140">If you want to import an application into a different BizTalk group and run it in that group, you must also import any artifacts on which this application depends.</span></span> <span data-ttu-id="c600e-141">通过首先导入到其他应用程序或通过将所需的项目添加到需要它的应用程序时，可以执行此操作。</span><span class="sxs-lookup"><span data-stu-id="c600e-141">You can do this by first importing the other application or by adding the needed artifact to the application that requires it.</span></span> <span data-ttu-id="c600e-142">有关导入应用程序的详细信息，请参阅[导入 BizTalk 应用程序的方式](../core/how-to-import-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-142">For more information about importing applications, see [How to Import a BizTalk Application](../core/how-to-import-a-biztalk-application.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="c600e-143">BizTalk Server 进行匹配的源和目标 BizTalk 组中的应用程序名称来验证应用程序的标识。</span><span class="sxs-lookup"><span data-stu-id="c600e-143">BizTalk Server verifies the identity of an application by matching the application names in the source and the destination BizTalk group.</span></span> <span data-ttu-id="c600e-144">它不会验证你的应用程序在其具有依赖关系的项目会包括在其中。</span><span class="sxs-lookup"><span data-stu-id="c600e-144">It does not verify that the artifacts on which your application has dependencies are included in it.</span></span> <span data-ttu-id="c600e-145">导入具有依存关系的应用程序和它所引用的应用程序时，我们建议你验证引用的应用程序包含所需的项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-145">When you import an application that has dependencies and the application to which it refers, we recommend that you verify that the referenced application contains the required artifact or artifacts.</span></span>  
  
-   <span data-ttu-id="c600e-146">**导入具有引用的应用程序。**</span><span class="sxs-lookup"><span data-stu-id="c600e-146">**Importing applications that have references.**</span></span> <span data-ttu-id="c600e-147">如果您要导入的应用程序依赖于另一个应用程序中的某个项目，您需要添加对此应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="c600e-147">If an application you are importing depends on an artifact in another application, you need to add a reference to this application.</span></span> <span data-ttu-id="c600e-148">导入向导提供了此选项。</span><span class="sxs-lookup"><span data-stu-id="c600e-148">The Import Wizard provides this option.</span></span> <span data-ttu-id="c600e-149">如果使用 BTSTask 的 ImportApp 命令，但是，您必须添加对导入之后，应用程序的引用中所述[如何添加对另一个应用程序的引用](../core/how-to-add-a-reference-to-another-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-149">If you are using the ImportApp command of BTSTask, however, you must add the reference to the application after import, as described in [How to Add a Reference to Another Application](../core/how-to-add-a-reference-to-another-application.md).</span></span> <span data-ttu-id="c600e-150">虽然 BizTalk Server 验证引用的应用程序存在，我们建议您采取额外的步骤来验证引用的应用程序包含所需的项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-150">While BizTalk Server verifies that the referenced application exists, we recommend that you take the additional step of verifying that the referenced application contains the required artifact.</span></span>  
  
-   <span data-ttu-id="c600e-151">**安装具有依赖项的应用程序。**</span><span class="sxs-lookup"><span data-stu-id="c600e-151">**Installing applications that have dependencies.**</span></span> <span data-ttu-id="c600e-152">在安装应用程序时，还必须安装它所依赖的任何应用程序。</span><span class="sxs-lookup"><span data-stu-id="c600e-152">When you install an application, you must also install any applications on which it depends.</span></span> <span data-ttu-id="c600e-153">当安装某个项目，如 BizTalk 程序集，其中包含在另一个应用程序中，具有一个依赖项的应用程序时必须首先安装包含该项目的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c600e-153">When you install an application that has a dependency on an artifact, such as a BizTalk assembly, which is contained in another application, you must first install the application that contains the artifact.</span></span> <span data-ttu-id="c600e-154">例如，如果你想要安装应用程序 A，并且取决于应用程序 B 中的程序集，您必须首先安装应用程序 B。</span><span class="sxs-lookup"><span data-stu-id="c600e-154">For example, if you want to install Application A, and it depends on an assembly in Application B, you must install Application B first.</span></span> <span data-ttu-id="c600e-155">然后，你可以安装应用程序 a。有关安装应用程序的详细信息，请参阅[如何安装 BizTalk 应用程序](../core/how-to-install-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-155">Then you can install Application A. For more information about installing applications, see [How to Install a BizTalk Application](../core/how-to-install-a-biztalk-application.md).</span></span>  
  
-   <span data-ttu-id="c600e-156">**移动项目。**</span><span class="sxs-lookup"><span data-stu-id="c600e-156">**Moving an artifact.**</span></span> <span data-ttu-id="c600e-157">当将项目移到新的应用程序时，它在其具有依赖关系的任何其他项目也被移动，除非新的应用程序具有对包含移动的项目所依赖的项目的应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="c600e-157">When you move an artifact to a new application, any other artifacts on which it has dependencies are also moved unless the new application has a reference to the application(s) containing the artifacts on which the moved artifact depends.</span></span> <span data-ttu-id="c600e-158">此外，移动项目有依赖关系的任何项目也将被移动，除非其包含的应用程序具有对新应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="c600e-158">Also, any artifacts that have dependencies on the moved artifact also will be moved unless the application(s) containing them have a reference to the new application.</span></span> <span data-ttu-id="c600e-159">当移动项目，将向您显示一起移动的其他项目的列表。</span><span class="sxs-lookup"><span data-stu-id="c600e-159">When moving an artifact, you will be shown the list of other artifacts that will also be moved.</span></span> <span data-ttu-id="c600e-160">有关移动项目的说明，请参阅[如何将项目移到不同的应用程序](../core/how-to-move-an-artifact-to-a-different-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c600e-160">For instructions on moving an artifact, see [How to Move an Artifact to a Different Application](../core/how-to-move-an-artifact-to-a-different-application.md).</span></span>  
  
-   <span data-ttu-id="c600e-161">**更新某一项目时在另一个应用程序中的项目依赖于它。**</span><span class="sxs-lookup"><span data-stu-id="c600e-161">**Updating an artifact when an artifact in another application depends on it.**</span></span> <span data-ttu-id="c600e-162">更新应用程序具有相同的应用程序中的某个项目的依赖关系中的项目时，BizTalk Server 会自动负责取消部署和重新部署依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="c600e-162">When you update an artifact in an application that has a dependency on an artifact in the same application, BizTalk Server automatically takes care of undeploying and redeploying the dependent artifact.</span></span> <span data-ttu-id="c600e-163">如果你想要更新一个应用程序中的项目，并且另一个应用程序中的项目有依赖关系，但是，你必须取消部署，并按如下所示重新部署依赖的程序集：</span><span class="sxs-lookup"><span data-stu-id="c600e-163">If you want to update an artifact in one application, and an artifact in another application has a dependency on it, however, you must undeploy and redeploy the dependent artifact manually as follows:</span></span>  
  
    1.  <span data-ttu-id="c600e-164">停止、 取消登记和取消绑定依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="c600e-164">Stop, unenlist, and unbind the dependent artifact.</span></span>  
  
    2.  <span data-ttu-id="c600e-165">更新所依赖的项目。</span><span class="sxs-lookup"><span data-stu-id="c600e-165">Update the artifact on which it depends.</span></span>  
  
    3.  <span data-ttu-id="c600e-166">将绑定、 登记并启动依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="c600e-166">Bind, enlist, and start the dependent artifact.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c600e-167">请参阅</span><span class="sxs-lookup"><span data-stu-id="c600e-167">See Also</span></span>  
 [<span data-ttu-id="c600e-168">了解 BizTalk 应用程序的部署和管理</span><span class="sxs-lookup"><span data-stu-id="c600e-168">Understanding BizTalk Application Deployment and Management</span></span>](../core/understanding-biztalk-application-deployment-and-management.md)