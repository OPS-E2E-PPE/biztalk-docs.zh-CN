---
title: "依赖关系和应用程序部署 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- deploying [applications], dependencies
- assemblies, dependencies
- artifacts, dependencies
- applications, dependencies
ms.assetid: b78c5a0d-b042-4862-bce7-59469365b369
caps.latest.revision: "20"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5cc7e4b44a09da04e62062d90cd99da0354cca34
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="dependencies-and-application-deployment"></a><span data-ttu-id="0ad0e-102">依存关系和应用程序部署</span><span class="sxs-lookup"><span data-stu-id="0ad0e-102">Dependencies and Application Deployment</span></span>
<span data-ttu-id="0ad0e-103">本主题介绍两个或多个 BizTalk 应用程序中各项目之间的依存关系如何影响应用程序的部署和维护。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-103">This topic describes how dependencies between artifacts in two or more BizTalk applications affect application deployment and maintenance.</span></span>  
  
 <span data-ttu-id="0ad0e-104">当一个项目需要使用另一个项目才能正常运行时，它称为*依赖*另一个项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-104">When one artifact needs to use another artifact in order to function properly, it is said to be *dependent* on another artifact.</span></span> <span data-ttu-id="0ad0e-105">例如，在业务流程需要使用特定架构进行消息解析时，或者需要使用特定管道以便正确传输消息时，便是此类依存关系。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-105">An example of such a dependency is when an orchestration needs to use a specific schema for message resolution or a specific pipeline in order to transmit messages correctly.</span></span> <span data-ttu-id="0ad0e-106">在上述这两种情况中，业务流程依赖于其他项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-106">In both of these scenarios, the orchestration is dependent on another artifact.</span></span>  
  
 <span data-ttu-id="0ad0e-107">在您可以更新应用程序中的某一项目之前，必须首先取消对该项目以及依赖于该项目的所有项目的部署。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-107">Before you can update an artifact in an application, you must first undeploy it, along with any artifacts that depend on it.</span></span> <span data-ttu-id="0ad0e-108">在具有依存关系的多个项目存在于同一应用程序中时，BizTalk Server 自动处理更新的和依赖的项目的取消部署和重新部署任务。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-108">When artifacts that have dependencies exist in the same application, BizTalk Server automatically handles the undeployment and redeployment tasks for the updated and dependent artifacts.</span></span> <span data-ttu-id="0ad0e-109">但在具有依存关系的项目存在于不同应用程序时，就无法自动完成上述任务了。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-109">When artifacts that have dependencies exist in different applications, however, this is not the case.</span></span> <span data-ttu-id="0ad0e-110">您必须首先执行手动步骤来取消对具有依存关系的项目的部署，然后才可以更新它们所依赖的项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-110">You must take manual steps to undeploy the artifacts that have the dependencies before you can update an artifact on which they depend.</span></span> <span data-ttu-id="0ad0e-111">之后，您必须手动重新部署依赖的项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-111">Afterwards, you must manually redeploy the dependent artifacts.</span></span>  
  
 <span data-ttu-id="0ad0e-112">为了在更新其他项目所依赖的项目时无需执行这些手动步骤，您可以尝试将具有依存关系的所有项目一起保存在同一应用程序中。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-112">To avoid the need to take these manual steps when you want to update an artifact on which other artifacts depend, you can attempt to keep all artifacts with dependencies together in the same application.</span></span> <span data-ttu-id="0ad0e-113">但是，这并非总是可行的。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-113">This is not always possible, however.</span></span> <span data-ttu-id="0ad0e-114">中所述[项目，必须是唯一的应用程序或组](../core/artifacts-that-must-be-unique-in-an-application-or-group.md)，大多数类型的项目必须是唯一 BizTalk 组中。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-114">As described in [Artifacts That Must Be Unique in an Application or Group](../core/artifacts-that-must-be-unique-in-an-application-or-group.md), most types of artifacts must be unique in a BizTalk group.</span></span> <span data-ttu-id="0ad0e-115">您不能在同一组的两个不同应用程序中具有相同的项目，即使这两个应用程序都包含依赖于相同项目的项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-115">You cannot have the same artifact in two different applications in the same group, even if both applications contain artifacts that depend on the same artifact.</span></span>  
  
 <span data-ttu-id="0ad0e-116">在发生此情况时，您可以将所需的项目添加到一个应用程序，然后添加从包含依赖它的项目的任何其他应用程序对该应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-116">When this happens, you can add the needed artifact to one application and then add a reference to that application from any other applications containing artifacts that depend on it.</span></span> <span data-ttu-id="0ad0e-117">在您添加对某一应用程序的引用时，该应用程序中的项目可以使用它引用的应用程序中的任何项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-117">When you add a reference to an application, artifacts in the application can use any artifacts in the application that it references.</span></span> <span data-ttu-id="0ad0e-118">有关添加引用的说明，请参阅[如何添加对另一个应用程序的引用](../core/how-to-add-a-reference-to-another-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-118">For instructions on adding a reference, see [How to Add a Reference to Another Application](../core/how-to-add-a-reference-to-another-application.md).</span></span>  
  
 <span data-ttu-id="0ad0e-119">下图描述了两个应用程序，这两个应用程序分别依赖于第三个应用程序中的项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-119">The following diagram depicts two applications that each depend on artifacts in a third application.</span></span> <span data-ttu-id="0ad0e-120">订单处理应用程序使用 Schema1，而它包含在架构应用程序中，因此，订单处理应用程序包含对架构应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-120">The Order Processing application uses Schema1, which is contained in the Schemas application, so the Order Processing application contains a reference to the Schemas application.</span></span> <span data-ttu-id="0ad0e-121">抵押应用程序使用 Schema2，它也包含在架构应用程序中，同样，抵押应用程序包含对后者的引用。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-121">The Mortgage application uses Schema2, which is also contained in the Schemas application, and likewise the former application contains a reference to the latter.</span></span>  
  
 <span data-ttu-id="0ad0e-122">![两个应用程序都引用第三个应用程序](../core/media/applicationdependencies.gif "ApplicationDependencies")</span><span class="sxs-lookup"><span data-stu-id="0ad0e-122">![Two applications reference a third application](../core/media/applicationdependencies.gif "ApplicationDependencies")</span></span>  
  
 <span data-ttu-id="0ad0e-123">添加从一个应用程序到另一个应用程序的引用将在两个应用程序之间创建一个依存关系，这个依存关系影响您部署和管理这两个应用程序的方式。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-123">Adding a reference from one application to another creates a dependency between the two applications that affects how you deploy and manage both applications.</span></span> <span data-ttu-id="0ad0e-124">由于在本主题后面所述的应用程序依赖项的各种影响，我们建议你遵循的最佳做法来将项目添加到应用程序，中, 所述[部署 BizTalk 应用程序的最佳做法](../core/best-practices-for-deploying-a-biztalk-application.md).</span><span class="sxs-lookup"><span data-stu-id="0ad0e-124">Because of the various effects of application dependencies described later in this topic, we recommend that you follow the best practices for adding artifacts to application, as described in [Best Practices for Deploying a BizTalk Application](../core/best-practices-for-deploying-a-biztalk-application.md).</span></span>  
  
 <span data-ttu-id="0ad0e-125">下图阐释在存在依存关系链时更新某一程序集所涉及的步骤，并且依赖于要更新的程序集的所有程序集都存在于同一应用程序中。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-125">The following diagram illustrates the steps involved in updating an assembly when there is a chain of dependency, and all assemblies that depend on the assembly being updated exist in the same application.</span></span>  
  
 <span data-ttu-id="0ad0e-126">![更新具有依赖项的程序集](../core/media/simpleadminredeploy.gif "SimpleAdminRedeploy")</span><span class="sxs-lookup"><span data-stu-id="0ad0e-126">![Updating an assembly with dependencies](../core/media/simpleadminredeploy.gif "SimpleAdminRedeploy")</span></span>  
  
 <span data-ttu-id="0ad0e-127">下图阐释在要更新的程序集上存在依存关系链时更新某一程序集所涉及的步骤，并且其中一个依赖的程序集存在于不同的应用程序中。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-127">The following diagram illustrates the steps involved in updating an assembly when there is a chain of dependencies on the assembly being updated, and one of the dependent assemblies exists in a different application.</span></span>  
  
 <span data-ttu-id="0ad0e-128">![更新具有外部依赖项的程序集](../core/media/complexadminredeploy.gif "ComplexAdminRedeploy")</span><span class="sxs-lookup"><span data-stu-id="0ad0e-128">![Updating an assembly with external dependencies](../core/media/complexadminredeploy.gif "ComplexAdminRedeploy")</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0ad0e-129">在更新某一程序集之前执行完全停止的原因在于，进行更新将自动取消登记业务流程，并且停止和终止所有消息。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-129">The reason to perform a full stop before updating an assembly is that doing this automatically unenlists the orchestration, and stops and terminates all messages.</span></span> <span data-ttu-id="0ad0e-130">如果您需要继续处理消息，可以部署同一程序集的不同版本，因此无需停止和终止消息。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-130">If you need to continue processing messages, you can deploy a different version of the same assembly and thereby avoid the need to stop and terminate messages.</span></span> <span data-ttu-id="0ad0e-131">有关详细信息，请参阅[更新 BizTalk 应用程序](../core/updating-biztalk-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-131">For more information, see [Updating BizTalk Applications](../core/updating-biztalk-applications.md).</span></span>  
  
 <span data-ttu-id="0ad0e-132">下面的结果可能会在两个应用程序之间导致依存关系。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-132">The following effects may result from dependencies between applications:</span></span>  
  
-   <span data-ttu-id="0ad0e-133">**停止项目。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-133">**Stopping an artifact.**</span></span> <span data-ttu-id="0ad0e-134">如果您停止一个应用程序中另一个应用程序所依赖的项目（这可能导致停止整个应用程序），则依赖的应用程序将无法正常工作。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-134">If you stop an artifact in one application (which may result from stopping the entire application) that another application depends on, the dependent application will not function correctly.</span></span> <span data-ttu-id="0ad0e-135">要停止应用程序的详细信息，请参阅[如何启动和停止 BizTalk 应用程序](../core/how-to-start-and-stop-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-135">For more information about stopping an application, see [How to Start and Stop a BizTalk Application](../core/how-to-start-and-stop-a-biztalk-application.md).</span></span>  
  
-   <span data-ttu-id="0ad0e-136">**删除或更改项目的状态。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-136">**Removing or changing the state of an artifact.**</span></span> <span data-ttu-id="0ad0e-137">在您添加从一个应用程序到另一个应用程序的引用，并且对其他应用程序所依赖的项目状态进行更改或删除该项目时，具有依存关系的应用程序将不会正常工作。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-137">When you add a reference from one application to another and make any changes to the state of an artifact on which another application depends or remove the artifact, the application that has the dependency will not function correctly.</span></span> <span data-ttu-id="0ad0e-138">有关更改项目的状态的详细信息，请参阅部分中相应项目[管理项目](../core/managing-artifacts.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-138">For more information about changing the state of an artifact, see the section on the appropriate artifact in [Managing Artifacts](../core/managing-artifacts.md).</span></span>  
  
-   <span data-ttu-id="0ad0e-139">**导入具有依赖关系的应用程序。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-139">**Importing applications that have dependencies.**</span></span> <span data-ttu-id="0ad0e-140">如果您想要将某一应用程序导入到不同的 BizTalk 组并在该组中运行此应用程序，则还必须导入此应用程序所依赖的所有项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-140">If you want to import an application into a different BizTalk group and run it in that group, you must also import any artifacts on which this application depends.</span></span> <span data-ttu-id="0ad0e-141">您可以通过首先导入其他应用程序或通过将所需项目添加到需要它的应用程序，实现上述要求。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-141">You can do this by first importing the other application or by adding the needed artifact to the application that requires it.</span></span> <span data-ttu-id="0ad0e-142">有关导入应用程序的详细信息，请参阅[如何导入 BizTalk 应用程序](../core/how-to-import-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-142">For more information about importing applications, see [How to Import a BizTalk Application](../core/how-to-import-a-biztalk-application.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="0ad0e-143">BizTalk Server 通过将源中的应用程序名称与目标 BizTalk 组中的名称进行匹配，确认应用程序的标识。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-143">BizTalk Server verifies the identity of an application by matching the application names in the source and the destination BizTalk group.</span></span> <span data-ttu-id="0ad0e-144">它并不确认您的应用程序具有依存关系的项目是否包括在其中。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-144">It does not verify that the artifacts on which your application has dependencies are included in it.</span></span> <span data-ttu-id="0ad0e-145">在导入具有依存关系的应用程序以及它所引用的应用程序时，我们建议您确认引用的应用程序包含所需的项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-145">When you import an application that has dependencies and the application to which it refers, we recommend that you verify that the referenced application contains the required artifact or artifacts.</span></span>  
  
-   <span data-ttu-id="0ad0e-146">**导入引用的应用程序。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-146">**Importing applications that have references.**</span></span> <span data-ttu-id="0ad0e-147">如果要导入的应用程序依赖于其他应用程序中的项目，则需要添加指向此应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-147">If an application you are importing depends on an artifact in another application, you need to add a reference to this application.</span></span> <span data-ttu-id="0ad0e-148">导入向导可提供此选项。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-148">The Import Wizard provides this option.</span></span> <span data-ttu-id="0ad0e-149">如果你使用的 BTSTask ImportApp 命令，但是，你必须添加对导入之后, 应用程序的引用中所述[如何添加对另一个应用程序的引用](../core/how-to-add-a-reference-to-another-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-149">If you are using the ImportApp command of BTSTask, however, you must add the reference to the application after import, as described in [How to Add a Reference to Another Application](../core/how-to-add-a-reference-to-another-application.md).</span></span> <span data-ttu-id="0ad0e-150">在 BizTalk Server 确认存在引用的应用程序时，我们建议您采取其他步骤来确认引用的应用程序包含所需项目。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-150">While BizTalk Server verifies that the referenced application exists, we recommend that you take the additional step of verifying that the referenced application contains the required artifact.</span></span>  
  
-   <span data-ttu-id="0ad0e-151">**安装具有依赖关系的应用程序。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-151">**Installing applications that have dependencies.**</span></span> <span data-ttu-id="0ad0e-152">在您安装某一应用程序时，还必须安装它所依赖的任何应用程序。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-152">When you install an application, you must also install any applications on which it depends.</span></span> <span data-ttu-id="0ad0e-153">如果某个项目（如 BizTalk 程序集）包含在另一个应用程序中，而要安装的应用程序与该项目之间存在依存关系，则在安装该应用程序时，必须首先安装包含该项目的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-153">When you install an application that has a dependency on an artifact, such as a BizTalk assembly, which is contained in another application, you must first install the application that contains the artifact.</span></span> <span data-ttu-id="0ad0e-154">例如，如果您要安装应用程序 A，并且它依赖于应用程序 B 中的程序集，则您必须首先安装应用程序 B。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-154">For example, if you want to install Application A, and it depends on an assembly in Application B, you must install Application B first.</span></span> <span data-ttu-id="0ad0e-155">然后，你可以安装应用程序 a。有关安装应用程序的详细信息，请参阅[如何安装 BizTalk 应用程序](../core/how-to-install-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-155">Then you can install Application A. For more information about installing applications, see [How to Install a BizTalk Application](../core/how-to-install-a-biztalk-application.md).</span></span>  
  
-   <span data-ttu-id="0ad0e-156">**移动项目。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-156">**Moving an artifact.**</span></span> <span data-ttu-id="0ad0e-157">将项目移向新应用程序时，该项目所依赖的其他所有项目也会被移动，除非此新应用程序有对包含移动项目所依赖项目的应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-157">When you move an artifact to a new application, any other artifacts on which it has dependencies are also moved unless the new application has a reference to the application(s) containing the artifacts on which the moved artifact depends.</span></span> <span data-ttu-id="0ad0e-158">同样，与移动项目有依存关系的所有项目也会被移动，除非包含这些项目的应用程序具有对新应用程序的引用。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-158">Also, any artifacts that have dependencies on the moved artifact also will be moved unless the application(s) containing them have a reference to the new application.</span></span> <span data-ttu-id="0ad0e-159">移动项目时，系统会显示一起移动的其他项目的列表。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-159">When moving an artifact, you will be shown the list of other artifacts that will also be moved.</span></span> <span data-ttu-id="0ad0e-160">有关移动项目的说明，请参阅[如何将项目移到不同的应用程序](../core/how-to-move-an-artifact-to-a-different-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-160">For instructions on moving an artifact, see [How to Move an Artifact to a Different Application](../core/how-to-move-an-artifact-to-a-different-application.md).</span></span>  
  
-   <span data-ttu-id="0ad0e-161">**当其他应用程序中的项目依赖于它时，请更新某个项目。**</span><span class="sxs-lookup"><span data-stu-id="0ad0e-161">**Updating an artifact when an artifact in another application depends on it.**</span></span> <span data-ttu-id="0ad0e-162">在您更新应用程序中对同一应用程序中的某一程序集具有依存关系的某一程序集时，BizTalk Server 自动执行对依赖的程序集的取消部署和重新部署。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-162">When you update an artifact in an application that has a dependency on an artifact in the same application, BizTalk Server automatically takes care of undeploying and redeploying the dependent artifact.</span></span> <span data-ttu-id="0ad0e-163">如果您要更新一个应用程序中的某一项目，但其他应用程序中的某个项目对该项目具有依存关系，则您必须按如下所示取消部署和重新部署这个依赖的程序集：</span><span class="sxs-lookup"><span data-stu-id="0ad0e-163">If you want to update an artifact in one application, and an artifact in another application has a dependency on it, however, you must undeploy and redeploy the dependent artifact manually as follows:</span></span>  
  
    1.  <span data-ttu-id="0ad0e-164">停止、取消登记和取消绑定依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-164">Stop, unenlist, and unbind the dependent artifact.</span></span>  
  
    2.  <span data-ttu-id="0ad0e-165">更新它依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-165">Update the artifact on which it depends.</span></span>  
  
    3.  <span data-ttu-id="0ad0e-166">绑定、登记和启动依赖的程序集。</span><span class="sxs-lookup"><span data-stu-id="0ad0e-166">Bind, enlist, and start the dependent artifact.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0ad0e-167">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0ad0e-167">See Also</span></span>  
 [<span data-ttu-id="0ad0e-168">了解 BizTalk 应用程序部署和管理</span><span class="sxs-lookup"><span data-stu-id="0ad0e-168">Understanding BizTalk Application Deployment and Management</span></span>](../core/understanding-biztalk-application-deployment-and-management.md)