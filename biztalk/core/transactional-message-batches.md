---
title: 事务性消息批 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: b1790c05-e3f7-4667-8a9e-f6f208e55e40
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bbc6d3a450106df1b67aa2c0e8fb1ada2f1a9e95
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65399224"
---
# <a name="transactional-message-batches"></a><span data-ttu-id="92e33-102">事务性消息批</span><span class="sxs-lookup"><span data-stu-id="92e33-102">Transactional Message Batches</span></span>
<span data-ttu-id="92e33-103">某些适配器必须协调外部与内部事务[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务。</span><span class="sxs-lookup"><span data-stu-id="92e33-103">Some adapters must coordinate an external transaction with an internal [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction.</span></span> <span data-ttu-id="92e33-104">例如，SQL 适配器附带[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]必须协调[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]事务[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务。</span><span class="sxs-lookup"><span data-stu-id="92e33-104">For example, the SQL adapter supplied with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must coordinate a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] transaction with a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction.</span></span> <span data-ttu-id="92e33-105">若要执行此操作，适配器需要访问[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务对象。</span><span class="sxs-lookup"><span data-stu-id="92e33-105">To do this, the adapter needs access to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction object.</span></span> <span data-ttu-id="92e33-106">事务对象显式创建并与批处理相关联，然后将批处理提交到[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="92e33-106">A transaction object is explicitly created and associated with the batch before the batch is submitted to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="92e33-107">有一个关联的事务对象的批处理调用事务性批处理。</span><span class="sxs-lookup"><span data-stu-id="92e33-107">A batch that has an associated transaction object is called a transactional batch.</span></span> <span data-ttu-id="92e33-108">通过提供你自己的 Microsoft 分布式事务处理协调器 (MSDTC) 事务对象，可以实现"得到了保证，一次且仅一次"，传递的数据输入和输出[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="92e33-108">By supplying your own Microsoft Distributed Transaction Coordinator (MSDTC) transaction object, you can achieve the "guaranteed, once and once only", delivery of data into and out of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
 <span data-ttu-id="92e33-109">像 SQL 适配器的事务数据库适配器由于该批处理的单个事务，在外部数据库中具有死锁的可能性。</span><span class="sxs-lookup"><span data-stu-id="92e33-109">Transactional database adapters like the SQL adapter have the potential for deadlocks in the external database because of the single transaction used for the batch.</span></span> <span data-ttu-id="92e33-110">这是 SQL 适配器的批大小是硬编码到其中一个原因。</span><span class="sxs-lookup"><span data-stu-id="92e33-110">This is why the batch size for the SQL adapter is hard-coded to one.</span></span>  
  
 <span data-ttu-id="92e33-111">应适配器需要登记附加资源管理器，如另一个数据库或 MSMQ，该事务的作用域内，它必须创建并传递给消息引擎显式外部事务。</span><span class="sxs-lookup"><span data-stu-id="92e33-111">Should the adapter need to enlist additional resource managers, such as another database or MSMQ, within the scope of that transaction, it must create and pass to the Messaging Engine an explicit external transaction.</span></span> <span data-ttu-id="92e33-112">创建外部事务并将其与批处理关联是被调用事务性批处理。</span><span class="sxs-lookup"><span data-stu-id="92e33-112">Creating an external transaction and associating it with a batch is a called a transactional batch.</span></span> <span data-ttu-id="92e33-113">事务性适配器是使适配器使用的事务批处理通过显式创建的外部的 Microsoft 分布式事务处理协调器 (MSDTC) 事务。</span><span class="sxs-lookup"><span data-stu-id="92e33-113">A transactional adapter is an adapter that makes use of transactional batches by explicitly creating an external Microsoft Distributed Transaction Coordinator (MSDTC) transaction.</span></span>  
  
 <span data-ttu-id="92e33-114">适配器提供的一个原因[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务是确保，或者[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]或外部系统具有数据的记录。</span><span class="sxs-lookup"><span data-stu-id="92e33-114">One of the reasons an adapter provides [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] with a transaction is to ensure that either [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] or the external system has a record of the data.</span></span> <span data-ttu-id="92e33-115">此记录可确保一次且只有一次传递消息。</span><span class="sxs-lookup"><span data-stu-id="92e33-115">This record ensures the message is delivered once and only once.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="92e33-116">有关 MSDTC 的详细信息，请参阅分布式事务处理协调器处的文档： [ http://go.microsoft.com/fwlink/?LinkId=44297 ](http://go.microsoft.com/fwlink/?LinkId=44297)。</span><span class="sxs-lookup"><span data-stu-id="92e33-116">For more information about MSDTC, see the documentation for the Distributed Transaction Coordinator at: [http://go.microsoft.com/fwlink/?LinkId=44297](http://go.microsoft.com/fwlink/?LinkId=44297).</span></span>  
  
 <span data-ttu-id="92e33-117">文件适配器是适配器的不需要访问事务由于它所管理的外部文件操作不是适配器的事务的示例。</span><span class="sxs-lookup"><span data-stu-id="92e33-117">The File adapter is an example of an adapter that does not require access to the transaction because the external file operations it manages are not transactional.</span></span> <span data-ttu-id="92e33-118">在这种情况下，适配器不提供将事务对象传递给[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="92e33-118">In this case, the adapter does not provide a transaction object to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="92e33-119">SQL 适配器，但是，与 SQL 数据库交互，并可能之外的其他操作其[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]消息的交互。</span><span class="sxs-lookup"><span data-stu-id="92e33-119">The SQL adapter, on the other hand, interacts with an SQL database and may have additional operations outside of its [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] message interactions.</span></span> <span data-ttu-id="92e33-120">外部 MSDTC 事务在这种情况下很有用的适配器要传递给[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="92e33-120">An external MSDTC transaction in this case may make sense for the adapter to pass to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="92e33-121">本节内容</span><span class="sxs-lookup"><span data-stu-id="92e33-121">In This Section</span></span>  
  
-   [<span data-ttu-id="92e33-122">处理事务</span><span class="sxs-lookup"><span data-stu-id="92e33-122">Handling Transactions</span></span>](../core/handling-transactions.md)