---
title: 事务性消息批处理 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: b1790c05-e3f7-4667-8a9e-f6f208e55e40
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 28be423aa500ba8950b5b2100ce68dba7743bd79
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22279525"
---
# <a name="transactional-message-batches"></a><span data-ttu-id="83d4a-102">事务性消息批</span><span class="sxs-lookup"><span data-stu-id="83d4a-102">Transactional Message Batches</span></span>
<span data-ttu-id="83d4a-103">某些适配器必须协调内部的外部事务[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务。</span><span class="sxs-lookup"><span data-stu-id="83d4a-103">Some adapters must coordinate an external transaction with an internal [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction.</span></span> <span data-ttu-id="83d4a-104">例如，SQL 适配器随附[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]必须协调[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]事务[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务。</span><span class="sxs-lookup"><span data-stu-id="83d4a-104">For example, the SQL adapter supplied with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must coordinate a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] transaction with a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction.</span></span> <span data-ttu-id="83d4a-105">若要执行此操作，该适配器需要访问[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]事务对象。</span><span class="sxs-lookup"><span data-stu-id="83d4a-105">To do this, the adapter needs access to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction object.</span></span> <span data-ttu-id="83d4a-106">显式创建事务对象，然后批处理提交到与批处理相关联[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="83d4a-106">A transaction object is explicitly created and associated with the batch before the batch is submitted to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="83d4a-107">具有关联的事务的对象的一批调用事务性批处理。</span><span class="sxs-lookup"><span data-stu-id="83d4a-107">A batch that has an associated transaction object is called a transactional batch.</span></span> <span data-ttu-id="83d4a-108">通过提供你自己的 Microsoft 分布式事务处理协调器 (MSDTC) 事务对象，你可以实现"保证，一次且仅一次"，传送数据进出[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="83d4a-108">By supplying your own Microsoft Distributed Transaction Coordinator (MSDTC) transaction object, you can achieve the "guaranteed, once and once only", delivery of data into and out of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
 <span data-ttu-id="83d4a-109">由于使用批处理的单个事务情况下，如 SQL 适配器的事务数据库适配器具有外部数据库中的死锁的可能性。</span><span class="sxs-lookup"><span data-stu-id="83d4a-109">Transactional database adapters like the SQL adapter have the potential for deadlocks in the external database because of the single transaction used for the batch.</span></span> <span data-ttu-id="83d4a-110">这是 SQL 适配器的批处理大小是硬编码到其中一个原因。</span><span class="sxs-lookup"><span data-stu-id="83d4a-110">This is why the batch size for the SQL adapter is hard-coded to one.</span></span>  
  
 <span data-ttu-id="83d4a-111">应适配器需要登记其他资源管理器，例如其他数据库或 MSMQ，该事务范围内的，它必须创建并传递给 the Messaging Engine 显式的外部事务。</span><span class="sxs-lookup"><span data-stu-id="83d4a-111">Should the adapter need to enlist additional resource managers, such as another database or MSMQ, within the scope of that transaction, it must create and pass to the Messaging Engine an explicit external transaction.</span></span> <span data-ttu-id="83d4a-112">创建一个外部事务，并将其与批处理相关联是调用事务性批处理。</span><span class="sxs-lookup"><span data-stu-id="83d4a-112">Creating an external transaction and associating it with a batch is a called a transactional batch.</span></span> <span data-ttu-id="83d4a-113">事务适配器是使适配器使用的事务批处理通过显式创建外部的 Microsoft 分布式事务处理协调器 (MSDTC) 事务。</span><span class="sxs-lookup"><span data-stu-id="83d4a-113">A transactional adapter is an adapter that makes use of transactional batches by explicitly creating an external Microsoft Distributed Transaction Coordinator (MSDTC) transaction.</span></span>  
  
 <span data-ttu-id="83d4a-114">适配器提供的一个原因[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]与事务是确保它或者[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]或外部系统具有的数据的记录。</span><span class="sxs-lookup"><span data-stu-id="83d4a-114">One of the reasons an adapter provides [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] with a transaction is to ensure that either [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] or the external system has a record of the data.</span></span> <span data-ttu-id="83d4a-115">此记录可确保消息传送一次且只有一次。</span><span class="sxs-lookup"><span data-stu-id="83d4a-115">This record ensures the message is delivered once and only once.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="83d4a-116">有关 MSDTC 的详细信息，请参阅分布式事务处理协调器处的文档： [http://go.microsoft.com/fwlink/?LinkId=44297](http://go.microsoft.com/fwlink/?LinkId=44297)。</span><span class="sxs-lookup"><span data-stu-id="83d4a-116">For more information about MSDTC, see the documentation for the Distributed Transaction Coordinator at: [http://go.microsoft.com/fwlink/?LinkId=44297](http://go.microsoft.com/fwlink/?LinkId=44297).</span></span>  
  
 <span data-ttu-id="83d4a-117">文件适配器是适配器的不需要对事务的访问因为它所管理的外部文件操作不是适配器的事务性的示例。</span><span class="sxs-lookup"><span data-stu-id="83d4a-117">The File adapter is an example of an adapter that does not require access to the transaction because the external file operations it manages are not transactional.</span></span> <span data-ttu-id="83d4a-118">在这种情况下，该适配器不提供事务对象到[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="83d4a-118">In this case, the adapter does not provide a transaction object to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="83d4a-119">SQL 适配器，另一方面，与 SQL 数据库交互，并且可能具有之外的其他操作其[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]消息的交互。</span><span class="sxs-lookup"><span data-stu-id="83d4a-119">The SQL adapter, on the other hand, interacts with an SQL database and may have additional operations outside of its [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] message interactions.</span></span> <span data-ttu-id="83d4a-120">外部 MSDTC 事务在这种情况下可能有意义的适配器将传递给[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="83d4a-120">An external MSDTC transaction in this case may make sense for the adapter to pass to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="83d4a-121">本节内容</span><span class="sxs-lookup"><span data-stu-id="83d4a-121">In This Section</span></span>  
  
-   [<span data-ttu-id="83d4a-122">处理事务</span><span class="sxs-lookup"><span data-stu-id="83d4a-122">Handling Transactions</span></span>](../core/handling-transactions.md)