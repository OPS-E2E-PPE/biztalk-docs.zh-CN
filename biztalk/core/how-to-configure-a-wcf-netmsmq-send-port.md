---
title: 如何配置 Wcf-netmsmq 发送端口 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 13f55e53-12af-473b-b73f-1c98edadfc28
caps.latest.revision: 14
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8e75ead03781384d3d95e152ec29402dd3c771d4
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65386909"
---
# <a name="how-to-configure-a-wcf-netmsmq-send-port"></a>如何配置 Wcf-netmsmq 发送端口
可以以编程方式或使用 BizTalk 管理控制台配置 Wcf-netmsmq 发送端口。  

## <a name="configuration-properties"></a>配置属性

 BizTalk 资源管理器对象模型公开了名为发送端口的特定于适配器的接口**ITransportInfo**具有**TransportTypeData**读/写属性。 此属性接受 XML 字符串的名称-值对的形式 Wcf-netmsmq 发送端口配置属性包。  

 **TransportTypeData**的属性**ITransportInfo**接口不需要。 如果未设置，该适配器使用 Wcf-netmsmq 发送端口配置，默认值，如下表所示。  

 下表列出了配置设置的属性可以在 BizTalk 浏览器对象模型中为 Wcf-netmsmq 发送端口。  


|          属性名称          |                                                                                                                                                                                                                                                                      类型                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|          **标识**           |                                                                                                                                                                                         XML Blob<br /><br /> 示例：<br /><br /> &lt;identity&gt;<br /><br /> &lt;userPrincipalName value="username@contoso.com" /&gt;<br /><br /> &lt;/identity&gt;                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        指定此发送端口预期的服务标识。 这些设置支持此发送端口进行身份验证服务。 在客户端和服务之间的握手过程中，Windows Communication Foundation (WCF) 基础结构将确保预期的服务匹配此元素的值的标识。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|        **StaticAction**         |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     | 指定**SOAPAction**为传出消息的标头字段。 此外可以通过消息上下文属性设置此属性**WCF。操作**管道或业务流程中。 可以通过两种方式指定此值： 单一操作格式和操作映射格式。 例如，将此属性设置中的单一操作格式-如果<http://contoso.com/Svc/Op1-> **SOAPAction**标头传出消息将始终设置为此属性中指定的值。<br /><br /> 如果将此属性设置采用操作映射格式，传出**SOAPAction**标头由**BTS。操作**上下文属性。 例如，如果此属性设置为以下 XML 格式和**BTS。操作**属性设置为 Op1，WCF 发送适配器使用 <http://contoso.com/Svc/Op1> 为传出**SOAPAction**标头。<br /><br /> \<BtsActionMapping\><br /><br /> \<Operation Name="Op1" Action="<http://contoso.com/Svc/Op1>" /\><br /><br /> \<Operation Name="Op2" Action="<http://contoso.com/Svc/Op2>" /\><br /><br /> \</BtsActionMapping\><br /><br /> 如果传出消息来自某个业务流程端口，业务流程实例动态设置**BTS。操作**使用的端口的操作名称的属性。 如果使用基于内容的路由来路由传出消息，则可以设置**BTS。操作**管道组件中的属性。<br /><br /> 默认值为一个空字符串。 |
|         **OpenTimeout**         |                                                                                                                                                                                                                                                              **System.TimeSpan**                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           指定一个时间跨度值来表示为完成信道打开操作提供的时间间隔。<br /><br /> 默认值：00:01:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|         **SendTimeout**         |                                                                                                                                                                                                                                                              **System.TimeSpan**                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指定一个时间跨度值来表示为完成发送操作提供的时间间隔。 如果使用要求响应发送端口，则此值指定完成，整个交互的时间跨度，即使该服务返回一条大消息。<br /><br /> 默认值：00:01:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        **CloseTimeout**         |                                                                                                                                                                                                                                                              **System.TimeSpan**                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           指定一个时间跨度值来表示为完成信道关闭操作提供的时间间隔。<br /><br /> 默认值：00:01:00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|     **EnableTransactional**     |                                                                                                                                                                                                                                                                    Boolean                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                             指定目标服务的消息队列的类型： 事务性或非事务性。 如果此属性设置为 **，则返回 True**、 此发送端口处理的每条消息只传递一次，并传递失败时会通知发件人。 若要通过事务性发送的消息发送端口，同时**持久**并**exactlyOnce**绑定服务元素必须设置为**True**。 如果此属性设置为**False**，发送的消息不保证送达。<br /><br /> 默认值：**True**                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|       **DeadLetterQueue**       |                                                                                                                                                                             Enum<br /><br /> -   **无**-没有死信队列的使用。<br />-   **系统**-使用系统级死信队列。<br />-   **自定义**-使用自定义死信队列。                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                            指定要从中传输失败传递到应用程序的消息的死信队列。 有关传递到死信队列的消息的详细信息，请参阅**Wcf-netmsmq 传输属性对话框，发送，绑定**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。<br/><br/> **请注意**:自定义死信队列被支持仅在消息队列 (MSMQ) 4.0 中，随 Windows Vista 一起发布。 <br /><br /> 默认值：**系统**                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|    **CustomDeadLetterQueue**    |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                               指定使用的完全限定的 URI **net.msmq**方案的每个应用程序的死信队列，消息已过期或失败传输或传递的放置位置的位置。 例如，net.msmq: //localhost/deadletterqueuename。 死信队列是发送应用程序的已用于放置传递失败的过期消息的队列管理器上的队列。 此属性是必需的如果**DeadLetterQueue**属性设置为**自定义**。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|         **TimeToLive**          |                                                                                                                                                                                                                                                              **System.TimeSpan**                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                 指定在将过期并放入死信队列之前消息多长时间是有效的时间跨度。 若要确保具有时效性的消息执行操作不会过时，通过此发送端口进行处理之前，设置此属性。 不使用时此发送端口指定的时间间隔内队列中的消息被认为已过期。 已过期的消息发送到称为死信队列的特殊队列。 死信队列的位置设置与**DeadLetterQueue**属性。<br /><br /> 默认值：1.00:00:00                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|      **UseSourceJournal**       |                                                                                                                                                                                                                                                                    Boolean                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             指定此发送端口处理的消息副本是否应存储在源日记队列。<br /><br /> 默认值：**False**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|        **SecurityMode**         |                                                                      Enum<br /><br /> -   **无**<br />-   **消息**<br />-   **传输**<br />-   **两者**<br /><br /> 有关成员名称的详细信息**SecurityMode**属性，请参阅**安全模式**中的属性**Wcf-netmsmq 传输属性对话框，发送，安全**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            指定使用的安全类型。<br /><br /> 默认值：**传输**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|   **MsmqAuthenticationMode**    |                                                                 Enum<br /><br /> -   **无**<br />-   **WindowsDomain**<br />-   **证书**<br /><br /> 有关成员名称的详细信息**MsmqAuthenticationMode**属性，请参阅**MSMQ 身份验证模式**中的属性**Wcf-netmsmq 传输属性对话框中，发送安全**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             指定 MSMQ 传输必须如何验证消息。<br /><br /> 默认值：**WindowsDomain**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|     **MsmqProtectionLevel**     |                                                                                                                                               Enum<br /><br /> -   **无**:无保护。<br />-   **登录**:对消息进行签名。<br />-   **EncryptAndSign**:消息进行加密和签名。 若要使用此保护级别，必须启用**Active Directory 集成**有关**MSMQ**。                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               指定在 MSMQ 传输级别保护消息。<br /><br /> 默认值：**签名**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|   **MsmqSecureHashAlgorithm**   |                                                                                                                                                                                                                             Enum<br /><br /> -   **MD5**<br />-   **SHA1**<br />-   **SHA25**<br />-   **SHA512**                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  指定要用于计算消息摘要的哈希算法。 此属性不可用如果**MsmqProtectionLevel**属性设置为**None**。<br /><br /> 默认值：**SHA1**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|   **MsmqEncryptionAlgorithm**   |                                                                                                                                                                                                                                              Enum<br /><br /> -   **RC4Stream**<br />-   **AES**                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               指定消息队列管理器之间传输消息时要使用在网络上进行消息加密算法。 提供了该属性才**MsmqProtectionLevel**属性设置为**EncryptAndSign**。<br /><br /> 默认值：**RC4Stream**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **MessageClientCredentialType** |                                                   Enum<br /><br /> -   **无**<br />-   **Windows**<br />-   **UserName**<br />-   **证书**<br /><br /> 有关成员名称的详细信息**MessageClientCredentialType**属性，请参阅**消息客户端凭据类型**中的属性**Wcf-netmsmq 传输属性对话框框中，发送，安全**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           指定使用基于消息的安全性对客户端执行验证时所用的凭据类型。<br /><br /> 默认值：**Windows**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|       **AlgorithmSuite**        |                                                                                                                Enum<br /><br /> 有关成员名称的详细信息**AlgorithmSuite**属性，请参阅**算法套件**中的属性**Wcf-netmsmq 传输属性对话框，发送，安全性**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指定消息加密和密钥包装算法。 这些算法与“安全策略语言”(WS-SecurityPolicy) 规范中指定的算法一致。<br /><br /> 默认值：**Basic256**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|      **ClientCertificate**      |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     指定此发送端口对服务进行身份验证的 X.509 证书的指纹。 此属性是必需的如果**ClientCredentialsType**属性设置为**证书**。 要用于此属性的证书必须安装到**我**将存储在**当前用户**位置。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|     **ServiceCertificate**      |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   指定此发送端口将消息发送到该服务进行身份验证的 X.509 证书的指纹。 要用于此属性的证书必须安装到**其他人**将存储在**本地计算机**位置。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|  **AffiliateApplicationName**   |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         指定要使用的企业单一登录 (SSO) 关联应用程序。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|           **UseSSO**            |                                                                                                                                                                                                                                                                    Boolean                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         指定是否使用单一登录检索客户端凭据的目标服务器的身份验证。<br /><br /> 默认值：**False**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|          **UserName**           |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指定要用于目标服务器的身份验证的用户名时**UseSSO**属性设置为**False**。 无需使用此属性的域 \ 用户格式。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|          **密码**           |                                                                                                                                                                                                                                                                     String                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 指定要用于目标服务器的身份验证的密码时**UseSSO**属性设置为**False**。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|    **OutboundBodyLocation**     | Enum<br /><br /> -   **UseBodyElement** -使用 BizTalk 消息正文部分创建的 soap 内容**正文**为传出消息的元素。<br />-   **UseTemplate** -使用中提供的模板**OutboundXMLTemplate**属性创建的 soap 内容**正文**为传出消息的元素。<br /><br /> 有关如何使用详细信息**OutboundBodyLocation**属性，请参阅[WCF 适配器指定消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     指定数据选择 soap**正文**的传出 WCF 消息的元素。<br /><br /> 默认值：**UseBodyElement**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|     **OutboundXMLTemplate**     |                                                                                                                                                              String<br /><br /> 有关如何使用详细信息**OutboundXMLTemplate**属性，请参阅[WCF 适配器指定消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             指定内容的 SOAP XML 格式的模板**正文**传出的消息的元素。 此属性是必需的如果**OutboundBodyLocation**属性设置为**UseTemplate**。<br /><br /> 默认值为一个空字符串。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

## <a name="configure-a-wcf-netmsmq-send-port-with-the-biztalk-administration-console"></a>使用 BizTalk 管理控制台配置 Wcf-netmsmq 发送端口

 您可以在 BizTalk 管理控制台中设置 Wcf-netmsmq 发送端口适配器变量。 如果没有为发送端口设置属性，Wcf-netmsmq 的默认值发送使用端口配置上, 表中所示。  

## <a name="configure-variables-for-a-wcf-netmsmq-send-port"></a>配置 Wcf-netmsmq 发送端口的变量  

1. 在 BizTalk 管理控制台中，创建新的发送端口或双击某个现有发送端口以对其进行修改。 有关详细信息，请参阅[如何创建发送端口](../core/how-to-create-a-send-port2.md)。 配置所有发送端口选项，并指定**Wcf-netmsmq**有关**类型**选项**传输**一部分**常规**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。  

2. 上**常规**选项卡上，在**传输**部分中，单击**配置**旁边**类型**。  

3. 在**Wcf-netmsmq 传输属性**对话框中，在**常规**选项卡上，配置终结点地址、 服务标识，并且**SOAPAction**标头Wcf-netmsmq 发送端口。 有关详细信息**常规**选项卡**Wcf-netmsmq 传输属性**对话框中，请参阅**Wcf-netmsmq 传输属性对话框中，发送，常规**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。  

4. 在中**Wcf-netmsmq 传输属性**对话框中，在**绑定**选项卡上，配置超时和事务属性和队列设置。 有关详细信息**绑定**选项卡**Wcf-netmsmq 传输属性**对话框中，请参阅**Wcf-netmsmq 传输属性对话框，发送，绑定**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。  

5. 在中**Wcf-netmsmq 传输属性**对话框中，在**安全**选项卡上，定义 Wcf-netmsmq 发送端口的安全功能。 有关详细信息**安全**选项卡**Wcf-netmsmq 传输属性**对话框中，请参阅**Wcf-netmsmq 传输属性对话框，发送，安全**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。  

6. 在中**Wcf-netmsmq 传输属性**对话框中，在**消息**选项卡上，指定数据选择 soap**正文**元素。 有关详细信息**消息**选项卡**Wcf-netmsmq 传输属性**对话框中，请参阅**Wcf-netmsmq 传输属性对话框，发送，消息**选项卡[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。  

## <a name="configure-a-wcf-netmsmq-send-port-programmatically"></a>以编程方式配置 Wcf-netmsmq 发送端口

 可以使用以下格式设置的属性：  

```  
<CustomProps>  
  <ServiceCertificate vt="8" />  
  <UseSSO vt="11">0</UseSSO>  
  <CloseTimeout vt="8">00:01:00</CloseTimeout>  
  <MessageClientCredentialType vt="8">Windows</MessageClientCredentialType>  
  <SendTimeout vt="8">00:01:00</SendTimeout>  
  <OutboundXmlTemplate vt="8"><bts-msg-body xmlns="http://www.microsoft.com/schemas/bts2007" encoding="xml"/></OutboundXmlTemplate>  
  <MsmqProtectionLevel vt="8">Sign</MsmqProtectionLevel>  
  <OpenTimeout vt="8">00:01:00</OpenTimeout>  
  <UseSourceJournal vt="11">0</UseSourceJournal>  
  <AlgorithmSuite vt="8">Basic256</AlgorithmSuite>  
  <SecurityMode vt="8">Transport</SecurityMode>  
  <CustomDeadLetterQueue vt="8" />  
  <ClientCertificate vt="8" />  
  <MsmqEncryptionAlgorithm vt="8">RC4Stream</MsmqEncryptionAlgorithm>  
  <StaticAction vt="8">http://www.northwindtraders.com/Service/Operation</StaticAction>  
  <MsmqSecureHashAlgorithm vt="8">Sha1</MsmqSecureHashAlgorithm>  
  <EnableTransaction vt="11">-1</EnableTransaction>  
  <TimeToLive vt="8">1.00:00:00</TimeToLive>  
  <MsmqAuthenticationMode vt="8">WindowsDomain</MsmqAuthenticationMode>  
  <DeadLetterQueue vt="8">System</DeadLetterQueue>  
  <OutboundBodyLocation vt="8">UseBodyElement</OutboundBodyLocation>  
</CustomProps>  

```  

 下面的代码段说明了如何创建 Wcf-netmsmq 发送端口：  

```  
// Use BizTalk Explorer object model to create new WCF-NetMsmq send port.  
string server = System.Environment.MachineName;  
string database = "BizTalkMgmtDb";  
string connectionString = string.Format("Server={0};Database={1};Integrated Security=true", server, database);  
string transportConfigData = @"<CustomProps>  
                                 <StaticAction vt=""8"">http://www.northwindtraders.com/Service/Operation</StaticAction>  
                                 <OpenTimeout vt=""8"">00:01:00</OpenTimeout>  
                               </CustomProps>";  
//requires project reference to \Program Files\Microsoft BizTalk Server 2009\Developer Tools\Microsoft.BizTalk.ExplorerOM.dll  
BtsCatalogExplorer explorer = new Microsoft.BizTalk.ExplorerOM.BtsCatalogExplorer();  
explorer.ConnectionString = connectionString;  
// Add a new BizTalk application  
Application application = explorer.AddNewApplication();  
application.Name = "SampleBizTalkApplication";  
// Save  
explorer.SaveChanges();  

// Add a new static one-way send port  
SendPort sendPort = application.AddNewSendPort(false, false);   
sendPort.Name = "SampleSendPort";  
sendPort.PrimaryTransport.TransportType = explorer.ProtocolTypes["WCF-NetMsmq"];  
sendPort.PrimaryTransport.Address = "net.msmq://mycomputer/private/samplequeue";  
sendPort.PrimaryTransport.TransportTypeData = transportConfigData; // propertyData; // need to change  
sendPort.SendPipeline = explorer.Pipelines["Microsoft.BizTalk.DefaultPipelines.PassThruTransmit"];  
// Save  
explorer.SaveChanges();  
```  

## <a name="see-also"></a>请参阅  
 [WCF 适配器属性架构和属性](../core/wcf-adapters-property-schema-and-properties.md)   
 [用于 WCF 适配器安装证书](../core/installing-certificates-for-the-wcf-adapters.md)   
 [指定 WCF 适配器的消息正文](../core/specifying-the-message-body-for-the-wcf-adapters.md)   
 [配置 Wcf-netmsmq 适配器](../core/configuring-the-wcf-netmsmq-adapter.md)   
 [使用 WCF 适配器上下文属性配置动态发送端口](../core/configuring-dynamic-send-ports-using-wcf-adapters-context-properties.md)