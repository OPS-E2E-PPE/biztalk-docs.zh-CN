---
title: "避免瓶颈的准则 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 640ab399-b22d-4f71-b41d-ea8d778e064a
caps.latest.revision: "9"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e78f637c2fd6919b4182f2a58b5f16fbd23f0170
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="guidelines-for-avoiding-bottlenecks"></a><span data-ttu-id="ce078-102">避免瓶颈的准则</span><span class="sxs-lookup"><span data-stu-id="ce078-102">Guidelines for Avoiding Bottlenecks</span></span>
<span data-ttu-id="ce078-103">虽然 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 中的默认设置可为许多硬件和软件配置提供最佳性能，但在某些情况下修改这些设置或部署配置可能更为有利。</span><span class="sxs-lookup"><span data-stu-id="ce078-103">While the default settings in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provide optimal performance for many hardware and software configurations, in some scenarios it may be beneficial to modify the settings or deployment configuration.</span></span> <span data-ttu-id="ce078-104">配置 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 时，请参考下列性能指南：</span><span class="sxs-lookup"><span data-stu-id="ce078-104">When configuring [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], consider the following performance guidelines:</span></span>  
  
-   <span data-ttu-id="ce078-105">为阻止资源争用，应将接收、业务流程和发送隔离到不同的主机上。</span><span class="sxs-lookup"><span data-stu-id="ce078-105">To prevent resource contention, isolate receiving, orchestration, and sending onto separate hosts.</span></span> <span data-ttu-id="ce078-106">为了进一步将资源争用降到最低，请隔离来自其他主机的跟踪服务。</span><span class="sxs-lookup"><span data-stu-id="ce078-106">To further minimize contention, isolate the tracking service from other hosts.</span></span>  
  
-   <span data-ttu-id="ce078-107">如果瓶颈为 BizTalk Server 的 CPU 处理能力，请通过增加 CPU 数量或升级到更快的 CPU 来提升 BizTalk Server 的性能。</span><span class="sxs-lookup"><span data-stu-id="ce078-107">If CPU processing on the BizTalk Server is the bottleneck, scale up BizTalk Server by including additional CPUs or upgrading to faster CPUs.</span></span>  
  
## <a name="sql-server-guidelines"></a><span data-ttu-id="ce078-108">SQL Server 指导原则</span><span class="sxs-lookup"><span data-stu-id="ce078-108">SQL Server Guidelines</span></span>  
 <span data-ttu-id="ce078-109">在使用 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 配置 Microsoft SQL Server 时，请参考以下性能指南：</span><span class="sxs-lookup"><span data-stu-id="ce078-109">Consider the following performance guidelines when configuring Microsoft SQL Server with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  
  
-   [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="ce078-110">数据库应配置为在尽可能的专用 SQL Server 实例上运行。</span><span class="sxs-lookup"><span data-stu-id="ce078-110"> databases should be configured to run on a dedicated SQL Server instance whenever possible.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="ce078-111">数据库密集型应用程序，因此分离[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机和承载 SQL Server 计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库将提高性能，应予以考虑在生产中的最佳实践[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]环境。</span><span class="sxs-lookup"><span data-stu-id="ce078-111"> is a databases intensive application, so separation of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer(s) and the SQL Server computer(s) that house the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases will improve performance and should be considered a best practice in a production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span>  
  
-   <span data-ttu-id="ce078-112">只要可能，请为 SQL Server 配置快速的磁盘子系统。</span><span class="sxs-lookup"><span data-stu-id="ce078-112">Whenever possible, use a fast disk subsystem with SQL Server.</span></span> <span data-ttu-id="ce078-113">使用带备份电源的独立磁盘冗余阵列类型 5 (RAID5/10) 或存储区域网络 (SAN)。</span><span class="sxs-lookup"><span data-stu-id="ce078-113">Use a redundant array of independent disks type 5 (RAID5/10) or a storage area network (SAN) with backup power supply.</span></span>  
  
-   <span data-ttu-id="ce078-114">定期使用 SQL Server 灾难恢复进程备份您的数据库。</span><span class="sxs-lookup"><span data-stu-id="ce078-114">Use the SQL Server disaster recovery process to back up your databases regularly.</span></span> <span data-ttu-id="ce078-115">BizTalk Server 服务将自动从 SQL Server 连接故障中恢复。</span><span class="sxs-lookup"><span data-stu-id="ce078-115">The BizTalk Server service automatically recovers from SQL Server connection malfunctions.</span></span>  
  
-   <span data-ttu-id="ce078-116">将所有 MessageBox 隔离到与 BizTalk 跟踪数据库 (BizTalkDTADb) 所在的服务器之外的其他服务器上。</span><span class="sxs-lookup"><span data-stu-id="ce078-116">Isolate each message box onto a separate server from the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="ce078-117">对于更小型的部署，在 CPU 资源可用的情况下，可能可以将 MessageBox 隔离到 BizTalkDTADb 数据库所在物理磁盘之外的其他磁盘上。</span><span class="sxs-lookup"><span data-stu-id="ce078-117">For smaller deployments if CPU resources are available, isolating the message box onto a separate physical disk from the BizTalkDTADb database might be sufficient.</span></span>  
  
-   <span data-ttu-id="ce078-118">主 MessageBox 可能会因 CPU 处理器的处理能力达到饱和或磁盘操作的延迟（平均磁盘队列长度）而成为瓶颈。</span><span class="sxs-lookup"><span data-stu-id="ce078-118">The primary MessageBox could be the bottleneck due to CPU processor saturation or latency from disk operations (average disk queue length).</span></span> <span data-ttu-id="ce078-119">如果瓶颈为 CPU 处理能力，请为主 MessageBox 添加 CPU 处理器。</span><span class="sxs-lookup"><span data-stu-id="ce078-119">If CPU processing is the bottleneck, add CPU processors to the primary message box.</span></span> <span data-ttu-id="ce078-120">如果不尝试禁用发布上 Master 消息框，的这样 Master MessageBox 可以更有效地处理路由到其他 MessageBox 数据库的消息。</span><span class="sxs-lookup"><span data-stu-id="ce078-120">If not try disabling publishing on the Master MessageBox, this way the Master MessageBox can more efficiently handle routing of messages to the other MessageBox databases.</span></span>  
  
-   <span data-ttu-id="ce078-121">如果瓶颈为磁盘操作，请将 BizTalkDTADb 数据库移至专用的 SQL Server 计算机和/或专用磁盘。</span><span class="sxs-lookup"><span data-stu-id="ce078-121">If disk operations are the bottleneck, move the BizTalkDTADb database to a dedicated SQL Server computer and/or dedicated disk.</span></span> <span data-ttu-id="ce078-122">如果主 MessageBox 中的 CPU 处理能力和磁盘操作均不是瓶颈，则您可在同一 SQL Server 计算机上创建新的 MessageBox 数据库，以充分利用您现有的硬件。</span><span class="sxs-lookup"><span data-stu-id="ce078-122">If CPU processing and disk operations on the primary message box are not the bottleneck, you can create new MessageBox databases on the same SQL Server computer to leverage your existing hardware.</span></span>  
  
-   <span data-ttu-id="ce078-123">按照 SQL Server 最佳实践将 MessageBox 和 BizTalkDTADb 数据库的事务和数据日志文件隔离到不同的物理磁盘上。</span><span class="sxs-lookup"><span data-stu-id="ce078-123">Follow SQL Server best practices to isolate the transaction and data log files for the MessageBox and BizTalkDTADb databases onto separate physical disks.</span></span>  
  
-   <span data-ttu-id="ce078-124">为数据和日志文件分配足够的存储空间，否则 SQL Server 会自动将保存日志文件的磁盘中的所有可用空间全部用完。</span><span class="sxs-lookup"><span data-stu-id="ce078-124">Allocate sufficient storage space for the data and log files; otherwise SQL Server will automatically consume all of the available space on the disks that the log files are kept.</span></span> <span data-ttu-id="ce078-125">日志文件的初始大小取决于您特殊情况的特定要求。</span><span class="sxs-lookup"><span data-stu-id="ce078-125">Initial size of the log files will depend on the specific requirements in your particular scenario.</span></span> <span data-ttu-id="ce078-126">根据测试结果估计要部署的文件的平均大小，并在实施解决方案前扩展存储空间。</span><span class="sxs-lookup"><span data-stu-id="ce078-126">Estimate the average file size in your deployment based on testing results, and expand the storage space before implementing your solution.</span></span>  
  
-   <span data-ttu-id="ce078-127">为磁盘空间需求量大的数据库分配足够的存储空间，这些数据库有 MessageBox 数据库、跟踪数据库、业务活动监视 (BAM) 数据库。</span><span class="sxs-lookup"><span data-stu-id="ce078-127">Allocate sufficient storage space for high-disk-usage databases, such as the MessageBox, Tracking, and Business Activity Monitoring (BAM) databases.</span></span> <span data-ttu-id="ce078-128">如果您的解决方案使用 BizTalk 框架消息协议，请为 BizTalk 配置数据库 (BizTalkMgmtDb) 分配足够的存储空间。</span><span class="sxs-lookup"><span data-stu-id="ce078-128">If your solution uses the BizTalk Framework messaging protocol, allocate sufficient storage space for the BizTalk Configuration database (BizTalkMgmtDb).</span></span>  
  
-   <span data-ttu-id="ce078-129">根据业务需求 [数据保留期] 和特定情况下要处理的数据量，配置跟踪数据库的存档/清除作业，以便 BizTalkDTADb 数据库不会增长得过于庞大。</span><span class="sxs-lookup"><span data-stu-id="ce078-129">Depending on business needs [data retention periods] and the volume of data processed in your particular scenario, configure the Archive/Purge jobs on the Tracking database such that the BizTalkDTADb database does not grow too large.</span></span> <span data-ttu-id="ce078-130">此数据库的增长会降低性能（尤其一个 BizTalkDTADb 数据库支持多个 MessageBox 的情况），这是因为数据库中存满数据后，插入数据的速率会受到限制。</span><span class="sxs-lookup"><span data-stu-id="ce078-130">The growth of this database can degrade performance (especially when one BizTalkDTADb database supports multiple message boxes) because reaching the full capacity of the database imposes a limit on the rate of data insertion.</span></span>  
  
-   <span data-ttu-id="ce078-131">如果 MessageBox 和 BizTalkDTADb 数据库所在的服务器为瓶颈，请提升这些服务器的性能。</span><span class="sxs-lookup"><span data-stu-id="ce078-131">Scale up the servers hosting the MessageBox and BizTalkDTADb databases if they are the bottleneck.</span></span> <span data-ttu-id="ce078-132">您可通过增加 CPU 和内存、升级到更快的 CPU 和使用高速专用磁盘来提升硬件性能。</span><span class="sxs-lookup"><span data-stu-id="ce078-132">You can scale up the hardware by adding CPUs, adding memory, upgrading to faster CPUs and using high-speed dedicated disks.</span></span>