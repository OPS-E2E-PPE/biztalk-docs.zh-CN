---
title: 避免瓶颈的准则 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 640ab399-b22d-4f71-b41d-ea8d778e064a
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: db480df2d47fdc03b1719ecfb17fdbb8f23eea41
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65387565"
---
# <a name="guidelines-for-avoiding-bottlenecks"></a><span data-ttu-id="abd21-102">避免瓶颈的准则</span><span class="sxs-lookup"><span data-stu-id="abd21-102">Guidelines for Avoiding Bottlenecks</span></span>
<span data-ttu-id="abd21-103">尽管中的默认设置[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]提供最佳性能的许多硬件和软件配置中，在某些情况下它可能会有所帮助修改这些设置或部署配置。</span><span class="sxs-lookup"><span data-stu-id="abd21-103">While the default settings in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provide optimal performance for many hardware and software configurations, in some scenarios it may be beneficial to modify the settings or deployment configuration.</span></span> <span data-ttu-id="abd21-104">配置时[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，请参考以下性能指南：</span><span class="sxs-lookup"><span data-stu-id="abd21-104">When configuring [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], consider the following performance guidelines:</span></span>  

-   <span data-ttu-id="abd21-105">若要避免资源争用，隔离接收、 业务流程，并将发送到单独的主机上。</span><span class="sxs-lookup"><span data-stu-id="abd21-105">To prevent resource contention, isolate receiving, orchestration, and sending onto separate hosts.</span></span> <span data-ttu-id="abd21-106">可进一步减少争用，隔离从其他主机的跟踪服务。</span><span class="sxs-lookup"><span data-stu-id="abd21-106">To further minimize contention, isolate the tracking service from other hosts.</span></span>  

-   <span data-ttu-id="abd21-107">如果处理 BizTalk Server 上的 CPU 是瓶颈，纵向扩展 BizTalk Server 通过包括更多的 Cpu 或升级到更快的 Cpu。</span><span class="sxs-lookup"><span data-stu-id="abd21-107">If CPU processing on the BizTalk Server is the bottleneck, scale up BizTalk Server by including additional CPUs or upgrading to faster CPUs.</span></span>  

## <a name="sql-server-guidelines"></a><span data-ttu-id="abd21-108">SQL Server 的指导原则</span><span class="sxs-lookup"><span data-stu-id="abd21-108">SQL Server Guidelines</span></span>  
 <span data-ttu-id="abd21-109">配置与 Microsoft SQL Server 时，请考虑以下性能指南[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="abd21-109">Consider the following performance guidelines when configuring Microsoft SQL Server with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  

- [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="abd21-110">应将数据库配置为只要有可能的专用 SQL Server 实例上运行。</span><span class="sxs-lookup"><span data-stu-id="abd21-110">databases should be configured to run on a dedicated SQL Server instance whenever possible.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="abd21-111">是数据库密集型应用程序，因此，分离[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机和承载的 SQL Server 计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库会提高性能和最佳做法在生产环境中的应考虑[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]环境。</span><span class="sxs-lookup"><span data-stu-id="abd21-111">is a databases intensive application, so separation of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer(s) and the SQL Server computer(s) that house the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases will improve performance and should be considered a best practice in a production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span>  

- <span data-ttu-id="abd21-112">只要可能，请使用 SQL Server 使用较快的磁盘子系统。</span><span class="sxs-lookup"><span data-stu-id="abd21-112">Whenever possible, use a fast disk subsystem with SQL Server.</span></span> <span data-ttu-id="abd21-113">使用带备份电源的独立磁盘类型 5 (RAID5/10) 的冗余阵列或存储区域网络 (SAN)。</span><span class="sxs-lookup"><span data-stu-id="abd21-113">Use a redundant array of independent disks type 5 (RAID5/10) or a storage area network (SAN) with backup power supply.</span></span>  

- <span data-ttu-id="abd21-114">使用 SQL Server 灾难恢复过程以定期备份您的数据库。</span><span class="sxs-lookup"><span data-stu-id="abd21-114">Use the SQL Server disaster recovery process to back up your databases regularly.</span></span> <span data-ttu-id="abd21-115">从 SQL Server 连接故障自动恢复 BizTalk Server 服务。</span><span class="sxs-lookup"><span data-stu-id="abd21-115">The BizTalk Server service automatically recovers from SQL Server connection malfunctions.</span></span>  

- <span data-ttu-id="abd21-116">隔离到 BizTalk 跟踪数据库 (BizTalkDTADb) 中的单独服务器上的每个消息框。</span><span class="sxs-lookup"><span data-stu-id="abd21-116">Isolate each message box onto a separate server from the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="abd21-117">对于较小的部署在 CPU 资源可用，隔离到 BizTalkDTADb 数据库中的单独物理磁盘上的消息框可能足以。</span><span class="sxs-lookup"><span data-stu-id="abd21-117">For smaller deployments if CPU resources are available, isolating the message box onto a separate physical disk from the BizTalkDTADb database might be sufficient.</span></span>  

- <span data-ttu-id="abd21-118">主 MessageBox 可能是瓶颈，因为 CPU 处理器能力达到饱和或磁盘操作 （平均磁盘队列长度） 的延迟。</span><span class="sxs-lookup"><span data-stu-id="abd21-118">The primary MessageBox could be the bottleneck due to CPU processor saturation or latency from disk operations (average disk queue length).</span></span> <span data-ttu-id="abd21-119">如果 CPU 处理瓶颈，为主 messagebox 添加 CPU 处理器。</span><span class="sxs-lookup"><span data-stu-id="abd21-119">If CPU processing is the bottleneck, add CPU processors to the primary message box.</span></span> <span data-ttu-id="abd21-120">否则请尝试禁用这种方式，主 MessageBox 可更加高效地将消息路由到其他 MessageBox 数据库的主 MessageBox 上的发布。</span><span class="sxs-lookup"><span data-stu-id="abd21-120">If not try disabling publishing on the Master MessageBox, this way the Master MessageBox can more efficiently handle routing of messages to the other MessageBox databases.</span></span>  

- <span data-ttu-id="abd21-121">如果磁盘操作是瓶颈，BizTalkDTADb 数据库移到专用的 SQL Server 计算机和/或专用的磁盘。</span><span class="sxs-lookup"><span data-stu-id="abd21-121">If disk operations are the bottleneck, move the BizTalkDTADb database to a dedicated SQL Server computer and/or dedicated disk.</span></span> <span data-ttu-id="abd21-122">如果主消息框上的 CPU 处理能力和磁盘操作均不是瓶颈，您可以在相同的 SQL Server 计算机，以利用现有硬件上创建新的 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="abd21-122">If CPU processing and disk operations on the primary message box are not the bottleneck, you can create new MessageBox databases on the same SQL Server computer to leverage your existing hardware.</span></span>  

- <span data-ttu-id="abd21-123">遵循 SQL Server 最佳做法来隔离到单独的物理磁盘上的 MessageBox 和 BizTalkDTADb 数据库的事务和数据日志文件。</span><span class="sxs-lookup"><span data-stu-id="abd21-123">Follow SQL Server best practices to isolate the transaction and data log files for the MessageBox and BizTalkDTADb databases onto separate physical disks.</span></span>  

- <span data-ttu-id="abd21-124">为数据和日志文件; 分配足够的存储空间否则 SQL Server 将自动使用所有这些日志文件保存在磁盘上的可用空间。</span><span class="sxs-lookup"><span data-stu-id="abd21-124">Allocate sufficient storage space for the data and log files; otherwise SQL Server will automatically consume all of the available space on the disks that the log files are kept.</span></span> <span data-ttu-id="abd21-125">日志文件的初始大小将取决于您特殊情况的特定要求。</span><span class="sxs-lookup"><span data-stu-id="abd21-125">Initial size of the log files will depend on the specific requirements in your particular scenario.</span></span> <span data-ttu-id="abd21-126">估计根据测试结果，在部署中的平均文件大小并实施解决方案前扩展存储空间。</span><span class="sxs-lookup"><span data-stu-id="abd21-126">Estimate the average file size in your deployment based on testing results, and expand the storage space before implementing your solution.</span></span>  

- <span data-ttu-id="abd21-127">对于高磁盘使用情况的数据库，如 MessageBox、 跟踪和业务活动监视 (BAM) 数据库分配足够的存储空间。</span><span class="sxs-lookup"><span data-stu-id="abd21-127">Allocate sufficient storage space for high-disk-usage databases, such as the MessageBox, Tracking, and Business Activity Monitoring (BAM) databases.</span></span> <span data-ttu-id="abd21-128">如果您的解决方案使用 BizTalk 框架消息传送协议，请为 BizTalk 配置数据库 (BizTalkMgmtDb) 分配足够的存储空间。</span><span class="sxs-lookup"><span data-stu-id="abd21-128">If your solution uses the BizTalk Framework messaging protocol, allocate sufficient storage space for the BizTalk Configuration database (BizTalkMgmtDb).</span></span>  

- <span data-ttu-id="abd21-129">根据业务需求 [数据保留期] 和处理特定方案中的数据量，存档/清除作业配置跟踪数据库上，以便 BizTalkDTADb 数据库变得不太大。</span><span class="sxs-lookup"><span data-stu-id="abd21-129">Depending on business needs [data retention periods] and the volume of data processed in your particular scenario, configure the Archive/Purge jobs on the Tracking database such that the BizTalkDTADb database does not grow too large.</span></span> <span data-ttu-id="abd21-130">（尤其是在一个 BizTalkDTADb 数据库支持多个消息框） 实施数据插入操作的速率限制到达数据库的全部容量，因为此数据库的增长会降低性能。</span><span class="sxs-lookup"><span data-stu-id="abd21-130">The growth of this database can degrade performance (especially when one BizTalkDTADb database supports multiple message boxes) because reaching the full capacity of the database imposes a limit on the rate of data insertion.</span></span>  

- <span data-ttu-id="abd21-131">纵向扩展它们是否瓶颈承载 MessageBox 和 BizTalkDTADb 数据库的服务器。</span><span class="sxs-lookup"><span data-stu-id="abd21-131">Scale up the servers hosting the MessageBox and BizTalkDTADb databases if they are the bottleneck.</span></span> <span data-ttu-id="abd21-132">可以通过添加 Cpu、 添加内存、 升级到更快的 Cpu 和使用高速专用的磁盘来纵向硬件。</span><span class="sxs-lookup"><span data-stu-id="abd21-132">You can scale up the hardware by adding CPUs, adding memory, upgrading to faster CPUs and using high-speed dedicated disks.</span></span>
