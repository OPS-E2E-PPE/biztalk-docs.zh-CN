---
title: 如何调查瓶颈 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 7ca22d07-d5fe-4dfb-8b52-3be3a95b0d6f
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 643c64401cc5d8f68d407efc37020391b9467a6b
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65384888"
---
# <a name="how-to-investigate-bottlenecks"></a>如何调查瓶颈
本主题介绍如何调查瓶颈的建议的过程。  
  
## <a name="what-is-the-source-of-the-problem"></a>问题的根源是什么？  
 问题的原因可能是硬件或软件相关。 在资源利用不足则通常表示瓶颈的某个位置在系统中。 由于硬件限制或由于和 / 或软件配置效率低下，可能会导致瓶颈。  
  
 确定瓶颈是一个渐进的过程，因此缓解一个问题可能会导致下一个发现。 本主题的目标是科学地确定和缓解这些瓶颈。 很可能以峰值的时间短时间内执行的系统。 但是，为了可承受吞吐量只能作为其执行速度最慢的组件快速处理系统。  
  
## <a name="using-a-serial-approach"></a>使用连续方法  
 瓶颈可位于此终结点 （进入/退出） 的系统或某个位置中的中间 （业务流程/数据库）。 瓶颈位置后可以执行结构化的方法来标识源。 已缓解瓶颈后务必测量性能以确保，新的瓶颈不中引入了其他位置在系统的其他行。  
  
 确定并解决瓶颈的过程应按串行方式，一次只有一个参数应进行变化，然后对性能进行测量以验证这一单个变化的影响。 一次变化多个参数可能会掩盖更改的效果。  
  
 例如，但是更改参数 1 可能会提高性能，更改参数 1 更改了参数 2 一起使用可能有不利影响，从而抵消更改参数 1，因此导致正负零效果的优势。 但是，这会导致效果的改变参数 1 假负和假阳性上改变参数 2 的效果。  
  
## <a name="testing-consistency"></a>测试一致性  
 更改设置后测量性能特征，则必须以验证更改的效果。  
  
-   硬件：请务必的使用一致的硬件，因为改变硬件可以显示不一致的行为生成误导性的结果; 例如不使用便携式计算机。  
  
-   测试运行持续时间：也很重要的固定的最短期限以确保结果是真正可持续而不仅是峰值性能进行测量。 运行时间较长的测试的另一个原因是确保，系统已进行过初始热启动/突增期间其中填充所有缓存、 数据库表已达到预期的计数和限制提供足够时间来限流和调整预定义的阈值，则会命中后的吞吐量。 此方法将有助于发现最佳可承受吞吐量。  
  
-   测试参数：它还是命令性不改变测试参数从测试运行。 例如，改变映射复杂性和/或文档大小可能产生不同的吞吐量和延迟结果。  
  
-   干净的状态：测试完成后务必清理所有状态，然后再运行下一个测试都运行。 例如，历史数据可能会影响运行时吞吐量在数据库中的累积。 回收服务实例有助于释放缓存的资源，例如内存、 数据库连接和线程。  
  
## <a name="expectations-throughput-versus-latency"></a>期望：吞吐量与延迟时间  
 有理由需要一定的吞吐量和/或从已部署系统的滞后时间。 正在尝试吞吐量很高和较低的延迟是得陇望蜀了两个不同的方向。 但是是现实期望获得最佳吞吐量的合理的滞后时间的。 随着吞吐量提高增加的压力 （更高的 CPU 占用率、 更多的磁盘 IO 争用、 内存压力、 更高版本的锁争用） 放置在可以对延迟时间产生负面影响的系统上。 若要发现最佳系统容量，则必须找到并缓解所有瓶颈。  
  
 通过在未清除的数据库中驻留的旧数据 （已完成的实例） 可能会导致瓶颈。当发生这种情况可能会降低性能。 让系统足够时间来排出可以帮助缓解此问题。 但是，发现导致积压累积并帮助缓解这一问题非常重要。  
  
 若要发现积压的原因，务必要分析历史数据和监视性能监视器计数器 （为了发现使用模式和诊断积压的根源）。 这是其中以批处理方式在夜间处理大量数据的常见情况。 发现的系统，并且能够从积压中恢复的容量可有助于评估处理过载情况以及缓冲区的空间量的硬件要求，以容纳系统为处理不可预见的峰值吞吐量.  
  
 优化系统以最佳可承受吞吐量要求用户深入了解正在部署的应用程序、 优点和缺点的特定方案的系统和使用情况模式。 将在生产环境中使用发现瓶颈和预测最佳可承受吞吐量颇有自信地是通过符合什么的拓扑结构进行彻底的测试的唯一方法。  
  
 本部分中的其他主题将指导您完成定义该拓扑的过程，并提供有关如何缓解瓶颈和从第一个位置中避免瓶颈的指南。  
  
## <a name="scaling"></a>缩放  
 瓶颈可能已部署的拓扑的各个阶段。 可以通过升级硬件得以一些瓶颈。 向上扩展 （更多 CPU、 内存或缓存） 或向外扩展 （更多服务器），则可以升级硬件。 增加/扩大的决定取决于遇到的瓶颈类型和要配置的应用程序。 以下信息有助于指导如何更改硬件部署拓扑基于遇到的瓶颈。 应用程序需要将从头开始构建，才能利用扩展/横向扩展。例如：  
  
-   向上扩展的其他服务器 CPU 的和/或内存可能无法帮助缓解此问题，如果应用程序序列化和依赖于单个执行线程。  
  
-   如果其他服务器只需添加无法扩展的公共资源争用，向外扩展与其他服务器系统用处不大。 但是，向外扩展提供了其他权益。 部署两个双处理器服务器，而不是一个四处理器服务器有助于提供冗余的服务器，起到双重作用的缩放以处理增加的吞吐量，并提供高度可用拓扑结构。