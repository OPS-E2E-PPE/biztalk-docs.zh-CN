---
title: "Windows SharePoint Services 适配器表达式 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- macros, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], supported macros
- configuring [Windows SharePoint Services adapters], expressions
- Windows SharePoint Services adapters, expressions
ms.assetid: 15e3afb2-0ef8-41b4-b3ec-de84af738c12
caps.latest.revision: "22"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 377859a1b2c28774342c6ff9dc5cc312c9fd82d9
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2017
---
# <a name="windows-sharepoint-services-adapter-expressions"></a><span data-ttu-id="09ec6-102">Windows SharePoint Services 适配器表达式</span><span class="sxs-lookup"><span data-stu-id="09ec6-102">Windows SharePoint Services Adapter Expressions</span></span>
<span data-ttu-id="09ec6-103">本主题介绍该格式，可以指定为值的字符串的含义**文件 NameProperty 源**Windows SharePoint Services 适配器的属性。</span><span class="sxs-lookup"><span data-stu-id="09ec6-103">This topic describes the format and the meaning of the strings that can be specified as values for the **File NameProperty Source** properties of the Windows SharePoint Services adapter.</span></span> <span data-ttu-id="09ec6-104">它还介绍相关的上下文属性中， **WSS。Filename**和**WSS。ConfigPropertiesXml**。</span><span class="sxs-lookup"><span data-stu-id="09ec6-104">It also describes the related context properties, **WSS.Filename** and **WSS.ConfigPropertiesXml**.</span></span> <span data-ttu-id="09ec6-105">这些表达式使您很容易基于文本以及从消息或 BizTalk 系统提取的值来定义文件名值，或自定义 Windows SharePoint 服务列值。</span><span class="sxs-lookup"><span data-stu-id="09ec6-105">These expressions allow you to easily define the file name value, or custom Windows SharePoint Service column value, based on literals as well as values extracted from the message or the BizTalk system.</span></span>  
  
 <span data-ttu-id="09ec6-106">表达式可以包含文本和宏。</span><span class="sxs-lookup"><span data-stu-id="09ec6-106">The expressions can contain literals and macros.</span></span> <span data-ttu-id="09ec6-107">文本将按键入顺序原样显示在文件名中。</span><span class="sxs-lookup"><span data-stu-id="09ec6-107">The literals will show up in the file name exactly as you type them.</span></span> <span data-ttu-id="09ec6-108">宏必须放在“%”字符之间。</span><span class="sxs-lookup"><span data-stu-id="09ec6-108">Macros must be placed between '%' characters.</span></span> <span data-ttu-id="09ec6-109">宏的示例如下：`%MessageID%`，在运行时该宏将替换为消息的 GUID。</span><span class="sxs-lookup"><span data-stu-id="09ec6-109">An example of a macro is `%MessageID%` which at runtime will be replaced with the GUID of the message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="09ec6-110">当为文本或 XPATH 中使用 %字符时，它必须进行转义如下\\%。</span><span class="sxs-lookup"><span data-stu-id="09ec6-110">When the % character is used as a literal or within an XPATH, it must be escaped like this \\%.</span></span> <span data-ttu-id="09ec6-111">单个 %将被视为宏分隔符，其中\\由单个 %，将在运行时替换 %。</span><span class="sxs-lookup"><span data-stu-id="09ec6-111">A single % will be considered a macro delimiter, where a \\% will be replaced at runtime by a single %.</span></span> <span data-ttu-id="09ec6-112">\ 必须转义的字符如下\\ \\。</span><span class="sxs-lookup"><span data-stu-id="09ec6-112">The \ character must be escaped like this \\\\.</span></span>  
  
## <a name="expression-examples"></a><span data-ttu-id="09ec6-113">表达式示例</span><span class="sxs-lookup"><span data-stu-id="09ec6-113">Expression examples</span></span>  
  
|<span data-ttu-id="09ec6-114">设计时值</span><span class="sxs-lookup"><span data-stu-id="09ec6-114">Design time value</span></span>|<span data-ttu-id="09ec6-115">运行时值</span><span class="sxs-lookup"><span data-stu-id="09ec6-115">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="09ec6-116">XYZ</span><span class="sxs-lookup"><span data-stu-id="09ec6-116">XYZ</span></span>|<span data-ttu-id="09ec6-117">XYZ</span><span class="sxs-lookup"><span data-stu-id="09ec6-117">XYZ</span></span>|  
|<span data-ttu-id="09ec6-118">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="09ec6-118">PurchaseOrder</span></span>|<span data-ttu-id="09ec6-119">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="09ec6-119">PurchaseOrder</span></span>|  
|<span data-ttu-id="09ec6-120">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="09ec6-120">%MessageID%</span></span>|<span data-ttu-id="09ec6-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="09ec6-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="09ec6-122">PurchaseOrder - %MessageID%</span><span class="sxs-lookup"><span data-stu-id="09ec6-122">PurchaseOrder - %MessageID%</span></span>|<span data-ttu-id="09ec6-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="09ec6-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="09ec6-124">折扣\\%10</span><span class="sxs-lookup"><span data-stu-id="09ec6-124">Discount \\%10</span></span>|<span data-ttu-id="09ec6-125">折扣 %10</span><span class="sxs-lookup"><span data-stu-id="09ec6-125">Discount %10</span></span>|  
|<span data-ttu-id="09ec6-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="09ec6-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="09ec6-127">PurchaseOrder – 10001</span><span class="sxs-lookup"><span data-stu-id="09ec6-127">PurchaseOrder – 10001</span></span>|  
|<span data-ttu-id="09ec6-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="09ec6-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="09ec6-129">PurchaseOrder – Contoso-10001</span><span class="sxs-lookup"><span data-stu-id="09ec6-129">PurchaseOrder – Contoso-10001</span></span>|  
  
## <a name="supported-macros"></a><span data-ttu-id="09ec6-130">支持的宏</span><span class="sxs-lookup"><span data-stu-id="09ec6-130">Supported macros</span></span>  
  
|<span data-ttu-id="09ec6-131">设计时值</span><span class="sxs-lookup"><span data-stu-id="09ec6-131">Design time value</span></span>|<span data-ttu-id="09ec6-132">运行时值</span><span class="sxs-lookup"><span data-stu-id="09ec6-132">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="09ec6-133">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="09ec6-133">%MessageID%</span></span>|<span data-ttu-id="09ec6-134">BizTalk 消息 ID，该 ID 是唯一的 GUID。</span><span class="sxs-lookup"><span data-stu-id="09ec6-134">The BizTalk message ID which is a unique GUID.</span></span>|  
|<span data-ttu-id="09ec6-135">%SendingOrchestrationID%</span><span class="sxs-lookup"><span data-stu-id="09ec6-135">%SendingOrchestrationID%</span></span>|<span data-ttu-id="09ec6-136">作为消息起源的业务流程实例的 BizTalk ID。</span><span class="sxs-lookup"><span data-stu-id="09ec6-136">The BizTalk ID of the orchestration instance where the message originated.</span></span>|  
|<span data-ttu-id="09ec6-137">%SendingOrchestrationType%</span><span class="sxs-lookup"><span data-stu-id="09ec6-137">%SendingOrchestrationType%</span></span>|<span data-ttu-id="09ec6-138">作为消息起源的业务流程的类型名称。</span><span class="sxs-lookup"><span data-stu-id="09ec6-138">The type name of the orchestration where the message originated.</span></span>|  
|<span data-ttu-id="09ec6-139">%Xpath =\<xpath\>%</span><span class="sxs-lookup"><span data-stu-id="09ec6-139">%XPATH=\<xpath\>%</span></span>|<span data-ttu-id="09ec6-140">允许指定一个 XPATH，用于从消息中提取值。</span><span class="sxs-lookup"><span data-stu-id="09ec6-140">Allows specifying an XPATH to be used for extracting the value from the message.</span></span> <span data-ttu-id="09ec6-141">"\<xpath\>"必须替换为有效的 XPATH 表达式。</span><span class="sxs-lookup"><span data-stu-id="09ec6-141">“\<xpath\>” must be replaced with a valid XPATH expression.</span></span> <span data-ttu-id="09ec6-142">**注意：**必须中的 Namespace 别名或 WSS 的表达式的外部定义的命名空间别名。ConfigNamespaceAliases 字段。</span><span class="sxs-lookup"><span data-stu-id="09ec6-142">**Note:**  The namespace alias must be defined outside the expression in the 'Namespace Aliases' or WSS.ConfigNamespaceAliases field.</span></span>|  
|<span data-ttu-id="09ec6-143">%Filename%</span><span class="sxs-lookup"><span data-stu-id="09ec6-143">%Filename%</span></span>|<span data-ttu-id="09ec6-144">替换为从消息上下文属性 WSS.Filename 中提取的文件名值。</span><span class="sxs-lookup"><span data-stu-id="09ec6-144">Replaced with the filename value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="09ec6-145">从 SharePoint 接收的消息已将 WSS.Filename 上下文属性值设置为 SharePoint 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="09ec6-145">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="09ec6-146">使用 Path.GetFilenameWithoutExtension 对返回值进行预处理。</span><span class="sxs-lookup"><span data-stu-id="09ec6-146">The returned value is preprocessed using Path.GetFilenameWithoutExtension.</span></span> <span data-ttu-id="09ec6-147">**注意：**中 WSS 不能使用此宏。配置 * （从业务流程） 的上下文属性。</span><span class="sxs-lookup"><span data-stu-id="09ec6-147">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
|<span data-ttu-id="09ec6-148">%Extension%</span><span class="sxs-lookup"><span data-stu-id="09ec6-148">%Extension%</span></span>|<span data-ttu-id="09ec6-149">替换为从消息上下文属性 WSS.Filename 中提取的文件扩展名值。</span><span class="sxs-lookup"><span data-stu-id="09ec6-149">Replaced with the file extension value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="09ec6-150">从 SharePoint 接收的消息已将 WSS.Filename 上下文属性值设置为 SharePoint 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="09ec6-150">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="09ec6-151">使用 Path.GetExtension 对返回值进行预处理。</span><span class="sxs-lookup"><span data-stu-id="09ec6-151">The returned value is preprocessed using Path.GetExtension.</span></span> <span data-ttu-id="09ec6-152">返回值将不会包含“.”。</span><span class="sxs-lookup"><span data-stu-id="09ec6-152">The returned value will not contain ".".</span></span> <span data-ttu-id="09ec6-153">**注意：**中 WSS 不能使用此宏。配置 * （从业务流程） 的上下文属性。</span><span class="sxs-lookup"><span data-stu-id="09ec6-153">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
  
 <span data-ttu-id="09ec6-154">属性升级所支持的任何有效的表达式都是有效的设计时文件名。</span><span class="sxs-lookup"><span data-stu-id="09ec6-154">Any valid expression supported by property promotion is a valid design time file name.</span></span> <span data-ttu-id="09ec6-155">设计时文件名将在运行时扩展为 Windows SharePoint Services 文件名。</span><span class="sxs-lookup"><span data-stu-id="09ec6-155">The design time file name will be expanded at runtime into Windows SharePoint Services file names.</span></span> <span data-ttu-id="09ec6-156">此 Windows SharePoint Services 文件名具有某些其他限制，如下所述：</span><span class="sxs-lookup"><span data-stu-id="09ec6-156">This Windows SharePoint Services file name has some additional limitations, which are described as follows:</span></span>  
  
-   <span data-ttu-id="09ec6-157">有效的 Windows 文件名称可以包含除以下外的任何 Unicode 字符: / \: *？</span><span class="sxs-lookup"><span data-stu-id="09ec6-157">Valid Windows file names can contain any Unicode characters with the exception of the following: /  \  :  *  ?</span></span>  <span data-ttu-id="09ec6-158">/< &#124; "# {} %& ~ 或选项卡上字符和多个段。</span><span class="sxs-lookup"><span data-stu-id="09ec6-158"><  >  &#124;  "  #  {  }  %  &  ~ or tab characters and multiple periods.</span></span>  
  
-   <span data-ttu-id="09ec6-159">文件名的长度不得超过 256 个字符，整个 URL 的长度必须小于或等于 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="09ec6-159">The file name cannot be longer than 256 characters and the entire URL must be less than or equal to 256 characters.</span></span>  
  
-   <span data-ttu-id="09ec6-160">如果扩展的 Windows SharePoint Services 文件名包含无效字符，或扩展的文件名或 URL 太长，则将在应用程序事件日志中记录错误，并挂起该消息。</span><span class="sxs-lookup"><span data-stu-id="09ec6-160">If the expanded Windows SharePoint Services file name contains invalid characters, or if the expanded file name or URL is too long, an error will be logged in the application event log and the message will be suspended.</span></span> <span data-ttu-id="09ec6-161">在使用消息事件和服务实例跟踪时，您还可以在“组中心”页中查看该错误和消息状态。</span><span class="sxs-lookup"><span data-stu-id="09ec6-161">The error and the message state will also be visible in the Group Hub page using the message event and service instance tracking.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="09ec6-162">另请参阅</span><span class="sxs-lookup"><span data-stu-id="09ec6-162">See Also</span></span>  
 <span data-ttu-id="09ec6-163">[如何配置 Windows SharePoint Services 接收位置](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span><span class="sxs-lookup"><span data-stu-id="09ec6-163">[How to Configure a Windows SharePoint Services Receive Location](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span></span>  
 <span data-ttu-id="09ec6-164">[如何配置 Windows SharePoint Services 发送处理程序](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="09ec6-164">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="09ec6-165">[如何配置 Windows SharePoint Services 发送端口](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="09ec6-165">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="09ec6-166">[Windows SharePoint Services 适配器属性参考](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="09ec6-166">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 [<span data-ttu-id="09ec6-167">支持的 Windows SharePoint Services 栏类型</span><span class="sxs-lookup"><span data-stu-id="09ec6-167">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)