---
title: 安装用于 WCF 适配器的证书 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- tools, Certificates Management Console
- certificates, installing [WCF adapters]
- certificates, Certificates Management Console
- certificates, WCF adapters
- WCF adapters, send locations
- receive locations, WCF adapters
- send locations, WCF adapters
- WCF adapters, receive locations
- WCF adapters, certificates
ms.assetid: 04dc065f-a6e8-4359-8696-2a3de24d531d
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e4e9e108c9ecb37ddd086778330c764de20fc47c
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65331938"
---
# <a name="installing-certificates-for-the-wcf-adapters"></a>用于 WCF 适配器安装证书
WCF 适配器可将公钥基础结构 (PKI) 数字证书用于进行消息加密和解密、 消息签名和验证 （不可否认），并客户端身份验证。 本主题介绍各种证书使用方案和 WCF 适配器使用数字证书的配置选项准则。  

## <a name="certificate-usage-scenarios-for-the-wcf-receive-locations"></a>证书使用方案，为 WCF 接收位置  
 下表显示了如何为 WCF 接收位置中安装的证书。  


|                                 证书使用情况                                 |                             用户上下文                              |                                                                                                                                                                                     证书存储位置                                                                                                                                                                                      |                      证书类型                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                何时安装证书                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 解密和签名取决于接收位置的安全设置 | 使用与接收处理程序关联的主机实例帐户 |                                                          登录到运行的每台计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，将每个主机实例服务帐户，托管接收位置并导入到的服务证书**当前用户 \ 个人 （我）** 存储。                                                           |                  私人证书                   | 指定的值**服务证书-指纹**下列配置中的属性：<br /><br /> -**安全模式**属性的 Wcf-basichttp 接收位置设置为**消息**。<br />-**传输客户端凭据类型**属性的 Wcf-basichttp 接收位置设置为**证书**有关**TransportCredentialOnly**安全模式。<br />-**消息客户端凭据类型**属性的 Wcf-wshttp 接收位置设置为**None**，**证书**，或者**用户名**有关**消息**安全模式。<br />-**传输客户端凭据类型**属性的 Wcf-nettcp 接收位置设置为**None**或**证书**为**传输**安全模式。<br />-**消息客户端凭据类型**属性的 Wcf-nettcp 接收位置设置为**None**，**用户名**，或者**证书**有关**消息**安全模式。<br />-**消息客户端凭据类型**属性的 Wcf-nettcp 接收位置设置为**Windows**，**用户名**，或**证书**对于**TransportWithMessageCredential**安全模式。<br />-**安全模式**Wcf-netmsmq 属性设置为**消息**或**同时**。 |
|                               客户端身份验证                               |                                  不可用                                  | 登录到运行每个计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，将托管接收位置作为管理员，并导入的 CA 证书链的客户端 X.509 证书到受信任的根证书颁发机构证书存储的计算机的因此，客户端可以进行身份验证与此接收位置。 | 客户端 X.509 证书的 CA 证书链 |                                                                                                                                                                                                               将客户端 X.509 证书的 CA 证书链安装到受信任的根证书颁发机构证书存储中的以下配置：<br /><br /> -**消息客户端凭据类型**或**传输客户端凭据类型**属性 Wcf-basichttp 接收位置设置为**证书**。<br />-**消息客户端凭据类型**或**传输客户端凭据类型**属性 Wcf-wshttp 接收位置设置为**证书**。<br />-**消息客户端凭据类型**或**传输客户端凭据类型**属性的 Wcf-nettcp 接收位置设置为**证书**。<br />-**消息客户端凭据类型**或**MSMQ 身份验证模式**属性 Wcf-netmsmq 接收位置设置为**证书**。                                                                                                                                                                                                                |

> [!NOTE]
>  由于标准 WCF 接收适配器使用[ChainTrust](http://go.microsoft.com/fwlink/?LinkId=88960)模式来验证客户端证书，必须安装客户端 X.509 证书的 CA 证书链。 可以使用 Wcf-custom 或 Wcf-customisolated 适配器 cange 到此默认行为。  

> [!NOTE]
>  为独立 WCF 接收适配器，你需要匹配独立主机实例和相应的应用程序池之间的用户帐户。 有关独立 BizTalk 主机的详细信息，请参阅[启用 Web 服务](../core/enabling-web-services.md)。  

> [!NOTE]
>  Wcf-custom 和 Wcf-customisolated 接收位置、 用户上下文、 证书存储位置和要安装证书的证书类型而异**serviceCredentials**和**clientCredentials**行为元素设置。  

> [!NOTE]
>  如果接收位置使用的证书元素**终结点标识**属性，您还必须安装到证书存储中指定的已发布的服务标识的证书的**终结点标识**属性。  

> [!NOTE]
>  而不是登录到使用主机实例服务帐户或管理员帐户的计算机，或者可用运行方式命令与适当的帐户来执行相同操作。  

## <a name="certificate-usage-scenarios-for-the-wcf-send-ports"></a>WCF 发送端口的证书使用方案  
 下表显示了如何安装用于 WCF 发送端口的证书。  


|                                                 证书使用情况                                                  |                          用户上下文                           |                                                                                                                                                                                                      证书存储位置                                                                                                                                                                                                      |                                       证书类型                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                   何时安装证书                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                               客户端身份验证                                                | 与发送端口关联的主机实例使用的帐户 |                                                                               登录到运行的每台计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，将发送端口宿主的每个主机实例服务帐户，并导入到客户端证书**当前用户 \ 个人 （我）** 存储。                                                                               |                                   私人证书                                    |                                                                                              指定的值**客户端证书-指纹**下列配置中的属性：<br /><br /> -**消息客户端凭据类型**或**传输客户端凭据类型**Wcf-basichttp 发送端口的属性设置为**证书**。<br />-**消息客户端凭据类型**或**传输客户端凭据类型**Wcf-wshttp 发送端口的属性设置为**证书**。<br />-**消息客户端凭据类型**或**传输客户端凭据类型**Wcf-nettcp 发送端口的属性设置为**证书**。<br />-**消息客户端凭据类型**或**MSMQ 身份验证模式**Wcf-netmsmq 发送端口的属性设置为**证书**。                                                                                              |
| 服务身份验证、 签名验证和发送端口根据安全设置加密 |                               不可用                               | 登录到运行的每台计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，将发送端口宿主的作为管理员，并导入到的服务证书**本地计算机 \ 其他人 （通讯簿）** 存储。 您还需要将服务证书的 CA 证书链安装到计算机的受信任的根证书颁发机构证书存储。 | -服务公用证书<br />的服务证书 CA 证书链 |                                                                                                                                                                           指定的值**服务证书-指纹**下列配置中的属性：<br /><br /> -**消息客户端凭据类型**或**传输客户端凭据类型**Wcf-basichttp 发送端口的属性设置为**证书**。<br />-**消息客户端凭据类型**Wcf-wshttp 发送端口的属性设置为**None**，**用户名**，或者**证书**时**协商服务凭据**选项已被清除。<br />-**安全模式**Wcf-netmsmq 发送端口设置为**消息**或**同时**。                                                                                                                                                                           |
| 服务身份验证、 签名验证和发送端口根据安全设置加密 |                               不可用                               |                         登录到运行每个计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，将作为管理员，承载发送端口并导入的 CA 证书链的客户端 X.509 证书到受信任的根证书颁发机构证书存储的计算机的因此，该服务可以进行身份验证此发送端口。                         |                     服务证书的 CA 证书链                     | 如果未显式指定的服务证书**服务证书-指纹**属性中，安装服务 X.509 CA 证书链证书到受信任的根证书颁发机构证书存储中的以下配置：<br /><br /> -**安全模式**Wcf-basichttp 发送端口设置为**传输**或**TransportWithMessageCredential**。<br />-**安全模式**Wcf-wshttp 发送端口设置为**传输**或**TransportWithMessageCredential**。<br />-**安全模式**的 Wcf-nettcp 发送端口设置为**TransportWithMessageCredential**。<br />-**传输客户端凭据类型**Wcf-nettcp 发送端口的属性设置为**None**或**证书**。<br />-**消息客户端凭据类型**Wcf-nettcp 发送端口的属性设置为**None**，**用户名**，或者**证书**。 |

> [!NOTE]
>  由于标准 WCF 发送适配器使用[ChainTrust](http://go.microsoft.com/fwlink/?LinkId=88960)模式来验证服务证书，必须安装服务 X.509 证书的 CA 证书链。 可以使用 Wcf-custom 或 Wcf-customisolated 适配器来更改此默认行为。  

> [!NOTE]
>  对于 Wcf-custom 和 Wcf-customisolated 发送端口、 用户上下文、 证书存储区位置和要安装证书的证书类型而异**serviceCredentials**和**clientCredentials**行为元素设置。  

> [!NOTE]
>  如果发送端口使用的证书元素**终结点标识**属性，还必须安装正确的服务标识的证书中指定的证书存储中**终结点标识**属性。  

> [!NOTE]
>  而不是登录到使用主机实例服务帐户或管理员帐户的计算机，或者可用运行方式命令与适当的帐户来执行相同操作。  

## <a name="displaying-the-certificates-management-console"></a>显示证书管理控制台  
 若要显示有关本地计算机和当前用户的证书管理控制台界面，请执行以下步骤：  

1.  单击**启动**，单击**运行**，类型**MMC**，然后单击**确定**以打开 Microsoft 管理控制台。  

2.  上**文件**菜单上，单击**添加/删除管理单元中**以显示**添加/删除管理单元中**对话框。  

3.  单击**外**以显示**添加独立管理单元中**对话框。  

4.  选择**证书**从列表中的管理单元，然后单击**添加**。  

5.  选择**计算机帐户**，单击**下一步**，然后单击**完成**。 这将为本地计算机添加证书管理控制台界面。  

6.  絋粄**证书**从管理单元的列表仍处于选中状态，然后单击**添加**试。  

7.  选择**我的用户帐户**，然后单击**完成**。 这将为当前用户添加证书管理控制台界面。  

    > [!NOTE]
    >  此时将显示证书管理控制台当前以登录的帐户。 如果你需要将证书导入的服务帐户的个人存储然后您应该登录使用服务帐户凭据第一次。  

8.  单击**关闭**中**独立管理单元中**对话框。  

9. 单击**确定**中**添加/删除管理单元中**对话框。