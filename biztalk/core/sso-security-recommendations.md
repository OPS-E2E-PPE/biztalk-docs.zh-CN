---
title: "SSO 安全建议 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- SSO, deploying
- Kerberos protocol, SSO
- deploying, SSO
- user accounts, SSO
- deploying, security
- SQL Server, SSO
- security, SSO
- SSO, Kerberos protocol
- SSO, auditing
- best practices, deploying
- SSO, Windows groups
- SSO, best practices
- SSO, perimeter network
- Windows groups, SSO
- SSO, SQL Server access
- best practices, security
- Master Secret server, clustering
- perimeter networks
- auditing [SSO]
- SSO, security
- SSO, user accounts
- Master Secret server, best practices
ms.assetid: 7ae922b4-fd48-41f4-aaab-419a5e22c753
caps.latest.revision: "17"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 0a86e669e603eaabf142ce446b8d7204a6cc0091
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="sso-security-recommendations"></a><span data-ttu-id="ef47b-102">SSO 安全建议</span><span class="sxs-lookup"><span data-stu-id="ef47b-102">SSO Security Recommendations</span></span>
<span data-ttu-id="ef47b-103">利用企业单一登录 (SSO) 系统，用户只需使用一组凭据即可连接到不同的系统。</span><span class="sxs-lookup"><span data-stu-id="ef47b-103">With the Enterprise Single Sign-On (SSO) system, users can connect to different systems by using only one set of credentials.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="ef47b-104">利用的敏感信息的存储区作为 SSO 系统。</span><span class="sxs-lookup"><span data-stu-id="ef47b-104"> leverages the SSO system as a store for sensitive information.</span></span> <span data-ttu-id="ef47b-105">虽然只要安装 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 运行时，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 便会自动安装企业单一登录，但您也可以独立于 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 环境将企业单一登录作为独立的组件进行安装。</span><span class="sxs-lookup"><span data-stu-id="ef47b-105">Although [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] automatically installs whenever you install the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] runtime, you can also install Enterprise Single Sign-On as a stand-alone component, independent of your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="ef47b-106">有关企业单一登录的详细信息，请参阅[使用 SSO](../core/using-sso.md)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-106">For more information about Enterprise Single Sign-On, see [Using SSO](../core/using-sso.md).</span></span> <span data-ttu-id="ef47b-107">建议遵循以下准则，以保护环境中企业单一登录 (SSO) 服务和资源的安全并对其进行部署。</span><span class="sxs-lookup"><span data-stu-id="ef47b-107">It is recommended you follow these guidelines for securing and deploying the Enterprise Single Sign-On (SSO) services and resources in your environment.</span></span>  
  
## <a name="general-deployment-recommendations-for-sso"></a><span data-ttu-id="ef47b-108">SSO 的一般性部署建议</span><span class="sxs-lookup"><span data-stu-id="ef47b-108">General Deployment Recommendations for SSO</span></span>  
  
-   <span data-ttu-id="ef47b-109">整个环境中必须只能有一个主密钥服务器和一个 SSO 数据库，即使您的环境中有多个 BizTalk 组。</span><span class="sxs-lookup"><span data-stu-id="ef47b-109">There must be only one master secret server and only one SSO database in the entire environment, even if you have multiple BizTalk groups in your environment.</span></span> <span data-ttu-id="ef47b-110">在配置任何其他 BizTalk 和 SSO 服务器之前，必须先配置这两个服务器。</span><span class="sxs-lookup"><span data-stu-id="ef47b-110">You must configure these two servers before you configure any other BizTalk and SSO servers.</span></span>  
  
-   <span data-ttu-id="ef47b-111">您的环境中必须有一个时间服务器，以确保所有 SSO 服务器保持同步。</span><span class="sxs-lookup"><span data-stu-id="ef47b-111">You must have a time server in your environment to ensure all SSO servers are synchronized.</span></span> <span data-ttu-id="ef47b-112">如果 SSO 服务器上的时钟不同步，可能会危及环境的安全。</span><span class="sxs-lookup"><span data-stu-id="ef47b-112">If the clocks on the SSO servers are not synchronized, the security of your environment could be compromised.</span></span>  
  
-   <span data-ttu-id="ef47b-113">假设您的整个环境中只有一个主密钥服务器，建议为该主密钥服务器使用主动-被动群集配置。</span><span class="sxs-lookup"><span data-stu-id="ef47b-113">Considering there is only one master secret server in your entire environment, it is recommended to use an active-passive cluster configuration for the master secret server.</span></span> <span data-ttu-id="ef47b-114">有关群集的主密钥服务器的详细信息，请参阅[如何安装群集主密钥服务器](../core/how-to-cluster-the-master-secret-server1.md)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-114">For more information about clustering the master secret server, see [How to Cluster the Master Secret Server](../core/how-to-cluster-the-master-secret-server1.md).</span></span>  
  
-   <span data-ttu-id="ef47b-115">主密钥服务器存放 SSO 系统用于对 SSO 数据库中的信息进行加密的加密密钥。</span><span class="sxs-lookup"><span data-stu-id="ef47b-115">The master secret server holds the encryption key that the SSO system uses to encrypt the information in the SSO database.</span></span> <span data-ttu-id="ef47b-116">建议不要在此计算机上安装或配置任何其他产品或服务。</span><span class="sxs-lookup"><span data-stu-id="ef47b-116">It is recommended that you do not install or configure any other products or services on this computer.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="ef47b-117">安装和配置主密钥服务器的计算机不必是服务器。</span><span class="sxs-lookup"><span data-stu-id="ef47b-117">The computer where you install and configure the master secret server does not have to be a server.</span></span>  
  
-   <span data-ttu-id="ef47b-118">主密钥服务器应能够访问可移动媒体或 NTFS 文件系统文件夹，以便备份和还原主密钥。</span><span class="sxs-lookup"><span data-stu-id="ef47b-118">The master secret server should have access to a removable media or NTFS file system folder in order to back up and restore the master secret.</span></span> <span data-ttu-id="ef47b-119">如果使用可移动媒体，请确保采取适当的措施来保护可移动媒体。</span><span class="sxs-lookup"><span data-stu-id="ef47b-119">If you use removable media, ensure you take appropriate measures to protect the removable media.</span></span> <span data-ttu-id="ef47b-120">如果将主密钥备份到 NTFS 文件系统，请确保对文件和文件夹进行保护。</span><span class="sxs-lookup"><span data-stu-id="ef47b-120">If you back up the master secret to an NTFS file system, ensure you protect the file and the folder.</span></span> <span data-ttu-id="ef47b-121">只有 SSO 管理员才能访问该文件。</span><span class="sxs-lookup"><span data-stu-id="ef47b-121">Only the SSO Administrator should have access to this file.</span></span>  
  
-   <span data-ttu-id="ef47b-122">一旦主密钥服务器生成主密钥，应立即备份主密钥。</span><span class="sxs-lookup"><span data-stu-id="ef47b-122">You should back up the master secret as soon as the master secret server generates it.</span></span> <span data-ttu-id="ef47b-123">这样，当主密钥服务器发生故障时，就可以对 SSO 数据库中的数据进行恢复。</span><span class="sxs-lookup"><span data-stu-id="ef47b-123">This is so that you may recover the data in the SSO database in the event the master secret server fails.</span></span> <span data-ttu-id="ef47b-124">有关备份主密钥的详细信息，请参阅[管理主密钥](../core/managing-the-master-secret.md)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-124">For more information about backing up the master secret, see [Managing the Master Secret](../core/managing-the-master-secret.md).</span></span>  
  
-   <span data-ttu-id="ef47b-125">应定期（例如，每月一次）备份当前密钥或生成新密钥。</span><span class="sxs-lookup"><span data-stu-id="ef47b-125">Back up your current secret, or generate a new secret on a regular basis, for example, once a month.</span></span> <span data-ttu-id="ef47b-126">如果没有密钥，将无法从 SSO 数据库检索信息。</span><span class="sxs-lookup"><span data-stu-id="ef47b-126">Without the secret, you cannot retrieve information from the SSO database.</span></span> <span data-ttu-id="ef47b-127">有关备份和还原主密钥的详细信息，请参阅[管理主密钥](../core/managing-the-master-secret.md)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-127">For more information about backing up and restoring the master secret, see [Managing the Master Secret](../core/managing-the-master-secret.md).</span></span>  
  
## <a name="security-recommendations-for-sso-groups-and-accounts"></a><span data-ttu-id="ef47b-128">SSO 组和帐户的安全建议</span><span class="sxs-lookup"><span data-stu-id="ef47b-128">Security Recommendations for SSO Groups and Accounts</span></span>  
  
-   <span data-ttu-id="ef47b-129">建议使用 Windows 组，而不要使用单个用户帐户，特别是对于 SSO Administrators 和 SSO Affiliate Administrators 组。</span><span class="sxs-lookup"><span data-stu-id="ef47b-129">It is recommended to use Windows groups, and not single user accounts, especially for the SSO Administrator and SSO Affiliate administrator groups.</span></span> <span data-ttu-id="ef47b-130">这些组在任何时候都必须至少具有两个组成员用户帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-130">These groups must have at least two user accounts as members of the group at all times.</span></span>  
  
-   <span data-ttu-id="ef47b-131">SSO 运行时服务帐户和 SSO 管理员用户帐户应为不同的帐户，即使它们是同一 SSO Administrators 组的成员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-131">The SSO runtime service accounts and the SSO administrator user accounts should be different accounts, even when they are members of the same SSO Administrators group.</span></span> <span data-ttu-id="ef47b-132">执行管理任务（例如生成和备份密钥）的 SSO 管理员用户必须为 Windows 管理员，而 SSO 运行时服务帐户不必为 Windows 管理员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-132">The SSO administrator users performing administrative tasks such as generating and backing up the secret must be Windows administrators, while the SSO runtime service accounts do not need to be Windows administrators.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="ef47b-133">Windows 管理员用户权限不能取代 SSO 管理员的用户权限。</span><span class="sxs-lookup"><span data-stu-id="ef47b-133">Windows administrator user rights do not supersede the user rights of the SSO administrator.</span></span> <span data-ttu-id="ef47b-134">若要执行任何 SSO 管理级别的任务，即使您已经是 Windows 管理员，也必须为 SSO Administrators 组的成员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-134">To perform any SSO administration-level task you must be a member of SSO administrators group even if you already are a Windows administrator.</span></span>  
  
-   <span data-ttu-id="ef47b-135">如果使用 SSO 票证功能，则必须使用处理域（SSO 服务器所在的域）中的计算机能够识别的域帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-135">If you use the SSO ticketing feature, you must use domain accounts that the computers in the processing domain (domain where the SSO servers are) recognize.</span></span>  
  
-   <span data-ttu-id="ef47b-136">建议为与主密钥服务器相应的 SSO 服务使用唯一的服务帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-136">It is recommended to use a unique service account for the SSO service corresponding to the master secret server.</span></span>  
  
-   <span data-ttu-id="ef47b-137">SSO 管理员帐户是 SSO 系统中具有很高权限的帐户，该帐户同时也是包含 SSO 数据库的 SQL Server 的 SQL Server 管理员帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-137">The SSO administrator account is a highly privileged account in the SSO system, which also is the SQL Server administrator account for the SQL server that has the SSO database.</span></span> <span data-ttu-id="ef47b-138">应为 SSO 管理员使用专用帐户，并且不应将这些帐户用于任何其他用途。</span><span class="sxs-lookup"><span data-stu-id="ef47b-138">You should have dedicated accounts for SSO administrators, and should not use these accounts for any other purposes.</span></span> <span data-ttu-id="ef47b-139">应将 SSO Administrators 组的成员身份限制为仅负责运行和维护 SSO 系统的帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-139">You should limit the membership to the SSO administrators group only to those accounts responsible for running and maintaining the SSO system.</span></span>  
  
-   <span data-ttu-id="ef47b-140">必须手动将 BizTalk Administrators 组添加到 SSO Affiliate Administrators 组中，以便 BizTalk 管理员可以利用 SSO 系统将适配器的配置信息保存到 SSO 数据库中。</span><span class="sxs-lookup"><span data-stu-id="ef47b-140">You must manually add the BizTalk administrators group to the SSO Affiliate Administrators group so that the BizTalk administrators can leverage the SSO system to save the configuration information for the adapters in the SSO database.</span></span> <span data-ttu-id="ef47b-141">只有管理适配器的 BizTalk 管理员需要为 SSO Affiliate Administrators 组的成员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-141">Only the BizTalk administrators managing adapters need to be members of the SSO Affiliate Administrators group.</span></span> <span data-ttu-id="ef47b-142">BizTalk 管理员不需要为 SSO 管理员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-142">BizTalk administrators do not need to be SSO administrators.</span></span>  
  
## <a name="security-recommendations-for-an-sso-deployment"></a><span data-ttu-id="ef47b-143">SSO 部署的安全建议</span><span class="sxs-lookup"><span data-stu-id="ef47b-143">Security Recommendations for an SSO Deployment</span></span>  
  
-   <span data-ttu-id="ef47b-144">如果您的网络支持 Kerberos 验证，则应注册所有 SSO 服务器。</span><span class="sxs-lookup"><span data-stu-id="ef47b-144">If your network supports Kerberos authentication, you should register all SSO servers.</span></span> <span data-ttu-id="ef47b-145">如果在主密钥服务器与 SSO 数据库之间使用 Kerberos 验证，则必须在该 SSO 数据库所在的 SQL Server 上配置服务主体名称 (SPN)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-145">When you use Kerberos authentication between the master secret server and the SSO database, you must configure Service Principal Names (SPN) on the SQL server where the SSO database is located.</span></span> <span data-ttu-id="ef47b-146">有关配置服务主体名称的详细信息，请参阅 Microsoft 下载网站，网址[http://go.microsoft.com/fwlink/?LinkId=195797](http://go.microsoft.com/fwlink/?LinkId=195797)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-146">For more information about configuring Service Principal Names, see Microsoft Download Web site at [http://go.microsoft.com/fwlink/?LinkId=195797](http://go.microsoft.com/fwlink/?LinkId=195797).</span></span>  
  
-   <span data-ttu-id="ef47b-147">在运行 [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] 或 [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] 时，如果主密钥服务器位于与其他 SSO 服务器和 SSO 数据库不同的域中，则必须对主密钥服务器、SSO 服务器（处理域中的处理计算机）和 SSO 数据库禁用 RPC 安全性（用于计算机之间的数据事务处理协调器 (DTC) 验证）。</span><span class="sxs-lookup"><span data-stu-id="ef47b-147">When running [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] or [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)], if the master secret server is on a different domain from the other SSO servers and from the SSO database, you must disable RPC security (as used for Data Transaction Coordinator (DTC) authentication between computers) on the master secret server, on the SSO servers (processing computers in the processing domain), and on the SSO database.</span></span> <span data-ttu-id="ef47b-148">RPC 安全性是 [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] 和 [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] 中的一项 DTC 功能。</span><span class="sxs-lookup"><span data-stu-id="ef47b-148">RPC security is a DTC feature in [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] and [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="ef47b-149">当禁用 RPC 安全性后，RPC 调用的 DTC 身份验证安全级别将恢复为 Microsoft Windows Server 2003 中可用的级别。</span><span class="sxs-lookup"><span data-stu-id="ef47b-149">When you disable RPC security, the DTC authentication security level for RPC calls goes back to one available in Microsoft Windows Server 2003.</span></span>  
  
-   <span data-ttu-id="ef47b-150">SSO 管理员应定期监视主密钥服务器和 SSO 服务器中的事件日志，以查看 SSO 审核事件。</span><span class="sxs-lookup"><span data-stu-id="ef47b-150">SSO administrators should regularly monitor the event log in the master secret server and the SSO server for SSO auditing events.</span></span>  
  
-   <span data-ttu-id="ef47b-151">除防火墙之外，建议在所有 SSO 服务器和 SSO 数据库之间使用 Internet 协议安全性 (IPSec) 或安全套接字层 (SSL)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-151">In addition to firewalls, it is recommended to use Internet Protocol security (IPSec) or Secure Sockets Layer (SSL) between all the SSO servers and the SSO database.</span></span> <span data-ttu-id="ef47b-152">有关 SSL 的详细信息，请参阅在 Microsoft 帮助和支持网站[http://go.microsoft.com/fwlink/?LinkId=195798](http://go.microsoft.com/fwlink/?LinkId=195798)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-152">For more information about SSL, see Microsoft Help and Support Web site at [http://go.microsoft.com/fwlink/?LinkId=195798](http://go.microsoft.com/fwlink/?LinkId=195798).</span></span> <span data-ttu-id="ef47b-153">有关所有 SSO 服务器与 SSO 数据库之间使用 SSL 的详细信息，请参阅[如何为 SSO 启用 SSL](../core/how-to-enable-ssl-for-sso.md)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-153">For more information about using SSL between all the SSO servers and the SSO database, see [How to Enable SSL for SSO](../core/how-to-enable-ssl-for-sso.md).</span></span>  
  
## <a name="perimeter-network"></a><span data-ttu-id="ef47b-154">外围网络</span><span class="sxs-lookup"><span data-stu-id="ef47b-154">Perimeter Network</span></span>  
 <span data-ttu-id="ef47b-155">在运行 Internet 信息服务 (IIS) 和企业单一登录时，请遵循以下建议：</span><span class="sxs-lookup"><span data-stu-id="ef47b-155">When running Internet Information Services (IIS) and Enterprise Single Sign-On, follow these recommendations:</span></span>  
  
-   <span data-ttu-id="ef47b-156">如果 IIS 位于外围网络（也称为外围安全区域、DMZ 和外围子网）中，应在防火墙后面提供另一台 IIS 服务器以连接到 SSO 系统。</span><span class="sxs-lookup"><span data-stu-id="ef47b-156">If IIS is in a perimeter network (also known as demilitarized zone, DMZ, and screened subnet), provide another IIS server behind the firewall to connect to the SSO system.</span></span>  
  
-   <span data-ttu-id="ef47b-157">不要打开 IIS 上的远程过程调用 (RPC) 端口。</span><span class="sxs-lookup"><span data-stu-id="ef47b-157">Do not open the remote procedure calls (RPC) port on IIS.</span></span>  
  
## <a name="sql-server-access"></a><span data-ttu-id="ef47b-158">SQL Server 访问</span><span class="sxs-lookup"><span data-stu-id="ef47b-158">SQL Server Access</span></span>  
 <span data-ttu-id="ef47b-159">所有 SSO 服务器都需要访问 SQL Server SSO 数据库。</span><span class="sxs-lookup"><span data-stu-id="ef47b-159">All SSO servers access the SQL Server SSO database.</span></span> <span data-ttu-id="ef47b-160">有关如何为安全的 SQL Server 数据库的详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=33175](http://go.microsoft.com/fwlink/?LinkId=33175)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-160">For more information about how to secure SQL Server databases, see [http://go.microsoft.com/fwlink/?LinkId=33175](http://go.microsoft.com/fwlink/?LinkId=33175).</span></span>  
  
 <span data-ttu-id="ef47b-161">建议使用安全套接字层 (SSL) 和/或 Internet 协议安全性 (IPSec) 来保护 SSO 服务器和 SSO 数据库之间的数据传输的安全。</span><span class="sxs-lookup"><span data-stu-id="ef47b-161">It is recommended that you use Secure Sockets Layer (SSL) and/or Internet Protocol security (IPSec) to secure the transmission of data between the SSO servers and the SSO database.</span></span> <span data-ttu-id="ef47b-162">有关使用 SSL 的详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=195798](http://go.microsoft.com/fwlink/?LinkId=195798)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-162">For more information about using SSL, see [http://go.microsoft.com/fwlink/?LinkId=195798](http://go.microsoft.com/fwlink/?LinkId=195798).</span></span>  
  
 <span data-ttu-id="ef47b-163">若要仅为 SSO 服务器和 SSO 数据库之间的连接启用 SSL，可以使用 ssoconfig 实用工具在每个 SSO 服务器上设置 SSL 支持。</span><span class="sxs-lookup"><span data-stu-id="ef47b-163">To enable SSL for only the connection between the SSO server and the SSO database, you can set SSL support on every SSO server using the ssoconfig utility.</span></span> <span data-ttu-id="ef47b-164">此选项允许 SSO 在访问 SSO 数据库时始终使用 SSL。</span><span class="sxs-lookup"><span data-stu-id="ef47b-164">This option enables SSO to always use SSL when accessing the SSO database.</span></span> <span data-ttu-id="ef47b-165">有关详细信息，请参阅[如何为 SSO 启用 SSL](../core/how-to-enable-ssl-for-sso.md)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-165">For more information, see [How to Enable SSL for SSO](../core/how-to-enable-ssl-for-sso.md).</span></span>  
  
## <a name="strong-passwords"></a><span data-ttu-id="ef47b-166">强密码</span><span class="sxs-lookup"><span data-stu-id="ef47b-166">Strong Passwords</span></span>  
 <span data-ttu-id="ef47b-167">为所有帐户使用强密码非常重要，特别是对于作为 SSO Administrators 组成员的帐户，因为这些用户对整个 SSO 系统具有控制权。</span><span class="sxs-lookup"><span data-stu-id="ef47b-167">It is very important that you use strong passwords for all accounts, especially the accounts that are members of the SSO Administrators group, because these users have control over the entire SSO system.</span></span>  
  
## <a name="sso-administrator-accounts"></a><span data-ttu-id="ef47b-168">SSO 管理员帐户</span><span class="sxs-lookup"><span data-stu-id="ef47b-168">SSO Administrator Accounts</span></span>  
 <span data-ttu-id="ef47b-169">建议为在不同计算机上运行的 SSO 服务使用不同的服务帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-169">It is recommended that you use different service accounts for the SSO services running on different computers.</span></span> <span data-ttu-id="ef47b-170">对于 SSO 服务，不要使用执行管理操作（例如生成和备份密钥）的 SSO 管理员帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-170">You should not use the SSO administrator account that performs administration operations such as generating and backing up the secret for the SSO service.</span></span> <span data-ttu-id="ef47b-171">虽然 SSO 服务帐户不应为该计算机的本地管理员，但对于某些操作，执行管理操作的 SSO 管理员必须为该计算机的本地管理员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-171">While the SSO service accounts should not be local administrators on that computer, the SSO administrator that is performing administration operations must be a local administrator on the computer for some operations.</span></span>  
  
## <a name="master-secret-server"></a><span data-ttu-id="ef47b-172">主密钥服务器</span><span class="sxs-lookup"><span data-stu-id="ef47b-172">Master Secret Server</span></span>  
 <span data-ttu-id="ef47b-173">强烈建议保护主密钥服务器的安全并锁定该服务器。</span><span class="sxs-lookup"><span data-stu-id="ef47b-173">It is highly recommended that you secure and lock down the master secret server.</span></span> <span data-ttu-id="ef47b-174">不应使用此服务器作为处理服务器。</span><span class="sxs-lookup"><span data-stu-id="ef47b-174">You should not use this server as a processing server.</span></span> <span data-ttu-id="ef47b-175">此服务器的唯一用途应为存放主密钥。</span><span class="sxs-lookup"><span data-stu-id="ef47b-175">The only purpose of this server should be to hold the master secret.</span></span> <span data-ttu-id="ef47b-176">应确保此计算机的物理安全性，只有 SSO 管理员才可以访问此计算机。</span><span class="sxs-lookup"><span data-stu-id="ef47b-176">You should ensure the physical security of this computer and only SSO Administrators should have access to this computer.</span></span>  
  
## <a name="kerberos"></a><span data-ttu-id="ef47b-177">Kerberos</span><span class="sxs-lookup"><span data-stu-id="ef47b-177">Kerberos</span></span>  
 <span data-ttu-id="ef47b-178">SSO 支持 Kerberos，建议为 SSO 设置 Kerberos。</span><span class="sxs-lookup"><span data-stu-id="ef47b-178">SSO supports Kerberos, and it is recommended that you set up Kerberos for SSO.</span></span> <span data-ttu-id="ef47b-179">若要为 SSO 设置 Kerberos，必须为 SSO 服务注册安全主体名称 (SPN)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-179">To set up Kerberos with SSO, you must register a Secure Principal Name (SPN) for the SSO service.</span></span> <span data-ttu-id="ef47b-180">默认情况下，在设置 Kerberos 时，SSO 使用该 SPN 来验证使用 SSO 服务的组件。</span><span class="sxs-lookup"><span data-stu-id="ef47b-180">By default, when you setup Kerberos, SSO uses that SPN to authenticate the components using the SSO Service.</span></span> <span data-ttu-id="ef47b-181">建议在 SSO 管理辅助服务和 SSO 服务器之间设置 Kerberos 验证。</span><span class="sxs-lookup"><span data-stu-id="ef47b-181">It is recommended you set up Kerberos authentication between the SSO administrative subservices and the SSO server.</span></span> <span data-ttu-id="ef47b-182">也可以在 SSO 服务器之间以及 SSO 服务器和 SSO 数据库所在的 SQL Server 之间使用 Kerberos 验证。</span><span class="sxs-lookup"><span data-stu-id="ef47b-182">You can also user Kerberos authentication between the SSO servers and between the SSO servers and the SQL server where the SSO database is.</span></span>  
  
 <span data-ttu-id="ef47b-183">若要设置和验证 Kerberos，请使用 setspn 和 kerbtray 实用工具。</span><span class="sxs-lookup"><span data-stu-id="ef47b-183">To set up and verify Kerberos, you use the utilities setspn and kerbtray.</span></span> <span data-ttu-id="ef47b-184">有关这些实用工具的详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=33178](http://go.microsoft.com/fwlink/?LinkId=33178)。</span><span class="sxs-lookup"><span data-stu-id="ef47b-184">For more information about these utilities, see [http://go.microsoft.com/fwlink/?LinkId=33178](http://go.microsoft.com/fwlink/?LinkId=33178).</span></span>  
  
## <a name="delegation"></a><span data-ttu-id="ef47b-185">委派</span><span class="sxs-lookup"><span data-stu-id="ef47b-185">Delegation</span></span>  
 <span data-ttu-id="ef47b-186">在使用 [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] 或 [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] 时，可以使用约束委托，但建议不要使用委托来执行单一登录管理员的任务。</span><span class="sxs-lookup"><span data-stu-id="ef47b-186">When using [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] or [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)], it is possible to use constrained delegation, but it is recommended that you do not use delegation to perform the tasks of the Single Sign-On Administrator.</span></span> <span data-ttu-id="ef47b-187">同样，建议不要将其他任务或用户权限委托给单一登录管理员。</span><span class="sxs-lookup"><span data-stu-id="ef47b-187">Similarly, it is recommended that you do not delegate additional tasks or user rights to the Single Sign-On administrator.</span></span>  
  
## <a name="auditing"></a><span data-ttu-id="ef47b-188">审核</span><span class="sxs-lookup"><span data-stu-id="ef47b-188">Auditing</span></span>  
 <span data-ttu-id="ef47b-189">审核是跟踪环境中的信息的关键机制。</span><span class="sxs-lookup"><span data-stu-id="ef47b-189">Auditing is a critical mechanism for tracking information in your environment.</span></span> <span data-ttu-id="ef47b-190">企业单一登录 (SSO) 将对 SSO 数据库中执行的所有操作进行审核。</span><span class="sxs-lookup"><span data-stu-id="ef47b-190">Enterprise Single Sign-On (SSO) audits all operations performed in the SSO database.</span></span> <span data-ttu-id="ef47b-191">SSO 使用数据库自身的事件日志和审核日志。</span><span class="sxs-lookup"><span data-stu-id="ef47b-191">SSO uses event logs and audit logs of the database itself.</span></span> <span data-ttu-id="ef47b-192">SSO 为单一登录服务器提供了两种审核级别：</span><span class="sxs-lookup"><span data-stu-id="ef47b-192">SSO provides two audit levels for the Single Sign-On servers:</span></span>  
  
-   <span data-ttu-id="ef47b-193">成功审核级别审核成功的操作</span><span class="sxs-lookup"><span data-stu-id="ef47b-193">Positive auditing levels audit successful operations</span></span>  
  
-   <span data-ttu-id="ef47b-194">失败审核级别审核失败的操作</span><span class="sxs-lookup"><span data-stu-id="ef47b-194">Negative auditing levels audit operations that fail</span></span>  
  
 <span data-ttu-id="ef47b-195">SSO 管理员可以设置适合其公司策略的成功和失败审核级别。</span><span class="sxs-lookup"><span data-stu-id="ef47b-195">SSO administrators can set the positive and negative audit levels that suit their corporate policies.</span></span>  
  
 <span data-ttu-id="ef47b-196">您可以将成功和失败审核设置为以下级别之一：</span><span class="sxs-lookup"><span data-stu-id="ef47b-196">You can set positive and negative audits to one of the following levels:</span></span>  
  
 <span data-ttu-id="ef47b-197">0 = 无。</span><span class="sxs-lookup"><span data-stu-id="ef47b-197">0 = None.</span></span> <span data-ttu-id="ef47b-198">此级别不发出任何审核消息</span><span class="sxs-lookup"><span data-stu-id="ef47b-198">This level issues no audit messages</span></span>  
  
 <span data-ttu-id="ef47b-199">1 = 低</span><span class="sxs-lookup"><span data-stu-id="ef47b-199">1 = Low</span></span>  
  
 <span data-ttu-id="ef47b-200">2 = 中等</span><span class="sxs-lookup"><span data-stu-id="ef47b-200">2 = Medium</span></span>  
  
 <span data-ttu-id="ef47b-201">3 = 高。</span><span class="sxs-lookup"><span data-stu-id="ef47b-201">3 = High.</span></span> <span data-ttu-id="ef47b-202">此级别发出尽可能多的审核消息</span><span class="sxs-lookup"><span data-stu-id="ef47b-202">This level issues as many audit messages as possible</span></span>  
  
 <span data-ttu-id="ef47b-203">正审核的默认值为 0 （无）、 和负审核的默认值为 1 （低）。</span><span class="sxs-lookup"><span data-stu-id="ef47b-203">The default value for positive auditing is 0 (none), and the default value for negative auditing is 1 (low).</span></span> <span data-ttu-id="ef47b-204">根据 SSO 系统所需的审核级别，您可能需要更改这些值。</span><span class="sxs-lookup"><span data-stu-id="ef47b-204">You may want to change these values depending on the level of auditing you want for your SSO system.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="ef47b-205">企业单一登录审核发出由单一登录服务生成的消息。</span><span class="sxs-lookup"><span data-stu-id="ef47b-205">Enterprise Single Sign-On auditing issues messages generated by the Single Sign-On service.</span></span> <span data-ttu-id="ef47b-206">这不是安全审核，SSO 系统不会将该信息保存在事件日志的安全日志中。</span><span class="sxs-lookup"><span data-stu-id="ef47b-206">This is not a security audit, and the SSO system does not save the information in the security log of the Event Log.</span></span> <span data-ttu-id="ef47b-207">SSO 系统将 SSO 审核消息直接保存到应用程序事件日志中。</span><span class="sxs-lookup"><span data-stu-id="ef47b-207">The SSO system saves the SSO audit messages directly to the Application Event Log.</span></span>  
  
### <a name="database-level-auditing"></a><span data-ttu-id="ef47b-208">数据库级别的审核</span><span class="sxs-lookup"><span data-stu-id="ef47b-208">Database-Level Auditing</span></span>  
 <span data-ttu-id="ef47b-209">对于数据库级别的审核，SSO 系统在数据库的审核表中跟踪对 SSO 数据库执行的操作。</span><span class="sxs-lookup"><span data-stu-id="ef47b-209">For database-level auditing, the SSO system tracks the operations performed on the SSO database in the audit tables in the database.</span></span> <span data-ttu-id="ef47b-210">这些审核表的大小在 SSO 系统级别上进行定义。</span><span class="sxs-lookup"><span data-stu-id="ef47b-210">The size of these audit tables is defined at the SSO system level.</span></span> <span data-ttu-id="ef47b-211">您可以对已删除的关联应用程序、已删除的映射和所执行的凭据查找进行审核。</span><span class="sxs-lookup"><span data-stu-id="ef47b-211">You can audit for affiliate applications that are deleted, for mappings that are deleted, and for credential look-ups that are performed.</span></span> <span data-ttu-id="ef47b-212">默认情况下，审核表大小设置为 1,000 个条目。</span><span class="sxs-lookup"><span data-stu-id="ef47b-212">By default, the audit size is set to 1,000 entries.</span></span> <span data-ttu-id="ef47b-213">SSO 管理员可以更改此大小以符合其公司策略。</span><span class="sxs-lookup"><span data-stu-id="ef47b-213">SSO administrators can change this size to meet their corporate policies.</span></span>  
  
## <a name="using-sso-accounts"></a><span data-ttu-id="ef47b-214">使用 SSO 帐户</span><span class="sxs-lookup"><span data-stu-id="ef47b-214">Using SSO Accounts</span></span>  
 <span data-ttu-id="ef47b-215">本节包含在企业单一登录 (SSO) 系统中使用域和本地组以及个人帐户时的最佳实践。</span><span class="sxs-lookup"><span data-stu-id="ef47b-215">This section contains best practices when using domain and local groups and individual accounts in the Enterprise Single Sign-On (SSO) system.</span></span>  
  
### <a name="domain-windows-groups-and-accounts"></a><span data-ttu-id="ef47b-216">域 Windows 组和帐户</span><span class="sxs-lookup"><span data-stu-id="ef47b-216">Domain Windows Groups and Accounts</span></span>  
 <span data-ttu-id="ef47b-217">在使用域 Windows 组时，请考虑以下建议：</span><span class="sxs-lookup"><span data-stu-id="ef47b-217">When working with domain Windows groups, the following recommendations apply:</span></span>  
  
-   <span data-ttu-id="ef47b-218">使用域组和域帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-218">Use domain groups and domain accounts.</span></span>  
  
-   <span data-ttu-id="ef47b-219">使用 [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] 或 [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] 时，可将 ENTSSO 服务帐户配置为以 Network Service 帐户运行。</span><span class="sxs-lookup"><span data-stu-id="ef47b-219">When using [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] or [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]the ENTSSO service account can be configured to run under the Network Service account.</span></span> <span data-ttu-id="ef47b-220">不过，出于安全方面的原因建议不使用该配置，因为将来需要授予 Network Service 帐户 SSO 管理员权限。</span><span class="sxs-lookup"><span data-stu-id="ef47b-220">However, this is not recommended for security reasons, as the Network Service account will need to be given the SSO Administrators privilege.</span></span> <span data-ttu-id="ef47b-221">建议您为 ENTSSO 服务帐户使用唯一的域服务帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-221">It is recommended instead that you use a unique domain service account for the ENTSSO service account.</span></span>  
  
-   <span data-ttu-id="ef47b-222">为 SSO 管理员使用域组。</span><span class="sxs-lookup"><span data-stu-id="ef47b-222">Use a domain group for SSO administrators.</span></span> <span data-ttu-id="ef47b-223">不应将个人域帐户指定为 SSO 管理员，因为无法将此帐户从一个个人帐户更改为另一个个人帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-223">You should not specify an individual domain account as the SSO administrator, because you cannot change this account from one individual account to another individual account.</span></span>  
  
-   <span data-ttu-id="ef47b-224">虽然可以将个人域帐户指定为 SSO 关联管理员，但还是应使用域组。</span><span class="sxs-lookup"><span data-stu-id="ef47b-224">Although you can specify an individual domain account as the SSO affiliate administrator, you should use a domain group.</span></span>  
  
-   <span data-ttu-id="ef47b-225">虽然可以将个人域帐户指定为应用程序管理员，但还是应使用域组。</span><span class="sxs-lookup"><span data-stu-id="ef47b-225">Although you can specify an individual domain account as the application administrator, you should use a domain group.</span></span>  
  
-   <span data-ttu-id="ef47b-226">必须为应用程序用户帐户使用域组。</span><span class="sxs-lookup"><span data-stu-id="ef47b-226">You must use domain groups for the application user account.</span></span> <span data-ttu-id="ef47b-227">SSO 应用程序用户帐户不支持个人帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-227">The SSO applications user account does not support an individual account.</span></span>  
  
-   <span data-ttu-id="ef47b-228">可以为这些 SSO 访问帐户中的每一个访问帐户指定多个帐户。</span><span class="sxs-lookup"><span data-stu-id="ef47b-228">Multiple accounts can be specified for each of these SSO access accounts.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ef47b-229">另请参阅</span><span class="sxs-lookup"><span data-stu-id="ef47b-229">See Also</span></span>  
 <span data-ttu-id="ef47b-230">[企业单一登录服务器的端口](../core/ports-for-the-enterprise-single-sign-on-servers.md) </span><span class="sxs-lookup"><span data-stu-id="ef47b-230">[Ports for the Enterprise Single Sign-On Servers](../core/ports-for-the-enterprise-single-sign-on-servers.md) </span></span>  
 [<span data-ttu-id="ef47b-231">最低安全用户权限</span><span class="sxs-lookup"><span data-stu-id="ef47b-231">Minimum Security User Rights</span></span>](../core/minimum-security-user-rights.md)