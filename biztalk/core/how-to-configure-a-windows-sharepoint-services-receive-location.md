---
title: 如何配置 Windows SharePoint Services 接收位置 |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- receive locations, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], receive locations
- Windows SharePoint Services adapters, receive locations
ms.assetid: 5db3d5cf-4a77-4985-bd03-307c520247ec
caps.latest.revision: 23
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 22a23f97634eaba9dccccd099f7c39ba6af75d67
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22249877"
---
# <a name="how-to-configure-a-windows-sharepoint-services-receive-location"></a><span data-ttu-id="1c579-102">如何配置 Windows SharePoint Services 接收位置</span><span class="sxs-lookup"><span data-stu-id="1c579-102">How to Configure a Windows SharePoint Services Receive Location</span></span>
<span data-ttu-id="1c579-103">本主题介绍如何通过使用 BizTalk Server 管理控制台来创建和配置 Windows SharePoint Services 接收位置。</span><span class="sxs-lookup"><span data-stu-id="1c579-103">This topic describes how to create and configure a Windows SharePoint Services receive location by using the BizTalk Server Administration Console.</span></span>  
  
### <a name="to-create-and-configure-a-windows-sharepoint-services-receive-location"></a><span data-ttu-id="1c579-104">创建和配置 Windows SharePoint Services 接收位置</span><span class="sxs-lookup"><span data-stu-id="1c579-104">To create and configure a Windows SharePoint Services receive location</span></span>  
  
1.  <span data-ttu-id="1c579-105">确保已正确配置了接收端口。</span><span class="sxs-lookup"><span data-stu-id="1c579-105">Ensure you have a receive port properly configured.</span></span> <span data-ttu-id="1c579-106">有关如何创建和配置接收端口的信息，请参阅[如何创建接收端口](../core/how-to-create-a-receive-port.md)。</span><span class="sxs-lookup"><span data-stu-id="1c579-106">For information about how to create and configure a receive port, see [How to Create a Receive Port](../core/how-to-create-a-receive-port.md).</span></span>  
  
2.  <span data-ttu-id="1c579-107">在**BizTalk Server 管理控制台**，展开[!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]**管理**，展开**BizTalk 组 [GroupName]**，展开**应用程序**，然后展开要创建中的接收位置的应用程序。</span><span class="sxs-lookup"><span data-stu-id="1c579-107">In the **BizTalk Server Administration console**, expand [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)] **Administration**, expand **BizTalk Group [GroupName]**, expand **Applications**, and then expand the application you want to create a receive location in.</span></span>  
  
3.  <span data-ttu-id="1c579-108">右键单击**接收位置**，单击**新建**，然后单击**单向接收位置**。</span><span class="sxs-lookup"><span data-stu-id="1c579-108">Right-click **Receive Locations**, click **New**, and then click **One-way Receive Location**.</span></span>  
  
4.  <span data-ttu-id="1c579-109">选择接收端口，将包含此接收位置，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="1c579-109">Select the receive port that will contain this receive location, and then click **OK**.</span></span>  
  
5.  <span data-ttu-id="1c579-110">在**接收位置属性**对话框中，在**传输**中**类型**下拉列表框中，选择**Windows SharePoint Services**.</span><span class="sxs-lookup"><span data-stu-id="1c579-110">In the **Receive Location Properties** dialog box, under **Transport**, in the **Type** drop-down box, select **Windows SharePoint Services**.</span></span>  
  
6.  <span data-ttu-id="1c579-111">单击**配置**。</span><span class="sxs-lookup"><span data-stu-id="1c579-111">Click **Configure**.</span></span>  
  
7.  <span data-ttu-id="1c579-112">在**Windows SharePoint Services 传输属性**对话框框中，执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="1c579-112">In the **Windows SharePoint Services Transport Properties** dialog box, do the following:</span></span>  
  
    |<span data-ttu-id="1c579-113">使用此选项</span><span class="sxs-lookup"><span data-stu-id="1c579-113">Use this</span></span>|<span data-ttu-id="1c579-114">执行的操作</span><span class="sxs-lookup"><span data-stu-id="1c579-114">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="1c579-115">适配器 Web Services 端口</span><span class="sxs-lookup"><span data-stu-id="1c579-115">Adapter Web Service Port</span></span>|<span data-ttu-id="1c579-116">安装 Windows SharePoint Services 适配器 Web Services 的 IIS 网站的 HTTP 端口。</span><span class="sxs-lookup"><span data-stu-id="1c579-116">The HTTP port of the IIS Web site where the Windows SharePoint Services adapter Web service is installed.</span></span> <span data-ttu-id="1c579-117">默认情况下，这是默认的网站在端口 80 上配置。</span><span class="sxs-lookup"><span data-stu-id="1c579-117">By default, this is the Default Web Site configured on port 80.</span></span> <span data-ttu-id="1c579-118">如果在默认网站以外的任何 IIS Web 站点上配置了 Windows SharePoint Services Web 服务，你将需要更新此值。</span><span class="sxs-lookup"><span data-stu-id="1c579-118">If you have configured the Windows SharePoint Services Web service on any IIS Web site other than the Default Web Site, you will have to update this value.</span></span>|  
    |<span data-ttu-id="1c579-119">超时</span><span class="sxs-lookup"><span data-stu-id="1c579-119">Timeout</span></span>|<span data-ttu-id="1c579-120">对 Windows SharePoint Services 适配器 Web Services 进行的适配器运行时 Web Services 调用的超时值（以毫秒计）。</span><span class="sxs-lookup"><span data-stu-id="1c579-120">The time-out, in milliseconds, for the adapter runtime Web service calls made to the Windows SharePoint Services adapter Web service.</span></span> <span data-ttu-id="1c579-121">如果消息或批的大小超过适配器预期的平均大小，则可能需要增加此值。</span><span class="sxs-lookup"><span data-stu-id="1c579-121">You may need to increase this value if the message or batch size is higher than the average that is expected by the adapter.</span></span>|  
    |<span data-ttu-id="1c579-122">存档文件名</span><span class="sxs-lookup"><span data-stu-id="1c579-122">Archive Filename</span></span>|<span data-ttu-id="1c579-123">（可选）存档的文件 Windows SharePoint Services 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="1c579-123">(Optional) The archived file Windows SharePoint Services file name.</span></span> <span data-ttu-id="1c579-124">您可以键入如“PurchaseOrder0001.xml”之类的文本值，也可以键入表达式。</span><span class="sxs-lookup"><span data-stu-id="1c579-124">You can type in a literal value like 'PurchaseOrder0001.xml' or an expression.</span></span> <span data-ttu-id="1c579-125">表达式可以包括文本、宏和 XPATH 查询的任意组合。</span><span class="sxs-lookup"><span data-stu-id="1c579-125">Expressions can include any mix of literals, macros, and XPATH queries.</span></span> <span data-ttu-id="1c579-126">例如，“PurchOrd-%XPATH=//po:PurchaseOrderId%-%MessageID%.xml”。</span><span class="sxs-lookup"><span data-stu-id="1c579-126">For example, "PurchOrd-%XPATH=//po:PurchaseOrderId%-%MessageID%.xml".</span></span> <span data-ttu-id="1c579-127">如果没有提供文件名，则会使用源文件的名称。</span><span class="sxs-lookup"><span data-stu-id="1c579-127">When no file name is supplied the file name of source file is used.</span></span> <span data-ttu-id="1c579-128">有关表达式的详细信息，请参阅[Windows SharePoint Services 适配器表达式](../core/windows-sharepoint-services-adapter-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="1c579-128">For more information about expressions, see [Windows SharePoint Services Adapter Expressions](../core/windows-sharepoint-services-adapter-expressions.md).</span></span> <span data-ttu-id="1c579-129">**注意：** 按此字段不支持的"%sendingorchestrationid%"和"%sendingorchestrationtype%"宏。</span><span class="sxs-lookup"><span data-stu-id="1c579-129">**Note:**  The "%SendingOrchestrationID%" and "%SendingOrchestrationType%" macros are not supported by this field.</span></span>|  
    |<span data-ttu-id="1c579-130">存档位置 URL</span><span class="sxs-lookup"><span data-stu-id="1c579-130">Archive Location URL</span></span>|<span data-ttu-id="1c579-131">Windows SharePoint Services 文件夹 URL（相对于用来对所处理的文件进行存档的 SharePoint 站点）。</span><span class="sxs-lookup"><span data-stu-id="1c579-131">The Windows SharePoint Services folder URL, relative to the SharePoint site, where the processed files are archived.</span></span> <span data-ttu-id="1c579-132">例如，存档或共享文档/处理订单 /。</span><span class="sxs-lookup"><span data-stu-id="1c579-132">For example, Archive or /Shared Documents/Processed Orders/.</span></span> <span data-ttu-id="1c579-133">如果未指定的存档位置，则适配器进行处理之后被删除该文档。</span><span class="sxs-lookup"><span data-stu-id="1c579-133">If an archive location is not specified, the document is deleted after being processed by the adapter.</span></span> <span data-ttu-id="1c579-134">**注意：** 有时 SharePoint 文档库中或文件夹的 URL 是不同于项的名称。</span><span class="sxs-lookup"><span data-stu-id="1c579-134">**Note:**  Sometimes the SharePoint document library, or folder URL is different from the name of that item.</span></span> <span data-ttu-id="1c579-135">请查看 Internet Explorer 的地址栏以确定正确的 URL。</span><span class="sxs-lookup"><span data-stu-id="1c579-135">Check the address bar in Internet Explorer to discover the correct URL.</span></span>|  
    |<span data-ttu-id="1c579-136">存档覆盖</span><span class="sxs-lookup"><span data-stu-id="1c579-136">Archive Overwrite</span></span>|<span data-ttu-id="1c579-137">确定是否覆盖存档中的现有文件。</span><span class="sxs-lookup"><span data-stu-id="1c579-137">Determines whether existing files in the archive are overwritten.</span></span> <span data-ttu-id="1c579-138">选择“是”将覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="1c579-138">Select "Yes" to overwrite existing files.</span></span> <span data-ttu-id="1c579-139">如果选择“否”，当存档位置中已经存在具有相同名称的文件时，存档将失败。</span><span class="sxs-lookup"><span data-stu-id="1c579-139">Select "No" for the archive to fail if a file with the same name already exists in the archive.</span></span> <span data-ttu-id="1c579-140">在这种情况下，文件将保持签出状态，必须对其进行手动存档。</span><span class="sxs-lookup"><span data-stu-id="1c579-140">In this case the file will remain checked out and it will have to be archived manually.</span></span> <span data-ttu-id="1c579-141">**注意：** 时存档文件，我们建议你使用的存档文件名值使用宏以使文件名唯一。</span><span class="sxs-lookup"><span data-stu-id="1c579-141">**Note:**  When archiving files, we recommend that you use Archive Filename values with macros in order to make the file name unique.</span></span> <span data-ttu-id="1c579-142">为此，可以使用类似于 PO-%MessageID%.xml 或 PO-%XPATH=//ns0:PurchaseOrder/ns0:ID%.xml（其中 ID 是采购订单的唯一 ID）这样的存档文件名。</span><span class="sxs-lookup"><span data-stu-id="1c579-142">For this purpose you could use an Archive Filename such as PO-%MessageID%.xml or PO-%XPATH=//ns0:PurchaseOrder/ns0:ID%.xml, where ID is the unique ID of the purchase order.</span></span>|  
    |<span data-ttu-id="1c579-143">批大小</span><span class="sxs-lookup"><span data-stu-id="1c579-143">Batch Size</span></span>|<span data-ttu-id="1c579-144">最大 Windows SharePoint Services 消息传送适配器 Web 服务将处理作为批处理的文档数。</span><span class="sxs-lookup"><span data-stu-id="1c579-144">The maximum number of documents that the Windows SharePoint Services Messaging Adapter Web service will process as a batch.</span></span> <span data-ttu-id="1c579-145">处理批次可能包含比定义的批处理大小; 较少消息但是，它将永远不会包含更多的消息。</span><span class="sxs-lookup"><span data-stu-id="1c579-145">A processed batch might contain fewer messages than the defined batch size; however, it will never contain more messages.</span></span>|  
    |<span data-ttu-id="1c579-146">错误阈值</span><span class="sxs-lookup"><span data-stu-id="1c579-146">Error Threshold</span></span>|<span data-ttu-id="1c579-147">适配器允许遇到的最大连续轮询失败次数，到达最大次数后将禁用该接收位置。</span><span class="sxs-lookup"><span data-stu-id="1c579-147">The maximum number of consecutive polling failures encountered by the adapter until the receive location is disabled.</span></span> <span data-ttu-id="1c579-148">若要永不禁用该接收位置，请将此字段设置为 0。</span><span class="sxs-lookup"><span data-stu-id="1c579-148">Set this field to 0 in order to never disable the receive location.</span></span>|  
    |<span data-ttu-id="1c579-149">命名空间别名</span><span class="sxs-lookup"><span data-stu-id="1c579-149">Namespaces Aliases</span></span>|<span data-ttu-id="1c579-150">（可选）以逗号或分号分隔的命名空间别名定义列表。</span><span class="sxs-lookup"><span data-stu-id="1c579-150">(Optional) A comma or semicolon-delimited list of namespace aliases definitions.</span></span> <span data-ttu-id="1c579-151">使用此字段来定义由在存档文件名字段中引入的 XPATH 查询的命名空间别名。</span><span class="sxs-lookup"><span data-stu-id="1c579-151">Use this field to define the namespace aliases that are used by the XPATH queries introduced in the Archive Filename field.</span></span> <span data-ttu-id="1c579-152">例如，po='http://OrderProcess/POrder', conf='http://OrderProcess/Confirmation' ipsol='{D8217CF1-4EF7-4bb5-A30D-765ECB09E0D9}'</span><span class="sxs-lookup"><span data-stu-id="1c579-152">For example, po='http://OrderProcess/POrder', conf='http://OrderProcess/Confirmation' ipsol='{D8217CF1-4EF7-4bb5-A30D-765ECB09E0D9}'</span></span>|  
    |<span data-ttu-id="1c579-153">轮询间隔</span><span class="sxs-lookup"><span data-stu-id="1c579-153">Polling Interval</span></span>|<span data-ttu-id="1c579-154">时间间隔，以秒为单位，两个连续查询执行的任何新的消息可用于处理的适配器之间。</span><span class="sxs-lookup"><span data-stu-id="1c579-154">The time interval, in seconds, between two consecutive queries performed by the adapter to see if any new messages are available for processing.</span></span> <span data-ttu-id="1c579-155">**注意：** 指定较低的值会缩短适配器的吞吐量和响应时间。</span><span class="sxs-lookup"><span data-stu-id="1c579-155">**Note:**  Specifying a lower value improves the throughput and response time for the adapter.</span></span>|  
    |<span data-ttu-id="1c579-156">SharePoint 站点 URL</span><span class="sxs-lookup"><span data-stu-id="1c579-156">SharePoint Site URL</span></span>|<span data-ttu-id="1c579-157">Windows SharePoint Services 网站的完整 URL。</span><span class="sxs-lookup"><span data-stu-id="1c579-157">The complete URL of the Windows SharePoint Services Web site.</span></span> <span data-ttu-id="1c579-158">例如，http://BizTalkServer/sites/TestSite。</span><span class="sxs-lookup"><span data-stu-id="1c579-158">For example, http://BizTalkServer/sites/TestSite.</span></span> <span data-ttu-id="1c579-159">**注意：** 对要发送的 URI 端口或接收位置不能超过 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="1c579-159">**Note:**  The URI for a send port or receive location cannot exceed 256 characters.</span></span>|  
    |<span data-ttu-id="1c579-160">源文档库 URL</span><span class="sxs-lookup"><span data-stu-id="1c579-160">Source Document Library URL</span></span>|<span data-ttu-id="1c579-161">这是 Windows SharePoint Services 文档库的 URL（相对于在其中检索文档的 SharePoint 站点）。</span><span class="sxs-lookup"><span data-stu-id="1c579-161">This is the URL of the Windows SharePoint Services document library, relative to the SharePoint site, where the documents are retrieved.</span></span> <span data-ttu-id="1c579-162">例如，/Shared Documents/ 或 /New Purchase Orders/。</span><span class="sxs-lookup"><span data-stu-id="1c579-162">For example, /Shared Documents/ or /New Purchase Orders/.</span></span> <span data-ttu-id="1c579-163">**注意：** 无法从 SharePoint 列表中接收消息。</span><span class="sxs-lookup"><span data-stu-id="1c579-163">**Note:**  You cannot receive messages from a SharePoint list.</span></span> <span data-ttu-id="1c579-164">除非使用显示所有文件夹中的消息的视图，否则您无法从 SharePoint 文件夹接收消息。</span><span class="sxs-lookup"><span data-stu-id="1c579-164">You cannot receive messages from a SharePoint folder unless using a view which shows the messages in all folders.</span></span> <span data-ttu-id="1c579-165">若要这样做你设置**文件夹**属性的值的**显示但文件夹不显示所有文档**创建视图时。</span><span class="sxs-lookup"><span data-stu-id="1c579-165">To do this you set the **Folders** property to a value of **Show all documents without folders** when creating a view.</span></span> <span data-ttu-id="1c579-166">**注意：** 有时的 SharePoint 文档库是不同于项的名称。</span><span class="sxs-lookup"><span data-stu-id="1c579-166">**Note:**  Sometimes the SharePoint document library is different from the name of that item.</span></span> <span data-ttu-id="1c579-167">请查看 Internet Explorer 的地址栏以确定正确的 URL。</span><span class="sxs-lookup"><span data-stu-id="1c579-167">Check the address bar in Internet Explorer to discover the correct URL.</span></span>|  
    |<span data-ttu-id="1c579-168">视图名称</span><span class="sxs-lookup"><span data-stu-id="1c579-168">View Name</span></span>|<span data-ttu-id="1c579-169">这是 Windows SharePoint Services 使用视图来筛选由适配器处理的文档。</span><span class="sxs-lookup"><span data-stu-id="1c579-169">This is the Windows SharePoint Services view used to filter documents processed by the adapter.</span></span> <span data-ttu-id="1c579-170">例如，批准订单。</span><span class="sxs-lookup"><span data-stu-id="1c579-170">For example, Approved Orders.</span></span> <span data-ttu-id="1c579-171">将此字段留空以处理源文档库中的所有现有文档。</span><span class="sxs-lookup"><span data-stu-id="1c579-171">Leave this field empty to process all the existing documents in the source document library.</span></span> <span data-ttu-id="1c579-172">适配器将不处理的视图，这些文件夹中包含的消息中显示的文件夹。</span><span class="sxs-lookup"><span data-stu-id="1c579-172">Folders showing up in a view and the messages contained in those folders will not be processed by the adapter.</span></span> <span data-ttu-id="1c579-173">你可以创建平面视图将显示平面结构包括的子文件夹中现有的文档中的所有文档。</span><span class="sxs-lookup"><span data-stu-id="1c579-173">You can create flat views that will show all documents in a flat structure including documents existing in subfolders.</span></span> <span data-ttu-id="1c579-174">**注意：** 平面视图中的所有消息都得到都处理。</span><span class="sxs-lookup"><span data-stu-id="1c579-174">**Note:**  All messages in a flat view will be processed.</span></span>|  
    |<span data-ttu-id="1c579-175">Microsoft Office 集成</span><span class="sxs-lookup"><span data-stu-id="1c579-175">Microsoft Office Integration</span></span>|<span data-ttu-id="1c579-176">选择“可选”将尽可能尝试删除 InfoPath 处理指令，如果不能删除（例如，二进制文档），则按原样处理。</span><span class="sxs-lookup"><span data-stu-id="1c579-176">"Optional" to attempt to remove InfoPath processing instructions if possible or to process as is if not possible (for instance, a binary document).</span></span> <span data-ttu-id="1c579-177">选择“是”将删除 InfoPath 处理指令，如果出现错误，则跳过该消息。</span><span class="sxs-lookup"><span data-stu-id="1c579-177">Choose "Yes" to remove InfoPath processing instructions or to skip the message in case of an error.</span></span> <span data-ttu-id="1c579-178">选择“否”将按原样处理文档。</span><span class="sxs-lookup"><span data-stu-id="1c579-178">Choose "No" to process the document "as is."</span></span> <span data-ttu-id="1c579-179">对于二进制消息，必须使用“否”或“可选”值。</span><span class="sxs-lookup"><span data-stu-id="1c579-179">For binary messages, you must use “No” or “Optional” values.</span></span>|  
  
8.  <span data-ttu-id="1c579-180">单击 **“确定”**。</span><span class="sxs-lookup"><span data-stu-id="1c579-180">Click **OK**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1c579-181">另请参阅</span><span class="sxs-lookup"><span data-stu-id="1c579-181">See Also</span></span>  
 <span data-ttu-id="1c579-182">[如何配置 Windows SharePoint Services 发送处理程序](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="1c579-182">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="1c579-183">[如何配置 Windows SharePoint Services 发送端口](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="1c579-183">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="1c579-184">[如何创建发送端口](../core/how-to-create-a-send-port2.md) </span><span class="sxs-lookup"><span data-stu-id="1c579-184">[How to Create a Send Port](../core/how-to-create-a-send-port2.md) </span></span>  
 <span data-ttu-id="1c579-185">[Windows SharePoint Services 适配器属性参考](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="1c579-185">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 <span data-ttu-id="1c579-186">[Windows SharePoint Services 适配器表达式](../core/windows-sharepoint-services-adapter-expressions.md) </span><span class="sxs-lookup"><span data-stu-id="1c579-186">[Windows SharePoint Services Adapter Expressions](../core/windows-sharepoint-services-adapter-expressions.md) </span></span>  
 [<span data-ttu-id="1c579-187">支持的 Windows SharePoint Services 列类型</span><span class="sxs-lookup"><span data-stu-id="1c579-187">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)