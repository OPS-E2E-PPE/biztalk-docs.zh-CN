---
title: EDI 类型 （数据元素） 验证 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: cd53685f-a49c-41c8-813e-29700fc0b62b
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 22dd511711a8ec2245c1196e5865f574cf47fc08
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65389145"
---
# <a name="edi-type-data-element-validation"></a>EDI 类型 （数据元素） 验证
EDI 接收管道和 EDI 发送管道对事务集数据元素执行 EDI 验证。 对于所有消息都进出特定参与方，通过该参与方的协议属性上配置此验证**验证**页 (下**事务集设置**X12 的部分或 EDIFACT 协议）。 如果**EDI 类型验证**属性中未选定**验证**页上，将不会执行本主题中所述的验证的数据。  
  
 选择针对传入消息和传出消息启用 EDI 类型验证**EDI 类型验证**属性中的**验证**中的双向协议选项卡页**协议属性**对话框。 对于传入和传出消息，此属性会选择默认情况下，以便默认启用 EDI 验证。  
  
## <a name="validation-checks"></a>验证检查  
 当 EDI 接收管道或 EDI 发送管道执行 EDI 验证时，它验证下列各项：  
  
- 架构的 EDI 属性定义数据类型  
  
- 长度限制  
  
- 空数据元素和尾部分隔符  
  
  > [!NOTE]
  >  此验证不会检查代码集 （枚举） 或发生最小值或最大值。  
  
  **字符集**  
  
  若要执行 EDI 数据元素验证，EDI 接收和发送管道要求按如下方式建立字符集：  
  
- 对于 EDIFACT，数据元素中建立字符集**UNB1**的**字符集和分隔符**的单向协议选项卡的页面**协议属性**对话框中或**EDIFACT 后备设置**对话框 （如果尚未建立任何协议）。  
  
- 对于 KEDIFACT，数据元素中建立字符**UNB1**的**字符集和分隔符**的单向协议选项卡的页面**协议属性**对话框框中，与 EDIFACT 一样。 值**UNB1.1**元素必须设置为`KECA`。  
  
- 对于 X12，消息在管道属性中建立字符集。  
  
  > [!NOTE]
  >  当 BizTalk 运行时执行的一条消息的 EDI 验证时，它将使用 X12 字符集在管道属性中选择的设置。 但是的页中输入的属性的验证**协议属性**使用在所选的字符集执行对话框**字符集和分隔符**该对话框的页。 在运行时，管道将忽略此值的 x12 字符集属性**字符集和分隔符**页**协议属性**对话框。 如果这两个设置不相同 (即，X12 字符集属性中**协议属性**对话框的设置为**扩展**，而管道属性中的字符属性设置为 X12**基本**)，则可能发生验证错误消息。  
  
  **数据类型验证**  
  
  对于 X12，以下 EDI 数据类型在验证的架构中批注中接收或发送管道的拆装器/组装器组件：数字、 十进制、 标识符、 字符串、 日期、 时间、 二进制和复合。  
  
  对于 EDIFACT，在验证的架构中接收或发送管道中的拆装器/组装器组件批注以下 EDI 数据类型：字母、 数字、 标识符、 字符串和复合。  
  
  **长度限制**  
  
  对于 X12 和 EDIFACT，元素或子元素必须验证的长度 （最小和最大） 要求。 长度定义为使用的字符位置数。 长度不包括符号和十进制符号。  
  
> [!NOTE]
>  对于 X12_AN 字符串数据类型，保留前导空格和尾随空格允许在任何段中以满足最小长度要求。  
  
 对于 KECA，长度解释为字节数。 例如，如果长度定义为三个，该元素或子元素可以包括三个单字节字符或一个双字节字符和一个单字节字符的组合。  
  
 **空数据元素和尾部分隔符验证**  
  
 对于 X12，如果段存在不能为空实例中标记为必需数据元素。 复合数据元素是否至少一个组件数据元素必须是值。  
  
 对于 EDIFACT，非值和条件的数据元素 （和子组件） 可以不包括;但是，保留分隔符。  
  
 尾部分隔符对于 X12 或 EDIFACT，不是必需，但建议。  
  
## <a name="when-edi-type-validation-is-disabled"></a>当禁用 EDI 类型验证时  
 如果停用 EDI 类型验证，EDI 接收管道或 EDI 发送管道将处理而不会挂起正在处理的消息由 EDI 类型验证查出有错的数据元素。  
  
> [!NOTE]
>  即使禁用 EDI 类型验证，则会执行 EDI 结构验证。 未通过基本结构验证的交换将挂起，即使禁用 EDI 类型验证。  
  
 下面是一些将处理而不会导致消息挂起的错误：  
  
- 意外/未定义事务集  
  
- 段/循环和数据元素级别上意外/未定义的数据  
  
- 可选性 （最小值和最大发生） 段/循环和数据元素级别  
  
- 在数据元素级别 （数据长度超出最大级别或低于最小级别） 的长度 （最小/最大） 违规  
  
- （ID 数据类型除外，它具有其自己的控件） 的数据元素级别的数据类型不匹配  
  
- 数据元素级别的无效枚举列表。  
  
  如果禁用在接收端，但在发送端启用 EDI 类型验证，EDI 发送管道不能将重新处理成有效的 EDI 文件生成由接收管道，如果 XML 文件包含错误的 XML。 因此，发送管道将生成错误。  
  
  如果禁用 EDI 类型验证，EDI 接收管道或发送管道将处理错误，如下所示：  
  
|||  
|-|-|  
|意外的数据|操作|  
|意外/未定义事务集|EDI 接收或发送管道将接受事务集。 即使尚未部署的架构，该|  
|意外的段/记录|接收管道将生成具有相应的前缀的标记：\<UnexpectedSegment_ _ %segmentid%\>。<br /><br /> 发送管道将使用第一个 XML 标记名称的一到三个字符作为段名称。|  
|意外简单数据元素|接收管道将生成具有前缀、 段标识符和表示数据元素的位置的段中索引的 XML 标记： < UnexpectedDataElement_ _ %fieldname%。|  
|意外复合数据元素|接收管道将生成一个 XML 前缀、 段标识符和表示数据元素在段中的所处位置的索引的标记： < UnexpectedCompositeDataElement_ _ %fieldname%。|  
|缺少所需的数据|管道会将数据视为可选。|  
|数据元素长度违规|管道会将无效的数据元素长度视为有效 (最小值 = 0，最大 = 不受限制)。|  
|（适用于 ID 数据类型） 的实例中的无效枚举值|管道将忽略错误并继续进行处理。|  
|实例中的 Max 违规|管道会将此类重复数据视为有效 (最小出现次数 = 0，最大出现次数 = 不受限制)。|  
  
 **错误报告**  
  
 当关闭 EDI 类型验证时，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]不会报告错误在事件查看器中，但会报告警告。 此外，确认报告将接受回源参与方，AK501 和 AK901 设置为"E"在 X12 997 或 UCI.4、 UCM.3 和 ucf.4 设置为"7"EDIFACT CONTRL 中。 因此，将消除在将来传输中进行纠正的任何机会。 但是，消息接收方必须更正通过手动干预文档而不是拒绝或挂起消息。 此外，`Edi.ErrorsInTransactionSet`会升级上下文属性，如果以上任一错误遇到的 EDI 接收管道。 如果遇到 EDI 或扩展验证错误，此属性将升级为"True"。 如果没有遇到错误时，该属性将升级为"False"。  
  
 如果接收或发送管道遇到意外的数据，它将报告父级别错误，并忽略子级别错误，如下所示：  
  
|||  
|-|-|  
|意外的数据|操作|  
|意外的事务集|确认报告此错误，并忽略段/循环和数据元素级别的后续错误|  
|意外的段/循环|确认报告此错误，并忽略数据元素级别的错误。|  
|意外的数据元素|确认报告此错误，并忽略与属性，如 ID、 长度、 出现次数等相关的复合错误） 和 （如果适用） 到复合数据元素字段相关的错误。|  
  
## <a name="see-also"></a>请参阅  
 [EDI 消息验证](../core/edi-message-validation.md)   
 [扩展 (BTS-XSD) 验证](../core/extended-bts-xsd-validation.md)