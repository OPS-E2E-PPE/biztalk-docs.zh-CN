---
title: 脚本 Functoid |Microsoft 文档
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Scripting functoids, about Scripting functoids
- Scripting functoids
- Scripting functoids, configuring
ms.assetid: ea8353da-049b-4e0c-a700-f51708db22a3
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 822bdbc4482a7e16a7458c7c44d128967203f283
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
ms.locfileid: "22273333"
---
# <a name="scripting-functoid"></a><span data-ttu-id="37831-102">“脚本”Functoid</span><span class="sxs-lookup"><span data-stu-id="37831-102">Scripting Functoid</span></span>
<span data-ttu-id="37831-103">**脚本**functoid，可使用自定义脚本或代码在运行时执行功能不可用。</span><span class="sxs-lookup"><span data-stu-id="37831-103">The **Scripting** functoid enables you to use custom script or code at run time to perform functions otherwise not available.</span></span> <span data-ttu-id="37831-104">例如，你可以在运行时的.NET 程序集使用调用**脚本**functoid 和编写您自己的自定义函数。</span><span class="sxs-lookup"><span data-stu-id="37831-104">For example, you can call a .NET assembly at run time by using the **Scripting** functoid and writing your own custom functions.</span></span>  
  
 <span data-ttu-id="37831-105">**脚本**functoid 支持以下语言：</span><span class="sxs-lookup"><span data-stu-id="37831-105">The **Scripting** functoid supports the following languages:</span></span>  
  
-   <span data-ttu-id="37831-106">C# .NET</span><span class="sxs-lookup"><span data-stu-id="37831-106">C# .NET</span></span>  
  
-   <span data-ttu-id="37831-107">JScript .NET</span><span class="sxs-lookup"><span data-stu-id="37831-107">JScript .NET</span></span>  
  
-   <span data-ttu-id="37831-108">Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="37831-108">Visual Basic .NET</span></span>  
  
-   <span data-ttu-id="37831-109">可扩展样式表语言转换 (XSLT)</span><span class="sxs-lookup"><span data-stu-id="37831-109">Extensible Stylesheet Language Transformations (XSLT)</span></span>  
  
-   <span data-ttu-id="37831-110">XSLT 调用模板</span><span class="sxs-lookup"><span data-stu-id="37831-110">XSLT Call Templates</span></span>  
  
 <span data-ttu-id="37831-111">当前的另一个显著区别**脚本**functoid 及更早版本是脚本需要不再是创建并存储在 functoid 本身。</span><span class="sxs-lookup"><span data-stu-id="37831-111">Another significant difference between the current **Scripting** functoid and earlier versions is that the script need no longer be created and stored in the functoid itself.</span></span> <span data-ttu-id="37831-112">相反，你可以在单独的.NET 程序集创建脚本，并引用程序集通过**脚本**属性。</span><span class="sxs-lookup"><span data-stu-id="37831-112">Instead, you can create the script in a separate .NET assembly and reference the assembly through the **Script** property.</span></span> <span data-ttu-id="37831-113">在单独的程序集中保存脚本使您能够在多个映射中使用同一脚本。</span><span class="sxs-lookup"><span data-stu-id="37831-113">Having the script in a separate assembly enables you to use the same script in more than one map.</span></span> <span data-ttu-id="37831-114">此外，你可能能够购买**脚本**functoid 第三方供应商提供的程序集。</span><span class="sxs-lookup"><span data-stu-id="37831-114">Additionally, you may be able to purchase **Scripting** functoid assemblies from third-party vendors.</span></span>  
  
 <span data-ttu-id="37831-115">你可以使用**脚本**创建在 BizTalk 映射程序的当前版本的以前版本的 BizTalk 映射程序 functoid。</span><span class="sxs-lookup"><span data-stu-id="37831-115">You can use **Scripting** functoids created in previous versions of BizTalk Mapper with the current version of BizTalk Mapper.</span></span> <span data-ttu-id="37831-116">但是，必须首先迁移这些 functoid。</span><span class="sxs-lookup"><span data-stu-id="37831-116">However, you must migrate the functoids first.</span></span> <span data-ttu-id="37831-117">有关详细信息，有关如何迁移**脚本**functoid，请参阅[迁移 Functoid](../core/migrating-functoids.md)。</span><span class="sxs-lookup"><span data-stu-id="37831-117">For more information about how to migrate **Scripting** functoids, see [Migrating Functoids](../core/migrating-functoids.md).</span></span>  
  
 <span data-ttu-id="37831-118">当你将添加**脚本**functoid 到图中的，你需要配置 functoid 使用的脚本。</span><span class="sxs-lookup"><span data-stu-id="37831-118">When you add a **Scripting** functoid to a map, you need to configure the script the functoid uses.</span></span> <span data-ttu-id="37831-119">如果你选择**脚本**functoid，**脚本**在中启用属性**属性**窗口。</span><span class="sxs-lookup"><span data-stu-id="37831-119">If you select a **Scripting** functoid, the **Script** property is enabled in the **Properties** window.</span></span> <span data-ttu-id="37831-120">如果单击省略号 (**...**) 为此属性的按钮**配置脚本 Functoid**对话框随即打开。</span><span class="sxs-lookup"><span data-stu-id="37831-120">If you click the ellipsis (**...**) button for this property, the **Configure Scripting Functoid** dialog box opens.</span></span> <span data-ttu-id="37831-121">或者，你可以双击**脚本**functoid。</span><span class="sxs-lookup"><span data-stu-id="37831-121">Alternatively, you can double-click the **Scripting** functoid.</span></span>  
  
 <span data-ttu-id="37831-122">下表显示了此对话框的字段：</span><span class="sxs-lookup"><span data-stu-id="37831-122">The following table shows the fields of this dialog box.</span></span>  
  
|<span data-ttu-id="37831-123">配置脚本 Functoid 对话框框字段</span><span class="sxs-lookup"><span data-stu-id="37831-123">Configure Scripting Functoid dialog box field</span></span>|<span data-ttu-id="37831-124">Description</span><span class="sxs-lookup"><span data-stu-id="37831-124">Description</span></span>|  
|---------------------------------------------------|-----------------|  
|<span data-ttu-id="37831-125">**选择脚本类型**</span><span class="sxs-lookup"><span data-stu-id="37831-125">**Select script type**</span></span>|<span data-ttu-id="37831-126">使用此字段来选择你想要使用此脚本的类型**脚本**functoid。</span><span class="sxs-lookup"><span data-stu-id="37831-126">Use this field to select the type of script you want to use in this **Scripting** functoid.</span></span><br /><br /> <span data-ttu-id="37831-127">值：</span><span class="sxs-lookup"><span data-stu-id="37831-127">Values:</span></span><br /><br /> <span data-ttu-id="37831-128">-   **外部程序集**。</span><span class="sxs-lookup"><span data-stu-id="37831-128">-   **External Assembly**.</span></span> <span data-ttu-id="37831-129">使用此值，如果你想要关联**脚本**functoid 与在全局程序集缓存 (GAC) 中的程序集。</span><span class="sxs-lookup"><span data-stu-id="37831-129">Use this value if you want to associate the **Scripting** functoid with an assembly in the global assembly cache (GAC).</span></span> <span data-ttu-id="37831-130">**警告：** 外部程序集中的代码必须是线程安全。</span><span class="sxs-lookup"><span data-stu-id="37831-130">**Warning:**      The code in the external assembly must be thread-safe.</span></span> <span data-ttu-id="37831-131">在任务繁忙时，可以同时运行多个映射实例。</span><span class="sxs-lookup"><span data-stu-id="37831-131">Under stress conditions, multiple instances of a map may be running concurrently.</span></span><br /><span data-ttu-id="37831-132">-   **内联 C#**。</span><span class="sxs-lookup"><span data-stu-id="37831-132">-   **Inline C#**.</span></span>  <span data-ttu-id="37831-133">使用此值，如果你想要关联**脚本**包含 C# 代码中的 functoid**内联脚本**缓冲区。</span><span class="sxs-lookup"><span data-stu-id="37831-133">Use this value if you want to associate the **Scripting** functoid with C# code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="37831-134">-   **内联 JScript.NET**。</span><span class="sxs-lookup"><span data-stu-id="37831-134">-   **Inline JScript .NET**.</span></span> <span data-ttu-id="37831-135">使用此值，如果你想要关联**脚本**与中的 JScript.NET 脚本 functoid**内联脚本**缓冲区。</span><span class="sxs-lookup"><span data-stu-id="37831-135">Use this value if you want to associate the **Scripting** functoid with JScript .NET script in the **Inline script** buffer.</span></span><br /><span data-ttu-id="37831-136">-   **内联 Visual 基本.NET**。</span><span class="sxs-lookup"><span data-stu-id="37831-136">-   **Inline Visual Basic .NET**.</span></span> <span data-ttu-id="37831-137">使用此值，如果你想要关联**脚本**与中的 Visual Basic.NET 代码的 functoid**内联脚本**缓冲区。</span><span class="sxs-lookup"><span data-stu-id="37831-137">Use this value if you want to associate the **Scripting** functoid with Visual Basic .NET code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="37831-138">-   **内联 XSLT**。</span><span class="sxs-lookup"><span data-stu-id="37831-138">-   **Inline XSLT**.</span></span> <span data-ttu-id="37831-139">使用此值，如果你想要关联**脚本**与中的 XSLT functoid**内联脚本**缓冲区。</span><span class="sxs-lookup"><span data-stu-id="37831-139">Use this value if you want to associate the **Scripting** functoid with XSLT in the **Inline script** buffer.</span></span><br /><span data-ttu-id="37831-140">-   **内联 XSLT 调用模板**。</span><span class="sxs-lookup"><span data-stu-id="37831-140">-   **Inline XSLT Call Template**.</span></span> <span data-ttu-id="37831-141">使用此值，如果你想要关联**脚本**与中的 XSLT 调用模板的 functoid**内联脚本**缓冲区。</span><span class="sxs-lookup"><span data-stu-id="37831-141">Use this value if you want to associate the **Scripting** functoid with XSLT call templates in the **Inline script** buffer.</span></span>|  
|<span data-ttu-id="37831-142">**脚本程序集**</span><span class="sxs-lookup"><span data-stu-id="37831-142">**Script assembly**</span></span>|<span data-ttu-id="37831-143">选择要将与相关联的程序集**脚本**functoid。</span><span class="sxs-lookup"><span data-stu-id="37831-143">Select the assembly to associate with the **Scripting** functoid.</span></span> <span data-ttu-id="37831-144">只有在“项目”窗口中引用的程序集才会显示在此列表中。</span><span class="sxs-lookup"><span data-stu-id="37831-144">Only assemblies referenced in the Project window appear in this list.</span></span> <span data-ttu-id="37831-145">另外请注意，必须在 GAC 中注册程序集。</span><span class="sxs-lookup"><span data-stu-id="37831-145">Note also that you must register assemblies in the GAC.</span></span><br /><br /> <span data-ttu-id="37831-146">此字段才可用**选择脚本类型**设置为**外部程序集**。</span><span class="sxs-lookup"><span data-stu-id="37831-146">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="37831-147">**脚本类**</span><span class="sxs-lookup"><span data-stu-id="37831-147">**Script class**</span></span>|<span data-ttu-id="37831-148">选择你想这选程序集内的类**脚本**functoid 来使用。</span><span class="sxs-lookup"><span data-stu-id="37831-148">Select the class within the chosen assembly that you want this **Scripting** functoid to use.</span></span><br /><br /> <span data-ttu-id="37831-149">此字段才可用**选择脚本类型**设置为**外部程序集**。</span><span class="sxs-lookup"><span data-stu-id="37831-149">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="37831-150">**脚本方法**</span><span class="sxs-lookup"><span data-stu-id="37831-150">**Script method**</span></span>|<span data-ttu-id="37831-151">选择你希望此所选的类中的方法**脚本**functoid 来使用。</span><span class="sxs-lookup"><span data-stu-id="37831-151">Select the method within the chosen class that you want this **Scripting** functoid to use.</span></span> <span data-ttu-id="37831-152">**注意：** 请确保被方法所期望的输入参数的数目匹配中指定的输入参数的数目**配置脚本 Functoid**对话框。</span><span class="sxs-lookup"><span data-stu-id="37831-152">**Note:**  Make sure the number of input parameters expected by the method matches the number of input parameters specified in the **Configure Scripting Functoid** dialog box.</span></span>|  
|<span data-ttu-id="37831-153">**内联脚本**</span><span class="sxs-lookup"><span data-stu-id="37831-153">**Inline script**</span></span>|<span data-ttu-id="37831-154">将要使用的内联脚本写入或复制到此文本框中。</span><span class="sxs-lookup"><span data-stu-id="37831-154">Write or copy the inline script to be used into this text box.</span></span> <span data-ttu-id="37831-155">有效的语言和脚本包括：C#、JScript .NET、Visual Basic .NET、XSLT 和 XSLT 调用模板。</span><span class="sxs-lookup"><span data-stu-id="37831-155">Valid languages and scripts include: C#, JScript .NET, Visual Basic .NET, XSLT, and XSLT call templates.</span></span><br /><br /> <span data-ttu-id="37831-156">此字段才可用**选择脚本类型**设置为之一**内联**设置。</span><span class="sxs-lookup"><span data-stu-id="37831-156">This field is only available when **Select script type** is set to one of the **Inline** settings.</span></span> <span data-ttu-id="37831-157">**注意：** 避免多次使用相同的方法签名。</span><span class="sxs-lookup"><span data-stu-id="37831-157">**Caution:**  Avoid using the same method signature more than once.</span></span> <span data-ttu-id="37831-158">如果多个“脚本”functoid 具有相同的方法签名，则 BizTalk 会选择实现的第一个方法签名，而忽略其他签名。</span><span class="sxs-lookup"><span data-stu-id="37831-158">When several Scripting functoids have the same method signature, BizTalk selects the first implementation and disregards the others.</span></span>|  
  
 <span data-ttu-id="37831-159">下图显示了**脚本**functoid 出现在图中使用 C#.Net 脚本来重新设置格式的电话号码。</span><span class="sxs-lookup"><span data-stu-id="37831-159">The following figure shows how the **Scripting** functoid appears in a map using the C# .Net script to reformat a telephone number.</span></span>  
  
 <span data-ttu-id="37831-160">![使用 c&#35; 的映射若要设置格式的电话号码。] (../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span><span class="sxs-lookup"><span data-stu-id="37831-160">![Map using the C&#35; to format a telephone number.](../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span></span>  
<span data-ttu-id="37831-161">“脚本”Functoid 映射</span><span class="sxs-lookup"><span data-stu-id="37831-161">Scripting Functoid Map</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="37831-162">本节内容</span><span class="sxs-lookup"><span data-stu-id="37831-162">In This Section</span></span>  
  
-   [<span data-ttu-id="37831-163">脚本使用外部程序集</span><span class="sxs-lookup"><span data-stu-id="37831-163">Scripting Using External Assemblies</span></span>](../core/scripting-using-external-assemblies.md)  
  
-   [<span data-ttu-id="37831-164">脚本使用内联 C#、 JScript.NET 和 Visual Basic.NET</span><span class="sxs-lookup"><span data-stu-id="37831-164">Scripting Using Inline C#, JScript .NET, and Visual Basic .NET</span></span>](../core/scripting-using-inline-csharp-jscript-net-and-visual-basic-net.md)  
  
-   [<span data-ttu-id="37831-165">脚本使用内联 XSLT 和 XSLT 调用模板</span><span class="sxs-lookup"><span data-stu-id="37831-165">Scripting Using Inline XSLT and XSLT Call Templates</span></span>](../core/scripting-using-inline-xslt-and-xslt-call-templates.md)