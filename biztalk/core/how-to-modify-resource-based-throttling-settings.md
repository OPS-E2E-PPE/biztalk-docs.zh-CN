---
title: 如何修改资源的基于限制设置 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
f1_keywords:
- Bts10.settings.HostResource
ms.assetid: 5f8b32a8-d8cc-4045-a8be-0de0bbadcce4
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1b874374c8aec99affe8055f61ed95992853dbff
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "37012358"
---
# <a name="how-to-modify-resource-based-throttling-settings"></a>如何修改资源的基于限制设置
使用设置仪表板，你可以在 BizTalk 组修改给定主机的基于资源限制的配置设置。 这些设置将应用于分配到给定主机的所有主机实例。 本主题提供了修改这些设置的分步过程。  

 为了管理主机实例进程使用的系统资源（如线程、内存和数据库大小），[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用可调节的阻止机制来管理消息在主机实例中的传输和处理。 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 主机阻止机制有助于确保系统按下列方式以最佳和可持续水平运行：  

-   缓解主机实例的工作量。  

-   阻止可能降低主机实例进程或其他系统进程整体性能的资源争用。  

-   检测何时可利用资源未得到充分利用。  

## <a name="prerequisites"></a>必要條件  
 若要执行此操作，则必须以 BizTalk Server Administrators 组成员的身份登录。  

### <a name="to-modify-the-resource-based-throttling-settings-of-a-host"></a>修改主机基于资源的阻止设置  

1. 在中**BizTalk Server 管理控制台**，展开[!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]，右键单击**BizTalk 组**，然后单击**设置**。  

2. 在中**BizTalk 设置仪表板**对话框中，在**主机**选项卡上，单击**基于资源的阻止**选项卡。  

3. 执行以下操作，然后依次**应用**以应用修改并转到另一个选项卡。否则，请单击**确定**应用所做的修改并退出设置仪表板。  


   |          **使用此**           |                                                                                                                                                                                                                                                                                                                                                             执行的操作                                                                                                                                                                                                                                                                                                                                                             |                                            边界值                                             | 默认值 |                                           升级逻辑                                           |
   |---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------|
   |            **主机**             |                                                                                                                                                                                                                                                                                  从下拉列表中，选择代表 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 运行时实例的主机。                                                                                                                                                                                                                                                                                   |                                                   -                                                    |       -       |                                                 -                                                 |
   |      **每 CPU 设置**       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                   -                                                    |       -       |                                                 -                                                 |
   |           **线程**           |                                                                                                                                                                                                                                                                                                                指定（每 CPU）允许的进程中最大线程数，一旦超出此值，就启用阻止功能。                                                                                                                                                                                                                                                                                                                |                                   [0，整数类型的最大值)                                   |       0       |                                                 -                                                 |
   |    **数据库连接**     |                                                                                                                                                                                                                                                                                                                    指定在阻止开始之前允许的数据库会话（每 CPU）的最大数量。                                                                                                                                                                                                                                                                                                                     |                                   1 – Integer 类型的最大值                                    |       0       |                                                 -                                                 |
   |     **进程内消息数**     |                                                                                                                                                                                                                                              指定传送到端点管理器 (EPM) 或 XLANG 并且尚未处理的最大消息数。 此值不包括已从数据库中检索到但仍在内存中队列内等待送达的消息数。                                                                                                                                                                                                                                              |                                   1 – Integer 类型的最大值                                    |     1000      |                                                 -                                                 |
   | **内部消息队列大小** |                                                表示内存中队列的大小。 此队列用作送达消息的临时占位符。<br /><br /> 如果将此参数设置为较大的值，则可能会在某种程度上改进延迟时间短的方案，因为将会从 MessageBox 数据库中主动检索更多的消息以进行处理。 由于此队列中的消息会消耗内存，因此对于涉及大消息的方案，可能需要将此参数设置为较小的值以避免基于内存的进程阻止。 **注意：** 修改此值，如果需要更改才能生效，必须重新启动主机。                                                |                                   1 – Integer 类型的最大值                                    |      100      |                                                 -                                                 |
   |     **在 DB 中的消息计数**     |                                                                                                                              表示此主机实例发布到订阅主机的工作、状态和已挂起队列的消息总数。<br /><br /> **DB 中的消息数**也可间接定义基于后台处理表或跟踪表中的消息数的阻止条件的阈值。 如果后台处理表或跟踪表中的消息数超过此值的 10 倍，则会触发阻止条件。                                                                                                                              |                                   1 – Integer 类型的最大值                                    |     50000     |                                                 -                                                 |
   |        **内存使用情况**         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                   -                                                    |       -       |                                                 -                                                 |
   |       **全局物理**       |                                                                                                                                                                                                                                                                                                                指定在阻止开始之前允许的系统范围虚拟内存使用的最大值（以百分比表示）。                                                                                                                                                                                                                                                                                                                 | 0: 禁用<br /><br /> 1% – 100%<br /><br /> > 100% 的值被视为 MB，可以上升到最大整数 |       0       |                                                 -                                                 |
   |       **进程虚拟**       |                                                                                                                                                                                                                                                                                                            指定在阻止开始（以百分比或 MB 表示）之前允许的进程内存最大值（以百分比表示）。                                                                                                                                                                                                                                                                                                             | 0: 禁用<br /><br /> 1% – 100%<br /><br /> > 100% 的值被视为 MB，可以上升到最大整数 |      25       |                                                 -                                                 |
   |      **后台乘数**       |                                                                                                                                                                              指示所依据的因素**DB 中的消息数**乘以和与指定后台处理表中的当前记录数进行比较的阈值。<br /><br /> 执行此操作是为了确定系统是否应当限制后台处理表的大小。 如果此值设置为 0，则不会将后台处理表大小作为确定阻止条件的考虑事项。                                                                                                                                                                              |                                                 0-1000                                                 |      10       | 从注册表中读取的阻止参数应当一对一地映射到主机实例参数。 |
   |  **跟踪数据乘数**   |                                                                                                                                                                          依据指定的系数**DB 中的消息数**乘以和与指定跟踪表中的当前记录数进行比较的阈值。<br /><br /> 这样做是为了确定系统是否应当限制跟踪表的大小。 如果此值设置为 0，跟踪表大小不用作确定限制条件的考虑因素。                                                                                                                                                                          |                                                 0-1000                                                 |      10       | 从注册表中读取的阻止参数应当一对一地映射到主机实例参数。 |
   |     **触发 GC 的限制**     |                                                                                                                                                                                                                                               指定在进程内存消耗增加并接近阈值的情况下，触发 .NET 垃圾收集 (GC) 的时间。 如果内存消耗超过内存阈值的这一百分比值时，则会触发 GC。                                                                                                                                                                                                                                               |                                                 50-100                                                 |      80       | 从注册表中读取的阻止参数应当一对一地映射到主机实例参数。 |
   |   **批内存阈值**    | 表示（以百分比形式）内存阈值，如果内存超过该阈值，则会阻止发布消息批。<br /><br /> 批内存阈值计算此百分比因子乘以**进程虚拟**阈值。 如果估计用于执行发布批的内存超过了批内存阈值，则该批会受到基于进程内存的阻止功能的限制。 否则，批处理已免除进程基于内存的阻止进程内存总量超过时甚至**进程虚拟**阈值。<br /><br /> 值 0 表示即使在估计用于执行批的内存很少的情况下，所有发布批也可能受到基于进程内存的阻止功能的限制。 |                                                0%-100%                                                 |               | 从注册表中读取的阻止参数应当一对一地映射到主机实例参数。 |
   |          **Severity**           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                   -                                                    |       -       |                                                 -                                                 |
   |           **内存**            |                                                                                                                                                                                                                                                   表示进程内存触发的阻止条件的严重性。 在百分比值中指定，此参数设置而导致的阻止条件的严重性**进程虚拟**超过了阈值。                                                                                                                                                                                                                                                   |                                                1 – 1000                                                |      500      |                                所有主机实例的最小值                                 |
   |           **数据库大小**           |                                                                                                                                                                                                                                                 表示数据库大小触发的阻止条件的严重性。 在百分比值中指定，此参数设置而导致的阻止条件的严重性**DB 中的消息数**超过了阈值。                                                                                                                                                                                                                                                 |                                                1 – 1000                                                |       @shouldalert       |                                所有主机实例的最小值                                 |
   |      **尚未到达的消息**       |                                                                                                                                                                                                                      指定时进行阻止的反应时间的值**进程内消息数**超出了阈值。 此参数以百分比值的形式指定，并且此参数设置而导致的阻止条件的严重性的值**进程内消息数**超过了阈值。                                                                                                                                                                                                                       |                                                1 – 1000                                                |      75       |                                所有主机实例的最小值                                 |

   > [!NOTE]
   >  若要还原默认设置，请单击**还原为默认值**。  

## <a name="see-also"></a>请参阅  
 [如何修改主机设置](../core/how-to-modify-host-settings.md)