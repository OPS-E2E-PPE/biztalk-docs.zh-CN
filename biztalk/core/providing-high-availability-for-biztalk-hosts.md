---
title: 为 BizTalk 主机提供高可用性 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- messages, MessageBox database
- planning, hosts
- hosts, high availability
- messages, routing
- deploying, high availability
- high availability, hosts
- hosts
- hosts, planning
- MessageBox database
ms.assetid: 9583b85c-7cad-4016-8065-5ca7de3f4359
caps.latest.revision: 47
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f28c4bb8935da0d98ea59efb2642e13900c3a54a
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65398436"
---
# <a name="providing-high-availability-for-biztalk-hosts"></a><span data-ttu-id="ff48a-102">为 BizTalk 主机提供高可用性</span><span class="sxs-lookup"><span data-stu-id="ff48a-102">Providing High Availability for BizTalk Hosts</span></span>
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="ff48a-103">处理高可用性，因为可以策略性地将运行特定区域的功能，如接收消息、 发送消息或处理业务流程的逻辑主机专门提供极大的灵活性。</span><span class="sxs-lookup"><span data-stu-id="ff48a-103">provides great flexibility for addressing high availability because you can strategically dedicate logical hosts to run specific areas of functionality such as receiving messages, sending messages or processing orchestrations.</span></span>  
  
 <span data-ttu-id="ff48a-104">BizTalk 主机是 BizTalk Server 组，可承载 BizTalk Server 项，例如适配器处理程序，接收位置 （包括管道） 和业务流程中的逻辑容器。</span><span class="sxs-lookup"><span data-stu-id="ff48a-104">A BizTalk host is a logical container within a BizTalk Server group that can house BizTalk Server items such as adapter handlers, receive locations (including pipelines), and orchestrations.</span></span> <span data-ttu-id="ff48a-105">您通常分组具有类似扩展要求到特定的主机项。</span><span class="sxs-lookup"><span data-stu-id="ff48a-105">You typically group items that have similar scaling requirements into a particular host.</span></span> <span data-ttu-id="ff48a-106">例如，可以将接收到"接收"的主机的位置、 发送端口分到"发送"主机和到"处理"主机的业务流程。</span><span class="sxs-lookup"><span data-stu-id="ff48a-106">For example, you would group receive locations into a “receive” host, send ports into a “send” host, and orchestrations into an “processing” host.</span></span>  
  
 <span data-ttu-id="ff48a-107">创建主机 （逻辑容器） 后，您可以配置要在物理上运行的主机的实例[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]中的计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]组。</span><span class="sxs-lookup"><span data-stu-id="ff48a-107">After you create a host (a logical container), you can configure instances of the host to run on physical [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group.</span></span> <span data-ttu-id="ff48a-108">作为 Windows 服务上指定的主机实例运行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机。</span><span class="sxs-lookup"><span data-stu-id="ff48a-108">A host instance runs as a Windows Service on the designated [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer(s).</span></span> <span data-ttu-id="ff48a-109">尽管不可能在运行多个实例在同一主机的给定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机，您可以通过上单独配置的主机实例运行特定主机的多个实例[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]中的计算机[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]组。</span><span class="sxs-lookup"><span data-stu-id="ff48a-109">Although it is not possible to run multiple instances of the same host on a given [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, you can run multiple instances of a particular host by configuring instances of the host on separate [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers in a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group.</span></span> <span data-ttu-id="ff48a-110">此外可以运行不同主机的多个实例的单个[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机。</span><span class="sxs-lookup"><span data-stu-id="ff48a-110">You can also run multiple instances of different hosts on a single [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer.</span></span>  
  
 <span data-ttu-id="ff48a-111">BizTalk 主机中包含的项可以执行以下功能：</span><span class="sxs-lookup"><span data-stu-id="ff48a-111">Items that are contained in BizTalk hosts can perform the following functions:</span></span>  
  
- <span data-ttu-id="ff48a-112">**接收**这些项后选取在接收位置对其进行初始处理的消息。</span><span class="sxs-lookup"><span data-stu-id="ff48a-112">**Receiving** These items do the initial processing of messages after they are picked up in a receive location.</span></span> <span data-ttu-id="ff48a-113">当主机包含接收项时，如接收位置或管道，它充当安全边界，并在主机内的管道中出现消息解码和解密。</span><span class="sxs-lookup"><span data-stu-id="ff48a-113">When a host contains a receiving item, such as a receive location or pipeline, it acts as a security boundary, and the message decoding and decrypting occurs in a pipeline within the host.</span></span>  
  
- <span data-ttu-id="ff48a-114">**发送**这些项对其进行最终处理消息之前发送到发送端口发送。</span><span class="sxs-lookup"><span data-stu-id="ff48a-114">**Sending** These items do the final processing of messages before they are sent out to the send port.</span></span> <span data-ttu-id="ff48a-115">当主机包含发送项，例如发送端口或管道中，主机将充当安全边界，而且消息的签名和加密发生在主机中的管道中。</span><span class="sxs-lookup"><span data-stu-id="ff48a-115">When a host contains a sending item, such as a send port or pipeline, the host acts as a security boundary, and the message signing and encryption occurs in a pipeline within the host.</span></span>  
  
- <span data-ttu-id="ff48a-116">**处理**这些项来处理基于业务流程中的说明进行操作的消息。</span><span class="sxs-lookup"><span data-stu-id="ff48a-116">**Processing** These items process messages based on the instructions in an orchestration.</span></span>  
  
  <span data-ttu-id="ff48a-117">虽然单一 BizTalk 主机可以包含接收的项、 发送和处理消息，但它被视为最佳做法来创建不同的主机的每个函数来创建安全边界以及出于管理简易性和可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="ff48a-117">Although a single BizTalk Host can contain items that receive, send, and process messages, it is considered a best practice to create different hosts for each function to create security boundaries and for easier management and scalability.</span></span> <span data-ttu-id="ff48a-118">具体而言，我们建议使用不同的主机，以进行处理，对于接收/发送操作，并且分隔可信任和不可信任项。</span><span class="sxs-lookup"><span data-stu-id="ff48a-118">In particular, we recommend that you use different hosts for processing and for receive/send operations, and that you separate trusted and non-trusted items.</span></span>  
  
  <span data-ttu-id="ff48a-119">例如，如果收到一条消息，运行业务流程，并发送 10 条消息，你想要将接收和发送功能分隔到两个单独的主机，因为发送项将具有将是接收项的十倍更多流量。</span><span class="sxs-lookup"><span data-stu-id="ff48a-119">For example, if you receive one message, run an orchestration, and send ten messages, you want to separate the receive and send functionality into two separate hosts because the send items will have ten times more traffic than the receive items.</span></span> <span data-ttu-id="ff48a-120">如果收到一条消息，运行业务流程，并发送一条消息，可以将这些项视为一个工作单元并将它们分到一台主机。</span><span class="sxs-lookup"><span data-stu-id="ff48a-120">If you receive one message, run an orchestration, and send one message, you can think of these items as a unit of work and group them into one single host.</span></span> <span data-ttu-id="ff48a-121">或者，可以将它们分到三个不同的主机以提高性能和灵活性。</span><span class="sxs-lookup"><span data-stu-id="ff48a-121">Alternatively, you can separate them into three different hosts to increase performance and flexibility.</span></span>  
  
  <span data-ttu-id="ff48a-122">BizTalk 主机分为两种类型之一**进程内**或**独立**。</span><span class="sxs-lookup"><span data-stu-id="ff48a-122">BizTalk hosts are one of two types, **In-process** or **Isolated**.</span></span> <span data-ttu-id="ff48a-123">进程内主机运行的内部[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]运行时处理而不会独立的主机运行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]运行时进程。</span><span class="sxs-lookup"><span data-stu-id="ff48a-123">In-process hosts run inside of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] runtime process whereas Isolated hosts do not run in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] runtime process.</span></span> <span data-ttu-id="ff48a-124">可能包含下表列出了每种主机类型的项。</span><span class="sxs-lookup"><span data-stu-id="ff48a-124">The following table lists the items that each of these host types may contain.</span></span>  
  
|<span data-ttu-id="ff48a-125">**主机类型**</span><span class="sxs-lookup"><span data-stu-id="ff48a-125">**Host Type**</span></span>|<span data-ttu-id="ff48a-126">**逻辑容器**</span><span class="sxs-lookup"><span data-stu-id="ff48a-126">**Logical container for**</span></span>|  
|-------------------|-------------------------------|  
|<span data-ttu-id="ff48a-127">进程内</span><span class="sxs-lookup"><span data-stu-id="ff48a-127">In-Process</span></span>|<span data-ttu-id="ff48a-128">-业务流程</span><span class="sxs-lookup"><span data-stu-id="ff48a-128">-   Orchestrations</span></span><br /><span data-ttu-id="ff48a-129">适配器发送处理程序</span><span class="sxs-lookup"><span data-stu-id="ff48a-129">-   Adapter Send Handlers</span></span><br /><span data-ttu-id="ff48a-130">适配器接收处理程序不是 HTTP 和 SOAP</span><span class="sxs-lookup"><span data-stu-id="ff48a-130">-   Adapter Receive Handlers other than HTTP and SOAP</span></span>|  
|<span data-ttu-id="ff48a-131">隔离</span><span class="sxs-lookup"><span data-stu-id="ff48a-131">Isolated</span></span>|<span data-ttu-id="ff48a-132">HTTP 和 SOAP 接收处理程序</span><span class="sxs-lookup"><span data-stu-id="ff48a-132">HTTP and SOAP Receive Handlers</span></span>|  
  
 <span data-ttu-id="ff48a-133">有关主机和主机实例的详细信息，请参阅[管理 BizTalk 主机和主机实例](../core/managing-biztalk-hosts-and-host-instances.md)。</span><span class="sxs-lookup"><span data-stu-id="ff48a-133">For more information about hosts and host instances, see [Managing BizTalk Hosts and Host Instances](../core/managing-biztalk-hosts-and-host-instances.md).</span></span>  
  
 <span data-ttu-id="ff48a-134">若要为 BizTalk 主机提供高可用性，您必须具有两个或多个主机实例的每个主机环境中 (在两个或多[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机)。</span><span class="sxs-lookup"><span data-stu-id="ff48a-134">To provide high availability for BizTalk hosts, you must have two or more host instances for each host in your environment (on two or more [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers).</span></span> <span data-ttu-id="ff48a-135">整个系统可以通过确保一个主机实例变为不可用，如果正在运行该主机的实例的其他计算机可以恢复的功能有问题或失败的主机实例中，并且每个主机具有多个主机实例继续执行中断降至最低。</span><span class="sxs-lookup"><span data-stu-id="ff48a-135">By having more than one host instance for each host you ensure that if one host instance becomes unavailable, the other computers that are running instances of that host can resume the functions of the problematic or failed host instance, and that the overall system can continue performing with minimal disruption.</span></span>  
  
## <a name="message-persistence"></a><span data-ttu-id="ff48a-136">消息持久性</span><span class="sxs-lookup"><span data-stu-id="ff48a-136">Message Persistence</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="ff48a-137">很大程度上依赖于[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]以实现高可用性，因为每个主机涉及[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]消息保存到 BizTalk MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="ff48a-137">relies heavily on [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] for high availability because every host involved in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] persists messages to the BizTalk MessageBox database.</span></span> <span data-ttu-id="ff48a-138">例如，当[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]收到传入消息，接收主机其保存到 MessageBox 数据库之前的其他主机检索业务流程处理和发送的消息。</span><span class="sxs-lookup"><span data-stu-id="ff48a-138">For example, when [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives an incoming message, the receive host persists it to the MessageBox database before other hosts retrieve the message for orchestration processing and sending.</span></span>  
  
 <span data-ttu-id="ff48a-139">如果你[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]解决方案包含业务流程，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]将消息路由到的主机执行业务流程 （处理主机），并在业务流程完成后，将消息保存到 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="ff48a-139">If your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solution involves orchestration, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] routes the message to the host that executes the business process (processing host), and saves the message to the MessageBox database after the orchestration finishes.</span></span> <span data-ttu-id="ff48a-140">发送到相应的发送适配器通过外部应用程序之前发送主机从 MessageBox 数据库随后检索消息。</span><span class="sxs-lookup"><span data-stu-id="ff48a-140">The sending host then retrieves the message from the MessageBox database before sending it to the external application through the appropriate send adapter.</span></span>  
  
## <a name="separating-the-host-and-database-functions"></a><span data-ttu-id="ff48a-141">分隔主机功能和数据库函数</span><span class="sxs-lookup"><span data-stu-id="ff48a-141">Separating the Host and Database Functions</span></span>  
 <span data-ttu-id="ff48a-142">因为[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]分隔数据与处理数据，可用于创建高度可用的环境的一个步骤的主机的主机功能 （发送、 接收和处理） 中发生的是[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]从数据库函数中发生的[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="ff48a-142">Because [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] separates the data from the hosts that process the data, one step that you can take to create a highly available environment is to separate the host functions (sending, receiving, and processing) that occur in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] from the database functions that occur in [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span> <span data-ttu-id="ff48a-143">通过分隔这些功能，可以独立缩放处理、 发送和接收主机功能以及存储数据的数据库。</span><span class="sxs-lookup"><span data-stu-id="ff48a-143">By separating these functions, you can independently scale the processing, sending, and receiving hosts and the databases that store the data.</span></span> <span data-ttu-id="ff48a-144">在运行时和数据库层相关的也就是说，如果增加的数量[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]的计算机可能需要增加运行的计算机数量[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]处理附加负载。</span><span class="sxs-lookup"><span data-stu-id="ff48a-144">The runtime and database layers are related, that is, if you increase the number of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers you will likely need to increase the number of computers that are running [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] to handle the additional load.</span></span> <span data-ttu-id="ff48a-145">但是，在数据库层和 BizTalk 层之间没有直接关系。</span><span class="sxs-lookup"><span data-stu-id="ff48a-145">However, there is no direct relationship between the database layer and the BizTalk layer.</span></span> <span data-ttu-id="ff48a-146">它们是两个独立的层，您可以单独地扩展它们。</span><span class="sxs-lookup"><span data-stu-id="ff48a-146">They are two independent layers and you can scale them out separately.</span></span>  
  
 <span data-ttu-id="ff48a-147">若要确保主机高度可用而必须执行的操作与不同必须执行哪些操作来使数据库高度可用。</span><span class="sxs-lookup"><span data-stu-id="ff48a-147">What you must do to make the hosts highly available is different from what you must do to make the databases highly available.</span></span> <span data-ttu-id="ff48a-148">以下各节说明您必须做什么以使接收、 发送和处理主机高度可用。</span><span class="sxs-lookup"><span data-stu-id="ff48a-148">The following sections explain what you must do to make the receiving, sending, and processing hosts highly available.</span></span> <span data-ttu-id="ff48a-149">有关如何实现数据库层的高可用性的详细信息，请参阅[的 BizTalk Server 数据库提供高可用性](../core/providing-high-availability-for-biztalk-server-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="ff48a-149">For more information about how to make the database layer highly available, see [Providing High Availability for BizTalk Server Databases](../core/providing-high-availability-for-biztalk-server-databases.md).</span></span>  
  
 <span data-ttu-id="ff48a-150">对于部署其中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]进程多于 SQL Server 进程，可以配置多个[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]使用运行 SQL Server 的同一台计算机的计算机。</span><span class="sxs-lookup"><span data-stu-id="ff48a-150">For deployments where [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes more than SQL Server processes, you can configure multiple [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers that use the same computer that is running SQL Server.</span></span> <span data-ttu-id="ff48a-151">此配置使用每台计算机上可用的资源。</span><span class="sxs-lookup"><span data-stu-id="ff48a-151">This configuration uses the resources available on each computer.</span></span> <span data-ttu-id="ff48a-152">例如，如果 CPU 或内存使用高 （大于 75%） 上运行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机但运行在较低 （小于 25%） 运行 SQL Server 的计算机上，您可以向其他[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]计算机分配工作负荷时提高运行 SQL Server 的计算机上的资源使用率。</span><span class="sxs-lookup"><span data-stu-id="ff48a-152">For example, if CPU or memory use runs high (more than 75 percent) on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer but runs low (less than 25 percent) on the computer that is running SQL Server, you can include additional [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers to distribute the workload while raising the resource utilization on the computer that is running SQL Server.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="ff48a-153">本节内容</span><span class="sxs-lookup"><span data-stu-id="ff48a-153">In This Section</span></span>  
  
-   [<span data-ttu-id="ff48a-154">横向扩展接收主机</span><span class="sxs-lookup"><span data-stu-id="ff48a-154">Scaled-Out Receiving Hosts</span></span>](../core/scaled-out-receiving-hosts.md)  
  
-   [<span data-ttu-id="ff48a-155">扩展处理主机</span><span class="sxs-lookup"><span data-stu-id="ff48a-155">Scaled-Out Processing Hosts</span></span>](../core/scaled-out-processing-hosts.md)  
  
-   [<span data-ttu-id="ff48a-156">扩展发送主机</span><span class="sxs-lookup"><span data-stu-id="ff48a-156">Scaled-Out Sending Hosts</span></span>](../core/scaled-out-sending-hosts.md)  
  
-   [<span data-ttu-id="ff48a-157">使用 Windows Server 群集为 BizTalk Server 主机 2 提供高可用性</span><span class="sxs-lookup"><span data-stu-id="ff48a-157">Using Windows Server Cluster to Provide High Availability for BizTalk Server Hosts2</span></span>](../core/use-windows-cluster-to-provide-high-availability-for-biztalk-hosts.md)  
  
## <a name="see-also"></a><span data-ttu-id="ff48a-158">请参阅</span><span class="sxs-lookup"><span data-stu-id="ff48a-158">See Also</span></span>  
 <span data-ttu-id="ff48a-159">[为 BizTalk Server 数据库提供高可用性](../core/providing-high-availability-for-biztalk-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="ff48a-159">[Providing High Availability for BizTalk Server Databases](../core/providing-high-availability-for-biztalk-server-databases.md) </span></span>  
 [<span data-ttu-id="ff48a-160">企业单一登录的高可用性</span><span class="sxs-lookup"><span data-stu-id="ff48a-160">High Availability for Enterprise Single Sign-On</span></span>](../core/high-availability-for-enterprise-single-sign-on.md)