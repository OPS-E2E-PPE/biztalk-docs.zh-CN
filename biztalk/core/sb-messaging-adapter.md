---
title: "SB 消息适配器 |Microsoft 文档"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c06c4934-45b2-4f6f-9d19-3ebd937c32ae
caps.latest.revision: "5"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2fb2eb8f532d72708dfca199f0eef794afdf77df
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2017
---
# <a name="sb-messaging-adapter"></a><span data-ttu-id="83183-102">SB 消息适配器</span><span class="sxs-lookup"><span data-stu-id="83183-102">SB-Messaging Adapter</span></span>
<span data-ttu-id="83183-103">Service Bus (**SB 消息**) 适配器用于接收和发送从服务总线实体，如队列、 主题和中继。</span><span class="sxs-lookup"><span data-stu-id="83183-103">The Service Bus (**SB-Messaging**) adapter is used to receive and send from Service Bus entities like Queues, Topics, and Relays.</span></span> <span data-ttu-id="83183-104">你可以使用**SB 消息**来桥接之间的连接的适配器[!INCLUDE[winazure](../includes/winazure-md.md)]和本地[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，从而使用户能够创建典型混合应用程序。</span><span class="sxs-lookup"><span data-stu-id="83183-104">You can use the **SB-Messaging** adapters to bridge the connectivity between [!INCLUDE[winazure](../includes/winazure-md.md)] and on-premises [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], thereby enabling users to create a typical hybrid application.</span></span> <span data-ttu-id="83183-105">此部分中的主题提供有关如何配置的说明**SB 消息**接收位置和发送端口来接收和发送消息从 Service Bus 实体。</span><span class="sxs-lookup"><span data-stu-id="83183-105">The topics in this section provide instructions on how to configure an **SB-Messaging** receive location and a send port to receive and send messages from the Service Bus entities.</span></span>  

## <a name="before-you-get-started"></a><span data-ttu-id="83183-106">开始操作之前</span><span class="sxs-lookup"><span data-stu-id="83183-106">Before you get started</span></span>
<span data-ttu-id="83183-107">服务总线提供了两种方法进行身份验证： 访问控制服务 (ACS) 和共享访问签名 (SAS)。</span><span class="sxs-lookup"><span data-stu-id="83183-107">Service Bus provides two methods to authenticate: Access Control Service (ACS) and the Shared Access Signature (SAS).</span></span> <span data-ttu-id="83183-108">我们建议是使用服务总线进行身份验证时使用共享访问签名 (SAS)。</span><span class="sxs-lookup"><span data-stu-id="83183-108">Our recommendation is to use Shared Access Signature (SAS) when authenticating with Service Bus.</span></span> <span data-ttu-id="83183-109">中列出的共享访问密钥值[Azure 门户](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="83183-109">The Shared Access Key value is listed in the [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="83183-110">当你创建了服务总线命名空间时，不自动创建 Access Control (ACS) 命名空间。</span><span class="sxs-lookup"><span data-stu-id="83183-110">When you create a Service Bus namespace, the Access Control (ACS) namespace is not automatically created.</span></span> <span data-ttu-id="83183-111">若要使用访问控制，你需要此命名空间的颁发者名称和颁发者密钥值。</span><span class="sxs-lookup"><span data-stu-id="83183-111">To use Access Control, you need the Issuer Name and Issuer Key values of this namespace.</span></span> <span data-ttu-id="83183-112">当你创建新的 ACS 命名空间使用 Windows PowerShell，这些值才可用。</span><span class="sxs-lookup"><span data-stu-id="83183-112">These values are available when you create a new ACS namespace using Windows PowerShell.</span></span> <span data-ttu-id="83183-113">在 Azure 门户中未列出这些值。</span><span class="sxs-lookup"><span data-stu-id="83183-113">These values are not listed in the Azure portal.</span></span>

<span data-ttu-id="83183-114">若要使用 ACS 进行身份验证，并获取颁发者名称和颁发者密钥值，总体步骤包括：</span><span class="sxs-lookup"><span data-stu-id="83183-114">To use ACS for authentication, and get the Issuer Name and Issuer Key values, the overall steps include:</span></span>

1. <span data-ttu-id="83183-115">安装[Azure Powershell cmdlet](https://azure.microsoft.com/documentation/articles/powershell-install-configure/)。</span><span class="sxs-lookup"><span data-stu-id="83183-115">Install the [Azure Powershell cmdlets](https://azure.microsoft.com/documentation/articles/powershell-install-configure/).</span></span>
2. <span data-ttu-id="83183-116">添加你的 Azure 帐户：`Add-AzureAccount`</span><span class="sxs-lookup"><span data-stu-id="83183-116">Add your Azure account: `Add-AzureAccount`</span></span>
3. <span data-ttu-id="83183-117">返回你的订阅名称：`get-azuresubscription`</span><span class="sxs-lookup"><span data-stu-id="83183-117">Return your subscription name: `get-azuresubscription`</span></span>
4. <span data-ttu-id="83183-118">选择你的订阅：`select-azuresubscription <name of your subscription>`</span><span class="sxs-lookup"><span data-stu-id="83183-118">Select your subscription: `select-azuresubscription <name of your subscription>`</span></span> 
5. <span data-ttu-id="83183-119">创建新的命名空间：`new-azuresbnamespace <name for the service bus> "Location" -CreateACSNamespace $true -NamespaceType Messaging`</span><span class="sxs-lookup"><span data-stu-id="83183-119">Create a new namespace: `new-azuresbnamespace <name for the service bus> "Location" -CreateACSNamespace $true -NamespaceType Messaging`</span></span>

    <span data-ttu-id="83183-120">示例：`new-azuresbnamespace biztalksbnamespace "South Central US" -CreateACSNamespace $true -NamespaceType Messaging`</span><span class="sxs-lookup"><span data-stu-id="83183-120">Example:    `new-azuresbnamespace biztalksbnamespace "South Central US" -CreateACSNamespace $true -NamespaceType Messaging`</span></span>
      
5. <span data-ttu-id="83183-121">创建新的 ACS 命名空间时 （这可能会花费几分钟的时间），连接字符串中列出了 IssuerName 和 IssuerKey 值：</span><span class="sxs-lookup"><span data-stu-id="83183-121">When the new ACS namespace is created (which can take several minutes), the IssuerName and IssuerKey values are listed in the connection string:</span></span> 

    ```
    Name                  : biztalksbnamespace
    Region                : South Central US
    DefaultKey            : abcdefghijklmnopqrstuvwxyz
    Status                : Active
    CreatedAt             : 10/18/2016 9:36:30 PM
    AcsManagementEndpoint : https://biztalksbnamespace-sb.accesscontrol.windows.net/
    ServiceBusEndpoint    : https://biztalksbnamespace.servicebus.windows.net/
    ConnectionString      : Endpoint=sb://biztalksbnamespace.servicebus.windows.net/;SharedSecretIssuer=owner;SharedSecretValue=abcdefghijklmnopqrstuvwxyz
    NamespaceType         : Messaging
    ```
[<span data-ttu-id="83183-122">新 AzureSBNamespace</span><span class="sxs-lookup"><span data-stu-id="83183-122">New-AzureSBNamespace</span></span>](https://msdn.microsoft.com/library/dn495165.aspx)

## <a name="receive-messages-from-service-bus"></a><span data-ttu-id="83183-123">从 Service Bus 接收消息</span><span class="sxs-lookup"><span data-stu-id="83183-123">Receive messages from Service Bus</span></span>
  
<span data-ttu-id="83183-124">本部分提供有关如何配置信息**SB 消息**接收位置使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="83183-124">This section provides information on how to configure an **SB-Messaging** Receive Location using the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="83183-125">之前完成以下过程，你必须已添加单向接收端口。</span><span class="sxs-lookup"><span data-stu-id="83183-125">Before completing the following procedure, you must have already added a one-way receive port.</span></span> <span data-ttu-id="83183-126">请参阅[如何创建接收端口](../core/how-to-create-a-receive-port.md)。</span><span class="sxs-lookup"><span data-stu-id="83183-126">See [How to create a receive port](../core/how-to-create-a-receive-port.md).</span></span>  

 
1.  <span data-ttu-id="83183-127">在 BizTalk Server 管理控制台中，展开[!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]，展开**BizTalk 组**，展开**应用程序**，然后展开应用程序在你想要创建接收位置。</span><span class="sxs-lookup"><span data-stu-id="83183-127">In the BizTalk Server Administration console, expand [!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)], expand **BizTalk Group**, expand **Applications**, and then expand the application under you want to create a receive location.</span></span>  
  
2.  <span data-ttu-id="83183-128">在左窗格中，单击“接收端口”  节点，在右窗格中，右键单击你希望将新的接收位置与其关联的接收端口，然后单击“属性” 。</span><span class="sxs-lookup"><span data-stu-id="83183-128">In the left pane, click the **Receive Ports** node and in the right pane, right-click the receive port with which you want to associate the new receive location, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="83183-129">在“接收端口属性”  对话框的左窗格中，选择“接收位置” ，然后在右窗格中单击“新建”  以创建新的接收位置。</span><span class="sxs-lookup"><span data-stu-id="83183-129">In the left pane of the **Receive Port Properties** dialog box, select **Receive Locations**, and in the right pane click **New** to create a new receive location.</span></span>  
  
4.  <span data-ttu-id="83183-130">在**接收位置属性**对话框中，在**传输**部分中，选择**SB 消息**从**类型**下拉列表然后单击**配置**若要配置接收位置的传输属性。</span><span class="sxs-lookup"><span data-stu-id="83183-130">In the **Receive Location Properties** dialog box, in the **Transport** section, select **SB-Messaging** from the **Type** drop-down list, and then click **Configure** to configure the transport properties for the receive location.</span></span>  
  
5.  <span data-ttu-id="83183-131">在**SB 消息传输属性**对话框中，在**常规**选项卡上，执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="83183-131">In the **SB-Messaging Transport Properties** dialog box, in the **General** tab, do the following:</span></span>  
  
    |<span data-ttu-id="83183-132">使用此选项</span><span class="sxs-lookup"><span data-stu-id="83183-132">Use this</span></span>|<span data-ttu-id="83183-133">执行的操作</span><span class="sxs-lookup"><span data-stu-id="83183-133">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="83183-134">**队列或订阅的 URL**</span><span class="sxs-lookup"><span data-stu-id="83183-134">**Queue or Subscription URL**</span></span>|<span data-ttu-id="83183-135">指定在其中部署 Service Bus 队列的 URL。</span><span class="sxs-lookup"><span data-stu-id="83183-135">Specify the URL where the Service Bus queue is deployed.</span></span> <span data-ttu-id="83183-136">通常此 URL 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="83183-136">Typically the URL is in the following format:</span></span><br /><br /> `sb://<namespace>.servicebus.windows.net/<queue_name>`|  
    |<span data-ttu-id="83183-137">**打开超时**</span><span class="sxs-lookup"><span data-stu-id="83183-137">**Open Timeout**</span></span>|<span data-ttu-id="83183-138">指定一个时间跨度值来表示完成信道打开操作的时间。</span><span class="sxs-lookup"><span data-stu-id="83183-138">Specifies a time span value that indicates the time for a channel open operation to complete.</span></span><br /><br /> <span data-ttu-id="83183-139">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="83183-139">**Default value:** 1 minute</span></span>|  
    |<span data-ttu-id="83183-140">**关闭超时**</span><span class="sxs-lookup"><span data-stu-id="83183-140">**Close Timeout**</span></span>|<span data-ttu-id="83183-141">指定一个时间跨度值来表示完成信道关闭操作的时间。</span><span class="sxs-lookup"><span data-stu-id="83183-141">Specifies a time span value that indicates the time for a channel close operation to complete.</span></span><br /><br /> <span data-ttu-id="83183-142">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="83183-142">**Default value:** 1 minute</span></span>|  
    |<span data-ttu-id="83183-143">**接收超时**</span><span class="sxs-lookup"><span data-stu-id="83183-143">**Receive timeout**</span></span>|<span data-ttu-id="83183-144">指定一个时间跨度值来表示完成接收操作的时间。</span><span class="sxs-lookup"><span data-stu-id="83183-144">Specifies a time span value that indicates the time for a receive operation to complete.</span></span><br /><br /> <span data-ttu-id="83183-145">**默认值：** 10 分钟</span><span class="sxs-lookup"><span data-stu-id="83183-145">**Default value:** 10 minutes</span></span>|  
    |<span data-ttu-id="83183-146">**预提取计数**</span><span class="sxs-lookup"><span data-stu-id="83183-146">**Prefetch count**</span></span>|<span data-ttu-id="83183-147">指定同时从 Service Bus 队列或主题收到的消息数。</span><span class="sxs-lookup"><span data-stu-id="83183-147">Specifies the number of messages that are received simultaneously from the Service Bus Queue or a topic.</span></span> <span data-ttu-id="83183-148">通过预获取，队列或订阅客户端可以在执行接收操作时从服务加载其他消息。</span><span class="sxs-lookup"><span data-stu-id="83183-148">Prefetching enables the queue or subscription client to load additional messages from the service when it performs a receive operation.</span></span> <span data-ttu-id="83183-149">客户端将这些消息存储在本地缓存中。</span><span class="sxs-lookup"><span data-stu-id="83183-149">The client stores these messages in a local cache.</span></span> <span data-ttu-id="83183-150">缓存的大小由你在此处指定的“Prefetch 计数”属性的值决定。</span><span class="sxs-lookup"><span data-stu-id="83183-150">The size of the cache is determined by the value for the Prefetch Count property you specify here.</span></span><br /><br /> <span data-ttu-id="83183-151">有关详细信息，请参阅部分"预提取"在[https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/)</span><span class="sxs-lookup"><span data-stu-id="83183-151">For more information, refer to the section “Prefetching” at [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/)</span></span><br /><br /> <span data-ttu-id="83183-152">**默认值：** -1</span><span class="sxs-lookup"><span data-stu-id="83183-152">**Default value:** -1</span></span>|  
    |<span data-ttu-id="83183-153">**使用会话**</span><span class="sxs-lookup"><span data-stu-id="83183-153">**Use Session**</span></span>|<span data-ttu-id="83183-154">选择此复选框可使用 Service Bus 会话从队列或订阅接收消息。</span><span class="sxs-lookup"><span data-stu-id="83183-154">Select this check box to use a Service Bus session to receive messages from a queue or a subscription.</span></span>|  
  
6.  <span data-ttu-id="83183-155">在**身份验证**选项卡上，执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="83183-155">In the **Authentication** tab, do the following:</span></span>  
  
    |<span data-ttu-id="83183-156">使用此选项</span><span class="sxs-lookup"><span data-stu-id="83183-156">Use this</span></span>|<span data-ttu-id="83183-157">执行的操作</span><span class="sxs-lookup"><span data-stu-id="83183-157">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="83183-158">**访问控制服务**</span><span class="sxs-lookup"><span data-stu-id="83183-158">**Access Control Service**</span></span>|<span data-ttu-id="83183-159">选择此项可使用 ACS 进行身份验证并提供以下值：</span><span class="sxs-lookup"><span data-stu-id="83183-159">Select this to use ACS for authentication and provide the following values:</span></span><br /><br /> <span data-ttu-id="83183-160">-输入的服务总线访问控制服务 STS URI。</span><span class="sxs-lookup"><span data-stu-id="83183-160">- Enter the Service Bus Access Control Service STS URI.</span></span> <span data-ttu-id="83183-161">通常此 URI 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="83183-161">Typically the URI is in the following format:</span></span><br /><br /> `https://<namespace>-sb.accesscontrol.windows.net/`<br /><br /> <span data-ttu-id="83183-162">-输入 Service Bus 命名空间的颁发者名称。</span><span class="sxs-lookup"><span data-stu-id="83183-162">- Enter the issuer name for the Service Bus namespace.</span></span><br /><br /> <span data-ttu-id="83183-163">-输入 Service Bus 命名空间的颁发者密钥。</span><span class="sxs-lookup"><span data-stu-id="83183-163">- Enter the issuer key for the Service Bus namespace.</span></span>|  
    |<span data-ttu-id="83183-164">**共享访问签名**(新开头[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span><span class="sxs-lookup"><span data-stu-id="83183-164">**Shared Access Signature** (new starting with [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span></span>|<span data-ttu-id="83183-165">选择此项可使用共享访问签名 (SAS) 进行身份验证，并提供 SAS 密钥名和密钥值。</span><span class="sxs-lookup"><span data-stu-id="83183-165">Select this to use Shared Access Signature (SAS) for authentication, and provide the SAS key name and key value.</span></span>|  
  
7.  <span data-ttu-id="83183-166">在**属性**选项卡上，在**中转消息属性的 Namespace**字段中，指定适配器使用编写中转的消息属性作为消息上下文属性上的命名空间接收的消息[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="83183-166">In the **Properties** tab, in the **Namespace for Brokered Message Properties** field, specify the namespace that the adapter uses to write the brokered message properties as message context properties on the message received by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="83183-167">此外，如果你想要升级的中转的消息属性，则选择**提升中转消息属性**复选框。</span><span class="sxs-lookup"><span data-stu-id="83183-167">Additionally, if you want to promote the brokered message properties, select the **Promote Brokered Message Properties** check box.</span></span>  
  
8.  <span data-ttu-id="83183-168">单击 **“确定”**。</span><span class="sxs-lookup"><span data-stu-id="83183-168">Click **OK**.</span></span>  
  
9. <span data-ttu-id="83183-169">在“接收位置属性”  对话框中输入相应的值，完成对接收位置的配置，然后单击“确定”  保存设置。</span><span class="sxs-lookup"><span data-stu-id="83183-169">Enter the appropriate values in the **Receive Location Properties** dialog box to complete the configuration of the receive location and click **OK** to save settings.</span></span> <span data-ttu-id="83183-170">璝惠**接收位置属性**对话框中，请参阅[如何创建接收位置](../core/how-to-create-a-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="83183-170">For information about the **Receive Locations Properties** dialog box, see [How to Create a Receive Location](../core/how-to-create-a-receive-location.md).</span></span>  
  
## <a name="send-messages-to-service-bus"></a><span data-ttu-id="83183-171">将消息发送到 Service Bus</span><span class="sxs-lookup"><span data-stu-id="83183-171">Send messages to Service Bus</span></span>
<span data-ttu-id="83183-172">本部分提供有关如何配置信息**SB 消息**发送端口使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理控制台。</span><span class="sxs-lookup"><span data-stu-id="83183-172">This section provides information on how to configure an **SB-Messaging** send port using the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console.</span></span>  
  
1.  <span data-ttu-id="83183-173">在 BizTalk Server 管理控制台中，创建新的发送端口或双击现有的发送端口来对其进行修改。</span><span class="sxs-lookup"><span data-stu-id="83183-173">In the BizTalk Server Administration console, create a new send port or double-click an existing send port to modify it.</span></span> <span data-ttu-id="83183-174">有关详细信息，请参阅[如何创建发送端口](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="83183-174">For more information, see [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span> <span data-ttu-id="83183-175">配置所有发送端口选项并指定**SB 消息**为**类型**选项**传输**部分**常规**选项卡。</span><span class="sxs-lookup"><span data-stu-id="83183-175">Configure all of the send port options and specify **SB-Messaging** for the **Type** option in the **Transport** section of the **General** tab.</span></span>  
  
2.  <span data-ttu-id="83183-176">上**常规**选项卡上，在**传输**部分中，单击**配置**按钮。</span><span class="sxs-lookup"><span data-stu-id="83183-176">On the **General** tab, in the **Transport** section, click the **Configure** button.</span></span>  
  
3.  <span data-ttu-id="83183-177">在**SB 消息传输属性**对话框中，在**常规**选项卡上，指定下列各项：</span><span class="sxs-lookup"><span data-stu-id="83183-177">In the **SB-Messaging Transport Properties** dialog box, on the **General** tab, specify the following:</span></span>  
  
    |<span data-ttu-id="83183-178">使用此选项</span><span class="sxs-lookup"><span data-stu-id="83183-178">Use this</span></span>|<span data-ttu-id="83183-179">执行的操作</span><span class="sxs-lookup"><span data-stu-id="83183-179">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="83183-180">**目标 URL**</span><span class="sxs-lookup"><span data-stu-id="83183-180">**Destination URL**</span></span>|<span data-ttu-id="83183-181">输入其中部署 Service Bus 队列的 URL。</span><span class="sxs-lookup"><span data-stu-id="83183-181">Enter the URL where the Service Bus queue is deployed.</span></span> <span data-ttu-id="83183-182">通常此 URL 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="83183-182">Typically the URL is in the following format:</span></span><br /><br /> `sb://<namespace>.servicebus.windows.net/<queue_name>`|  
    |<span data-ttu-id="83183-183">**批处理刷新间隔**</span><span class="sxs-lookup"><span data-stu-id="83183-183">**Batch Flush Interval**</span></span>|<span data-ttu-id="83183-184">指定一个时间跨度值来表示向队列发送消息批或刷新主题的时间间隔。</span><span class="sxs-lookup"><span data-stu-id="83183-184">Specifies a time span value that indicates the interval when the message batches being sent to a Queue or a Topic are flushed.</span></span> <span data-ttu-id="83183-185">默认值为 20 毫秒。</span><span class="sxs-lookup"><span data-stu-id="83183-185">The default value is 20 milliseconds.</span></span><br /><br /> <span data-ttu-id="83183-186">有关 Service Bus 队列和主题方面对批处理的详细信息，请参阅**客户端批处理**部分[https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements)。</span><span class="sxs-lookup"><span data-stu-id="83183-186">For more information about batching with respect to Service Bus Queues and Topics, see the **Client-side batching** section at [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements).</span></span>|  
    |<span data-ttu-id="83183-187">**打开超时**</span><span class="sxs-lookup"><span data-stu-id="83183-187">**Open Timeout**</span></span>|<span data-ttu-id="83183-188">指定一个时间跨度值来表示完成信道打开操作的时间。</span><span class="sxs-lookup"><span data-stu-id="83183-188">Specifies a time span value that indicates the time for a channel open operation to complete.</span></span><br /><br /> <span data-ttu-id="83183-189">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="83183-189">**Default value:** 1 minute</span></span>|  
    |<span data-ttu-id="83183-190">**发送超时时**</span><span class="sxs-lookup"><span data-stu-id="83183-190">**Send Timeout**</span></span>|<span data-ttu-id="83183-191">指定一个时间跨度值来表示完成发送操作的时间。</span><span class="sxs-lookup"><span data-stu-id="83183-191">Specifies a time span value that indicates the time for a send operation to complete.</span></span><br /><br /> <span data-ttu-id="83183-192">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="83183-192">**Default value:** 1 minute</span></span>|  
    |<span data-ttu-id="83183-193">**关闭超时**</span><span class="sxs-lookup"><span data-stu-id="83183-193">**Close Timeout**</span></span>|<span data-ttu-id="83183-194">指定一个时间跨度值来表示完成信道关闭操作的时间。</span><span class="sxs-lookup"><span data-stu-id="83183-194">Specifies a time span value that indicates the time for a channel close operation to complete.</span></span><br /><br /> <span data-ttu-id="83183-195">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="83183-195">**Default value:** 1 minute</span></span>|  
  
4.  <span data-ttu-id="83183-196">在**身份验证**选项卡上，执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="83183-196">In the **Authentication** tab, do the following:</span></span>  
  
    |<span data-ttu-id="83183-197">使用此选项</span><span class="sxs-lookup"><span data-stu-id="83183-197">Use this</span></span>|<span data-ttu-id="83183-198">执行的操作</span><span class="sxs-lookup"><span data-stu-id="83183-198">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="83183-199">**访问控制服务**</span><span class="sxs-lookup"><span data-stu-id="83183-199">**Access Control Service**</span></span>|<span data-ttu-id="83183-200">选择此项可使用 ACS 进行身份验证并提供以下值：</span><span class="sxs-lookup"><span data-stu-id="83183-200">Select this to use ACS for authentication and provide the following values:</span></span><br /><br /> <span data-ttu-id="83183-201">-输入的服务总线访问控制服务 STS URI。</span><span class="sxs-lookup"><span data-stu-id="83183-201">- Enter the Service Bus Access Control Service STS URI.</span></span> <span data-ttu-id="83183-202">通常此 URI 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="83183-202">Typically the URI is in the following format:</span></span><br /><br /> `https://<namespace>-sb.accesscontrol.windows.net/`<br /><br /> <span data-ttu-id="83183-203">-输入 Service Bus 命名空间的颁发者名称。</span><span class="sxs-lookup"><span data-stu-id="83183-203">- Enter the issuer name for the Service Bus namespace.</span></span><br /><br /> <span data-ttu-id="83183-204">-输入 Service Bus 命名空间的颁发者密钥。</span><span class="sxs-lookup"><span data-stu-id="83183-204">- Enter the issuer key for the Service Bus namespace.</span></span>|  
    |<span data-ttu-id="83183-205">**共享访问签名**(新开头[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span><span class="sxs-lookup"><span data-stu-id="83183-205">**Shared Access Signature** (new starting with [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span></span>|<span data-ttu-id="83183-206">选择此项可使用共享访问签名 (SAS) 进行身份验证，并提供 SAS 密钥名和密钥值。</span><span class="sxs-lookup"><span data-stu-id="83183-206">Select this to use Shared Access Signature (SAS) for authentication, and provide the SAS key name and key value.</span></span>|  
  
5.  <span data-ttu-id="83183-207">在**属性**选项卡上，在**Namespace 用户定义的中转消息属性**字段中，指定包含你想要编写作为 BizTalk 消息上下文属性的命名空间用户定义的中转消息属性的传出消息发送到 Service Bus 队列。</span><span class="sxs-lookup"><span data-stu-id="83183-207">In the **Properties** tab, in the **Namespace for the user defined Brokered Message Properties** field, specify the namespace that contains the BizTalk message context properties that you want to write as user-defined Brokered Message properties on the outgoing message sent to the Service Bus Queue.</span></span> <span data-ttu-id="83183-208">所有属于该命名空间的属性将作为用户定义的异步传输消息属性写入到消息中。</span><span class="sxs-lookup"><span data-stu-id="83183-208">All the properties that belong to the namespace are written to the message as user-defined Brokered Message properties.</span></span> <span data-ttu-id="83183-209">当写入作为异步传输消息属性的属性时，适配器将忽略该命名空间。</span><span class="sxs-lookup"><span data-stu-id="83183-209">The adapter ignores the namespace while writing the properties as Brokered Message properties.</span></span> <span data-ttu-id="83183-210">它仅将该命名空间用于确定要写入哪些属性。</span><span class="sxs-lookup"><span data-stu-id="83183-210">It uses the namespace only to ascertain what properties to write.</span></span>  
  
     <span data-ttu-id="83183-211">你还可以指定 BrokeredMessage 属性的值。</span><span class="sxs-lookup"><span data-stu-id="83183-211">You can also specify the values for the BrokeredMessage properties.</span></span> <span data-ttu-id="83183-212">有关属性的详细信息，请参阅[BrokeredMessage 属性](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.brokeredmessage_properties.aspx)。</span><span class="sxs-lookup"><span data-stu-id="83183-212">For more information about the properties, see [BrokeredMessage Properties](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.brokeredmessage_properties.aspx).</span></span>  
  
6.  <span data-ttu-id="83183-213">单击**确定**和**确定**再次以保存设置。</span><span class="sxs-lookup"><span data-stu-id="83183-213">Click **OK** and **OK** again to save settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="83183-214">另请参阅</span><span class="sxs-lookup"><span data-stu-id="83183-214">See also</span></span>
[<span data-ttu-id="83183-215">使用适配器</span><span class="sxs-lookup"><span data-stu-id="83183-215">Using adapters</span></span>](../core/using-adapters.md)