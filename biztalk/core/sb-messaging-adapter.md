---
title: 服务总线消息传送适配器 |Microsoft Docs
description: 发送和接收消息在 BizTalk Server 中使用 Azure SB 消息适配器
ms.custom: ''
ms.date: 11/21/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c06c4934-45b2-4f6f-9d19-3ebd937c32ae
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d050a2f2b4435daa0ea2bff8b7f2a2f19456d624
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65309399"
---
# <a name="sb-messaging-adapter"></a><span data-ttu-id="0b382-103">SB 消息适配器</span><span class="sxs-lookup"><span data-stu-id="0b382-103">SB-Messaging Adapter</span></span>
<span data-ttu-id="0b382-104">服务总线 (**SB 消息**) 适配器用于接收和发送从服务总线实体，例如队列、 主题和中继。</span><span class="sxs-lookup"><span data-stu-id="0b382-104">The Service Bus (**SB-Messaging**) adapter is used to receive and send from Service Bus entities like Queues, Topics, and Relays.</span></span> <span data-ttu-id="0b382-105">可以使用**Sb-messaging**适配器来连接本地[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]到 Azure。</span><span class="sxs-lookup"><span data-stu-id="0b382-105">You can use the **SB-Messaging** adapter to connect your on-premises [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to Azure.</span></span>

<span data-ttu-id="0b382-106">**从开始[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]功能包 2**，支持服务总线高级版。</span><span class="sxs-lookup"><span data-stu-id="0b382-106">**Starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] Feature Pack 2**, Service Bus Premium is supported.</span></span> <span data-ttu-id="0b382-107">在配置使用此适配器的发送端口，可以将消息发送到分区的队列和主题。</span><span class="sxs-lookup"><span data-stu-id="0b382-107">When configuring a send port using this adapter, you can send messages to partitioned queues and topics.</span></span> 

## <a name="authenticating-with-service-bus"></a><span data-ttu-id="0b382-108">使用服务总线进行身份验证</span><span class="sxs-lookup"><span data-stu-id="0b382-108">Authenticating with Service Bus</span></span>
<span data-ttu-id="0b382-109">服务总线提供两种方法进行身份验证：</span><span class="sxs-lookup"><span data-stu-id="0b382-109">Service Bus provides two methods to authenticate:</span></span> 

- <span data-ttu-id="0b382-110">访问控制服务 (ACS)</span><span class="sxs-lookup"><span data-stu-id="0b382-110">Access Control Service (ACS)</span></span> 
- <span data-ttu-id="0b382-111">共享访问签名 (SAS)</span><span class="sxs-lookup"><span data-stu-id="0b382-111">Shared Access Signature (SAS)</span></span>

<span data-ttu-id="0b382-112">我们建议使用共享访问签名 (SAS) 来使用服务总线进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="0b382-112">We recommend using Shared Access Signature (SAS) to authenticate with Service Bus.</span></span> <span data-ttu-id="0b382-113">中列出的共享访问密钥值[Azure 门户](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="0b382-113">The Shared Access Key value is listed in the [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="0b382-114">在创建服务总线命名空间时，不自动创建 Access Control (ACS) 命名空间。</span><span class="sxs-lookup"><span data-stu-id="0b382-114">When you create a Service Bus namespace, the Access Control (ACS) namespace is not automatically created.</span></span> <span data-ttu-id="0b382-115">若要使用访问控制，需要此命名空间的颁发者名称和颁发者密钥值。</span><span class="sxs-lookup"><span data-stu-id="0b382-115">To use Access Control, you need the Issuer Name and Issuer Key values of this namespace.</span></span> <span data-ttu-id="0b382-116">创建新的 ACS 命名空间使用 Windows PowerShell 时，这些值都可用。</span><span class="sxs-lookup"><span data-stu-id="0b382-116">These values are available when you create a new ACS namespace using Windows PowerShell.</span></span> <span data-ttu-id="0b382-117">在 Azure 门户中未列出这些值。</span><span class="sxs-lookup"><span data-stu-id="0b382-117">These values are not listed in the Azure portal.</span></span>

<span data-ttu-id="0b382-118">若要使用 ACS 进行身份验证，并获取颁发者名称和颁发者密钥值，总体步骤包括：</span><span class="sxs-lookup"><span data-stu-id="0b382-118">To use ACS for authentication, and get the Issuer Name and Issuer Key values, the overall steps include:</span></span>

1. <span data-ttu-id="0b382-119">安装[Azure Powershell cmdlet](https://azure.microsoft.com/documentation/articles/powershell-install-configure/)。</span><span class="sxs-lookup"><span data-stu-id="0b382-119">Install the [Azure Powershell cmdlets](https://azure.microsoft.com/documentation/articles/powershell-install-configure/).</span></span>
2. <span data-ttu-id="0b382-120">添加 Azure 帐户： `Add-AzureAccount`</span><span class="sxs-lookup"><span data-stu-id="0b382-120">Add your Azure account: `Add-AzureAccount`</span></span>
3. <span data-ttu-id="0b382-121">返回你的订阅名称： `get-azuresubscription`</span><span class="sxs-lookup"><span data-stu-id="0b382-121">Return your subscription name: `get-azuresubscription`</span></span>
4. <span data-ttu-id="0b382-122">选择你的订阅： `select-azuresubscription <name of your subscription>`</span><span class="sxs-lookup"><span data-stu-id="0b382-122">Select your subscription: `select-azuresubscription <name of your subscription>`</span></span> 
5. <span data-ttu-id="0b382-123">创建新的命名空间： `new-azuresbnamespace <name for the service bus> "Location" -CreateACSNamespace $true -NamespaceType Messaging`</span><span class="sxs-lookup"><span data-stu-id="0b382-123">Create a new namespace: `new-azuresbnamespace <name for the service bus> "Location" -CreateACSNamespace $true -NamespaceType Messaging`</span></span>

    <span data-ttu-id="0b382-124">示例：    `new-azuresbnamespace biztalksbnamespace "South Central US" -CreateACSNamespace $true -NamespaceType Messaging`</span><span class="sxs-lookup"><span data-stu-id="0b382-124">Example:    `new-azuresbnamespace biztalksbnamespace "South Central US" -CreateACSNamespace $true -NamespaceType Messaging`</span></span>

5. <span data-ttu-id="0b382-125">创建新的 ACS 命名空间时 （这可能需要几分钟时间），在连接字符串中列出了 IssuerName 和 IssuerKey 值：</span><span class="sxs-lookup"><span data-stu-id="0b382-125">When the new ACS namespace is created (which can take several minutes), the IssuerName and IssuerKey values are listed in the connection string:</span></span> 

    ```
    Name                  : biztalksbnamespace
    Region                : South Central US
    DefaultKey            : abcdefghijklmnopqrstuvwxyz
    Status                : Active
    CreatedAt             : 10/18/2016 9:36:30 PM
    AcsManagementEndpoint : https://biztalksbnamespace-sb.accesscontrol.windows.net/
    ServiceBusEndpoint    : https://biztalksbnamespace.servicebus.windows.net/
    ConnectionString      : Endpoint=sb://biztalksbnamespace.servicebus.windows.net/;SharedSecretIssuer=owner;SharedSecretValue=abcdefghijklmnopqrstuvwxyz
    NamespaceType         : Messaging
    ```

<span data-ttu-id="0b382-126">请参阅[New-azuresbnamespace](https://docs.microsoft.com/powershell/module/Azure/New-AzureSBNamespace)有关的指南。</span><span class="sxs-lookup"><span data-stu-id="0b382-126">See [New-AzureSBNamespace](https://docs.microsoft.com/powershell/module/Azure/New-AzureSBNamespace) for guidance.</span></span>

## <a name="receive-messages-from-service-bus"></a><span data-ttu-id="0b382-127">从服务总线接收消息</span><span class="sxs-lookup"><span data-stu-id="0b382-127">Receive messages from Service Bus</span></span>

1. <span data-ttu-id="0b382-128">在 BizTalk Server 管理控制台中，展开**BizTalk 组**，展开**应用程序**，然后展开你的应用程序。</span><span class="sxs-lookup"><span data-stu-id="0b382-128">In the BizTalk Server Administration console, expand **BizTalk Group**, expand **Applications**, and then expand your application.</span></span> 

2. <span data-ttu-id="0b382-129">右键单击**接收端口**，选择**新建**，然后选择**单向接收端口**。</span><span class="sxs-lookup"><span data-stu-id="0b382-129">Right-click **Receive Ports**, select **New**, and select **One-Way receive port**.</span></span> 

3. <span data-ttu-id="0b382-130">为其提供一个名称，然后选择**接收位置**。</span><span class="sxs-lookup"><span data-stu-id="0b382-130">Give it a name, and select **Receive Locations**.</span></span> 

4. <span data-ttu-id="0b382-131">选择**新建**，为其提供**名称**。</span><span class="sxs-lookup"><span data-stu-id="0b382-131">Select **New**, give it a **Name**.</span></span> <span data-ttu-id="0b382-132">在中**传输**部分中，选择**SB 消息**从**类型**下拉列表，然后选择**配置**。</span><span class="sxs-lookup"><span data-stu-id="0b382-132">In the **Transport** section, select **SB-Messaging** from the **Type** drop-down list, and then select **Configure**.</span></span>  

5. <span data-ttu-id="0b382-133">配置**常规**属性：</span><span class="sxs-lookup"><span data-stu-id="0b382-133">Configure the **General** properties:</span></span>  


   |           <span data-ttu-id="0b382-134">使用此选项</span><span class="sxs-lookup"><span data-stu-id="0b382-134">Use this</span></span>            |                                                                                                                                                                                                                                                                                                                                              <span data-ttu-id="0b382-135">执行的操作</span><span class="sxs-lookup"><span data-stu-id="0b382-135">To do this</span></span>                                                                                                                                                                                                                                                                                                                                               |
   |-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | <span data-ttu-id="0b382-136">**队列或订阅 URL**</span><span class="sxs-lookup"><span data-stu-id="0b382-136">**Queue or Subscription URL**</span></span> |                                                                                                                                                                                                                                                               <span data-ttu-id="0b382-137">指定部署的服务总线队列的 URL。</span><span class="sxs-lookup"><span data-stu-id="0b382-137">Specify the URL where the Service Bus queue is deployed.</span></span> <span data-ttu-id="0b382-138">通常此 URL 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="0b382-138">Typically the URL is in the following format:</span></span><br /><br /> `sb://<namespace>.servicebus.windows.net/<queue_name>`                                                                                                                                                                                                                                                               |
   |       <span data-ttu-id="0b382-139">**打开超时**</span><span class="sxs-lookup"><span data-stu-id="0b382-139">**Open Timeout**</span></span>        |                                                                                                                                                                                                                                                                                 <span data-ttu-id="0b382-140">指定一个时间跨度值，该值指示信道打开操作完成的时间。</span><span class="sxs-lookup"><span data-stu-id="0b382-140">Specifies a time span value that indicates the time for a channel open operation to complete.</span></span><br /><br /> <span data-ttu-id="0b382-141">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="0b382-141">**Default value:** 1 minute</span></span>                                                                                                                                                                                                                                                                                 |
   |       <span data-ttu-id="0b382-142">**关闭超时**</span><span class="sxs-lookup"><span data-stu-id="0b382-142">**Close Timeout**</span></span>       |                                                                                                                                                                                                                                                                                <span data-ttu-id="0b382-143">指定一个时间跨度值，该值指示信道关闭操作完成的时间。</span><span class="sxs-lookup"><span data-stu-id="0b382-143">Specifies a time span value that indicates the time for a channel close operation to complete.</span></span><br /><br /> <span data-ttu-id="0b382-144">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="0b382-144">**Default value:** 1 minute</span></span>                                                                                                                                                                                                                                                                                 |
   |      <span data-ttu-id="0b382-145">**接收超时**</span><span class="sxs-lookup"><span data-stu-id="0b382-145">**Receive timeout**</span></span>      |                                                                                                                                                                                                                                                                                  <span data-ttu-id="0b382-146">指定一个时间跨度值，该值指示为完成接收操作的时间。</span><span class="sxs-lookup"><span data-stu-id="0b382-146">Specifies a time span value that indicates the time for a receive operation to complete.</span></span><br /><br /> <span data-ttu-id="0b382-147">**默认值：** 10 分钟。</span><span class="sxs-lookup"><span data-stu-id="0b382-147">**Default value:** 10 minutes</span></span>                                                                                                                                                                                                                                                                                   |
   |      <span data-ttu-id="0b382-148">**预提取计数**</span><span class="sxs-lookup"><span data-stu-id="0b382-148">**Prefetch count**</span></span>       | <span data-ttu-id="0b382-149">指定同时接收来自服务总线队列或主题的消息数。</span><span class="sxs-lookup"><span data-stu-id="0b382-149">Specifies the number of messages that are received simultaneously from the Service Bus Queue or a topic.</span></span> <span data-ttu-id="0b382-150">预提取使队列或订阅客户端执行接收操作时从服务加载其他消息。</span><span class="sxs-lookup"><span data-stu-id="0b382-150">Prefetching enables the queue or subscription client to load additional messages from the service when it performs a receive operation.</span></span> <span data-ttu-id="0b382-151">客户端将这些消息存储在本地缓存中。</span><span class="sxs-lookup"><span data-stu-id="0b382-151">The client stores these messages in a local cache.</span></span> <span data-ttu-id="0b382-152">缓存的大小由你在此处指定的预提取计数属性值确定。</span><span class="sxs-lookup"><span data-stu-id="0b382-152">The size of the cache is determined by the value for the Prefetch Count property you specify here.</span></span><br /><br /> <span data-ttu-id="0b382-153">有关详细信息，请参阅部分"预提取"时 [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/)</span><span class="sxs-lookup"><span data-stu-id="0b382-153">For more information, refer to the section “Prefetching” at [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/)</span></span><br /><br /> <span data-ttu-id="0b382-154">**默认值：** -1</span><span class="sxs-lookup"><span data-stu-id="0b382-154">**Default value:** -1</span></span> |
   |        <span data-ttu-id="0b382-155">**使用会话**</span><span class="sxs-lookup"><span data-stu-id="0b382-155">**Use Session**</span></span>        |                                                                                                                                                                                                                                                                                                <span data-ttu-id="0b382-156">选中此复选框以使用 Service Bus 会话从队列或订阅接收消息。</span><span class="sxs-lookup"><span data-stu-id="0b382-156">Select this check box to use a Service Bus session to receive messages from a queue or a subscription.</span></span>                                                                                                                                                                                                                                                                                                 |


6. <span data-ttu-id="0b382-157">配置**身份验证**属性：</span><span class="sxs-lookup"><span data-stu-id="0b382-157">Configure the **Authentication** properties:</span></span>  


   |                                               <span data-ttu-id="0b382-158">使用此选项</span><span class="sxs-lookup"><span data-stu-id="0b382-158">Use this</span></span>                                                |                                                                                                                                                                                             <span data-ttu-id="0b382-159">执行的操作</span><span class="sxs-lookup"><span data-stu-id="0b382-159">To do this</span></span>                                                                                                                                                                                             |
   |-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |                                      <span data-ttu-id="0b382-160">**访问控制服务**</span><span class="sxs-lookup"><span data-stu-id="0b382-160">**Access Control Service**</span></span>                                       | <span data-ttu-id="0b382-161">选择此选项可使用 ACS 进行身份验证并提供以下值：</span><span class="sxs-lookup"><span data-stu-id="0b382-161">Select this to use ACS for authentication and provide the following values:</span></span><br /><br /> <span data-ttu-id="0b382-162">-输入服务总线访问控制服务 STS URI。</span><span class="sxs-lookup"><span data-stu-id="0b382-162">- Enter the Service Bus Access Control Service STS URI.</span></span> <span data-ttu-id="0b382-163">通常此 URI 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="0b382-163">Typically the URI is in the following format:</span></span><br /><br /> `https://<namespace>-sb.accesscontrol.windows.net/`<br /><br /> <span data-ttu-id="0b382-164">-输入服务总线命名空间的颁发者名称。</span><span class="sxs-lookup"><span data-stu-id="0b382-164">- Enter the issuer name for the Service Bus namespace.</span></span><br /><br /> <span data-ttu-id="0b382-165">-输入服务总线命名空间的颁发者密钥。</span><span class="sxs-lookup"><span data-stu-id="0b382-165">- Enter the issuer key for the Service Bus namespace.</span></span> |
   | <span data-ttu-id="0b382-166">**共享访问签名**(新开头[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span><span class="sxs-lookup"><span data-stu-id="0b382-166">**Shared Access Signature** (new starting with [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span></span> |                                                                                                                                          <span data-ttu-id="0b382-167">选择此选项可使用共享访问签名 (SAS) 进行身份验证，并提供 SAS 密钥名称和密钥值。</span><span class="sxs-lookup"><span data-stu-id="0b382-167">Select this to use Shared Access Signature (SAS) for authentication, and provide the SAS key name and key value.</span></span>                                                                                                                                          |


7. <span data-ttu-id="0b382-168">在中**属性**选项卡上，在**异步传输消息属性的 Namespace**，输入适配器使用将中转的消息属性为消息上下文属性上的命名空间收到的消息[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0b382-168">In the **Properties** tab, in the **Namespace for Brokered Message Properties**, enter the namespace that the adapter uses to write the brokered message properties as message context properties on the message received by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="0b382-169">如果你想要升级的中转的消息属性，请选择**推广异步传输消息属性**复选框。</span><span class="sxs-lookup"><span data-stu-id="0b382-169">If you want to promote the brokered message properties, select the **Promote Brokered Message Properties** check box.</span></span>  

8. <span data-ttu-id="0b382-170">选择 **确定**。</span><span class="sxs-lookup"><span data-stu-id="0b382-170">Select **OK**.</span></span>  

9. <span data-ttu-id="0b382-171">选择你**接收处理程序**，并**接收管道**。</span><span class="sxs-lookup"><span data-stu-id="0b382-171">Select your **Receive handler**, and the **Receive pipeline**.</span></span> <span data-ttu-id="0b382-172">选择**确定**以保存所做的更改。</span><span class="sxs-lookup"><span data-stu-id="0b382-172">Select **OK** to save your changes.</span></span> <span data-ttu-id="0b382-173">[创建接收位置](../core/how-to-create-a-receive-location.md)提供一些指导。</span><span class="sxs-lookup"><span data-stu-id="0b382-173">[Create a Receive Location](../core/how-to-create-a-receive-location.md) provides some guidance.</span></span>  

## <a name="send-messages-to-service-bus"></a><span data-ttu-id="0b382-174">将消息发送到服务总线</span><span class="sxs-lookup"><span data-stu-id="0b382-174">Send messages to Service Bus</span></span>

1. <span data-ttu-id="0b382-175">在 BizTalk Server 管理控制台中，右键单击**发送端口**，选择**新建**，然后选择**静态单向发送端口**。</span><span class="sxs-lookup"><span data-stu-id="0b382-175">In the BizTalk Server Administration console, right-click **Send Ports**, select **New**, and select **Static One-way send port**.</span></span>

   <span data-ttu-id="0b382-176">[创建发送端口](../core/how-to-create-a-send-port2.md)提供一些指导。</span><span class="sxs-lookup"><span data-stu-id="0b382-176">[Create a Send Port](../core/how-to-create-a-send-port2.md) provides some guidance.</span></span>

2. <span data-ttu-id="0b382-177">输入**名称**。</span><span class="sxs-lookup"><span data-stu-id="0b382-177">Enter a **Name**.</span></span> <span data-ttu-id="0b382-178">在**传输**，请设置**类型**到**SB 消息**，然后选择**配置**。</span><span class="sxs-lookup"><span data-stu-id="0b382-178">In **Transport**, set the **Type** to **SB-Messaging**, and select **Configure**.</span></span> 

3. <span data-ttu-id="0b382-179">配置**常规**属性：</span><span class="sxs-lookup"><span data-stu-id="0b382-179">Configure the **General** properties:</span></span>  


   |         <span data-ttu-id="0b382-180">使用此选项</span><span class="sxs-lookup"><span data-stu-id="0b382-180">Use this</span></span>         |                                                                                                                                                                                                                                             <span data-ttu-id="0b382-181">执行的操作</span><span class="sxs-lookup"><span data-stu-id="0b382-181">To do this</span></span>                                                                                                                                                                                                                                              |
   |--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |   <span data-ttu-id="0b382-182">**目标 URL**</span><span class="sxs-lookup"><span data-stu-id="0b382-182">**Destination URL**</span></span>    |                                                                                                                                                               <span data-ttu-id="0b382-183">输入部署的服务总线队列的位置的 URL。</span><span class="sxs-lookup"><span data-stu-id="0b382-183">Enter the URL where the Service Bus queue is deployed.</span></span> <span data-ttu-id="0b382-184">通常此 URL 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="0b382-184">Typically the URL is in the following format:</span></span><br /><br /> `sb://<namespace>.servicebus.windows.net/<queue_name>`                                                                                                                                                               |
   | <span data-ttu-id="0b382-185">**批刷新时间间隔**</span><span class="sxs-lookup"><span data-stu-id="0b382-185">**Batch Flush Interval**</span></span> | <span data-ttu-id="0b382-186">指定一个时间跨度值，该值指示间隔时向队列发送消息批或刷新主题。</span><span class="sxs-lookup"><span data-stu-id="0b382-186">Specifies a time span value that indicates the interval when the message batches being sent to a Queue or a Topic are flushed.</span></span> <span data-ttu-id="0b382-187">默认值为 20 毫秒。</span><span class="sxs-lookup"><span data-stu-id="0b382-187">The default value is 20 milliseconds.</span></span><br /><br /> <span data-ttu-id="0b382-188">批处理服务总线队列和主题的详细信息，请参阅**客户端批处理**在部分[ https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements ](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements)。</span><span class="sxs-lookup"><span data-stu-id="0b382-188">For more information about batching with respect to Service Bus Queues and Topics, see the **Client-side batching** section at [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements).</span></span> |
   |     <span data-ttu-id="0b382-189">**打开超时**</span><span class="sxs-lookup"><span data-stu-id="0b382-189">**Open Timeout**</span></span>     |                                                                                                                                                                                <span data-ttu-id="0b382-190">指定一个时间跨度值，该值指示信道打开操作完成的时间。</span><span class="sxs-lookup"><span data-stu-id="0b382-190">Specifies a time span value that indicates the time for a channel open operation to complete.</span></span><br /><br /> <span data-ttu-id="0b382-191">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="0b382-191">**Default value:** 1 minute</span></span>                                                                                                                                                                                |
   |     <span data-ttu-id="0b382-192">**发送超时**</span><span class="sxs-lookup"><span data-stu-id="0b382-192">**Send Timeout**</span></span>     |                                                                                                                                                                                    <span data-ttu-id="0b382-193">指定一个时间跨度值，该值指示为完成发送操作的时间。</span><span class="sxs-lookup"><span data-stu-id="0b382-193">Specifies a time span value that indicates the time for a send operation to complete.</span></span><br /><br /> <span data-ttu-id="0b382-194">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="0b382-194">**Default value:** 1 minute</span></span>                                                                                                                                                                                    |
   |    <span data-ttu-id="0b382-195">**关闭超时**</span><span class="sxs-lookup"><span data-stu-id="0b382-195">**Close Timeout**</span></span>     |                                                                                                                                                                               <span data-ttu-id="0b382-196">指定一个时间跨度值，该值指示信道关闭操作完成的时间。</span><span class="sxs-lookup"><span data-stu-id="0b382-196">Specifies a time span value that indicates the time for a channel close operation to complete.</span></span><br /><br /> <span data-ttu-id="0b382-197">**默认值：** 1 分钟</span><span class="sxs-lookup"><span data-stu-id="0b382-197">**Default value:** 1 minute</span></span>                                                                                                                                                                                |


4. <span data-ttu-id="0b382-198">配置**身份验证**属性：</span><span class="sxs-lookup"><span data-stu-id="0b382-198">Configure the **Authentication** properties:</span></span> 


   |                                               <span data-ttu-id="0b382-199">使用此选项</span><span class="sxs-lookup"><span data-stu-id="0b382-199">Use this</span></span>                                                |                                                                                                                                                                                             <span data-ttu-id="0b382-200">执行的操作</span><span class="sxs-lookup"><span data-stu-id="0b382-200">To do this</span></span>                                                                                                                                                                                             |
   |-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |                                      <span data-ttu-id="0b382-201">**访问控制服务**</span><span class="sxs-lookup"><span data-stu-id="0b382-201">**Access Control Service**</span></span>                                       | <span data-ttu-id="0b382-202">选择此选项可使用 ACS 进行身份验证并提供以下值：</span><span class="sxs-lookup"><span data-stu-id="0b382-202">Select this to use ACS for authentication and provide the following values:</span></span><br /><br /> <span data-ttu-id="0b382-203">-输入服务总线访问控制服务 STS URI。</span><span class="sxs-lookup"><span data-stu-id="0b382-203">- Enter the Service Bus Access Control Service STS URI.</span></span> <span data-ttu-id="0b382-204">通常此 URI 的格式如下：</span><span class="sxs-lookup"><span data-stu-id="0b382-204">Typically the URI is in the following format:</span></span><br /><br /> `https://<namespace>-sb.accesscontrol.windows.net/`<br /><br /> <span data-ttu-id="0b382-205">-输入服务总线命名空间的颁发者名称。</span><span class="sxs-lookup"><span data-stu-id="0b382-205">- Enter the issuer name for the Service Bus namespace.</span></span><br /><br /> <span data-ttu-id="0b382-206">-输入服务总线命名空间的颁发者密钥。</span><span class="sxs-lookup"><span data-stu-id="0b382-206">- Enter the issuer key for the Service Bus namespace.</span></span> |
   | <span data-ttu-id="0b382-207">**共享访问签名**(新开头[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span><span class="sxs-lookup"><span data-stu-id="0b382-207">**Shared Access Signature** (new starting with [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span></span> |                                                                                                                                          <span data-ttu-id="0b382-208">选择此选项可使用共享访问签名 (SAS) 进行身份验证，并提供 SAS 密钥名称和密钥值。</span><span class="sxs-lookup"><span data-stu-id="0b382-208">Select this to use Shared Access Signature (SAS) for authentication, and provide the SAS key name and key value.</span></span>                                                                                                                                          |


5. <span data-ttu-id="0b382-209">在中**属性**选项卡上，输入**Namespace 为用户定义的中转消息属性**包含你想要编写的传出消息上的 BizTalk 消息上下文属性服务总线。</span><span class="sxs-lookup"><span data-stu-id="0b382-209">In the **Properties** tab, enter the **Namespace for the user defined Brokered Message Properties** that contains the BizTalk message context properties that you want to write on the outgoing message to Service Bus.</span></span> <span data-ttu-id="0b382-210">所有命名空间属性作为用户定义的中转消息属性写入消息。</span><span class="sxs-lookup"><span data-stu-id="0b382-210">All the namespace properties are written to the message as user-defined Brokered Message properties.</span></span> <span data-ttu-id="0b382-211">在编写为异步传输消息属性的属性时，则适配器将忽略该命名空间。</span><span class="sxs-lookup"><span data-stu-id="0b382-211">The adapter ignores the namespace while writing the properties as Brokered Message properties.</span></span> <span data-ttu-id="0b382-212">它使用命名空间只是为了确定要写入哪些属性。</span><span class="sxs-lookup"><span data-stu-id="0b382-212">It uses the namespace only to ascertain what properties to write.</span></span>  

    <span data-ttu-id="0b382-213">此外可以输入 BrokeredMessage 属性的值。</span><span class="sxs-lookup"><span data-stu-id="0b382-213">You can also enter the values for the BrokeredMessage properties.</span></span> <span data-ttu-id="0b382-214">这些属性，请参阅[BrokeredMessage 属性](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.brokeredmessage)，其中包括**分区键**。</span><span class="sxs-lookup"><span data-stu-id="0b382-214">These properties are described at [BrokeredMessage Properties](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.brokeredmessage), including the **Partition Key**.</span></span>

6. <span data-ttu-id="0b382-215">选择**确定**以保存所做的更改。</span><span class="sxs-lookup"><span data-stu-id="0b382-215">Select **OK** to save your changes.</span></span>  

## <a name="see-also"></a><span data-ttu-id="0b382-216">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0b382-216">See also</span></span>
[<span data-ttu-id="0b382-217">使用适配器</span><span class="sxs-lookup"><span data-stu-id="0b382-217">Using adapters</span></span>](../core/using-adapters.md)