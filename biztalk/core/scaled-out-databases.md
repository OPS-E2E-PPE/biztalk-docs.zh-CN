---
title: 向外扩展数据库 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- performance, databases [BAM]
- databases [BAM], high availability
- Archive database [BAM]
- Analysis database [BAM], high availability
- high availability, databases [BAM]
- MessageBox database, master database
- scaling, databases [BAM]
- scaling, BizTalk Server
- MessageBox database, multiple databases
- MessageBox database, clustering
- databases [BAM], scaling
- MessageBox database, routing
- Tracking database, scaling
- Primary Import database [BAM], clustering
- high availability, MessageBox database
- databases [BAM], performance
- Star Schema database [BAM]
- MessageBox database, high availability
- messages, disabling
- MSMQT adapters, See MSMQ adapters
- clustering, Analysis database [BAM]
- Windows Message Queuing
- MessageBox database
- Analysis database [BAM], clustering
- DTS packages, scheduling
ms.assetid: e02edc0d-1c51-4b97-be04-0feb787089ac
caps.latest.revision: 33
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6ca93333f1588a91df6b62641c30c684ac977237
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65309367"
---
# <a name="scaled-out-databases"></a><span data-ttu-id="aab60-102">向外扩展数据库</span><span class="sxs-lookup"><span data-stu-id="aab60-102">Scaled-Out Databases</span></span>
<span data-ttu-id="aab60-103">若要提供高可用性[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库，配置 Windows 群集中运行 SQL Server 的两台计算机。</span><span class="sxs-lookup"><span data-stu-id="aab60-103">To provide high availability for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, configure two computers that are running SQL Server in a Windows cluster.</span></span> <span data-ttu-id="aab60-104">这些计算机可以运行在主动/主动或主动/被动配置中以实现冗余和数据存储在共享驱动器 (例如 RAID 1 + 0 SCSI 磁盘阵列) 或存储区域网络 (SAN)。</span><span class="sxs-lookup"><span data-stu-id="aab60-104">These computers can run in an active/active or active/passive configuration for redundancy and store data on a shared drive (such as a RAID 1+0 SCSI disk array) or storage area network (SAN).</span></span>  
  
 <span data-ttu-id="aab60-105">如果出于任何原因，SQL Server 服务将变得不可用，则数据库群集会将资源从主动计算机传输到被动计算机。</span><span class="sxs-lookup"><span data-stu-id="aab60-105">If the SQL Server service becomes unavailable for any reason, the database cluster transfers resources from the active computer to the passive computer.</span></span> <span data-ttu-id="aab60-106">在此故障转移过程中，BizTalk Server 服务实例遇到数据库连接失败，并自动重新启动以重新连接到数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-106">During this failover process, the BizTalk Server service instances experience database connection failures and automatically restart to reconnect to the databases.</span></span> <span data-ttu-id="aab60-107">正常运行的数据库计算机 （以前的被动计算机） 开始处理故障转移期间假设资源后的数据库连接。</span><span class="sxs-lookup"><span data-stu-id="aab60-107">The functioning database computer (previously the passive computer) begins processing the database connections after assuming the resources during failover.</span></span>  
  
## <a name="running-multiple-messagebox-databases"></a><span data-ttu-id="aab60-108">运行多个 MessageBox 数据库</span><span class="sxs-lookup"><span data-stu-id="aab60-108">Running Multiple MessageBox Databases</span></span>  
 <span data-ttu-id="aab60-109">若要增强的可伸缩性[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库，可以配置 BizTalk Server 跨多个 MessageBox 数据库中存储数据。</span><span class="sxs-lookup"><span data-stu-id="aab60-109">To enhance the scalability of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you can configure BizTalk Server to store data across multiple MessageBox databases.</span></span> <span data-ttu-id="aab60-110">当您运行配置向导时创建的第一个 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-110">You create the first MessageBox database when you run the Configuration Wizard.</span></span> <span data-ttu-id="aab60-111">此 MessageBox 数据库是主 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-111">This MessageBox database is the master MessageBox database.</span></span> <span data-ttu-id="aab60-112">在 BizTalk Server 部署中没有一个主 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-112">There is a single master MessageBox database in your BizTalk Server deployment.</span></span> <span data-ttu-id="aab60-113">主 MessageBox 数据库包含主订阅信息，并将消息路由到相应的 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-113">The master MessageBox database contains the master subscription information and routes messages to the appropriate MessageBox database.</span></span> <span data-ttu-id="aab60-114">通常情况下，你想要将专用主 MessageBox，以执行仅路由 (选择**禁止发布新消息**)，并让其他 MessageBox 数据库进行处理。</span><span class="sxs-lookup"><span data-stu-id="aab60-114">Typically, you want to dedicate the master MessageBox to do routing only (select **Disable new message publication**) and let the other MessageBox databases do the processing.</span></span>  
  
 <span data-ttu-id="aab60-115">当主 MessageBox 数据库接收到新的激活消息，业务流程或订阅消息的新实例，主 MessageBox 数据库将分发到下一个可用的 MessageBox 数据库的激活消息。</span><span class="sxs-lookup"><span data-stu-id="aab60-115">When the master MessageBox database receives a new activation message—a brand new instance of a business process or a subscription message—the master MessageBox database distributes the activation message to the next available MessageBox database.</span></span> <span data-ttu-id="aab60-116">例如，如果您有一个主 MessageBox 数据库和两个 MessageBox 数据库，主 MessageBox 数据库将第一个激活消息路由到 MessageBox 数据库 1、 第二个激活消息到 MessageBox 数据库 2、 第三个激活消息到 MessageBox 数据库 1，轮循机制模式中，依此类推。</span><span class="sxs-lookup"><span data-stu-id="aab60-116">For example, if you have one master MessageBox database and two MessageBox databases, the master MessageBox database routes the first activation message to MessageBox database 1, the second activation message to MessageBox database 2, the third activation message to MessageBox database 1, and so on in a round-robin pattern.</span></span> <span data-ttu-id="aab60-117">主 MessageBox 数据库使用内置逻辑来进行负载平衡，并且无需其他负载平衡机制。</span><span class="sxs-lookup"><span data-stu-id="aab60-117">The master MessageBox database uses built-in logic to load balance, and does not need additional load-balancing mechanisms.</span></span>  
  
 <span data-ttu-id="aab60-118">主 MessageBox 数据库将激活消息路由到特定的 MessageBox 数据库 （例如，MessageBox 数据库 1） 后，业务流程将进入内存并运行。</span><span class="sxs-lookup"><span data-stu-id="aab60-118">After the master MessageBox database routes the activation message to a particular MessageBox database (for example, MessageBox database 1), the business process goes into memory and runs.</span></span> <span data-ttu-id="aab60-119">如果业务流程必须等待一条消息，并且等待时间超过几秒钟，业务流程保存回 MessageBox 数据库 1。</span><span class="sxs-lookup"><span data-stu-id="aab60-119">If the business process has to wait for a message, and the wait time is longer than several seconds, the business process is persisted back into MessageBox database 1.</span></span> <span data-ttu-id="aab60-120">业务流程正在等待相关消息。</span><span class="sxs-lookup"><span data-stu-id="aab60-120">The business process is waiting for a correlation message.</span></span> <span data-ttu-id="aab60-121">相关消息到达主 MessageBox 数据库，该消息执行查找操作数据库中包含的相关消息 （在此示例中，MessageBox 1） 的状态的 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-121">When the correlation message arrives at the master MessageBox database, the message does a lookup operation in the database for the MessageBox database that contains the state for the correlation message (in this example, MessageBox 1).</span></span> <span data-ttu-id="aab60-122">然后，主 MessageBox 数据库将消息传送到包含业务流程的 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-122">The master MessageBox database then delivers the message to the MessageBox database that contains the business process.</span></span> <span data-ttu-id="aab60-123">业务流程将返回到内存中以继续处理直到它完成或必须等待另一个相关消息。</span><span class="sxs-lookup"><span data-stu-id="aab60-123">The business process is then brought back into memory to continue processing until it finishes or until it has to wait for another correlation message.</span></span>  
  
 <span data-ttu-id="aab60-124">BizTalk Server MessageBox 数据库中存储的所有状态和每个 MessageBox 数据库包含不同的业务流程的状态信息。</span><span class="sxs-lookup"><span data-stu-id="aab60-124">BizTalk Server stores all the states in the MessageBox databases, and each MessageBox database contains state information for different business processes.</span></span> <span data-ttu-id="aab60-125">出于可靠性考虑，您必须群集所有 MessageBox 数据库，包括主和辅助 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-125">For reliability, you must cluster all the MessageBox databases, including the master and secondary MessageBox databases.</span></span>  
  
 <span data-ttu-id="aab60-126">若要配置多个 MessageBox 数据库，您使用 BizTalk 管理控制台来添加运行 SQL Server 的计算机。</span><span class="sxs-lookup"><span data-stu-id="aab60-126">To configure multiple MessageBox databases, you use the BizTalk Administration console to add the computers that are running SQL Server.</span></span> <span data-ttu-id="aab60-127">从管理角度看，只需添加新的 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-127">From an administration perspective, you only have to add new MessageBox databases.</span></span> <span data-ttu-id="aab60-128">BizTalk Server 自动处理激活消息的轮循机制分布，并将相关消息发送到相应的 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-128">BizTalk Server automatically handles the round-robin distribution of activation messages and sends correlation messages to the correct MessageBox databases.</span></span>  
  
 <span data-ttu-id="aab60-129">如果在环境中配置多个 MessageBox 数据库应为你的 BizTalk Server 组中创建 3 个 MessageBox 数据库的最小值和应禁止主 MessageBox 上的发布消息。</span><span class="sxs-lookup"><span data-stu-id="aab60-129">If you configure multiple MessageBox databases in your environment you should create a minimum of 3 MessageBox databases for your BizTalk Server group and you should disable message publication on the Master MessageBox.</span></span> <span data-ttu-id="aab60-130">此建议是因为，添加其他 MessageBox 数据库可能会产生开销通过 MessageBox 数据库之间路由消息的主 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-130">This recommendation is made because adding additional MessageBox databases incurs overhead by the Master MessageBox database for routing messages between the MessageBox databases.</span></span> <span data-ttu-id="aab60-131">如果只配置 2 个 MessageBox 数据库按主 MessageBox 的消息路由的系统开销偏移大部分其他 MessageBox 数据库所获得的权益。</span><span class="sxs-lookup"><span data-stu-id="aab60-131">If you only configure 2 MessageBox databases then most of the benefit gained by the additional MessageBox database is offset by the overhead consumed by the Master MessageBox for message routing.</span></span>  
  
## <a name="providing-high-availability-for-multiple-messagebox-databases"></a><span data-ttu-id="aab60-132">为多个 MessageBox 数据库提供高可用性</span><span class="sxs-lookup"><span data-stu-id="aab60-132">Providing High Availability for Multiple MessageBox Databases</span></span>  
 <span data-ttu-id="aab60-133">添加到 MessageBox 数据库时你[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]部署提高了可伸缩性，它不提供高可用性，因为每个 MessageBox 数据库是唯一和独立和可能是单点为 BizTalk Server 的故障环境。</span><span class="sxs-lookup"><span data-stu-id="aab60-133">While adding MessageBox databases to your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] deployment improves scalability, it does not provide high availability because each MessageBox database is unique and independent and is potentially a single point of failure for your BizTalk Server environment.</span></span> <span data-ttu-id="aab60-134">若要添加冗余包括： 配置每个 MessageBox 数据库的服务器群集。</span><span class="sxs-lookup"><span data-stu-id="aab60-134">To add redundancy involves configuring a server cluster for each MessageBox database.</span></span> <span data-ttu-id="aab60-135">BizTalk Server 将数据分发跨多个 MessageBox 数据库，因此数据库不共享数据或情况下没有服务器群集提供冗余。</span><span class="sxs-lookup"><span data-stu-id="aab60-135">BizTalk Server distributes data across the multiple MessageBox databases, so the databases do not share data or otherwise provide redundancy without server clustering.</span></span>  
  
## <a name="providing-high-availability-for-the-biztalk-tracking-database"></a><span data-ttu-id="aab60-136">为 BizTalk 跟踪数据库提供高可用性</span><span class="sxs-lookup"><span data-stu-id="aab60-136">Providing High Availability for the BizTalk Tracking Database</span></span>  
 <span data-ttu-id="aab60-137">具体取决于您的特定部署的要求，你可能想要隔离到单独的 SQL Server 计算机上的 BizTalk 跟踪数据库，从而增强跟踪性能并通过创建单独的 BizTalk 主机专用于跟踪的主机。</span><span class="sxs-lookup"><span data-stu-id="aab60-137">Depending on the requirements of your particular deployment, you might want to enhance performance for tracking by isolating the BizTalk Tracking database onto a separate SQL Server computer and by creating a separate BizTalk Host dedicated to host tracking.</span></span> <span data-ttu-id="aab60-138">如果你的部署具有高吞吐量，并且涉及到跟踪大量数据的这些消息，则跟踪系统开销可能会使用运行 SQL Server 的计算机上的大量资源。</span><span class="sxs-lookup"><span data-stu-id="aab60-138">If your deployment has high throughput and involves tracking lots of data for these messages, the tracking overhead could potentially consume lots of resources on the computer that is running SQL Server.</span></span> <span data-ttu-id="aab60-139">如果出现这种情况，并且传入消息的速率很高继续[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]到达的点，它无法处理新消息，因为跟踪消息所需的资源比运行其他 BizTalk Server 所需的资源组件 （如接收消息并将其保存到 MessageBox 数据库）。</span><span class="sxs-lookup"><span data-stu-id="aab60-139">If this situation occurs and a high rate of incoming messages continues, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] reaches a point where it cannot process new messages because the resources required to track messages are greater than the resources required to run the other BizTalk Server components (such as receiving messages and persisting them to the MessageBox database).</span></span>  
  
 <span data-ttu-id="aab60-140">若要提高性能和安全性，建议将专门用于跟踪不包含任何其他项 （如接收位置、 业务流程或管道） 的主机和处理和发送主机禁用从接收的跟踪。</span><span class="sxs-lookup"><span data-stu-id="aab60-140">To improve performance and security, we recommend that you dedicate a host for tracking that does not contain any other items (such as receive locations, orchestrations, or pipelines) and that you disable tracking from the receiving, processing, and sending hosts.</span></span> <span data-ttu-id="aab60-141">若要为跟踪主机提供高可用性，创建多个跟踪主机的主机实例。</span><span class="sxs-lookup"><span data-stu-id="aab60-141">To provide high availability for the tracking host, create more than one host instance of the tracking host.</span></span>  
  
 <span data-ttu-id="aab60-142">对于每个 MessageBox 数据库，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]只使用一个跟踪主机实例将消息从 MessageBox 数据库移至 BizTalk 跟踪数据库 (BizTalkDTADb)。</span><span class="sxs-lookup"><span data-stu-id="aab60-142">For each MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses only one tracking host instance to move messages from the MessageBox database to the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="aab60-143">如果其他计算机运行的跟踪主机实例，BizTalk Server 将会自动向外的每个 MessageBox 数据库跟踪主机的单独实例的处理。</span><span class="sxs-lookup"><span data-stu-id="aab60-143">If additional computers run instances of the tracking host, BizTalk Server automatically scales out the handling of each MessageBox database to a separate instance of the tracking host.</span></span> <span data-ttu-id="aab60-144">如果 MessageBox 数据库的数量大于许多跟踪主机实例、 一个或多个跟踪主机实例将服务多个 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-144">If the number of MessageBox databases is larger than the number of tracking host instances, one or more tracking host instances will service more than one MessageBox database.</span></span>  
  
 <span data-ttu-id="aab60-145">若要为 BizTalk 跟踪数据库提供高可用性，使用 Windows 群集配置中的主动/被动配置运行 SQL Server 的两台数据库计算机。</span><span class="sxs-lookup"><span data-stu-id="aab60-145">To provide high availability for the BizTalk Tracking database, use Windows Clustering to configure two database computers that are running SQL Server in an active/passive configuration.</span></span>  
  
## <a name="providing-high-availability-for-the-bam-databases"></a><span data-ttu-id="aab60-146">为 BAM 数据库提供高可用性</span><span class="sxs-lookup"><span data-stu-id="aab60-146">Providing High Availability for the BAM Databases</span></span>  
 <span data-ttu-id="aab60-147">业务活动监视 (BAM) 提供了独立于 IT 实施或跨异类 IT 实施的业务流程的可见性。</span><span class="sxs-lookup"><span data-stu-id="aab60-147">Business Activity Monitoring (BAM) provides visibility into business processes independent of the IT implementation or across a heterogeneous IT implementation.</span></span> <span data-ttu-id="aab60-148">BAM SQL Server 数据库 （BAM 星型架构数据库、 BAM 主导入数据库和 BAM 存档数据库） 和 BAM 分析数据库存储不同于操作监视数据的业务活动数据。</span><span class="sxs-lookup"><span data-stu-id="aab60-148">The BAM SQL Server databases (BAM Star Schema database, BAM Primary Import database, and BAM Archive database) and the BAM Analysis database store the business activity data that is different from the operational monitoring data.</span></span> <span data-ttu-id="aab60-149">若要确保 BAM 基础结构是高可用，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="aab60-149">To make sure your BAM infrastructure is highly available, do the following:</span></span>  
  
- <span data-ttu-id="aab60-150">**群集 BAM 主导入数据库和 BAM 分析数据库。**</span><span class="sxs-lookup"><span data-stu-id="aab60-150">**Cluster the BAM Primary Import database and the BAM Analysis database.**</span></span> <span data-ttu-id="aab60-151">BAM 主导入数据库是业务活动监视系统的中心。</span><span class="sxs-lookup"><span data-stu-id="aab60-151">The BAM Primary Import database is the center of the Business Activity Monitoring system.</span></span> <span data-ttu-id="aab60-152">因此是重要，确保此数据库高度可用通过使用 Windows 群集，请按照下面的两个建议，以防止此数据库被填满。</span><span class="sxs-lookup"><span data-stu-id="aab60-152">It is therefore important that you make this database highly available by using Windows Clustering and that you follow the next two recommendations to prevent this database from filling up.</span></span> <span data-ttu-id="aab60-153">BAM 分析数据库是存储业务分析员使用来生成活动聚合和 OLAP 多维数据集的数据的 Analysis Services 数据库，因此此数据库的任何停机时间会影响他们的工作效率。</span><span class="sxs-lookup"><span data-stu-id="aab60-153">The BAM Analysis database is an Analysis Services database that stores the data that business analysts use to build activity aggregations and OLAP cubes, and therefore any downtime of this database affects their productivity.</span></span> <span data-ttu-id="aab60-154">尽管不必群集 BAM 存档数据库，我们建议你监视事件日志错误，以确保数据已传输成功，并因此监视数据库的大小，Data Transformation Services (DTS) 包运行时可以替换它之前它填充了。</span><span class="sxs-lookup"><span data-stu-id="aab60-154">While you do not have to cluster the BAM Archive database, we recommend that you monitor the event log for errors when the Data Transformation Services (DTS) packages run to make sure the data has been transferred successfully, and to monitor the size of the database so that you can replace it before it fills up.</span></span>  
  
- <span data-ttu-id="aab60-155">**定义联机时段。**</span><span class="sxs-lookup"><span data-stu-id="aab60-155">**Define an online window.**</span></span> <span data-ttu-id="aab60-156">若要为更高的性能并避免故障，BAM BAM 主导入数据库中的数据到表时活动的完成基于时间戳。</span><span class="sxs-lookup"><span data-stu-id="aab60-156">To allow for greater performance and avoid downtime, BAM partitions the data in the BAM Primary Import database into tables based on the timestamp when the activity was completed.</span></span> <span data-ttu-id="aab60-157">BAM 来实现此通过定期交换已完成的表与另一个空表的格式完全相同。</span><span class="sxs-lookup"><span data-stu-id="aab60-157">BAM achieves this by regularly swapping the completed table with another empty table of identical format.</span></span> <span data-ttu-id="aab60-158">BAM 完成此操作后，其他已完成的活动会进入新分区 （表），而 BAM 将保留旧分区中的联机时段定义的时间。</span><span class="sxs-lookup"><span data-stu-id="aab60-158">After BAM does this, the additional completed activities go into the new partition (table), while BAM keeps the old partitions for the time defined in the online window.</span></span> <span data-ttu-id="aab60-159">必须定义联机时段以确保 BAM 主导入数据库中的分区数变得不太大。</span><span class="sxs-lookup"><span data-stu-id="aab60-159">You must define an online window to make sure the number of partitions in the BAM Primary Import database does not grow too large.</span></span> <span data-ttu-id="aab60-160">有关安排联机时段的详细信息，请参阅"存档主导入数据库数据"中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]帮助。</span><span class="sxs-lookup"><span data-stu-id="aab60-160">For more information about scheduling online windows, see "Archiving Primary Import Database Data" in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
- <span data-ttu-id="aab60-161">**安排 DTS 包定期运行。**</span><span class="sxs-lookup"><span data-stu-id="aab60-161">**Schedule DTS packages to run periodically.**</span></span> <span data-ttu-id="aab60-162">定义联机时段可确保 BAM 主导入数据库不会填满旧活动分区。</span><span class="sxs-lookup"><span data-stu-id="aab60-162">Defining an online window makes sure your BAM Primary Import database does not fill up with old activity partitions.</span></span> <span data-ttu-id="aab60-163">此外必须安排 DTS 包定期运行，若要创建新分区的活动数据，并将数据从 BAM 主导入数据库中的旧分区移到 BAM 存档数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-163">You must also schedule DTS packages to run periodically to create a new partition for the activity data and to move the data from the old partitions in the BAM Primary Import database into the BAM Archive database.</span></span> <span data-ttu-id="aab60-164">有关安排 DTS 包的详细信息，请参阅"安排 DTS 包"中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]帮助。</span><span class="sxs-lookup"><span data-stu-id="aab60-164">For more information about scheduling DTS packages, see "Scheduling the DTS Packages" in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
- <span data-ttu-id="aab60-165">**请仔细选择几小组数据项 （检查点），并避免包括不必要的数据的项定义某个活动时。**</span><span class="sxs-lookup"><span data-stu-id="aab60-165">**Carefully choose small sets of data items (checkpoints), and avoid including unnecessary data items when defining an activity.**</span></span>  
  
- <span data-ttu-id="aab60-166">**了解在设计聚合时的计划扫描和实时聚合之间权衡。**</span><span class="sxs-lookup"><span data-stu-id="aab60-166">**Understand the trade-offs between scheduled and real-time aggregations when you design your aggregations.**</span></span> <span data-ttu-id="aab60-167">实时聚合由 SQL Server 触发器自动维护，并且没有延迟。</span><span class="sxs-lookup"><span data-stu-id="aab60-167">Real-time aggregations are automatically maintained by SQL Server triggers and have zero latency.</span></span> <span data-ttu-id="aab60-168">它非常适合于某些关键的低延迟方案，但它会导致性能成本每当事件被写入到 BAM 主导入数据库。</span><span class="sxs-lookup"><span data-stu-id="aab60-168">It is ideal for some mission-critical low-latency scenarios, but it incurs a performance cost whenever the events are being written to the BAM Primary Import database.</span></span> <span data-ttu-id="aab60-169">计划的聚合依赖于计划的多维数据集 DTS 包，以更新其聚合数据。</span><span class="sxs-lookup"><span data-stu-id="aab60-169">Scheduled aggregations rely on scheduled cubing DTS packages to update its aggregation data.</span></span> <span data-ttu-id="aab60-170">其延迟时间等于或大于 DTS 计划时间间隔，但整体对 BAM 主导入数据库的性能影响更小。</span><span class="sxs-lookup"><span data-stu-id="aab60-170">Its latency is equal to or greater than the DTS schedule interval, but overall it has a smaller performance impact on the BAM Primary Import database.</span></span>  
  
- <span data-ttu-id="aab60-171">**如果您选择计划的聚合，请确保计划频率高于存档 DTS 运行多维数据集 DTS。**</span><span class="sxs-lookup"><span data-stu-id="aab60-171">**If you choose scheduled aggregations, make sure you schedule the cubing DTS to run more frequently than the archiving DTS.**</span></span> <span data-ttu-id="aab60-172">这是因为存档 DTS 不会移动到 BAM 存档数据库的计划聚合处理的活动数据。</span><span class="sxs-lookup"><span data-stu-id="aab60-172">This is because the archiving DTS will not move the activity data that has been processed for scheduled aggregation to the BAM Archive database.</span></span>  
  
- <span data-ttu-id="aab60-173">**启用 BAM 事件总线服务在多台计算机中获取故障转移功能。**</span><span class="sxs-lookup"><span data-stu-id="aab60-173">**Enable the BAM Event Bus Service in multiple computers to obtain failover functionality.**</span></span>  
  
## <a name="providing-high-availability-for-the-other-biztalk-server-databases"></a><span data-ttu-id="aab60-174">为其他 BizTalk Server 数据库提供高可用性</span><span class="sxs-lookup"><span data-stu-id="aab60-174">Providing High Availability for the Other BizTalk Server Databases</span></span>  
 <span data-ttu-id="aab60-175">若要为其他提供高可用性[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库，配置 Windows 群集中运行 SQL Server 的两台计算机。</span><span class="sxs-lookup"><span data-stu-id="aab60-175">To provide high availability for the other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, configure two computers that are running SQL Server in a Windows cluster.</span></span> <span data-ttu-id="aab60-176">这些计算机可以运行在主动/主动或主动/被动配置中以实现冗余和数据存储在共享驱动器 (例如 RAID 1 + 0 SCSI 磁盘阵列) 或存储区域网络 (SAN)。</span><span class="sxs-lookup"><span data-stu-id="aab60-176">These computers can run in an active/active or active/passive configuration for redundancy and store data on a shared drive (such as a RAID 1+0 SCSI disk array) or storage area network (SAN).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aab60-177">请参阅</span><span class="sxs-lookup"><span data-stu-id="aab60-177">See Also</span></span>  
 <span data-ttu-id="aab60-178">[为 BizTalk 主机提供高可用性](../core/providing-high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="aab60-178">[Providing High Availability for BizTalk Hosts](../core/providing-high-availability-for-biztalk-hosts.md) </span></span>  
 <span data-ttu-id="aab60-179">[为 BizTalk Server 数据库提供高可用性](../core/providing-high-availability-for-biztalk-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="aab60-179">[Providing High Availability for BizTalk Server Databases](../core/providing-high-availability-for-biztalk-server-databases.md) </span></span>  
 [<span data-ttu-id="aab60-180">BizTalk Server 高可用性示例方案</span><span class="sxs-lookup"><span data-stu-id="aab60-180">Sample BizTalk Server High Availability Scenarios</span></span>](../core/sample-biztalk-server-high-availability-scenarios.md)