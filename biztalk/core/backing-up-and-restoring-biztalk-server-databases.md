---
title: 备份和还原 BizTalk Server 数据库 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- backing up [BAM]
- databases, backing up
- databases, restoring
- backing up, restoring
- backing up, databases
- restoring, BAM
- backing up, BAM
- backing up, backup jobs
- BAM, restoring
- restoring, databases
- restoring [BAM]
- BAM, backing up
ms.assetid: 82fc1af2-1389-4c79-80dc-f2df5656d201
caps.latest.revision: 30
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8031316b733d1e86ace3d26e31ea2318e6f40a23
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/27/2018
ms.locfileid: "36980470"
---
# <a name="backing-up-and-restoring-biztalk-server-databases"></a><span data-ttu-id="083cf-102">备份和还原 BizTalk Server 数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-102">Backing Up and Restoring BizTalk Server Databases</span></span>
<span data-ttu-id="083cf-103">使用备份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 作业可以备份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 源系统中的所有数据库，但业务活动监视 (BAM) 所使用的某些数据库除外。</span><span class="sxs-lookup"><span data-stu-id="083cf-103">You use the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up all of the databases in your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] source system, except for some databases used by Business Activity Monitoring (BAM).</span></span> <span data-ttu-id="083cf-104">源系统是包含实时数据的服务器或服务器组。</span><span class="sxs-lookup"><span data-stu-id="083cf-104">The source system is the server or group of servers that contain live data.</span></span> <span data-ttu-id="083cf-105">由于 BAM 数据库的备份和还原要求不同，因此，要使用其他方法对这些数据库进行备份和还原。</span><span class="sxs-lookup"><span data-stu-id="083cf-105">Because BAM databases have different backup and restore requirements, these databases are backed up and restored using other methods.</span></span>  

 <span data-ttu-id="083cf-106">备份和还原 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 数据库包括以下步骤：</span><span class="sxs-lookup"><span data-stu-id="083cf-106">Backing up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases and restoring them involves the following steps:</span></span>  

1. <span data-ttu-id="083cf-107">**配置备份 BizTalk Server 作业**</span><span class="sxs-lookup"><span data-stu-id="083cf-107">**Configuring the Backup BizTalk Server job**</span></span>  

    <span data-ttu-id="083cf-108">备份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 数据库之前，必须先在源系统中配置备份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 作业，以便将备份自动写入一个文件夹中，然后可以使用该文件夹将数据库还原到目标系统。</span><span class="sxs-lookup"><span data-stu-id="083cf-108">Before you can back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you must first configure the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job on the source system, which directs backups to be automatically written to a folder where they can then be used to restore the databases on the destination system.</span></span> <span data-ttu-id="083cf-109">目标系统是用于还原由源系统生成的数据库备份的服务器或服务器组。</span><span class="sxs-lookup"><span data-stu-id="083cf-109">The destination system is the server or group of servers that will be used to restore the database backups produced by the source system.</span></span> <span data-ttu-id="083cf-110">有关此步骤的详细信息，请参阅[如何配置备份 BizTalk Server 作业](../core/how-to-configure-the-backup-biztalk-server-job.md)。</span><span class="sxs-lookup"><span data-stu-id="083cf-110">For more information about this step, see [How to Configure the Backup BizTalk Server Job](../core/how-to-configure-the-backup-biztalk-server-job.md).</span></span>  

2. <span data-ttu-id="083cf-111">**配置日志传送的目标系统**</span><span class="sxs-lookup"><span data-stu-id="083cf-111">**Configuring the destination system for log shipping**</span></span>  

    <span data-ttu-id="083cf-112">您还必须配置日志传送的目标系统，该系统具有备用服务器功能，它可以缩短出现系统失败时的停机时间。</span><span class="sxs-lookup"><span data-stu-id="083cf-112">You must also configure the destination system for log shipping, which provides standby server capabilities and reduces downtime in the event of a system failure.</span></span> <span data-ttu-id="083cf-113">有关此步骤的详细信息，请参阅[如何为日志传送配置目标系统](../core/how-to-configure-the-destination-system-for-log-shipping.md)。</span><span class="sxs-lookup"><span data-stu-id="083cf-113">For more information about this step, see [How to Configure the Destination System for Log Shipping](../core/how-to-configure-the-destination-system-for-log-shipping.md).</span></span>  

3. <span data-ttu-id="083cf-114">**还原数据库**</span><span class="sxs-lookup"><span data-stu-id="083cf-114">**Restoring the databases**</span></span>  

    <span data-ttu-id="083cf-115">在发生硬件故障时，通过使用发送到目标系统的备份和日志，可以还原数据库。</span><span class="sxs-lookup"><span data-stu-id="083cf-115">When a hardware failure occurs, you can restore your databases by using the backups and logs sent to your destination system.</span></span> <span data-ttu-id="083cf-116">有关此步骤的详细信息，请参阅[如何还原您数据库](../core/how-to-restore-your-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="083cf-116">For more information about this step, see [How to Restore Your Databases](../core/how-to-restore-your-databases.md).</span></span>  

## <a name="biztalk-server-databases"></a><span data-ttu-id="083cf-117">BizTalk Server 数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-117">BizTalk Server Databases</span></span>  
 <span data-ttu-id="083cf-118">下表介绍了 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用的数据库，并指出采用哪些方法来备份数据库。</span><span class="sxs-lookup"><span data-stu-id="083cf-118">The following tables describe the databases used by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and identify which methods are used to back up the databases.</span></span>  

### <a name="databases-backed-up-by-the-backup-biztalk-server-job"></a><span data-ttu-id="083cf-119">通过备份 BizTalk Server 作业备份的数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-119">Databases Backed Up by the Backup BizTalk Server Job</span></span>  
 <span data-ttu-id="083cf-120">下表列出了在备份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 作业的过程中备份和还原的数据库。</span><span class="sxs-lookup"><span data-stu-id="083cf-120">The following table lists the databases that are backed up and restored as a part of the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job.</span></span> <span data-ttu-id="083cf-121">可以修改备份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 作业，以通过将自定义数据库添加到 adm_OtherBackupDatabases 表来备份自定义数据库。</span><span class="sxs-lookup"><span data-stu-id="083cf-121">You can modify the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up custom databases by adding them to the adm_OtherBackupDatabases table.</span></span> <span data-ttu-id="083cf-122">有关详细信息，请参阅[如何返回自定义数据库](../core/how-to-back-up-custom-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="083cf-122">For more information, see [How to Back Up Custom Databases](../core/how-to-back-up-custom-databases.md).</span></span>  


|                    <span data-ttu-id="083cf-123">“数据库”</span><span class="sxs-lookup"><span data-stu-id="083cf-123">Database</span></span>                    | <span data-ttu-id="083cf-124">默认数据库名称</span><span class="sxs-lookup"><span data-stu-id="083cf-124">Default database name</span></span> |                                                                                                                                       <span data-ttu-id="083cf-125">Description</span><span class="sxs-lookup"><span data-stu-id="083cf-125">Description</span></span>                                                                                                                                        |
|------------------------------------------------|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|          <span data-ttu-id="083cf-126">BAM 主导入数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-126">BAM Primary Import database</span></span>           |   <span data-ttu-id="083cf-127">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="083cf-127">BAMPrimaryImport</span></span>    |                                                                                              <span data-ttu-id="083cf-128">此数据库是业务活动监视 (BAM) 从中收集原始跟踪数据的数据库。</span><span class="sxs-lookup"><span data-stu-id="083cf-128">This is the database where the Business Activity Monitoring (BAM) collects raw tracking data.</span></span>                                                                                               |
| <span data-ttu-id="083cf-129">BAM 通知服务应用程序数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-129">BAM Notification Services Application database</span></span> | <span data-ttu-id="083cf-130">BAMAlertsApplication</span><span class="sxs-lookup"><span data-stu-id="083cf-130">BAMAlertsApplication</span></span>  | <span data-ttu-id="083cf-131">此数据库包含用于 BAM 通知的警报信息。</span><span class="sxs-lookup"><span data-stu-id="083cf-131">This database contains alert information for BAM notifications.</span></span> <span data-ttu-id="083cf-132">例如，在使用 BAM 门户创建警报时，会将指定与警报相关的条件和事件的条目以及支持警报数据项的其他条目插入该数据库中。</span><span class="sxs-lookup"><span data-stu-id="083cf-132">For example, when you create an alert using the BAM portal, entries are inserted in the database specifying the conditions and events to which the alert pertains, as well as other supporting data items for the alert.</span></span> |
|  <span data-ttu-id="083cf-133">BAM 通知服务实例数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-133">BAM Notification Services Instance database</span></span>   |    <span data-ttu-id="083cf-134">BAMAlertsNSMain</span><span class="sxs-lookup"><span data-stu-id="083cf-134">BAMAlertsNSMain</span></span>    |                                                                            <span data-ttu-id="083cf-135">此数据库包含指定通知服务如何连接到 BAM 所监视的系统的实例信息。</span><span class="sxs-lookup"><span data-stu-id="083cf-135">This database contains instance information specifying how the notification services connect to the system that BAM is monitoring.</span></span>                                                                            |
|           <span data-ttu-id="083cf-136">BizTalk 跟踪数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-136">BizTalk Tracking database</span></span>            |     <span data-ttu-id="083cf-137">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="083cf-137">BizTalkDTADb</span></span>      |                                                              <span data-ttu-id="083cf-138">此数据库存储 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 跟踪引擎所跟踪的运行状况监视数据。</span><span class="sxs-lookup"><span data-stu-id="083cf-138">This database stores health monitoring data tracked by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking engine.</span></span>                                                              |
|          <span data-ttu-id="083cf-139">BizTalk 管理数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-139">BizTalk Management database</span></span>           |     <span data-ttu-id="083cf-140">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="083cf-140">BizTalkMgmtDb</span></span>     |                                                               <span data-ttu-id="083cf-141">此数据库是所有 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 实例的中央元信息存储区。</span><span class="sxs-lookup"><span data-stu-id="083cf-141">This database is the central meta-information store for all instances of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>                                                               |
|          <span data-ttu-id="083cf-142">BizTalk MessageBox 数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-142">BizTalk MessageBox database</span></span>           |    <span data-ttu-id="083cf-143">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="083cf-143">BizTalkMsgBoxDb</span></span>    |                                             <span data-ttu-id="083cf-144">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 引擎使用此数据库来执行路由、排队、实例管理和其他各种任务。</span><span class="sxs-lookup"><span data-stu-id="083cf-144">This database is used by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] engine for routing, queuing, instance management, and a variety of other tasks.</span></span>                                              |
|              <span data-ttu-id="083cf-145">规则引擎数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-145">Rule Engine database</span></span>              |  <span data-ttu-id="083cf-146">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="083cf-146">BizTalkRuleEngineDb</span></span>  |                                     <span data-ttu-id="083cf-147">此数据库是包含以下内容的存储库：</span><span class="sxs-lookup"><span data-stu-id="083cf-147">This database is a repository for:</span></span><br /><br /> <span data-ttu-id="083cf-148">-策略，这是一组相关的规则。</span><span class="sxs-lookup"><span data-stu-id="083cf-148">-   Policies, which are sets of related rules.</span></span><br /><span data-ttu-id="083cf-149">-词汇，即是规则中的数据引用的用户友好的特定于域的名称的集合。</span><span class="sxs-lookup"><span data-stu-id="083cf-149">-   Vocabularies, which are collections of user-friendly, domain-specific names for data references in rules.</span></span>                                     |
|                  <span data-ttu-id="083cf-150">SSO 数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-150">SSO database</span></span>                  |         <span data-ttu-id="083cf-151">SSODB</span><span class="sxs-lookup"><span data-stu-id="083cf-151">SSODB</span></span>         |                                                                                       <span data-ttu-id="083cf-152">此企业单一登录数据库安全地存储接收位置的配置信息。</span><span class="sxs-lookup"><span data-stu-id="083cf-152">This Enterprise Single Sign-On database securely stores the configuration information for receive locations.</span></span>                                                                                       |

### <a name="databases-backed-up-by-the-bam-backup-process"></a><span data-ttu-id="083cf-153">通过 BAM 备份过程备份的数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-153">Databases Backed Up by the BAM Backup Process</span></span>  
 <span data-ttu-id="083cf-154">下表列出了备份和还原使用中的过程的数据库[备份和还原 BAM](../core/backing-up-and-restoring-bam.md):</span><span class="sxs-lookup"><span data-stu-id="083cf-154">The following table lists the databases that are backed up and restored using the procedures in [Backing Up and Restoring BAM](../core/backing-up-and-restoring-bam.md):</span></span>  

|<span data-ttu-id="083cf-155">“数据库”</span><span class="sxs-lookup"><span data-stu-id="083cf-155">Database</span></span>|<span data-ttu-id="083cf-156">默认数据库名称</span><span class="sxs-lookup"><span data-stu-id="083cf-156">Default database name</span></span>|<span data-ttu-id="083cf-157">Description</span><span class="sxs-lookup"><span data-stu-id="083cf-157">Description</span></span>|  
|--------------|---------------------------|-----------------|  
|<span data-ttu-id="083cf-158">BAM 星型架构</span><span class="sxs-lookup"><span data-stu-id="083cf-158">BAM Star Schema</span></span>|<span data-ttu-id="083cf-159">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="083cf-159">BAMStarSchema</span></span>|<span data-ttu-id="083cf-160">此数据库包含中间临时表、度量值表和维度表。</span><span class="sxs-lookup"><span data-stu-id="083cf-160">This database contains the staging table, and the measure and dimension tables.</span></span>|  
|<span data-ttu-id="083cf-161">BAM 分析</span><span class="sxs-lookup"><span data-stu-id="083cf-161">BAM Analysis</span></span>|<span data-ttu-id="083cf-162">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="083cf-162">BAMAnalysis</span></span>|<span data-ttu-id="083cf-163">此数据库包含用于进行联机和脱机分析的 BAM OLAP 多维数据集。</span><span class="sxs-lookup"><span data-stu-id="083cf-163">This database contains BAM OLAP cubes for both online and offline analysis.</span></span>|  
|<span data-ttu-id="083cf-164">BAM 存档</span><span class="sxs-lookup"><span data-stu-id="083cf-164">BAM Archive</span></span>|<span data-ttu-id="083cf-165">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="083cf-165">BAMArchive</span></span>|<span data-ttu-id="083cf-166">此数据库存档旧的业务活动数据。</span><span class="sxs-lookup"><span data-stu-id="083cf-166">This database archives old business activity data.</span></span> <span data-ttu-id="083cf-167">创建 BAM 存档数据库以最大限度地减少 BAM 主导入数据库中业务活动数据的累积。</span><span class="sxs-lookup"><span data-stu-id="083cf-167">Create a BAM Archive database to minimize the accumulation of business activity data in the BAM Primary Import database.</span></span>|  
|<span data-ttu-id="083cf-168">跟踪分析服务器</span><span class="sxs-lookup"><span data-stu-id="083cf-168">Tracking Analysis Server</span></span>|<span data-ttu-id="083cf-169">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="083cf-169">BizTalkAnalysisDb</span></span>|<span data-ttu-id="083cf-170">此数据库存储运行状况监视联机分析处理 (OLAP) 多维数据集。</span><span class="sxs-lookup"><span data-stu-id="083cf-170">This database stores health monitoring online analytical processing (OLAP) cubes.</span></span>|  

## <a name="in-this-section"></a><span data-ttu-id="083cf-171">本节内容</span><span class="sxs-lookup"><span data-stu-id="083cf-171">In This Section</span></span>  

-   [<span data-ttu-id="083cf-172">如何配置备份 BizTalk Server 作业</span><span class="sxs-lookup"><span data-stu-id="083cf-172">How to Configure the Backup BizTalk Server Job</span></span>](../core/how-to-configure-the-backup-biztalk-server-job.md)  

-   [<span data-ttu-id="083cf-173">如何配置日志传送目标系统</span><span class="sxs-lookup"><span data-stu-id="083cf-173">How to Configure the Destination System for Log Shipping</span></span>](../core/how-to-configure-the-destination-system-for-log-shipping.md)  

-   [<span data-ttu-id="083cf-174">如何还原数据库</span><span class="sxs-lookup"><span data-stu-id="083cf-174">How to Restore Your Databases</span></span>](../core/how-to-restore-your-databases.md)  

-   [<span data-ttu-id="083cf-175">如何备份和还原 SQL 代理作业</span><span class="sxs-lookup"><span data-stu-id="083cf-175">How to Back Up and Restore SQL Agent Jobs</span></span>](../core/how-to-back-up-and-restore-sql-agent-jobs.md)  

-   [<span data-ttu-id="083cf-176">如何备份和还原 SQL Server 登录名</span><span class="sxs-lookup"><span data-stu-id="083cf-176">How to Back Up and Restore SQL Server Logins</span></span>](../core/how-to-back-up-and-restore-sql-server-logins.md)