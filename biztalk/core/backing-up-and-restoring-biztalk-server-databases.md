---
title: 备份和还原 BizTalk Server 数据库 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- backing up [BAM]
- databases, backing up
- databases, restoring
- backing up, restoring
- backing up, databases
- restoring, BAM
- backing up, BAM
- backing up, backup jobs
- BAM, restoring
- restoring, databases
- restoring [BAM]
- BAM, backing up
ms.assetid: 82fc1af2-1389-4c79-80dc-f2df5656d201
caps.latest.revision: 30
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1744d18f51df2020daf57eee7ad532a5eda148e5
ms.sourcegitcommit: d27732e569b0897361dfaebca8352aa97bb7efe1
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/10/2019
ms.locfileid: "65528853"
---
# <a name="backing-up-and-restoring-biztalk-server-databases"></a><span data-ttu-id="82992-102">备份和还原 BizTalk Server 数据库</span><span class="sxs-lookup"><span data-stu-id="82992-102">Backing Up and Restoring BizTalk Server Databases</span></span>
<span data-ttu-id="82992-103">使用备份[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]中的数据库的所有备份作业在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]源系统，使用由业务活动监视 (BAM) 某些数据库除外。</span><span class="sxs-lookup"><span data-stu-id="82992-103">You use the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up all of the databases in your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] source system, except for some databases used by Business Activity Monitoring (BAM).</span></span> <span data-ttu-id="82992-104">源系统是服务器或组包含实时数据的服务器。</span><span class="sxs-lookup"><span data-stu-id="82992-104">The source system is the server or group of servers that contain live data.</span></span> <span data-ttu-id="82992-105">由于 BAM 数据库具有不同的备份和还原要求，因此这些数据库进行备份和还原使用其他方法。</span><span class="sxs-lookup"><span data-stu-id="82992-105">Because BAM databases have different backup and restore requirements, these databases are backed up and restored using other methods.</span></span>  

 <span data-ttu-id="82992-106">备份[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库和还原涉及以下步骤：</span><span class="sxs-lookup"><span data-stu-id="82992-106">Backing up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases and restoring them involves the following steps:</span></span>  

1. <span data-ttu-id="82992-107">**配置备份 BizTalk Server 作业**</span><span class="sxs-lookup"><span data-stu-id="82992-107">**Configuring the Backup BizTalk Server job**</span></span>  

    <span data-ttu-id="82992-108">在备份之前[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]数据库，必须先配置备份[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]源系统，以便将备份自动写入其中它们可以然后使用要还原到目标数据库的文件夹上的作业系统。</span><span class="sxs-lookup"><span data-stu-id="82992-108">Before you can back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you must first configure the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job on the source system, which directs backups to be automatically written to a folder where they can then be used to restore the databases on the destination system.</span></span> <span data-ttu-id="82992-109">目标系统是服务器或组将用于还原由源系统生成的数据库备份的服务器。</span><span class="sxs-lookup"><span data-stu-id="82992-109">The destination system is the server or group of servers that will be used to restore the database backups produced by the source system.</span></span> <span data-ttu-id="82992-110">有关此步骤的详细信息，请参阅[如何配置备份 BizTalk Server 作业](../core/how-to-configure-the-backup-biztalk-server-job.md)。</span><span class="sxs-lookup"><span data-stu-id="82992-110">For more information about this step, see [How to Configure the Backup BizTalk Server Job](../core/how-to-configure-the-backup-biztalk-server-job.md).</span></span>  

2. <span data-ttu-id="82992-111">**配置日志传送的目标系统**</span><span class="sxs-lookup"><span data-stu-id="82992-111">**Configuring the destination system for log shipping**</span></span>  

    <span data-ttu-id="82992-112">此外必须配置日志传送具有备用服务器功能，可以缩短出现系统故障时的停机时间的目标系统。</span><span class="sxs-lookup"><span data-stu-id="82992-112">You must also configure the destination system for log shipping, which provides standby server capabilities and reduces downtime in the event of a system failure.</span></span> <span data-ttu-id="82992-113">有关此步骤的详细信息，请参阅[如何为日志传送配置目标系统](../core/how-to-configure-the-destination-system-for-log-shipping.md)。</span><span class="sxs-lookup"><span data-stu-id="82992-113">For more information about this step, see [How to Configure the Destination System for Log Shipping](../core/how-to-configure-the-destination-system-for-log-shipping.md).</span></span>  

3. <span data-ttu-id="82992-114">**还原数据库**</span><span class="sxs-lookup"><span data-stu-id="82992-114">**Restoring the databases**</span></span>  

    <span data-ttu-id="82992-115">出现硬件故障时，可以通过使用备份和日志发送到目标系统中还原数据库。</span><span class="sxs-lookup"><span data-stu-id="82992-115">When a hardware failure occurs, you can restore your databases by using the backups and logs sent to your destination system.</span></span> <span data-ttu-id="82992-116">有关此步骤的详细信息，请参阅[如何还原您数据库](../core/how-to-restore-your-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="82992-116">For more information about this step, see [How to Restore Your Databases](../core/how-to-restore-your-databases.md).</span></span>  

## <a name="biztalk-server-databases"></a><span data-ttu-id="82992-117">BizTalk Server 数据库</span><span class="sxs-lookup"><span data-stu-id="82992-117">BizTalk Server Databases</span></span>  
 <span data-ttu-id="82992-118">下表描述了使用的数据库[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]并确定哪些方法可用来将数据库备份。</span><span class="sxs-lookup"><span data-stu-id="82992-118">The following tables describe the databases used by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and identify which methods are used to back up the databases.</span></span>  

### <a name="databases-backed-up-by-the-backup-biztalk-server-job"></a><span data-ttu-id="82992-119">备份的数据库的备份 BizTalk Server 作业</span><span class="sxs-lookup"><span data-stu-id="82992-119">Databases Backed Up by the Backup BizTalk Server Job</span></span>  
 <span data-ttu-id="82992-120">下表列出了数据库备份和还原的备份一部分[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]作业。</span><span class="sxs-lookup"><span data-stu-id="82992-120">The following table lists the databases that are backed up and restored as a part of the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job.</span></span> <span data-ttu-id="82992-121">您可以修改备份[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]作业，以通过将它们添加到 adm_OtherBackupDatabases 表来备份自定义数据库。</span><span class="sxs-lookup"><span data-stu-id="82992-121">You can modify the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up custom databases by adding them to the adm_OtherBackupDatabases table.</span></span> <span data-ttu-id="82992-122">有关详细信息，请参阅[如何返回自定义数据库](../core/how-to-back-up-custom-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="82992-122">For more information, see [How to Back Up Custom Databases](../core/how-to-back-up-custom-databases.md).</span></span>  


|                    <span data-ttu-id="82992-123">“数据库”</span><span class="sxs-lookup"><span data-stu-id="82992-123">Database</span></span>                    | <span data-ttu-id="82992-124">默认数据库名称</span><span class="sxs-lookup"><span data-stu-id="82992-124">Default database name</span></span> |                                                                                                                                       <span data-ttu-id="82992-125">Description</span><span class="sxs-lookup"><span data-stu-id="82992-125">Description</span></span>                                                                                                                                        |
|------------------------------------------------|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|          <span data-ttu-id="82992-126">BAM 主导入数据库</span><span class="sxs-lookup"><span data-stu-id="82992-126">BAM Primary Import database</span></span>           |   <span data-ttu-id="82992-127">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="82992-127">BAMPrimaryImport</span></span>    |                                                                                              <span data-ttu-id="82992-128">这是业务活动监视 (BAM) 从中收集原始跟踪数据的数据库。</span><span class="sxs-lookup"><span data-stu-id="82992-128">This is the database where the Business Activity Monitoring (BAM) collects raw tracking data.</span></span>                                                                                               |
| <span data-ttu-id="82992-129">BAM Notification Services 应用程序数据库</span><span class="sxs-lookup"><span data-stu-id="82992-129">BAM Notification Services Application database</span></span> | <span data-ttu-id="82992-130">BAMAlertsApplication</span><span class="sxs-lookup"><span data-stu-id="82992-130">BAMAlertsApplication</span></span>  | <span data-ttu-id="82992-131">此数据库包含 BAM 通知的警报信息。</span><span class="sxs-lookup"><span data-stu-id="82992-131">This database contains alert information for BAM notifications.</span></span> <span data-ttu-id="82992-132">例如，在创建警报使用 BAM 门户时，会将条目插入在指定与警报相关，以及其他支持的数据项的警报的条件和事件的数据库中。</span><span class="sxs-lookup"><span data-stu-id="82992-132">For example, when you create an alert using the BAM portal, entries are inserted in the database specifying the conditions and events to which the alert pertains, as well as other supporting data items for the alert.</span></span> |
|  <span data-ttu-id="82992-133">BAM 通知服务实例数据库</span><span class="sxs-lookup"><span data-stu-id="82992-133">BAM Notification Services Instance database</span></span>   |    <span data-ttu-id="82992-134">BAMAlertsNSMain</span><span class="sxs-lookup"><span data-stu-id="82992-134">BAMAlertsNSMain</span></span>    |                                                                            <span data-ttu-id="82992-135">此数据库包含指定 notification services 如何连接到 BAM 监视的系统的实例信息。</span><span class="sxs-lookup"><span data-stu-id="82992-135">This database contains instance information specifying how the notification services connect to the system that BAM is monitoring.</span></span>                                                                            |
|           <span data-ttu-id="82992-136">BizTalk 跟踪数据库</span><span class="sxs-lookup"><span data-stu-id="82992-136">BizTalk Tracking database</span></span>            |     <span data-ttu-id="82992-137">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="82992-137">BizTalkDTADb</span></span>      |                                                              <span data-ttu-id="82992-138">此数据库存储运行状况监视数据跟踪的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]跟踪引擎。</span><span class="sxs-lookup"><span data-stu-id="82992-138">This database stores health monitoring data tracked by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking engine.</span></span>                                                              |
|          <span data-ttu-id="82992-139">BizTalk 管理数据库</span><span class="sxs-lookup"><span data-stu-id="82992-139">BizTalk Management database</span></span>           |     <span data-ttu-id="82992-140">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="82992-140">BizTalkMgmtDb</span></span>     |                                                               <span data-ttu-id="82992-141">此数据库是的所有实例的中央元信息存储区[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="82992-141">This database is the central meta-information store for all instances of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>                                                               |
|          <span data-ttu-id="82992-142">BizTalk MessageBox 数据库</span><span class="sxs-lookup"><span data-stu-id="82992-142">BizTalk MessageBox database</span></span>           |    <span data-ttu-id="82992-143">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="82992-143">BizTalkMsgBoxDb</span></span>    |                                             <span data-ttu-id="82992-144">使用此数据库[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]引擎，用于路由、 排队、 实例管理和各种其他任务。</span><span class="sxs-lookup"><span data-stu-id="82992-144">This database is used by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] engine for routing, queuing, instance management, and a variety of other tasks.</span></span>                                              |
|              <span data-ttu-id="82992-145">规则引擎数据库</span><span class="sxs-lookup"><span data-stu-id="82992-145">Rule Engine database</span></span>              |  <span data-ttu-id="82992-146">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="82992-146">BizTalkRuleEngineDb</span></span>  |                                     <span data-ttu-id="82992-147">此数据库是存储库：</span><span class="sxs-lookup"><span data-stu-id="82992-147">This database is a repository for:</span></span><br /><br /> <span data-ttu-id="82992-148">-策略，这是一组相关的规则。</span><span class="sxs-lookup"><span data-stu-id="82992-148">-   Policies, which are sets of related rules.</span></span><br /><span data-ttu-id="82992-149">-词汇，即是规则中的数据引用的用户友好的特定于域的名称的集合。</span><span class="sxs-lookup"><span data-stu-id="82992-149">-   Vocabularies, which are collections of user-friendly, domain-specific names for data references in rules.</span></span>                                     |
|                  <span data-ttu-id="82992-150">SSO 数据库</span><span class="sxs-lookup"><span data-stu-id="82992-150">SSO database</span></span>                  |         <span data-ttu-id="82992-151">SSODB</span><span class="sxs-lookup"><span data-stu-id="82992-151">SSODB</span></span>         |                                                                                       <span data-ttu-id="82992-152">此企业单一登录数据库安全地存储配置信息的接收位置。</span><span class="sxs-lookup"><span data-stu-id="82992-152">This Enterprise Single Sign-On database securely stores the configuration information for receive locations.</span></span>                                                                                       |

### <a name="databases-backed-up-by-the-bam-backup-process"></a><span data-ttu-id="82992-153">通过 BAM 备份过程备份数据库</span><span class="sxs-lookup"><span data-stu-id="82992-153">Databases Backed Up by the BAM Backup Process</span></span>  
 <span data-ttu-id="82992-154">下表列出了备份和还原使用中的过程的数据库[备份和还原 BAM](../core/backing-up-and-restoring-bam.md):</span><span class="sxs-lookup"><span data-stu-id="82992-154">The following table lists the databases that are backed up and restored using the procedures in [Backing Up and Restoring BAM](../core/backing-up-and-restoring-bam.md):</span></span>  

|<span data-ttu-id="82992-155">“数据库”</span><span class="sxs-lookup"><span data-stu-id="82992-155">Database</span></span>|<span data-ttu-id="82992-156">默认数据库名称</span><span class="sxs-lookup"><span data-stu-id="82992-156">Default database name</span></span>|<span data-ttu-id="82992-157">Description</span><span class="sxs-lookup"><span data-stu-id="82992-157">Description</span></span>|  
|--------------|---------------------------|-----------------|  
|<span data-ttu-id="82992-158">BAM 星型架构</span><span class="sxs-lookup"><span data-stu-id="82992-158">BAM Star Schema</span></span>|<span data-ttu-id="82992-159">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="82992-159">BAMStarSchema</span></span>|<span data-ttu-id="82992-160">此数据库包含中间临时表、 和的度量值和维度表。</span><span class="sxs-lookup"><span data-stu-id="82992-160">This database contains the staging table, and the measure and dimension tables.</span></span>|  
|<span data-ttu-id="82992-161">BAM 分析</span><span class="sxs-lookup"><span data-stu-id="82992-161">BAM Analysis</span></span>|<span data-ttu-id="82992-162">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="82992-162">BAMAnalysis</span></span>|<span data-ttu-id="82992-163">此数据库包含 BAM OLAP 多维数据集以进行联机和脱机分析。</span><span class="sxs-lookup"><span data-stu-id="82992-163">This database contains BAM OLAP cubes for both online and offline analysis.</span></span>|  
|<span data-ttu-id="82992-164">BAM 存档</span><span class="sxs-lookup"><span data-stu-id="82992-164">BAM Archive</span></span>|<span data-ttu-id="82992-165">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="82992-165">BAMArchive</span></span>|<span data-ttu-id="82992-166">此数据库存档旧的业务活动数据。</span><span class="sxs-lookup"><span data-stu-id="82992-166">This database archives old business activity data.</span></span> <span data-ttu-id="82992-167">创建 BAM 存档数据库以最大程度减少 BAM 主导入数据库中的业务活动数据的累计。</span><span class="sxs-lookup"><span data-stu-id="82992-167">Create a BAM Archive database to minimize the accumulation of business activity data in the BAM Primary Import database.</span></span>|  
|<span data-ttu-id="82992-168">跟踪分析服务器</span><span class="sxs-lookup"><span data-stu-id="82992-168">Tracking Analysis Server</span></span>|<span data-ttu-id="82992-169">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="82992-169">BizTalkAnalysisDb</span></span>|<span data-ttu-id="82992-170">此数据库存储运行状况监视联机分析处理 (OLAP) 多维数据集。</span><span class="sxs-lookup"><span data-stu-id="82992-170">This database stores health monitoring online analytical processing (OLAP) cubes.</span></span>|  

## <a name="in-this-section"></a><span data-ttu-id="82992-171">本节内容</span><span class="sxs-lookup"><span data-stu-id="82992-171">In This Section</span></span>  

-   [<span data-ttu-id="82992-172">如何配置备份 BizTalk Server 作业</span><span class="sxs-lookup"><span data-stu-id="82992-172">How to Configure the Backup BizTalk Server Job</span></span>](../core/how-to-configure-the-backup-biztalk-server-job.md)  

-   [<span data-ttu-id="82992-173">如何配置日志传送目标系统</span><span class="sxs-lookup"><span data-stu-id="82992-173">How to Configure the Destination System for Log Shipping</span></span>](../core/how-to-configure-the-destination-system-for-log-shipping.md)  

-   [<span data-ttu-id="82992-174">如何还原数据库</span><span class="sxs-lookup"><span data-stu-id="82992-174">How to Restore Your Databases</span></span>](../core/how-to-restore-your-databases.md)  

-   [<span data-ttu-id="82992-175">如何备份和还原 SQL 代理作业</span><span class="sxs-lookup"><span data-stu-id="82992-175">How to Back Up and Restore SQL Agent Jobs</span></span>](../core/how-to-back-up-and-restore-sql-agent-jobs.md)  

-   [<span data-ttu-id="82992-176">如何备份和还原 SQL Server 登录名</span><span class="sxs-lookup"><span data-stu-id="82992-176">How to Back Up and Restore SQL Server Logins</span></span>](../core/how-to-back-up-and-restore-sql-server-logins.md)