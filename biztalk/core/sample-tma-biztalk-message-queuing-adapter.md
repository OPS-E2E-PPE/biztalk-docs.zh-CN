---
title: 示例 TMA:BizTalk 消息队列适配器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- security examples [TMA], MSMQ adapters
- architecture, examples
- MSMQ adapters, TMA
- DFD, MSMQ adapters
- MSMQ adapters, data flow
ms.assetid: 15b4a540-2fcd-4668-b4b4-757f23ebd83e
caps.latest.revision: 23
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 27187bcb688ed50d6935fb7dd386cdaad6f59ede
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65393880"
---
# <a name="sample-tma-biztalk-message-queuing-adapter"></a><span data-ttu-id="d12c2-102">示例 TMA:BizTalk 消息队列适配器</span><span class="sxs-lookup"><span data-stu-id="d12c2-102">Sample TMA: BizTalk Message Queuing Adapter</span></span>
<span data-ttu-id="d12c2-103">本主题介绍对示例结构的 BizTalk 消息队列适配器方案进行威胁模型分析 (TMA)。</span><span class="sxs-lookup"><span data-stu-id="d12c2-103">This topic presents the threat model analysis (TMA) for the BizTalk Message Queuing adapter scenario for the sample architecture.</span></span>  
  
## <a name="step-1-collect-background-information-biztalk-message-queuing-adapter-scenario"></a><span data-ttu-id="d12c2-104">步骤 1.</span><span class="sxs-lookup"><span data-stu-id="d12c2-104">Step 1.</span></span> <span data-ttu-id="d12c2-105">收集背景信息 （BizTalk 消息队列适配器方案）</span><span class="sxs-lookup"><span data-stu-id="d12c2-105">Collect Background Information (BizTalk Message Queuing Adapter Scenario)</span></span>  
 <span data-ttu-id="d12c2-106">本部分提供对示例结构的 BizTalk 消息队列适配器方案的数据流关系图 (DFD)。</span><span class="sxs-lookup"><span data-stu-id="d12c2-106">This section provides the data flow diagram (DFD) for the BizTalk Message Queuing adapter scenario for the sample architecture.</span></span> <span data-ttu-id="d12c2-107">下图显示了 HTTP 和 SOAP 适配器方案的示例体系结构。</span><span class="sxs-lookup"><span data-stu-id="d12c2-107">The following figure shows the sample architecture for the HTTP and SOAP adapters scenario.</span></span>  
  
 <span data-ttu-id="d12c2-108">**图 1 BizTalk 消息队列适配器方案的示例体系结构**</span><span class="sxs-lookup"><span data-stu-id="d12c2-108">**Figure 1 Sample architecture for the BizTalk Message Queuing adapter scenario**</span></span>  
  
 <span data-ttu-id="d12c2-109">![用于 BizTalk 消息队列的示例体系结构](../core/media/tdi-sec-refarch-msmq.gif "TDI_Sec_RefArch_MSMQ")</span><span class="sxs-lookup"><span data-stu-id="d12c2-109">![Sample architecture for BizTalk Message Queuing](../core/media/tdi-sec-refarch-msmq.gif "TDI_Sec_RefArch_MSMQ")</span></span>  
  
 <span data-ttu-id="d12c2-110">所有其他背景信息是相同的所有使用方案，以及前面所述[示例方案的背景信息](../core/background-information-for-sample-scenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="d12c2-110">All the other background information is the same for all our usage scenarios, and is described previously in [Background Information for Sample Scenarios](../core/background-information-for-sample-scenarios.md).</span></span>  
  
### <a name="data-flow-diagram"></a><span data-ttu-id="d12c2-111">数据流关系图</span><span class="sxs-lookup"><span data-stu-id="d12c2-111">Data Flow Diagram</span></span>  
 <span data-ttu-id="d12c2-112">使用 BizTalk 消息队列适配器时，下图显示了示例结构的 dfd:。</span><span class="sxs-lookup"><span data-stu-id="d12c2-112">The following figure shows the DFD for the sample architecture when you use the BizTalk Message Queuing adapter.</span></span>  
  
 <span data-ttu-id="d12c2-113">**图 2 的示例结构的 BizTalk 消息队列适配器方案的 DFD**</span><span class="sxs-lookup"><span data-stu-id="d12c2-113">**Figure 2 DFD for the sample architecture of the BizTalk Message Queuing adapter scenario**</span></span>  
  
 <span data-ttu-id="d12c2-114">![用于 BizTalk 消息队列的示例体系结构](../core/media/tdi-sec-refarch-dfd-msmq.gif "TDI_Sec_RefArch_DFD_MSMQ")</span><span class="sxs-lookup"><span data-stu-id="d12c2-114">![Sample architecture for BizTalk Message Queuing](../core/media/tdi-sec-refarch-dfd-msmq.gif "TDI_Sec_RefArch_DFD_MSMQ")</span></span>  
  
 <span data-ttu-id="d12c2-115">数据流如下所示：</span><span class="sxs-lookup"><span data-stu-id="d12c2-115">The data flow is as follows:</span></span>  
  
1.  <span data-ttu-id="d12c2-116">合作伙伴发送使用消息队列或 BizTalk 消息队列的消息。</span><span class="sxs-lookup"><span data-stu-id="d12c2-116">A partner sends a message using Message Queuing or BizTalk Message Queuing.</span></span> <span data-ttu-id="d12c2-117">将消息以适当的格式打包并在网络上发送。</span><span class="sxs-lookup"><span data-stu-id="d12c2-117">The message is packed in the appropriate format and sent on the network.</span></span> <span data-ttu-id="d12c2-118">如果使用 Active Directory，则消息将通过一系列消息队列路由器，直至到达正确的目标 （BizTalk Server 运行主机实例的 BizTalk 消息队列接收适配器）。</span><span class="sxs-lookup"><span data-stu-id="d12c2-118">If you use Active Directory, the message goes through a series of Message Queuing routers until it reaches the right destination (the BizTalk Server that runs a host instance of the BizTalk Message Queuing receive adapter).</span></span>  
  
2.  <span data-ttu-id="d12c2-119">进程内主机实例定期 BizTalk 消息队列接收适配器从消息队列路由器 （通过防火墙 2) 接收消息、 进行初始处理、 发送正确的网络响应所定义的网络协议并将该消息放入 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="d12c2-119">An instance of an in-process host for the BizTalk Message Queuing receive adapter regularly receives the message from a Message Queuing router (through Firewall 2), does any initial processing, sends the correct network responses as defined by the network protocol, and puts the message in the MessageBox database.</span></span>  
  
3.  <span data-ttu-id="d12c2-120">已对消息的订阅的处理主机实例提取该消息从 MessageBox 数据库、 任何其他处理，并将该消息放回 MessageBox 数据库中。</span><span class="sxs-lookup"><span data-stu-id="d12c2-120">An instance of the processing host that has a subscription to the message picks it up from the MessageBox database, does any additional processing, and puts the message back in the MessageBox database.</span></span>  
  
4.  <span data-ttu-id="d12c2-121">具有 BizTalk 消息队列发送适配器的进程内主机实例中提取消息从 MessageBox 数据库。</span><span class="sxs-lookup"><span data-stu-id="d12c2-121">An instance of the in-process host that has a BizTalk Message Queuing send adapter picks up the message from the MessageBox database.</span></span> <span data-ttu-id="d12c2-122">消息完成所有最终处理在发送管道中，并且然后通过防火墙 2 通过网络发送到合作伙伴或应用程序。</span><span class="sxs-lookup"><span data-stu-id="d12c2-122">The message goes through any final processing in the send pipeline, and is then sent through Firewall 2 over the network to the partner or application.</span></span>  
  
## <a name="step-2-create-and-analyze-the-threat-model-biztalk-message-queuing-adapter-scenario"></a><span data-ttu-id="d12c2-123">步骤 2.</span><span class="sxs-lookup"><span data-stu-id="d12c2-123">Step 2.</span></span> <span data-ttu-id="d12c2-124">创建和分析威胁模型 （BizTalk 消息队列适配器方案）</span><span class="sxs-lookup"><span data-stu-id="d12c2-124">Create and Analyze the Threat Model (BizTalk Message Queuing Adapter Scenario)</span></span>  
 <span data-ttu-id="d12c2-125">本部分提供对示例结构的 BizTalk 消息队列适配器方案执行的 TMA 的结果。</span><span class="sxs-lookup"><span data-stu-id="d12c2-125">This section provides the results of the TMA we did for the BizTalk Message Queuing adapter scenario for the sample architecture.</span></span>  
  
- <span data-ttu-id="d12c2-126">**确定入口点、 信任边界和数据流-** 请参阅之前在步骤 1 中以及中所述的背景信息[示例方案的背景信息](../core/background-information-for-sample-scenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="d12c2-126">**Identify Entry Points, Trust Boundaries, and Flow of Data -** See background information described earlier in step 1 and in [Background Information for Sample Scenarios](../core/background-information-for-sample-scenarios.md).</span></span>  
  
- <span data-ttu-id="d12c2-127">**创建一组威胁-** 我们使用以下分类 DFD 中的所有条目来识别潜在威胁的方案：**S**poofing 标识，请**T**篡改数据， **R**epudiation，**我**表示信息泄露**D**表示拒绝服务，并**E**表示特权提升。</span><span class="sxs-lookup"><span data-stu-id="d12c2-127">**Create a List of the Identified Threats -** We used the following categorization for all entries in the DFD to identify potential threats to the scenario: **S**poofing identify, **T**ampering with data, **R**epudiation, **I**nformation disclosure, **D**enial of service, and **E**levation of privileges.</span></span> <span data-ttu-id="d12c2-128">下表列出了使用 BizTalk 消息队列适配器发送和接收消息与 BizTalk Server 时的各威胁分类。</span><span class="sxs-lookup"><span data-stu-id="d12c2-128">The following table lists the threats we identified when you use the BizTalk Message Queuing adapter to send and receive messages to and from BizTalk Server.</span></span>  
  
  <span data-ttu-id="d12c2-129">**表 1 威胁分类列表**</span><span class="sxs-lookup"><span data-stu-id="d12c2-129">**Table 1 List of identified threats**</span></span>  
  
|<span data-ttu-id="d12c2-130">威胁</span><span class="sxs-lookup"><span data-stu-id="d12c2-130">Threat</span></span>|<span data-ttu-id="d12c2-131">Description</span><span class="sxs-lookup"><span data-stu-id="d12c2-131">Description</span></span>|<span data-ttu-id="d12c2-132">资产</span><span class="sxs-lookup"><span data-stu-id="d12c2-132">Asset</span></span>|<span data-ttu-id="d12c2-133">影响</span><span class="sxs-lookup"><span data-stu-id="d12c2-133">Impact</span></span>|  
|------------|-----------------|-----------|------------|  
|<span data-ttu-id="d12c2-134">发送大量消息，以接收位置</span><span class="sxs-lookup"><span data-stu-id="d12c2-134">Send lots of messages to receive location</span></span>|<span data-ttu-id="d12c2-135">恶意用户可以发送大量有效或无效的消息和填满该应用程序。</span><span class="sxs-lookup"><span data-stu-id="d12c2-135">A malicious user can send a large number of valid or invalid messages and flood the application.</span></span>|<span data-ttu-id="d12c2-136">BizTalk Server 环境</span><span class="sxs-lookup"><span data-stu-id="d12c2-136">BizTalk Server environment</span></span>|<span data-ttu-id="d12c2-137">拒绝服务</span><span class="sxs-lookup"><span data-stu-id="d12c2-137">Denial of service</span></span>|  
|<span data-ttu-id="d12c2-138">在网络上以明文形式传输消息标头</span><span class="sxs-lookup"><span data-stu-id="d12c2-138">Message header travels in the clear on the wire</span></span>|<span data-ttu-id="d12c2-139">随着从队列消息传递到 BizTalk 消息队列接收适配器，消息标头为明文形式，并且恶意用户可能可以读取并篡改标头。</span><span class="sxs-lookup"><span data-stu-id="d12c2-139">As the message travels from the queue to the BizTalk Message Queuing receive adapter, the message header is in the clear, and a malicious user can potentially read and tamper with the header.</span></span>|<span data-ttu-id="d12c2-140">消息标头</span><span class="sxs-lookup"><span data-stu-id="d12c2-140">Message header</span></span>|<span data-ttu-id="d12c2-141">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-141">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-142">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-142">Information disclosure</span></span>|  
|<span data-ttu-id="d12c2-143">未经授权的用户可以对运行 BizTalk 消息队列主机的 BizTalk 服务器进行网络连接</span><span class="sxs-lookup"><span data-stu-id="d12c2-143">An unauthorized user can make a network connection to the BizTalk Server that runs the BizTalk Message Queuing host</span></span>|<span data-ttu-id="d12c2-144">不能使用任意访问列表 (DACL) 来限制对 BizTalk 消息队列访问接收位置。</span><span class="sxs-lookup"><span data-stu-id="d12c2-144">You cannot use a discretionary access list (DACL) to restrict access to the BizTalk Message Queuing receive location.</span></span> <span data-ttu-id="d12c2-145">因此，可以对运行 BizTalk 消息队列的主机实例的 BizTalk 服务器进行网络连接的任何人都接收适配器和端口 1801年可以发送到 BizTalk 消息队列的消息的接收位置。</span><span class="sxs-lookup"><span data-stu-id="d12c2-145">Therefore, anyone that can make a network connection to the BizTalk Server that runs a host instance of the BizTalk Message Queuing receive adapter and to port 1801 can send messages to the BizTalk Message Queuing receive location.</span></span>|<span data-ttu-id="d12c2-146">BizTalk Server 环境</span><span class="sxs-lookup"><span data-stu-id="d12c2-146">BizTalk Server environment</span></span>|<span data-ttu-id="d12c2-147">否认性</span><span class="sxs-lookup"><span data-stu-id="d12c2-147">Repudiation</span></span><br /><br /> <span data-ttu-id="d12c2-148">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-148">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-149">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-149">Information disclosure</span></span><br /><br /> <span data-ttu-id="d12c2-150">拒绝服务</span><span class="sxs-lookup"><span data-stu-id="d12c2-150">Denial of service</span></span><br /><br /> <span data-ttu-id="d12c2-151">特权提升</span><span class="sxs-lookup"><span data-stu-id="d12c2-151">Elevation of privileges</span></span>|  
|<span data-ttu-id="d12c2-152">恶意用户可能篡改该消息，BizTalk Server 接收它之前</span><span class="sxs-lookup"><span data-stu-id="d12c2-152">A malicious user can tamper with the message before BizTalk Server receives it</span></span>|<span data-ttu-id="d12c2-153">恶意用户可以在传输时截获消息并对其进行修改。</span><span class="sxs-lookup"><span data-stu-id="d12c2-153">A malicious user can intercept the message while it is in transit and modify it.</span></span>|<span data-ttu-id="d12c2-154">消息正文</span><span class="sxs-lookup"><span data-stu-id="d12c2-154">Message body</span></span>|<span data-ttu-id="d12c2-155">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-155">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-156">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-156">Information disclosure</span></span>|  
  
## <a name="step-3-review-threats-biztalk-message-queuing-adapter-scenario"></a><span data-ttu-id="d12c2-157">步骤 3.</span><span class="sxs-lookup"><span data-stu-id="d12c2-157">Step 3.</span></span> <span data-ttu-id="d12c2-158">查看威胁 （BizTalk 消息队列适配器方案）</span><span class="sxs-lookup"><span data-stu-id="d12c2-158">Review Threats (BizTalk Message Queuing Adapter Scenario)</span></span>  
 <span data-ttu-id="d12c2-159">本部分提供有关对示例结构的 BizTalk 消息队列适配器方案的各威胁分类的风险分析的结果。</span><span class="sxs-lookup"><span data-stu-id="d12c2-159">This section provides the results of the risk analysis we did for threats we identified for the BizTalk Message Queuing adapter scenario for the sample architecture.</span></span> <span data-ttu-id="d12c2-160">在主要威胁模型会议后，我们对威胁进行并使用以下影响类别来划分每种威胁的风险：**D**潜在，损害**R**再现， **E**xploitability，**一个**可用户并**D**iscoverability。</span><span class="sxs-lookup"><span data-stu-id="d12c2-160">After the main threat model meeting, we reviewed the threats and used the following impact categories to identify the risk for each threat: **D**amage potential, **R**eproducibility, **E**xploitability, **A**ffected users, and **D**iscoverability.</span></span>  
  
 <span data-ttu-id="d12c2-161">下表列出了使用 BizTalk 消息队列适配器发送和接收消息与 BizTalk Server 时的各威胁分类的风险等级。</span><span class="sxs-lookup"><span data-stu-id="d12c2-161">The following table lists the risk ratings for the threats we identified when you use the BizTalk Message Queuing adapter to send and receive messages to and from BizTalk Server.</span></span>  
  
 <span data-ttu-id="d12c2-162">**表 2 威胁分类的风险等级**</span><span class="sxs-lookup"><span data-stu-id="d12c2-162">**Table 2 Risk ratings for identified threats**</span></span>  
  
|<span data-ttu-id="d12c2-163">威胁</span><span class="sxs-lookup"><span data-stu-id="d12c2-163">Threat</span></span>|<span data-ttu-id="d12c2-164">影响</span><span class="sxs-lookup"><span data-stu-id="d12c2-164">Impact</span></span>|<span data-ttu-id="d12c2-165">潜在破坏性</span><span class="sxs-lookup"><span data-stu-id="d12c2-165">Damage potential</span></span>|<span data-ttu-id="d12c2-166">可再现性</span><span class="sxs-lookup"><span data-stu-id="d12c2-166">Reproducibility</span></span>|<span data-ttu-id="d12c2-167">可利用性指数</span><span class="sxs-lookup"><span data-stu-id="d12c2-167">Exploitability</span></span>|<span data-ttu-id="d12c2-168">受影响的用户</span><span class="sxs-lookup"><span data-stu-id="d12c2-168">Affected users</span></span>|<span data-ttu-id="d12c2-169">可发现性</span><span class="sxs-lookup"><span data-stu-id="d12c2-169">Discoverability</span></span>|<span data-ttu-id="d12c2-170">风险危害</span><span class="sxs-lookup"><span data-stu-id="d12c2-170">Risk exposure</span></span>|  
|------------|------------|----------------------|---------------------|--------------------|--------------------|---------------------|-------------------|  
|<span data-ttu-id="d12c2-171">发送大量消息，以接收位置</span><span class="sxs-lookup"><span data-stu-id="d12c2-171">Send lots of messages to receive location</span></span>|<span data-ttu-id="d12c2-172">拒绝服务</span><span class="sxs-lookup"><span data-stu-id="d12c2-172">Denial of service</span></span>|<span data-ttu-id="d12c2-173">8</span><span class="sxs-lookup"><span data-stu-id="d12c2-173">8</span></span>|<span data-ttu-id="d12c2-174">7</span><span class="sxs-lookup"><span data-stu-id="d12c2-174">7</span></span>|<span data-ttu-id="d12c2-175">7</span><span class="sxs-lookup"><span data-stu-id="d12c2-175">7</span></span>|<span data-ttu-id="d12c2-176">7</span><span class="sxs-lookup"><span data-stu-id="d12c2-176">7</span></span>|<span data-ttu-id="d12c2-177">5</span><span class="sxs-lookup"><span data-stu-id="d12c2-177">5</span></span>|<span data-ttu-id="d12c2-178">6.8</span><span class="sxs-lookup"><span data-stu-id="d12c2-178">6.8</span></span>|  
|<span data-ttu-id="d12c2-179">在网络上以明文形式传输消息标头</span><span class="sxs-lookup"><span data-stu-id="d12c2-179">Message header travels in the clear on the wire</span></span>|<span data-ttu-id="d12c2-180">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-180">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-181">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-181">Information disclosure</span></span>|<span data-ttu-id="d12c2-182">8</span><span class="sxs-lookup"><span data-stu-id="d12c2-182">8</span></span>|<span data-ttu-id="d12c2-183">10</span><span class="sxs-lookup"><span data-stu-id="d12c2-183">10</span></span>|<span data-ttu-id="d12c2-184">8</span><span class="sxs-lookup"><span data-stu-id="d12c2-184">8</span></span>|<span data-ttu-id="d12c2-185">3</span><span class="sxs-lookup"><span data-stu-id="d12c2-185">3</span></span>|<span data-ttu-id="d12c2-186">5</span><span class="sxs-lookup"><span data-stu-id="d12c2-186">5</span></span>|<span data-ttu-id="d12c2-187">6.8</span><span class="sxs-lookup"><span data-stu-id="d12c2-187">6.8</span></span>|  
|<span data-ttu-id="d12c2-188">未经授权的用户可以对运行 BizTalk 消息队列主机的 BizTalk 服务器进行网络连接</span><span class="sxs-lookup"><span data-stu-id="d12c2-188">An unauthorized user can make a network connection to the BizTalk Server that runs the BizTalk Message Queuing host</span></span>|<span data-ttu-id="d12c2-189">否认性</span><span class="sxs-lookup"><span data-stu-id="d12c2-189">Repudiation</span></span><br /><br /> <span data-ttu-id="d12c2-190">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-190">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-191">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-191">Information disclosure</span></span><br /><br /> <span data-ttu-id="d12c2-192">拒绝服务</span><span class="sxs-lookup"><span data-stu-id="d12c2-192">Denial of service</span></span><br /><br /> <span data-ttu-id="d12c2-193">特权提升</span><span class="sxs-lookup"><span data-stu-id="d12c2-193">Elevation of privileges</span></span>|<span data-ttu-id="d12c2-194">8</span><span class="sxs-lookup"><span data-stu-id="d12c2-194">8</span></span>|<span data-ttu-id="d12c2-195">10</span><span class="sxs-lookup"><span data-stu-id="d12c2-195">10</span></span>|<span data-ttu-id="d12c2-196">9</span><span class="sxs-lookup"><span data-stu-id="d12c2-196">9</span></span>|<span data-ttu-id="d12c2-197">9</span><span class="sxs-lookup"><span data-stu-id="d12c2-197">9</span></span>|<span data-ttu-id="d12c2-198">9</span><span class="sxs-lookup"><span data-stu-id="d12c2-198">9</span></span>|<span data-ttu-id="d12c2-199">9</span><span class="sxs-lookup"><span data-stu-id="d12c2-199">9</span></span>|  
|<span data-ttu-id="d12c2-200">恶意用户可能篡改该消息，BizTalk Server 接收它之前</span><span class="sxs-lookup"><span data-stu-id="d12c2-200">A malicious user can tamper with the message before BizTalk Server receives it</span></span>|<span data-ttu-id="d12c2-201">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-201">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-202">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-202">Information disclosure</span></span>|<span data-ttu-id="d12c2-203">5</span><span class="sxs-lookup"><span data-stu-id="d12c2-203">5</span></span>|<span data-ttu-id="d12c2-204">7</span><span class="sxs-lookup"><span data-stu-id="d12c2-204">7</span></span>|<span data-ttu-id="d12c2-205">6</span><span class="sxs-lookup"><span data-stu-id="d12c2-205">6</span></span>|<span data-ttu-id="d12c2-206">5</span><span class="sxs-lookup"><span data-stu-id="d12c2-206">5</span></span>|<span data-ttu-id="d12c2-207">7</span><span class="sxs-lookup"><span data-stu-id="d12c2-207">7</span></span>|<span data-ttu-id="d12c2-208">6</span><span class="sxs-lookup"><span data-stu-id="d12c2-208">6</span></span>|  
  
## <a name="step-4-identify-mitigation-techniques-biztalk-message-queuing-adapter-scenario"></a><span data-ttu-id="d12c2-209">步骤 4.</span><span class="sxs-lookup"><span data-stu-id="d12c2-209">Step 4.</span></span> <span data-ttu-id="d12c2-210">确定缓解措施 （BizTalk 消息队列适配器方案）</span><span class="sxs-lookup"><span data-stu-id="d12c2-210">Identify Mitigation Techniques (BizTalk Message Queuing Adapter Scenario)</span></span>  
 <span data-ttu-id="d12c2-211">本部分介绍对示例结构的 BizTalk 消息队列适配器方案的各威胁分类的一些缓解措施。</span><span class="sxs-lookup"><span data-stu-id="d12c2-211">This section presents some mitigation techniques for the threats we identified for the BizTalk Message Queuing adapter scenario for the sample architecture.</span></span>  
  
 <span data-ttu-id="d12c2-212">下表列出了缓解措施时使用的 BizTalk 消息队列适配器发送和接收消息与 BizTalk Server 的各威胁分类。</span><span class="sxs-lookup"><span data-stu-id="d12c2-212">The following table lists mitigation techniques and technologies for the threats we identified when you use the BizTalk Message Queuing adapter to send and receive messages to and from BizTalk Server.</span></span>  
  
 <span data-ttu-id="d12c2-213">**表 3 缓解措施和技术**</span><span class="sxs-lookup"><span data-stu-id="d12c2-213">**Table 3 Mitigation techniques and technologies**</span></span>  
  
|<span data-ttu-id="d12c2-214">威胁</span><span class="sxs-lookup"><span data-stu-id="d12c2-214">Threat</span></span>|<span data-ttu-id="d12c2-215">影响</span><span class="sxs-lookup"><span data-stu-id="d12c2-215">Impact</span></span>|<span data-ttu-id="d12c2-216">风险危害</span><span class="sxs-lookup"><span data-stu-id="d12c2-216">Risk exposure</span></span>|<span data-ttu-id="d12c2-217">缓解措施</span><span class="sxs-lookup"><span data-stu-id="d12c2-217">Mitigation techniques and technologies</span></span>|  
|------------|------------|-------------------|--------------------------------------------|  
|<span data-ttu-id="d12c2-218">发送大量消息，以接收位置</span><span class="sxs-lookup"><span data-stu-id="d12c2-218">Send lots of messages to receive location</span></span>|<span data-ttu-id="d12c2-219">拒绝服务</span><span class="sxs-lookup"><span data-stu-id="d12c2-219">Denial of service</span></span>|<span data-ttu-id="d12c2-220">6.8</span><span class="sxs-lookup"><span data-stu-id="d12c2-220">6.8</span></span>|<span data-ttu-id="d12c2-221">在身份验证要求模式下使用 BizTalk 消息队列适配器。</span><span class="sxs-lookup"><span data-stu-id="d12c2-221">Use the BizTalk Message Queuing adapter in authentication-required mode.</span></span> <span data-ttu-id="d12c2-222">设置**要求 MSMQ 身份验证**接收位置上的标志和**身份验证必需 （删除消息）** 接收端口上。</span><span class="sxs-lookup"><span data-stu-id="d12c2-222">Set the **Requires MSMQ authentication** flag on the receive location and **Authentication Required (Drop messages)** on the receive port.</span></span><br /><br /> <span data-ttu-id="d12c2-223">配置 BizTalk 消息队列需要基于证书的身份验证。</span><span class="sxs-lookup"><span data-stu-id="d12c2-223">Configure BizTalk Message Queuing to require certificate-based authentication.</span></span> <span data-ttu-id="d12c2-224">此行为在适配器级别进行，并且不同于 BizTalk 管道的参与方解析组件。</span><span class="sxs-lookup"><span data-stu-id="d12c2-224">This behavior occurs at the adapter level, and is different from the Party Resolution component of a BizTalk pipeline.</span></span> <span data-ttu-id="d12c2-225">如果配置，是包含在传入消息的公用证书。</span><span class="sxs-lookup"><span data-stu-id="d12c2-225">If configured, the public certificate is included with the incoming message.</span></span> <span data-ttu-id="d12c2-226">这是可用于 BizTalk 消息队列的唯一客户端身份验证模式。</span><span class="sxs-lookup"><span data-stu-id="d12c2-226">This is the only client authentication mode available for BizTalk Message Queuing.</span></span> <span data-ttu-id="d12c2-227">若要使用此客户端身份验证模式，您必须安装 BizTalk 消息队列与 Active Directory 集成模式。</span><span class="sxs-lookup"><span data-stu-id="d12c2-227">To use this client authentication mode, you must install BizTalk Message Queuing with Active Directory Integration Mode.</span></span> <span data-ttu-id="d12c2-228">当使用此功能时，请记住选择**要求进行身份验证**复选框上的属性对话框的 BizTalk 消息队列接收位置。</span><span class="sxs-lookup"><span data-stu-id="d12c2-228">When you use this feature, remember to select the **Require Authentication** check box on the property dialog box for the BizTalk Message Queuing receive location.</span></span>|  
|<span data-ttu-id="d12c2-229">在网络上以明文形式传输消息标头</span><span class="sxs-lookup"><span data-stu-id="d12c2-229">Message header travels in the clear on the wire</span></span>|<span data-ttu-id="d12c2-230">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-230">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-231">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-231">Information disclosure</span></span>|<span data-ttu-id="d12c2-232">6.8</span><span class="sxs-lookup"><span data-stu-id="d12c2-232">6.8</span></span>|<span data-ttu-id="d12c2-233">使用 Internet 协议安全 (IPsec) 来帮助保护消息正文和消息标头，在一台服务器间传递到另一个。</span><span class="sxs-lookup"><span data-stu-id="d12c2-233">Use Internet Protocol security (IPsec) to help protect the message body and the message header as it travels from one server to another.</span></span>|  
|<span data-ttu-id="d12c2-234">未经授权的用户可以对运行 BizTalk 消息队列主机的 BizTalk 服务器进行网络连接</span><span class="sxs-lookup"><span data-stu-id="d12c2-234">An unauthorized user can make a network connection to the BizTalk Server that runs the BizTalk Message Queuing host</span></span>|<span data-ttu-id="d12c2-235">否认性</span><span class="sxs-lookup"><span data-stu-id="d12c2-235">Repudiation</span></span><br /><br /> <span data-ttu-id="d12c2-236">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-236">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-237">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-237">Information disclosure</span></span><br /><br /> <span data-ttu-id="d12c2-238">拒绝服务</span><span class="sxs-lookup"><span data-stu-id="d12c2-238">Denial of service</span></span><br /><br /> <span data-ttu-id="d12c2-239">特权提升</span><span class="sxs-lookup"><span data-stu-id="d12c2-239">Elevation of privileges</span></span>|<span data-ttu-id="d12c2-240">9</span><span class="sxs-lookup"><span data-stu-id="d12c2-240">9</span></span>|<span data-ttu-id="d12c2-241">创建包含参与方解析管道组件的自定义管道，然后配置要使用发件人 ID (SID) 来解析参与方的参与方解析组件。</span><span class="sxs-lookup"><span data-stu-id="d12c2-241">Create a custom pipeline with a Party Resolution pipeline component, and then configure the Party Resolution component to use the Sender ID (SID) to resolve the party.</span></span> <span data-ttu-id="d12c2-242">设置**通过证书解析参与方**属性设置为**False**，并**通过 SID 解析参与方**属性设置为**True**。</span><span class="sxs-lookup"><span data-stu-id="d12c2-242">Set the **Resolve Party By Certificate** property to **False**, and the **Resolve Party By SID** property to **True**.</span></span> <span data-ttu-id="d12c2-243">有关详细信息，请参阅[参与方解析管道组件](../core/party-resolution-pipeline-component.md)。</span><span class="sxs-lookup"><span data-stu-id="d12c2-243">For more information, see [Party Resolution Pipeline Component](../core/party-resolution-pipeline-component.md).</span></span><br /><br /> <span data-ttu-id="d12c2-244">在接收端口上设置**身份验证**属性设置为**必需 （删除消息）**。</span><span class="sxs-lookup"><span data-stu-id="d12c2-244">On the receive port, set the **Authentication** property to **Required (Drop Messages)**.</span></span>|  
|<span data-ttu-id="d12c2-245">恶意用户可能篡改该消息，BizTalk Server 接收它之前</span><span class="sxs-lookup"><span data-stu-id="d12c2-245">A malicious user can tamper with the message before BizTalk Server receives it</span></span>|<span data-ttu-id="d12c2-246">篡改数据</span><span class="sxs-lookup"><span data-stu-id="d12c2-246">Tampering with data</span></span><br /><br /> <span data-ttu-id="d12c2-247">信息泄露</span><span class="sxs-lookup"><span data-stu-id="d12c2-247">Information disclosure</span></span>|<span data-ttu-id="d12c2-248">6</span><span class="sxs-lookup"><span data-stu-id="d12c2-248">6</span></span>|<span data-ttu-id="d12c2-249">使用协议级别身份验证来确保消息未篡改在传输过程中。</span><span class="sxs-lookup"><span data-stu-id="d12c2-249">Use protocol-level authentication to make sure the message was not tampered with while in transit.</span></span> <span data-ttu-id="d12c2-250">若要使用协议级别身份验证，必须在电子商务域中具有消息队列路由器。</span><span class="sxs-lookup"><span data-stu-id="d12c2-250">To use protocol-level authentication, you must have a Message Queuing router in the E-Business domain.</span></span> <span data-ttu-id="d12c2-251">配置 BizTalk Server 按如下所示：</span><span class="sxs-lookup"><span data-stu-id="d12c2-251">Configure BizTalk Server as follows:</span></span><br /><br /> <span data-ttu-id="d12c2-252">-在**BizTalk 消息传送**页的配置管理器中，提供路由器的名称。</span><span class="sxs-lookup"><span data-stu-id="d12c2-252">-   On the **BizTalk Messaging** page of the Configuration Manager, provide the name of the router.</span></span><br /><span data-ttu-id="d12c2-253">-对于接收端口设置**身份验证**属性设置为**必需 （删除消息）** 或**必需 （保留消息）**。</span><span class="sxs-lookup"><span data-stu-id="d12c2-253">-   For the receive port, set the **Authentication** property to **Required (Drop Messages)** or **Required (Keep Messages)**.</span></span><br /><span data-ttu-id="d12c2-254">-对于发送处理程序，在**常规**选项卡上，在**MSMQ 路由器**名称框中，键入消息队列路由器的名称。</span><span class="sxs-lookup"><span data-stu-id="d12c2-254">-   For the send handler, on the **General** tab, in the **MSMQ Router** name box, type the name of the Message Queuing router.</span></span><br /><span data-ttu-id="d12c2-255">-对于该发送端口，选择**使用 MSMQ 身份验证**。</span><span class="sxs-lookup"><span data-stu-id="d12c2-255">-   For the send port, select **Use MSMQ Authentication**.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="d12c2-256">请参阅</span><span class="sxs-lookup"><span data-stu-id="d12c2-256">See Also</span></span>  
 <span data-ttu-id="d12c2-257">[威胁模型分析](../core/threat-model-analysis.md) </span><span class="sxs-lookup"><span data-stu-id="d12c2-257">[Threat Model Analysis](../core/threat-model-analysis.md) </span></span>  
 <span data-ttu-id="d12c2-258">[威胁模型分析的示例方案](../core/sample-scenarios-for-threat-model-analysis.md) </span><span class="sxs-lookup"><span data-stu-id="d12c2-258">[Sample Scenarios for Threat Model Analysis](../core/sample-scenarios-for-threat-model-analysis.md) </span></span>  
 [<span data-ttu-id="d12c2-259">中小型公司的示例体系结构</span><span class="sxs-lookup"><span data-stu-id="d12c2-259">Sample Architectures for Small & Medium-Sized Companies</span></span>](../core/sample-architectures-for-small-medium-sized-companies.md)