---
title: 如何测试和调试适配器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: cf6563ea-b4ea-4617-b3da-d31250d002ab
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c6d3806dc78fa09031339ab548d64149202d6dc3
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/07/2019
ms.locfileid: "65383739"
---
# <a name="how-to-test-and-debug-an-adapter"></a>如何测试和调试适配器
调试运行时问题通常需要综合的解决方法。 必须从例如软件跟踪、 性能计数器、 事件日志条目、 Windows Management Instrumentation (WMI) 事件和调试源代码，以确定问题或软件错误的原因的多个源收集数据。  
  
 因为接收和发送适配器需要将调试器附加到 BtsNtSvc.exe 进程，以调试适配器的 BizTalk 服务的地址空间中运行。 但是对于独立接收适配器，需要将调试器附加到承载适配器的进程。  
  
 应使用跟踪以捕获运行时诊断进行故障排除的代码检测适配器运行时代码。 可以使用 Microsoft Enterprise Instrumentation Framework (EIF) 来执行此操作。 通常最好添加跟踪语句的不同级别的严重性，例如，跟踪仅错误情况、 跟踪错误和警告，以及跟踪错误、 警告和信息性语句。 此外，更复杂的适配器可能有独立的子系统需要跟踪在彼此隔离。 例如，适配器可能有网络子系统和一个核心子系统;为所有子系统启用跟踪可能会在某些情况下生成过多的"噪声"。  
  
 应添加性能计数器，以在运行时能够在运行时行为的适配器的详细信息捕获速率和值。 例如，适配器可以发布有关在每个终结点的基础，以及每秒发送的消息的速率发送的消息的原始数字的性能计数器。  
  
 WMI 事件也可能适用于某些严重错误方案。  例如，如果适配器遇到严重错误，导致其关闭接收位置，触发 WMI 事件允许管理员能够侦听该事件并采取相应的措施。  
  
## <a name="adapter-testing"></a>适配器测试  
 当 BizTalk server 开发的自定义适配器时，请记住应开发企业软件质量标准。 这意味着您需要交付之前彻底测试适配器。 虽然它不完全详细说明应如何测试适配器，此部分可为需要完成的想法。 一般情况下测试适配器等的运行时代码应包含三大类： 功能测试、 压力测试和性能测试。  
  
### <a name="function-testing"></a>功能测试  
 适配器应测试其功能，包括正向测试和反向测试的所有可能情况。 正向测试应包括但不是限于以下方案：  
  
- 接收消息  
  
- 传输消息  
  
- 使用动态端口将消息传送  
  
- 禁用接收位置  
  
- 更新配置  
  
- 请确保接收和发送适配器均使用服务时段  
  
- 确保事务性适配器的事务完整性  
  
  反向测试应包括但不是限于：  
  
- 收到错误消息  
  
- 接收消息、 一些良好和有错误的混合消息的批  
  
- 传输失败  
  
- 重试成功  
  
- 重试失败，将转到下一个传输成功  
  
- 转到下一个传输失败，则挂起消息  
  
- 传输混合的消息批  
  
- 数据库故障转移  
  
### <a name="stress-testing"></a>压力测试  
 适配器是运行时组件和这种情况下应满足运行时软件的严格要求。 通常执行压力测试的负载下运行的一段时间内扩展。 进一步高压力下和低压力平均故障时间测试应执行，因此适配器在负载下运行测得的时间段内。  
  
 对于这些测试一些大致的指南可能在运行该适配器的高压力大约 72 个小时，其中通过适配器的消息数会导致 CPU 使用率达到大约 80 到 90%。 对于低压力，CPU 使用率为 30 到 40%左右大约 120 小时。  
  
### <a name="performance-testing"></a>性能测试  
 与性能方面的考虑，应开发适配器。 发布适配器前应验证其性能。 务必要确保其性能向上扩展和横向扩展;即，添加更多的 Cpu 会导致性能提升一样添加更多的计算机。 分析代码有助于消除性能瓶颈。